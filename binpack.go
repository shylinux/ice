package ice

import (
	"encoding/base64"
	ice "shylinux.com/x/icebergs"
)

func init() {

	pack := map[string]string{
        "/favicon.ico": "AAABAAEAgIAAAAEAIAAoCAEAFgAAACgAAACAAAAAAAEAAAEAIAAAAAAAAAABABILAAASCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAQAAAAEAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAABAAAAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAMAAAACAAAAAQAAAAEAAAABAAAAAQAAAAIAAAADAAAAAgAAAAIAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAIAAAACAAAAAgAAAAIAAAACAAAAAwAAAAMAAAAEAAAABAAAAAUAAAAGAAAABwAAAAcAAAAJAAAACQAAAAoAAAALAAAADQAAAA0AAAAOAAAADwAAABEAAAARAAAAEgAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////8////////5f//0AAAAABzoIB/////8AAAAAAAAAAAAAAAAD///gAAAAAAAAAAAAAAAAAD//gAAAAAAAAAAAAAAAAAAP/4AAAAAAAAAAAAAAAAAAD/+AAAAAAAAAAAAAAAAAAAf/gAAAAAAAAAAAAAAAAAAH/4AAAAAAAAAAAAAAAAAAD/+AAAAAAAAAAAAAAAAAAA//4AAAAAAAAAAAAAAAAAAf//4AAAAAAAAAAAAAAAAB////9gAAAAAAAAAAAAAAf//////+AAAAAAAAAAAP/////////AAAAAAAAAAAP/////////gAAAAAAAAAAA/////////gAAAAAAAAAAAP////////wAAAAAAAAAAAB////////4AAAAAAAAAAAAH///////8AAAAAAAAAAAAA///////+AAAAAAAAAAAAAD///////AAAAAAAAAAAAAAf//////gAAAAAAAAAAAAAD//////wAAAAAAAAAAAAAAf/////4AAAAAAAAAAAAAAH/////8AAAAAAAAAAAAAAA/////+AAAAAAAAAAAAAAAH/////AAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAH////4AAAAAAAAAAAAAAAA////+AAAAAAAAAAAAAAAAP////AAAAAAAAAAAAAAAAB////gAAAAAAAAAAAAAAAAP///4AAAAAAAAAAAAAAAAD///4AAAAAAAAAAAAAAAAAf//+AAAAAAAAAAAAAAAAAD///AAAAAAAAAAAAAAAAAA///wAAAAAAAAAAAAAAAAAH//4AAAAAAAAAAAAAAAAAB//+AAAAAAAAAAAAAAAAAAP//AAAAAAAAAAAAAAAAAAD//wAAAAAAAAAAAAAAAAAAf/4AAAAAAAAAAAAAAAAAAH/+AAAAAAAAAAAAAAAAAAB//AAAAAAAAAAAAAAAAAAAf/wAAAAAAAAAAAAAAAAAAD/8AAAAAAAAAAAAAAAAAAA/+AAAAAAAAAAAAAAAAAAAP/gAAAAAAAAAAAAAAAAAAB/4AAAAAAAAAAAAAAAAAAAf+AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP8AAAAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAP+AAAAAAAAAAAAAAAAAAAH/gAAAAAAAAAAAAAAAAAAB/4AAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAP/wAAAAAAAAAAAAAAAAAAD/8AAAAAAAAAAAAAAAAAAB//gAAAAAAAAAAAAAAAAAAf/4AAAAAAAAAAAAAAAAAAH/+AAAAAAAAAAAAAAAAAAD//wAAAAAAAAAAAAAAAAAA//8AAAAAAAAAAAAAAAAAAP//gAAAAAAAAAAAAAAAAAH//4AAAAAAAAAAAAAAAAAB///AAAAAAAAAAAAAAAAAA///wAAAAAAAAAAAAAAAAAP//+AAAAAAAAAAAAAAAAAH///gAAAAAAAAAAAAAAAAB///8AAAAAAAAAAAAAAAAA////gAAAAAAAAAAAAAAAAf///4AAAAAAAAAAAAAAAAH////AAAAAAAAAAAAAAAAH////4AAAAAAAAAAAAAAAD/////AAAAAAAAAAAAAAAA/////4AAAAAAAAAAAAAAAf/////AAAAAAAAAAAAAAAH/////4AAAAAAAAAAAAAAD//////AAAAAAAAAAAAAAB//////4AAAAAAAAAAAAAA///////AAAAAAAAAAAAAAf//////4AAAAAAAAAAAAAP///////AAAAAAAAAAAAAH///////4AAAAAAAAAAAAH////////AAAAAAAAAAAAD////////+AAAAAAAAAAAB/////////wAAAAAAAAAAA/////////8AAAAAAAAAAA//////////gAAAAAAAAAAf/////////+AAAAAAAAAAf//////////4AAAAAAAAA////////////AAAAAAAAAf///////////8AAAAAAAAP////////////wAAAAAAAP/////////////gAAAAAAf//////////////AAAAAAf//////////////+AAAAB//////////////////////////////////////////////////8=",
        "/proto.js": "dmFyIGtpdCA9IHsKCURpY3Q6IGZ1bmN0aW9uKCkgeyB2YXIgcmVzID0ge30KCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgKz0gMikgewoJCQlyZXNbYXJndW1lbnRzW2ldXSA9IGFyZ3VtZW50c1tpKzFdCgkJfSByZXR1cm4gcmVzCgl9Cn0KdmFyIGljZSA9IHsKCVRCOiAiXHQiLCBTUDogIiAiLCBERjogIjoiLCBFUTogIj0iLCBBVDogIkAiLCBQUzogIi8iLCBQVDogIi4iLCBGUzogIiwiLCBOTDogIlxuIiwgTFQ6ICI8IiwgR1Q6ICI+IiwKCU9LOiAib2siLCBUUlVFOiAidHJ1ZSIsIEZBTFNFOiAiZmFsc2UiLCBTVUNDRVNTOiAic3VjY2VzcyIsIEZBSUxVUkU6ICJmYWlsdXJlIiwgUFJPQ0VTUzogInByb2Nlc3MiLAoKCUFVVE86ICJhdXRvIiwgTElTVDogImxpc3QiLCBCQUNLOiAiYmFjayIsIEVYRUM6ICJleGVjIiwKCVNIT1c6ICJzaG93IiwgSElERTogImhpZGUiLCBIRUxQOiAiaGVscCIsIEhUVFA6ICJodHRwIiwKCVZJRVc6ICJ2aWV3IiwgTU9ERTogIm1vZGUiLCBTSElQOiAic2hpcCIsIENPUFk6ICJjb3B5IiwKCglQT0Q6ICJwb2QiLCBDVFg6ICJjdHgiLCBDTUQ6ICJjbWQiLCBBUkc6ICJhcmciLCBSRVM6ICJyZXMiLAoJUlVOOiAicnVuIiwgRVJSOiAiZXJyIiwgT1BUOiAib3B0IiwKCVBXRDogIi4vIiwKCglNU0dfREVUQUlMOiAiZGV0YWlsIiwKCU1TR19PUFRJT046ICJvcHRpb24iLAoJTVNHX0FQUEVORDogImFwcGVuZCIsCglNU0dfUkVTVUxUOiAicmVzdWx0IiwKCU1TR19GSUVMRFM6ICJmaWVsZHMiLAoJTVNHX1NFU1NJRDogInNlc3NpZCIsCgoJTVNHX1NPVVJDRTogIl9zb3VyY2UiLAoJTVNHX1RBUkdFVDogIl90YXJnZXQiLAoJTVNHX0hBTkRMRTogIl9oYW5kbGUiLAoJTVNHX1VQTE9BRDogIl91cGxvYWQiLAoJTVNHX0RBRU1PTjogIl9kYWVtb24iLAoJTVNHX0FDVElPTjogIl9hY3Rpb24iLAoJTVNHX1NUQVRVUzogIl9zdGF0dXMiLAoJTVNHX1BSRUZJWDogIl9wcmVmaXgiLAoKCU1TR19ESVNQTEFZOiAiX2Rpc3BsYXkiLAoJTVNHX1BST0NFU1M6ICJfcHJvY2VzcyIsCgoJTVNHX1VTRVJOQU1FOiAidXNlci5uYW1lIiwKCU1TR19VU0VSTklDSzogInVzZXIubmljayIsCgoJTVNHX1RJVExFOiAic2Vzcy50aXRsZSIsCglNU0dfVE9QSUM6ICJzZXNzLnRvcGljIiwKCU1TR19SSVZFUjogInNlc3Mucml2ZXIiLAoJTVNHX1NUT1JNOiAic2Vzcy5zdG9ybSIsCglNU0dfVE9BU1Q6ICJzZXNzLnRvYXN0IiwKCglQUk9DRVNTX0FHQUlOOiAiX2FnYWluIiwKCglFcnJXYXJuOiAid2FybjogIiwKCUVyck5vdExvZ2luOiAibm90IGxvZ2luOiAiLAoJRXJyTm90UmlnaHQ6ICJub3QgcmlnaHQ6ICIsCglFcnJOb3RGb3VuZDogIm5vdCBmb3VuZDogIiwKfQoKdmFyIGN0eCA9IHsKCUNPTlRFWFQ6ICJjb250ZXh0IiwgQ09NTUFORDogImNvbW1hbmQiLCBDT05GSUc6ICJjb25maWciLAoJSU5ERVg6ICJpbmRleCIsIEFSR1M6ICJhcmdzIiwgU1RZTEU6ICJzdHlsZSIsIERJU1BMQVk6ICJkaXNwbGF5IiwgQUNUSU9OOiAiYWN0aW9uIiwKCUlOUFVUUzogImlucHV0cyIsIEZFQVRVUkU6ICJmZWF0dXJlIiwKfQp2YXIgY2xpID0gewoJREFFTU9OOiAiZGFlbW9uIiwKCVNUQVJUOiAic3RhcnQiLCBTVE9QOiAic3RvcCIsIE9QRU46ICJvcGVuIiwgQ0xPU0U6ICJjbG9zZSIsIEJFR0lOOiAiYmVnaW4iLCBFTkQ6ICJlbmQiLAoKCVJFRDogInJlZCIsIEdSRUVOOiAiZ3JlZW4iLCBCTFVFOiAiYmx1ZSIsCglZRUxMT1c6ICJ5ZWxsb3ciLCBDWUFOOiAiY3lhbiIsIFBVUlBMRTogInB1cnBsZSIsIE1BR0VOVEE6ICJtYWdlbnRhIiwKCVdISVRFOiAid2hpdGUiLCBCTEFDSzogImJsYWNrIiwKCglNQUtFOiAibWFrZSIsIE1BSU46ICJtYWluIiwgRVhFQzogImV4ZWMiLCBET05FOiAiZG9uZSIsCglDT0RFOiAiY29kZSIsIENPU1Q6ICJjb3N0IiwgQkFDSzogImJhY2siLCBGUk9NOiAiZnJvbSIsCglFUlJPUjogImVycm9yIiwgQ0xFQVI6ICJjbGVhciIsIFJFRlJFU0g6ICJyZWZyZXNoIiwKCVNIT1c6ICJzaG93IiwKfQp2YXIgbmZzID0gewoJWk1MOiAiem1sIiwgSU1MOiAiaW1sIiwKCUhUTUw6ICJodG1sIiwgQ1NTOiAiY3NzIiwgSlM6ICJqcyIsIEdPOiAiZ28iLCBTSDogInNoIiwgQ1NWOiAiY3N2IiwgSlNPTjogImpzb24iLAoJUEFUSDogInBhdGgiLCBGSUxFOiAiZmlsZSIsIExJTkU6ICJsaW5lIiwgU0laRTogInNpemUiLAoJU0FWRTogInNhdmUiLCBMT0FEOiAibG9hZCIsIFRBR1M6ICJ0YWdzIiwgRklORDogImZpbmQiLCBHUkVQOiAiZ3JlcCIsCglESVI6ICJkaXIiLCBDQVQ6ICJjYXQiLCBERUZTOiAiZGVmcyIsIFRSQVNIOiAidHJhc2giLAoJRElSX1JPT1Q6ICJkaXJfcm9vdCIsCglTQ1JJUFQ6ICJzY3JpcHQiLAp9CnZhciBtZGIgPSB7CglESUNUOiAiZGljdCIsIE1FVEE6ICJtZXRhIiwgSEFTSDogImhhc2giLCBMSVNUOiAibGlzdCIsCgoJSUQ6ICJpZCIsIEtFWTogImtleSIsIFRJTUU6ICJ0aW1lIiwgWk9ORTogInpvbmUiLCBUWVBFOiAidHlwZSIsIE5BTUU6ICJuYW1lIiwgVEVYVDogInRleHQiLAoJTElOSzogImxpbmsiLCBTQ0FOOiAic2NhbiIsIFNIT1c6ICJzaG93IiwgSEVMUDogImhlbHAiLAoJU0hPUlQ6ICJzaG9ydCIsIEZJRUxEOiAiZmllbGQiLCBUT1RBTDogInRvdGFsIiwgQ09VTlQ6ICJjb3VudCIsIExJTUlUOiAibGltaXQiLAoJSU5ERVg6ICJpbmRleCIsIFZBTFVFOiAidmFsdWUiLCBFWFRSQTogImV4dHJhIiwgQUxJQVM6ICJhbGlhcyIsIEVYUElSRTogImV4cGlyZSIsCgoJQ1JFQVRFOiAiY3JlYXRlIiwgUkVNT1ZFOiAicmVtb3ZlIiwgSU5TRVJUOiAiaW5zZXJ0IiwgREVMRVRFOiAiZGVsZXRlIiwKCU1PRElGWTogIm1vZGlmeSIsIFNFTEVDVDogInNlbGVjdCIsCglJTlBVVFM6ICJpbnB1dHMiLCBQUlVORVM6ICJwcnVuZXMiLCBFWFBPUlQ6ICJleHBvcnQiLCBJTVBPUlQ6ICJpbXBvcnQiLAoJVVBMT0FEOiAidXBsb2FkIiwKCglTRUFSQ0g6ICJzZWFyY2giLCBFTkdJTkU6ICJlbmdpbmUiLCBSRU5ERVI6ICJyZW5kZXIiLCBQTFVHSU46ICJwbHVnaW4iLAoJUEFHRTogInBhZ2UiLCBORVhUOiAibmV4dCIsIFBSRVY6ICJwcmV2IiwgTElNSVQ6ICJsaW1pdCIsIE9GRkVORDogIm9mZmVuZCIsCglNQUlOOiAibWFpbiIsCgoJRk9SRUFDSDogIioiLCBSQU5ET01TOiAiJSIsCn0KdmFyIGFhYSA9IHsKCVBBU1NXT1JEOiAicGFzc3dvcmQiLCBVU0VSTkFNRTogInVzZXJuYW1lIiwgVVNFUk5JQ0s6ICJ1c2VybmljayIsIEJBQ0tHUk9VTkQ6ICJiYWNrZ3JvdW5kIiwgQVZBVEFSOiAiYXZhdGFyIiwKCUxBTkdVQUdFOiAibGFuZ3VhZ2UiLCBFTkdMSVNIOiAiZW5nbGlzaCIsIENISU5FU0U6ICJjaGluZXNlIiwKCUxPR0lOOiAibG9naW4iLCBMT0dPVVQ6ICJsb2dvdXQiLCBJTlZJVEU6ICJpbnZpdGUiLAp9CnZhciB3ZWIgPSB7CglTUEFDRTogInNwYWNlIiwgRFJFQU06ICJkcmVhbSIsIFNIQVJFOiAic2hhcmUiLAp9CnZhciB0Y3AgPSB7CglIT1NUOiAiaG9zdCIsIFBPUlQ6ICJwb3J0IiwKfQp2YXIgZ2RiID0gewoJU0lHTkFMOiAic2lnbmFsIiwKfQp2YXIgbGV4ID0gewoJU1BMSVQ6ICJzcGxpdCIsCn0KCnZhciBjb2RlID0gewoJVklNRVI6ICJ2aW1lciIsIElOTkVSOiAiaW5uZXIiLCBGQVZPUjogImZhdm9yIiwKCUFVVE9HRU46ICJhdXRvZ2VuIiwgQ09NUElMRTogImNvbXBpbGUiLCBCSU5QQUNLOiAiYmlucGFjayIsIFdFQlBBQ0s6ICJ3ZWJwYWNrIiwgUFVCTElTSDogInB1Ymxpc2giLAoJS0VZV09SRDogImtleXdvcmQiLAp9CnZhciB3aWtpID0gewoJVElUTEU6ICJ0aXRsZSIsIEJSSUVGOiAiYnJpZWYiLCBSRUZFUjogInJlZmVyIiwgU1BBUks6ICJzcGFyayIsCglPUkRFUjogIm9yZGVyIiwgVEFCTEU6ICJ0YWJsZSIsIENIQVJUOiAiY2hhcnQiLCBJTUFHRTogImltYWdlIiwgVklERU86ICJ2aWRlbyIsCglGSUVMRDogImZpZWxkIiwgU0hFTEw6ICJzaGVsbCIsIExPQ0FMOiAibG9jYWwiLCBQQVJTRTogInBhcnNlIiwKCglOQVZNRU5VOiAibmF2bWVudSIsIFBSRU1FTlU6ICJwcmVtZW51IiwKCglJVEVNOiAiLnN0b3J5IiwKCUgyOiAiaDIuc3RvcnkiLAoJSDM6ICJoMy5zdG9yeSIsCglESVZfUEFHRTogImRpdi5wYWdlIiwKfQp2YXIgY2hhdCA9IHsKCUxJQjogImxpYiIsIFBBR0U6ICJwYWdlIiwgUEFORUw6ICJwYW5lbCIsIFBMVUdJTjogInBsdWdpbiIsIE9VVFBVVDogIm91dHB1dCIsIFNUT1JZOiAic3RvcnkiLCBGTE9BVDogImZsb2F0IiwKCVRPQVNUOiAidG9hc3QiLCBDQVJURTogImNhcnRlIiwgSU5QVVQ6ICJpbnB1dCIsIFVQTE9BRDogInVwbG9hZCIsIENPTlRFWFRTOiAiY29udGV4dHMiLAoJTEVHTkVEOiAibGVnZW5kIiwgT1BUSU9OOiAib3B0aW9uIiwgQUNUSU9OOiAiYWN0aW9uIiwgT1VUUFVUOiAib3V0cHV0IiwgU1RBVFVTOiAic3RhdHVzIiwKCUxBWU9VVDogImxheW91dCIsIFBST0pFQ1Q6ICJwcm9qZWN0IiwgQ09OVEVOVDogImNvbnRlbnQiLCBESVNQTEFZOiAiZGlzcGxheSIsIFBST0ZJTEU6ICJwcm9maWxlIiwKCU9OSU1QT1JUOiAib25pbXBvcnQiLCBPTkFDVElPTjogIm9uYWN0aW9uIiwgT05LRVlNQVA6ICJvbmtleW1hcCIsIE9ORVhQT1JUOiAib25leHBvcnQiLAoKCVRJVExFOiAidGl0bGUiLCBUT1BJQzogInRvcGljIiwgQkxBQ0s6ICJibGFjayIsIFdISVRFOiAid2hpdGUiLCBQUklOVDogInByaW50IiwKCVNIQVJFOiAic2hhcmUiLCBSSVZFUjogInJpdmVyIiwgU1RPUk06ICJzdG9ybSIsIEZJRUxEOiAiZmllbGQiLAoJUFVCTElDOiAicHVibGljIiwgUFJPVEVDVEVEOiAicHJvdGVjdGVkIiwgUFJJVkFURTogInByaXZhdGUiLAoJVVNFUjogInVzZXIiLCBUT09MOiAidG9vbCIsIE5PREU6ICJub2RlIiwKCglBR0VOVDogImFnZW50IiwgQ0hFQ0s6ICJjaGVjayIsIEdSQU5UOiAiZ3JhbnQiLAoJU1RBVEU6ICJzdGF0ZSIsIE1FTlVTOiAibWVudXMiLCBUUkFOUzogInRyYW5zIiwKCVNTTzogInNzbyIsCgoJT05NQUlOOiAib25tYWluIiwgT05MT0dJTjogIm9ubG9naW4iLCBPTlNFQVJDSDogIm9uc2VhcmNoIiwKCU9OU0laRTogIm9uc2l6ZSIsIE9OVE9BU1Q6ICJvbnRvYXN0IiwgT05SRU1PVEU6ICJvbnJlbW90ZSIsCglPTktFWURPV046ICJvbmtleWRvd24iLAoKCVdFQlNJVEU6ICJ3ZWJzaXRlIiwKCUhFQUQ6ICJoZWFkIiwgTEVGVDogImxlZnQiLCBNQUlOOiAibWFpbiIsIEFVVE86ICJhdXRvIiwgSElERTogImhpZGUiLCBGT09UOiAiZm9vdCIsCglIRUFERVI6ICJoZWFkZXIiLCBGT09URVI6ICJmb290ZXIiLAogICAgQUNUSU9OX0xBWU9VVF9GTVQ6IGAKZmllbGRzZXQuQWN0aW9uLmdyaWQ+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4gewogICAgd2lkdGg6X3dpZHRoOyBoZWlnaHQ6X2hlaWdodDsKfQpmaWVsZHNldC5BY3Rpb24uZ3JpZD5kaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbj5kaXYub3V0cHV0IHsKICAgIHdpZHRoOl93aWR0aDsgaGVpZ2h0Ol9oZWlnaHQ7Cn0KYCwKCglQTFVHSU5fU1RBVEVfSlM6ICIvcGx1Z2luL3N0YXRlLmpzIiwKCVBMVUdJTl9JTlBVVF9KUzogIi9wbHVnaW4vaW5wdXQuanMiLAoJUExVR0lOX1RBQkxFX0pTOiAiL3BsdWdpbi90YWJsZS5qcyIsCgoJbGliczogWyIvbGliL2Jhc2UuanMiLCAiL2xpYi9jb3JlLmpzIiwgIi9saWIvbWlzYy5qcyIsICIvbGliL3BhZ2UuanMiLCAiL2xpYi91c2VyLmpzIl0sCglwYW5lbF9saXN0OiBbCgkJe25hbWU6ICJIZWFkZXIiLCBoZWxwOiAi5qCH6aKY5qCPIiwgcG9zOiAiaGVhZCIsIHN0YXRlOiBbInRpbWUiLCAidXNlcm5pY2siLCAiYXZhdGFyIl19LAoJCXtuYW1lOiAiUml2ZXIiLCAgaGVscDogIue+pOiBiue7hCIsIHBvczogImxlZnQiLCBhY3Rpb246IFsiY3JlYXRlIiwgInJlZnJlc2giXX0sCgkJe25hbWU6ICJBY3Rpb24iLCBoZWxwOiAi5bel5L2c5Y+wIiwgcG9zOiAibWFpbiJ9LAoJCXtuYW1lOiAiU2VhcmNoIiwgaGVscDogIuaQnOe0ouahhiIsIHBvczogImF1dG8ifSwKCQl7bmFtZTogIkZvb3RlciIsIGhlbHA6ICLnirbmgIHmnaEiLCBwb3M6ICJmb290Iiwgc3RhdGU6IFsibmNtZCJdfSwKCV0sCglwbHVnaW5fbGlzdDogWwoJCSIvcGx1Z2luL3N0YXRlLmpzIiwKCQkiL3BsdWdpbi9pbnB1dC5qcyIsCgkJIi9wbHVnaW4vdGFibGUuanMiLAoJCSIvcGx1Z2luL2lucHV0L2tleS5qcyIsCgkJIi9wbHVnaW4vaW5wdXQvZGF0ZS5qcyIsCgkJIi9wbHVnaW4vc3Rvcnkvc3BpZGUuanMiLAoJCSIvcGx1Z2luL3N0b3J5L3RyZW5kLmpzIiwKCQkiL3BsdWdpbi9sb2NhbC9jb2RlL2lubmVyLmpzIiwKCQkiL3BsdWdpbi9sb2NhbC9jb2RlL3ZpbWVyLmpzIiwKCQkiL3BsdWdpbi9sb2NhbC93aWtpL2RyYXcvcGF0aC5qcyIsCgkJIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmpzIiwKCQkiL3BsdWdpbi9sb2NhbC93aWtpL3dvcmQuanMiLAoJCSIvcGx1Z2luL2xvY2FsL2NoYXQvZGl2LmpzIiwKCQkiL3BsdWdpbi9sb2NhbC90ZWFtL3BsYW4uanMiLAoJCSIvcGx1Z2luL2lucHV0L3Byb3ZpbmNlLmpzIiwKCV0sCn0KdmFyIHRlYW0gPSB7CglUQVNLOiAidGFzayIsIFBMQU46ICJwbGFuIiwKfQp2YXIgbWFsbCA9IHsKCUFTU0VUOiAiYXNzZXQiLCBTQUxBUlk6ICJzYWxhcnkiLAp9Cgp2YXIgc3ZnID0gewoJRzogImciLCBYOiAieCIsIFk6ICJ5IiwgUjogInIiLCBSWDogInJ4IiwgUlk6ICJyeSIsCglMSU5FOiAibGluZSIsIFJFQ1Q6ICJyZWN0IiwgVEVYVDogInRleHQiLAoJTTogIk0iLCBROiAiUSIsIFQ6ICJUIiwKCVBBVEgyVjogInBhdGgydiIsIFBBVEgySDogInBhdGgyaCIsCn0KdmFyIGh0bWwgPSB7CglGSUVMRFNFVDogImZpZWxkc2V0IiwgTEVHRU5EOiAibGVnZW5kIiwgT1BUSU9OOiAib3B0aW9uIiwgQUNUSU9OOiAiYWN0aW9uIiwgT1VUUFVUOiAib3V0cHV0IiwgU1RBVFVTOiAic3RhdHVzIiwKCUZPUk1fT1BUSU9OOiAiZm9ybS5vcHRpb24iLCBESVZfQUNUSU9OOiAiZGl2LmFjdGlvbiIsIERJVl9PVVRQVVQ6ICJkaXYub3V0cHV0IiwgRElWX1NUQVRVUzogImRpdi5zdGF0dXMiLAoJRklFTERTRVRfUEFORUw6ICJmaWVsZHNldC5wYW5lbCIsIEZJRUxEU0VUX1BMVUdJTjogImZpZWxkc2V0LnBsdWdpbiIsIEZJRUxEU0VUX1NUT1JZOiAiZmllbGRzZXQuc3RvcnkiLAoKCUZJRUxEU0VUX0hFQUQ6ICJmaWVsZHNldC5oZWFkIiwgRklFTERTRVRfRk9PVDogImZpZWxkc2V0LmZvb3QiLAoJRklFTERTRVRfTEVGVDogImZpZWxkc2V0LmxlZnQiLCBGSUVMRFNFVF9NQUlOOiAiZmllbGRzZXQubWFpbiIsCglGSUVMRFNFVF9BVVRPOiAiZmllbGRzZXQuYXV0byIsIEZJRUxEU0VUX0ZMT0FUOiAiZmllbGRzZXQuZmxvYXQiLAoKCU9QVElPTl9BUkdTOiAic2VsZWN0LmFyZ3MsaW5wdXQuYXJncyx0ZXh0YXJlYS5hcmdzIiwKCUlOUFVUX0FSR1M6ICJpbnB1dC5hcmdzLHRleHRhcmVhLmFyZ3MiLAoJSU5QVVRfQlVUVE9OOiAiaW5wdXRbdHlwZT1idXR0b25dIiwKCglVUExPQUQ6ICJ1cGxvYWQiLCBVU0VSTkFNRTogInVzZXJuYW1lIiwgUEFTU1dPUkQ6ICJwYXNzd29yZCIsCglJTlBVVDogImlucHV0IiwgVEVYVDogInRleHQiLCBURVhUQVJFQTogInRleHRhcmVhIiwgU0VMRUNUOiAic2VsZWN0IiwgQlVUVE9OOiAiYnV0dG9uIiwKCUZPUk06ICJmb3JtIiwgRklMRTogImZpbGUiLCBTUEFDRTogInNwYWNlIiwgQ0xJQ0s6ICJjbGljayIsIFNVQk1JVDogInN1Ym1pdCIsIENBTkNFTDogImNhbmNlbCIsCglESVY6ICJkaXYiLCBJTUc6ICJpbWciLCBDT0RFOiAiY29kZSIsIFNQQU46ICJzcGFuIiwgVklERU86ICJ2aWRlbyIsCglUQUJMRTogInRhYmxlIiwgVEJPRFk6ICJ0Ym9keSIsIFRSOiAidHIiLCBUSDogInRoIiwgVEQ6ICJ0ZCIsIEJSOiAiYnIiLCBVTDogInVsIiwgTEk6ICJsaSIsCglBOiAiYSIsIExBQkVMOiAibGFiZWwiLCBJTk5FUjogImlubmVyIiwgVElUTEU6ICJ0aXRsZSIsCglIMTogImgxIiwgSDI6ICJoMiIsIEgzOiAiaDMiLAoKCUNMQVNTOiAiY2xhc3MiLCBGTE9BVDogImZsb2F0IiwgQ0xFQVI6ICJjbGVhciIsIEJPVEg6ICJib3RoIiwKCUJBQ0tHUk9VTkQ6ICJiYWNrZ3JvdW5kIiwgU0VMRUNUOiAic2VsZWN0IiwgSElEREVOOiAiaGlkZGVuIiwKCURJU1BMQVk6ICJkaXNwbGF5IiwgQkxPQ0s6ICJibG9jayIsIE5PTkU6ICJub25lIiwgRklYRUQ6ICJmaXhlZCIsCglPUEFDSVRZOiAib3BhY2l0eSIsCglTVFJPS0VfV0lEVEg6ICJzdHJva2Utd2lkdGgiLCBTVFJPS0U6ICJzdHJva2UiLCBGSUxMOiAiZmlsbCIsIEZPTlRfU0laRTogImZvbnQtc2l6ZSIsIE1PTk9TUEFDRTogIm1vbm9zcGFjZSIsCglTQ1JPTEw6ICJzY3JvbGwiLCBIRUlHSFQ6ICJoZWlnaHQiLCBXSURUSDogIndpZHRoIiwgTEVGVDogImxlZnQiLCBUT1A6ICJ0b3AiLCBSSUdIVDogInJpZ2h0IiwgQk9UVE9NOiAiYm90dG9tIiwKCU1JTl9IRUlHSFQ6ICJtaW4taGVpZ2h0IiwgTUFYX0hFSUdIVDogIm1heC1oZWlnaHQiLCBNQVhfV0lEVEg6ICJtYXgtd2lkdGgiLCBNQVJHSU5fVE9QOiAibWFyZ2luLXRvcCIsIE1BUkdJTl9YOiAibWFyZ2luLXgiLCBNQVJHSU5fWTogIm1hcmdpbi15IiwKCVBMVUdJTl9NQVJHSU46IDEwLCBBQ1RJT05fSEVJR0hUOiAyOSwgQUNUSU9OX01BUkdJTjogMjAwLAoJVE9HR0xFOiAidG9nZ2xlIiwKCglXU1M6ICJ3c3MiLCBTVkc6ICJzdmciLCBDQU5WQVM6ICJjYW52YXMiLCBJRlJBTUU6ICJpZnJhbWUiLCBDSFJPTUU6ICJjaHJvbWUiLAoJTElTVDogImxpc3QiLCBJVEVNOiAiaXRlbSIsIE1FTlU6ICJtZW51IiwgTk9ERTogIm5vZGUiLAoJRElWX0lURU06ICJkaXYuaXRlbSIsIERJVl9GTE9BVDogImRpdi5mbG9hdCIsCglUQUJTOiAidGFicyIsIERJVl9UQUJTOiAiZGl2LnRhYnMiLAoJSElERTogImhpZGUiLCBTSE9XOiAic2hvdyIsCgoJSEVBRDogImhlYWQiLCBMRUZUOiAibGVmdCIsIE1BSU46ICJtYWluIiwgRk9PVDogImZvb3QiLAoJVEFCUzogInRhYnMiLCBNRU5VOiAibWVudSIsCglMSVNUOiAibGlzdCIsIElURU06ICJpdGVtIiwKCVBBR0U6ICJwYWdlIiwKCUhJREU6ICJoaWRlIiwKCUxBWU9VVDogImxheW91dCIsCglQTFVHSU46ICJwbHVnaW4iLAoJRElWX1BBR0U6ICJkaXYucGFnZSIsCglESVZfTElTVDogImRpdi5saXN0IiwKCURJVl9JVEVNOiAiZGl2Lml0ZW0iLAoJRElWX0xBWU9VVF9IRUFEOiAiZGl2LmxheW91dC5oZWFkIiwKCURJVl9MQVlPVVRfTEVGVDogImRpdi5sYXlvdXQubGVmdCIsCglESVZfTEFZT1VUX0ZPT1Q6ICJkaXYubGF5b3V0LmZvb3QiLAoKCUVTQ0FQRTogIkVzY2FwZSIsIEVOVEVSOiAiRW50ZXIiLCBUQUI6ICJUYWIiLAp9CnZhciBsYW5nID0gewoJVU5ERUZJTkVEOiAidW5kZWZpbmVkIiwKCVNUUklORzogInN0cmluZyIsIE5VTUJFUjogIm51bWJlciIsCglPQkpFQ1Q6ICJvYmplY3QiLCBGVU5DVElPTjogImZ1bmN0aW9uIiwKCUVTQ0FQRTogIkVzY2FwZSIsIEVOVEVSOiAiRW50ZXIiLCBUQUI6ICJUYWIiLAoJQ09OVFJPTDogIkNvbnRyb2wiLCBTSElGVDogIlNoaWZ0IiwKCVBTOiAiLyIsCn0KZnVuY3Rpb24gc2h5KGhlbHAsIG1ldGEsIGxpc3QsIGNiKSB7Cgl2YXIgaW5kZXggPSAwLCBhcmdzID0gYXJndW1lbnRzOyBmdW5jdGlvbiBuZXh0KHR5cGUpIHsKCQlpZiAoaW5kZXggPCBhcmdzLmxlbmd0aCAmJiAoIXR5cGUgfHwgdHlwZSA9PSB0eXBlb2YgYXJnc1tpbmRleF0pKSB7IHJldHVybiBhcmdzW2luZGV4KytdIH0KCX0KCgljYiA9IGFyZ3NbYXJncy5sZW5ndGgtMV18fGZ1bmN0aW9uKCkge30KCWNiLmhlbHAgPSBuZXh0KGxhbmcuU1RSSU5HKXx8IiIKCWNiLm1ldGEgPSBuZXh0KGxhbmcuT0JKRUNUKXx8e30KCWNiLmxpc3QgPSBuZXh0KGxhbmcuT0JKRUNUKXx8W10KCXJldHVybiBjYgp9OyB2YXIgX2Nhbl9uYW1lID0gIiIsIF9jYW5fcGF0aCA9ICIiCnZhciBWb2xjYW5vcyA9IHNoeSgi54Gr5bGx5p62Iiwge2ljZWJlcmc6ICIvY2hhdC8iLCB2b2xjYW5vOiAiL2ZyYW1lLmpzIiwgYXJnczoge30sIHBhY2s6IHt9LCBsaWJzOiBbXSwgY2FjaGU6IHt9fSwgZnVuY3Rpb24obmFtZSwgY2FuLCBsaWJzLCBjYikgewoJdmFyIG1ldGEgPSBhcmd1bWVudHMuY2FsbGVlLm1ldGEsIGxpc3QgPSBhcmd1bWVudHMuY2FsbGVlLmxpc3QKCWlmICh0eXBlb2YgbmFtZSA9PSBsYW5nLk9CSkVDVCkgeyB2YXIgQ29uZmlnID0gbmFtZTsgQ29uZmlnLnBsdWdpbiA9IENvbmZpZy5wbHVnaW58fGNoYXQucGx1Z2luX2xpc3QKCQlDb25maWcucGFuZWxzID0gQ29uZmlnLnBhbmVsc3x8Y2hhdC5wYW5lbF9saXN0LCBDb25maWcubWFpbiA9IENvbmZpZy5tYWlufHx7bmFtZTogIkhlYWRlciJ9CgkJbWV0YS5saWJzID0gQ29uZmlnLmxpYnN8fGNoYXQubGlicywgbWV0YS5pY2ViZXJnID0gQ29uZmlnLmljZWJlcmd8fG1ldGEuaWNlYmVyZwoKCQkvLyDpooTliqDovb0KCQlsaWJzID0gW107IGZvciAodmFyIGkgPSAwOyBpIDwgQ29uZmlnLnBhbmVscy5sZW5ndGg7IGkrKykgeyB2YXIgcGFuZWwgPSBDb25maWcucGFuZWxzW2ldCgkJCXBhbmVsICYmIChsaWJzID0gbGlicy5jb25jYXQocGFuZWwubGlzdCA9IHBhbmVsLmxpc3R8fFsiL3BhbmVsLyIrcGFuZWwubmFtZSsiLmNzcyIsICIvcGFuZWwvIitwYW5lbC5uYW1lKyIuanMiXSkpCgkJfTsgbGlicyA9IGxpYnMuY29uY2F0KENvbmZpZy5wbHVnaW4sIENvbmZpZy5tYWluLmxpc3R8fFtdKQoKCQkvLyDmoLnmqKHlnZcKCQlfY2FuX25hbWUgPSAiIiwgbmFtZSA9IENvbmZpZy5uYW1lfHwiY2hhdCIsIGNiID0gY2FufHxmdW5jdGlvbihjYW4pIHsKCQkJY2FuLm9uZW5naW5lLl9pbml0KGNhbiwgY2FuLkNvbmYoQ29uZmlnKSwgQ29uZmlnLnBhbmVscywgQ29uZmlnLl9pbml0LCBjYW4uX3RhcmdldCkKCQl9CgkJY2FuID0ge19mb2xsb3c6IG5hbWUsIF90YXJnZXQ6IENvbmZpZy50YXJnZXR8fG1ldGEudGFyZ2V0fSwgY2FuLl9yb290ID0gY2FuCgkJZm9yICh2YXIgayBpbiBDb25maWcpIHsgY2FuW2tdID0gQ29uZmlnW2tdIH0KCX0KCgl2YXIgcHJvdG8gPSB7X19wcm90b19fOiBtZXRhLCBfcGF0aDogX2Nhbl9wYXRoLCBfbmFtZTogbmFtZSwgX2xvYWQ6IGZ1bmN0aW9uKG5hbWUsIGVhY2gpIHsgLy8g5Yqg6L2957yT5a2YCgkJCXZhciBjYWNoZSA9IG1ldGEuY2FjaGVbbmFtZV18fFtdOyBmb3IgKGxpc3QucmV2ZXJzZSgpOyBsaXN0Lmxlbmd0aCA+IDA7IGxpc3QpIHsKCQkJCXZhciBzdWIgPSBsaXN0LnBvcCgpOyBzdWIgIT0gY2FuICYmIGNhY2hlLnB1c2goc3ViKQoJCQl9OyBtZXRhLmNhY2hlW25hbWVdID0gY2FjaGUKCgkJCS8vIOWKoOi9veaooeWdlwoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGNhY2hlLmxlbmd0aDsgaSsrKSB7IHZhciBzdWIgPSBjYWNoZVtpXSwgbmFtZSA9IHN1Yi5fbmFtZQoJCQkJaWYgKHR5cGVvZiBlYWNoID09IGxhbmcuRlVOQ1RJT04gJiYgZWFjaChjYW4sIG5hbWUsIHN1YikpIHsgY29udGludWUgfQoJCQkJIWNhbltuYW1lXSAmJiAoY2FuW25hbWVdID0ge30pOyBmb3IgKHZhciBrIGluIHN1YikgewoJCQkJCWNhbltuYW1lXS5oYXNPd25Qcm9wZXJ0eShrKSB8fCAoY2FuW25hbWVdW2tdID0gc3ViW2tdKQoJCQkJfQoJCQl9CgkJfSwKCQlyZXF1aXJlOiBmdW5jdGlvbihsaWJzLCBjYiwgZWFjaCkgeyBpZiAoIWxpYnMgfHwgbGlicy5sZW5ndGggPT0gMCkgewoJCQkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2IoY2FuKSB9LCAxMCkKCQkJCXJldHVybiAvLyDliqDovb3lrozmiJAKCQkJfQoKCQkJLy8g5peg5pWI5Zyw5Z2ACgkJCWlmICghbGlic1swXSkgeyByZXR1cm4gY2FuLnJlcXVpcmUobGlicy5zbGljZSgxKSwgY2IsIGVhY2gpIH0KCgkJCS8vIOihpeWFqOWcsOWdgAoJCQlpZiAobGlic1swXSA9PSAiIikgewoJCQkJbGlic1swXSA9IGNhbi5fbmFtZS5yZXBsYWNlKCIuanMiLCAiLmNzcyIpCgkJCX0gZWxzZSBpZiAobGlic1swXVswXSAhPSBpY2UuUFMgJiYgbGlic1swXS5pbmRleE9mKGljZS5IVFRQKSAhPSAwKSB7CgkJCQlsaWJzWzBdID0gY2FuLl9uYW1lLnNsaWNlKDAsIGNhbi5fbmFtZS5sYXN0SW5kZXhPZihpY2UuUFMpKzEpK2xpYnNbMF0KCQkJfQoKCQkJLy8g5Yqg6L295qih5Z2XCgkJCWxpYnNbMF0gPSBsaWJzWzBdLnRvTG93ZXJDYXNlKCkKCQkJdmFyIG5hbWUgPSBsaWJzWzBdLnNwbGl0KCI/IilbMF0KCQkJZnVuY3Rpb24gbmV4dCgpIHsgY2FuLl9sb2FkKG5hbWUsIGVhY2gpLCBjYW4ucmVxdWlyZShsaWJzLnNsaWNlKDEpLCBjYiwgZWFjaCkgfQoJCQltZXRhLmNhY2hlW25hbWVdPyBuZXh0KCk6IChfY2FuX3BhdGggPSBsaWJzWzBdLCBtZXRhLl9sb2FkKG5hbWUsIG5leHQpKQoJCX0sCgkJcmVxdWVzdDogZnVuY3Rpb24oZXZlbnQsIG9wdGlvbikgeyBldmVudCA9IGV2ZW50fHx7fQoJCQl2YXIgbXNnID0gZXZlbnQuX21zZ3x8Y2FuLm1pc2MuTWVzc2FnZShldmVudCwgY2FuKTsgZXZlbnQuX21zZyA9IG1zZwoJCQlmdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSkgeyBtc2cuT3B0aW9uKGtleSkgfHwgdmFsdWUgPT0gIiIgfHwgbXNnLk9wdGlvbihrZXksIHZhbHVlKSB9CgoJCQljYW4uY29yZS5MaXN0KGFyZ3VtZW50cywgZnVuY3Rpb24ob3B0aW9uLCBpbmRleCkgeyBpZiAoIW9wdGlvbiB8fCBpbmRleCA9PSAwKSB7IHJldHVybiB9IAoJCQkJY2FuLmJhc2UuaXNGdW5jKG9wdGlvbi5PcHRpb24pPyBjYW4uY29yZS5MaXN0KG9wdGlvbi5PcHRpb24oKSwgZnVuY3Rpb24oa2V5KSB7CgkJCQkJc2V0KGtleSwgb3B0aW9uLk9wdGlvbihrZXkpKQoJCQkJfSk6IGNhbi5jb3JlLkl0ZW0oY2FuLmJhc2UuaXNGdW5jKG9wdGlvbik/IG9wdGlvbigpOiBvcHRpb24sIHNldCkKCQkJfSk7IHJldHVybiBtc2cKCQl9LAoJCWFjdGlvbnM6IGZ1bmN0aW9uKGV2ZW50LCBidXR0b24pIHsgY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGJ1dHRvbl0sIG51bGwsIHRydWUpIH0sCgoJCXNlYXJjaDogZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCWlmIChjbWRzICYmIHR5cGVvZiBjbWRzID09IGxhbmcuT0JKRUNUICYmIGNtZHMubGVuZ3RoID4gMCAmJiB0eXBlb2YgY21kc1swXSA9PSBsYW5nLk9CSkVDVCAmJiBjbWRzWzBdLmxlbmd0aCA+IDAgKSB7CgkJCQljbWRzWzBdID0gY21kc1swXS5qb2luKGljZS5QVCkKCQkJfQoJCQlyZXR1cm4gY2FuLnJ1biAmJiBjYW4ucnVuKGV2ZW50LCBbIl9zZWFyY2giXS5jb25jYXQoY21kcyksIGNiLCB0cnVlKQoJCX0sCgkJZ2V0OiBmdW5jdGlvbihuYW1lLCBrZXksIGNiKSB7IHJldHVybiBjYW4uc2VhcmNoKHt9LCBbY2FuLmNvcmUuS2V5cyhuYW1lLCBjaGF0Lk9ORVhQT1JULCBrZXkpXSwgY2IpIH0sCgkJc2V0OiBmdW5jdGlvbihuYW1lLCBrZXksIHZhbHVlKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdCh7fSk7IG1zZy5PcHRpb24oa2V5LCB2YWx1ZSkKCQkJcmV0dXJuIGNhbi5zZWFyY2gobXNnLl9ldmVudCwgW1tuYW1lLCBjaGF0Lk9OSU1QT1JULCBrZXldXSkKCQl9LAoJCXNldEhlYWRlck1lbnU6IGZ1bmN0aW9uKGxpc3QsIGNiKSB7IGNhbi5fbWVudSAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uX21lbnUpCgkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdCh7fSwge3RyYW5zOiBjYW4ub25hY3Rpb24uX3RyYW5zfSkKCQkJcmV0dXJuIGNhbi5fbWVudSA9IGNhbi5zZWFyY2gobXNnLl9ldmVudCwgW1siSGVhZGVyIiwgY2hhdC5PTklNUE9SVCwgIm1lbnUiXSwgY2FuLl9uYW1lXS5jb25jYXQobGlzdCksIGNiKQoJCX0sCgkJc2V0Uml2ZXI6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGNhbi5zZXQoIlJpdmVyIiwga2V5LCB2YWx1ZSkgfSwKCQlzZXRIZWFkZXI6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGNhbi5zZXQoIkhlYWRlciIsIGtleSwgdmFsdWUpIH0sCgkJZ2V0SGVhZGVyOiBmdW5jdGlvbihrZXksIGNiKSB7IHJldHVybiBjYW4uZ2V0KCJIZWFkZXIiLCBrZXksIGNiKSB9LAoJCWdldEFjdGlvbjogZnVuY3Rpb24oa2V5LCBjYikgeyByZXR1cm4gY2FuLmdldCgiQWN0aW9uIiwga2V5LCBjYikgfSwKCQlnZXRBY3Rpb25TaXplOiBmdW5jdGlvbihjYikgeyByZXR1cm4gY2FuLmdldCgiQWN0aW9uIiwgInNpemUiLCBjYikgfSwKCgkJcnVuQWN0aW9uOiBmdW5jdGlvbihldmVudCwgYWN0aW9uLCBhcmdzLCBjYikgewoJCQljYW4ucmVxdWVzdChldmVudCwge19oYW5kbGU6IGljZS5UUlVFfSwgY2FuLk9wdGlvbigpKQoJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgYWN0aW9uXSwgYXJncyksIGNifHxmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4sIGFjdGlvbikKCQkJfSwgdHJ1ZSkKCQl9LAoKCQlDb25mSGVpZ2h0OiBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gY2FuLkNvbmYoaHRtbC5IRUlHSFQsIHZhbHVlKSB9LAoJCUNvbmZXaWR0aDogZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIGNhbi5Db25mKGh0bWwuV0lEVEgsIHZhbHVlKSB9LAoJCUNvbmY6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgdmFyIHJlcyA9IGNhbi5fY29uZgoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgKz0gMikgewoJCQkJaWYgKHR5cGVvZiBrZXkgPT0gbGFuZy5PQkpFQ1QpIHsKCQkJCQlyZXMgPSBjYW4uY29yZS5WYWx1ZShjYW4uX2NvbmYsIGFyZ3VtZW50c1tpXSksIGktLQoJCQkJCWNvbnRpbnVlCgkJCQl9CgkJCQlyZXMgPSBjYW4uY29yZS5WYWx1ZShjYW4uX2NvbmYsIGFyZ3VtZW50c1tpXSwgYXJndW1lbnRzW2krMV0pCgkJCX0KCQkJaWYgKHJlcyA9PSB1bmRlZmluZWQgJiYga2V5LmluZGV4T2YoImZlYXR1cmUuIikgPT0gLTEpIHsKCQkJCXJldHVybiBjYW4uQ29uZihjYW4uY29yZS5LZXlzKCJmZWF0dXJlIiwga2V5KSkKCQkJfQoJCQlyZXR1cm4gcmVzCgkJfSwgX2NvbmY6IHt9LAoJfQoKCWNhbiA9IGNhbnx8e30sIGNhbi5fX3Byb3RvX18gPSBwcm90bwoKCWlmIChfY2FuX25hbWUpIHsgLy8g5Yqg5YWl57yT5a2YCgkJbWV0YS5jYWNoZVtfY2FuX25hbWVdID0gbWV0YS5jYWNoZVtfY2FuX25hbWVdfHxbXSwgbWV0YS5jYWNoZVtfY2FuX25hbWVdLnB1c2goY2FuKQoJfSBlbHNlIHsgLy8g5Yqg5YWl6Zif5YiXCgkJbGlzdC5wdXNoKGNhbikKCX0KCglpZiAoY2FuLl9mb2xsb3cpIHsgbGlicyA9IGxpYnMuY29uY2F0KG1ldGEubGlicywgbWV0YS52b2xjYW5vKSB9CglpZiAobGlicyAmJiBsaWJzLmxlbmd0aCA+IDApIHsKCQlmb3IgKHZhciBpID0gMDsgaSA8IGxpYnMubGVuZ3RoOyBpKyspIHsKCQkJaWYgKGxpYnNbaV0gPT0gdW5kZWZpbmVkKSB7CgoJCQl9IGVsc2UgaWYgKGxpYnNbaV0gPT0gIiIpIHsKCQkJCWxpYnNbaV0gPSBfY2FuX3BhdGgucmVwbGFjZSgiLmpzIiwgIi5jc3MiKQoJCQl9IGVsc2UgaWYgKGxpYnNbaV1bMF0gIT0gaWNlLlBTICYmIGxpYnNbaV0uaW5kZXhPZihpY2UuSFRUUCkgIT0gMCkgewoJCQkJbGlic1tpXSA9IF9jYW5fcGF0aC5zbGljZSgwLCBfY2FuX3BhdGgubGFzdEluZGV4T2YoaWNlLlBTKSsxKStsaWJzW2ldCgkJCX0KCQl9Cgl9CglyZXR1cm4gY2FuLnJlcXVpcmUobGlicywgY2IpLCBjYW4KfSkKVm9sY2Fub3MubWV0YS5fbG9hZCA9IGZ1bmN0aW9uKHVybCwgY2IpIHsKCXN3aXRjaCAodXJsLnNwbGl0KCI/IilbMF0uc3BsaXQoaWNlLlBUKS5wb3AoKS50b0xvd2VyQ2FzZSgpKSB7CgkJY2FzZSBuZnMuQ1NTOgoJCQl2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobWRiLkxJTkspCgkJCWl0ZW0ucmVsID0gInN0eWxlc2hlZXQiLCBpdGVtLnR5cGUgPSAidGV4dC9jc3MiCgkJCWl0ZW0uaHJlZiA9IHVybCwgaXRlbS5vbmxvYWQgPSBjYgoJCQlyZXR1cm4gKGRvY3VtZW50LmhlYWR8fGRvY3VtZW50LmJvZHkpLmFwcGVuZENoaWxkKGl0ZW0pLCBpdGVtCgkJY2FzZSBuZnMuSlM6CgkJCXZhciBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuZnMuU0NSSVBUKQoJCQlpdGVtLnNyYyA9IHVybCwgaXRlbS5vbmxvYWQgPSBjYiwgaXRlbS5vbmVycm9yID0gY2IKCQkJcmV0dXJuIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaXRlbSksIGl0ZW0KCX0KfQpmdW5jdGlvbiBjYW4odG9vbCkgewoJVm9sY2Fub3Moe25hbWU6ICJjaGF0IiwgcGFuZWxzOiBbCgkJe25hbWU6ICJIZWFkZXIiLCBoZWxwOiAi5qCH6aKY5qCPIiwgcG9zOiBjaGF0LkhJREUsIHN0YXRlOiBbInRpbWUiLCAidXNlcm5pY2siLCAiYXZhdGFyIl19LAoJCXtuYW1lOiAiQWN0aW9uIiwgaGVscDogIuW3peS9nOWPsCIsIHBvczogY2hhdC5NQUlOLCB0b29sOiB0b29sfSwKCQl7bmFtZTogIlNlYXJjaCIsIGhlbHA6ICLmkJzntKLmoYYiLCBwb3M6IGNoYXQuQVVUT30sCgldfSkKfQpmdW5jdGlvbiBfY2FuKHRvb2wpIHsKCVZvbGNhbm9zKHtuYW1lOiAiY2hhdCIsIHBhbmVsczogW3tuYW1lOiAiQWN0aW9uIiwgaGVscDogIuW3peS9nOWPsCIsIHBvczogY2hhdC5NQUlOLCB0b29sOiB0b29sfV19KQp9Cgp0cnkgeyBpZiAodHlwZW9mKGdsb2JhbCkgPT0gbGFuZy5PQkpFQ1QpIHsKCWdsb2JhbC5raXQgPSBraXQsIGdsb2JhbC5pY2UgPSBpY2UKCWdsb2JhbC5jdHggPSBjdHgsIGdsb2JhbC5jbGkgPSBjbGksIGdsb2JhbC53ZWIgPSB3ZWIsIGdsb2JhbC5hYWEgPSBhYWEKCWdsb2JhbC5tZGIgPSBtZGIsIGdsb2JhbC5zc2ggPSBzc2gsIGdsb2JhbC5uZnMgPSBuZnMsIGdsb2JhbC50Y3AgPSB0Y3AKCWdsb2JhbC5jb2RlID0gY29kZSwgZ2xvYmFsLndpa2kgPSB3aWtpLCBnbG9iYWwuY2hhdCA9IGNoYXQsIGdsb2JhbC50ZWFtID0gdGVhbSwgZ2xvYmFsLm1hbGwgPSBtYWxsCglnbG9iYWwuc3ZnID0gc3ZnLCBnbG9iYWwuaHRtbCA9IGh0bWwsIGdsb2JhbC5sYW5nID0gbGFuZwoJZ2xvYmFsLnNoeSA9IHNoeSwgZ2xvYmFsLlZvbGNhbm9zID0gVm9sY2Fub3MKCglWb2xjYW5vcy5tZXRhLl9sb2FkID0gZnVuY3Rpb24odXJsLCBjYikgewoJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IGlmIChWb2xjYW5vcy5tZXRhLmNhY2hlW3VybF0pIHsgcmV0dXJuIGNiKFZvbGNhbm9zLm1ldGEuY2FjaGVbdXJsXSkgfQoJCQlzd2l0Y2ggKHVybC5zcGxpdCgiPyIpWzBdLnNwbGl0KGljZS5QVCkucG9wKCkudG9Mb3dlckNhc2UoKSkgewoJCQkJY2FzZSBuZnMuSlM6IHJlcXVpcmUoX2Nhbl9uYW1lID0gdXJsKSwgY2IoVm9sY2Fub3MubWV0YS5jYWNoZVt1cmxdKTsgYnJlYWsKCQkJfQoJCX0sIDEwMCkKCX0KCglWb2xjYW5vcy5tZXRhLl9sb2FkKGdsb2JhbC5wbHVnaW4sIGZ1bmN0aW9uKGNhY2hlKSB7CgkJVm9sY2Fub3MubWV0YS52b2xjYW5vID0gIi4vZnJhbWUuanMiLCBWb2xjYW5vcyh7bGliczogWwoJCQkiLi9saWIvYmFzZS5qcyIsICIuL2xpYi9jb3JlLmpzIiwgIi4vbGliL21pc2MuanMiLCAiLi9saWIvcGFnZS5qcyIsIC8vICIuL2xpYi91c2VyLmpzIiwKCQldLCBwYW5lbHM6IFtdLCBwbHVnaW46IFtdfSwgZnVuY3Rpb24oY2FuKSB7IGNhbi5jb3JlLkxpc3QoY2FjaGUsIGZ1bmN0aW9uKGl0ZW0pIHsgY2FuW2l0ZW0uX25hbWVdID0gaXRlbSB9KQoJCQlWb2xjYW5vcy5tZXRhLl9sb2FkKCIuL3B1Ymxpc2gvY2xpZW50L25vZGVqcy9wcm90by5qcyIsIGZ1bmN0aW9uKGNhY2hlKSB7CgkJCQljYW4uY29yZS5MaXN0KGNhY2hlLCBmdW5jdGlvbihpdGVtKSB7IGNhbi5iYXNlLkNvcHkoY2FuW2l0ZW0uX25hbWVdfHx7fSwgaXRlbSkgfSkKCQkJCWNhbi5vbmltcG9ydC5faW5pdChjYW4sIGNhbi5yZXF1ZXN0KCksIGZ1bmN0aW9uKG1zZykgeyBjb25zb2xlLmxvZyhpY2UuTkwpIH0sIG51bGwpCgkJCX0pCgkJfSkKCX0pCn0gZWxzZSB7CglWb2xjYW5vcy5tZXRhLnRhcmdldCA9IGRvY3VtZW50LmJvZHkKfSB9IGNhdGNoIChlKSB7IGNvbnNvbGUubG9nKGUpIH0K",
        "/frame.js": "Vm9sY2Fub3MoIm9uZW5naW5lIiwge2hlbHA6ICLmkJzntKLlvJXmk44iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgbGlzdCwgY2IsIHRhcmdldCkgewoJCWNhbi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KTsgY21kcyA9IGNtZHN8fFtdCgkJCXJldHVybiAoY2FuLm9uZW5naW5lW2NtZHNbMF1dfHxjYW4ub25lbmdpbmUuX3JlbW90ZSkoZXZlbnQsIGNhbiwgbXNnLCBjYW4sIGNtZHMsIGNiKQoJCX0KCgkJaWYgKGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5NU0dfU0VTU0lEKSkgewoJCQljYW4ubWlzYy5Db29raWVTZXNzaWQoY2FuLCBjYW4ubWlzYy5TZWFyY2goY2FuLCBpY2UuTVNHX1NFU1NJRCkpCgkJCXJldHVybiBjYW4ubWlzYy5TZWFyY2goY2FuLCBpY2UuTVNHX1NFU1NJRCwgIiIpIAoJCX0KCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBodG1sLklGUkFNRSwgZnVuY3Rpb24oaXRlbSkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBpdGVtKSB9KQoJCWlmIChjYW4udXNlci5pc0V4dGVuc2lvbikgeyBWb2xjYW5vcy5tZXRhLmFyZ3MgPSBjYW4uYmFzZS5PYmoobG9jYWxTdG9yYWdlLmdldEl0ZW0oY3R4LkFSR1MpLCB7fSkgfQoKCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgY2hhdC5PTlNFQVJDSCwgZnVuY3Rpb24obXNnLCB3b3JkKSB7IGlmICh3b3JkWzBdID09IGN0eC5DT01NQU5EIHx8IHdvcmRbMV0gIT0gIiIpIHsgdmFyIG1ldGEgPSBjYW4ub25lbmdpbmUucGx1Z2luLm1ldGEKCQkJdmFyIGxpc3QgPSB3b3JkWzFdID09ICIiPyBtZXRhOiBtZXRhW3dvcmRbMV1dPyBraXQuRGljdCh3b3JkWzFdLCBtZXRhW3dvcmRbMV1dKToge30KCQkJY2FuLmNvcmUuSXRlbShsaXN0LCBmdW5jdGlvbihuYW1lLCBjb21tYW5kKSB7IG5hbWUgPSBjYW4uYmFzZS50cmltUHJlZml4KG5hbWUsICJjYW4uIikKCQkJCWNhbi5jb3JlLkxpc3QobXNnLk9wdGlvbihpY2UuTVNHX0ZJRUxEUykuc3BsaXQoaWNlLkZTKSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCW1zZy5QdXNoKGl0ZW0sIGtpdC5EaWN0KGljZS5DVFgsICJvbmVuZ2luZSIsIGljZS5DTUQsICJjb21tYW5kIiwKCQkJCQkJbWRiLlRZUEUsICJjYW4iLCBtZGIuTkFNRSwgbmFtZSwgbWRiLlRFWFQsIGNvbW1hbmQuaGVscCwKCQkJCQkJY3R4LkNPTlRFWFQsICJjYW4iLCBjdHguQ09NTUFORCwgbmFtZQoJCQkJCSlbaXRlbV18fCIiKQoJCQkJfSkKCQkJfSkKCQl9IH0pCgoJCWNhbi5jb3JlLk5leHQobGlzdCwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgeyBpdGVtLnR5cGUgPSBjaGF0LlBBTkVMCgkJCWNhbi5vbmFwcGVuZC5faW5pdChjYW4sIGNhbi5iYXNlLkNvcHkoaXRlbSwgY2FuLmNvcmUuVmFsdWUoY2FuLl9yb290LCBbY2hhdC5SSVZFUiwgaXRlbS5uYW1lXSkpLCBpdGVtLmxpc3QsIGZ1bmN0aW9uKHBhbmVsKSB7CgkJCQlwYW5lbC5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IHBhbmVsLnJlcXVlc3QoZXZlbnQpOyBjbWRzID0gY21kc3x8W10KCQkJCQlyZXR1cm4gKGNhbi5vbmVuZ2luZVtjbWRzWzBdXXx8Y2FuLm9uZW5naW5lLl9yZW1vdGUpKGV2ZW50LCBjYW4sIG1zZywgcGFuZWwsIGNtZHMsIGNiKQoJCQkJfSwgY2FuW2l0ZW0ubmFtZV0gPSBwYW5lbCwgcGFuZWwuX3Jvb3QgPSBjYW4sIHBhbmVsLl90cmFucyA9IHBhbmVsLm9uYWN0aW9uICYmIHBhbmVsLm9uYWN0aW9uLl90cmFuc3x8e30KCgkJCQljYW4uY29yZS5JdGVtQ0IocGFuZWwub25hY3Rpb24sIGZ1bmN0aW9uKGtleSwgY2IpIHsKCQkJCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwga2V5LCBmdW5jdGlvbihtc2cpIHsgY2FuLmNvcmUuQ2FsbEZ1bmMoY2IsIHtjYW46IHBhbmVsLCBtc2c6IG1zZ30pIH0pCgkJCQl9KSwgY2FuLmNvcmUuQ2FsbEZ1bmMoW3BhbmVsLm9uYWN0aW9uLCAiX2luaXQiXSwge2NhbjogcGFuZWwsIGNiOiBuZXh0LCB0YXJnZXQ6IHBhbmVsLl90YXJnZXR9KQoJCQl9LCB0YXJnZXQpCgkJfSwgZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZyhjYW4udXNlci50aXRsZSgpLCBpY2UuUlVOLCBjYW4pCgkJCWNhbi5yZXF1aXJlKFtjYW4udm9sY2Fub10sIG51bGwsIGZ1bmN0aW9uKGNhbiwgbmFtZSwgc3ViKSB7IGNhbltuYW1lXSA9IHN1YiB9KQoJCQljYW4ub25sYXlvdXQudG9waWMoY2FuKSwgY2FuLm9ubW90aW9uLl9pbml0KGNhbiwgdGFyZ2V0KSwgY2FuLm9ua2V5bWFwLl9pbml0KGNhbikKCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNoYXQuT05NQUlOLCBjYW4ucmVxdWVzdCgpKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgkJfSkKCX0sCglfc2VhcmNoOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikgewoJCXZhciBzdWIsIG1vZCA9IGNhbiwgZnVuID0gY2FuLCBrZXkgPSAiIjsgY2FuLmNvcmUuTGlzdChjbWRzWzFdLnNwbGl0KGljZS5QVCksIGZ1bmN0aW9uKHZhbHVlKSB7CgkJCWZ1biAmJiAoc3ViID0gbW9kLCBtb2QgPSBmdW4sIGZ1biA9IG1vZFt2YWx1ZV0sIGtleSA9IHZhbHVlKQoJCX0pOyBpZiAoIXN1YiB8fCAhbW9kIHx8ICFmdW4pIHsgY2FuLm1pc2MuV2FybihpY2UuRXJyTm90Rm91bmQsIGNtZHMpCgkJCXJldHVybiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZy5FY2hvKGljZS5FcnJXYXJuLCBpY2UuRXJyTm90Rm91bmQsIGNtZHMpKQoJCX0KCgkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKGZ1biwgewoJCQlldmVudDogZXZlbnQsIGNhbjogc3ViLCBtc2c6IG1zZywgY21kczogY21kcy5zbGljZSgyKSwgY2I6IGNiLCB0YXJnZXQ6IHN1Yi5fdGFyZ2V0LAoJCQlidXR0b246IGtleSwgY21kOiBrZXksIGFyZzogY21kcy5zbGljZSgyKSwgbGlzdDogY21kcy5zbGljZSgyKSwKCQl9LCBtb2QpCgl9LAoJX2VuZ2luZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbXNnLCBwYW5lbCwgY21kcywgY2IpIHsgcmV0dXJuIGZhbHNlIH0sCglfcGx1Z2luOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikgewoJCWlmIChjbWRzWzBdID09IGN0eC5BQ1RJT04gJiYgY21kc1sxXSA9PSBpY2UuUlVOICYmIGNhbi5vbmVuZ2luZS5wbHVnaW4ubWV0YVtjbWRzWzJdXSkgewoJCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2NtZHNbMl1dLCB7bXNnOiBtc2csIGNtZHM6IGNtZHMuc2xpY2UoMyksIGNiOiBjYn0pLCB0cnVlCgkJfQoJCXZhciBwID0gY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2NtZHNbMF1dOyBpZiAocCkgewoJCQlpZiAocC5tZXRhICYmIHAubWV0YVtjbWRzWzFdXSAmJiBjbWRzWzBdID09IGN0eC5BQ1RJT04pIHsKCQkJCXJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhwLm1ldGFbY21kc1sxXV0sIHtjYW46IGNhbiwgbXNnOiBtc2csIGNtZHM6IGNtZHMuc2xpY2UoMyksIGNiOiBjYn0pLCB0cnVlCgkJCX0gZWxzZSBpZiAocC5tZXRhICYmIHAubWV0YVtjbWRzWzBdXSkgewoJCQkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKHAubWV0YVtjbWRzWzBdXSwge2NhbjogY2FuLCBtc2c6IG1zZywgY21kczogY21kcy5zbGljZSgyKSwgY2I6IGNifSksIHRydWUKCQkJfQoJCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMocCwge2NhbjogY2FuLCBtc2c6IG1zZywgY21kczogY21kcy5zbGljZSgxKSwgY2I6IGNifSksIHRydWUKCQl9CgkJcmV0dXJuIGZhbHNlCgl9LAoJX3JlbW90ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbXNnLCBwYW5lbCwgY21kcywgY2IpIHsKCQltc2cub3B0aW9uID0gY2FuLmNvcmUuTGlzdChtc2cub3B0aW9uLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiB7X3RvYXN0OiB0cnVlLCBfaGFuZGxlOiB0cnVlfVtpdGVtXSAmJiBkZWxldGUobXNnW2l0ZW1dKT8gdW5kZWZpbmVkOiBpdGVtCgkJfSkKCgkJaWYgKHBhbmVsLm9uZW5naW5lLl9lbmdpbmUoZXZlbnQsIGNhbiwgbXNnLCBwYW5lbCwgY21kcywgY2IpKSB7IHJldHVybiB9CgkJaWYgKHBhbmVsLm9uZW5naW5lLl9wbHVnaW4oZXZlbnQsIGNhbiwgbXNnLCBwYW5lbCwgY21kcywgY2IpKSB7IHJldHVybiB9CgoJCXZhciBrZXkgPSBjYW4uY29yZS5LZXlzKHBhbmVsLl9uYW1lLCBjbWRzLmpvaW4oaWNlLkZTKSkKCQlpZiAoY2FuLnVzZXIuaXNMb2NhbEZpbGUpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KTsgbXNnLkNsZWFyKGljZS5NU0dfQVBQRU5EKQoJCQl2YXIgcmVzID0gVm9sY2Fub3MubWV0YS5wYWNrW2tleV07IHJlcz8gbXNnLkNvcHkocmVzKTogY2FuLnVzZXIudG9hc3QoY2FuLCAi57y65aSx5pWw5o2uIikKCQkJcmV0dXJuIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCX0KCgkJdmFyIHRvYXN0OyBpZiAobXNnLk9wdGlvbigiX3RvYXN0IikpIHsgY2FuLmNvcmUuVGltZXIoMTAwMCwgZnVuY3Rpb24oKSB7CgkJCXRvYXN0ID0gdG9hc3R8fGNhbi51c2VyLnRvYXN0KGNhbiwgbXNnLk9wdGlvbigiX3RvYXN0IiksIG1zZy5fY2FuLl9uYW1lLCAtMSkKCQl9KSB9CgkJdmFyIG5hbWVzID0gbXNnLk9wdGlvbigiX25hbWVzIil8fHBhbmVsLl9uYW1lc3x8KChjYW4uQ29uZigiaWNlYmVyZyIpfHwiL2NoYXQvIikrcGFuZWwuX25hbWUpCgkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNoYXQuT05SRU1PVEUsIGNhbi5yZXF1ZXN0KHt9LCB7X2ZvbGxvdzogcGFuZWwuX2ZvbGxvdywgX21zZzogbXNnLCBfY21kczogY21kc30pKQoJCWNhbi5taXNjLlJ1bihldmVudCwgY2FuLCB7bmFtZXM6IG5hbWVzLCBkYWVtb246IGNhbi5jb3JlLktleXMoY2FuLm9uZGFlbW9uLl9saXN0WzBdLCBtc2cuX2RhZW1vbil9LCBjbWRzLCBmdW5jdGlvbihtc2cpIHsKCQkJVm9sY2Fub3MubWV0YS5wYWNrW2tleV0gPSBtc2csIGRlbGV0ZShtc2cuX2hhbmRsZSksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQl0b2FzdCAmJiB0b2FzdC5jbG9zZSgpLCB0b2FzdCA9IHRydWUsIGRlbGV0ZShtc2cuX3RvYXN0KQoJCX0pCgl9LAoKCXBsdWdpbjogc2h5KCLmt7vliqDmj5Lku7YiLCB7fSwgW10sIGZ1bmN0aW9uKGNhbiwgbmFtZSwgY29tbWFuZCkgeyBuYW1lID0gY2FuLmJhc2UudHJpbVByZWZpeChuYW1lLCAiY2FuLiIpCgkJdmFyIHR5cGUgPSBodG1sLlRFWFQ7IGNvbW1hbmQubGlzdCA9IGNhbi5jb3JlLkxpc3QoY29tbWFuZC5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCXN3aXRjaCAodHlwZW9mIGl0ZW0pIHsKCQkJCWNhc2UgbGFuZy5TVFJJTkc6IHJldHVybiBjYW4uY29yZS5TcGxpdElucHV0KGl0ZW0pCgkJCQljYXNlIGxhbmcuT0JKRUNUOiByZXR1cm4gdHlwZSA9IGl0ZW0udHlwZXx8dHlwZSwgaXRlbQoJCQl9CgkJfSksIGFyZ3VtZW50cy5jYWxsZWUubWV0YVtjYW4uY29yZS5LZXlzKCJjYW4iLCBuYW1lKV0gPSBjb21tYW5kCgl9KSwKCWxpc3Rlbjogc2h5KCLnm5HlkKzkuovku7YiLCB7fSwgW10sIGZ1bmN0aW9uKGNhbiwgbmFtZSwgY2IpIHsgYXJndW1lbnRzLmNhbGxlZS5tZXRhW25hbWVdID0gKGFyZ3VtZW50cy5jYWxsZWUubWV0YVtuYW1lXXx8W10pLmNvbmNhdChjYikgfSksCglzaWduYWw6IHNoeSgi6Kem5Y+R5LqL5Lu2IiwgZnVuY3Rpb24oY2FuLCBuYW1lLCBtc2cpIHsgbXNnID0gbXNnfHxjYW4ucmVxdWVzdCgpCgkJY2FuLm1pc2MuTG9nKGdkYi5TSUdOQUwsIG5hbWUsIG5hbWUgPT0gY2hhdC5PTlJFTU9URT8gbXNnLk9wdGlvbigiX21zZyIpOiBtc2cpCgkJcmV0dXJuIGNhbi5jb3JlLkxpc3QoY2FuLm9uZW5naW5lLmxpc3Rlbi5tZXRhW25hbWVdLCBmdW5jdGlvbihjYikgeyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2V2ZW50OiBtc2cuX2V2ZW50LCBtc2c6IG1zZ30pIH0pLmxlbmd0aAoJfSksCn0pClZvbGNhbm9zKCJvbmRhZW1vbiIsIHtoZWxwOiAi5o6o6I2Q5byV5pOOIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG5hbWUpIHsgaWYgKGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJY2FuLm1pc2MuV1NTKGNhbiwge3R5cGU6IGh0bWwuQ0hST01FLCBuYW1lOiBjYW4ubWlzYy5TZWFyY2goY2FuLCBjbGkuREFFTU9OKXx8bmFtZXx8IiJ9LCBmdW5jdGlvbihldmVudCwgbXNnLCBjbWQsIGFyZykgeyBpZiAoIW1zZykgeyByZXR1cm4gfQoJCQl2YXIgc3ViID0gY2FuLm9uZGFlbW9uLl9saXN0W21zZy5PcHRpb24oaWNlLk1TR19UQVJHRVQpXQoJCQljYW4uYmFzZS5pc0Z1bmMoY2FuLm9uZGFlbW9uW2NtZF0pPyBjYW4uY29yZS5DYWxsRnVuYyhjYW4ub25kYWVtb25bY21kXSwgewoJCQkJY2FuOiBjYW4sIHN1Yjogc3ViLCBtc2c6IG1zZywgY21kOiBjbWQsIGFyZzogYXJnLCBjYjogZnVuY3Rpb24oKSB7IG1zZy5SZXBseSgpIH0sCgkJCX0pOiBjYW4ub25lbmdpbmUuX3NlYXJjaCh7fSwgY2FuLCBtc2csIGNhbiwgWyJfc2VhcmNoIiwgY21kXS5jb25jYXQoYXJnKSwgZnVuY3Rpb24oKSB7IG1zZy5SZXBseSgpIH0pCgkJfSkKCX0sIF9saXN0OiBbIiJdLAoJcmVmcmVzaDogZnVuY3Rpb24oY2FuLCBtc2csIHN1YikgeyBzdWIuVXBkYXRlKCkgfSwKCXB3ZDogZnVuY3Rpb24oY2FuLCBtc2csIGFyZykgeyBjYW4ub25kYWVtb24uX2xpc3RbMF0gPSBhcmdbMF0gfSwKCWdyb3c6IGZ1bmN0aW9uKGNhbiwgbXNnLCBzdWIsIGFyZykgeyBzdWIub25pbXBvcnQuX2dyb3coc3ViLCBjYW4ucGFnZS5Db2xvcihhcmcuam9pbigiIikpKSB9LAoJdG9hc3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCBhcmcpIHsgY2FuLmNvcmUuQ2FsbEZ1bmMoY2FuLnVzZXIudG9hc3QsIHtjYW46IGNhbiwgbXNnOiBtc2csIGNtZHM6IGFyZ30pIH0sCn0pClZvbGNhbm9zKCJvbmFwcGVuZCIsIHtoZWxwOiAi5riy5p+T5byV5pOOIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1ldGEsIGxpc3QsIGNiLCB0YXJnZXQsIGZpZWxkKSB7CgkJbWV0YS5uYW1lID0gKG1ldGEubmFtZXx8IiIpLnNwbGl0KGljZS5TUClbMF0uc3BsaXQoaWNlLlBUKS5wb3AoKQoJCWZpZWxkID0gZmllbGR8fGNhbi5vbmFwcGVuZC5maWVsZChjYW4sIG1ldGEudHlwZSwgbWV0YSwgdGFyZ2V0KS5maXJzdAoJCXZhciBsZWdlbmQgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBmaWVsZCwgaHRtbC5MRUdFTkQpWzBdCgkJdmFyIG9wdGlvbiA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkZPUk1fT1BUSU9OKVswXQoJCXZhciBhY3Rpb24gPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBmaWVsZCwgaHRtbC5ESVZfQUNUSU9OKVswXQoJCXZhciBvdXRwdXQgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBmaWVsZCwgaHRtbC5ESVZfT1VUUFVUKVswXQoJCXZhciBzdGF0dXMgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBmaWVsZCwgaHRtbC5ESVZfU1RBVFVTKVswXQoKCQl2YXIgc3ViID0gVm9sY2Fub3MobWV0YS5uYW1lLCB7X2ZvbGxvdzogY2FuLmNvcmUuS2V5cyhjYW4uX2ZvbGxvdywgbWV0YS5uYW1lKSwgX3RhcmdldDogZmllbGQsCgkJCV9sZWdlbmQ6IGxlZ2VuZCwgX29wdGlvbjogb3B0aW9uLCBfYWN0aW9uOiBhY3Rpb24sIF9vdXRwdXQ6IG91dHB1dCwgX3N0YXR1czogc3RhdHVzLAoJCQlfaW5wdXRzOiB7fSwgX291dHB1dHM6IFtdLCBfaGlzdG9yeTogW10sCgoJCQlTdGF0dXM6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKCQkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7IHJldHVybiBjYW4uY29yZS5JdGVtKGtleSwgc3ViLlN0YXR1cyksIGtleSB9CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBzdGF0dXMsIFtbW2h0bWwuRElWLCBrZXldLCBodG1sLlNQQU5dXSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCXJldHVybiB2YWx1ZSA9PSB1bmRlZmluZWQ/ICh2YWx1ZSA9IGl0ZW0uaW5uZXJIVE1MKTogKGl0ZW0uaW5uZXJIVE1MID0gdmFsdWUpCgkJCQl9KTsgcmV0dXJuIHZhbHVlCgkJCX0sCgkJCUFjdGlvbjogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4gY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGFjdGlvbiwga2V5LCB2YWx1ZSlbMF0gfSwKCQkJT3B0aW9uOiBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiBjYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgb3B0aW9uLCBrZXksIHZhbHVlKVswXSB9LAoJCQlVcGRhdGU6IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYiwgc2lsZW50KSB7IHN1Yi5vbmFwcGVuZC5fb3V0cHV0MChzdWIsIHN1Yi5Db25mKCksIGV2ZW50fHx7fSwgY21kc3x8c3ViLklucHV0KCksIGNiLCBzaWxlbnQpOyByZXR1cm4gdHJ1ZSB9LAoJCQlGb2N1czogZnVuY3Rpb24oKSB7IGNhbi5wYWdlLlNlbGVjdChjYW4sIG9wdGlvbiwgaHRtbC5JTlBVVF9BUkdTLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgeyBpbmRleCA9PSAwICYmIGl0ZW0uZm9jdXMoKSB9KSB9LAoJCQlJbnB1dDogZnVuY3Rpb24oY21kcywgc2lsZW50KSB7CgkJCQljbWRzID0gY21kcyAmJiBjbWRzLmxlbmd0aCA+IDA/IGNtZHM6IGNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBvcHRpb24sICIiKS5jb25jYXQoY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGFjdGlvbiwgIiIpKSwgY21kcyA9IGNhbi5iYXNlLnRyaW0oY21kcykKCQkJCXNpbGVudCB8fCBjbWRzWzBdID09IGN0eC5BQ1RJT04gfHwgY2FuLmJhc2UuRXEoc3ViLl9oaXN0b3J5W3N1Yi5faGlzdG9yeS5sZW5ndGgtMV0sIGNtZHMpIHx8IHN1Yi5faGlzdG9yeS5wdXNoKGNtZHMpCgkJCQlyZXR1cm4gY21kcwoJCQl9LAoJCQlDbG9uZTogZnVuY3Rpb24oKSB7IG1ldGEuYXJncyA9IGNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBvcHRpb24sICIiKQoJCQkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgbWV0YSwgbGlzdCwgZnVuY3Rpb24oc3ViKSB7IGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViLCB0cnVlKQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgZm9yICh2YXIgayBpbiBzdWIuX2lucHV0cykgeyBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBzdWIuX2lucHV0c1trXS5fdGFyZ2V0KTsgYnJlYWsgfSB9KQoJCQkJfSwgdGFyZ2V0KQoJCQl9LAoJCX0sIGxpc3QsIGZ1bmN0aW9uKHN1YikgeyBzdWIuQ29uZihtZXRhKSwgbWV0YS5mZWF0dXJlID0gY2FuLmJhc2UuT2JqKG1ldGEuZmVhdHVyZSwge30pCgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBmaWVsZCwgbWV0YS5pbmRleD8gbWV0YS5pbmRleC5zcGxpdChpY2UuUFQpLnBvcCgpOiBtZXRhLm5hbWUpCgkJCXZhciBzdHlsZSA9IGNhbi5iYXNlLmdldFZhbGlkKG1ldGEuc3R5bGUsIG1ldGEuZmVhdHVyZS5zdHlsZSk7IHN3aXRjaCAodHlwZW9mIHN0eWxlKSB7CgkJCQljYXNlIGxhbmcuU1RSSU5HOiBjYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgZmllbGQsIHN0eWxlKTsgYnJlYWsKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6IGNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl90YXJnZXQsIHN0eWxlKTsgYnJlYWsKCQkJfQoKCQkJbWV0YS5pbnB1dHMgJiYgc3ViLm9uYXBwZW5kLl9vcHRpb24oc3ViLCBtZXRhLCBzdWIuX29wdGlvbiwgbWV0YS5tc2cpCgkJCWlmIChtZXRhLm1zZykgeyB2YXIgbXNnID0gc3ViLnJlcXVlc3QoKTsgbXNnLkNvcHkoY2FuLmJhc2UuT2JqKG1ldGEubXNnKSksIHN1Yi5vbmFwcGVuZC5fb3V0cHV0KHN1YiwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSl8fG1ldGEuZmVhdHVyZS5kaXNwbGF5KSB9CgoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBzdWIuX2xlZ2VuZCwga2l0LkRpY3QoY2FuLkNvbmYoImxlZ2VuZF9ldmVudCIpfHwib25tb3VzZWVudGVyIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi51c2VyLmNhcnRlKGV2ZW50LCBzdWIsIHN1Yi5vbmFjdGlvbiwgc3ViLm9uYWN0aW9uLmxpc3QuY29uY2F0KFtbIuaJgOaciSJdLmNvbmNhdChjYW4uY29yZS5JdGVtKG1ldGEuZmVhdHVyZS5fdHJhbnMpKV0pLCBmdW5jdGlvbihldmVudCwgaXRlbSwgbWV0YSkgewoJCQkJCXZhciBjYiA9IGNhbi5jb3JlLlZhbHVlKHN1YiwgWyJfb3V0cHV0cy4tMS5vbmFjdGlvbiIsIGl0ZW1dKQoJCQkJCWlmIChjYW4uYmFzZS5pc0Z1bmMoY2IpKSB7IHJldHVybiBjYihldmVudCwgY2FuLmNvcmUuVmFsdWUoc3ViLCAiX291dHB1dHMuLTEiKSwgaXRlbSkgfQoJCQkJCXZhciBjYiA9IG1ldGFbaXRlbV18fG1ldGFbIl9lbmdpbmUiXQoJCQkJCWlmIChjYW4uYmFzZS5pc0Z1bmMoY2IpKSB7IHJldHVybiBjYihldmVudCwgc3ViLCBpdGVtKSB9CgkJCQl9KQoJCQl9KSksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJCX0pOyByZXR1cm4gc3ViCgl9LAoJX29wdGlvbjogZnVuY3Rpb24oY2FuLCBtZXRhLCBvcHRpb24sIHNraXApIHsgbWV0YSA9IG1ldGF8fHt9OyB2YXIgaW5kZXggPSAtMSwgYXJncyA9IGNhbi5iYXNlLk9iaihtZXRhLmFyZ3N8fG1ldGEuYXJnfHxtZXRhLm9wdCwgW10pLCBvcHRzID0gY2FuLmJhc2UuT2JqKG1ldGEub3B0cywge30pCgkJZnVuY3Rpb24gYWRkKGl0ZW0sIG5leHQpIHsgaXRlbSA9IGNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pPyB7dHlwZTogaHRtbC5URVhULCBuYW1lOiBpdGVtfTogaXRlbSwgaXRlbS50eXBlICE9IGh0bWwuQlVUVE9OICYmIGluZGV4KysKCQkJcmV0dXJuIFZvbGNhbm9zKGl0ZW0ubmFtZSwge19mb2xsb3c6IGNhbi5jb3JlLktleXMoY2FuLl9mb2xsb3csIGl0ZW0ubmFtZSksCgkJCQlfdGFyZ2V0OiBjYW4ub25hcHBlbmQuaW5wdXQoY2FuLCBpdGVtLCBhcmdzW2luZGV4XXx8b3B0c1tpdGVtLm5hbWVdLCBvcHRpb258fGNhbi5fb3B0aW9uKSwKCQkJCV9vcHRpb246IG9wdGlvbnx8Y2FuLl9vcHRpb24sIF9hY3Rpb246IGNhbi5fYWN0aW9uLCBfb3V0cHV0OiBjYW4uX291dHB1dCwgX3N0YXR1czogY2FuLl9zdGF0dXMsCgkJCQlPcHRpb246IGNhbi5PcHRpb24sIEFjdGlvbjogY2FuLkFjdGlvbiwgU3RhdHVzOiBjYW4uU3RhdHVzLCBDbG9uZUZpZWxkOiBjYW4uQ2xvbmUsCgkJCQlDbG9uZUlucHV0OiBmdW5jdGlvbigpIHsgY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgYWRkKGl0ZW0pLl90YXJnZXQpIH0sCgkJCX0sIFtpdGVtLmRpc3BsYXksIGNoYXQuUExVR0lOX0lOUFVUX0pTXSwgZnVuY3Rpb24oaW5wdXQpIHsgaW5wdXQuQ29uZihpdGVtKQoJCQkJaW5wdXQucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiLCBzaWxlbnQpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQkJCWlmIChpdGVtLl9jYikgeyByZXR1cm4gaXRlbS5fY2IoZXZlbnQpIH0KCQkJCQlpZiAobXNnLlJ1bkFjdGlvbihldmVudCwgY2FuLmNvcmUuVmFsdWUoY2FuLCAiX291dHB1dHMuLTEiKSwgY21kcykpIHsgcmV0dXJuIH0KCQkJCQlpZiAobXNnLlJ1bkFjdGlvbihldmVudCwgaW5wdXQsIGNtZHMpKSB7IHJldHVybiB9CgkJCQkJcmV0dXJuIGNhbi5VcGRhdGUoZXZlbnQsIGNhbi5JbnB1dChjbWRzLCBzaWxlbnQpLCBjYiwgc2lsZW50KQoJCQkJfSwgY2FuLl9pbnB1dHNbaXRlbS5uYW1lXSA9IGlucHV0LCBpbnB1dC5zdXAgPSBjYW4KCgkJCQljYW4uY29yZS5JdGVtQ0IoaW5wdXQub25hY3Rpb24sIGZ1bmN0aW9uKGtleSwgY2IpIHsgaW5wdXQuX3RhcmdldFtrZXldID0gZnVuY3Rpb24oZXZlbnQpIHsgY2IoZXZlbnQsIGlucHV0KSB9IH0pCgkJCQljYW4uY29yZS5JdGVtQ0IoaXRlbSwgZnVuY3Rpb24oa2V5LCBjYikgeyBpbnB1dC5fdGFyZ2V0W2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgaW5wdXQpIH0gfSkKCQkJCXNraXA/IG5leHQoKTogY2FuLmNvcmUuQ2FsbEZ1bmMoW2lucHV0Lm9uYWN0aW9uLCAiX2luaXQiXSwgW2lucHV0LCBpdGVtLCBuZXh0LCBpbnB1dC5fdGFyZ2V0XSk7CgkJCQkoaXRlbS5hY3Rpb258fGNhbi5jb3JlLlZhbHVlKG1ldGEsIFtjdHguRkVBVFVSRSwgY3R4LklOUFVUU10pKSAmJiBjYW4ub25hcHBlbmQuZmlndXJlKGlucHV0LCBpdGVtLCBpbnB1dC5fdGFyZ2V0KQoJCQl9KQoJCX07IGNhbi5jb3JlLk5leHQoY2FuLmJhc2UuT2JqKG1ldGEuaW5wdXRzLCBjYW4uY29yZS5WYWx1ZShjYW4sIFtjaGF0Lk9OSU1QT1JULCBtZGIuTElTVF0pKS5jb25jYXQobWV0YS50eXBlID09IGNoYXQuRkxPQVQ/IFt7dHlwZTogaHRtbC5CVVRUT04sIG5hbWU6IGNsaS5DTE9TRX1dOiBbXSksIGFkZCkKCX0sCglfYWN0aW9uOiBmdW5jdGlvbihjYW4sIGxpc3QsIGFjdGlvbiwgbWV0YSkgewoJCWxpc3QgPSBjYW4uYmFzZS5nZXRWYWxpZChsaXN0LCBjYW4uY29yZS5JdGVtKG1ldGEpKQoJCWxpc3QgPSBjYW4uYmFzZS5PYmoobGlzdCwgY2FuLmNvcmUuVmFsdWUoY2FuLCBbY2hhdC5PTkFDVElPTiwgbWRiLkxJU1RdKSkKCQl2YXIgX2xpc3QgPSBbXTsgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7CgkJCXN3aXRjaCAobGlzdFtpXSkgeyBjYXNlICIiOiBfbGlzdC5wdXNoKCIiKTsgYnJlYWsKCQkJCWNhc2UgbWRiLlBBR0U6CgkJCQkJX2xpc3QucHVzaCh7dHlwZTogaHRtbC5URVhULCBuYW1lOiBtZGIuTElNSVQsIHZhbHVlOiBjYW4uX21zZy5PcHRpb24obWRiLkxJTUlUKX0pCgkJCQkJX2xpc3QucHVzaCh7dHlwZTogaHRtbC5URVhULCBuYW1lOiBtZGIuT0ZGRU5ELCB2YWx1ZTogY2FuLl9tc2cuT3B0aW9uKG1kYi5PRkZFTkQpfSkKCQkJCQlfbGlzdC5wdXNoKG1kYi5QUkVWLCBtZGIuTkVYVCkKCQkJCQlicmVhawoJCQkJZGVmYXVsdDoKCQkJCQkoZnVuY3Rpb24oKSB7CgkJCQkJCXZhciBpdGVtID0gY2FuLmNvcmUuU3BsaXRJbnB1dChsaXN0W2ldLCBodG1sLkJVVFRPTik7CgkJCQkJCWlmIChpdGVtLnR5cGUgPT0gaHRtbC5TRUxFQ1QpIHsKCQkJCQkJCWl0ZW0uX2luaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsKCQkJCQkJCQl0YXJnZXQudmFsdWUgPSBpdGVtLnZhbHVlfHxpdGVtLnZhbHVlc1swXQoJCQkJCQkJCXRhcmdldC5vbmNoYW5nZSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5ydW4oZXZlbnQpIH0KCQkJCQkJCX0KCQkJCQkJfQoJCQkJCQlpdGVtLmFjdGlvbiAmJiAoZnVuY3Rpb24oKSB7CgkJCQkJCQlpdGVtLl9pbml0ID0gZnVuY3Rpb24odGFyZ2V0KSB7IGNhbi5vbmFwcGVuZC5maWd1cmUoY2FuLCBpdGVtLCB0YXJnZXQpIH0KCQkJCQkJfSkoKSwgaXRlbS50eXBlID09IGh0bWwuQlVUVE9OPyBfbGlzdC5wdXNoKGxpc3RbaV0pOiBfbGlzdC5wdXNoKGl0ZW0pCgkJCQkJfSkgKCkKCQkJfQoJCX0KCQltZXRhID0gbWV0YXx8Y2FuLm9uYWN0aW9uLCBhY3Rpb24gPSBhY3Rpb258fGNhbi5fYWN0aW9uLCBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBhY3Rpb24pCgkJcmV0dXJuIGNhbi5jb3JlLkxpc3QoX2xpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsgaWYgKGl0ZW0gPT0gdW5kZWZpbmVkKSB7IHJldHVybiB9IGNhbi5vbmFwcGVuZC5pbnB1dChjYW4sIGl0ZW0gPT0gIiI/IC8q56m655m9Ki8ge3R5cGU6IGh0bWwuU1BBQ0V9OgoJCQljYW4uYmFzZS5pc1N0cmluZyhpdGVtKT8gLyrmjInplK4qLyB7dHlwZTogaHRtbC5CVVRUT04sIHZhbHVlOiBjYW4udXNlci50cmFucyhjYW4sIGl0ZW0pLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJdmFyIGNiID0gbWV0YVtpdGVtXXx8bWV0YVsiX2VuZ2luZSJdOyBjYj8gY2FuLmNvcmUuQ2FsbEZ1bmMoY2IsIHtldmVudDogZXZlbnQsIGNhbjogY2FuLCBidXR0b246IGl0ZW19KTogY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGl0ZW1dLmNvbmNhdChjYW4uc3VwLklucHV0KCkpKQoKCQkJfSwgb25rZXlkb3duOiBmdW5jdGlvbihldmVudCkgewoJCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVOVEVSKSB7CgkJCQkJdmFyIGNiID0gbWV0YVtpdGVtXXx8bWV0YVsiX2VuZ2luZSJdOyBjYj8gY2FuLmNvcmUuQ2FsbEZ1bmMoY2IsIHtldmVudDogZXZlbnQsIGNhbjogY2FuLCBidXR0b246IGl0ZW19KTogY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGl0ZW1dLmNvbmNhdChjYW4uc3VwLklucHV0KCkpKQoJCQkJfQoKCQkJfX06IGl0ZW0ubGVuZ3RoID4gMD8gLyrliJfooagqLyB7dHlwZTogaHRtbC5TRUxFQ1QsIG5hbWU6IGl0ZW1bMF0sIHZhbHVlczogaXRlbS5zbGljZSgxKSwgb25jaGFuZ2U6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl2YXIgd2hpY2ggPSBpdGVtW2V2ZW50LnRhcmdldC5zZWxlY3RlZEluZGV4KzFdCgkJCQljYW4uY29yZS5DYWxsRnVuYyhtZXRhW3doaWNoXSwgW2V2ZW50LCBjYW4sIHdoaWNoXSkKCQkJCWNhbi5jb3JlLkNhbGxGdW5jKG1ldGFbaXRlbVswXV0sIFtldmVudCwgY2FuLCBpdGVtWzBdLCB3aGljaF0pCgoJCQl9fTogLyrlhbblroMqLyBpdGVtLCAiIiwgYWN0aW9uKX0pLCBtZXRhCgl9LAoJX291dHB1dDA6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgZXZlbnQsIGNtZHMsIGNiLCBzaWxlbnQpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KTsgaWYgKG1zZy5SdW5BY3Rpb24oZXZlbnQsIGNhbiwgY21kcykpIHsgcmV0dXJuIH0KCQlpZiAobXNnLk9wdGlvbihpY2UuTVNHX0hBTkRMRSkgIT0gaWNlLlRSVUUgJiYgY21kcyAmJiBjbWRzWzBdID09IGN0eC5BQ1RJT04gJiYgbWV0YS5mZWF0dXJlW2NtZHNbMV1dKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge2FjdGlvbjogY21kc1sxXX0pCgkJCWlmIChjYW4uYmFzZS5pc0Z1bmMobWV0YS5mZWF0dXJlW2NtZHNbMV1dKSkgeyByZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMobWV0YS5mZWF0dXJlW2NtZHNbMV1dLCB7Y2FuOiBjYW4sIG1zZzogbXNnLCBjbWRzOiBjbWRzLnNsaWNlKDIpfSkgfQoJCQlyZXR1cm4gY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgbWV0YS5mZWF0dXJlW2NtZHNbMV1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge19oYW5kbGU6IGljZS5UUlVFfSwgY2FuLk9wdGlvbigpKQoJCQkJY2FuLlVwZGF0ZShldmVudCwgY21kcy5zbGljZSgwLCAyKS5jb25jYXQoYXJncyksIGNifHxmdW5jdGlvbigpIHsKCQkJCQlpZiAoY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5zdXAsIGNoYXQuT05JTVBPUlQsIGljZS5NU0dfUFJPQ0VTU10sIHtjYW46IGNhbi5zdXAsIG1zZzogbXNnfSkpIHsgcmV0dXJuIH0KCQkJCQlpZiAoY2FuLmNvcmUuQ2FsbEZ1bmMoW2NhbiwgY2hhdC5PTklNUE9SVCwgaWNlLk1TR19QUk9DRVNTXSwge2NhbjogY2FuLCBtc2c6IG1zZ30pKSB7IHJldHVybiB9CgkJCQkJaWYgKG1zZy5SZXN1bHQoKS5sZW5ndGggPiAwIHx8IG1zZy5MZW5ndGgoKSA+IDApIHsKCQkJCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCQkJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLlVwZGF0ZSgpCgkJCQkJfQoJCQkJfSwgdHJ1ZSkKCQkJfSkKCQl9CgoJCWlmIChjYW4uYmFzZS5pc1VuZGVmaW5lZChtc2cuX2RhZW1vbikpIHsKCQkJY2FuLmJhc2UuaXNVbmRlZmluZWQoY2FuLl9kYWVtb24pICYmIGNhbi5vbmRhZW1vbi5fbGlzdFswXSAmJiAoY2FuLl9kYWVtb24gPSBjYW4ub25kYWVtb24uX2xpc3QucHVzaChjYW4pLTEpCgkJCWlmIChjYW4uX2RhZW1vbikgeyBtc2cuT3B0aW9uKGljZS5NU0dfREFFTU9OLCBjYW4uY29yZS5LZXlzKGNhbi5vbmRhZW1vbi5fbGlzdFswXSwgY2FuLl9kYWVtb24pKSB9CgkJfQoJCWlmIChtZXRhICYmIG1ldGEuaW5kZXggJiYgbWV0YS5pbmRleC5pbmRleE9mKCJjYW4uIikgPT0gMCkgewoJCQljYW4ub25lbmdpbmUuX3BsdWdpbihldmVudCwgY2FuLCBtc2csIGNhbiwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW21ldGEuaW5kZXhdLCBjbWRzKSwgZnVuY3Rpb24obXNnKSB7CgkJCQlpZiAoY2FuLmJhc2UuaXNGdW5jKGNiKSkgeyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2NhbjogY2FuLCBtc2c6IG1zZ30pOyByZXR1cm4gfQoJCQkJIXNpbGVudCAmJiBjYW4ub25hcHBlbmQuX291dHB1dChjYW4sIG1zZywgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVkpfHxtZXRhLmRpc3BsYXl8fG1ldGEuZmVhdHVyZS5kaXNwbGF5KQoJCQl9KQoJCQlyZXR1cm4KCQl9CgoJCXJldHVybiBjYW4ucnVuKGV2ZW50LCBjbWRzLCBmdW5jdGlvbihtc2cpIHsgdmFyIHN1YiA9IGNhbi5jb3JlLlZhbHVlKGNhbiwgIl9vdXRwdXRzLi0xIil8fHt9OyBjYW4uX21zZyA9IG1zZywgc3ViLl9tc2cgPSBtc2cKCQkJaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikpIHsgY2FuLmNvcmUuQ2FsbEZ1bmMoY2IsIHtjYW46IGNhbiwgbXNnOiBtc2d9KTsgcmV0dXJuIH0KCQkJdmFyIHByb2Nlc3MgPSBtc2cuX2NhbiA9PSBjYW4gfHwgbXNnLl9jYW4gPT0gc3ViCgkJCWlmIChwcm9jZXNzICYmIGNhbi5jb3JlLkNhbGxGdW5jKFtzdWIsIGNoYXQuT05JTVBPUlQsIGljZS5NU0dfUFJPQ0VTU10sIHtjYW46IHN1YiwgbXNnOiBtc2d9KSkgeyByZXR1cm4gfQoJCQlpZiAocHJvY2VzcyAmJiBjYW4uY29yZS5DYWxsRnVuYyhbY2FuLCBjaGF0Lk9OSU1QT1JULCBpY2UuTVNHX1BST0NFU1NdLCB7Y2FuOiBjYW4sIG1zZzogbXNnfSkpIHsgcmV0dXJuIH0KCQkJIXNpbGVudCAmJiBjYW4ub25hcHBlbmQuX291dHB1dChjYW4sIG1zZywgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVkpfHxtZXRhLmRpc3BsYXl8fG1ldGEuZmVhdHVyZS5kaXNwbGF5KQoJCX0pCgl9LAoJX291dHB1dDogZnVuY3Rpb24oY2FuLCBtc2csIGRpc3BsYXksIG91dHB1dCwgYWN0aW9uLCBjYikgeyBkaXNwbGF5ID0gZGlzcGxheXx8Y2hhdC5QTFVHSU5fVEFCTEVfSlMsIG91dHB1dCA9IG91dHB1dHx8Y2FuLl9vdXRwdXQKCQlWb2xjYW5vcyhkaXNwbGF5LCB7X2ZvbGxvdzogY2FuLmNvcmUuS2V5cyhjYW4uX2ZvbGxvdywgZGlzcGxheSksIF9kaXNwbGF5OiBkaXNwbGF5LCBfdGFyZ2V0OiBvdXRwdXQsIF9maWVsZHM6IGNhbi5fdGFyZ2V0LAoJCQlfb3B0aW9uOiBjYW4uX29wdGlvbiwgX2FjdGlvbjogY2FuLl9hY3Rpb24sIF9vdXRwdXQ6IGNhbi5fb3V0cHV0LCBfc3RhdHVzOiBjYW4uX3N0YXR1cywgX2xlZ2VuZDogY2FuLl9sZWdlbmQsIF9pbnB1dHM6IHt9LAoJCQlVcGRhdGU6IGNhbi5VcGRhdGUsIE9wdGlvbjogY2FuLk9wdGlvbiwgQWN0aW9uOiBjYW4uQWN0aW9uLCBTdGF0dXM6IGNhbi5TdGF0dXMsCgkJfSwgW2Rpc3BsYXksIGNoYXQuUExVR0lOX1RBQkxFX0pTXSwgZnVuY3Rpb24odGFibGUpIHsgdGFibGUuQ29uZihjYW4uQ29uZigpKQoJCQl0YWJsZS5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpCgkJCQlpZiAobXNnLlJ1bkFjdGlvbihldmVudCwgdGFibGUsIGNtZHMpKSB7IHJldHVybiB9CgkJCQlyZXR1cm4gY2FuLlVwZGF0ZShldmVudCwgY2FuLklucHV0KGNtZHMsIHNpbGVudCksIGNiLCBzaWxlbnQpCgkJCX0sIGNhbi5fb3V0cHV0cyAmJiBjYW4uX291dHB1dHMucHVzaCh0YWJsZSksIHRhYmxlLnN1cCA9IGNhbiwgdGFibGUuX21zZyA9IG1zZwoKCQkJaWYgKGNhbi5Db25mKGN0eC5JTkRFWCkgPT0gImNhbi5jb2RlLmlubmVyLnBsdWdpbiIgJiYgdGFibGUub25pbXBvcnQgJiYgdGFibGUub25pbXBvcnQubGlzdC5sZW5ndGggPiAwKSB7CgkJCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uX29wdGlvbiksIGNhbi5vbmFwcGVuZC5fb3B0aW9uKGNhbiwge2lucHV0czogdGFibGUub25pbXBvcnQubGlzdH0pCgkJCX0KCgkJCXRhYmxlLl9hcmdzID0gY2FuLmJhc2UuUGFyc2VVUkwodGFibGUuX2Rpc3BsYXkpCgkJCXRhYmxlLl90cmFucyA9IGNhbi5iYXNlLkNvcHkodGFibGUuX3RyYW5zfHx7fSwgY2FuLmNvcmUuVmFsdWUodGFibGUsICJvbmFjdGlvbi5fdHJhbnMiKSkKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW3RhYmxlLCBjaGF0Lk9OSU1QT1JULCAiX2luaXQiXSwge2NhbjogdGFibGUsIG1zZzogbXNnLCBsaXN0OiBtc2cucmVzdWx0fHxtc2cuYXBwZW5kfHxbXSwgY2I6IGZ1bmN0aW9uKG1zZykgewoJCQkJYWN0aW9uID09PSBmYWxzZSB8fCB0YWJsZS5vbmFwcGVuZC5fYWN0aW9uKHRhYmxlLCBtc2cuT3B0aW9uKGljZS5NU0dfQUNUSU9OKXx8Y2FuLkNvbmYoaWNlLk1TR19BQ1RJT04pLCBhY3Rpb24pCgkJCQlhY3Rpb24gPT09IGZhbHNlIHx8IHRhYmxlLm9uYXBwZW5kLl9zdGF0dXModGFibGUsIG1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMpKQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJCX0sIHRhcmdldDogb3V0cHV0fHxjYW4uX291dHB1dH0pCgkJfSkKCX0sCglfc3RhdHVzOiBmdW5jdGlvbihjYW4sIGxpc3QsIHN0YXR1cykgeyBzdGF0dXMgPSBzdGF0dXN8fGNhbi5fc3RhdHVzLCBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBzdGF0dXMpCgkJY2FuLmNvcmUuTGlzdChjYW4uYmFzZS5PYmoobGlzdCwgY2FuLmNvcmUuVmFsdWUoY2FuLCBbY2hhdC5PTkVYUE9SVCwgbWRiLkxJU1RdKSksIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbSA9IGNhbi5iYXNlLmlzT2JqZWN0KGl0ZW0pPyBpdGVtOiB7bmFtZTogaXRlbX0KCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgc3RhdHVzLCBbe3ZpZXc6IGNhbi5iYXNlLmpvaW4oW2h0bWwuSVRFTSwgaXRlbS5uYW1lXSksIHRpdGxlOiBpdGVtLm5hbWUsIGxpc3Q6IFsKCQkJCXt0ZXh0OiBbaXRlbS5uYW1lLCBodG1sLkxBQkVMXX0sIHt0ZXh0OiBbIjogIiwgaHRtbC5MQUJFTF19LCB7dGV4dDogWyhpdGVtLnZhbHVlfHwiIikrIiIsIGh0bWwuU1BBTiwgaXRlbS5uYW1lXX0sCgkJCV0sIH1dKQoJCX0pCgl9LAoKCXRhYnM6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgY2IsIGNicywgYWN0aW9uLCBlYWNoKSB7IGFjdGlvbiA9IGFjdGlvbnx8Y2FuLl9hY3Rpb24KCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgYWN0aW9uLCBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKG1ldGEpIHsKCQkJcmV0dXJuIHt0ZXh0OiBbbWV0YS5uYW1lLCBodG1sLkRJViwgaHRtbC5UQUJTXSwgdGl0bGU6IG1ldGEudGV4dCwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBhY3Rpb24sICJkaXYudGFicyIsIGV2ZW50LnRhcmdldCkKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIG1ldGEpCgkJCX0sIF9pbml0OiBmdW5jdGlvbihpdGVtKSB7IGNvbnN0IE9WRVIgPSAib3ZlciIKCQkJCWZ1bmN0aW9uIGNsb3NlKGl0ZW0pIHsgdmFyIG5leHQgPSBpdGVtLm5leHRTaWJsaW5nfHxpdGVtLnByZXZpb3VzU2libGluZwoJCQkJCWl0ZW0uX2Nsb3NlKGl0ZW0pIHx8IGNhbi5wYWdlLlJlbW92ZShjYW4sIGl0ZW0pLCBuZXh0ICYmIG5leHQuY2xpY2soKQoJCQkJfQoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgaXRlbSwge2RyYWdnYWJsZTogdHJ1ZSwgX2Nsb3NlOiBjYnMsCgkJCQkJb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQljYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBraXQuRGljdCgKCQkJCQkJCSJjbG9zZSB0YWIiLCBmdW5jdGlvbihldmVudCkgeyBjbG9zZShpdGVtKSB9LAoJCQkJCQkJImNsb3NlIG90aGVyIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBhY3Rpb24sIGh0bWwuRElWX1RBQlMsIGZ1bmN0aW9uKF9pdGVtKSB7IF9pdGVtID09IGl0ZW0gfHwgY2xvc2UoX2l0ZW0pIH0pCgkJCQkJCQl9LAoJCQkJCQkJImNsb3NlIGFsbCIsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5wYWdlLlNlbGVjdChjYW4sIGFjdGlvbiwgaHRtbC5ESVZfVEFCUywgY2xvc2UpIH0KCQkJCQkJKSwgWyJjbG9zZSB0YWIiLCAiY2xvc2Ugb3RoZXIiLCAiY2xvc2UgYWxsIl0pCgkJCQkJfSwKCQkJCQlvbmRyYWdzdGFydDogZnVuY3Rpb24oZXZlbnQpIHsgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDsgdGFyZ2V0LmNsaWNrKCkKCQkJCQkJYWN0aW9uLl9kcm9wID0gZnVuY3Rpb24oZXZlbnQsIGJlZm9yZSkgeyBhY3Rpb24uaW5zZXJ0QmVmb3JlKHRhcmdldCwgYmVmb3JlKSB9CgkJCQkJfSwKCQkJCQlvbmRyYWdvdmVyOiBmdW5jdGlvbihldmVudCkgeyBldmVudC5wcmV2ZW50RGVmYXVsdCgpLCBhY3Rpb24uX2Ryb3AoZXZlbnQsIGV2ZW50LnRhcmdldCkgfSwKCQkJCQlvbmRyb3A6IGZ1bmN0aW9uKGV2ZW50KSB7IGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGFjdGlvbi5fZHJvcChldmVudCwgZXZlbnQudGFyZ2V0KSB9LAoJCQkJfSksIGNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgaXRlbS5jbGljaygpIH0pCgkJCQljYW4uYmFzZS5pc0Z1bmMoZWFjaCkgJiYgZWFjaChpdGVtKQoJCQl9fQoJCX0pKS5maXJzdAoJfSwKCWxpc3Q6IGZ1bmN0aW9uKGNhbiwgcm9vdCwgY2IsIHRhcmdldCkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi5fb3V0cHV0CgkJY2FuLmNvcmUuTGlzdChyb290Lmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtodG1sLklURU0sIGh0bWwuRElWLCBpdGVtLm1ldGEubmFtZV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50LCBpdGVtKSB8fCBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgdWkubGlzdCkKCQkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuRElWX0lURU0sIGV2ZW50LnRhcmdldCkKCQkJfX0sIHt2aWV3OiBodG1sLkxJU1R9XSk7IGNhbi5vbmFwcGVuZC5saXN0KGNhbiwgaXRlbSwgY2IsIHVpLmxpc3QpCgkJfSkKCX0sCglpdGVtOiBmdW5jdGlvbihjYW4sIHR5cGUsIGl0ZW0sIGNiLCBjYnMsIHRhcmdldCkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi5fb3V0cHV0CgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFt0eXBlLCBodG1sLkRJViwgaXRlbS5uaWNrfHxpdGVtLm5hbWVdLAoJCQlvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgdWkuZmlyc3QpCgkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgdGFyZ2V0LCBjYW4uY29yZS5LZXlzKGh0bWwuRElWLCB0eXBlKSwgdWkuZmlyc3QpCgkJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsgY2JzKGV2ZW50LCB1aS5maXJzdCkgfSwKCQl9XSk7IHJldHVybiB1aS5maXJzdAoJfSwKCXRyZWU6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgZmllbGQsIHNwbGl0LCBjYiwgdGFyZ2V0LCBub2RlKSB7CgkJbm9kZSA9IG5vZGV8fHsiIjogdGFyZ2V0fTsgY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW1bZmllbGRdICYmIGNhbi5jb3JlLkxpc3QoaXRlbVtmaWVsZF0uc3BsaXQoc3BsaXQpLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGFycmF5KSB7IGlmICghdmFsdWUpIHsgcmV0dXJuIH0KCQkJCXZhciBsYXN0ID0gYXJyYXkuc2xpY2UoMCwgaW5kZXgpLmpvaW4oc3BsaXQpLCBuYW1lID0gYXJyYXkuc2xpY2UoMCwgaW5kZXgrMSkuam9pbihzcGxpdCkKCQkJCWlmIChub2RlW25hbWVdKSB7IHJldHVybiB9CgkJCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBub2RlW2xhc3RdLCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogW3t2aWV3OiBbInN3aXRjaCIsICJkaXYiLCAoaW5kZXg9PWFycmF5Lmxlbmd0aC0xPyIiOiImIzg5NjM7IildfSwge3ZpZXc6IFsibmFtZSIsIGh0bWwuRElWLCB2YWx1ZSsoaW5kZXg9PWFycmF5Lmxlbmd0aC0xPyIiOiIiKV19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlpbmRleCA8IGFycmF5Lmxlbmd0aCAtIDE/IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBub2RlW25hbWVdLCBmdW5jdGlvbigpIHsKCQkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHVpWyJzd2l0Y2giXSwgIm9wZW4iKQoJCQkJCX0sIGZ1bmN0aW9uKCkgewoJCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuZGVsKGNhbiwgdWlbInN3aXRjaCJdLCAib3BlbiIpCgkJCQkJfSk6IGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGl0ZW0pCgkJCQkJaWYgKG5vZGVbbmFtZV0uY2hpbGRFbGVtZW50Q291bnQgPT0gMikgeyBub2RlW25hbWVdLmZpcnN0Q2hpbGQuY2xpY2soKSB9CgkJCQl9fSwge3ZpZXc6IGh0bWwuTElTVCwgc3R5bGU6IHtkaXNwbGF5OiBodG1sLk5PTkV9LCBfaW5pdDogZnVuY3Rpb24obGlzdCkgeyBpdGVtLmV4cGFuZCAmJiBjYW4ucGFnZS5zdHlsZShjYW4sIGxpc3QsIGh0bWwuRElTUExBWSwgaHRtbC5CTE9DSykgfX1dKQoJCQkJbm9kZVtuYW1lXSA9IHVpLmxpc3QKCQkJfSkKCQl9KTsgcmV0dXJuIG5vZGUKCX0sCglmaWVsZDogZnVuY3Rpb24oY2FuLCB0eXBlLCBpdGVtLCB0YXJnZXQpIHsgdHlwZSA9IHR5cGV8fGh0bWwuUExVR0lOLCBpdGVtID0gaXRlbXx8e30KCQl2YXIgbmFtZSA9IChpdGVtLm5pY2t8fGl0ZW0ubmFtZXx8IiIpLnNwbGl0KGljZS5TUClbMF0KCQl2YXIgdGl0bGUgPSAhaXRlbS5oZWxwIHx8IGNhbi51c2VyLmxhbmd1YWdlKGNhbikgPT0gImVuIj8gbmFtZTogbmFtZSsiKCIraXRlbS5oZWxwLnNwbGl0KGljZS5TUClbMF0rIikiCgkJcmV0dXJuIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldHx8Y2FuLl9vdXRwdXQsIFt7dmlldzogW2Nhbi5iYXNlLmpvaW4oW3R5cGV8fCIiLCBpdGVtLm5hbWV8fCIiLCBpdGVtLnBvc3x8IiJdKSwgaHRtbC5GSUVMRFNFVF0sIGxpc3Q6IFsKCQkJbmFtZSAmJiB7dGV4dDogW3RpdGxlLCBodG1sLkxFR0VORF19LCB7dmlldzogW2h0bWwuT1BUSU9OLCBodG1sLkZPUk1dfSwge3ZpZXc6IFtodG1sLkFDVElPTl19LCB7dmlldzogW2h0bWwuT1VUUFVUXX0sIHt2aWV3OiBbaHRtbC5TVEFUVVNdfSwKCQldfV0pCgl9LAoJaW5wdXQ6IGZ1bmN0aW9uKGNhbiwgaXRlbSwgdmFsdWUsIHRhcmdldCwgc3R5bGUpIHsKCQlzd2l0Y2ggKGl0ZW0udHlwZSkgewoJCQljYXNlICIiOiByZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbaXRlbV0pCgkJCWNhc2UgaHRtbC5TUEFDRTogcmV0dXJuIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBjYW4uYmFzZS5qb2luKFtodG1sLklURU0sIGh0bWwuU1BBQ0VdKX1dKQoJCX0KCgkJdmFyIGlucHV0ID0gY2FuLnBhZ2UuaW5wdXQoY2FuLCBpdGVtLCB2YWx1ZSkKCQl2YXIgYnIgPSBpbnB1dC50eXBlID09IGh0bWwuVEVYVEFSRUE/IFt7dHlwZTogaHRtbC5CUiwgc3R5bGU6IHtjbGVhcjogaHRtbC5CT1RIfX1dOiBbXQoJCXZhciB0aXRsZSA9IGNhbi5Db25mKFtjdHguRkVBVFVSRSwgY2hhdC5USVRMRSwgaXRlbS5uYW1lXS5qb2luKGljZS5QVCkpfHwiIjsgdGl0bGUgJiYgKGlucHV0LnRpdGxlID0gdGl0bGUpCgkJcmV0dXJuIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgKFt7dmlldzogc3R5bGV8fGNhbi5iYXNlLmpvaW4oW2h0bWwuSVRFTSwgaXRlbS50eXBlXSksIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJaXRlbS50eXBlID09IGh0bWwuVEVYVEFSRUEgJiYgZXZlbnQua2V5ID09IGxhbmcuVEFCICAmJiBjYW4ub25rZXltYXAuaW5zZXJ0VGV4dChldmVudC50YXJnZXQsICJcdCIpCgkJCWl0ZW0udHlwZSA9PSBodG1sLlRFWFQgJiYgY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pLCBjYW4ub25tb3Rpb24uc2VsZWN0RmllbGQoZXZlbnQsIGNhbikKCQl9LCBsaXN0OiBbaW5wdXRdfV0pLmNvbmNhdChicikpW2l0ZW0ubmFtZV0KCX0sCgl0YWJsZTogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQsIHNvcnQpIHsgaWYgKG1zZy5MZW5ndGgoKSA9PSAwKSB7IHJldHVybiB9CgkJdmFyIHRhYmxlID0gY2FuLnBhZ2UuQXBwZW5kVGFibGUoY2FuLCBtc2csIHRhcmdldHx8Y2FuLl9vdXRwdXQsIG1zZy5hcHBlbmQsIGNifHxmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgYXJyYXkpIHsKCQkJaWYgKG1zZy5hcHBlbmQubGVuZ3RoID09IDIgJiYgbXNnLmFwcGVuZFswXSA9PSBtZGIuS0VZICYmIG1zZy5hcHBlbmRbMV0gPT0gbWRiLlZBTFVFKSB7CgkJCQlpZiAoa2V5ID09IG1kYi5WQUxVRSkgeyBrZXkgPSBsaW5lLmtleSB9CgkJCQlsaW5lID0ge30sIGNhbi5jb3JlLkxpc3QoYXJyYXksIGZ1bmN0aW9uKGl0ZW0pIHsgbGluZVtpdGVtLmtleV0gPSBpdGVtLnZhbHVlIH0pCgkJCX0KCgkJCWlmIChrZXkgPT0gImV4dHJhLmNtZCIpIHsKCQkJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCB7Y3R4OiBsaW5lWyJleHRyYS5jdHgiXSwgY21kOiBsaW5lWyJleHRyYS5jbWQiXSwgYXJnOiBsaW5lWyJleHRyYS5hcmciXX0sIGZ1bmN0aW9uKHN1YikgewoJCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCBsaW5lLCBjYW4uT3B0aW9uKCkpCgkJCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBjYW4uY29yZS5LZXlzKGxpbmVbImV4dHJhLmN0eCJdLCBsaW5lWyJleHRyYS5jbWQiXSldLCBjbWRzKSwgY2IsIHRydWUpCgkJCQkJfQoJCQkJfSwgdGFyZ2V0fHxjYW4uX291dHB1dCkKCQkJfQoKCQkJZnVuY3Rpb24gcnVuKGNtZHMpIHsgdmFyIG1zZyA9IGNhbi5zdXAucmVxdWVzdChldmVudCwgbGluZSwgY2FuLk9wdGlvbigpKQoJCQkJcmV0dXJuIGNhbi5ydW4oZXZlbnQsIGNtZHMsIGZ1bmN0aW9uKG1zZykgewoJCQkJCWlmIChjYW4uY29yZS5DYWxsRnVuYyhbY2FuLnN1cCwgY2hhdC5PTklNUE9SVCwgaWNlLk1TR19QUk9DRVNTXSwge2NhbjogY2FuLnN1cCwgbXNnOiBtc2d9KSkgeyByZXR1cm4gfQoJCQkJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSkgIT0gIiIpIHsKCQkJCQkJY2FuLm9uYXBwZW5kLl9vdXRwdXQoY2FuLnN1cCwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSkpCgkJCQkJfSBlbHNlIGlmIChtc2cuUmVzdWx0KCkubGVuZ3RoID4gMCB8fCBtc2cuTGVuZ3RoKCkgPiAwKSB7CgkJCQkJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZykKCQkJCQkJY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgbXNnKQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNhbi5VcGRhdGUoKQoJCQkJCX0KCQkJCX0sIHRydWUpCgkJCX0KCgkJCXJldHVybiB7dGV4dDogW3ZhbHVlLCBodG1sLlREXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldAoJCQkJaWYgKHRhcmdldC50YWdOYW1lID09ICJJTlBVVCIgJiYgdGFyZ2V0LnR5cGUgPT0gaHRtbC5CVVRUT04pIHsgcmV0dXJuIHJ1bihbY3R4LkFDVElPTiwgdGFyZ2V0Lm5hbWVdKSB9CgkJCQlpZiAoa2V5ID09IG1kYi5IQVNIICYmIGNhbi51c2VyLm1vZC5pc0RpdikgeyByZXR1cm4gY2FuLnVzZXIuanVtcHMoIi9jaGF0L2Rpdi8iK3ZhbHVlKSB9CgkJCQljYW4uc3VwLm9uYWN0aW9uLmNoYW5nZShldmVudCwgY2FuLnN1cCwga2V5LCBldmVudC50YXJnZXQuaW5uZXJUZXh0KQoKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsgaWYgKFttZGIuS0VZXS5pbmRleE9mKGtleSkgPiAtMSkgeyByZXR1cm4gfQoJCQkJdmFyIGl0ZW0gPSBjYW4uY29yZS5MaXN0KGNhbi5Db25mKCJmZWF0dXJlLmluc2VydCIpLCBmdW5jdGlvbihpdGVtKSB7IGlmIChpdGVtLm5hbWUgPT0ga2V5KSB7IHJldHVybiBpdGVtIH0gfSlbMF18fHtuYW1lOiBrZXksIHZhbHVlOiB2YWx1ZX0KCQkJCWl0ZW0ucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IGNhbi5ydW4oY2FuLnJlcXVlc3QoZXZlbnQsIGxpbmUpLl9ldmVudCwgY21kcywgY2IsIHRydWUpIH0KCQkJCWNhbi5vbm1vdGlvbi5tb2RpZnlzKGNhbiwgZXZlbnQudGFyZ2V0LCBmdW5jdGlvbihldmVudCwgdmFsdWUsIG9sZCkgeyBydW4oW2N0eC5BQ1RJT04sIG1kYi5NT0RJRlksIGtleSwgdmFsdWVdKSB9LCBpdGVtKQoJCQl9fQoJCX0pOyB0YWJsZSAmJiBjYW4ucGFnZS5Nb2RpZnkoY2FuLCB0YWJsZSwge2NsYXNzTmFtZTogY2hhdC5DT05URU5UfSkKCQlpZiAobXNnLmFwcGVuZCAmJiBtc2cuYXBwZW5kW21zZy5hcHBlbmQubGVuZ3RoLTFdID09ICJhY3Rpb24iKSB7IGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YWJsZSwgImFjdGlvbiIpIH0KCQljYW4uX3RhYmxlID0gdGFibGUsIGNhbi5zdXAgJiYgKGNhbi5zdXAuX3RhYmxlID0gdGFibGUpCgkJcmV0dXJuIHNvcnQgJiYgY2FuLnBhZ2UuUmFuZ2VUYWJsZShjYW4sIHRhYmxlLCBzb3J0KSwgdGFibGUKCX0sCglib2FyZDogZnVuY3Rpb24oY2FuLCB0ZXh0LCB0YXJnZXQpIHsgdGV4dCAmJiB0ZXh0LlJlc3VsdCAmJiAodGV4dCA9IHRleHQuUmVzdWx0KCkpOyBpZiAoIXRleHQpIHsgcmV0dXJuIH0KCQl2YXIgY29kZSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldHx8Y2FuLl9vdXRwdXQsIFt7dGV4dDogW2Nhbi5wYWdlLkNvbG9yKHRleHQpLCBodG1sLkRJViwgaHRtbC5DT0RFXX1dKS5jb2RlCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY29kZSwgaHRtbC5JTlBVVF9CVVRUT04sIGZ1bmN0aW9uKHRhcmdldCkgewoJCQl0YXJnZXQub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7IHZhciBtc2cgPSBjYW4uc3VwLnJlcXVlc3QoZXZlbnQsIGNhbi5PcHRpb24oKSkKCQkJCXJldHVybiBjYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgdGFyZ2V0Lm5hbWVdLCBmdW5jdGlvbihtc2cpIHsgY2FuLnJ1bigpIH0sIHRydWUpCgkJCX0KCQl9KQoJCXJldHVybiAoY29kZS5zY3JvbGxCeSAmJiBjb2RlLnNjcm9sbEJ5KDAsIDEwMDAwKSksIGNvZGUKCX0sCglwYXJzZTogZnVuY3Rpb24oY2FuLCBsaXN0LCB0YXJnZXQsIGtleXMsIGRhdGEsIHR5cGUpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX291dHB1dCwgZGF0YSA9IGRhdGF8fHt9CgkJaWYgKCFsaXN0KSB7IHJldHVybiB9IGVsc2UgaWYgKGNhbi5iYXNlLmlzQXJyYXkobGlzdCkpIHsKCQkJcmV0dXJuIGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24obWV0YSwgaW5kZXgpIHsKCQkJCXJldHVybiBjYW4ub25hcHBlbmQucGFyc2UoY2FuLCBtZXRhLCB0YXJnZXQsIGtleXMsIGRhdGEsIHR5cGUpCgkJCX0pCgoJCX0gZWxzZSBpZiAoY2FuLmJhc2UuaXNTdHJpbmcobGlzdCkpIHsKCQkJdmFyIGxzID0gY2FuLmNvcmUuU3BsaXQobGlzdCwgIiIsICI6PUAiKTsgaWYgKGxzLmxlbmd0aCA9PSAxKSB7CgkJCQl2YXIgbWV0YSA9IHR5cGU/IHt0eXBlOiB0eXBlLCBuYW1lOiBsc1swXX06IHt0eXBlOiBsc1swXX0KCQkJfSBlbHNlIHsKCQkJCXZhciBtZXRhID0ge25hbWU6IGxzWzBdfTsgZm9yICh2YXIgaSA9IDE7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgeyBzd2l0Y2ggKGxzW2ldKSB7CgkJCQkJY2FzZSAiOiI6IG1ldGEudHlwZSA9IGxzW2krMV07IGJyZWFrCgkJCQkJY2FzZSAiPSI6IG1ldGEudmFsdWUgPSBsc1tpKzFdOyBicmVhawoJCQkJCWNhc2UgIkAiOiBtZXRhLmFjdGlvbiA9IGxzW2krMV07IGJyZWFrCgkJCQl9IH0KCQkJfQoKCQl9IGVsc2UgaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGxpc3QpKSB7IHZhciBtZXRhID0gbGlzdCB9CgoJCWtleXMgPSBjYW4uY29yZS5LZXlzKGtleXMsIG1ldGEubmFtZXx8bWV0YS50eXBlKSAKCQl2YXIgaXRlbSA9IHt2aWV3OiBtZXRhLnR5cGV9LCBpbml0LCBzdWJ0eXBlOyBzd2l0Y2ggKG1ldGEudHlwZSkgewoJCQljYXNlIGh0bWwuSEVBRDogc3VidHlwZSA9ICJtZW51IiwgZGF0YSA9IHt9CgkJCQlpbml0ID0gZnVuY3Rpb24odGFyZ2V0KSB7IGRhdGEuaGVhZCA9IHRhcmdldAoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YXJnZXQsIGh0bWwuTEFZT1VUKQoJCQkJfQoJCQkJYnJlYWsKCQkJY2FzZSBodG1sLkxFRlQ6IHN1YnR5cGUgPSAiaXRlbSIKCQkJCWluaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsKCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdGFyZ2V0LCBodG1sLkxBWU9VVCkKCQkJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IHZhciBoZWlnaHQgPSB0YXJnZXQucGFyZW50Tm9kZS5vZmZzZXRIZWlnaHQKCQkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LnBhcmVudE5vZGUsIGNhbi5wYWdlLktleXMoaHRtbC5ESVZfTEFZT1VUX0hFQUQsIGh0bWwuRElWX0xBWU9VVF9GT09UKSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCQkJaGVpZ2h0IC09IGl0ZW0ub2Zmc2V0SGVpZ2h0CgkJCQkJCX0pLCBjYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5IRUlHSFQsIGhlaWdodCkKCQkJCQl9KQoJCQkJfQoJCQkJYnJlYWsKCQkJY2FzZSBodG1sLk1BSU46CgkJCQlpbml0ID0gZnVuY3Rpb24odGFyZ2V0KSB7IGRhdGEubWFpbiA9IHRhcmdldAoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YXJnZXQsIGh0bWwuTEFZT1VUKQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgdmFyIGhlaWdodCA9IHRhcmdldC5wYXJlbnROb2RlLm9mZnNldEhlaWdodAoJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQucGFyZW50Tm9kZSwgY2FuLnBhZ2UuS2V5cyhodG1sLkRJVl9MQVlPVVRfSEVBRCwgaHRtbC5ESVZfTEFZT1VUX0ZPT1QpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCQloZWlnaHQgLT0gaXRlbS5vZmZzZXRIZWlnaHQKCQkJCQkJfSksIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkhFSUdIVCwgaGVpZ2h0KQoJCQkJCX0pCgoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7CgkJCQkJCXZhciB3aWR0aCA9IHRhcmdldC5wYXJlbnROb2RlLm9mZnNldFdpZHRoCgkJCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldC5wYXJlbnROb2RlLCBodG1sLkRJVl9MQVlPVVRfTEVGVCwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCQkJd2lkdGggLT0gaXRlbS5vZmZzZXRXaWR0aCsxCgkJCQkJCX0pLCBjYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5XSURUSCwgd2lkdGgpCgkJCQkJfSkKCgkJCQl9CgkJCQlicmVhawoJCQljYXNlIGh0bWwuRk9PVDoKCQkJCWluaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsgZGF0YS5mb290ID0gdGFyZ2V0CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgaHRtbC5MQVlPVVQpCgkJCQl9CgkJCQlicmVhawoJCQljYXNlIGh0bWwuVEFCUzoKCQkJCWl0ZW0ubGlzdCA9IFt7dmlldzogIm5hbWUifSwge3ZpZXc6IGh0bWwuUEFHRX1dLCBpdGVtLl9pbml0ID0gZnVuY3Rpb24oX3RhcmdldCwgdWkpIHsKCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB1aS5wYWdlLCBbe3ZpZXc6IGh0bWwuSU5QVVQsIGxpc3Q6IFt7dHlwZTogaHRtbC5JTlBVVCwgb25rZXl1cDogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgX3RhcmdldCwgW2h0bWwuRElWX1BBR0UsIGh0bWwuRElWX0lURU1dLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCQljYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgaXRlbSwgaHRtbC5ISURFLCBpdGVtLmlubmVyVGV4dC5pbmRleE9mKGV2ZW50LnRhcmdldC52YWx1ZSkgPT0gLTEpCgkJCQkJCX0pCgkJCQkJfX1dfV0pCgkJCQkJY2FuLmNvcmUuTGlzdChtZXRhLmxpc3QsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLm5hbWUsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIGl0ZW0ubmFtZXx8aXRlbV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgX3RhcmdldCwgW1todG1sLkRJVl9QQUdFLCBodG1sLkRJVl9MSVNUXV0sIGluZGV4KQoJCQkJCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIHVpLm5hbWUsIGh0bWwuRElWX0lURU0sIGluZGV4KQoJCQkJCQkJdWkucGFnZS5zY3JvbGxUbygwLCAwKQoJCQkJCQl9fV0pCgkJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLnBhZ2UsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIGl0ZW0ubmFtZV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgZXZlbnQudGFyZ2V0Lm5leHRTaWJsaW5nLCBodG1sLlNFTEVDVCkKCQkJCQkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCB1aS5uYW1lLCBodG1sLkRJVl9JVEVNLCBpbmRleCkKCQkJCQkJfX0sIHt2aWV3OiBbaHRtbC5MSVNUXSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgewoJCQkJCQkJY2FuLm9uYXBwZW5kLnBhcnNlKGNhbiwgaXRlbS5saXN0LCB0YXJnZXQsIGNhbi5jb3JlLktleXMoa2V5cywgaXRlbS5uYW1lKSwgZGF0YSwgaHRtbC5JVEVNKQoJCQkJCQl9fV0pCgkJCQkJfSkKCQkJCQljYW4uY29yZS5UaW1lcigxMDAsIGZ1bmN0aW9uKCkgeyB2YXIgaGVpZ2h0ID0gdGFyZ2V0Lm9mZnNldEhlaWdodAoJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHVpLnBhZ2UsIGh0bWwuSEVJR0hULCBoZWlnaHQtMTAtKG1ldGEuc3R5bGU/IDA6IHVpLm5hbWUub2Zmc2V0SGVpZ2h0KSkKCQkJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBfdGFyZ2V0LCBodG1sLkhFSUdIVCwgaGVpZ2h0LTEwKQoJCQkJCX0pLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS5uYW1lLCBodG1sLkRJVl9JVEVNKVswXS5jbGljaygpCgkJCQl9CgkJCQlicmVhawoJCQljYXNlICJ1c2VybmFtZSI6CgkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFsKCQkJCQljYW4uYmFzZS5Db3B5KHt2aWV3OiBbInVzZXJuYW1lIiwgImRpdiJdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJfSwgbGlzdDogW3t2aWV3OiBbInNvbWUiLCBodG1sLkRJViwgY2FuLnVzZXIuaW5mby51c2Vybmlja119LCB7aW1nOiBjYW4udXNlci5pbmZvLmF2YXRhcn1dfSldKQoJCQkJcmV0dXJuCgkJfQoKCQlpdGVtLl9pbml0ID0gaXRlbS5faW5pdHx8ZnVuY3Rpb24odGFyZ2V0KSB7CgkJCW1ldGEubGlzdCAmJiBjYW4ub25hcHBlbmQucGFyc2UoY2FuLCBtZXRhLmxpc3QsIHRhcmdldCwga2V5cywgZGF0YSwgdHlwZXx8c3VidHlwZSkKCQkJY2FuLmJhc2UuaXNGdW5jKGluaXQpICYmIGluaXQodGFyZ2V0KSwgY2FuLmJhc2UuaXNGdW5jKG1ldGEuaW5pdCkgJiYgbWV0YS5pbml0KHRhcmdldCkKCQl9CgkJaWYgKGNhbi5iYXNlLmlzU3RyaW5nKG1ldGEuc3R5bGUpKSB7IGl0ZW0uY2xhc3NOYW1lID0gbWV0YS5zdHlsZSB9CgkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KG1ldGEuc3R5bGUpKSB7IGl0ZW0uc3R5bGUgPSBtZXRhLnN0eWxlIH0KCgkJaWYgKChtZXRhLnR5cGV8fHR5cGUpID09IGh0bWwuTUVOVSkgewoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFtjYW4uYmFzZS5Db3B5KHt2aWV3OiBbaHRtbC5NRU5VLCBodG1sLkRJViwgbWV0YS5uYW1lfHxtZXRhXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWlmIChtZXRhLmxpc3QgJiYgbWV0YS5saXN0Lmxlbmd0aCA+IDApIHsgcmV0dXJuIH0KCQkJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBtZXRhLm5hbWUpIHx8IGNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBodG1sLk1FTlUsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7aXRlbTogbWV0YS5uYW1lfSkpCgkJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCW1ldGEubGlzdCAmJiBtZXRhLmxpc3QubGVuZ3RoID4gMCAmJiBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCB7fSwgbWV0YS5saXN0LCBmdW5jdGlvbihldmVudCwgaXRlbSkgewoJCQkJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBpdGVtKSB8fCBjYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgbWV0YS5uYW1lLCBjYW4ucmVxdWVzdChldmVudCwge2l0ZW06IGl0ZW19KSkKCQkJCX0pCgkJCX19KV0pLmZpcnN0CgkJCXJldHVybgoJCX0KCQlpZiAoKHR5cGV8fHN1YnR5cGUpID09IGh0bWwuSVRFTSkgeyBpdGVtLnZpZXcgPSBpdGVtLnZpZXd8fGh0bWwuTElTVAoJCQlpZiAobWV0YS5hY3Rpb24gPT0gImF1dG8iKSB7CgkJCQltZXRhLmluaXQgPSBtZXRhLmluaXR8fGZ1bmN0aW9uKGl0ZW0pIHsgY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsgaXRlbS5jbGljaygpIH0pIH0KCQkJfQoJCQlpZiAoZGVjb2RlVVJJQ29tcG9uZW50KGxvY2F0aW9uLmhhc2gpID09ICIjIitjYW4uY29yZS5LZXlzKGtleXMsIGl0ZW0ubmFtZSkpIHsKCQkJCW1ldGEuaW5pdCA9IG1ldGEuaW5pdHx8ZnVuY3Rpb24oaXRlbSkgeyBjYW4uY29yZS5UaW1lcigzMDAsIGZ1bmN0aW9uKCkgeyBpdGVtLmNsaWNrKCkgfSkgfQoJCQl9IAoKCQkJdmFyIF9pdGVtID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbY2FuLmJhc2UuQ29weSh7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIG1ldGEubmFtZXx8bWV0YV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlsb2NhdGlvbi5oYXNoID0gY2FuLmNvcmUuS2V5cyhrZXlzLCBpdGVtLm5hbWUpCgoJCQkJaWYgKG1ldGEuYWN0aW9uID09ICJvcGVuIikgewoJCQkJCWlmIChjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikpIHsKCQkJCQkJY2FuLnVzZXIub3BlbigiL2NoYXQvcG9kLyIrY2FuLm1pc2MuU2VhcmNoKGNhbiwgInBvZCIpKyIvY21kLyIrbWV0YS5pbmRleCkKCQkJCQl9IGVsc2UgewoJCQkJCQljYW4udXNlci5vcGVuKCIvY2hhdC9jbWQvIittZXRhLmluZGV4KQoJCQkJCX0KCQkJCQlyZXR1cm4KCQkJCX0KCQkJCWlmIChtZXRhLmFjdGlvbiA9PSAicHVzaCIpIHsKCQkJCQlpZiAoY2FuLm1pc2MuU2VhcmNoKGNhbiwgInBvZCIpKSB7CgkJCQkJCWNhbi51c2VyLmp1bXBzKCIvY2hhdC9wb2QvIitjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikrIi9jbWQvIittZXRhLmluZGV4KQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNhbi51c2VyLmp1bXBzKCIvY2hhdC9jbWQvIittZXRhLmluZGV4KQoJCQkJCX0KCQkJCQlyZXR1cm4KCQkJCX0KCQkJCXN3aXRjaCAobWV0YS50eXBlKSB7CgkJCQkJY2FzZSBodG1sLlBMVUdJTjoKCQkJCQkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4ga2V5cyB9LCBkYXRhLm1haW4pKSB7IGJyZWFrIH0KCQkJCQkJaWYgKGNhbi5iYXNlLkV4dChtZXRhLmluZGV4KSA9PSBuZnMuWk1MIHx8IGNhbi5iYXNlLkV4dChtZXRhLmluZGV4KSA9PSBuZnMuSU1MKSB7CgkJCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBkYXRhLm1haW4sIFt7dHlwZTogaHRtbC5JRlJBTUUsIHNyYzogIi9jaGF0L2NtZC8iK21ldGEuaW5kZXgsCgkJCQkJCQkJaGVpZ2h0OiBkYXRhLm1haW4ub2Zmc2V0SGVpZ2h0LCB3aWR0aDogZGF0YS5tYWluLm9mZnNldFdpZHRoLAoJCQkJCQkJfV0pCgkJCQkJCQlicmVhawoJCQkJCQl9CgoJCQkJCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwge2luZGV4OiBtZXRhLmluZGV4LCBhcmdzOiBjYW4uYmFzZS5PYmoobWV0YS5hcmdzKX0sIGZ1bmN0aW9uKHN1YikgewoJCQkJCQkJc3ViLkNvbmZIZWlnaHQoZGF0YS5tYWluLm9mZnNldEhlaWdodC0xNjApCgkJCQkJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiLCBzaWxlbnQpIHsKCQkJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9XSURUSCwgc3ViLkNvbmZXaWR0aChkYXRhLm1haW4ub2Zmc2V0V2lkdGgtNDApKQoJCQkJCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBzdWIuX2luZGV4fHxtZXRhLmluZGV4XSwgY21kcyksIGZ1bmN0aW9uKG1zZykgewoJCQkJCQkJCQljYihtc2cpLCBjYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7CgkJCQkJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fdGFibGUsIGh0bWwuTUFYX0hFSUdIVCwgZGF0YS5tYWluLm9mZnNldEhlaWdodC0xNTApCgkJCQkJCQkJCX0pCgkJCQkJCQkJfSwgdHJ1ZSkKCQkJCQkJCX0KCQkJCQkJfSwgZGF0YS5tYWluKQoJCQkJCWRlZmF1bHQ6CgkJCQkJCW1ldGEubGlzdCAmJiBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgZXZlbnQudGFyZ2V0Lm5leHRTaWJsaW5nKQoJCQkJfQoJCQl9fSldKS5maXJzdDsgY2FuLmNvcmUuSXRlbUNCKG1ldGEsIGZ1bmN0aW9uKGtleSwgY2IpIHsgX2l0ZW1ba2V5XSA9IGNhbi5iYXNlLmlzRnVuYyhjYik/IGNiOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNiLCBjYW4ucmVxdWVzdChldmVudCkpCgkJCX0gfSkKCQkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBtZXRhLmluaXQgJiYgbWV0YS5pbml0KF9pdGVtKSB9KQoJCQlpZiAoIW1ldGEubGlzdCkgeyByZXR1cm4gfQoJCX0KCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbaXRlbV0pLmZpcnN0Cgl9LAoJX3BhcnNlOiBmdW5jdGlvbihjYW4sIHRleHQpIHsgdmFyIHN0YWNrID0gW3tfZGVlcDogLTEsIGxpc3Q6IFtdfV0KCQljYW4uY29yZS5MaXN0KGNhbi5jb3JlLlNwbGl0KHRleHQsIGljZS5OTCwgaWNlLk5MLCBpY2UuTkwpLCBmdW5jdGlvbihsaW5lKSB7IGlmIChsaW5lID09ICIiKSB7IHJldHVybiB9CgkJCXZhciBkZWVwID0gMDsgZm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lLmxlbmd0aDsgaSsrKSB7IGlmIChsaW5lW2ldID09IGljZS5TUCkgeyBkZWVwKysgfSBlbHNlIGlmIChsaW5lW2ldID09IGljZS5UQikgeyBkZWVwICs9IDQgfSBlbHNlIHsgYnJlYWsgfSB9CgkJCWZvciAodmFyIGkgPSBzdGFjay5sZW5ndGgtMTsgaSA+IDA7IGktLSkgeyBpZiAoZGVlcCA8PSBzdGFja1tpXS5fZGVlcCkgeyBzdGFjay5wb3AoKSB9IH0KCgkJCXZhciBpdGVtID0ge19kZWVwOiBkZWVwLCBsaXN0OiBbXX07IHZhciBsaXN0ID0gc3RhY2tbc3RhY2subGVuZ3RoLTFdOyBsaXN0Lmxpc3QucHVzaChpdGVtKTsgaWYgKGRlZXAgPiBsaXN0Ll9kZWVwKSB7IHN0YWNrLnB1c2goaXRlbSkgfQoJCQl2YXIgbHMgPSBjYW4uY29yZS5TcGxpdChsaW5lKTsgc3dpdGNoIChsc1swXSkgewoJCQkJY2FzZSBodG1sLkhFQUQ6CgkJCQljYXNlIGh0bWwuTEVGVDoKCQkJCWNhc2UgaHRtbC5NQUlOOgoJCQkJY2FzZSBodG1sLkZPT1Q6CgkJCQljYXNlIGh0bWwuVEFCUzoKCQkJCWNhc2UgInVzZXJuYW1lIjoKCQkJCWNhc2UgaHRtbC5NRU5VOiBpdGVtLnR5cGUgPSBsc1swXTsgYnJlYWsKCQkJCWRlZmF1bHQ6IGl0ZW0ubmFtZSA9IGxzWzBdOyBicmVhawoJCQl9CgkJCWZvciAodmFyIGkgPSAxOyBpIDwgbHMubGVuZ3RoOyBpICs9IDIpIHsgY2FuLmNvcmUuVmFsdWUoaXRlbSwgbHNbaV0sIGxzW2krMV0pCgkJCQlpZiAobHNbaV0gPT0gY3R4LklOREVYKSB7IGl0ZW0udHlwZSA9IGl0ZW0udHlwZXx8aHRtbC5QTFVHSU4gfQoJCQl9CgkJfSkKCQlyZXR1cm4ge3R5cGU6ICJkZW1vIiwgc3R5bGU6IHtoZWlnaHQ6IGNhbi5Db25mSGVpZ2h0KCl8fHdpbmRvdy5pbm5lckhlaWdodH0sIGxpc3Q6IHN0YWNrWzBdLmxpc3R9Cgl9LAoKCV9wbHVnaW46IGZ1bmN0aW9uKGNhbiwgdmFsdWUsIG1ldGEsIGNiLCB0YXJnZXQpIHsKCQltZXRhLmZlYXR1cmUgPSBjYW4uYmFzZS5nZXRWYWxpZChtZXRhLmZlYXR1cmUsIGNhbi5iYXNlLk9iaih2YWx1ZS5tZXRhKSl8fHt9CgkJbWV0YS5pbnB1dHMgPSBjYW4uYmFzZS5nZXRWYWxpZChtZXRhLmlucHV0cywgY2FuLmJhc2UuT2JqKHZhbHVlLmxpc3QpKXx8W10KCQltZXRhLmFyZ3MgPSBjYW4uYmFzZS5nZXRWYWxpZChjYW4uYmFzZS5PYmoobWV0YS5hcmdzKSwgY2FuLmJhc2UuT2JqKG1ldGEuYXJnKSwgY2FuLmJhc2UuT2JqKHZhbHVlLmFyZ3MpLCBjYW4uYmFzZS5PYmoodmFsdWUuYXJnKSl8fFtdCgkJbWV0YS5kaXNwbGF5ID0gbWV0YS5kaXNwbGF5fHx2YWx1ZS5kaXNwbGF5CgoJCW1ldGEuaGVpZ2h0ID0gbWV0YS5oZWlnaHR8fGNhbi5Db25mKGh0bWwuSEVJR0hUKQoJCW1ldGEud2lkdGggPSBtZXRhLndpZHRofHxjYW4uQ29uZihodG1sLldJRFRIKQoKCQltZXRhLnR5cGUgPSBtZXRhLnR5cGV8fGNoYXQuUExVR0lOCgkJbWV0YS5uYW1lID0gbWV0YS5uYW1lfHx2YWx1ZS5uYW1lCgkJbWV0YS5oZWxwID0gbWV0YS5oZWxwfHx2YWx1ZS5oZWxwCgoJCWNhbi5vbmFwcGVuZC5faW5pdChjYW4sIG1ldGEsIFtjaGF0LlBMVUdJTl9TVEFURV9KU10sIGZ1bmN0aW9uKHN1Yiwgc2tpcCkgewoJCQlzdWIuX2luZGV4ID0gdmFsdWUuaW5kZXh8fG1ldGEuaW5kZXgKCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyBjYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgc3ViLl9pbmRleF0sIGNtZHMpLCBjYikgfQoJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YiwgbWV0YSwgc2tpcCkKCQl9LCB0YXJnZXR8fGNhbi5fb3V0cHV0KQoJfSwKCXBsdWdpbjogZnVuY3Rpb24oY2FuLCBtZXRhLCBjYiwgdGFyZ2V0KSB7IG1ldGEgPSBtZXRhfHx7fSwgbWV0YS5pbmRleCA9IG1ldGEuaW5kZXh8fGNhbi5jb3JlLktleXMobWV0YS5jdHgsIG1ldGEuY21kKQoJCXZhciBwID0gY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW21ldGEuaW5kZXhdLCByZXMgPSB7fTsgZnVuY3Rpb24gY2JzKHN1YiwgbWV0YSwgc2tpcCkgeyByZXMuX19wcm90b19fID0gc3ViLCBjYihzdWIsIG1ldGEsIHNraXApIH0KCQkobWV0YS5tZXRhIHx8IG1ldGEuaW5wdXRzICYmIG1ldGEuaW5wdXRzLmxlbmd0aCA+IDApPyAvKiDlsYDpg6jlkb3ku6QgKi8gY2FuLm9uYXBwZW5kLl9wbHVnaW4oY2FuLCB7bWV0YTogbWV0YS5tZXRhLCBsaXN0OiBtZXRhLmxpc3R9LCBtZXRhLCBjYnMsIHRhcmdldCk6CgkJCXA/IC8qIOWJjeerr+WRveS7pCAqLyBjYW4ub25hcHBlbmQuX3BsdWdpbihjYW4sIHtuYW1lOiBtZXRhLmluZGV4LCBoZWxwOiBwLmhlbHAsIG1ldGE6IHAubWV0YSwgbGlzdDogcC5saXN0fSwgbWV0YSwgZnVuY3Rpb24oc3ViLCBtZXRhLCBza2lwKSB7CgkJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCQkJaWYgKHAubWV0YSAmJiBwLm1ldGFbY21kc1sxXV0gJiYgY21kc1swXSA9PSBjdHguQUNUSU9OKSB7CgkJCQkJCWNhbi5jb3JlLkNhbGxGdW5jKHAubWV0YVtjbWRzWzFdXSwge2Nhbjogc3ViLCBtc2c6IGNhbi5yZXF1ZXN0KGV2ZW50KSwgY21kczogY21kcy5zbGljZSgyKSwgY2I6IGNifSkKCQkJCQl9IGVsc2UgaWYgKHAubWV0YSAmJiBwLm1ldGFbY21kc1swXV0pIHsKCQkJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMocC5tZXRhW2NtZHNbMF1dLCB7Y2FuOiBzdWIsIG1zZzogY2FuLnJlcXVlc3QoZXZlbnQpLCBjbWRzOiBjbWRzLnNsaWNlKDEpLCBjYjogY2J9KQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNhbi5jb3JlLkNhbGxGdW5jKHAsIHtjYW46IHN1YiwgbXNnOiBjYW4ucmVxdWVzdChldmVudCksIGNtZHM6IGNtZHMsIGNiOiBjYn0pCgkJCQkJfQoJCQkJfQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNicykgJiYgY2JzKHN1YiwgbWV0YSwgc2tpcCkKCQkJfSwgdGFyZ2V0KTogLyog5ZCO56uv5ZG95LukICovIGNhbi5ydW4oY2FuLnJlcXVlc3Qoe30sIG1ldGEpLl9ldmVudCwgW2N0eC5BQ1RJT04sIGN0eC5DT01NQU5ELCBtZXRhLmluZGV4XSwgZnVuY3Rpb24obXNnKSB7IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSkgewoJCQkJY2FuLm9uYXBwZW5kLl9wbHVnaW4oY2FuLCB2YWx1ZSwgbWV0YSwgY2JzLCB0YXJnZXQpCgkJCX0pIH0sIHRydWUpCgkJcmV0dXJuIHJlcwoJfSwKCWZpZ3VyZTogZnVuY3Rpb24oY2FuLCBtZXRhLCB0YXJnZXQsIGNicykgeyBpZiAoW2h0bWwuQlVUVE9OLCBodG1sLlNFTEVDVF0uaW5kZXhPZihtZXRhLnR5cGUpID4gLTEpIHsgcmV0dXJuIH0KCQl2YXIgaW5wdXQgPSBtZXRhLmFjdGlvbnx8bWRiLktFWTsgaW5wdXQgIT0gaWNlLkFVVE8gJiYgY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2lucHV0LyIraW5wdXQrIi5qcyJdLCBmdW5jdGlvbihjYW4pIHsKCQkJY2FuLmNvcmUuSXRlbUNCKGNhbi5vbmZpZ3VyZVtpbnB1dF0sIGZ1bmN0aW9uKGtleSwgb24pIHsgdmFyIGxhc3QgPSB0YXJnZXRba2V5XTsgdGFyZ2V0W2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBvbihldmVudCwgY2FuLCBtZXRhLCBmdW5jdGlvbihjYikgewoJCQkJaWYgKHRhcmdldC5fY2FuKSB7IHJldHVybiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHRhcmdldC5fY2FuLCBjYnMpIH0KCQkJCWNhbi5vbmFwcGVuZC5faW5pdChjYW4sIHt0eXBlOiBodG1sLklOUFVULCBuYW1lOiBpbnB1dCwgcG9zOiBjaGF0LkZMT0FUfSwgWyIvcGx1Z2luL2lucHV0LyIraW5wdXQrIi5qcyJdLCBmdW5jdGlvbihzdWIpIHsgc3ViLkNvbmYobWV0YSkKCQkJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKTsgKG1ldGEucnVufHxjYW4ucnVuKShldmVudCwgY21kcywgY2IsIHRydWUpIH0KCQkJCQlzdWIuY2xvc2UgPSBmdW5jdGlvbigpIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgc3ViLl90YXJnZXQpLCBkZWxldGUodGFyZ2V0Ll9jYW4pIH0sIHRhcmdldC5fY2FuID0gc3ViCgoJCQkJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKHN1YiwgW2NsaS5DTE9TRSwgY2xpLkNMRUFSLCBjbGkuUkVGUkVTSF0sIHN1Yi5fYWN0aW9uLCBraXQuRGljdCgKCQkJCQkJY2xpLlJFRlJFU0gsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKSB9LAoJCQkJCQljbGkuQ0xFQVIsIGZ1bmN0aW9uKGV2ZW50KSB7IHRhcmdldC52YWx1ZSA9ICIiIH0sCgkJCQkJCWNsaS5DTE9TRSwgZnVuY3Rpb24oZXZlbnQpIHsgc3ViLmNsb3NlKCkgfSwKCQkJCQkpKSwgY2FuLm9uYXBwZW5kLl9zdGF0dXMoc3ViLCBbbWRiLlRPVEFMLCBtZGIuSU5ERVhdKQoKCQkJCQljYW4ucGFnZS5zdHlsZShzdWIsIHN1Yi5fdGFyZ2V0LCBtZXRhLnN0eWxlKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIHN1Yi5fdGFyZ2V0KQoJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViLCBmdW5jdGlvbihzdWIsIGhpZGUpIHsgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIHN1Yi5fdGFyZ2V0LCAhaGlkZSksIGNhbi5iYXNlLmlzRnVuYyhjYnMpICYmIGNicyhzdWIpIH0pCgkJCQl9LCBkb2N1bWVudC5ib2R5KQoJCQl9LCB0YXJnZXQsIGxhc3QpIH0gfSkKCQl9KQoJfSwKCWZsb2F0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IpIHsKCQl2YXIgdWkgPSBjYW4ub25hcHBlbmQuZmllbGQoY2FuLCAic3RvcnkgdG9hc3QgZmxvYXQiLCB7fSwgZG9jdW1lbnQuYm9keSkKCQl1aS5jbG9zZSA9IGZ1bmN0aW9uKCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5maXJzdCkgfQoKCQljYW4uZ2V0QWN0aW9uU2l6ZShmdW5jdGlvbihsZWZ0LCB0b3AsIGhlaWdodCwgd2lkdGgpIHsKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB1aS5vdXRwdXQsIGh0bWwuTUFYX0hFSUdIVCwgaGVpZ2h0LTI4LCBodG1sLk1BWF9XSURUSCwgd2lkdGgpCgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdWkuZmlyc3QsIGh0bWwuTEVGVCwgbGVmdCwgaHRtbC5UT1AsIHRvcCkKCQl9KQoKCQljYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtjbGkuQ0xPU0UsIGNsaS5SRUZSRVNILCB7aW5wdXQ6IGh0bWwuVEVYVCwgcGxhY2Vob2xkZXI6ICJmaWx0ZXIiLCBfaW5pdDogZnVuY3Rpb24oaW5wdXQpIHsKCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJrZXltYXAuZm9jdXMiLCBjYW4ucmVxdWVzdCh7fSwge2NiOiBmdW5jdGlvbihldmVudCkgewoJCQkJaWYgKGV2ZW50LnRhcmdldC50YWdOYW1lID09ICJJTlBVVCIpIHsgcmV0dXJuIH0KCQkJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FU0NBUEUpIHsgdWkuY2xvc2UoKTsgcmV0dXJuIH0KCQkJCWlmIChldmVudC5rZXkgPT0gaWNlLlNQKSB7IGlucHV0LmZvY3VzKCksIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KSB9CgkJCX19KSkKCQl9LCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmtleW1hcC5pbnB1dChldmVudCwgY2FuKQoJCQlpZiAoZXZlbnQua2V5ICE9IGxhbmcuRU5URVIpIHsgcmV0dXJuIH0KCQkJZXZlbnQudGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKDAsIC0xKQoKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdWkub3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0ciwgaW5kZXgpIHsgaWYgKGluZGV4ID09IDApIHsgcmV0dXJuIH0KCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0ciwgaHRtbC5ISURERU4pCgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQpIHsgaWYgKHRkLmlubmVyVGV4dC5pbmRleE9mKGV2ZW50LnRhcmdldC52YWx1ZSkgPiAtMSkgewoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCB0ciwgaHRtbC5ISURERU4pCgkJCQl9IH0pCgkJCX0pCgkJfX1dLCB1aS5hY3Rpb24sIGtpdC5EaWN0KGNsaS5DTE9TRSwgdWkuY2xvc2UsIGNsaS5SRUZSRVNILCBmdW5jdGlvbihldmVudCkgeyB1aS5jbG9zZSgpLCBjYW4udG9hc3QuY2xpY2soKX0pKQoKCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBsaXN0KSB7CgkJCXJldHVybiB7dGV4dDogW3ZhbHVlLCBodG1sLlREXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IodmFsdWUsIGtleSwgaW5kZXgsIGxpbmUsIGxpc3QpCgkJCX19CgkJfSwgdWkub3V0cHV0KSwgY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgbXNnLlJlc3VsdCgpLCB1aS5vdXRwdXQpCgkJcmV0dXJuIHVpCgl9LAoKfSkKVm9sY2Fub3MoIm9ubGF5b3V0Iiwge2hlbHA6ICLpobXpnaLluIPlsYAiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8ZG9jdW1lbnQuYm9keQoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuRklFTERTRVRfTUFJTisiLnBhZ2UiKS5sZW5ndGggPiAwKSB7CgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5GSUVMRFNFVF9MRUZULCBmdW5jdGlvbihmaWVsZCwgaW5kZXgpIHsKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgZmllbGQsICIiKQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBbW2h0bWwuRklFTERTRVRfTEVGVCwgaHRtbC5ESVZfT1VUUFVUXV0sIGZ1bmN0aW9uKG91dHB1dCkgewoJCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgb3V0cHV0LCAiIikKCQkJCX0pCgkJCX0pCgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5GSUVMRFNFVF9NQUlOLCBmdW5jdGlvbihmaWVsZCwgaW5kZXgpIHsKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgZmllbGQsICIiKQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBbW2h0bWwuRklFTERTRVRfTUFJTiwgaHRtbC5ESVZfT1VUUFVUXV0sIGZ1bmN0aW9uKG91dHB1dCkgewoJCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgb3V0cHV0LCAiIikKCQkJCX0pCgkJCX0pCgkJCXJldHVybgoJCX0KCgkJdmFyIHdpZHRoID0gd2luZG93LmlubmVyV2lkdGgsIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodAoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgY2FuLnBhZ2UuS2V5cyhodG1sLkZJRUxEU0VUX0hFQUQsIGh0bWwuRklFTERTRVRfRk9PVCksIGZ1bmN0aW9uKGZpZWxkKSB7CgkJCWhlaWdodCAtPSBmaWVsZC5vZmZzZXRIZWlnaHQKCQl9KQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuRklFTERTRVRfTEVGVCwgZnVuY3Rpb24oZmllbGQsIGluZGV4KSB7CgkJCXZhciBvZmZzZXQgPSBjYW4udXNlci5pc01vYmlsZSAmJiAhY2FuLnVzZXIuaXNMYW5kc2NhcGUoKT8gMTAwOiAwCgkJCWNhbi51c2VyLmlzTW9iaWxlIHx8ICh3aWR0aCAtPSBmaWVsZC5vZmZzZXRXaWR0aCkKCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBmaWVsZCwgaGVpZ2h0LW9mZnNldCkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBbW2h0bWwuRklFTERTRVRfTEVGVCwgaHRtbC5ESVZfT1VUUFVUXV0sIGZ1bmN0aW9uKG91dHB1dCkgewoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBvdXRwdXQsIGhlaWdodC1odG1sLkFDVElPTl9IRUlHSFQtMS1vZmZzZXQpCgkJCX0pCgkJfSkKCgkJY2FuLnVzZXIuaXNNb2JpbGUgfHwgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBodG1sLkZJRUxEU0VUX01BSU4sIGZ1bmN0aW9uKGZpZWxkLCBpbmRleCkgewoJCQljYW4ucGFnZS5zdHlsZShjYW4sIGZpZWxkLCBodG1sLkhFSUdIVCwgaGVpZ2h0LCBodG1sLldJRFRILCB3aWR0aCkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBbW2h0bWwuRklFTERTRVRfTUFJTiwgaHRtbC5ESVZfT1VUUFVUXV0sIGZ1bmN0aW9uKG91dHB1dCkgewoJCQkJaGVpZ2h0IC09IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkRJVl9BQ1RJT04pWzBdLm9mZnNldEhlaWdodAoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBvdXRwdXQsIGhlaWdodCkKCQkJfSkKCQl9KQoKCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTlNJWkUsIGNhbi5yZXF1ZXN0KHt9LCB7d2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodH0pKQoJfSwKCXRvcGljOiBmdW5jdGlvbihjYW4sIHRvcGljKSB7IHRvcGljICYmIChjYW4uX3RvcGljID0gdG9waWMpCgkJY2FuLnVzZXIudG9waWMoY2FuLCBjYW4uX3RvcGljIHx8IGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuVE9QSUMpIHx8IFZvbGNhbm9zLm1ldGEuYXJncy50b3BpYyB8fCAoY2FuLmJhc2UuaXNOaWdodCgpPyBjaGF0LkJMQUNLOiBjaGF0LldISVRFKSkKCX0sCgliYWNrZ3JvdW5kOiBmdW5jdGlvbihjYW4sIHVybCwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXR8fGRvY3VtZW50LmJvZHksIGh0bWwuQkFDS0dST1VORCwgdXJsID09ICIiIHx8IHVybCA9PSAidm9pZCI/ICIiOiAndXJsKCInK3VybCsnIiknKQoJfSwKCWZpZ3VyZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCByaWdodCwgbGF5b3V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQlpZiAobGF5b3V0KSB7IHJldHVybiBjYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgbGF5b3V0KSwgY2FuLm9ubW90aW9uLm1vdmUoY2FuLCB0YXJnZXQsIGxheW91dCksIGxheW91dCB9CgkJaWYgKCFldmVudCB8fCAhZXZlbnQudGFyZ2V0IHx8ICFldmVudC5jbGllbnRYKSB7IHJldHVybiB7fSB9CgoJCXZhciBsZWZ0ID0gZXZlbnQuY2xpZW50WC1ldmVudC5vZmZzZXRYLCB0b3AgPSBldmVudC5jbGllbnRZLWV2ZW50Lm9mZnNldFkrZXZlbnQudGFyZ2V0Lm9mZnNldEhlaWdodC01OyBpZiAocmlnaHQpIHsKCQkJdmFyIGxlZnQgPSBldmVudC5jbGllbnRYLWV2ZW50Lm9mZnNldFgrZXZlbnQudGFyZ2V0Lm9mZnNldFdpZHRoLCB0b3AgPSBldmVudC5jbGllbnRZLWV2ZW50Lm9mZnNldFkKCQl9CgoJCWxheW91dCA9IHtsZWZ0OiBsZWZ0LCB0b3A6IHRvcH0KCQlpZiAobGF5b3V0LnRvcCA8IDApIHsgbGF5b3V0LnRvcCA9IDAgfQoJCWlmIChsYXlvdXQubGVmdCA8IDApIHsgbGF5b3V0LmxlZnQgPSAwIH0KCQlpZiAobGF5b3V0LmxlZnQrdGFyZ2V0Lm9mZnNldFdpZHRoPndpbmRvdy5pbm5lcldpZHRoKSB7CgkJCWxheW91dC5yaWdodCA9IDAsIGxheW91dC5sZWZ0ID0gIiIKCQl9CgkJaWYgKCEoY2FuLnVzZXIuaXNNb2JpbGUgJiYgY2FuLnVzZXIuaXNMYW5kc2NhcGUoKSkgJiYgdG9wK3RhcmdldC5vZmZzZXRIZWlnaHQ+d2luZG93LmlubmVySGVpZ2h0LTMyKSB7CgkJCWxheW91dC5ib3R0b20gPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSBldmVudC5jbGllbnRZK2V2ZW50Lm9mZnNldFksIGxheW91dC50b3AgPSAiIgoJCQlpZiAocmlnaHQpIHsgbGF5b3V0LmJvdHRvbSAtPSB0YXJnZXQub2Zmc2V0SGVpZ2h0IH0KCQl9CgkJcmV0dXJuIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBsYXlvdXQpLCBjYW4ub25tb3Rpb24ubW92ZShjYW4sIHRhcmdldCwgbGF5b3V0KSwgbGF5b3V0Cgl9LAoKCWRpc3BsYXk6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2hhdC5MQVlPVVQsIGh0bWwuVEFCTEVdLCBsaXN0OiBbCgkJCXt0eXBlOiBodG1sLlRSLCBsaXN0OiBbe3ZpZXc6IGNoYXQuQ09OVEVOVH1dfSwKCQkJe3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dmlldzogY2hhdC5ESVNQTEFZfV19LAoJCV19XSkKCX0sCglwcm9qZWN0OiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi5fdGFyZ2V0CgkJcmV0dXJuIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2hhdC5MQVlPVVQsIGh0bWwuVEFCTEVdLCBsaXN0OiBbe3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFsKCQkJe3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFt7dmlldzogY2hhdC5QUk9KRUNULCBzdHlsZToge2Rpc3BsYXk6IGh0bWwuTk9ORX19XX0sIHt0eXBlOiBodG1sLlRELCBsaXN0OiBbCgkJCQl7dmlldzogW2NoYXQuTEFZT1VULCBodG1sLlRBQkxFXSwgbGlzdDogWwoJCQkJCXt0eXBlOiBodG1sLlRSLCBsaXN0OiBbe3ZpZXc6IGNoYXQuQ09OVEVOVH1dfSwKCQkJCQl7dHlwZTogaHRtbC5UUiwgbGlzdDogW3t2aWV3OiBjaGF0LkRJU1BMQVl9XX0sCgkJCQldfQoJCQldfQoJCV19XSB9XSkKCX0sCglwcm9maWxlOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi5fb3V0cHV0CgkJZnVuY3Rpb24gdG9nZ2xlKHZpZXcpIHsKCQkJdmlldy5fdG9nZ2xlPyB2aWV3Ll90b2dnbGUoZXZlbnQsIHZpZXcuc3R5bGUuZGlzcGxheSA9PSBodG1sLk5PTkUpOiBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgdmlldykKCQkJcmV0dXJuIHZpZXcuc3R5bGUuZGlzcGxheSA9PSBodG1sLk5PTkUKCQl9CgoJCXZhciBndCA9ICImIzEwMDk1OyIsIGx0ID0gIiYjMTAwOTQ7IiwgZG93biA9ICImIzcwOTsiLCB1cCA9ICImIzcwODsiCgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjaGF0LkxBWU9VVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFsKCQkJe3ZpZXc6IFtjaGF0LlBST0pFQ1QsIGh0bWwuVERdLCBsaXN0OiBbe3ZpZXc6IFtjaGF0LlBST0pFQ1RdfV19LAoJCQl7dHlwZTogaHRtbC5URCwgbGlzdDogWwoJCQkJe3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQkJCXt2aWV3OiBbY2hhdC5DT05URU5ULCBodG1sLlREXSwgbGlzdDogW3t2aWV3OiBbY2hhdC5DT05URU5UXX0sCgkJCQkJCXt2aWV3OiBbW2h0bWwuVE9HR0xFLCBjaGF0LlBST0pFQ1RdXSwgbGlzdDogW3t0ZXh0OiBbZ3QsIGh0bWwuRElWXX1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQkJZXZlbnQudGFyZ2V0LmlubmVySFRNTCA9IHRvZ2dsZShjYW4udWkucHJvamVjdCk/IGd0OiBsdAoJCQkJCQl9fSwKCQkJCQkJe3ZpZXc6IFtbaHRtbC5UT0dHTEUsIGNoYXQuUFJPRklMRV1dLCBsaXN0OiBbe3RleHQ6IFtsdCwgaHRtbC5ESVZdfV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCQlldmVudC50YXJnZXQuaW5uZXJIVE1MID0gdG9nZ2xlKGNhbi51aS5wcm9maWxlKT8gbHQ6IGd0CgkJCQkJCX19LAoJCQkJCQl7dmlldzogW1todG1sLlRPR0dMRSwgY2hhdC5ESVNQTEFZXV0sIGxpc3Q6IFt7dGV4dDogW3VwLCBodG1sLkRJVl19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCWV2ZW50LnRhcmdldC5pbm5lckhUTUwgPSB0b2dnbGUoY2FuLnVpLmRpc3BsYXkpPyB1cDogZG93bgoJCQkJCQl9fSwKCQkJCQldfSwKCQkJCQl7dmlldzogW2NoYXQuUFJPRklMRSwgaHRtbC5URF0sIGxpc3Q6IFt7dmlldzogW2NoYXQuUFJPRklMRV0sIHN0eWxlOiB7ZGlzcGxheTogaHRtbC5OT05FfX1dfSwKCQkJCV19XX0sCgkJCQl7dmlldzogW2NoYXQuRElTUExBWSwgaHRtbC5UUl0sIGxpc3Q6IFt7dmlldzogW2NoYXQuRElTUExBWV0sIHN0eWxlOiB7ZGlzcGxheTogaHRtbC5OT05FfX1dfQoJCQldfQoJCV0gfV0pOyByZXR1cm4gY2FuLnVpID0gdWkKCX0sCn0pClZvbGNhbm9zKCJvbm1vdGlvbiIsIHtoZWxwOiAi5Yqo5oCB54m55pWIIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCXdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJvcmllbnRhdGlvbmNoYW5nZSIsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCAib3JpZW50YXRpb25jaGFuZ2UiKQoJCX0pLCBjYW4ub25tb3Rpb24uZmxvYXQuYXV0byhjYW4sIHRhcmdldCkKCX0sCglmb2N1czogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsgaWYgKCF0YXJnZXQpIHsgcmV0dXJuIH0KCQl0YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UgJiYgdGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKDAsIC0xKSwgdGFyZ2V0LmZvY3VzKCkKCX0sCglzaGFyZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgaW5wdXQsIGFyZ3MpIHsKCQlyZXR1cm4gY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgaW5wdXQsIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIF9hcmdzKSB7CgkJCWNhbi5zZWFyY2goY2FuLnJlcXVlc3QoZXZlbnQsIHthcmdzOiBbbWRiLlRZUEUsIGNoYXQuRklFTERdLmNvbmNhdChhcmdzfHxbXSwgX2FyZ3N8fFtdKX0pLl9ldmVudCwgW1siSGVhZGVyIiwgY2hhdC5PTkFDVElPTiwgd2ViLlNIQVJFXV0pCgkJfSkKCX0sCglzdG9yeTogewoJCV9oYXNoOiB7CgkJCXNwYXJrOiBmdW5jdGlvbihjYW4sIG1ldGEsIHRhcmdldCkgewoJCQkJbWV0YVttZGIuTkFNRV0gPT0gaHRtbC5JTk5FUj8gY2FuLm9ubW90aW9uLmNvcHkoY2FuLCB0YXJnZXQpOiBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuU1BBTiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCWNhbi5vbm1vdGlvbi5jb3B5KGNhbiwgaXRlbSkKCQkJCX0pCgkJCX0sCgkJfSwKCQlhdXRvOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyB2YXIgdGhhdCA9IHRoaXMKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgIi5zdG9yeSIsIGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIG1ldGEgPSBpdGVtLmRhdGFzZXQKCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwgY2FuLmJhc2UuT2JqKG1ldGEuc3R5bGUpKQoJCQkJY2FuLmNvcmUuQ2FsbEZ1bmModGhhdC5faGFzaFttZXRhLnR5cGVdLCBbY2FuLCBtZXRhLCB0YXJnZXR8fGNhbi5fb3V0cHV0XSkKCQkJfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgaHRtbC5JRlJBTUUsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwgaHRtbC5IRUlHSFQsIGNhbi5Db25mKGh0bWwuSEVJR0hUKS04OCwgaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCktMzApCgkJCX0pCgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldHx8Y2FuLl9vdXRwdXQsIGh0bWwuU1ZHLCBmdW5jdGlvbihpdGVtKSB7CgkJCQlpdGVtLm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIGtpdC5EaWN0KG1kYi5FWFBPUlQsIGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoKCQkJCQl9KSwgW21kYi5FWFBPUlRdKQoJCQkJfQoJCQl9KQoJCX0sCgl9LAoJZmxvYXQ6IHtfaGFzaDoge30sCgkJZGVsOiBmdW5jdGlvbihjYW4sIGtleSkgewoJCQlrZXkgPT0gY2hhdC5DQVJURSAmJiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBkb2N1bWVudC5ib2R5LCBjYW4uY29yZS5LZXlzKGh0bWwuRElWLCBjaGF0LkNBUlRFKSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaXRlbSkKCQkJfSkKCQkJdmFyIGxhc3QgPSB0aGlzLl9oYXNoW2tleV07IGlmICghbGFzdCkgeyByZXR1cm4gfQoJCQlsYXN0LmNsb3NlPyBsYXN0LmNsb3NlKCk6IGNhbi5wYWdlLlJlbW92ZShjYW4sIGxhc3QuX3RhcmdldCkKCQl9LAoJCWFkZDogZnVuY3Rpb24oY2FuLCBrZXksIHZhbHVlKSB7IHJldHVybiB0aGlzLmRlbChjYW4sIGtleSksIHRoaXMuX2hhc2hba2V5XSA9IHZhbHVlIH0sCgkJYXV0bzogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGtleSkgeyB2YXIgdGhhdCA9IHRoaXMKCQkJdmFyIGxpc3QgPSBjYW4uY29yZS5MaXN0KGFyZ3VtZW50cykuc2xpY2UoMikKCQkJaWYgKGxpc3QubGVuZ3RoID09IDApIHsgbGlzdCA9IFtjaGF0LkNBUlRFLCBjaGF0LklOUFVUXSB9CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHRhcmdldCwge29ubW91c2VvdmVyOiBmdW5jdGlvbihldmVudCkgeyAKCQkJCWlmIChjYW4ucGFnZS50YWdpcyhodG1sLklNRywgZXZlbnQudGFyZ2V0KSkgeyByZXR1cm4gfQoJCQkJY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihrZXksIGluZGV4KSB7IHRoYXQuZGVsKGNhbiwga2V5KSB9KQoJCQl9fSkKCQl9LAoJfSwKCWNhY2hlOiBmdW5jdGlvbihjYW4sIG5leHQpIHsgdmFyIGxpc3QgPSBjYW4uYmFzZS5PYmooY2FuLmNvcmUuTGlzdChhcmd1bWVudHMpLnNsaWNlKDIpLCBbY2FuLl9vdXRwdXRdKQoJCWNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBjYW4ucGFnZS5DYWNoZShpdGVtLl9jYWNoZV9rZXksIGl0ZW0sIGl0ZW0uc2Nyb2xsVG9wKzEpIH0pCgkJdmFyIGtleSA9IG5leHQoY2FuLl9jYWNoZV9kYXRhID0gY2FuLl9jYWNoZV9kYXRhfHx7fSkKCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtKSB7IHZhciBwb3MgPSBjYW4ucGFnZS5DYWNoZShpdGVtLl9jYWNoZV9rZXkgPSBrZXksIGl0ZW0pCgkJCWlmIChwb3MpIHsgaXRlbS5zY3JvbGxUbyAmJiBpdGVtLnNjcm9sbFRvKDAsIHBvcy0xKTsgcmV0dXJuIGl0ZW0gfQoJCX0pLmxlbmd0aCA+IDAKCX0sCgljbGVhcjogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsgcmV0dXJuIGNhbi5wYWdlLk1vZGlmeShjYW4sIHRhcmdldHx8Y2FuLl9vdXRwdXQsICIiKSwgdHJ1ZSB9LAoJZGVsYXk6IGZ1bmN0aW9uKGNhbiwgY2IpIHsgY2FuLmNvcmUuVGltZXIoMTAwLCBjYikgfSwKCgloaWRkZW46IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBzaG93KSB7CgkJY2FuLnBhZ2Uuc3R5bGVEaXNwbGF5KGNhbiwgdGFyZ2V0fHxjYW4uX3RhcmdldCwgc2hvdz8gIiI6IGh0bWwuTk9ORSkKCX0sCgl0b2dnbGU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBzaG93LCBoaWRlKSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQl2YXIgc3RhdHVzID0gdGFyZ2V0LnN0eWxlLmRpc3BsYXkgPT0gaHRtbC5OT05FCgkJaWYgKCEoc3RhdHVzPyBjYW4uYmFzZS5pc0Z1bmMoc2hvdykgJiYgc2hvdygpOiBjYW4uYmFzZS5pc0Z1bmMoaGlkZSkgJiYgaGlkZSgpKSkgewoJCQljYW4ucGFnZS5zdHlsZURpc3BsYXkoY2FuLCB0YXJnZXQsIHN0YXR1cz8gIiI6IGh0bWwuTk9ORSkKCQl9CgkJcmV0dXJuIHN0YXR1cwoJfSwKCXNlbGVjdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIG5hbWUsIHdoaWNoKSB7CgkJdmFyIG9sZCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgbmFtZSwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJaWYgKGNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCBpdGVtLCAic2VsZWN0IikpIHsgcmV0dXJuIGluZGV4IH0KCQl9KVswXQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgbmFtZSwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIGl0ZW0sIGh0bWwuU0VMRUNULCBpdGVtID09IHdoaWNoIHx8IHdoaWNoID09IGluZGV4KQoJCX0pCgkJcmV0dXJuIG9sZAoJfSwKCW1vZGlmeTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGNiLCBpdGVtKSB7IHZhciBiYWNrID0gdGFyZ2V0LmlubmVySFRNTCwgdGV4dCA9IHRhcmdldC5pbm5lclRleHQKCQlpZiAoYmFjay5sZW5ndGggPiAxMjAgfHwgYmFjay5pbmRleE9mKGljZS5OTCkgPiAtMSkgewoJCQlyZXR1cm4gY2FuLm9ubW90aW9uLm1vZGlmeXMoY2FuLCB0YXJnZXQsIGNiKQoJCX0KCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmRzKGNhbiwgdGFyZ2V0LCBbe3R5cGU6IGh0bWwuSU5QVVQsIHZhbHVlOiB0YXJnZXQuaW5uZXJUZXh0LCBzdHlsZTogewoJCQl3aWR0aDogdGFyZ2V0Lm9mZnNldFdpZHRoID4gNDAwPyA0MDA6IHRhcmdldC5vZmZzZXRXaWR0aC0yMCwKCQl9LCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCQljYXNlIGxhbmcuRU5URVI6IHRhcmdldC5pbm5lckhUTUwgPSBldmVudC50YXJnZXQudmFsdWUKCQkJCQlldmVudC50YXJnZXQudmFsdWUgPT0gYmFjayB8fCBjYihldmVudCwgZXZlbnQudGFyZ2V0LnZhbHVlLCBiYWNrKQoJCQkJCWJyZWFrCgkJCQljYXNlIGxhbmcuRVNDQVBFOiB0YXJnZXQuaW5uZXJIVE1MID0gYmFjazsgYnJlYWsKCQkJCWRlZmF1bHQ6IGNhbi5vbmtleW1hcC5pbnB1dChldmVudCwgY2FuKQoJCQl9CgkJfSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgewoJCQlpdGVtICYmIGNhbi5vbmFwcGVuZC5maWd1cmUoY2FuLCBpdGVtLCB0YXJnZXQpLCB0YXJnZXQudmFsdWUgPSB0ZXh0CgkJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIHRhcmdldCkKCQl9fV0pCgl9LAoJbW9kaWZ5czogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGNiLCBpdGVtKSB7IHZhciBiYWNrID0gdGFyZ2V0LmlubmVySFRNTAoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dHlwZTogaHRtbC5URVhUQVJFQSwgdmFsdWU6IHRhcmdldC5pbm5lclRleHQsIHN0eWxlOiB7CgkJCXdpZHRoOiB0YXJnZXQub2Zmc2V0V2lkdGggPiA0MDA/IDQwMDogdGFyZ2V0Lm9mZnNldFdpZHRoLTIwLCBoZWlnaHQ6IHRhcmdldC5vZmZzZXRIZWlnaHQgPCA2MD8gNjA6IHRhcmdldC5vZmZzZXRIZWlnaHQtMjAsCgkJfSwgb25rZXlkb3duOiBmdW5jdGlvbihldmVudCkgewoJCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQkJY2FzZSBsYW5nLkVOVEVSOgoJCQkJCWlmIChldmVudC5jdHJsS2V5KSB7IHRhcmdldC5pbm5lckhUTUwgPSBldmVudC50YXJnZXQudmFsdWUKCQkJCQkJZXZlbnQudGFyZ2V0LnZhbHVlID09IGJhY2sgfHwgY2IoZXZlbnQsIGV2ZW50LnRhcmdldC52YWx1ZSwgYmFjaykKCQkJCQl9CgkJCQkJYnJlYWsKCQkJCWNhc2UgbGFuZy5FU0NBUEU6IHRhcmdldC5pbm5lckhUTUwgPSBiYWNrOyBicmVhawoJCQkJZGVmYXVsdDogY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pCgkJCX0KCQl9LCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCWl0ZW0gJiYgY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIGl0ZW0sIHRhcmdldCkKCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgdGFyZ2V0KQoJCX19XSkKCX0sCgl0b2ltYWdlOiBmdW5jdGlvbihldmVudCwgY2FuLCBuYW1lLCB0YXJnZXQpIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6ICJuYW1lIiwgdmFsdWU6IG5hbWV9XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgZGF0YSkgewoJCQljYW4ucmVxdWlyZShbImh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vaHRtbDJjYW52YXNAMS4wLjAtcmMuNS9kaXN0L2h0bWwyY2FudmFzLm1pbi5qcyJdLCBmdW5jdGlvbigpIHsKCQkJCWh0bWwyY2FudmFzKHRhcmdldHx8Y2FuLl90YXJnZXQpLnRoZW4oZnVuY3Rpb24gKGNhbnZhcykgewoJCQkJCWNhbi5wYWdlLkNyZWF0ZShjYW4sIGh0bWwuQSwge2hyZWY6IGNhbnZhcy50b0RhdGFVUkwoImltYWdlL3BuZyIpLCBkb3dubG9hZDogZGF0YS5uYW1lfSkuY2xpY2soKQoJCQkJfSkKCQkJfSkKCQl9KQoJfSwKCglsaW5rOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdGV4dCkgewoJCWlmICh0YXJnZXQuaW5uZXJUZXh0ID09ICIiKSB7IHRhcmdldC5pbm5lclRleHQgPSB0YXJnZXQuaHJlZiB9CgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCB7dGFyZ2V0OiAiX2JsYW5rIn0pCgl9LAoJY29weTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHRleHQsIGNiKSB7CgkJdGFyZ2V0LnRpdGxlID0gIueCueWHu+WkjeWItiIsIHRhcmdldC5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnVzZXIuY29weShldmVudCwgY2FuLCB0ZXh0fHx0YXJnZXQuaW5uZXJUZXh0KQoJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50KQoJCX0KCX0sCgltb3ZlOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgbGF5b3V0LCBjYikgeyB2YXIgYmVnaW47IGxheW91dCA9IGxheW91dHx8e30KCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgbGF5b3V0KSwgdGFyZ2V0Lm9ubW91c2Vkb3duID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJbGF5b3V0LmhlaWdodCA9IHRhcmdldC5vZmZzZXRIZWlnaHQsIGxheW91dC53aWR0aCA9IHRhcmdldC5vZmZzZXRXaWR0aAoJCQlsYXlvdXQubGVmdCA9IHRhcmdldC5vZmZzZXRMZWZ0LCBsYXlvdXQudG9wID0gdGFyZ2V0Lm9mZnNldFRvcAoJCQliZWdpbiA9IGNhbi5iYXNlLkNvcHkoe3g6IGV2ZW50LngsIHk6IGV2ZW50Lnl9LCBsYXlvdXQpCgkJfSwgdGFyZ2V0Lm9ubW91c2V1cCA9IGZ1bmN0aW9uKGV2ZW50KSB7IGJlZ2luID0gbnVsbCB9CgoJCXRhcmdldC5vbm1vdXNlbW92ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGlmICghYmVnaW4gfHwgIWV2ZW50LmN0cmxLZXkpIHsgcmV0dXJuIH0KCQkJaWYgKGV2ZW50LnNoaWZ0S2V5KSB7CgkJCQlsYXlvdXQud2lkdGggPSBsYXlvdXQud2lkdGggKyBldmVudC54IC0gYmVnaW4ueCAKCQkJCWxheW91dC5oZWlnaHQgPSBsYXlvdXQuaGVpZ2h0ICsgZXZlbnQueSAtIGJlZ2luLnkKCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkhFSUdIVCwgbGF5b3V0LmhlaWdodCwgaHRtbC5XSURUSCwgbGF5b3V0LndpZHRoKQoJCQl9IGVsc2UgewoJCQkJbGF5b3V0LnRvcCA9IGJlZ2luLnRvcCArIGV2ZW50LnkgLSBiZWdpbi55CgkJCQlsYXlvdXQubGVmdCA9IGJlZ2luLmxlZnQgKyBldmVudC54IC0gYmVnaW4ueCAKCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkxFRlQsIGxheW91dC5sZWZ0LCBodG1sLlRPUCwgbGF5b3V0LnRvcCkKCQkJfQoJCQljYW4ub25rZXltYXAucHJldmVudChldmVudCksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IodGFyZ2V0LCBsYXlvdXQpCgkJfQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IodGFyZ2V0LCBsYXlvdXQpCgl9LAoJc2hvdzogZnVuY3Rpb24oY2FuLCB0aW1lLCBjYiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQl0aW1lID0gY2FuLmJhc2UuaXNPYmplY3QodGltZSk/IHRpbWU6IHtpbnRlcnZhbDogMTAsIGxlbmd0aDogdGltZXx8MzB9CgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuT1BBQ0lUWSwgMCwgaHRtbC5ESVNQTEFZLCBodG1sLkJMT0NLKQoJCWNhbi5jb3JlLlRpbWVyKHRpbWUsIGZ1bmN0aW9uKGV2ZW50LCB2YWx1ZSwgaW5kZXgpIHsKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuT1BBQ0lUWSwgKGluZGV4KzEpL3RpbWUubGVuZ3RoKQoJCX0sIGNiKQoJfSwKCWhpZGU6IGZ1bmN0aW9uKGNhbiwgdGltZSwgY2IsIHRhcmdldCkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi5fdGFyZ2V0CgkJdGltZSA9IGNhbi5iYXNlLmlzT2JqZWN0KHRpbWUpPyB0aW1lOiB7dmFsdWU6IDEwLCBsZW5ndGg6IHRpbWV8fDIwfQoJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLk9QQUNJVFksIDEpCgkJY2FuLmNvcmUuVGltZXIodGltZSwgZnVuY3Rpb24oZXZlbnQsIHZhbHVlLCBpbmRleCkgewoJCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5PUEFDSVRZLCAxLShpbmRleCsxKS90aW1lLmxlbmd0aCkKCQl9LCBmdW5jdGlvbigpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpLCBjYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5ESVNQTEFZLCBodG1sLk5PTkUpIH0pCgl9LAoKCXNlbGVjdEZpZWxkOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJaWYgKGV2ZW50LmtleSA9PSAiRW50ZXIiKSB7IHJldHVybiBjYW4ucnVuKGV2ZW50KSB9CgkJaWYgKCFldmVudC5jdHJsS2V5IHx8IGV2ZW50LmtleSA8ICIwIiB8fCBldmVudC5rZXkgPiAiOSIpIHsgcmV0dXJuIH0KCQlpZiAoZXZlbnQuc2hpZnRLZXkpIHsKCQkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3B0aW9uLCAiaW5wdXRbdHlwZT1idXR0b25dIiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJCWluZGV4ID09IGV2ZW50LmtleSAmJiAoaXRlbS5jbGljaygpKQoJCQl9KQoJCX0KCQlpZiAoZXZlbnQua2V5ID09ICIwIikgeyByZXR1cm4gY2FuLm9uaW1wb3J0Ll9iYWNrKGNhbikgfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5UUiwgZnVuY3Rpb24odHIsIGluZGV4KSB7IGlmIChpbmRleCA9PSBldmVudC5rZXkpIHsKCQkJdmFyIGhlYWQgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5USCwgZnVuY3Rpb24odGgsIG9yZGVyKSB7IHJldHVybiB0aC5pbm5lclRleHQgfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdHIsIGh0bWwuVEQsIGZ1bmN0aW9uKHRkLCBpbmRleCkgeyBjYW4uT3B0aW9uKGhlYWRbaW5kZXhdLCB0ZC5pbm5lclRleHQpIH0pCgkJCWNhbi5VcGRhdGUoZXZlbnQpCgkJfSB9KQoJfSwKCXNlbGVjdFRhYmxlOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNiKSB7IGlmICghZXZlbnQuY3RybEtleSkgeyByZXR1cm4gfQoJCWZ1bmN0aW9uIHNlbGVjdChvcmRlcikgeyB2YXIgaW5kZXggPSAwCgkJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5UUiwgZnVuY3Rpb24odHIpIHsKCQkJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QuaGFzKGNhbiwgdHIsIGh0bWwuSElEREVOKSkgeyByZXR1cm4gfQoJCQkJaWYgKCFjYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgdHIsIGh0bWwuU0VMRUNULCBvcmRlciA9PSBpbmRleCsrKSkgeyByZXR1cm4gdHIgfQoJCQkJcmV0dXJuIGNhbi5TdGF0dXMobWRiLklOREVYLCBpbmRleC0xKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih0ciksIHRyCgkJCX0pLmxlbmd0aAoJCX0KCQl2YXIgdG90YWwgPSBzZWxlY3QodGFyZ2V0Ll9pbmRleCk7IHN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCWNhc2UgIm4iOiBzZWxlY3QodGFyZ2V0Ll9pbmRleCA9ICgodGFyZ2V0Ll9pbmRleCkrMSkgJSB0b3RhbCk7IGJyZWFrCgkJCWNhc2UgInAiOiBzZWxlY3QodGFyZ2V0Ll9pbmRleCA9ICh0YXJnZXQuX2luZGV4LTEpIDwgMD8gdG90YWwtMTogKHRhcmdldC5faW5kZXgtMSkpOyBicmVhawoJCQlkZWZhdWx0OiB0YXJnZXQuX2luZGV4ID0gMDsgcmV0dXJuCgkJfSBjYW4ub25rZXltYXAucHJldmVudChldmVudCkKCX0sCglzZWxlY3RUYWJsZUlucHV0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNiKSB7CgkJaWYgKHRhcmdldC52YWx1ZSA9PSAiIikgeyByZXR1cm4gY2IoKSB9CgkJaWYgKGV2ZW50LmN0cmxLZXkpIHsKCQkJZnVuY3Rpb24gc2VsZWN0KG9yZGVyKSB7IGlmIChvcmRlciA9PSAwKSB7IHRhcmdldC52YWx1ZSA9IHRhcmdldC5fdmFsdWUgfQoJCQkJdmFyIGluZGV4ID0gMDsgcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0cikgewoJCQkJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QuaGFzKGNhbiwgdHIsIGh0bWwuSElEREVOKSkgeyByZXR1cm4gfQoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCB0ciwgaHRtbC5TRUxFQ1QpOyBpZiAob3JkZXIgIT0gaW5kZXgrKykgeyByZXR1cm4gdHIgfQoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0ciwgaHRtbC5TRUxFQ1QpLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQsIGluZGV4KSB7CgkJCQkJCXRhcmdldC5fdmFsdWUgPSB0YXJnZXQuX3ZhbHVlfHx0YXJnZXQudmFsdWUsIGluZGV4ID09IDAgJiYgKHRhcmdldC52YWx1ZSA9IHRkLmlubmVyVGV4dCkKCQkJCQl9KTsgcmV0dXJuIHRyCgkJCQl9KS5sZW5ndGgKCQkJfQoJCQl2YXIgdG90YWwgPSBzZWxlY3QodGFyZ2V0Ll9pbmRleCk7IHN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCQljYXNlICJuIjogc2VsZWN0KHRhcmdldC5faW5kZXggPSAoKHRhcmdldC5faW5kZXgpKzEpICUgdG90YWwpOyBicmVhawoJCQkJY2FzZSAicCI6IHNlbGVjdCh0YXJnZXQuX2luZGV4ID0gKHRhcmdldC5faW5kZXgtMSkgPCAwPyB0b3RhbC0xOiAodGFyZ2V0Ll9pbmRleC0xKSk7IGJyZWFrCgkJCQlkZWZhdWx0OiB0YXJnZXQuX2luZGV4ID0gMCwgdGFyZ2V0Ll92YWx1ZSA9ICIiOyByZXR1cm4KCQkJfSByZXR1cm4gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJfQoKCQl0YXJnZXQuX2luZGV4ID0gMCwgdGFyZ2V0Ll92YWx1ZSA9ICIiCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyLCBpbmRleCkgewoJCQl2YXIgaGFzID0gZmFsc2U7IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgewoJCQkJaGFzID0gaGFzIHx8IHRkLmlubmVyVGV4dC5pbmRleE9mKHRhcmdldC52YWx1ZSk+LTEKCQkJfSksIGNhbi5wYWdlLkNsYXNzTGlzdC5zZXQoY2FuLCB0ciwgaHRtbC5ISURERU4sICFoYXMgJiYgaW5kZXggIT0gMCkKCQl9KQoKCQl2YXIgdG90YWwgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5UUiwgZnVuY3Rpb24odHIpIHsKCQkJaWYgKCFjYW4ucGFnZS5DbGFzc0xpc3QuaGFzKGNhbiwgdHIsIGh0bWwuSElEREVOKSkgeyByZXR1cm4gdHJ9CgkJfSkubGVuZ3RoLTE7IHRvdGFsID09IDAgJiYgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgkJY2FuLlN0YXR1cyhraXQuRGljdChtZGIuVE9UQUwsIHRvdGFsLCBtZGIuSU5ERVgsIHRhcmdldC5faW5kZXgpKQoJfSwKfSkKVm9sY2Fub3MoIm9ua2V5bWFwIiwge2hlbHA6ICLplK7nm5jkuqTkupIiLCBsaXN0OiBbXSwgX2ZvY3VzOiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJZG9jdW1lbnQuYm9keS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJaWYgKHdpbmRvdy53ZWJ2aWV3KSB7CgkJCQlpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT0gIkEiKSB7CgkJCQkJd2luZG93Lm9wZW4oZXZlbnQudGFyZ2V0LmhyZWYpCgkJCQl9CgkJCX0KCQl9CgkJY2FuLm9ua2V5bWFwLl9idWlsZChjYW4pLCBkb2N1bWVudC5ib2R5Lm9ua2V5ZG93biA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWlmIChldmVudC5tZXRhS2V5KSB7IGlmICh3aW5kb3cud2VidmlldykgewoJCQkJc3dpdGNoIChldmVudC5rZXkpIHsKCQkJCQljYXNlICJxIjogd2luZG93LnRlcm1pbmF0ZSgpOyBicmVhawoJCQkJCWNhc2UgInciOiB3aW5kb3cuY2xvc2UoKTsgYnJlYWsKCQkJCQljYXNlICJyIjogbG9jYXRpb24ucmVsb2FkKCk7IGJyZWFrCgkJCQkJY2FzZSAiZiI6IGNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCAib25vcGVuc2VhcmNoIiwgY2FuLnJlcXVlc3Qoe30sIHt0eXBlOiAiKiJ9KSk7IGJyZWFrCgkJCQkJY2FzZSAiWyI6IGhpc3RvcnkuYmFjaygpOyBicmVhawoJCQkJCWNhc2UgIl0iOiBoaXN0b3J5LmZvcndhcmQoKTsgYnJlYWsKCQkJCX0KCQkJfSByZXR1cm4gfQoJCQlpZiAoY2FuLnBhZ2UudGFnaXMoW2h0bWwuU0VMRUNULCBodG1sLklOUFVULCBodG1sLlRFWFRBUkVBXSwgZXZlbnQudGFyZ2V0KSkgeyByZXR1cm4gfQoJCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHsibW9kZWwiOiAibm9ybWFsIn0pOyBpZiAobXNnLk9wdGlvbihpY2UuTVNHX0hBTkRMRSkgPT0gaWNlLlRSVUUpIHsgcmV0dXJuIH0KCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNoYXQuT05LRVlET1dOLCBtc2cpOyBpZiAobXNnLk9wdGlvbihpY2UuTVNHX0hBTkRMRSkgPT0gaWNlLlRSVUUpIHsgcmV0dXJuIH0KCQkJY2FuLl9rZXlsaXN0ID0gY2FuLm9ua2V5bWFwLl9wYXJzZShldmVudCwgY2FuLCBtc2cuT3B0aW9uKCJtb2RlbCIpLCBjYW4uX2tleWxpc3QsIGNhbi5fb3V0cHV0KQoJCX0KCX0sCglfYnVpbGQ6IGZ1bmN0aW9uKGNhbikgewoJCWNhbi5jb3JlLkl0ZW0oY2FuLm9ua2V5bWFwLl9tb2RlLCBmdW5jdGlvbihpdGVtLCB2YWx1ZSkgeyB2YXIgZW5naW5lID0ge2xpc3Q6IHt9fQoJCQljYW4uY29yZS5JdGVtKHZhbHVlLCBmdW5jdGlvbihrZXksIGNiKSB7IHZhciBtYXAgPSBlbmdpbmUKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwga2V5Lmxlbmd0aDsgaSsrKSB7CgkJCQkJaWYgKCFtYXAubGlzdFtrZXlbaV1dKSB7IG1hcC5saXN0W2tleVtpXV0gPSB7bGlzdDoge319IH0KCQkJCQltYXAgPSBtYXAubGlzdFtrZXlbaV1dOyBpZiAoaSA9PSBrZXkubGVuZ3RoLTEpIHsgbWFwLmNiID0gY2IgfQoJCQkJfQoJCQl9KSwgY2FuLm9ua2V5bWFwLl9lbmdpbmVbaXRlbV0gPSBlbmdpbmUKCQl9KQoJfSwKCV9wYXJzZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbW9kZSwgbGlzdCwgdGFyZ2V0KSB7IGxpc3QgPSBsaXN0fHxbXQoJCWlmIChbIkNvbnRyb2wiLCAiU2hpZnQiXS5pbmRleE9mKGV2ZW50LmtleSkgPiAtMSkgeyByZXR1cm4gbGlzdCB9CgkJbGlzdC5wdXNoKGV2ZW50LmtleSk7IGZvciAodmFyIHByZSA9IDA7IHByZSA8IGxpc3QubGVuZ3RoOyBwcmUrKykgewoJCQlpZiAoIjAiIDw9IGxpc3RbcHJlXSAmJiBsaXN0W3ByZV0gPD0gIjkiKSB7IGNvbnRpbnVlIH0gYnJlYWsKCQl9OyB2YXIgY291bnQgPSBwYXJzZUludChsaXN0LnNsaWNlKDAsIHByZSkuam9pbigiIikpfHwxCgoJCXZhciBtYXAgPSBjYW4ub25rZXltYXAuX21vZGVbbW9kZV0KCQlmdW5jdGlvbiByZXBlYXQoY2IsIGNvdW50KSB7IGxpc3QgPSBbXTsgZm9yICh2YXIgaSA9IDE7IGkgPD0gY291bnQ7IGkrKykgeyBpZiAoY2IoZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkpIHsgYnJlYWsgfSB9IH0KCQl2YXIgY2IgPSBtYXAgJiYgbWFwW2V2ZW50LmtleV07IGlmIChjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGV2ZW50LmtleS5sZW5ndGggPiAxKSB7IHJlcGVhdChjYiwgY291bnQpOyByZXR1cm4gbGlzdCB9CgkJdmFyIGNiID0gbWFwICYmIG1hcFtldmVudC5rZXkudG9Mb3dlckNhc2UoKV07IGlmIChjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGV2ZW50LmtleS5sZW5ndGggPiAxKSB7IHJlcGVhdChjYiwgY291bnQpOyByZXR1cm4gbGlzdCB9CgoJCXZhciBtYXAgPSBjYW4ub25rZXltYXAuX2VuZ2luZVttb2RlXTsgaWYgKCFtYXApIHsgcmV0dXJuIFtdIH0KCQlmb3IgKHZhciBpID0gcHJlOyBpIDwgbGlzdC5sZW5ndGg7IGkrKyApIHsKCQkJdmFyIG1hcCA9IG1hcC5saXN0W2xpc3RbaV1dOyBpZiAoIW1hcCkgeyByZXR1cm4gW10gfQoJCQlpZiAoaSA9PSBsaXN0Lmxlbmd0aC0xICYmIGNhbi5iYXNlLmlzRnVuYyhtYXAuY2IpKSB7IHJlcGVhdChtYXAuY2IsIGNvdW50KTsgcmV0dXJuIFtdIH0KCQl9CgkJcmV0dXJuIGxpc3QKCX0sCglfbW9kZTogewoJCWluc2VydDogewoJCQlqazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHRhcmdldC5ibHVyKCksIGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0LTEsIHRhcmdldC5zZWxlY3Rpb25TdGFydCkgfSwKCQkJRXNjYXBlOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdGFyZ2V0LmJsdXIoKSB9LAoJCQlFbnRlcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHZhciBoaXMgPSB0YXJnZXQuX2hpc3Rvcnl8fFtdCgkJCQloaXMucHVzaCh0YXJnZXQudmFsdWUpLCB0YXJnZXQuX2hpc3RvcnkgPSBoaXMsIHRhcmdldC5fY3VycmVudCA9IGhpcy5sZW5ndGgKCQkJCWNhbi5wYWdlLnRhZ2lzKGh0bWwuSU5QVVQsIGV2ZW50LnRhcmdldCkgJiYgY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgdGFyZ2V0KQoJCQl9LAoJCX0sCgkJaW5zZXJ0X2N0cmw6IHsKCQkJcDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQl2YXIgaGlzID0gdGFyZ2V0Ll9oaXN0b3J5fHxbXSwgcG9zID0gdGFyZ2V0Ll9jdXJyZW50fHwwCgkJCQlwb3MgPSAtLXBvcyAlIChoaXMubGVuZ3RoKzEpOyBpZiAocG9zIDwgMCkgeyBwb3MgPSBoaXMubGVuZ3RoIH0KCQkJCXRhcmdldC5fY3VycmVudCA9IHBvcywgdGFyZ2V0LnZhbHVlID0gaGlzW3Bvc118fCIiCgkJCX0sCgkJCW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgewoJCQkJdmFyIGhpcyA9IHRhcmdldC5faGlzdG9yeXx8W10sIHBvcyA9IHRhcmdldC5fY3VycmVudHx8MAoJCQkJcG9zID0gKytwb3MgJSAoaGlzLmxlbmd0aCsxKQoJCQkJdGFyZ2V0Ll9jdXJyZW50ID0gcG9zLCB0YXJnZXQudmFsdWUgPSBoaXNbcG9zXXx8IiIKCQkJfSwKCgkJCXU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4ub25rZXltYXAuZGVsZXRlVGV4dCh0YXJnZXQsIDAsIHRhcmdldC5zZWxlY3Rpb25FbmQpIH0sCgkJCWs6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4ub25rZXltYXAuZGVsZXRlVGV4dCh0YXJnZXQsIHRhcmdldC5zZWxlY3Rpb25TdGFydCkgfSwKCQkJaDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0LTEsIDEpIH0sCgkJCWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4ub25rZXltYXAuZGVsZXRlVGV4dCh0YXJnZXQsIDAsIHRhcmdldC5zZWxlY3Rpb25TdGFydCkgfSwKCQkJdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHZhciBzdGFydCA9IHRhcmdldC5zZWxlY3Rpb25TdGFydC0yLCBlbmQgPSB0YXJnZXQuc2VsZWN0aW9uRW5kLTEKCQkJCWZvciAodmFyIGkgPSBzdGFydDsgaSA+PSAwOyBpLS0pIHsKCQkJCQlpZiAodGFyZ2V0LnZhbHVlW2VuZF0gPT0gaWNlLlNQICYmIHRhcmdldC52YWx1ZVtpXSAhPSBpY2UuU1ApIHsgYnJlYWsgfQoJCQkJCWlmICh0YXJnZXQudmFsdWVbZW5kXSAhPSBpY2UuU1AgJiYgdGFyZ2V0LnZhbHVlW2ldID09IGljZS5TUCkgeyBicmVhayB9CgkJCQl9IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgaSsxLCBlbmQtaSkKCQkJfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCgoJaW5wdXQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgaWYgKGV2ZW50Lm1ldGFrZXkpIHsgcmV0dXJuIH0gdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldAoJCXRhcmdldC5fa2V5cyA9IGNhbi5vbmtleW1hcC5fcGFyc2UoZXZlbnQsIGNhbiwgZXZlbnQuY3RybEtleT8gImluc2VydF9jdHJsIjogbWRiLklOU0VSVCwgdGFyZ2V0Ll9rZXlzLCB0YXJnZXQpCgl9LAoJcHJldmVudDogZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCksIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7IHJldHVybiB0cnVlIH0sCglkZWxldGVUZXh0OiBmdW5jdGlvbih0YXJnZXQsIHN0YXJ0LCBjb3VudCkgeyB2YXIgZW5kID0gY291bnQ/IHN0YXJ0K2NvdW50OiB0YXJnZXQudmFsdWUubGVuZ3RoCgkJdmFyIGN1dCA9IHRhcmdldC52YWx1ZS5zbGljZShzdGFydCwgZW5kKQoJCXRhcmdldC52YWx1ZSA9IHRhcmdldC52YWx1ZS5zdWJzdHJpbmcoMCwgc3RhcnQpK3RhcmdldC52YWx1ZS5zdWJzdHJpbmcoZW5kLCB0YXJnZXQudmFsdWUubGVuZ3RoKQoJCXJldHVybiB0YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2Uoc3RhcnQsIHN0YXJ0KSwgY3V0Cgl9LAoJaW5zZXJ0VGV4dDogZnVuY3Rpb24odGFyZ2V0LCB0ZXh0KSB7IHZhciBzdGFydCA9IHRhcmdldC5zZWxlY3Rpb25TdGFydAoJCXZhciBiZWZvcmUgPSB0YXJnZXQudmFsdWUuc2xpY2UoMCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0KQoJCXZhciBhZnRlciA9IHRhcmdldC52YWx1ZS5zbGljZSh0YXJnZXQuc2VsZWN0aW9uRW5kKQoJCXRhcmdldC52YWx1ZSA9IGJlZm9yZSt0ZXh0K2FmdGVyCgkJcmV0dXJuIHRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShzdGFydCsxLCBzdGFydCsxKQoJfSwKCWN1cnNvck1vdmU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBjb3VudCwgYmVnaW4pIHsgYmVnaW4gIT0gdW5kZWZpbmVkICYmIHRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShiZWdpbiwgYmVnaW4pCgkJdGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKHRhcmdldC5zZWxlY3Rpb25TdGFydCtjb3VudCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0K2NvdW50KQoJfSwKfSkKX2Nhbl9uYW1lID0gIiIK",
        "/lib/base.js": "Vm9sY2Fub3MoImJhc2UiLCB7aGVscDogIuaVsOaNruexu+WeiyIsIEludDogZnVuY3Rpb24odmFsLCBkZWYpIHsgcmV0dXJuIHBhcnNlSW50KHZhbCl8fGRlZnx8MCB9LAoJTWluOiBmdW5jdGlvbih2YWwsIG1pbikgeyByZXR1cm4gdmFsID4gbWluPyB2YWw6IG1pbiB9LAoJT2JqOiBmdW5jdGlvbih2YWwsIGRlZikgewoJCXRyeSB7CgkJCWlmICh0eXBlb2YgdmFsID09IGxhbmcuU1RSSU5HKSB7IGlmICh2YWwgPT0gIiIpIHsgcmV0dXJuIGRlZiB9IHZhbCA9IEpTT04ucGFyc2UodmFsKSB9CgkJCWlmICh2YWwubGVuZ3RoID4gMCkgeyByZXR1cm4gdmFsIH0gZm9yICh2YXIgayBpbiB2YWwpIHsgcmV0dXJuIHZhbCB9IHJldHVybiBkZWYKCQl9IGNhdGNoIChlKSB7IHJldHVybiB2YWwgJiYgdmFsLnNwbGl0ICYmIHZhbC5zcGxpdChpY2UuRlMpIHx8IGRlZiB9Cgl9LAoJQ29weTogZnVuY3Rpb24odG8sIGZyb20pIHsKCQlpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyKSB7CgkJCWZvciAodmFyIGsgaW4gZnJvbSkgeyB0b1trXSA9IGZyb21ba10gfQoJCQlyZXR1cm4gdG8KCQl9CgkJZm9yICh2YXIgaSA9IDI7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCQkJdmFyIGsgPSBhcmd1bWVudHNbaV07IHRvW2tdID0gZnJvbVtrXQoJCX0KCQlyZXR1cm4gdG8KCX0sCglFcTogZnVuY3Rpb24odG8sIGZyb20pIHsgdmFyIGNhbGwgPSBhcmd1bWVudHMuY2FsbGVlCgkJaWYgKHR5cGVvZiB0byAhPSB0eXBlb2YgZnJvbSkgeyByZXR1cm4gZmFsc2UgfQoJCWlmICh0eXBlb2YgdG8gPT0gbGFuZy5PQkpFQ1QpIHsKCQkJaWYgKHRvLmxlbmd0aCAhPSBmcm9tLmxlbmd0aCkgeyByZXR1cm4gZmFsc2UgfQoJCQlmb3IgKHZhciBpID0gMDsgaSA8IHRvLmxlbmd0aDsgaSsrKSB7CgkJCQlpZiAoIWNhbGwodG9baV0sIGZyb21baV0pKSB7IHJldHVybiBmYWxzZSB9CgkJCX0KCQkJZm9yICh2YXIgayBpbiB0bykgewoJCQkJaWYgKCFjYWxsKHRvW2tdLCBmcm9tW2tdKSkgeyByZXR1cm4gZmFsc2UgfQoJCQl9CgkJCXJldHVybiB0cnVlCgkJfQoJCXJldHVybiB0byA9PT0gZnJvbQoJfSwKCglFeHQ6IGZ1bmN0aW9uKHBhdGgpIHsgcmV0dXJuIChwYXRoLnNwbGl0KGljZS5QUykucG9wKCkuc3BsaXQoaWNlLlBUKS5wb3AoKSkudG9Mb3dlckNhc2UoKSB9LAoJUGF0aDogZnVuY3Rpb24ocGF0aCkgeyB2YXIgcmVzID0gIiIKCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyBpZiAoIWFyZ3VtZW50c1tpXSkgeyBjb250aW51ZSB9CgkJCXJlcyArPSAoYXJndW1lbnRzW2ldWzBdPT1pY2UuUFMgfHwgcmVzPT0iIiB8fCByZXNbcmVzLmxlbmd0aC0xXT09aWNlLlBTPyAiIjogaWNlLlBTKSArIGFyZ3VtZW50c1tpXS50cmltKCkKCQl9CgkJcmV0dXJuIHJlcwoJfSwKCUFyZ3M6IGZ1bmN0aW9uKCkgeyB2YXIgcmVzID0gW10KCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgKz0gMikgewoJCQlpZiAodHlwZW9mIGFyZ3VtZW50c1tpXSA9PSBsYW5nLk9CSkVDVCkgewoJCQkJZm9yICh2YXIgayBpbiBhcmd1bWVudHNbaV0pIHsgcmVzLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGspKyI9IitlbmNvZGVVUklDb21wb25lbnQoYXJndW1lbnRzW2ldW2tdKSkgfQoJCQkJaS0tOyBjb250aW51ZQoJCQl9IGVsc2UgaWYgKGFyZ3VtZW50c1tpXSkgeyAKCQkJCXJlcy5wdXNoKGVuY29kZVVSSUNvbXBvbmVudChhcmd1bWVudHNbaV0pKyI9IitlbmNvZGVVUklDb21wb25lbnQoYXJndW1lbnRzW2krMV0pKQoJCQl9CgkJfQoJCXJldHVybiByZXMuam9pbigiJiIpCgl9LAoJTWVyZ2VVUkw6IGZ1bmN0aW9uKHVybCkgewoJCXZhciBhcmdzID0ge307ICh1cmwuc3BsaXQoIj8iKVsxXXx8IiIpLnNwbGl0KCImIikuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7IGlmICghaXRlbSkgeyByZXR1cm4gfQoJCQl2YXIgbHMgPSBpdGVtLnNwbGl0KCI9Iik7IGFyZ3NbZGVjb2RlVVJJQ29tcG9uZW50KGxzWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQobHNbMV0pCgkJfSkKCQlmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJCQlzd2l0Y2ggKHR5cGVvZiBhcmd1bWVudHNbaV0pIHsKCQkJCWNhc2UgbGFuZy5TVFJJTkc6IGFyZ3NbYXJndW1lbnRzW2ldXSA9IGFyZ3VtZW50c1tpKzFdLCBpKys7IGJyZWFrCgkJCQljYXNlIGxhbmcuT0JKRUNUOgoJCQkJCWlmIChhcmd1bWVudHNbaV0ubGVuZ3RoID4gMCkgewoJCQkJCQlmb3IgKHZhciBqID0gMDsgaiA8IGFyZ3VtZW50c1tpXS5sZW5ndGg7IGogKz0gMikgeyBhcmdzW2FyZ3VtZW50c1tpXVtqXV0gPSBhcmd1bWVudHNbaV1bal0gfQoJCQkJCX0gZWxzZSB7CgkJCQkJCWZvciAodmFyIGsgaW4gYXJndW1lbnRzW2ldKSB7IGFyZ3Nba10gPSBhcmd1bWVudHNbaV1ba10gfQoJCQkJCX0KCQkJCQlicmVhawoJCQl9CgkJfQoJCXZhciBsaXN0ID0gW107IGZvciAodmFyIGsgaW4gYXJncykgeyBsaXN0LnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGspKyI9IitlbmNvZGVVUklDb21wb25lbnQoYXJnc1trXSkpIH0KCQlyZXR1cm4gdXJsLnNwbGl0KCI/IilbMF0rKGxpc3QubGVuZ3RoPjA/ICI/IitsaXN0LmpvaW4oIiYiKTogIiIpCgl9LAoJUGFyc2VVUkw6IGZ1bmN0aW9uKHVybCkgeyB2YXIgcmVzID0ge2xpbms6IHVybH0KCQl2YXIgbGlzdCA9IHVybC5zcGxpdCgiPyIpOyByZXNbIm9yaWdpbiJdID0gbGlzdFswXQoJCWxpc3RbMV0gJiYgbGlzdFsxXS5zcGxpdCgiJiIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgewoJCQl2YXIgbHMgPSBpdGVtLnNwbGl0KCI9Iik7IHJlc1tkZWNvZGVVUklDb21wb25lbnQobHNbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChsc1sxXSkKCQl9KQoJCXJldHVybiByZXMKCX0sCglQYXJzZUpTT046IGZ1bmN0aW9uKHN0cikgeyB2YXIgcmVzCgkJaWYgKHR5cGVvZiBzdHIgPT0gbGFuZy5PQkpFQ1QpIHsgcmV0dXJuIHN0ciB9CgkJaWYgKHN0ci5pbmRleE9mKCJodHRwIikgPT0gMCkgeyB2YXIgbHMgPSBzdHIuc3BsaXQoIj8iKQoJCQlyZXMgPSB7dHlwZTogbWRiLkxJTkssIG5hbWU6ICIiLCB0ZXh0OiBzdHJ9CgkJCXJlcy5uYW1lID0gbHNbMF0uc3BsaXQoIjovLyIpLnBvcCgpLnNwbGl0KGljZS5QUylbMF0KCQkJbHNbMV0gJiYgbHNbMV0uc3BsaXQoIiYiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGxzID0gaXRlbS5zcGxpdCgiPSIpCgkJCQlyZXNbZGVjb2RlVVJJQ29tcG9uZW50KGxzWzBdKV0gPSBkZWNvZGVVUklDb21wb25lbnQobHNbMV0pCgkJCX0pCgkJCXJldHVybiByZXMKCQl9CgkJdHJ5IHsgcmVzID0gSlNPTi5wYXJzZShzdHIpLCByZXMudGV4dCA9IHJlcy50ZXh0fHxzdHIsIHJlcy50eXBlID0gcmVzLnR5cGV8fG5mcy5KU09OCgkJfSBjYXRjaCAoZSkgeyByZXMgPSB7dHlwZTogbWRiLlRFWFQsIHRleHQ6IHN0cn0gfQoJCXJldHVybiByZXMKCX0sCglQYXJzZVNpemU6IGZ1bmN0aW9uKHNpemUpIHsgc2l6ZSA9IHNpemUudG9Mb3dlckNhc2UoKQoJCWlmIChzaXplLmVuZHNXaXRoKCJ0YiIpIHx8IHNpemUuZW5kc1dpdGgoInQiKSkgewoJCQlyZXR1cm4gcGFyc2VJbnQoc2l6ZSkgKiAxMDI0ICogMTAyNCAqIDEwMjQgKiAxMDI0CgkJfQoJCWlmIChzaXplLmVuZHNXaXRoKCJnYiIpIHx8IHNpemUuZW5kc1dpdGgoImciKSkgewoJCQlyZXR1cm4gcGFyc2VJbnQoc2l6ZSkgKiAxMDI0ICogMTAyNCAqIDEwMjQKCQl9CgkJaWYgKHNpemUuZW5kc1dpdGgoIm1iIikgfHwgc2l6ZS5lbmRzV2l0aCgibSIpKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplKSAqIDEwMjQgKiAxMDI0CgkJfQoJCWlmIChzaXplLmVuZHNXaXRoKCJrYiIpIHx8IHNpemUuZW5kc1dpdGgoImsiKSkgewoJCQlyZXR1cm4gcGFyc2VJbnQoc2l6ZSkgKiAxMDI0CgkJfQoJCXJldHVybiBwYXJzZUludChzaXplKQoJfSwKCglTaXplOiBmdW5jdGlvbihzaXplKSB7IHNpemUgPSBwYXJzZUludChzaXplKQoJCWlmIChzaXplID4gMTAwMDAwMDAwMCkgewoJCQlyZXR1cm4gcGFyc2VJbnQoc2l6ZS8xMDAwMDAwMDAwKSArIGljZS5QVCArIHBhcnNlSW50KHNpemUvMTAwMDAwMDAlMTAwKSArICJHIgoJCX0KCQlpZiAoc2l6ZSA+IDEwMDAwMDApIHsKCQkJcmV0dXJuIHBhcnNlSW50KHNpemUvMTAwMDAwMCkgKyBpY2UuUFQgKyBwYXJzZUludChzaXplLzEwMDAwJTEwMCkgKyAiTSIKCQl9CgkJaWYgKHNpemUgPiAxMDAwKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplLzEwMDApICsgaWNlLlBUICsgcGFyc2VJbnQoc2l6ZS8xMCUxMDApICsgIksiCgkJfQoJCXJldHVybiBzaXplICsgIkIiCgl9LAoJTnVtYmVyOiBmdW5jdGlvbihkLCBuKSB7IHZhciByZXN1bHQgPSBbXQoJCXdoaWxlIChkID4gMCkgeyByZXN1bHQucHVzaChkJTEwKTsgZCA9IHBhcnNlSW50KGQvMTApOyBuLS0gfQoJCXdoaWxlIChuID4gMCkgeyByZXN1bHQucHVzaCgiMCIpOyBuLS0gfQoJCXJldHVybiByZXN1bHQucmV2ZXJzZSgpLCByZXN1bHQuam9pbigiIikKCX0sCglGb3JtYXQ6IGZ1bmN0aW9uKG9iaikgeyByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqKSB9LAoJU2ltcGxlOiBmdW5jdGlvbigpIHsgdmFyIHJlcyA9IFtdCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCQkJdmFyIGFyZyA9IGFyZ3VtZW50c1tpXTsgc3dpdGNoICh0eXBlb2YgYXJndW1lbnRzW2ldKSB7CgkJCQljYXNlIGxhbmcuTlVNQkVSOiByZXMucHVzaChhcmcpOyBicmVhawoJCQkJY2FzZSBsYW5nLlNUUklORzogcmVzLnB1c2goYXJnKTsgYnJlYWsKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6CgkJCQkJaWYgKGFyZy5sZW5ndGggPiAwKSB7IHJlcyA9IHJlcy5jb25jYXQoYXJnKTsgYnJlYWsgfQoJCQkJCWZvciAodmFyIGsgaW4gYXJnKSB7IGsgJiYgYXJnW2tdICYmIHJlcy5wdXNoKGssIGFyZ1trXSkgfQoJCQkJCWJyZWFrCgkJCQlkZWZhdWx0OiByZXMucHVzaChhcmcpOyAKCQkJfQoJCX0KCQlyZXR1cm4gcmVzCgl9LAoJQWRkVW5pcTogZnVuY3Rpb24obGlzdCwgdmFsdWUpIHsgbGlzdCA9IGxpc3R8fFtdOyByZXR1cm4gbGlzdC5pbmRleE9mKHZhbHVlKSA9PSAtMSAmJiBsaXN0LnB1c2godmFsdWUpLCBsaXN0IH0sCgoJRGF0ZTogZnVuY3Rpb24odGltZSkgeyB2YXIgbm93ID0gbmV3IERhdGUoKQoJCWlmICh0eXBlb2YgdGltZSA9PSBsYW5nLlNUUklORyAmJiB0aW1lICE9ICIiKSB7IHZhciBscyA9IHRpbWUuc3BsaXQoaWNlLlNQKQoJCQl2YXIgdnMgPSBsc1swXS5zcGxpdCgiLSIpCgkJCW5vdy5zZXRGdWxsWWVhcihwYXJzZUludCh2c1swXSkpCgkJCW5vdy5zZXRNb250aChwYXJzZUludCh2c1sxXSktMSkKCQkJbm93LnNldERhdGUocGFyc2VJbnQodnNbMl0pKQoKCQkJdmFyIHZzID0gbHNbMV0uc3BsaXQoIjoiKQoJCQlub3cuc2V0SG91cnMocGFyc2VJbnQodnNbMF0pKQoJCQlub3cuc2V0TWludXRlcyhwYXJzZUludCh2c1sxXSkpCgkJCW5vdy5zZXRTZWNvbmRzKHBhcnNlSW50KHZzWzJdKSkKCQl9IGVsc2UgaWYgKHRpbWUpIHsKCQkJbm93ID0gdGltZQoJCX0KCQlyZXR1cm4gbm93Cgl9LAoJVGltZTogZnVuY3Rpb24odGltZSwgZm10KSB7IHZhciBub3cgPSB0aGlzLkRhdGUodGltZSkKCQl2YXIgbGlzdCA9IFsiU3VuIiwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0Il0KCQlmbXQgPSBmbXR8fCIlSDolTTolUyIKCQlmbXQgPSBmbXQucmVwbGFjZSgiJXkiLCBub3cuZ2V0RnVsbFllYXIoKSkKCQlmbXQgPSBmbXQucmVwbGFjZSgiJW0iLCB0aGlzLk51bWJlcihub3cuZ2V0TW9udGgoKSsxLCAyKSkKCQlmbXQgPSBmbXQucmVwbGFjZSgiJWQiLCB0aGlzLk51bWJlcihub3cuZ2V0RGF0ZSgpLCAyKSkKCQlmbXQgPSBmbXQucmVwbGFjZSgiJXciLCBsaXN0W25vdy5nZXREYXkoKV0pCgkJZm10ID0gZm10LnJlcGxhY2UoIiVIIiwgdGhpcy5OdW1iZXIobm93LmdldEhvdXJzKCksIDIpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIlTSIsIHRoaXMuTnVtYmVyKG5vdy5nZXRNaW51dGVzKCksIDIpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIlUyIsIHRoaXMuTnVtYmVyKG5vdy5nZXRTZWNvbmRzKCksIDIpKQoJCXJldHVybiBmbXQKCX0sCglUaW1lQWRkOiBmdW5jdGlvbih0LCBkKSB7IHJldHVybiBuZXcgRGF0ZSh0IC0gdCUoMjQqMzYwMCoxMDAwKSAtIDgqMzYwMCoxMDAwICsgZCoyNCozNjAwKjEwMDApIH0sCglEdXJhdGlvbjogZnVuY3Rpb24obikgeyB2YXIgcmVzID0gIiIsIGggPSAwCgkJaCA9IHBhcnNlSW50KG4vMzYwMDAwMC8yNCksIGggPiAwICYmIChyZXMgKz0gaCsiZCIpLCBuID0gbiAlICgzNjAwMDAwKjI0KQoJCWggPSBwYXJzZUludChuLzM2MDAwMDApLCBoID4gMCAmJiAocmVzICs9IGgrImgiKSwgbiA9IG4gJSAzNjAwMDAwCgkJaCA9IHBhcnNlSW50KG4vNjAwMDApLCBoID4gMCAmJiAocmVzICs9IGgrIm0iKSwgbiA9IG4gJSA2MDAwMAoJCWggPSBwYXJzZUludChuLzEwMDApLCBoID4gMCAmJiAocmVzICs9IGgpLCBuID0gbiAlIDEwMDAKCQlyZXR1cm4gcmVzICsgKG4gPiAwPyBpY2UuUFQrcGFyc2VJbnQobi8xMCk6ICIiKSArICJzIgoJfSwKCgltb2Q6IGZ1bmN0aW9uKGluZGV4LCB0b3RhbCkgewoJCXJldHVybiAoaW5kZXgrdG90YWwpICUgdG90YWwKCX0sCglnZXRWYWxpZDogZnVuY3Rpb24oKSB7CgkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHYgPSBhcmd1bWVudHNbaV0KCQkJaWYgKHR5cGVvZiB2ID09IGxhbmcuT0JKRUNUKSB7CgkJCQlpZiAodiA9PSBudWxsKSB7IGNvbnRpbnVlIH0KCQkJCWZvciAodmFyIGsgaW4gdikgeyByZXR1cm4gdiB9CgkJCQlpZiAodi5sZW5ndGggPiAwKSB7IHJldHVybiB2IH0KCQkJfSBlbHNlIGlmICh0eXBlb2YgdiA9PSBsYW5nLlNUUklORyAmJiB2KSB7CgkJCQlyZXR1cm4gdgoJCQl9IGVsc2UgaWYgKHYgPT0gdW5kZWZpbmVkKSB7CgkJCQljb250aW51ZQoJCQl9IGVsc2UgewoJCQkJcmV0dXJuIHYKCQkJfQoJCX0KCX0sCglpc051bWJlcjogZnVuY3Rpb24odmFsKSB7IHJldHVybiB0eXBlb2YgdmFsID09IGxhbmcuTlVNQkVSIH0sCglpc1N0cmluZzogZnVuY3Rpb24odmFsKSB7IHJldHVybiB0eXBlb2YgdmFsID09IGxhbmcuU1RSSU5HIH0sCglpc09iamVjdDogZnVuY3Rpb24odmFsKSB7IHJldHVybiB0eXBlb2YgdmFsID09IGxhbmcuT0JKRUNUIH0sCglpc0FycmF5OiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5PQkpFQ1QgJiYgdmFsLmxlbmd0aCAhPSB1bmRlZmluZWQgfSwKCWlzRnVuYzogZnVuY3Rpb24odmFsKSB7IHJldHVybiB0eXBlb2YgdmFsID09IGxhbmcuRlVOQ1RJT04gfSwKCWlzRnVuY3Rpb246IGZ1bmN0aW9uKHZhbCkgeyByZXR1cm4gdHlwZW9mIHZhbCA9PSBsYW5nLkZVTkNUSU9OIH0sCglpc0NhbGxiYWNrOiBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiBrZXkuaW5kZXhPZigib24iKSA9PSAwICYmIHR5cGVvZiB2YWx1ZSA9PSBsYW5nLkZVTkNUSU9OIH0sCglpc1VuZGVmaW5lZDogZnVuY3Rpb24odmFsKSB7IHJldHVybiB2YWwgPT0gdW5kZWZpbmVkIH0sCglpc051bGw6IGZ1bmN0aW9uKHZhbCkgeyByZXR1cm4gdmFsID09IG51bGwgfSwKCXJlcGxhY2VBbGw6IGZ1bmN0aW9uKHN0cikgewoJCWZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSArPSAyKSB7IGlmICghYXJndW1lbnRzW2ldKSB7IGNvbnRpbnVlIH0KCQkJaWYgKHN0ci5yZXBsYWNlQWxsKSB7IHN0ciA9IHN0ci5yZXBsYWNlQWxsKGFyZ3VtZW50c1tpXSwgYXJndW1lbnRzW2krMV0pOyBjb250aW51ZSB9CgkJCWlmIChzdHIucmVwbGFjZSkgeyBzdHIgPSBzdHIucmVwbGFjZShhcmd1bWVudHNbaV0sIGFyZ3VtZW50c1tpKzFdKTsgY29udGludWUgfQoJCX0KCQlyZXR1cm4gc3RyCgl9LAoKCWNvdW50OiBmdW5jdGlvbihzdHIsIHMpIHsgdmFyIG4gPSAwCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHsKCQkJaWYgKHN0cltpXSA9PSBzKSB7IG4rKyB9CgkJfQoJCXJldHVybiBuCgl9LAoJcmFuZG9tOiBmdW5jdGlvbihtYXgsIG1pbikgeyBtaW4gPSBtaW58fDAsIHBhcnNlSW50KE1hdGgucmFuZG9tKCkqKG1heC1taW4pKSttaW4gfSwKCWlzTmlnaHQ6IGZ1bmN0aW9uKCkgeyB2YXIgbm93ID0gbmV3IERhdGUoKTsgcmV0dXJuIG5vdy5nZXRIb3VycygpIDwgNyB8fCBub3cuZ2V0SG91cnMoKSA+IDE3IH0sCgliZWdpbldpdGg6IGZ1bmN0aW9uKHN0ciwgYmVnaW4pIHsgcmV0dXJuIHN0ci50cmltKCkuaW5kZXhPZihiZWdpbikgPT0gMCB9LAoJZW5kV2l0aDogZnVuY3Rpb24oc3RyLCBlbmQpIHsgcmV0dXJuIHN0ci5sYXN0SW5kZXhPZihlbmQpICsgZW5kLmxlbmd0aCA9PSBzdHIubGVuZ3RoIH0sCgl0cmltOiBmdW5jdGlvbihhcmdzKSB7IGlmICh0aGlzLmlzU3RyaW5nKGFyZ3MpKSB7IHJldHVybiBhcmdzLnRyaW0oKSB9CgkJaWYgKHRoaXMuaXNBcnJheShhcmdzKSkgeyBmb3IgKHZhciBpID0gYXJncy5sZW5ndGgtMTsgaSA+PSAwOyBpLS0pIHsgaWYgKCFhcmdzW2ldKSB7IGFyZ3MucG9wKCkgfSBlbHNlIHsgYnJlYWsgfSB9IH0KCQlyZXR1cm4gYXJncwoJfSwKCXRyaW1QcmVmaXg6IGZ1bmN0aW9uKHN0ciwgcHJlKSB7IGlmIChzdHIuaW5kZXhPZihwcmUpID09IC0xKSB7IHJldHVybiBzdHIgfSByZXR1cm4gc3RyLnNsaWNlKHByZS5sZW5ndGgpIH0sCgl0cmltU3VmZml4OiBmdW5jdGlvbihzdHIsIGVuZCkgewoJCXZhciBpbmRleCA9IHN0ci5sYXN0SW5kZXhPZihlbmQpCgkJaWYgKGluZGV4ID09IC0xIHx8IGluZGV4K2VuZC5sZW5ndGggIT0gc3RyLmxlbmd0aCkgeyByZXR1cm4gc3RyIH0gcmV0dXJuIHN0ci5zbGljZSgwLCBpbmRleCkKCX0sCglqb2luOiBmdW5jdGlvbihsaXN0LCBzcCkgeyByZXR1cm4gKGxpc3R8fFtdKS5qb2luKHNwfHxpY2UuU1ApIH0sCglqb2luczogZnVuY3Rpb24obGlzdCwgaW5uZXIsIG91dGVyKSB7IAoJCWZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewoJCQlsaXN0W2ldID0gdHlwZW9mIGxpc3RbaV0gPT0gbGFuZy5TVFJJTkc/IGxpc3RbaV06IGxpc3RbaV0uam9pbihpbm5lcnx8aWNlLkZTKQoJCX0KCQlyZXR1cm4gbGlzdC5qb2luKG91dGVyfHxpY2UuU1ApCgl9LAp9KQoK",
        "/lib/core.js": "Vm9sY2Fub3MoImNvcmUiLCB7aGVscDogIuaVsOaNrue7k+aehCIsCglLZXlzOiBzaHkoIui/nuaOpeWZqCIsIGZ1bmN0aW9uKCkgeyB2YXIgbGlzdCA9IFtdCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHYgPSBhcmd1bWVudHNbaV0KCQkJc3dpdGNoICh0eXBlb2YgdikgewoJCQkJY2FzZSBsYW5nLk9CSkVDVDogZm9yICh2YXIgaiA9IDA7IGogPCB2Lmxlbmd0aDsgaisrKSB7IGxpc3QucHVzaCh2W2pdKSB9IGJyZWFrCgkJCQljYXNlIGxhbmcuRlVOQ1RJT046IHYgPSB2KCkKCQkJCWRlZmF1bHQ6IHYgJiYgbGlzdC5wdXNoKHYrIiIpCgkJCX0KCQl9CgkJcmV0dXJuIGxpc3Quam9pbihpY2UuUFQpCgl9KSwKCVZhbHVlOiBzaHkoIuWtmOWCqOWZqCIsIGZ1bmN0aW9uKGRhdGEsIGtleSwgdmFsdWUpIHsKCQlpZiAoZGF0YSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIH0KCQlpZiAoa2V5ID09IHVuZGVmaW5lZCkgeyByZXR1cm4gZGF0YSB9CgoJCWlmICh0eXBlb2Yga2V5ID09IGxhbmcuT0JKRUNUICYmIGtleS5sZW5ndGggPiAwKSB7IGtleSA9IGtleS5qb2luKGljZS5QVCkgfQoJCWlmICh0eXBlb2Yga2V5ID09IGxhbmcuT0JKRUNUKSB7IGZvciAodmFyIGsgaW4ga2V5KSB7IGFyZ3VtZW50cy5jYWxsZWUuY2FsbCh0aGlzLCBkYXRhLCBrLCBrZXlba10pIH0gcmV0dXJuIGRhdGEgfQoKCQlpZiAodmFsdWUgIT0gdW5kZWZpbmVkKSB7CgkJCXZhciBfZGF0YSA9IGRhdGEKCgkJCXZhciBscyA9IGtleS5zcGxpdChpY2UuUFQpCgkJCWZvciAodmFyIGkgPSAwOyBpIDwgbHMubGVuZ3RoOyBpKyspIHsKCQkJCXZhciBfc3ViID0gX2RhdGFbbHNbaV1dfHx7fQoJCQkJX2RhdGFbbHNbaV1dID0gX3N1YgoJCQkJaWYgKGkgPT0gbHMubGVuZ3RoIC0gMSkgewoJCQkJCV9kYXRhW2xzW2ldXSA9IHZhbHVlCgkJCQl9IGVsc2UgewoJCQkJCV9kYXRhID0gX3N1YgoJCQkJfQoJCQl9CgkJCS8vIGRhdGFba2V5XSA9IHZhbHVlCgkJfQoJCWlmIChkYXRhW2tleV0gIT0gdW5kZWZpbmVkKSB7IHJldHVybiBkYXRhW2tleV0gfQoKCQl2YXIgcCA9IGRhdGEsIGxzID0ga2V5LnNwbGl0KGljZS5QVCk7IHdoaWxlIChwICYmIGxzLmxlbmd0aCA+IDApIHsKCQkJaWYgKGxzWzBdID09ICItMSIpIHsgbHNbMF0gPSBwLmxlbmd0aC0xIH0KCQkJcCA9IHBbbHNbMF1dLCBscyA9IGxzLnNsaWNlKDEpCgkJfSByZXR1cm4gcAoJfSksCglTcGxpdDogc2h5KCLliIbor43lmagiLCBmdW5jdGlvbihzdHIpIHsgaWYgKCFzdHIgfHwgIXN0ci5sZW5ndGgpIHsgcmV0dXJuIFtdIH0KCQl2YXIgb3B0ID0ge2RldGFpbDogZmFsc2V9LCBhcmcgPSBbXTsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCQkJdHlwZW9mIGFyZ3VtZW50c1tpXSA9PSBsYW5nLk9CSkVDVD8gb3B0ID0gYXJndW1lbnRzW2ldOiBhcmcucHVzaChhcmd1bWVudHNbaV0pCgkJfQoKCQkvLyDlrZfnrKblrprkuYkKCQlmdW5jdGlvbiBfbGlzdChzdHIpIHsgdmFyIHJlcyA9IHt9OyBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgeyByZXNbc3RyW2ldXSA9IHRydWUgfTsgcmV0dXJuIHJlcyB9CgkJdmFyIHNwYWNlID0gX2xpc3QoYXJnWzBdfHwiXHQgLDtcbiIpICAvLyDnqbrnmb3nrKYKCQl2YXIgYmxvY2sgPSBfbGlzdChhcmdbMV18fCJ7WygpXX0iKSAgIC8vIOWIhumalOespgoJCXZhciBxdW90ZSA9IF9saXN0KGFyZ1syXXx8IidcImAiKSAgICAgLy8g5byV55So56ymCgkJdmFyIHRyYW5zID0gX2xpc3QoYXJnWzNdfHwiXFwiKSAgICAgICAvLyDovazkuYnnrKYKCgkJdmFyIHJlcyA9IFtdLCBiZWdpbiA9IDA7IGZ1bmN0aW9uIHB1c2gob2JqKSB7CgkJCW9iaiAmJiByZXMucHVzaCh0eXBlb2Ygb2JqID09IGxhbmcuU1RSSU5HIHx8IG9wdC5kZXRhaWw/IG9iajogb2JqLnRleHQpLCBiZWdpbiA9IC0xCgkJfQoKCQkvLyDlvIDlp4vliIbor40KCQlmb3IgKHZhciBzID0gIiIsIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7CgkJCWlmIChzcGFjZVtzdHJbaV1dKSB7IC8vIOepuueZveespgoJCQkJaWYgKHMpIHsgY29udGludWUgfQoJCQkJYmVnaW4gPiAtMSAmJiBwdXNoKHN0ci5zbGljZShiZWdpbiwgaSkpCgkJCQlvcHQuZGV0YWlsICYmIHB1c2goe3R5cGU6IGh0bWwuU1BBQ0UsIHRleHQ6IHN0ci5zbGljZShpLCBpKzEpfSkKCgkJCX0gZWxzZSBpZiAoYmxvY2tbc3RyW2ldXSkgeyAvLyDliIbpmpTnrKYKCQkJCWlmIChzKSB7IGNvbnRpbnVlIH0KCQkJCWJlZ2luID4gLTEgJiYgcHVzaChzdHIuc2xpY2UoYmVnaW4sIGkpKQoJCQkJcHVzaChzdHIuc2xpY2UoaSwgaSsxKSkKCgkJCX0gZWxzZSBpZiAocXVvdGVbc3RyW2ldXSkgeyAvLyDlvJXnlKjnrKYKCQkJCWlmIChzID09ICIiKSB7CgkJCQkJYmVnaW4gPiAtMSAmJiBwdXNoKHN0ci5zbGljZShiZWdpbiwgaSkpCgkJCQkJcyA9IHN0cltpXSwgYmVnaW4gPSBpKzEKCQkJCX0gZWxzZSBpZiAocyA9PSBzdHJbaV0pIHsKCQkJCQlwdXNoKHt0eXBlOiBsYW5nLlNUUklORywgdGV4dDogc3RyLnNsaWNlKGJlZ2luLCBpKSwgbGVmdDogcywgcmlnaHQ6IHN0cltpXX0pCgkJCQkJcyA9ICIiLCBiZWdpbiA9IC0xCgkJCQl9CgoJCQl9IGVsc2UgaWYgKHRyYW5zW3N0cltpXV0pIHsgLy8g6L2s5LmJ56ymCgkJCQliZWdpbiA9PSAtMSAmJiAoYmVnaW4gPSBpKyspCgoJCQl9IGVsc2UgeyAvLyDmma7pgJrnrKYKCQkJCWJlZ2luID09IC0xICYmIChiZWdpbiA9IGkpCgkJCX0KCQl9CgoJCS8vIOWJqeS9meWtl+espgoJCWJlZ2luID49IDAgJiYgKHM/IHB1c2goe3R5cGU6IGxhbmcuU1RSSU5HLCB0ZXh0OiBzdHIuc2xpY2UoYmVnaW4pLCBsZWZ0OiBzLCByaWdodDogIiJ9KTogcHVzaChzdHIuc2xpY2UoYmVnaW4pKSkKCQlyZXR1cm4gcmVzCgl9KSwKCUNhbGxGdW5jOiBzaHkoIuiwg+eUqOWZqCIsIGZ1bmN0aW9uKGZ1bmMsIGFyZ3MsIG1vZCkgeyBhcmdzID0gYXJnc3x8e30KCQl2YXIgZXZlbnQgPSBhcmdzWyJldmVudCJdfHx7fSwgY2FuID0gYXJnc1siY2FuIl18fGFyZ3NbMF0sIG1zZyA9IGFyZ3NbIm1zZyJdfHxhcmdzWzFdLCBjbWRzID0gYXJnc1siY21kcyJdfHxbXQoKCQkvLyDmn6Xmib7osIPnlKgKCQlmdW5jID0gdHlwZW9mIGZ1bmMgPT0gbGFuZy5GVU5DVElPTj8gZnVuYzogdHlwZW9mIGZ1bmMgPT0gbGFuZy5TVFJJTkc/IHRoaXMuVmFsdWUobW9kfHxjYW4sIGZ1bmMpOgoJCQl0eXBlb2YgZnVuYyA9PSBsYW5nLk9CSkVDVCAmJiBmdW5jLmxlbmd0aCA+IDA/IHRoaXMuVmFsdWUoZnVuY1swXSwgdGhpcy5LZXlzKGZ1bmMuc2xpY2UoMSkpKTogbnVsbAoJCWlmICh0eXBlb2YgZnVuYyAhPSBsYW5nLkZVTkNUSU9OKSB7IHJldHVybiB9CgoJCS8vIOino+aekOWPguaVsAoJCXZhciBsaXN0ID0gW10sIGVjaG8gPSBmYWxzZSwgY2IgPSBhcmdzWyJjYiJdCgkJdGhpcy5MaXN0KGZ1bmMudG9TdHJpbmcoKS5zcGxpdCgiKSIpWzBdLnNwbGl0KCIoIilbMV0uc3BsaXQoaWNlLkZTKSwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsgaXRlbSA9IGl0ZW0udHJpbSgpOyBpZiAoaXRlbSA9PSAiIikgeyByZXR1cm4gfQoJCQl2YXIgYXJnID0gYXJnc1tpdGVtXSB8fCBtc2cmJm1zZy5PcHRpb24mJm1zZy5PcHRpb24oaXRlbSkgfHwgY2FuJiZjYW4uQ29uZiYmY2FuLkNvbmYoaXRlbSkgfHwKCQkJCWV2ZW50JiYhKGV2ZW50IGluc3RhbmNlb2YgRXZlbnQpJiZldmVudFtpdGVtXSB8fCBhcmdzW2luZGV4XSB8fCBjbWRzW2luZGV4XSB8fCBudWxsCgkJCWlmIChpdGVtID09ICJjYiIpIHsgZWNobyA9IHRydWUgfQoJCQlsaXN0LnB1c2goYXJnKQoJCX0pCgoJCS8vIOaJp+ihjOiwg+eUqAoJCXZhciByZXMgPSBmdW5jLmFwcGx5KG1vZHx8Y2FuLCBsaXN0KQoJCWlmICghZWNobyAmJiB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTikgeyByZXMgJiYgbXNnICYmIG1zZy5FY2hvKHJlcyksIGFyZ3VtZW50cy5jYWxsZWUuYXBwbHkodGhpcywgW2NiLCB7bXNnOiBtc2csIHJlczogcmVzfV0pIH0KCQlyZXR1cm4gcmVzCgl9KSwKCglMaXN0OiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKGxpc3QsIGNiLCBpbnRlcnZhbCwgY2JzKSB7CgkJaWYgKHR5cGVvZiBsaXN0ID09IGxhbmcuU1RSSU5HKSB7IC8vIOm7mOiupOW6j+WIlwoJCQlsaXN0ID0gW2xpc3RdCgkJfSBlbHNlIGlmICh0eXBlb2YgbGlzdCA9PSBsYW5nLk5VTUJFUikgeyAvLyDnrYnlt67luo/liJcgW2VuZCBjYiBpbnRlcnZhbF18W2JlZ2luIGVuZCBpbnRlcnZhbF0KCQkJdmFyIGJlZ2luID0gMCwgZW5kID0gbGlzdCwgc3RlcCA9IHR5cGVvZiBpbnRlcnZhbCA9PSBsYW5nLk5VTUJFUj8gaW50ZXJ2YWw6IDEKCQkJaWYgKHR5cGVvZiBjYiA9PSBsYW5nLk5VTUJFUikgeyBiZWdpbiA9IGxpc3QsIGVuZCA9IGNiLCBjYiA9IG51bGwgfQoJCQlsaXN0ID0gW107IGZvciAodmFyIGkgPSBiZWdpbjsgaSA8IGVuZDsgaSArPSBzdGVwKSB7IGxpc3QucHVzaChpKSB9CgkJfQoKCQlsaXN0ID0gbGlzdHx8W10KCQlpZiAoaW50ZXJ2YWwgPiAwKSB7IC8vIOaXtumXtOW6j+WIlwoJCQlmdW5jdGlvbiBsb29wKGkpIHsgaWYgKGkgPj0gbGlzdC5sZW5ndGgpIHsgcmV0dXJuIHR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnMobGlzdCkgfQoJCQkJY2IobGlzdFtpXSwgaSwgbGlzdCksIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IGxvb3AoaSsxKSB9LCBpbnRlcnZhbCkKCQkJfQoJCQl0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTiAmJiBsaXN0Lmxlbmd0aCA+IDAgJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcCgwKSB9LCBpbnRlcnZhbC80KQoJCX0gZWxzZSB7IC8vIOmAieaLqeW6j+WIlwoJCQl2YXIgc2xpY2UgPSBbXSwgcmVzCgkJCWZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewoJCQkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04/IChyZXMgPSBjYihsaXN0W2ldLCBpLCBsaXN0KSkgIT0gdW5kZWZpbmVkICYmIHNsaWNlLnB1c2gocmVzKTogc2xpY2UucHVzaChsaXN0W2ldKQoJCQl9OyBsaXN0ID0gc2xpY2UKCQl9CgkJcmV0dXJuIGxpc3QKCX0pLAoJTmV4dDogc2h5KCLov63ku6PlmagiLCBmdW5jdGlvbihsaXN0LCBjYiwgY2JzKSB7CgkJc3dpdGNoICh0eXBlb2YgbGlzdCkgewoJCQljYXNlIGxhbmcuT0JKRUNUOiBpZiAobGlzdCA9PSBudWxsKSB7IGxpc3QgPSBbXTsgYnJlYWsgfQoJCQkJaWYgKGxpc3QubGVuZ3RoID09IHVuZGVmaW5lZCkgeyB2YXIgbHMgPSBbXTsgZm9yICh2YXIgayBpbiBsaXN0KSB7IGxzLnB1c2goaykgfSBsaXN0ID0gbHMgfSBicmVhawoJCQlkZWZhdWx0OiBpZiAobGlzdCA9PSB1bmRlZmluZWQpIHsgbGlzdCA9IFtdOyBicmVhayB9CgkJCQlsaXN0ID0gW2xpc3RdCgkJfQoKCQlmdW5jdGlvbiBuZXh0KGkpIHsgaSA8IGxpc3QubGVuZ3RoPyAgdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IobGlzdFtpXSwgZnVuY3Rpb24oKSB7IG5leHQoaSsxKSB9LCBpLCBsaXN0KToKCQkJCXR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnMobGlzdCkgfQoJCXJldHVybiBuZXh0KDApLCBsaXN0Cgl9KSwKCUl0ZW1zOiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKG9iaiwgY2IpIHsgdmFyIGxpc3QgPSBbXQoJCWZvciAodmFyIGsgaW4gb2JqKSB7CgkJCWxpc3QgPSBsaXN0LmNvbmNhdCh0aGlzLkxpc3Qob2JqW2tdLCBmdW5jdGlvbih2LCBpKSB7CgkJCQlyZXR1cm4gdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IodiwgaSwgaywgb2JqKQoJCQl9KSkKCQl9CgkJcmV0dXJuIGxpc3QKCX0pLAoJSXRlbVNvcnQ6IHNoeSgi6L+t5Luj5ZmoIiwgZnVuY3Rpb24ob2JqLCBrZXksIGNiKSB7IHZhciBsaXN0ID0gW10KCQl2YXIgb3JkZXIgPSBbXSwga2V5cyA9IHt9LCB2YWxzID0ge30sIGkgPSAwCgkJZm9yICh2YXIgayBpbiBvYmopIHsgbyA9IG9ialtrXVtrZXldfHxpKysKCQkJb3JkZXIucHVzaChvKSwga2V5c1tvXSA9IGssIHZhbHNbb10gPSBvYmpba10KCQl9OyBvcmRlci5zb3J0KCkKCgkJZm9yICh2YXIgaSBpbiBvcmRlcikgeyB2YXIgayA9IG9yZGVyW2ldCgkJCXZhciByZXMgPSB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTj8gY2Ioa2V5c1trXSwgdmFsc1trXSk6IGsKCQkJcmVzICE9IHVuZGVmaW5lZCAmJiBsaXN0LnB1c2gocmVzKQoJCX0KCQlyZXR1cm4gbGlzdAoJfSksCglJdGVtOiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKG9iaiwgY2IpIHsgdmFyIGxpc3QgPSBbXQoJCWZvciAodmFyIGsgaW4gb2JqKSB7CgkJCXZhciByZXMgPSB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTj8gY2Ioaywgb2JqW2tdKTogawoJCQlyZXMgIT0gdW5kZWZpbmVkICYmIGxpc3QucHVzaChyZXMpCgkJfQoJCXJldHVybiBsaXN0Cgl9KSwKCUl0ZW1DQjogc2h5KCLov63ku6PlmagiLCBmdW5jdGlvbihtZXRhLCBjYiwgY2FuLCBpdGVtKSB7IHZhciBsaXN0ID0gW10KCQlmb3IgKHZhciBrIGluIG1ldGEpIHsgKGZ1bmN0aW9uKGspIHsKCQkJaWYgKGsuaW5kZXhPZigib24iKSA9PSAwICYmIHR5cGVvZiBtZXRhW2tdID09IGxhbmcuRlVOQ1RJT04pIHsKCQkJCWlmICh0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTikgewoJCQkJCWNiKGssIG1ldGFba10pCgkJCQl9IGVsc2UgewoJCQkJCWNiW2tdID0gZnVuY3Rpb24oZXZlbnQpIHsgbWV0YVtrXShldmVudCwgY2FuLCBpdGVtKSB9CgkJCQl9CgkJCQlsaXN0LnB1c2goaykKCQkJfQoJCX0pKGspIH0KCQlyZXR1cm4gbGlzdAoJfSksCgoJU3BsaXRJbnB1dDogZnVuY3Rpb24oaXRlbSwgdHlwZSkgeyBpZiAodHlwZW9mIGl0ZW0gPT0gbGFuZy5PQkpFQ1QpIHsgcmV0dXJuIGl0ZW0gfQoJCXR5cGUgPSB0eXBlfHxodG1sLlRFWFQ7IHN3aXRjaCAoaXRlbSkgewoJCQljYXNlIG1kYi5MSVNUOiByZXR1cm4ge3R5cGU6IHR5cGUgPSBodG1sLkJVVFRPTiwgbmFtZTogaXRlbSwgYWN0aW9uOiBpY2UuQVVUT30KCQkJY2FzZSBjbGkuQkFDSzogcmV0dXJuIHt0eXBlOiB0eXBlID0gaHRtbC5CVVRUT04sIG5hbWU6IGl0ZW19CgkJCWNhc2UgbWRiLk5BTUU6IHJldHVybiB7dHlwZTogdHlwZSA9IGh0bWwuVEVYVCwgbmFtZTogaXRlbX0KCQkJY2FzZSBtZGIuVEVYVDogcmV0dXJuIHt0eXBlOiB0eXBlID0gaHRtbC5URVhUQVJFQSwgbmFtZTogaXRlbX0KCQkJZGVmYXVsdDogdmFyIGxzID0gdGhpcy5TcGxpdChpdGVtLCAiICIsICI6PUAiKSwgcmVzID0ge3R5cGU6IHR5cGUsIG5hbWU6IGxzWzBdfTsgZm9yICh2YXIgaSA9IDE7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgewoJCQkJCXN3aXRjaCAobHNbaV0pIHsKCQkJCQkJY2FzZSAiOiI6IHJlc1ttZGIuVFlQRV0gPSBsc1tpKzFdOyBicmVhawoJCQkJCQljYXNlICI9IjoKCQkJCQkJCWlmIChyZXNbbWRiLlRZUEVdID09IGh0bWwuU0VMRUNUKSB7CgkJCQkJCQkJcmVzLnZhbHVlcyA9IHRoaXMuU3BsaXQobHNbaSsxXSkKCQkJCQkJCQlmb3IgKHZhciBqID0gMTsgaiA8IHJlcy52YWx1ZXMubGVuZ3RoOyBqKyspIHsKCQkJCQkJCQkJaWYgKHJlcy52YWx1ZXNbMF0gPT0gIiIgfHwgcmVzLnZhbHVlc1swXSA9PSByZXMudmFsdWVzW2pdKSB7CgkJCQkJCQkJCQlyZXMudmFsdWUgPSByZXMudmFsdWVzWzBdLCByZXMudmFsdWVzID0gcmVzLnZhbHVlcy5zbGljZSgxKQoJCQkJCQkJCQkJYnJlYWsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJcmVzLnZhbHVlID0gbHNbaSsxXQoJCQkJCQkJfQoJCQkJCQkJYnJlYWsKCQkJCQkJY2FzZSAiQCI6IHJlc1tjdHguQUNUSU9OXSA9IGxzW2krMV07IGJyZWFrCgkJCQkJfQoJCQkJfSByZXR1cm4gcmVzCgkJfQoJfSwKCVRpbWVyMzAwbXM6IGZ1bmN0aW9uKGNiKSB7IHRoaXMuVGltZXIoMzAwLCBjYikgfSwKCVRpbWVyMzAwOiBmdW5jdGlvbihjYikgeyB0aGlzLlRpbWVyKDMwMCwgY2IpIH0sCglUaW1lcjNzOiBmdW5jdGlvbihjYikgeyB0aGlzLlRpbWVyKDMwMDAsIGNiKSB9LAoJVGltZXI6IHNoeSgi5a6a5pe25ZmoLCB2YWx1ZSwgWzEsMiwzLDRdLCB7aW50ZXJ2YWwsIGxlbmd0aH0iLCBmdW5jdGlvbihpbnRlcnZhbCwgY2IsIGNicykgewoJCXZhciB0aW1lciA9IHtzdG9wOiBmYWxzZX07IGZ1bmN0aW9uIGxvb3AoaSkgewoJCQl0aW1lci5zdG9wIHx8IGkgPj0gaW50ZXJ2YWwubGVuZ3RoICYmIGludGVydmFsLmxlbmd0aCA+PSAwIHx8IGNiKHRpbWVyLCBpbnRlcnZhbC5pbnRlcnZhbHx8aW50ZXJ2YWxbaV0sIGksIGludGVydmFsKT8KCQkJCXR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnModGltZXIsIGludGVydmFsKTogc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcChpKzEpIH0sIGludGVydmFsLmludGVydmFsfHxpbnRlcnZhbFtpKzFdKQoJCX0KCgkJaW50ZXJ2YWwgPSB0eXBlb2YgaW50ZXJ2YWwgPT0gbGFuZy5PQkpFQ1Q/IGludGVydmFsOiBbaW50ZXJ2YWxdCgkJaWYgKGludGVydmFsLmludGVydmFsID09IDApIHsgY2IoKTsgcmV0dXJuIHRpbWVyIH0KCgkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcCgwKSB9LCBpbnRlcnZhbC5pbnRlcnZhbHx8aW50ZXJ2YWxbMF0pCgkJcmV0dXJuIHRpbWVyCgl9KSwKfSkKCg==",
        "/lib/misc.js": "Vm9sY2Fub3MoIm1pc2MiLCB7aGVscDogIumAmuS/oeWNj+iuriIsIE1lc3NhZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IHt9IAoJdmFyIHByb3RvID0ge19ldmVudDogZXZlbnQsIF9jYW46IGNhbiwKCQlSdW5BY3Rpb246IGZ1bmN0aW9uKGV2ZW50LCBzdWIsIGNtZHMsIG1ldGEpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KTsgbWV0YSA9IG1ldGEgfHwgc3ViJiZzdWIub25hY3Rpb24gfHwge30KCQkJaWYgKG1zZy5PcHRpb24oaWNlLk1TR19IQU5ETEUpID09IGljZS5UUlVFKSB7IHJldHVybiB9CgkJCWlmIChjbWRzICYmIGNtZHNbMF0gPT0gY3R4LkFDVElPTiAmJiBjYW4uYmFzZS5pc0Z1bmMobWV0YVtjbWRzWzFdXSkpIHsKCQkJCXJldHVybiBtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFLCBpY2UuVFJVRSksIGNhbi5jb3JlLkNhbGxGdW5jKG1ldGFbY21kc1sxXV0sIHtldmVudDogZXZlbnQsIGNhbjogc3ViLCBtc2c6IG1zZywgYnV0dG9uOiBjbWRzWzFdLCBjbWQ6IGNtZHNbMV19KSwgdHJ1ZQoJCQl9CgkJCXJldHVybiBmYWxzZQoJCX0sCgkJRGlzcGxheTogZnVuY3Rpb24oZmlsZSkgeyBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSwgZmlsZSkgfSwKCQlEaXNwbGF5U3Rvcnk6IGZ1bmN0aW9uKGZpbGUpIHsgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVksICIvcGx1Z2luL3N0b3J5LyIrZmlsZSkgfSwKCQlPcHRpb25TdGF0dXM6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbXNnLk9wdGlvbihpY2UuTVNHX1NUQVRVUykgfSwKCQlPcHRpb25Qcm9jZXNzOiBmdW5jdGlvbigpIHsgcmV0dXJuIG1zZy5PcHRpb24oaWNlLk1TR19QUk9DRVNTKSB9LAoJCU9wdGlvbk9yU2VhcmNoOiBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIGNhbi5taXNjLlNlYXJjaChjYW4sIGtleSl8fG1zZy5PcHRpb24oa2V5KSB9LAoJCU9wdGlvbjogZnVuY3Rpb24oa2V5LCB2YWwpIHsKCQkJaWYgKGtleSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIG1zZyAmJiBtc2cub3B0aW9uIHx8IFtdIH0KCQkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsgY2FuLmNvcmUuSXRlbShrZXksIG1zZy5PcHRpb24pIH0KCQkJaWYgKHZhbCA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIG1zZyAmJiBtc2dba2V5XSAmJiBtc2dba2V5XVswXSB8fCAiIiB9CgkJCXJldHVybiBtc2cub3B0aW9uID0gY2FuLmJhc2UuQWRkVW5pcShtc2cub3B0aW9uLCBrZXkpLCBtc2dba2V5XSA9IGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKS5zbGljZSgxKSwgdmFsCgkJfSwKCQlBcHBlbmQ6IGZ1bmN0aW9uKGtleSwgdmFsKSB7CgkJCWlmIChrZXkgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBtc2cgJiYgbXNnLmFwcGVuZCB8fCBbXSB9CgkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7IGNhbi5jb3JlLkl0ZW0oa2V5LCBtc2cuQXBwZW5kKSB9CgkJCWlmICh2YWwgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBtc2cgJiYgbXNnW2tleV0gJiYgbXNnW2tleV1bMF0gfHwgIiIgfQoJCQlyZXR1cm4gbXNnLmFwcGVuZCA9IGNhbi5iYXNlLkFkZFVuaXEobXNnLmFwcGVuZCwga2V5KSwgbXNnW2tleV0gPSBjYW4uY29yZS5MaXN0KGFyZ3VtZW50cykuc2xpY2UoMSksIHZhbAoJCX0sCgkJUmVzdWx0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1zZy5yZXN1bHQgJiYgbXNnLnJlc3VsdC5qb2luKCIiKSB8fCAiIiB9LAoKCQlMZW5ndGg6IGZ1bmN0aW9uKCkgewoJCQl2YXIgbWF4ID0gIiIsIGxlbiA9IDA7IGNhbi5jb3JlLkxpc3QobXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCBpbmRleCkgewoJCQkJaWYgKG1zZ1trZXldICYmIG1zZ1trZXldLmxlbmd0aCA+IGxlbikgeyBtYXggPSBrZXksIGxlbiA9IG1zZ1trZXldLmxlbmd0aCB9CgkJCX0pCgkJCXJldHVybiBsZW4KCQl9LAoJCVRhYmxlOiBmdW5jdGlvbihjYikgeyBpZiAoIW1zZy5hcHBlbmQgfHwgbXNnLmFwcGVuZC5sZW5ndGggPT0gMCkgeyByZXR1cm4gfQoJCQl2YXIgbWF4ID0gIiIsIGxlbiA9IDA7IGNhbi5jb3JlLkxpc3QobXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCBpbmRleCkgewoJCQkJaWYgKG1zZ1trZXldICYmIG1zZ1trZXldLmxlbmd0aCA+IGxlbikgeyBtYXggPSBrZXksIGxlbiA9IG1zZ1trZXldLmxlbmd0aCB9CgkJCX0pCgoJCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChtc2dbbWF4XSwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBhcnJheSkgeyB2YXIgb25lID0ge30sIHJlcwoJCQkJY2FuLmNvcmUuTGlzdChtc2cuYXBwZW5kLCBmdW5jdGlvbihrZXkpIHsgb25lW2tleV0gPSAobXNnW2tleV0mJm1zZ1trZXldW2luZGV4XXx8IiIpIH0pCgkJCQlyZXR1cm4gY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiAocmVzID0gY2Iob25lLCBpbmRleCwgYXJyYXkpKSAmJiByZXMgIT0gdW5kZWZpbmVkICYmIHJlcyB8fCBvbmUKCQkJfSkKCQl9LAoJCUNsZWFyOiBmdW5jdGlvbihrZXkpIHsgc3dpdGNoIChrZXl8fGljZS5NU0dfQVBQRU5EKSB7CgkJCWNhc2UgaWNlLk1TR19BUFBFTkQ6CgkJCWNhc2UgaWNlLk1TR19PUFRJT046CgkJCQljYW4uY29yZS5MaXN0KG1zZ1trZXldLCBmdW5jdGlvbihpdGVtKSB7IGRlbGV0ZShtc2dbaXRlbV0pIH0pCgkJCWRlZmF1bHQ6IG1zZ1trZXldID0gW10KCQl9IH0sCgkJQ29weTogZnVuY3Rpb24ocmVzKSB7IGlmICghcmVzKSB7IHJldHVybiBtc2cgfQoJCQlyZXMucmVzdWx0ICYmIChtc2cucmVzdWx0ID0gKG1zZy5yZXN1bHR8fFtdKS5jb25jYXQocmVzLnJlc3VsdCkpCgkJCXJlcy5hcHBlbmQgJiYgKG1zZy5hcHBlbmQgPSByZXMuYXBwZW5kKSAmJiByZXMuYXBwZW5kLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgewoJCQkJdmFyIGkgPSBtc2cub3B0aW9uICYmIG1zZy5vcHRpb24uaW5kZXhPZihpdGVtKTsgaWYgKGkgPiAtMSkgewoJCQkJCW1zZy5vcHRpb25baV0gPSAiIiwgZGVsZXRlKG1zZ1tpdGVtXSkKCQkJCX0KCQkJCXJlc1tpdGVtXSAmJiAobXNnW2l0ZW1dID0gKG1zZ1tpdGVtXXx8W10pLmNvbmNhdChyZXNbaXRlbV0pKQoJCQl9KQoJCQlyZXMub3B0aW9uICYmIChtc2cub3B0aW9uID0gcmVzLm9wdGlvbikgJiYgcmVzLm9wdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCXJlc1tpdGVtXSAmJiAobXNnW2l0ZW1dID0gcmVzW2l0ZW1dKQoJCQl9KQoJCQlyZXMuX29wdGlvbiAmJiAobXNnLl9vcHRpb24gPSByZXMuX29wdGlvbikgJiYgcmVzLl9vcHRpb24uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CgkJCQlyZXNbaXRlbV0gJiYgKG1zZ1tpdGVtXSA9IHJlc1tpdGVtXSkKCQkJfSkKCQkJcmV0dXJuIG1zZwoJCX0sCgkJUHVzaDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgZGV0YWlsKSB7CgkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7CgkJCQl2YWx1ZSA9IHZhbHVlfHxjYW4uY29yZS5JdGVtKGtleSksIGNhbi5jb3JlLkxpc3QodmFsdWUsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQlkZXRhaWw/IG1zZy5QdXNoKG1kYi5LRVksIGl0ZW0pLlB1c2gobWRiLlZBTFVFLCBrZXlbaXRlbV18fCIiKTogbXNnLlB1c2goaXRlbSwga2V5W2l0ZW1dfHwiIikKCQkJCX0pCgkJCQlyZXR1cm4gbXNnCgkJCX0KCgkJCW1zZy5hcHBlbmQgPSBjYW4uYmFzZS5BZGRVbmlxKG1zZy5hcHBlbmQsIGtleSksIG1zZ1trZXldID0gbXNnW2tleV0gfHwgW10KCQkJbXNnW2tleV0ucHVzaChjYW4uYmFzZS5pc1N0cmluZyh2YWx1ZSl8fGNhbi5iYXNlLmlzRnVuY3Rpb24odmFsdWUpPyB2YWx1ZTogSlNPTi5zdHJpbmdpZnkodmFsdWUpKQoJCQlyZXR1cm4gbXNnCgkJfSwKCQlTdGF0dXM6IGZ1bmN0aW9uKG9iaikgeyBtc2cuT3B0aW9uKGljZS5NU0dfU1RBVFVTLCBKU09OLnN0cmluZ2lmeShjYW4uY29yZS5JdGVtKG9iaiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4ge25hbWU6IGtleSwgdmFsdWU6IHZhbHVlfSB9KSkpIH0sCgkJU3RhdHVzVGltZUNvdW50OiBmdW5jdGlvbihvYmopIHsgbXNnLmFwcGVuZCAmJiBtc2cuU3RhdHVzKGNhbi5iYXNlLkNvcHkoeyJ0aW1lIjogY2FuLmJhc2UuVGltZSgpLCAiY291bnQiOiBtc2cuTGVuZ3RoKCkrIngiK21zZy5hcHBlbmQubGVuZ3RofSwgb2JqKSkgfSwKCQlFY2hvOiBmdW5jdGlvbihyZXMpIHsgbXNnLnJlc3VsdCA9IG1zZy5yZXN1bHQgfHwgW10KCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgbXNnLnJlc3VsdC5wdXNoKGFyZ3VtZW50c1tpXSkgfQoJCQlyZXR1cm4gbXNnLl9oYW5kID0gdHJ1ZSwgbXNnCgkJfSwKCQlEdW1wOiBmdW5jdGlvbihjYW4pIHsKCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJfSwKCX0KCXJldHVybiBjYW4ubWlzYy5wcm90byhtc2csIHByb3RvKQp9LAoJUE9TVDogZnVuY3Rpb24oY2FuLCBtc2csIHVybCwgZm9ybSwgY2IpIHsgLy8gX21ldGhvZCBfYWNjZXB0IF91cGxvYWQgX3Byb2dyZXNzCgkJdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyBtc2cuX3hociA9IHhocgoJCXhoci5vcGVuKG1zZy5fbWV0aG9kfHwiUE9TVCIsIHVybCksIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9IDQpIHsgcmV0dXJuIH0KCgkJCXRyeSB7IC8vIOino+aekOWTjeW6lAoJCQkJdmFyIHJlcyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkKCQkJfSBjYXRjaCAoZSkgewoJCQkJdmFyIHJlcyA9IHtyZXN1bHQ6IFt4aHIucmVzcG9uc2VUZXh0XX0KCQkJfQoJCQlpZiAoeGhyLnN0YXR1cyA9PSAyMDApIHsKCQkJCXJldHVybiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZy5Db3B5KHJlcykpCgkJCX0KCQkJY2FuLnVzZXIudG9hc3QoY2FuLCByZXMsIHhoci5zdGF0dXMpCgkJfQoKCQlpZiAobXNnLl91cGxvYWQpIHsgLy8g5LiK5Lyg5paH5Lu2CgkJCXZhciBkYXRhID0gbmV3IEZvcm1EYXRhKCk7IGNhbi5jb3JlLkl0ZW1zKGZvcm0sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwga2V5KSB7CgkJCQlkYXRhLmFwcGVuZChrZXksIHZhbHVlKQoJCQl9KSwgZGF0YS5hcHBlbmQoaHRtbC5VUExPQUQsIG1zZy5fdXBsb2FkKSwgZGF0YS5hcHBlbmQoaWNlLk1TR19VUExPQUQsIG1kYi5VUExPQUQpCgoJCQl4aHIudXBsb2FkLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLmJhc2UuaXNGdW5jKG1zZy5fcHJvZ3Jlc3MpICYmIG1zZy5fcHJvZ3Jlc3MoZXZlbnQsIHBhcnNlSW50KGV2ZW50LmxvYWRlZCoxMDAvZXZlbnQudG90YWwpLCBldmVudC50b3RhbCwgZXZlbnQubG9hZGVkKQoJCQl9CgkJfSBlbHNlIHsgLy8g6K+35rGC5pWw5o2uCgkJCXZhciBkYXRhID0gY2FuLmNvcmUuSXRlbXMoZm9ybSwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBrZXkpIHsgcmV0dXJuIGtleSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSB9KS5qb2luKCImIikKCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQoJCX0KCgkJLy8g5Y+R6YCB6K+35rGCCgkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIkFjY2VwdCIsIG1zZy5fYWNjZXB0fHwiYXBwbGljYXRpb24vanNvbiIpCgkJdHJ5IHsgeGhyLnNlbmQoZGF0YSkgfSBjYXRjaChlKSB7IGNhbi5taXNjLkxvZyhlKSB9Cgl9LAoJUnVuOiBmdW5jdGlvbihldmVudCwgY2FuLCBkYXRhc2V0LCBjbWRzLCBjYikgewoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudHx8e30pLCBza2lwID0ge19oYW5kbGU6IHRydWV9CgkJdmFyIGZvcm0gPSB7Y21kczogY21kc3x8bXNnLmNtZH07IG1zZy5vcHRpb24gJiYgbXNnLm9wdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKCQkJIXNraXBbaXRlbV0gJiYgbXNnW2l0ZW1dICYmIChmb3JtW2l0ZW1dID0gbXNnW2l0ZW1dKQoJCX0pCgoJCWNhbi5taXNjLlBPU1QoY2FuLCBtc2csIGNhbi5iYXNlLk1lcmdlVVJMKGRhdGFzZXQubmFtZXMudG9Mb3dlckNhc2UoKSwKCQkJIl8iLCAobXNnLl9jYW4uc3VwfHxtc2cuX2NhbikuX25hbWUsIGljZS5NU0dfREFFTU9OLCBtc2cuX19kYWVtb258fGRhdGFzZXQuZGFlbW9ufHwiIgoJCSksIGZvcm0sIGNiKQoJfSwKCVdTUzogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYiwgb25vcGVuLCBvbmNsb3NlLCBvbmVycm9yKSB7IGlmIChjYW4udXNlci5pc0lFKSB7IHJldHVybiB9CgkJdmFyIHVybCA9IGxvY2F0aW9uLnByb3RvY29sLnJlcGxhY2UoImh0dHAiLCAid3MiKSsiLy8iK2xvY2F0aW9uLmhvc3QrIi9zcGFjZS8iCgkJaWYgKHVybC5pbmRleE9mKCJjaHJvbWUiKSA9PSAwKSB7IHVybCA9ICJ3czovL2xvY2FsaG9zdDo5MDIwL3NwYWNlLyIgfQoKCQl2YXIgc29ja2V0ID0gbmV3IFdlYlNvY2tldChjYW4uYmFzZS5NZXJnZVVSTCh1cmwsIGFyZ3MpKQoJCXNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZyhodG1sLldTUywgY2xpLkNMT1NFLCBhcmdzKQoJCQljYW4uYmFzZS5pc0Z1bmMob25jbG9zZSk/IG9uY2xvc2Uoc29ja2V0KTogY2FuLmNvcmUuVGltZXIoY2FuLmJhc2UucmFuZG9tKDMwMDAsIDEwMDApLCBmdW5jdGlvbigpIHsKCQkJCWNhbi5taXNjLldTUyhjYW4sIGFyZ3MsIGNiLCBvbm9wZW4sIG9uZXJyb3IsIG9uY2xvc2UpCgkJCX0pCgkJfSwgc29ja2V0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHsgY2FuLm1pc2MuTG9nKGh0bWwuV1NTLCBjbGkuRVJST1IsIGFyZ3MpCgkJCWNhbi5iYXNlLmlzRnVuYyhvbmVycm9yKT8gb25lcnJvcihzb2NrZXQpOiBzb2NrZXQuY2xvc2UoKQoKCQl9LCBzb2NrZXQub25vcGVuID0gZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZyhodG1sLldTUywgY2xpLk9QRU4sIGFyZ3MpCgkJCWNhbi5iYXNlLmlzRnVuYyhvbm9wZW4pICYmIG9ub3Blbihzb2NrZXQpCgkJfQoKCQlzb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHsgLy8g6Kej5p6Q5ZG95LukCgkJCXRyeSB7IHZhciBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKSB9IGNhdGNoIChlKSB7IHZhciBkYXRhID0ge2RldGFpbDogW2V2ZW50LmRhdGFdfSB9CgoJCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBtc2cuUmVwbHkgPSBmdW5jdGlvbigpIHsgLy8g5Zue5aSN5ZG95LukCgkJCQltc2cuT3B0aW9uKHtfaGFuZGxlOiB0cnVlLCBfc291cmNlOiAobXNnW2ljZS5NU0dfVEFSR0VUXXx8W10pLnJldmVyc2UoKS5zbGljZSgxKS5qb2luKGljZS5QVCl8fCIiLCBfdGFyZ2V0OiAobXNnW2ljZS5NU0dfU09VUkNFXXx8W10pLnJldmVyc2UoKS5qb2luKGljZS5QVCl9KQoJCQkJbXNnLnJlc3VsdCA9IChtc2cucmVzdWx0fHxbXSkuY29uY2F0KGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKSksIGNhbi5taXNjLkxvZyhodG1sLldTUywgaWNlLk1TR19SRVNVTFQsIG1zZy5yZXN1bHQsIG1zZykKCQkJCWRlbGV0ZShtc2cuX2V2ZW50KSwgZGVsZXRlKG1zZy5fY2FuKSwgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSkKCQkJfSwgbXNnLmRldGFpbCA9IGRhdGEuZGV0YWlsLCBtc2cuQ29weShkYXRhKQoKCQkJdHJ5IHsgLy8g5omn6KGM5ZG95LukCgkJCQljYW4ubWlzYy5Mb2coaHRtbC5XU1MsIGljZS5NU0dfREVUQUlMLCBtc2cuZGV0YWlsLCBtc2cpCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50LCBtc2csIG1zZy5kZXRhaWxbMF0sIG1zZy5kZXRhaWwuc2xpY2UoMSkpCgkJCX0gY2F0Y2ggKGUpIHsgY2FuLm1pc2MuTG9nKGUpLCBtc2cuUmVwbHkoKSB9CgkJfQoJfSwKCglDb29raWVTZXNzaWQ6IHNoeSgi5Lya6K+d5Y+Y6YePIiwgZnVuY3Rpb24oY2FuLCB2YWx1ZSwgcGF0aCkgewoJCXJldHVybiBjYW4ubWlzYy5Db29raWUoY2FuLCBpY2UuTVNHX1NFU1NJRCsiXyIrbG9jYXRpb24uaG9zdC5yZXBsYWNlQWxsKGljZS5QVCwgIl8iKS5yZXBsYWNlQWxsKGljZS5ERiwgIl8iKSwgdmFsdWUsIHBhdGgpCgl9KSwKCUNvb2tpZTogc2h5KCLkvJror53lj5jph48iLCBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUsIHBhdGgpIHsKCQlmdW5jdGlvbiBzZXQoaywgdikgeyBkb2N1bWVudC5jb29raWUgPSBrKyI9Iit2KyI7cGF0aD0iKyhwYXRofHxpY2UuUFMpIH0KCQlpZiAoY2FuLmJhc2UuaXNPYmplY3Qoa2V5KSkgeyBmb3IgKHZhciBrIGluIGtleSkgeyBzZXQoaywga2V5W2tdKSB9IGtleSA9IHVuZGVmaW5lZCB9CgoJCWlmIChrZXkgPT0gdW5kZWZpbmVkKSB7IHZhciBjcyA9IHt9CgkJCWRvY3VtZW50LmNvb2tpZS5zcGxpdCgiOyAiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGxzID0gaXRlbS5zcGxpdCgiPSIpOyBjc1tsc1swXV0gPSBsc1sxXSB9KQoJCQlyZXR1cm4gY3MKCQl9CgoJCXZhbHVlICE9IHVuZGVmaW5lZCAmJiBzZXQoa2V5LCB2YWx1ZSkKCQl2YXIgdmFsID0gKG5ldyBSZWdFeHAoa2V5KyI9KFteO10qKTs/IikpLmV4ZWMoZG9jdW1lbnQuY29va2llKQoJCXJldHVybiB2YWwgJiYgdmFsLmxlbmd0aCA+IDA/IHZhbFsxXTogIiIKCX0pLAoJU2VhcmNoT3JDb25mOiBmdW5jdGlvbihjYW4sIGtleSwgZGVmKSB7IHJldHVybiBjYW4uYmFzZS5nZXRWYWxpZChjYW4ubWlzYy5TZWFyY2goY2FuLCBrZXkpLCBjYW4uQ29uZihrZXkpLCBkZWYpIH0sCglTZWFyY2g6IHNoeSgi6K+35rGC5Y+C5pWwIiwgZnVuY3Rpb24oY2FuLCBrZXksIHZhbHVlKSB7IHZhciBhcmdzID0ge30KCQlpZiAodmFsdWUgPT0gdW5kZWZpbmVkICYmIGNhbi5iYXNlLmlzU3RyaW5nKGtleSkpIHsKCQkJdmFyIGxzID0gbG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoaWNlLlBTKTsgaWYgKGxzWzFdID09IGNoYXQuU0hBUkUpIHsgYXJnc1tjaGF0LlNIQVJFXSA9IGxzWzJdIH0KCQkJZm9yICh2YXIgaSA9IDI7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgeyBpZiAoeyJwb2QiOiB0cnVlLCAiY21kIjogdHJ1ZX1bbHNbaV1dKSB7IGFyZ3NbbHNbaV1dID0gbHNbaSsxXSB9IH0KCQl9CgkJbG9jYXRpb24uc2VhcmNoICYmIGxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKS5zcGxpdCgiJiIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgeyB2YXIgeCA9IGl0ZW0uc3BsaXQoIj0iKQoJCQl4WzFdICE9ICIiICYmIChhcmdzW3hbMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KHhbMV0pKQoJCX0pCgoJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7CgkJCWNhbi5jb3JlLkl0ZW0oa2V5LCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCQlpZiAodmFsdWUgIT0gdW5kZWZpbmVkKSB7IGFyZ3Nba2V5XSA9IHZhbHVlIH0gYXJnc1trZXldID09ICIiICYmIGRlbGV0ZShhcmdzW2tleV0pCgkJCX0pCgkJfSBlbHNlIHsKCQkJaWYgKGtleSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIGFyZ3MgfQoJCQlpZiAodmFsdWUgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBhcmdzW2tleV0gfQoJCQlhcmdzW2tleV0gPSB2YWx1ZSwgYXJnc1trZXldID09ICIiICYmIGRlbGV0ZShhcmdzW2tleV0pCgkJfQoKCQl2YXIgc2VhcmNoID0gY2FuLmNvcmUuSXRlbShhcmdzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiBrZXkrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgfSkuam9pbigiJiIpCgkJcmV0dXJuIHNlYXJjaD8gbG9jYXRpb24uc2VhcmNoID0gc2VhcmNoOiBsb2NhdGlvbi5ocmVmID0gbG9jYXRpb24ucGF0aG5hbWUKCX0pLAoJTWVyZ2VVUkw6IHNoeSgi5Zyw5Z2A6ZO+5o6lIiwgZnVuY3Rpb24oY2FuLCBvYmpzLCBjbGVhcikgewoJCXZhciBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7IG9ianMuX3BhdGggJiYgKHBhdGggPSBvYmpzLl9wYXRoLCBkZWxldGUob2Jqcy5fcGF0aCkpCgkJb2JqcyAmJiBvYmpzLnBvZCAmJiAocGF0aCA9ICIvY2hhdC9wb2QvIitvYmpzLnBvZCwgZGVsZXRlKG9ianMucG9kKSkKCQlyZXR1cm4gY2FuLmJhc2UuTWVyZ2VVUkwobG9jYXRpb24ub3JpZ2luK3BhdGgrKGNsZWFyPyIiOmxvY2F0aW9uLnNlYXJjaCksIG9ianMpCgl9KSwKCglydW5BY3Rpb246IGZ1bmN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwgbGlzdCkgewoJCWlmIChjbWRzWzBdID09IGN0eC5BQ1RJT04gJiYgbGlzdFtjbWRzWzFdXSkgeyByZXR1cm4gbGlzdFtjbWRzWzFdXShjbWRzLnNsaWNlKDIpKSwgdHJ1ZSB9CgkJaWYgKGxpc3RbY21kc1swXV0pIHsgcmV0dXJuIGxpc3RbY21kc1swXV0oY21kcy5zbGljZSgxKSksIHRydWUgfQoJfSwKCWNvbmNhdDogZnVuY3Rpb24oY2FuLCB0bywgZnJvbSkgeyB0byA9IHRvfHxbXSwgZnJvbSA9IGZyb218fFtdCgkJaWYgKGZyb21bMF0gPT0gY3R4LkFDVElPTiAmJiBmcm9tWzFdID09IGljZS5SVU4gJiYgY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2Zyb21bMl1dKSB7IHJldHVybiBmcm9tIH0KCQlpZiAoY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2Zyb21bMF1dKSB7IHJldHVybiBmcm9tIH0KCQlpZiAoZnJvbVswXSA9PSAiX3NlYXJjaCIpIHsgcmV0dXJuIGZyb20gfQoJCXJldHVybiB0by5jb25jYXQoZnJvbSkKCX0sCglwcm90bzogZnVuY3Rpb24oc3ViLCBzdXApIHsgcmV0dXJuIHN1Yi5fX3Byb3RvX18gPSBzdXAsIHN1YiB9LAoKCUxvZzogZnVuY3Rpb24oKSB7CgkJdmFyIGFyZ3MgPSBbdGhpcy5fdGltZSgpLCB0aGlzLkZpbGVMaW5lKDIsIDMpXQoJCWZvciAodmFyIGkgaW4gYXJndW1lbnRzKSB7IGFyZ3MucHVzaChhcmd1bWVudHNbaV0pIH0KCQljb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKQoJfSwKCUluZm86IGZ1bmN0aW9uKCkgewoJCXZhciBhcmdzID0gW3RoaXMuX3RpbWUoKSwgdGhpcy5GaWxlTGluZSgyLCAzKV0KCQlmb3IgKHZhciBpIGluIGFyZ3VtZW50cykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKSB9CgkJY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJncykKCX0sCglXYXJuOiBmdW5jdGlvbigpIHsKCQl2YXIgYXJncyA9IFt0aGlzLl90aW1lKCksIHRoaXMuRmlsZUxpbmUoMiwgMyksICJ3YXJuIl0KCQlmb3IgKHZhciBpIGluIGFyZ3VtZW50cykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKSB9CgkJYXJncy5wdXNoKGljZS5OTCwgdGhpcy5fZmlsZUxpbmUoKS5zcGxpdChpY2UuTkwpLnNsaWNlKDIpLmpvaW4oaWNlLk5MKSkKCQljb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKQoJfSwKCURlYnVnOiBmdW5jdGlvbigpIHsKCQl2YXIgYXJncyA9IFt0aGlzLl90aW1lKCksIHRoaXMuRmlsZUxpbmUoMiwgMyksICJkZWJ1ZyJdCgkJZm9yICh2YXIgaSBpbiBhcmd1bWVudHMpIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSkgfQoJCWFyZ3MucHVzaCh0aGlzLmZpbGVMaW5lKDIsIDMpKQoJCWNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpCgkJbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNb2JpbGUiKSA+IC0xICYmIGFsZXJ0KEpTT04uc3RyaW5naWZ5KGFyZ3Muam9pbihpY2UuU1ApKSkKCX0sCglGaWxlTGluZTogZnVuY3Rpb24oZGVwdGgsIGxlbmd0aCkgewoJCXJldHVybiB0aGlzLmZpbGVMaW5lKGRlcHRoKzEpLnNwbGl0KGljZS5QUykuc2xpY2UoMykuc2xpY2UoLWxlbmd0aCkuam9pbihpY2UuUFMpLnNwbGl0KCIpIilbMF0KCX0sCglmaWxlTGluZTogZnVuY3Rpb24oZGVwdGgpIHsKCQlyZXR1cm4gKHRoaXMuX2ZpbGVMaW5lKCkuc3BsaXQoaWNlLk5MKVsxK2RlcHRoXXx8IiIpLnRyaW0oKQoJfSwKCV9maWxlTGluZTogZnVuY3Rpb24oKSB7IHZhciBvYmogPSB7fQoJCUVycm9yLmNhcHR1cmVTdGFja1RyYWNlICYmIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKG9iaiwgYXJndW1lbnRzLmNhbGxlZSkKCQlyZXR1cm4gb2JqLnN0YWNrIHx8ICIiCgl9LAoJX3RpbWU6IGZ1bmN0aW9uKCkgeyB2YXIgbm93ID0gbmV3IERhdGUoKQoJCXZhciBob3VyID0gbm93LmdldEhvdXJzKCkKCQlpZiAoaG91ciA8IDEwKSB7IGhvdXIgPSAiMCIraG91ciB9CgkJdmFyIG1pbnV0ZSA9IG5vdy5nZXRNaW51dGVzKCkKCQlpZiAobWludXRlIDwgMTApIHsgbWludXRlID0gIjAiK21pbnV0ZSB9CgkJdmFyIHNlY29uZCA9IG5vdy5nZXRTZWNvbmRzKCkKCQlpZiAoc2Vjb25kIDwgMTApIHsgc2Vjb25kID0gIjAiK3NlY29uZCB9CgkJcmV0dXJuIGhvdXIrIjoiK21pbnV0ZSsiOiIrc2Vjb25kCgl9LAp9KQoK",
        "/lib/page.js": "Vm9sY2Fub3MoInBhZ2UiLCB7aGVscDogIueUqOaIt+eVjOmdoiIsIENsYXNzTGlzdDogewoJCWhhczogZnVuY3Rpb24oY2FuLCBvYmosIGtleSkgeyB2YXIgbGlzdCA9IG9iai5jbGFzc05hbWU/IG9iai5jbGFzc05hbWUuc3BsaXQoaWNlLlNQKTogW10KCQkJcmV0dXJuIGxpc3QuaW5kZXhPZihrZXkpID4gLTEKCQl9LAoJCWFkZDogZnVuY3Rpb24oY2FuLCBvYmosIGtleSkgeyB2YXIgbGlzdCA9IG9iai5jbGFzc05hbWU/IG9iai5jbGFzc05hbWUuc3BsaXQoaWNlLlNQKTogW10KCQkJdmFyIHZhbHVlID0gY2FuLmJhc2UuQWRkVW5pcShsaXN0LCBrZXkpLmpvaW4oaWNlLlNQKS50cmltKCkKCQkJcmV0dXJuIHZhbHVlICE9IG9iai5jbGFzc05hbWUgJiYgKG9iai5jbGFzc05hbWUgPSB2YWx1ZSksIHZhbHVlCgkJfSwKCQlkZWw6IGZ1bmN0aW9uKGNhbiwgb2JqLCBrZXkpIHsgdmFyIGxpc3QgPSBvYmouY2xhc3NOYW1lPyBvYmouY2xhc3NOYW1lLnNwbGl0KGljZS5TUCk6IFtdCgkJCXJldHVybiBvYmouY2xhc3NOYW1lID0gY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gdmFsdWUgPT0ga2V5PyB1bmRlZmluZWQ6IHZhbHVlIH0pLmpvaW4oaWNlLlNQKS50cmltKCkKCQl9LAoJCXNldDogZnVuY3Rpb24oY2FuLCBvYmosIGtleSwgY29uZGl0aW9uKSB7CgkJCXJldHVybiAoY29uZGl0aW9uPyB0aGlzLmFkZChjYW4sIG9iaiwga2V5KTogdGhpcy5kZWwoY2FuLCBvYmosIGtleSkpLmluZGV4T2Yoa2V5KSA+IC0xCgkJfSwKCQluZWc6IGZ1bmN0aW9uKGNhbiwgb2JqLCBrZXkpIHsKCQkJcmV0dXJuICh0aGlzLmhhcyhjYW4sIG9iaiwga2V5KT8gdGhpcy5kZWwoY2FuLCBvYmosIGtleSk6IHRoaXMuYWRkKGNhbiwgb2JqLCBrZXkpKS5pbmRleE9mKGtleSkgPiAtMQoJCX0sCgl9LAoJU2VsZWN0QXJnczogZnVuY3Rpb24oY2FuLCBvcHRpb24sIGtleSwgY2IpIHsKCQlpZiAoY2FuLmJhc2UuaXNVbmRlZmluZWQoa2V5KSkgeyB2YXIgdmFsdWUgPSB7fQoJCQljYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgb3B0aW9uLCAiIiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJaXRlbS5uYW1lICYmIGl0ZW0udmFsdWUgJiYgKHZhbHVlW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlKQoJCQl9KTsgcmV0dXJuIFt2YWx1ZV0KCQl9CgkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsKCQkJcmV0dXJuIGNhbi5jb3JlLkl0ZW0oa2V5LCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBvcHRpb24sIGtleSwgdmFsdWUpIH0pLCBba2V5XQoJCX0KCQlpZiAoIWNhbi5iYXNlLmlzRnVuYyhjYikpIHsgdmFyIHZhbHVlID0gY2I7IGNiID0gZnVuY3Rpb24oaXRlbSkgeyBpZiAoaXRlbS50eXBlID09IGh0bWwuQlVUVE9OKSB7IHJldHVybiB9CgkJCXJldHVybiBpdGVtLm5hbWUgJiYgKGNhbi5iYXNlLmlzVW5kZWZpbmVkKHZhbHVlKT8gaXRlbS52YWx1ZTogKGl0ZW0udmFsdWUgPSB2YWx1ZSkpfHwiIgoJCX0gfQoJCWlmIChrZXkuaW5kZXhPZihpY2UuUFQpID4gLTEpIHsgcmV0dXJuIFsiIl19CgkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIG9wdGlvbiwga2V5PyAidGV4dGFyZWFbbmFtZT0iK2tleSsiXSwiKyJpbnB1dFtuYW1lPSIra2V5KyJdLCIrInNlbGVjdFtuYW1lPSIra2V5KyJdIjogIi5hcmdzIiwgY2IpCgl9LAoJU2VsZWN0QWxsOiBzaHkoIumAieaLqeiKgueCuSIsIGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBrZXksIGNiLCBpbnRlcnZhbCwgY2JzKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBodG1sLklGUkFNRSwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ucGFnZS5TZWxlY3RBbGwoY2FuLCBpdGVtLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuYm9keSwga2V5LCBjYiwgaW50ZXJ2YWwsIGNicykKCQl9KQoJCXJldHVybiBjYW4uY29yZS5MaXN0KHRhcmdldCAmJiB0YXJnZXQucXVlcnlTZWxlY3RvckFsbChrZXkpLCBjYiwgaW50ZXJ2YWwsIGNicykKCX0pLAoJU2VsZWN0OiBzaHkoIumAieaLqeiKgueCuSIsIGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBrZXksIGNiLCBpbnRlcnZhbCwgY2JzKSB7IGlmIChrZXkgPT0gaWNlLlBUKSB7IGNiKHRhcmdldCk7IHJldHVybiBbXSB9CgkJcmV0dXJuIGNhbi5jb3JlLkxpc3QodGFyZ2V0ICYmIHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKGNhbi5wYWdlLktleXMoa2V5KSksIGNiLCBpbnRlcnZhbCwgY2JzKQoJfSksCglNb2RpZnk6IHNoeSgi5L+u5pS56IqC54K5IiwgZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHZhbHVlKSB7IHRhcmdldCA9IHRhcmdldHx8e30KCQl0YXJnZXQgPSBjYW4uYmFzZS5pc09iamVjdCh0YXJnZXQpPyB0YXJnZXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0KTsgaWYgKCF0YXJnZXQpIHsgcmV0dXJuIH0KCQljYW4uYmFzZS5pc1N0cmluZyh2YWx1ZSk/ICh0YXJnZXQuaW5uZXJIVE1MID0gdmFsdWUpOiBjYW4uY29yZS5JdGVtKHZhbHVlLCBmdW5jdGlvbihrZXksIHZhbCkgewoJCQlrZXkgPT0gImNsYXNzTmFtZSIgJiYgY2FuLmJhc2UuaXNBcnJheSh2YWwpICYmICh2YWwgPSB2YWwuam9pbihpY2UuU1ApKQoJCQkhY2FuLmJhc2UuaXNPYmplY3QodmFsKT8gKHRhcmdldFtrZXldID0gdmFsKTogY2FuLmNvcmUuSXRlbSh2YWwsIGZ1bmN0aW9uKGssIHYpIHsKCQkJCXZhciBzaXplID0gewoJCQkJCSJoZWlnaHQiOiB0cnVlLCAibWF4LWhlaWdodCI6IHRydWUsICJtaW4taGVpZ2h0IjogdHJ1ZSwKCQkJCQkid2lkdGgiOiB0cnVlLCAibWF4LXdpZHRoIjogdHJ1ZSwgIm1pbi13aWR0aCI6IHRydWUsCgkJCQl9CgkJCQlpZiAoc2l6ZVtrXSAmJiBwYXJzZUludCh2KSA8IDApIHsgcmV0dXJuIHRhcmdldFtrZXldICYmICh0YXJnZXRba2V5XVtrXSA9ICIiKSB9CgoJCQkJdmFyIHNpemUgPSB7CgkJCQkJIm1hcmdpbi10b3AiOiB0cnVlLCAibWFyZ2luLWxlZnQiOiB0cnVlLCAiZm9udC1zaXplIjogdHJ1ZSwKCQkJCQkibGVmdCI6IHRydWUsICJyaWdodCI6IHRydWUsICJ0b3AiOiB0cnVlLCAiYm90dG9tIjogdHJ1ZSwKCQkJCQkiaGVpZ2h0IjogdHJ1ZSwgIm1heC1oZWlnaHQiOiB0cnVlLCAibWluLWhlaWdodCI6IHRydWUsCgkJCQkJIndpZHRoIjogdHJ1ZSwgIm1heC13aWR0aCI6IHRydWUsICJtaW4td2lkdGgiOiB0cnVlLAoJCQkJfQoKCQkJCWlmIChzaXplW2tdICYmIHYgJiYgKGNhbi5iYXNlLmlzTnVtYmVyKHYpIHx8IHYuaW5kZXhPZiAmJiB2LmluZGV4T2YoInB4IikgPT0gLTEpKSB7IHYgKz0gInB4IiB9CgkJCQl0YXJnZXRba2V5XSAmJiAodGFyZ2V0W2tleV1ba10gPSB2KQoJCQl9KQoJCX0pCgkJcmV0dXJuIHRhcmdldAoJfSksCglSZW1vdmU6IHNoeSgi5Yig6Zmk6IqC54K5IiwgZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQlyZXR1cm4gdGFyZ2V0ICYmIHRhcmdldC5wYXJlbnROb2RlICYmIHRhcmdldC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRhcmdldCksIHRhcmdldAoJfSksCglDcmVhdGU6IHNoeSgi5Yib5bu66IqC54K5IiwgZnVuY3Rpb24oY2FuLCBrZXksIHZhbHVlKSB7CgkJcmV0dXJuIGNhbi5wYWdlLk1vZGlmeShjYW4sIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoa2V5KSwgdmFsdWUpCgl9KSwKCUFwcGVuZDogc2h5KCLmt7vliqDoioLngrkiLCBmdW5jdGlvbihjYW4sIHRhcmdldCwga2V5LCB2YWx1ZSkgeyB2YWx1ZSA9IHZhbHVlfHx7fQoJCWlmIChjYW4uYmFzZS5pc1N0cmluZyhrZXkpKSB7IHZhciByZXMgPSBjYW4ucGFnZS5DcmVhdGUoY2FuLCBrZXksIHZhbHVlKTsgcmV0dXJuIHRhcmdldC5hcHBlbmRDaGlsZChyZXMpLCByZXMgfQoKCQljYW4uY29yZS5MaXN0KGtleSwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsgaWYgKCFpdGVtKSB7IHJldHVybiB9CgkJCWlmIChjYW4uYmFzZS5pc1N0cmluZyhpdGVtKSkgeyB0YXJnZXQuaW5uZXJIVE1MID0gaXRlbTsgcmV0dXJuIH0KCQkJaWYgKGl0ZW0ubm9kZU5hbWUpIHsgdGFyZ2V0LmFwcGVuZENoaWxkKGl0ZW0pOyByZXR1cm4gfQoKCQkJLy8g5Z+65pys57uT5p6EOiB0eXBlIG5hbWUgZGF0YSBsaXN0CgkJCXZhciB0eXBlID0gaXRlbS50eXBlfHxodG1sLkRJViwgZGF0YSA9IGl0ZW0uZGF0YXx8e30KCQkJdmFyIG5hbWUgPSBpdGVtLm5hbWV8fGRhdGEubmFtZXx8IiIKCgkJCS8vIOaVsOaNruiwg+aVtAoJCQljYW4uY29yZS5JdGVtKGl0ZW0sIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKCQkJCXN3aXRjaCAoa2V5KSB7CgkJCQkJY2FzZSBtZGIuVFlQRTogYnJlYWsKCQkJCQljYXNlIG1kYi5OQU1FOiBicmVhawoJCQkJCWNhc2UgbWRiLkRBVEE6IGJyZWFrCgkJCQkJY2FzZSBtZGIuTElTVDogYnJlYWsKCQkJCQljYXNlIGh0bWwuSU5ORVI6IGRhdGEuaW5uZXJIVE1MID0gaXRlbS5pbm5lcjsgYnJlYWsKCQkJCQljYXNlIGh0bWwuQ0xJQ0s6IGRhdGEub25jbGljayA9IGl0ZW0uY2xpY2s7IGJyZWFrCgkJCQkJZGVmYXVsdDogZGF0YVtrZXldID0gaXRlbVtrZXldCgkJCQl9CgkJCX0pCgoJCQkvLyDln7rmnKznsbvlnos6IHZpZXcgdGV4dCBidXR0b24gc2VsZWN0IGlucHV0IHVzZXJuYW1lIHBhc3N3b3JkCgkJCS8vIOWfuuacrOexu+WeizogaW1nIHJvdyB0aCB0ZAoJCQlpZiAoaXRlbS52aWV3KSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLnZpZXcpCgkJCQlpZiAoY2FuLmJhc2UuaXNBcnJheShsaXN0WzBdKSkgeyBsaXN0WzBdID0gbGlzdFswXS5qb2luKGljZS5TUCkgfQoJCQkJbGlzdFswXSAmJiBjYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgZGF0YSwgbGlzdFswXSkKCQkJCXR5cGUgPSBsaXN0WzFdfHxodG1sLkRJVgoJCQkJZGF0YS5pbm5lckhUTUwgPSBsaXN0WzJdfHxkYXRhLmlubmVySFRNTHx8IiIKCQkJCW5hbWUgPSBuYW1lfHxsaXN0WzNdfHwiIgoKCQkJfSBlbHNlIGlmIChpdGVtLnRleHQpIHsgdmFyIGxpc3QgPSBjYW4uY29yZS5MaXN0KGl0ZW0udGV4dCkKCQkJCWRhdGEuaW5uZXJIVE1MID0gbGlzdFswXXx8ZGF0YS5pbm5lckhUTUx8fCIiCgkJCQl0eXBlID0gbGlzdFsxXXx8aHRtbC5TUEFOCgkJCQlsaXN0WzJdICYmIGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBkYXRhLCBsaXN0WzJdKQoKCQkJfSBlbHNlIGlmIChpdGVtLmJ1dHRvbikgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS5idXR0b24pCgkJCQl0eXBlID0gaHRtbC5CVVRUT04sIG5hbWUgPSBuYW1lfHxsaXN0WzBdCgkJCQlkYXRhLmlubmVyVGV4dCA9IGNhbi51c2VyLnRyYW5zKGNhbiwgbGlzdFswXSksIGRhdGEub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jdGlvbihsaXN0WzFdKSAmJiBsaXN0WzFdKGV2ZW50LCBuYW1lKQoJCQkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQkJCXJldHVybiB0cnVlCgkJCQl9CgoJCQl9IGVsc2UgaWYgKGl0ZW0uc2VsZWN0KSB7IHZhciBsaXN0ID0gaXRlbS5zZWxlY3QKCQkJCXR5cGUgPSBodG1sLlNFTEVDVCwgZGF0YS5uYW1lID0gbmFtZSA9IG5hbWV8fGxpc3RbMF1bMF0KCQkJCWRhdGEudGl0bGUgPSBjYW4udXNlci50cmFucyhjYW4sIGRhdGEudGl0bGV8fG5hbWUpCgkJCQlkYXRhLmNsYXNzTmFtZSA9IGRhdGEuY2xhc3NOYW1lfHxsaXN0WzBdWzBdfHwiIgoKCQkJCWl0ZW0ubGlzdCA9IGxpc3RbMF0uc2xpY2UoMSkubWFwKGZ1bmN0aW9uKHZhbHVlKSB7CgkJCQkJcmV0dXJuIHt0eXBlOiBodG1sLk9QVElPTiwgdmFsdWU6IHZhbHVlLCBpbm5lcjogY2FuLnVzZXIudHJhbnMoY2FuLCB2YWx1ZSl9CgkJCQl9KQoJCQkJZGF0YS5vbmNoYW5nZSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jdGlvbihsaXN0WzFdKSAmJiBsaXN0WzFdKGV2ZW50LCBldmVudC50YXJnZXQudmFsdWUsIG5hbWUpCgkJCQl9CgoJCQl9IGVsc2UgaWYgKGl0ZW0uaW5wdXQpIHsgdmFyIGxpc3QgPSBjYW4uY29yZS5MaXN0KGl0ZW0uaW5wdXQpCgkJCQl0eXBlID0gaHRtbC5JTlBVVCwgbmFtZSA9IG5hbWV8fGxpc3RbMF18fCIiLCBkYXRhLm5hbWUgPSBkYXRhLm5hbWV8fG5hbWUKCQkJCWRhdGEuY2xhc3NOYW1lID0gZGF0YS5jbGFzc05hbWV8fGRhdGEubmFtZQoJCQkJZGF0YS5hdXRvY29tcGxldGUgPSAib2ZmIgoKCQkJCWRhdGEub25mb2N1cyA9IGRhdGEub25mb2N1c3x8ZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlldmVudC50YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgLTEpCgkJCQl9CgkJCQlkYXRhLm9ua2V5ZG93biA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jdGlvbihsaXN0WzFdKSAmJiBsaXN0WzFdKGV2ZW50KQoJCQkJfQoJCQkJZGF0YS5vbmtleXVwID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmN0aW9uKGxpc3RbMl0pICYmIGxpc3RbMl0oZXZlbnQpCgkJCQl9CgkJCX0gZWxzZSBpZiAoaXRlbS51c2VybmFtZSkgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS51c2VybmFtZSkKCQkJCXR5cGUgPSBodG1sLklOUFVULCBuYW1lID0gbmFtZXx8bGlzdFswXXx8aHRtbC5VU0VSTkFNRSwgZGF0YS5uYW1lID0gZGF0YS5uYW1lfHxuYW1lCgkJCQlkYXRhLmNsYXNzTmFtZSA9IGxpc3RbMV18fGRhdGEuY2xhc3NOYW1lfHxkYXRhLm5hbWUKCQkJCWRhdGEuYXV0b2NvbXBsZXRlID0gZGF0YS5hdXRvY29tcGxldGV8fGh0bWwuVVNFUk5BTUUKCgkJCX0gZWxzZSBpZiAoaXRlbS5wYXNzd29yZCkgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS5wYXNzd29yZCkKCQkJCXR5cGUgPSBodG1sLklOUFVULCBuYW1lID0gbmFtZXx8bGlzdFswXXx8aHRtbC5QQVNTV09SRCwgZGF0YS5uYW1lID0gZGF0YS5uYW1lfHxuYW1lCgkJCQlkYXRhLmNsYXNzTmFtZSA9IGxpc3RbMV18fGRhdGEuY2xhc3NOYW1lfHxkYXRhLm5hbWUKCQkJCWRhdGEuYXV0b2NvbXBsZXRlID0gZGF0YS5hdXRvY29tcGxldGV8fCJjdXJyZW50LXBhc3N3b3JkIgoJCQkJZGF0YS50eXBlID0gaHRtbC5QQVNTV09SRAoKCQkJfSBlbHNlIGlmIChpdGVtLmltZykgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS5pbWcpCgkJCQl0eXBlID0gaHRtbC5JTUcsIGRhdGEuc3JjID0gbGlzdFswXQoKCQkJfSBlbHNlIGlmIChpdGVtLnJvdykgeyB0eXBlID0gaHRtbC5UUgoJCQkJaXRlbS5saXN0ID0gaXRlbS5yb3cubWFwKGZ1bmN0aW9uKHRleHQpIHsgcmV0dXJuIHt0ZXh0OiBbdGV4dCwgaXRlbS5zdWJ8fGh0bWwuVERdfSB9KQoJCQl9IGVsc2UgaWYgKGl0ZW0udGgpIHsgdHlwZSA9IGh0bWwuVFIKCQkJCWl0ZW0ubGlzdCA9IGl0ZW0udGgubWFwKGZ1bmN0aW9uKHRleHQpIHsgcmV0dXJuIHt0ZXh0OiBbdGV4dCwgaHRtbC5USF19IH0pCgkJCX0gZWxzZSBpZiAoaXRlbS50ZCkgeyB0eXBlID0gaHRtbC5UUgoJCQkJaXRlbS5saXN0ID0gaXRlbS50ZC5tYXAoZnVuY3Rpb24odGV4dCkgeyByZXR1cm4ge3RleHQ6IFt0ZXh0LCBodG1sLlREXX0gfSkKCQkJfQoKCQkJLy8g6K+t6KiA6L2s5o2iCgkJCWlmICh0eXBlID09IGh0bWwuSU5QVVQpICB7IGRhdGEudHlwZSA9PSBodG1sLkJVVFRPTiAmJiAoZGF0YS52YWx1ZSA9IGNhbi51c2VyLnRyYW5zKGNhbiwgZGF0YS52YWx1ZSkpCgkJCQlpZiAoZGF0YS50eXBlID09IGh0bWwuVEVYVHx8ZGF0YS50eXBlID09IGh0bWwuUEFTU1dPUkR8fCFkYXRhLnR5cGUpIHsgZGF0YS5hdXRvY29tcGxldGUgPSBkYXRhLmF1dG9jb21wbGV0ZXx8Im9mZiIKCQkJCQkvLyBkYXRhLnBsYWNlaG9sZGVyID0gY2FuLnVzZXIudHJhbnMoY2FuLCAoZGF0YS5wbGFjZWhvbGRlcnx8ZGF0YS5uYW1lfHwiIikuc3BsaXQoaWNlLlBUKS5wb3AoKSkKCQkJCQlkYXRhLnBsYWNlaG9sZGVyID0gKGRhdGEucGxhY2Vob2xkZXJ8fGRhdGEubmFtZXx8IiIpLnNwbGl0KGljZS5QVCkucG9wKCkKCQkJCQlkYXRhLnRpdGxlID0gY2FuLnVzZXIudHJhbnMoY2FuLCBkYXRhLnRpdGxlfHxkYXRhLnBsYWNlaG9sZGVyKQoJCQkJfQoJCQl9CgkJCWlmICh0eXBlID09IGh0bWwuVEVYVEFSRUEpICB7CgkJCQlkYXRhLnBsYWNlaG9sZGVyID0gY2FuLnVzZXIudHJhbnMoY2FuLCAoZGF0YS5wbGFjZWhvbGRlcnx8ZGF0YS5uYW1lfHwiIikuc3BsaXQoaWNlLlBUKS5wb3AoKSkKCQkJfQoKCQkJLy8g5Yib5bu66IqC54K5CgkJCSFkYXRhLm5hbWUgJiYgaXRlbS5uYW1lICYmIChkYXRhLm5hbWUgPSBpdGVtLm5hbWUpCgkJCXZhciBub2RlID0gY2FuLnBhZ2UuQ3JlYXRlKGNhbiwgdHlwZSwgZGF0YSkKCgkJCS8vIOWIm+W7uue0ouW8lQoJCQluYW1lID0gbmFtZXx8ZGF0YS5jbGFzc05hbWV8fHR5cGV8fCIiCgkJCXZhbHVlW25hbWV8fCIiXSA9IHZhbHVlW2RhdGEuY2xhc3NOYW1lfHwiIl0gPSB2YWx1ZVt0eXBlXSA9IG5vZGUKCQkJdmFsdWUuZmlyc3QgPSB2YWx1ZS5maXJzdHx8bm9kZSwgdmFsdWUubGFzdCA9IG5vZGUKCQkJdmFsdWUuX3RhcmdldCA9IHZhbHVlLl90YXJnZXR8fG5vZGUKCgkJCS8vIOmAkuW9kuiKgueCuQoJCQlpdGVtLmxpc3QgJiYgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgbm9kZSwgaXRlbS5saXN0LCB2YWx1ZSkKCQkJdGFyZ2V0ICYmIHRhcmdldC5hcHBlbmRDaGlsZCAmJiB0YXJnZXQuYXBwZW5kQ2hpbGQobm9kZSkKCQkJY2FuLmJhc2UuaXNGdW5jKGl0ZW0uX2luaXQpICYmIGl0ZW0uX2luaXQobm9kZSwgdmFsdWUpCgkJfSkKCQlyZXR1cm4gdmFsdWUKCX0pLAoJQXBwZW5kczogc2h5KCLmt7vliqDoioLngrkiLCBmdW5jdGlvbihjYW4sIHRhcmdldCwga2V5LCB2YWx1ZSkgewoJCXJldHVybiB0YXJnZXQuaW5uZXJIVE1MID0gIiIsIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwga2V5LCB2YWx1ZSkKCX0pLAoKCUFwcGVuZFRhYmxlOiBzaHkoIua3u+WKoOihqOagvCIsIGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQsIGxpc3QsIGNiKSB7CgkJaWYgKCFtc2cuYXBwZW5kfHxtc2cuYXBwZW5kLmxlbmd0aCA9PSAwKSB7cmV0dXJufQoKCQl2YXIgdGFibGUgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIGh0bWwuVEFCTEUpCgkJdmFyIHRoZWFkID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFibGUsICJ0aGVhZCIpCgkJdmFyIHRib2R5ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFibGUsICJ0Ym9keSIpCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGhlYWQsIFt7dHlwZTogaHRtbC5UUiwgZGF0YToge2RhdGFzZXQ6IHtpbmRleDogLTF9fSwgbGlzdDogCgkJCWNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oa2V5KSB7CgkJCQlyZXR1cm4ga2V5WzBdID09ICJfIj8gdW5kZWZpbmVkOiB7dGV4dDogW2tleS50cmltKCksIGh0bWwuVEhdfQoJCQl9KQoJCX1dKQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRib2R5LCBjYW4uY29yZS5MaXN0KG1zZy5UYWJsZSgpLCBmdW5jdGlvbihsaW5lLCBpbmRleCwgYXJyYXkpIHsKCQkJdmFyIF9saXN0ID0gY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihrZXkpIHsgaWYgKGtleS5pbmRleE9mKCJfIikgPT0gMCkgeyByZXR1cm4gfQoJCQkJcmV0dXJuIGNiKGNhbi5wYWdlLkNvbG9yKGxpbmVba2V5XSkudHJpbSgpLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkKCQkJfSkKCQkJcmV0dXJuIF9saXN0Lmxlbmd0aCA+IDA/IHt0eXBlOiBodG1sLlRSLCBkYXRhc2V0OiB7aW5kZXg6IGluZGV4fSwgbGlzdDogX2xpc3R9OiB1bmRlZmluZWQKCQl9KSkKCQlyZXR1cm4gY2FuLnBhZ2UuT3JkZXJUYWJsZShjYW4sIHRhYmxlKQoJfSksCglPcmRlclRhYmxlOiBmdW5jdGlvbihjYW4sIHRhYmxlKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFibGUsIGh0bWwuVEgsIGZ1bmN0aW9uKHRoLCBpbmRleCkgewoJCQl0aC5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsgdmFyIGRhdGFzZXQgPSBldmVudC50YXJnZXQuZGF0YXNldAoJCQkJZGF0YXNldFsic29ydF9hc2MiXSA9IChkYXRhc2V0WyJzb3J0X2FzYyJdID09ICIxIikgPyAwOiAxCgkJCQljYW4ucGFnZS5SYW5nZVRhYmxlKGNhbiwgdGFibGUsIGluZGV4LCBkYXRhc2V0WyJzb3J0X2FzYyJdID09ICIxIikKCQkJfQoJCX0pCgkJcmV0dXJuIHRhYmxlCgl9LAoJUmFuZ2VUYWJsZTogZnVuY3Rpb24oY2FuLCB0YWJsZSwgaW5kZXgsIHNvcnRfYXNjKSB7CgkJdmFyIGxpc3QgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YWJsZSwgaHRtbC5UUiwgZnVuY3Rpb24odHIpIHsKCQkJcmV0dXJuIHRyLnN0eWxlLmRpc3BsYXkgPT0gaHRtbC5OT05FfHxjYW4ucGFnZS5DbGFzc0xpc3QuaGFzKGNhbiwgdHIsICJoaWRlIik/IG51bGw6IHRyCgkJfSkuc2xpY2UoMSkKCgkJaW5kZXggPSBjYW4uYmFzZS5pc09iamVjdChpbmRleCk/IGluZGV4OiBbaW5kZXhdCgkJaW5kZXggPSBjYW4uY29yZS5MaXN0KGluZGV4LCBmdW5jdGlvbihpdGVtKSB7IGlmIChpdGVtID4gLTEpIHsgcmV0dXJuIGl0ZW19IH0pCgkJaWYgKGluZGV4Lmxlbmd0aCA9PSAwKSB7IHJldHVybiB9CgoJCXZhciBpc190aW1lID0gdHJ1ZSwgaXNfbnVtYmVyID0gdHJ1ZQoJCWNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24odHIpIHsKCQkJdmFyIHRleHQgPSB0ci5jaGlsZE5vZGVzW2luZGV4WzBdXS5pbm5lclRleHQKCQkJaXNfdGltZSA9IGlzX3RpbWUgJiYgRGF0ZS5wYXJzZSh0ZXh0KSA+IDAKCQkJaXNfbnVtYmVyID0gaXNfbnVtYmVyICYmICFpc05hTihwYXJzZUludCh0ZXh0KSkKCQl9KQoKCQl2YXIgbnVtX2xpc3QgPSBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKHRyKSB7CgkJCXZhciB0ZXh0ID0gdHIuY2hpbGROb2Rlc1tpbmRleFswXV0uaW5uZXJUZXh0CgkJCXJldHVybiBpc190aW1lPyBEYXRlLnBhcnNlKHRleHQpOgoJCQkJaXNfbnVtYmVyPyBjYW4uYmFzZS5QYXJzZVNpemUodGV4dCk6IHRleHQKCQl9KQoJCWZ1bmN0aW9uIGlzbGVzcyhhLCBiLCBpbmRleCkgewoJCQlpZiAoYS5jaGlsZE5vZGVzW2luZGV4WzBdXSAmJiBiLmNoaWxkTm9kZXNbaW5kZXhbMF1dKSB7CgkJCQlpZiAoYS5jaGlsZE5vZGVzW2luZGV4WzBdXS5pbm5lclRleHQgPCBiLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dCkgeyByZXR1cm4gdHJ1ZSB9CgkJCQlpZiAoYS5jaGlsZE5vZGVzW2luZGV4WzBdXS5pbm5lclRleHQgPiBiLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dCkgeyByZXR1cm4gZmFsc2UgfQoJCQl9CgkJCXJldHVybiBpbmRleC5sZW5ndGggPiAxICYmIGlzbGVzcyhhLCBiLCBpbmRleC5zbGljZSgxKSkKCQl9CgoJCS8vIOmAieaLqeaOkuW6jwoJCWZvciAodmFyIGkgPSAwOyBpIDwgbnVtX2xpc3QubGVuZ3RoOyBpKyspIHsgdmFyIG1pbiA9IGkKCQkJZm9yICh2YXIgaiA9IGkrMTsgaiA8IG51bV9saXN0Lmxlbmd0aDsgaisrKSB7CgkJCQlpZiAobnVtX2xpc3RbbWluXSA9PSBudW1fbGlzdFtqXSAmJiBpbmRleC5sZW5ndGggPiAxICYmIGxpc3RbaW5kZXhbMV1dKSB7CgkJCQkJaWYgKHNvcnRfYXNjPyBpc2xlc3MobGlzdFttaW5dLCBsaXN0W2pdLCBpbmRleC5zbGljZSgxKSk6IGlzbGVzcyhsaXN0W2pdLCBsaXN0W21pbl0sIGluZGV4LnNsaWNlKDEpKSkgewoJCQkJCQltaW4gPSBqCgkJCQkJfQoJCQkJfSBlbHNlIGlmIChzb3J0X2FzYz8gbnVtX2xpc3RbbWluXSA8IG51bV9saXN0W2pdOiBudW1fbGlzdFtqXSA8IG51bV9saXN0W21pbl0pIHsKCQkJCQltaW4gPSBqCgkJCQl9CgkJCX0KCgkJCWlmIChtaW4gIT0gaSkgewoJCQkJdmFyIHRlbXAgPSBudW1fbGlzdFtpXTsgbnVtX2xpc3RbaV0gPSBudW1fbGlzdFttaW5dOyBudW1fbGlzdFttaW5dID0gdGVtcAoJCQkJdmFyIHRlbXAgPSBsaXN0W2ldOyBsaXN0W2ldID0gbGlzdFttaW5dOyBsaXN0W21pbl0gPSB0ZW1wCgkJCX0KCgkJCXZhciB0Ym9keSA9IGxpc3RbaV0ucGFyZW50RWxlbWVudAoJCQlsaXN0W2ldLnBhcmVudEVsZW1lbnQgJiYgdGJvZHkucmVtb3ZlQ2hpbGQobGlzdFtpXSkKCQkJdGJvZHkuYXBwZW5kQ2hpbGQobGlzdFtpXSkKCQl9Cgl9LAoKCUNhY2hlOiBmdW5jdGlvbihuYW1lLCBvdXRwdXQsIGRhdGEpIHsgaWYgKCFuYW1lKSB7IHJldHVybiB9CgkJdmFyIGNhY2hlID0gb3V0cHV0Ll9jYWNoZXx8e307IG91dHB1dC5fY2FjaGUgPSBjYWNoZQoJCWlmIChkYXRhKSB7IGlmIChvdXRwdXQuY2hpbGRyZW4ubGVuZ3RoID09IDApIHsgcmV0dXJuIH0KCQkJdmFyIHRlbXAgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkKCQkJd2hpbGUgKG91dHB1dC5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHsgLy8g5YaZ57yT5a2YCgkJCQl2YXIgaXRlbSA9IG91dHB1dC5jaGlsZE5vZGVzWzBdCgkJCQlpdGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaXRlbSksCgkJCQkJdGVtcC5hcHBlbmRDaGlsZChpdGVtKQoJCQl9CgkJCXJldHVybiBjYWNoZVtuYW1lXSA9IHtub2RlOiB0ZW1wLCBkYXRhOiBkYXRhfSwgbmFtZQoJCX0KCQlvdXRwdXQuaW5uZXJIVE1MID0gIiIKCgkJdmFyIGxpc3QgPSBjYWNoZVtuYW1lXTsgaWYgKCFsaXN0KSB7IHJldHVybiB9CgkJd2hpbGUgKGxpc3Qubm9kZS5jaGlsZE5vZGVzLmxlbmd0aCA+IDApIHsgLy8g6K+757yT5a2YCgkJCXZhciBpdGVtID0gbGlzdC5ub2RlLmNoaWxkTm9kZXNbMF0KCQkJaXRlbS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGl0ZW0pCgkJCW91dHB1dC5hcHBlbmRDaGlsZChpdGVtKQoJCX0KCQlyZXR1cm4gZGVsZXRlKGNhY2hlW25hbWVdKSwgbGlzdC5kYXRhCgl9LAoJRm9ybWF0OiBmdW5jdGlvbih0eXBlKSB7CgkJc3dpdGNoICh0eXBlKSB7CgkJCWNhc2UgaHRtbC5BOiByZXR1cm4gIjxhIGhyZWY9JyIrYXJndW1lbnRzWzFdKyInIHRhcmdldD0nX2JsYW5rJz4iKyhhcmd1bWVudHNbMl18fGFyZ3VtZW50c1sxXSkrIjwvYT4iCgkJCWNhc2UgaHRtbC5JTUc6IHJldHVybiBhcmd1bWVudHNbMl0/ICI8aW1nIHNyYz0nIithcmd1bWVudHNbMV0rIicgaGVpZ2h0PSIrYXJndW1lbnRzWzJdKyI+IjogIjxpbWcgc3JjPSciK2FyZ3VtZW50c1sxXSsiJz4iCgkJfQoJfSwKCXJlcGxhY2U6IGZ1bmN0aW9uKGNhbiwgdGV4dCwga2V5LCB2YWx1ZSkgewoJCXJldHVybiBjYW4uYmFzZS5yZXBsYWNlQWxsKHRleHQsICI8IiwgIiZsdDsiLCAiPiIsICImZ3Q7Iiwga2V5LCB2YWx1ZSkKCX0sCglDb2xvcjogZnVuY3Rpb24odGV4dCkgeyBpZiAodHlwZW9mIHRleHQgIT0gbGFuZy5TVFJJTkcpIHsgcmV0dXJuICIiIH0KCQlpZiAodGV4dC5pbmRleE9mKCJodHRwOi8vIikgPT0gMCB8fCB0ZXh0LmluZGV4T2YoImh0dHBzOi8vIikgPT0gMCB8fCB0ZXh0LmluZGV4T2YoImZ0cDovLyIpID09IDApIHsKCQkJdmFyIGxzID0gdGV4dC5zcGxpdChpY2UuU1ApOwoJCQl0ZXh0ID0gIjxhIGhyZWY9JyIrbHNbMF0rIicgdGFyZ2V0PSdfYmxhbmsnPiIrbHNbMF0rIjwvYT4iK2xzLnNsaWNlKDEpLmpvaW4oaWNlLlNQKQoJCX07IHRleHQgPSB0ZXh0LnJlcGxhY2UoL1xcbi9nLCAiPGJyPiIpCgoJCWlmICh0ZXh0LmluZGV4T2YoIlwwMzNcWyIpID09IC0xKSB7IHJldHVybiB0ZXh0IH0KCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFszMW0vZywgIjxzcGFuIHN0eWxlPSdjb2xvcjojZjAwJz4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzMybS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiMwZjAnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzNtL2csICI8c3BhbiBzdHlsZT0nY29sb3I6I2ZmMCc+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFszNG0vZywgIjxzcGFuIHN0eWxlPSdjb2xvcjojMDBmJz4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzM2bS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiMwZmYnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzQ7MW0vZywgIjxzcGFuIHN0eWxlPSdjb2xvcjojMDBmJz4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzM3OzFtL2csICI8c3BhbiBzdHlsZT0nY29sb3I6I2ZmZic+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFsxbS9nLCAiPHNwYW4gc3R5bGU9J2ZvbnQtd2VpZ2h0OmJvbGQnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMG0vZywgIjwvc3Bhbj4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcW20vZywgIjwvc3Bhbj4iKQoJCXJldHVybiB0ZXh0Cgl9LAoJaW5wdXQ6IGZ1bmN0aW9uKGNhbiwgaXRlbSwgdmFsdWUpIHsKCQl2YXIgaW5wdXQgPSB7dHlwZTogaHRtbC5JTlBVVCwgbmFtZTogaXRlbS5uYW1lLCBkYXRhOiBpdGVtLCBkYXRhc2V0OiB7fSwgX2luaXQ6IGl0ZW0uX2luaXQsIHN0eWxlOiBpdGVtLnN0eWxlfHx7fX0KCQlpdGVtLnZhbHVlID09IGljZS5BVVRPICYmIChpdGVtLnZhbHVlID0gIiIsIGl0ZW0uYWN0aW9uID0gaWNlLkFVVE8pLCBpdGVtLmFjdGlvbiA9PSBpY2UuQVVUTyAmJiAoaW5wdXQuZGF0YXNldC5hY3Rpb24gPSBpY2UuQVVUTykKCgkJc3dpdGNoIChpdGVtLnR5cGUgPSBpdGVtLnR5cGV8fGh0bWwuVEVYVCkgewoJCQljYXNlIGh0bWwuVEVYVEFSRUE6IGlucHV0LnR5cGUgPSBodG1sLlRFWFRBUkVBCgkJCQlpbnB1dC5zdHlsZS5oZWlnaHQgPSBpbnB1dC5zdHlsZS5oZWlnaHR8fGNhbi5Db25mKFtjdHguRkVBVFVSRSwgaHRtbC5URVhUQVJFQSwgaXRlbS5uYW1lLCBodG1sLkhFSUdIVF0uam9pbihpY2UuUFQpKXx8Y2FuLkNvbmYoWyJmZWF0dXJlIiwgaHRtbC5URVhUQVJFQSwgaHRtbC5IRUlHSFRdLmpvaW4oaWNlLlBUKSkKCQkJCWlucHV0LnN0eWxlLndpZHRoID0gaW5wdXQuc3R5bGUud2lkdGh8fGNhbi5Db25mKFtjdHguRkVBVFVSRSwgaHRtbC5URVhUQVJFQSwgaXRlbS5uYW1lLCBodG1sLldJRFRIXS5qb2luKGljZS5QVCkpfHxjYW4uQ29uZihbImZlYXR1cmUiLCBodG1sLlRFWFRBUkVBLCBodG1sLldJRFRIXS5qb2luKGljZS5QVCkpCgkJCQkvLyBubyBicmVhawoJCQljYXNlIGh0bWwuVVNFUk5BTUU6CgkJCWNhc2UgaHRtbC5QQVNTV09SRDoKCQkJCS8vIG5vIGJyZWFrCgkJCWNhc2UgaHRtbC5URVhUOgoJCQkJaXRlbS5hdXRvY29tcGxldGUgPSAib2ZmIgoJCQkJaXRlbS5uYW1lID0gaXRlbS5uYW1lfHxpdGVtLnR5cGUKCQkJCWl0ZW0udmFsdWUgPSB2YWx1ZXx8aXRlbS52YWx1ZXx8IiIKCQkJCWl0ZW0ucGxhY2Vob2xkZXIgPSBpdGVtLnBsYWNlaG9sZGVyfHxpdGVtLm5hbWV8fGl0ZW0udHlwZQoJCQkJaXRlbS50aXRsZSA9IGl0ZW0udGl0bGV8fGl0ZW0ucGxhY2Vob2xkZXJ8fGl0ZW0ubmFtZXx8aXRlbS50eXBlCgkJCQlpdGVtLmNsYXNzTmFtZSB8fCBjYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgaXRlbSwgY3R4LkFSR1MpCgkJCQlicmVhawoJCQljYXNlIGh0bWwuU0VMRUNUOiBpbnB1dC50eXBlID0gaHRtbC5TRUxFQ1QKCQkJCWl0ZW0udmFsdWVzID0gY2FuLmJhc2UuaXNTdHJpbmcoaXRlbS52YWx1ZXMpPyBjYW4uY29yZS5TcGxpdChpdGVtLnZhbHVlcyk6IGl0ZW0udmFsdWVzCgkJCQlpZiAoIWl0ZW0udmFsdWVzICYmIGl0ZW0udmFsdWUpIHsgaXRlbS52YWx1ZXMgPSBjYW4uY29yZS5TcGxpdChpdGVtLnZhbHVlKSwgaXRlbS52YWx1ZSA9IGl0ZW0udmFsdWVzWzBdIH0KCgkJCQlpdGVtLnZhbHVlID0gdmFsdWV8fGl0ZW0udmFsdWUsIGlucHV0Lmxpc3QgPSBpdGVtLnZhbHVlcy5tYXAoZnVuY3Rpb24odmFsdWUpIHsKCQkJCQlyZXR1cm4ge3R5cGU6IGh0bWwuT1BUSU9OLCB2YWx1ZTogdmFsdWUsIGlubmVyOiB2YWx1ZX0KCQkJCX0pLCBpdGVtLmNsYXNzTmFtZSB8fCBjYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgaXRlbSwgY3R4LkFSR1MpCgkJCQlicmVhawoJCQljYXNlIGh0bWwuQlVUVE9OOiBpdGVtLnZhbHVlID0gaXRlbS52YWx1ZXx8aXRlbS5uYW1lfHxtZGIuTElTVDsgYnJlYWsKCQkJY2FzZSAidXBmaWxlIjogaXRlbS50eXBlID0gaHRtbC5GSUxFOyBicmVhawoJCQljYXNlIGh0bWwuVVBMT0FEOiBpdGVtLnR5cGUgPSBodG1sLkZJTEUsIGlucHV0Lm5hbWUgPSBodG1sLlVQTE9BRDsgYnJlYWsKCQkJZGVmYXVsdDoKCQl9CgkJcmV0dXJuIGlucHV0Cgl9LAoKCXN0eWxlRGlzcGxheTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHZhbHVlKSB7CgkJcmV0dXJuIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkRJU1BMQVksIHZhbHVlKSwgdGFyZ2V0LnN0eWxlLmRpc3BsYXkKCX0sCglzdHlsZUhlaWdodDogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHZhbHVlKSB7CgkJcmV0dXJuIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkhFSUdIVCwgdmFsdWUpLCB0YXJnZXQub2Zmc2V0SGVpZ2h0Cgl9LAoJc3R5bGVXaWR0aDogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHZhbHVlKSB7CgkJcmV0dXJuIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLldJRFRILCB2YWx1ZSksIHRhcmdldC5vZmZzZXRXaWR0aAoJfSwKCXN0eWxlOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgc3R5bGUpIHsgdmFyIHZhbHVlID0ge30KCQlmb3IgKHZhciBpID0gMjsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgKz0gMikgewoJCQlpZiAodHlwZW9mIGFyZ3VtZW50c1tpXSA9PSBsYW5nLk9CSkVDVCkgewoJCQkJY2FuLmJhc2UuQ29weSh2YWx1ZSwgYXJndW1lbnRzW2ktLV0pCgkJCX0gZWxzZSBpZiAodHlwZW9mIGFyZ3VtZW50c1tpXSA9PSBsYW5nLlVOREVGSU5FRCkgewoJCQkJY29udGludWUKCQkJfSBlbHNlIHsKCQkJCXZhbHVlW2FyZ3VtZW50c1tpXV0gPSBhcmd1bWVudHNbaSsxXQoJCQl9CgkJfQoJCXJldHVybiBjYW4ucGFnZS5Nb2RpZnkoY2FuLCB0YXJnZXQsIHtzdHlsZTogdmFsdWV9KSwgdmFsdWUKCX0sCglLZXlzOiBmdW5jdGlvbigpIHsgdmFyIGxpc3QgPSBbXSAvLyBGUyBTUCBHVCBQVAoJCWZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciB2ID0gYXJndW1lbnRzW2ldCgkJCWlmICh0eXBlb2YgdiA9PSBsYW5nLk9CSkVDVCkgewoJCQkJZm9yICh2YXIgaiA9IDA7IGogPCB2Lmxlbmd0aDsgaisrKSB7CgkJCQkJaWYgKHR5cGVvZiB2W2pdID09IGxhbmcuT0JKRUNUKSB7CgkJCQkJCWZvciAodmFyIGsgPSAwOyBrIDwgdltqXS5sZW5ndGg7IGsrKykgewoJCQkJCQkJaWYgKHR5cGVvZiB2W2pdW2tdID09IGxhbmcuT0JKRUNUKSB7IHZbal1ba10gPSB2W2pdW2tdLmpvaW4oaWNlLlBUKSB9CgkJCQkJCX0KCQkJCQkJdltqXSA9IHZbal0uam9pbihpY2UuR1QpCgkJCQkJfQoJCQkJfQoJCQkJbGlzdC5wdXNoKHYuam9pbihpY2UuU1ApKQoJCQl9IGVsc2UgewoJCQkJbGlzdC5wdXNoKHYrIiIpCgkJCX0KCQl9CgkJcmV0dXJuIGxpc3Quam9pbihpY2UuRlMpCgl9LAoJY3NzOiBmdW5jdGlvbih0ZXh0KSB7CgkJdmFyIHN0eWxlU2hlZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpCgkJc3R5bGVTaGVldC50eXBlID0gInRleHQvY3NzIiwgc3R5bGVTaGVldC5pbm5lclRleHQgPSB0ZXh0CgkJZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZVNoZWV0KQoJfSwKCXRhZ2lzOiBmdW5jdGlvbih0eXBlLCB0YXJnZXQpIHsgdHlwZSA9IHR5cGVvZiB0eXBlID09IGxhbmcuT0JKRUNUPyB0eXBlOiBbdHlwZV0KCQlpZiAodHlwZS5pbmRleE9mKHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkpID4gLTEpIHsgcmV0dXJuIHRydWUgfQoJfSwKCW9mZnNldFRvcDogZnVuY3Rpb24oaXRlbSkgeyB2YXIgcmVzID0gMAoJCXdoaWxlIChpdGVtKSB7IHJlcyArPSBpdGVtLm9mZnNldFRvcHx8MCwgaXRlbSA9IGl0ZW0ucGFyZW50Tm9kZSB9CgkJcmV0dXJuIHJlcwoJfSwKCW9mZnNldExlZnQ6IGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIHJlcyA9IDAKCQkvLyBpZiAoaXRlbS5vZmZzZXRMZWZ0KSB7IHJldHVybiBpdGVtLm9mZnNldExlZnQgfQoJCXdoaWxlIChpdGVtKSB7IHJlcyArPSBpdGVtLm9mZnNldExlZnR8fDAsIGl0ZW0gPSBpdGVtLnBhcmVudE5vZGUgfQoJCXJldHVybiByZXMKCX0sCgoJQXBwZW5kVnVlOiBmdW5jdGlvbihjYW4sIG1ldGEsIGxpc3QsIHRhcmdldCkgewoJCWNhbi5yZXF1aXJlKFsiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS92dWVAMi9kaXN0L3Z1ZS5qcyJdLCBmdW5jdGlvbigpIHsKCQkJY2FuLnJlcXVpcmUoWyJodHRwczovL3VucGtnLmNvbS9lbGVtZW50LXVpL2xpYi9pbmRleC5qcyIsICJodHRwczovL3VucGtnLmNvbS9lbGVtZW50LXVpL2xpYi90aGVtZS1jaGFsay9pbmRleC5jc3MiXSwgZnVuY3Rpb24oKSB7CgkJCQluZXcgVnVlKGNhbi5iYXNlLkNvcHkoe2VsOiBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXR8fGNhbi5fb3V0cHV0LCBbe3R5cGU6ICJkaXYiLCBpbm5lcjogbGlzdH1dKS5maXJzdH0sIG1ldGEpKQoJCQl9KQoJCX0pCgl9LAoKCWluc2VydEJlZm9yZTogZnVuY3Rpb24oY2FuLCBsaXN0LCBiZWZvcmUpIHsKCQl2YXIgaXRlbSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGJlZm9yZS5wYXJlbnROb2RlLCBsaXN0KS5maXJzdAoJCWJlZm9yZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShpdGVtLCBiZWZvcmUpCgkJcmV0dXJuIGl0ZW0KCX0sCn0pCgo=",
        "/lib/user.js": "Vm9sY2Fub3MoInVzZXIiLCB7aGVscDogIueUqOaIt+aTjeS9nCIsIGluZm86IHt9LCBhZ2VudDogewoJCXNjYW5RUkNvZGU6IGZ1bmN0aW9uKGNiLCBjYW4pIHsKCQkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3t0eXBlOiBodG1sLlRFWFRBUkVBLCBuYW1lOiAidGV4dCIsIHRleHQ6ICIifV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJCWNiKGxpc3RbMF0sIGNhbi5iYXNlLlBhcnNlSlNPTihsaXN0WzBdKSkKCQkJfSkKCQl9LAoJCWdldExvY2F0aW9uOiBmdW5jdGlvbihjYikgewoJCQluYXZpZ2F0b3IuZ2VvbG9jYXRpb24uZ2V0Q3VycmVudFBvc2l0aW9uKGZ1bmN0aW9uKHJlcykgewoJCQkJY2Ioe2xhdGl0dWRlOiBwYXJzZUludChyZXMuY29vcmRzLmxhdGl0dWRlKjEwMDAwMCksIGxvbmdpdHVkZTogcGFyc2VJbnQocmVzLmNvb3Jkcy5sb25naXR1ZGUqMTAwMDAwKX0pCgkJCX0sIGZ1bmN0aW9uKHNvbWUpIHsKCQkJCXR5cGVvZiBjYiA9PSBsYW5nLkZVTkNUSU9OICYmIGNiKHtuYW1lOiAic29tZSJ9KQoJCQl9ICk7CgkJfSwKCQlvcGVuTG9jYXRpb246IGZ1bmN0aW9uKG1zZykgewoJCQl3aW5kb3cub3BlbigiaHR0cHM6Ly9tYXAuYmFpZHUuY29tL3NlYXJjaC8iK2VuY29kZVVSSUNvbXBvbmVudChtc2cuT3B0aW9uKG1kYi5URVhUKSkKCQkJCSsiL0AxMjk1ODc1MC4wODUsNDgyNTc4NS41NSwxNno/cXVlcnl0eXBlPXMmZGFfc3JjPXNoYXJldXJsJndkPSIrZW5jb2RlVVJJQ29tcG9uZW50KG1zZy5PcHRpb24obWRiLlRFWFQpKSkKCQl9LAoJCWNob29zZUltYWdlOiBmdW5jdGlvbihjYikgewoJCQl0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTiAmJiBjYihbXSkKCQl9LAoJfSwKCWlzV2VpWGluOiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk1pY3JvTWVzc2VuZ2VyIikgPiAtMSwKCWlzSVBob25lOiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoImlQaG9uZSIpID4gLTEsCglpc01vYmlsZTogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNb2JpbGUiKSA+IC0xLAoJaXNNYWNPU1g6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTWFjIE9TIFgiKSA+IC0xLAoJaXNXaW5kb3dzOiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIldpbmRvd3MiKSA+IC0xLAoJaXNJRTogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIikgPiAtMSwKCWlzRXh0ZW5zaW9uOiBsb2NhdGlvbiAmJiBsb2NhdGlvbi5wcm90b2NvbCAmJiBsb2NhdGlvbi5wcm90b2NvbCA9PSAiY2hyb21lLWV4dGVuc2lvbjoiLAoJaXNMb2NhbEZpbGU6IGxvY2F0aW9uICYmIGxvY2F0aW9uLnByb3RvY29sICYmIGxvY2F0aW9uLnByb3RvY29sID09ICJmaWxlOiIsCglpc0xhbmRzY2FwZTogZnVuY3Rpb24oKSB7IHJldHVybiB3aW5kb3cuaW5uZXJXaWR0aCA+IHdpbmRvdy5pbm5lckhlaWdodCB9LAoJaXNQb3J0cmFpdDogZnVuY3Rpb24oKSB7IHJldHVybiB3aW5kb3cuaW5uZXJXaWR0aCA8IHdpbmRvdy5pbm5lckhlaWdodCB9LAoJbW9kOiB7CgkJaXNQb2Q6IGxvY2F0aW9uICYmIGxvY2F0aW9uLnBhdGhuYW1lICYmIChsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC9wb2QvIikgPT0gMCB8fCBsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIveC8iKSA9PSAwKSwKCQlpc0RpdjogbG9jYXRpb24gJiYgbG9jYXRpb24ucGF0aG5hbWUgJiYgKGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9jaGF0L2Rpdi8iKSA9PSAwKSwKCQlpc0NtZDogbG9jYXRpb24gJiYgbG9jYXRpb24ucGF0aG5hbWUgJiYgKGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9jaGF0L3BvZC8iKSA9PSAwICYmIGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9jbWQvIikgPiAwIHx8CgkJCWxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9jaGF0L2NtZC8iKSA9PSAwIHx8IGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9oZWxwLyIpID09IDApLAoJCWlzV2ViOiBsb2NhdGlvbiAmJiBsb2NhdGlvbi5wYXRobmFtZSAmJiAobG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZigiL2NoYXQvcG9kLyIpID09IDAgJiYgbG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZigiL3dlYnNpdGUvIikgPiAwIHx8CgkJCWxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9jaGF0L3dlYnNpdGUvIikgPT0gMCksCgl9LAoKCWFsZXJ0OiBmdW5jdGlvbih0ZXh0KSB7IGFsZXJ0KEpTT04uc3RyaW5naWZ5KHRleHQpKSB9LAoJY29uZmlybTogZnVuY3Rpb24odGV4dCkgeyByZXR1cm4gY29uZmlybShKU09OLnN0cmluZ2lmeSh0ZXh0KSkgfSwKCXByb21wdDogZnVuY3Rpb24odGlwLCBkZWYsIGNiLCBzaWxlbnQpIHsgKHRleHQgPSBzaWxlbnQ/IGRlZjogcHJvbXB0KHRpcCwgZGVmfHwiIikpICE9IHVuZGVmaW5lZCAmJiB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTiAmJiBjYih0ZXh0KTsgcmV0dXJuIHRleHQgfSwKCXJlbG9hZDogZnVuY3Rpb24oZm9yY2UpIHsgKGZvcmNlIHx8IGNvbmZpcm0oIumHjeaWsOWKoOi9vemhtemdou+8nyIpKSAmJiBsb2NhdGlvbi5yZWxvYWQoKSB9LAoJanVtcHM6IGZ1bmN0aW9uKHVybCkgeyBsb2NhdGlvbi5ocmVmID0gdXJsIH0sCglvcGVuOiBmdW5jdGlvbih1cmwpIHsgd2luZG93Lm9wZW4odXJsKSB9LAoJdGltZTogZnVuY3Rpb24oY2FuLCB0aW1lLCBmbXQpIHsgdmFyIG5vdyA9IGNhbi5iYXNlLkRhdGUodGltZSkKCQl2YXIgbGlzdCA9IGNhbi51c2VyLmxhbmd1YWdlKGNhbikgPT0gImVuIj8gWyJTdW4iLCAiTW9uIiwgIlR1ZSIsICJXZWQiLCAiVGh1IiwgIkZyaSIsICJTYXQiXTogWyLlkajml6UiLCAi5ZGo5LiAIiwgIuWRqOS6jCIsICLlkajkuIkiLCAi5ZGo5ZubIiwgIuWRqOS6lCIsICLlkajlha0iXQoJCXJldHVybiBjYW4uYmFzZS5UaW1lKHRpbWUsIChmbXR8fCIleS0lbS0lZCAlSDolTTolUyIpLnJlcGxhY2UoIiV3IiwgbGlzdFtub3cuZ2V0RGF5KCldKSkKCX0sCgoJdGl0bGU6IGZ1bmN0aW9uKHRleHQpIHsKCQlpZiAod2luZG93LndlYnZpZXcpIHsgcmV0dXJuIHRpdGxlKHRleHQpIH0KCQlyZXR1cm4gdGV4dCAmJiAoZG9jdW1lbnQudGl0bGUgPSBWb2xjYW5vcy5tZXRhLmFyZ3MubmFtZXx8dGV4dCksIGRvY3VtZW50LnRpdGxlCgl9LAoJdG9waWM6IGZ1bmN0aW9uKGNhbiwgbmFtZSkgewoJCWNhbi51c2VyLm1vZC5pc0NtZCAmJiAobmFtZSArPSAiIHNpbXBsZSIpCgkJY2FuLkNvbmYoImRpc3BsYXkiKSAmJiAobmFtZSArPSAiICIrY2FuLkNvbmYoImRpc3BsYXkiKSkKCQljYW4udXNlci5pc01vYmlsZSAmJiAobmFtZSArPSAiIG1vYmlsZSIpICYmIGNhbi51c2VyLmlzTGFuZHNjYXBlKCkgJiYgKG5hbWUgKz0gIiBsYW5kc2NhcGUiKQoJCWNhbi51c2VyLmxhbmd1YWdlKGNhbikgJiYgKG5hbWUgKz0gIiAiK2Nhbi51c2VyLmxhbmd1YWdlKGNhbikpCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgZG9jdW1lbnQuYm9keSwge2NsYXNzTmFtZTogbmFtZX0pCgl9LAoJbGFuZ3VhZ2U6IGZ1bmN0aW9uKGNhbikgeyByZXR1cm4gY2FuLm1pc2MuU2VhcmNoKGNhbiwgImxhbmd1YWdlIikgfSwKCXRyYW5zOiBmdW5jdGlvbihjYW4sIHRleHQsIGxpc3QpIHsgaWYgKGNhbi5iYXNlLmlzT2JqZWN0KHRleHQpKSB7CgkJCXJldHVybiBjYW4uY29yZS5JdGVtKHRleHQsIGZ1bmN0aW9uKGssIHYpIHsgY2FuLmNvcmUuVmFsdWUoY2FuLl90cmFucywgaywgdikgfSkKCQl9CgoJCWlmIChjYW4udXNlci5sYW5ndWFnZShjYW4pID09ICJlbiIpIHsgcmV0dXJuIHRleHQgfQoJCWlmIChjYW4uYmFzZS5pc0Z1bmN0aW9uKHRleHQpKSB7IHRleHQgPSB0ZXh0Lm5hbWV8fCIiIH0KCQlyZXR1cm4gbGlzdCYmbGlzdFt0ZXh0XSB8fCBjYW4uQ29uZigidHJhbnMuIit0ZXh0KSB8fCBjYW4uQ29uZigiZmVhdHVyZS5fdHJhbnMuIit0ZXh0KSB8fCBjYW4uX3RyYW5zJiZjYW4uX3RyYW5zW3RleHRdIHx8IHsKCQkJImNyZWF0ZSI6ICLliJvlu7oiLCAicmVtb3ZlIjogIuWIoOmZpCIsICJpbnNlcnQiOiAi5re75YqgIiwgImRlbGV0ZSI6ICLliKDpmaQiLCAibW9kaWZ5IjogIue8lui+kSIsCgkJCSJpbnB1dHMiOiAi6KGl5YWoIiwgInBydW5lcyI6ICLmuIXnkIYiLCAiZXhwb3J0IjogIuWvvOWHuiIsICJpbXBvcnQiOiAi5a+85YWlIiwKCQkJImxpc3QiOiAi5p+l55yLIiwgImJhY2siOiAi6L+U5ZueIiwgInJ1biI6ICLmiafooYwiLCAiZG9uZSI6ICLlrozmiJAiLCAic2hhcmUiOiAi5YWx5LqrIiwKCQkJImVkaXQiOiAi57yW6L6RIiwgInNhdmUiOiAi5L+d5a2YIiwgImNvcHkiOiAi5aSN5Yi2IiwgInNob3ciOiAi5pi+56S6IiwgImhpZGUiOiAi6ZqQ6JePIiwKCQkJInByb2plY3QiOiAi6aG555uuIiwgInByb2ZpbGUiOiAi6K+m5oOFIiwgImFjdGlvbnMiOiAi5Y+C5pWwIiwKCQkJInBsdWdpbiI6ICLmj5Lku7YiLAoJCQkicHJldiI6ICLkuIrkuIDpobUiLCAibmV4dCI6ICLkuIvkuIDpobUiLAoKCQkJIm9wZW4iOiAi5omT5byAIiwgImNsb3NlIjogIuWFs+mXrSIsCgkJCSJzdGFydCI6ICLlkK/liqgiLCAic3RvcCI6ICLlgZzmraIiLAoJCQkiYmVnaW4iOiAi5byA5aeLIiwgImVuZCI6ICLnu5PmnZ8iLAoJCQkiY2xlYXIiOiAi5riF56m6IiwgInJlZnJlc2giOiAi5Yi35pawIiwKCQkJInN1Ym1pdCI6ICLmj5DkuqQiLCAiY2FuY2VsIjogIuWPlua2iCIsCgkJCSJsYWJlbCI6ICLmoIfnrb4iLCAiZXhlYyI6ICLmiafooYwiLAoJCX1bdGV4dF18fHRleHQKCX0sCgl0b2FzdENvbmZpcm06IGZ1bmN0aW9uKGNhbiwgdGl0bGUsIGNvbnRlbnQsIGFjdGlvbikgewoJCXJldHVybiBjYW4udXNlci50b2FzdChjYW4sIHt0aXRsZTogdGl0bGUsIGNvbnRlbnQ6IGNvbnRlbnQsIGFjdGlvbjogYWN0aW9ufHxbY2xpLkNMT1NFXSwgZHVyYXRpb246IC0xLCB3aWR0aDogLTMwMH0pCgl9LAoJdG9hc3RQcm9jZXNzOiBmdW5jdGlvbihjYW4sIHRpdGxlKSB7IHJldHVybiBjYW4udXNlci50b2FzdChjYW4sIGljZS5QUk9DRVNTLCB0aXRsZSwgLTEpIH0sCgl0b2FzdFN1Y2Nlc3M6IGZ1bmN0aW9uKGNhbiwgdGl0bGUpIHsgcmV0dXJuIGNhbi51c2VyLnRvYXN0KGNhbiwgaWNlLlNVQ0NFU1MsIHRpdGxlKSB9LAoJdG9hc3Q6IGZ1bmN0aW9uKGNhbiwgY29udGVudCwgdGl0bGUsIGR1cmF0aW9uLCBwcm9ncmVzcykgewoJCXZhciBtZXRhID0gY2FuLmJhc2UuaXNPYmplY3QoY29udGVudCk/IGNvbnRlbnQ6IHtjb250ZW50OiBjb250ZW50LCB0aXRsZTogdGl0bGV8fGNhbi5faGVscCwgZHVyYXRpb246IGR1cmF0aW9uLCBwcm9ncmVzczogcHJvZ3Jlc3N9CgkJdmFyIHdpZHRoID0gbWV0YS53aWR0aHx8NDAwLCBoZWlnaHQgPSBtZXRhLmhlaWdodHx8MTAwOyBpZiAod2lkdGggPCAwKSB7IHdpZHRoID0gd2luZG93LmlubmVyV2lkdGggKyB3aWR0aCB9CgoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGRvY3VtZW50LmJvZHksICBbe3ZpZXc6IGNoYXQuVE9BU1QsIHN0eWxlOiB7CgkJCWxlZnQ6ICh3aW5kb3cuaW5uZXJXaWR0aC13aWR0aCkvMiwgd2lkdGg6IHdpZHRoLCBib3R0b206IDEwMCwKCQl9LCBsaXN0OiBbCgkJCXt0ZXh0OiBbbWV0YS50aXRsZXx8IiIsIGh0bWwuRElWLCBodG1sLlRJVExFXSwgdGl0bGU6ICLngrnlh7vlpI3liLYiLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnVzZXIuY29weShldmVudCwgY2FuLCBtZXRhLnRpdGxlKQoJCQl9fSwKCQkJe3ZpZXc6ICJkdXJhdGlvbiIsIHRpdGxlOiAi54K55Ye75YWz6ZetIiwgb25jbGljazogZnVuY3Rpb24oKSB7IGFjdGlvbi5jbG9zZSgpIH19LAoJCQljYW4uYmFzZS5pc09iamVjdChtZXRhLmNvbnRlbnQpPyBtZXRhLmNvbnRlbnQ6IHt0ZXh0OiBbbWV0YS5jb250ZW50fHwi5omn6KGM5oiQ5YqfIiwgaHRtbC5ESVYsICJjb250ZW50Il19LAoKCQkJe3ZpZXc6IGNoYXQuQUNUSU9OfSwgbWV0YS5wcm9ncmVzcyAhPSB1bmRlZmluZWQgJiYge3ZpZXc6ICJwcm9ncmVzcyIsIHN0eWxlOiB7d2lkdGg6IHdpZHRofSwgbGlzdDogWwoJCQkJe3ZpZXc6ICJjdXJyZW50Iiwgc3R5bGU6IHt3aWR0aDogKG1ldGEucHJvZ3Jlc3N8fDApLzEwMCp3aWR0aH19LAoJCQldfSwKCQldIH1dKQoKCQl2YXIgYWN0aW9uID0gY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBtZXRhLmFjdGlvbnx8WyIiXSwgdWkuYWN0aW9uLCB7CgkJCWNsb3NlOiBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBhY3Rpb24uX3RhcmdldCksIGFjdGlvbi50aW1lci5zdG9wID0gdHJ1ZSB9LAoJCQl0aW1lcjogY2FuLmNvcmUuVGltZXIoe2ludGVydmFsOiAxMDAsIGxlbmd0aDogKHBhcnNlSW50KG1ldGEuZHVyYXRpb258fDEwMDApKS8xMDB9LCBmdW5jdGlvbihldmVudCwgaW50ZXJ2YWwsIGluZGV4KSB7CgkJCQlpZiAoaW5kZXggPiAzMCkgeyB1aS5kdXJhdGlvbi5pbm5lckhUTUwgPSBwYXJzZUludChpbmRleC8xMCkraWNlLlBUKyhpbmRleCUxMCkrInMuLi4iIH0KCQkJfSwgZnVuY3Rpb24oKSB7IGFjdGlvbi5jbG9zZSgpIH0pLCBfdGFyZ2V0OiB1aS5fdGFyZ2V0LCB1aTogdWksCgkJfSk7IGNhbi5vbm1vdGlvbi5zdG9yeS5hdXRvKGNhbiwgdWkuX3RhcmdldCkKCgkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNoYXQuT05UT0FTVCwgY2FuLnJlcXVlc3Qoe30sIHt0aW1lOiBjYW4uYmFzZS5UaW1lKCksIHRpdGxlOiBtZXRhLnRpdGxlLCBjb250ZW50OiBtZXRhLmNvbnRlbnQsIGZpbGVsaW5lOiBjYW4ubWlzYy5GaWxlTGluZSgyLCAyKX0pKQoJCXJldHVybiAhbWV0YS5hY3Rpb24gJiYgY2FuLm9ubW90aW9uLmZsb2F0LmFkZChjYW4sIGNoYXQuVE9BU1QsIGFjdGlvbiksIGFjdGlvbgoJfSwKCXNoYXJlOiBmdW5jdGlvbihjYW4sIG1zZywgY21kKSB7CgkJY2FuLnJ1bihtc2cuX2V2ZW50LCBjbWR8fFtjdHguQUNUSU9OLCBjaGF0LlNIQVJFXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0KGNhbiwge2hlaWdodDogMzAwLCB3aWR0aDogNTAwLAoJCQkJdGl0bGU6IG1zZy5BcHBlbmQobWRiLk5BTUUpLCBkdXJhdGlvbjogLTEsCgkJCQljb250ZW50OiBtc2cuQXBwZW5kKG1kYi5URVhUKSwgYWN0aW9uOiBbY2xpLkNMT1NFXSwKCQkJfSksIGNhbi51c2VyLmNvcHkobXNnLl9ldmVudCwgY2FuLCBtc2cuQXBwZW5kKG1kYi5OQU1FKSkKCQl9KQoJfSwKCWxvZ2luOiBmdW5jdGlvbihjYW4sIGNiLCBtZXRob2QsIGF1dG8pIHsgbWV0aG9kID0gY2FuLmJhc2UuT2JqKG1ldGhvZCwgWyLnmbvlvZUiLCAi5omr56CBIl0pCgkJdmFyIGxpc3QgPSB7CgkJCSLnmbvlvZUiOiBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCQljYW4ucnVuKHt9LCBbYWFhLkxPR0lOLCBkYXRhW2h0bWwuVVNFUk5BTUVdLCBkYXRhW2h0bWwuUEFTU1dPUkRdXSwgZnVuY3Rpb24obXNnKSB7CgkJCQkJaWYgKG1zZy5PcHRpb24oaWNlLk1TR19VU0VSTkFNRSkpIHsKCQkJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdWkuX3RhcmdldCksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNhbi51c2VyLnRvYXN0KGNhbiwgIueUqOaIt+WQjeaIluWvhueggemUmeivryIpCgkJCQkJfQoJCQkJfSkKCQkJCXJldHVybiB0cnVlCgkJCX0sIAoJCQki5omr56CBIjogZnVuY3Rpb24oKSB7CgkJCQljYW4ubWlzYy5XU1MoY2FuLCB7dHlwZTogaHRtbC5DSFJPTUUsIGNtZDogInB3ZCJ9LCBmdW5jdGlvbihldmVudCwgbXNnLCBjbWQsIGFyZykgeyBpZiAoIW1zZykgeyByZXR1cm4gfQoJCQkJCWlmIChjbWQgPT0gInB3ZCIpIHsKCQkJCQkJcmV0dXJuIGNhbi51c2VyLnRvYXN0KGNhbiwgYXJnWzJdLCBhcmdbMV0sIC0xKSwgbXNnLlJlcGx5KCkKCQkJCQl9CgkJCQkJaWYgKGNtZCA9PSBpY2UuTVNHX1NFU1NJRCkgewoJCQkJCQlyZXR1cm4gY2FuLm1pc2MuQ29va2llU2Vzc2lkKGNhbiwgYXJnWzBdKSwgbXNnLlJlcGx5KCksIGNhbi51c2VyLnJlbG9hZCh0cnVlKQoJCQkJCX0KCQkJCQljYW4uc2VhcmNoKGV2ZW50LCBtc2dbaWNlLk1TR19ERVRBSUxdfHxbXSwgZnVuY3Rpb24obXNnKSB7IG1zZy5SZXBseSgpIH0pCgkJCQl9KQoJCQl9LAoJCQki5o6I5p2DIjogZnVuY3Rpb24oKSB7CgkJCQljYW4ubWlzYy5XU1MoY2FuLCB7dHlwZTogaHRtbC5DSFJPTUUsIGNtZDogInNzbyIsICJ1c2VyLndlYiI6IGxvY2F0aW9uLmhyZWZ9LCBmdW5jdGlvbihldmVudCwgbXNnLCBjbWQsIGFyZykgeyBpZiAoIW1zZykgeyByZXR1cm4gfQoJCQkJCWlmIChjbWQgPT0gInB3ZCIpIHsKCQkJCQkJcmV0dXJuIGxvY2F0aW9uLmhyZWYgPSBhcmdbMV0KCQkJCQl9CgkJCQkJaWYgKGNtZCA9PSBpY2UuTVNHX1NFU1NJRCkgewoJCQkJCQlyZXR1cm4gY2FuLm1pc2MuQ29va2llU2Vzc2lkKGNhbiwgYXJnWzBdKSwgbXNnLlJlcGx5KCksIGNhbi51c2VyLnJlbG9hZCh0cnVlKQoJCQkJCX0KCQkJCQljYW4uc2VhcmNoKGV2ZW50LCBtc2dbaWNlLk1TR19ERVRBSUxdfHxbXSwgZnVuY3Rpb24obXNnKSB7IG1zZy5SZXBseSgpIH0pCgkJCQl9KQoJCQl9LAoJCQki6aOe5LmmIjogZnVuY3Rpb24oKSB7IGxvY2F0aW9uLmhyZWYgPSAiL2NoYXQvbGFyay9zc28iIH0sCgkJfTsgaWYgKGF1dG8pIHsgcmV0dXJuIGxpc3RbIuaOiOadgyJdKCkgfSBlbHNlIGlmIChtZXRob2QubGVuZ3RoID09IDEpIHsgbGlzdFttZXRob2RbMF1dKCk7IHJldHVybiB9CgoJCXZhciB1aSA9IGNhbi51c2VyLmlucHV0KHt9LCBjYW4sIFt7dHlwZTogaHRtbC5VU0VSTkFNRX0sIHt0eXBlOiBodG1sLlBBU1NXT1JEfV0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEpIHsgcmV0dXJuIGxpc3RbYnV0dG9uXShldmVudCwgYnV0dG9uLCBkYXRhKSB9LCBtZXRob2QpCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdWkuX3RhcmdldCwge2NsYXNzTmFtZTogImlucHV0IGxvZ2luIiwgc3R5bGU6IHtsZWZ0OiAod2luZG93LmlubmVyV2lkdGgtdWkuX3RhcmdldC5vZmZzZXRXaWR0aCkvMiwgdG9wOiB3aW5kb3cuaW5uZXJIZWlnaHQvNn19KQoJfSwKCWxvZ291dDogZnVuY3Rpb24oY2FuLCBmb3JjZSkgeyBpZiAoZm9yY2V8fGNhbi51c2VyLmNvbmZpcm0oImxvZ291dD8iKSkgewoJCWNhbi5ydW4oe30sIFtjdHguQUNUSU9OLCBhYWEuTE9HT1VUXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuU0hBUkUpPyBjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LlNIQVJFLCAiIik6IGNhbi51c2VyLnJlbG9hZCh0cnVlKQoJCX0pCgl9IH0sCgoJdG9QTkc6IGZ1bmN0aW9uKGNhbiwgbmFtZSwgdGV4dCwgaGVpZ2h0LCB3aWR0aCkgewoJCWlmICh0ZXh0LmluZGV4T2YoIjxzdmciKSAhPSAwKSB7CgkJCXRleHQgPSAnPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPicrdGV4dCsiPC9zdmc+IgoJCX0KCQl2YXIgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChodG1sLklNRykKCQlpbWcub25sb2FkID0gZnVuY3Rpb24oKSB7CgkJCXZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJjYW52YXMiKQoJCQljYW52YXMuaGVpZ2h0ID0gaGVpZ2h0LCBjYW52YXMud2lkdGggPSB3aWR0aAoJCQljYW52YXMuZ2V0Q29udGV4dCgiMmQiKS5kcmF3SW1hZ2UoaW1nLCAwLCAwKQoKCQkJdmFyIGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIikKCQkJYS5ocmVmID0gY2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIikKCQkJYS5kb3dubG9hZCA9IG5hbWUsIGEuY2xpY2soKQoJCX0sIGltZy5zcmMgPSAiZGF0YTppbWFnZS9zdmcreG1sLCIrZW5jb2RlVVJJQ29tcG9uZW50KHRleHQpCgl9LAoJY29weTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGV4dCkgewoJCWlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkKSB7IHZhciBvayA9IGZhbHNlCgkJCW5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHRleHQpLnRoZW4oZnVuY3Rpb24oKSB7IG9rID0gdHJ1ZSB9KQoJCQlpZiAob2spIHsgcmV0dXJuIGNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pIH0KCQl9CgoJCXZhciBpbnB1dCA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLCBbe3R5cGU6IGh0bWwuVEVYVEFSRUEsIHZhbHVlOiB0ZXh0fV0pLmZpcnN0CgkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgaW5wdXQpLCBkb2N1bWVudC5leGVjQ29tbWFuZCgiQ29weSIpCgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaW5wdXQpLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKQoJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCWNhbi5taXNjLkxvZygiY29weSIsIHRleHQpCgkJcmV0dXJuIHRleHQKCX0sCgljYXJ0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbWV0YSwgbGlzdCwgY2IsIHBhcmVudCkgeyAvLyBldmVudCBpdGVtIG1ldGEKCQltZXRhID0gbWV0YXx8Y2FuLm9uZGV0YWlsfHxjYW4ub25hY3Rpb258fHt9LCBsaXN0ID0gbGlzdCYmbGlzdC5sZW5ndGggPiAwPyBsaXN0OiBtZXRhLmxpc3R8fFtdOyBpZiAobGlzdC5sZW5ndGggPT0gMCkgeyByZXR1cm4gfQoJCWNiID0gY2J8fGZ1bmN0aW9uKGV2ZW50LCBpdGVtLCBtZXRhKSB7IHZhciBjYiA9IG1ldGFbaXRlbV18fG1ldGFbIl9lbmdpbmUiXTsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgY2FuLCBpdGVtKSB9CgoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGRvY3VtZW50LmJvZHksIFt7dmlldzogY2hhdC5DQVJURSwgc3R5bGU6IHtsZWZ0OiAwLCB0b3A6IDB9LCBvbm1vdXNlbGVhdmU6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCS8vIGNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLl90YXJnZXQpCgkJfSwgbGlzdDogY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQlyZXR1cm4gY2FuLmJhc2UuaXNTdHJpbmcoaXRlbSk/IHt2aWV3OiBodG1sLklURU0sIGxpc3Q6IFt7dGV4dDogY2FuLnVzZXIudHJhbnMoY2FuLCBpdGVtKSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLl90YXJnZXQpCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50LCBpdGVtLCBtZXRhLCBpbmRleCkKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FydGUuX2Zsb2F0ICYmIGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhcnRlLl9mbG9hdC5fdGFyZ2V0KQoJCQl9IH1dIH06IGNhbi5iYXNlLmlzQXJyYXkoaXRlbSk/IHt2aWV3OiBodG1sLklURU0sIGxpc3Q6IFt7dGV4dDogY2FuLnVzZXIudHJhbnMoY2FuLCBpdGVtWzBdKSsiIC0+ICJ9XSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJdmFyIHN1YiA9IGNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIG1ldGEsIGl0ZW0uc2xpY2UoMSksIGNiLCBjYXJ0ZSkKCQkJCWNhcnRlLl9mbG9hdCAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYXJ0ZS5fZmxvYXQuX3RhcmdldCksIGNhcnRlLl9mbG9hdCA9IHN1YgoJCQkJY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuLCBzdWIuX3RhcmdldCwgdHJ1ZSkKCQkJfSB9OiB7dmlldzogaHRtbC5JVEVNLCBsaXN0OiBbe3RleHQ6IGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbS5uYW1lKSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLl90YXJnZXQpCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50LCBpdGVtLm5hbWUsIG1ldGEsIGluZGV4KQoJCQl9LCBvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYXJ0ZS5fZmxvYXQgJiYgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FydGUuX2Zsb2F0Ll90YXJnZXQpCgkJCX0gfV0gfQoJCX0pIH1dICkKCgkJdWkuX3RhcmdldC5vbm1vdXNlb3ZlciA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KSB9CgkJdmFyIGNhcnRlID0ge190YXJnZXQ6IHVpLl90YXJnZXQsIF9wYXJlbnQ6IHBhcmVudCwgbGF5b3V0OiBjYW4ub25sYXlvdXQuZmlndXJlKGV2ZW50LCBjYW4sIHVpLl90YXJnZXQpfQoJCXJldHVybiBjYW4ub25rZXltYXAucHJldmVudChldmVudCksIGNhcnRlCgl9LAoJY2FydGVSaWdodDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbWV0YSwgbGlzdCwgY2IsIHBhcmVudCkgewoJCXZhciBjYXJ0ZSA9IGNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIG1ldGEsIGxpc3QsIGNiLCBwYXJlbnQpCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FydGUuX3RhcmdldCwge3N0eWxlOiB7CgkJCWxlZnQ6IGV2ZW50LmNsaWVudFgtZXZlbnQub2Zmc2V0WCtldmVudC50YXJnZXQub2Zmc2V0V2lkdGgtMywKCQkJdG9wOiBjYXJ0ZS5fdGFyZ2V0Lm9mZnNldFRvcC0oY2FydGUubGF5b3V0LmJvdHRvbT8gLWV2ZW50LnRhcmdldC5vZmZzZXRIZWlnaHQ6IGV2ZW50LnRhcmdldC5vZmZzZXRIZWlnaHQpKzUsCgkJCWJvdHRvbTogIiIsCgkJfX0pCgkJcmV0dXJuIGNhcnRlCgl9LAoJY2FydGVDbGllbnQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGxpc3QsIGNiLCBwYXJlbnQpIHsKCQl2YXIgdWkgPSBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBtZXRhLCBsaXN0LCBjYiwgcGFyZW50KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLl90YXJnZXQsIHtzdHlsZToge2xlZnQ6IGV2ZW50LmNsaWVudFgsIHRvcDogZXZlbnQuY2xpZW50WX19KQoJfSwKCglpbnB1dDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgZm9ybSwgY2IsIGJ1dHRvbikgeyBpZiAoIWZvcm0gfHwgZm9ybS5sZW5ndGggPT0gMCkgeyByZXR1cm4gY2IoKSB9CgkJdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGRvY3VtZW50LmJvZHksIFt7dmlldzogW2h0bWwuSU5QVVRdLCBzdHlsZToge2xlZnQ6IDAsIHRvcDogMH0sIGxpc3Q6IFsKCQkJe3ZpZXc6ICJjb250ZW50IiwgbGlzdDogW3t2aWV3OiBbY2hhdC5PUFRJT04sIGh0bWwuVEFCTEVdLCBsaXN0OiBjYW4uY29yZS5MaXN0KGZvcm0sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWl0ZW0gPSBjYW4uYmFzZS5pc1N0cmluZyhpdGVtKT8ge3R5cGU6IGh0bWwuVEVYVCwgbmFtZTogaXRlbX06IGl0ZW0ubGVuZ3RoID4gMD8ge3R5cGU6IGh0bWwuU0VMRUNULCBuYW1lOiBpdGVtWzBdLCB2YWx1ZXM6IGl0ZW0uc2xpY2UoMSl9OiBpdGVtCgkJCQlpdGVtLnR5cGUgPSBpdGVtLnR5cGV8fChpdGVtLnZhbHVlcz8gaHRtbC5TRUxFQ1Q6IGl0ZW0ubmFtZSA9PSBodG1sLlRFWFQ/IGh0bWwuVEVYVEFSRUE6IGh0bWwuVEVYVCkKCgkJCQlpdGVtLl9pbml0ID0gZnVuY3Rpb24odGFyZ2V0KSB7CgkJCQkJaXRlbS5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsKCQkJCQkJdmFyIF9tc2cgPSBjYW4ucmVxdWVzdChldmVudCwge19oYW5kbGU6IGljZS5UUlVFLCBhY3Rpb246IG1zZy5PcHRpb24oY2hhdC5BQ1RJT04pfSwgbXNnLCBjYW4uT3B0aW9uKCkpCgkJCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLnRhYmxlLCBodG1sLk9QVElPTl9BUkdTLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCQlpdGVtLm5hbWUgJiYgaXRlbS52YWx1ZSAmJiBfbXNnLk9wdGlvbihpdGVtLm5hbWUsIGl0ZW0udmFsdWUpCgkJCQkJCX0pCgkJCQkJCWNhbi5ydW4oZXZlbnQsIGNtZHMsIGNiLCB0cnVlKQoJCQkJCX0KCgkJCQkJaWYgKGl0ZW0ubmFtZSAhPSAiYWN0aW9uIiAmJiBpdGVtLm5hbWUpIHsKCQkJCQkJdGFyZ2V0LnZhbHVlID0gbXNnLk9wdGlvbihpdGVtLm5hbWUpfHxjYW4uT3B0aW9uKGl0ZW0ubmFtZSl8fHRhcmdldC52YWx1ZXx8IiIKCQkJCQl9CgkJCQkJY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIGl0ZW0sIHRhcmdldCkKCQkJCX0KCgkJCQkvLyByZXR1cm4ge3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dHlwZTogaHRtbC5URCwgbGlzdDogW3t0ZXh0OiBpdGVtLl90cmFuc3x8Y2FuLnVzZXIudHJhbnMoY2FuLCBpdGVtLm5hbWUpfHwiIn1dfSwge3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFtjYW4ucGFnZS5pbnB1dChjYW4sIGl0ZW0pXX0gXX0KCQkJCXJldHVybiB7dHlwZTogaHRtbC5UUiwgbGlzdDogW3t0eXBlOiBodG1sLlRELCBsaXN0OiBbe3RleHQ6IGl0ZW0ubmFtZXx8IiJ9XX0sIHt0eXBlOiBodG1sLlRELCBsaXN0OiBbY2FuLnBhZ2UuaW5wdXQoY2FuLCBpdGVtKV19IF19CgkJCX0pfV19LCB7dmlldzogY2hhdC5BQ1RJT059LAoJCV19XSkKCgkJdmFyIGxheW91dCA9IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgdWkuX3RhcmdldCkKCQlpZiAobGF5b3V0LmxlZnQgPT0gdW5kZWZpbmVkKSB7IGlmICghbGF5b3V0LnRvcCkgeyBsYXlvdXQudG9wID0gMzIgfQoJCQlsYXlvdXQubGVmdCA9IHdpbmRvdy5pbm5lcldpZHRoLzItdWkuX3RhcmdldC5vZmZzZXRXaWR0aC8yLCBsYXlvdXQucmlnaHQgPSAiIgoJCQljYW4ucGFnZS5zdHlsZShjYW4sIHVpLl90YXJnZXQsIGxheW91dCkKCQl9CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHVpLl90YXJnZXQsIGNoYXQuRkxPQVQpCgkJaWYgKGxheW91dC50b3ApIHsKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB1aS5jb250ZW50LCBodG1sLk1BWF9IRUlHSFQsIHdpbmRvdy5pbm5lckhlaWdodCAtIGxheW91dC50b3AgLSBodG1sLkFDVElPTl9IRUlHSFQgLSAxMCkKCQl9CgoJCXZhciBhY3Rpb24gPSBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIGJ1dHRvbnx8W2h0bWwuU1VCTUlULCBodG1sLkNBTkNFTF0sIHVpLmFjdGlvbiwgewoJCQlmb2N1czogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdWkuZmlyc3QsIGh0bWwuSU5QVVRfQVJHUylbMF0uZm9jdXMoKSB9LAoJCQljYW5jZWw6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLl90YXJnZXQpIH0sCgkJCV9lbmdpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBhY3Rpb24uc3VibWl0KGV2ZW50LCBjYW4sIGJ1dHRvbikgfSwKCQkJc3VibWl0OiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgdmFyIGRhdGEgPSB7fSwgYXJncyA9IFtdLCBsaXN0ID0gW10KCQkJCWxpc3QgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS50YWJsZSwgaHRtbC5PUFRJT05fQVJHUywgZnVuY3Rpb24oaXRlbSkgewoJCQkJCXJldHVybiBpdGVtLm5hbWUgJiYgaXRlbS52YWx1ZSAmJiBhcmdzLnB1c2goaXRlbS5uYW1lLCBpdGVtLnZhbHVlKSwgZGF0YVtpdGVtLm5hbWVdID0gaXRlbS52YWx1ZQoJCQkJfSkKCQkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge19oYW5kbGU6IGljZS5UUlVFfSkKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgIWNiKGV2ZW50LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpICYmIGFjdGlvbi5jYW5jZWwoKQoJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCX0sIF90YXJnZXQ6IHVpLl90YXJnZXQsCgkJfSkKCQlpZiAoYnV0dG9uID09PSAgdHJ1ZSkgeyByZXR1cm4gYWN0aW9uLnN1Ym1pdChldmVudCwgY2FuLCAic3VibWl0IiksIGFjdGlvbiB9CgoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLl90YXJnZXQsIGh0bWwuSU5QVVRfQVJHUywgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJaW5kZXggPT0gMCAmJiBjYW4uY29yZS5UaW1lcigxMDAsIGZ1bmN0aW9uKCkgeyBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBpdGVtKSB9KQoJCX0pCgkJcmV0dXJuIGFjdGlvbgoJfSwKCXNlbGVjdDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdHlwZSwgZmllbGRzLCBjYiwgY2JzKSB7CgkJdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB7ZmllbGRzOiBmaWVsZHN8fCJ0eXBlLG5hbWUsdGV4dCJ9KQoJCWNhbi5zZWFyY2gobXNnLl9ldmVudCwgWyJTZWFyY2gub25pbXBvcnQuc2VsZWN0IiwgdHlwZSwgIiIsICIiXSwgZnVuY3Rpb24obGlzdCkgewoJCQljYW4uY29yZS5OZXh0KGxpc3QsIGNiLCBjYnN8fGZ1bmN0aW9uKCkgewoJCQkJY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbikKCQkJfSkKCQl9KQoJfSwKCXVwbG9hZDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgYmVnaW4gPSBuZXcgRGF0ZSgpCgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgZG9jdW1lbnQuYm9keSwgW3t2aWV3OiBodG1sLlVQTE9BRCwgc3R5bGU6IHtsZWZ0OiAwLCB0b3A6IDB9LCBsaXN0OiBbCgkJCXt2aWV3OiBodG1sLkFDVElPTn0sIHt2aWV3OiBodG1sLk9VVFBVVCwgbGlzdDogW3t2aWV3OiAicHJvZ3Jlc3MifV19LAoJCQl7dmlldzogaHRtbC5TVEFUVVMsIGxpc3Q6IFt7dmlldzogaHRtbC5TSE9XfSwge3ZpZXc6ICJjb3N0In0sIHt2aWV3OiAic2l6ZSJ9XX0sCgkJXX1dKTsgY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuLCB1aS5fdGFyZ2V0KQoKCQl2YXIgYWN0aW9uID0gY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBbCgkJCXt0eXBlOiBodG1sLlVQTE9BRCwgb25jaGFuZ2U6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlhY3Rpb24uc2hvdyhldmVudCwgMCwgZXZlbnQudGFyZ2V0LmZpbGVzWzBdLnNpemUsIDApCgkJCX19LCBjbGkuQ0xPU0UsCgkJXSwgdWkuYWN0aW9uLCB7CgkJCWNsb3NlOiBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KSB9LAoJCQliZWdpbjogZnVuY3Rpb24oZXZlbnQpIHsgYmVnaW4gPSBuZXcgRGF0ZSgpCgkJCQl2YXIgdXBsb2FkID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdWkuYWN0aW9uLCAiaW5wdXRbdHlwZT1maWxlXSIpCgkJCQlpZiAodXBsb2FkWzBdLmZpbGVzLmxlbmd0aCA9PSAwKSB7IHJldHVybiB1cGxvYWRbMF0uZm9jdXMoKSB9CgoJCQkJdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCBjYW4uT3B0aW9uKCksIHtfaGFuZGxlOiAidHJ1ZSJ9KQoJCQkJbXNnLl91cGxvYWQgPSB1cGxvYWRbMF0uZmlsZXNbMF0sIG1zZy5fcHJvZ3Jlc3MgPSBhY3Rpb24uc2hvdwoKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBodG1sLlVQTE9BRF0sIGZ1bmN0aW9uKG1zZykgewoJCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pLCBjYW4uVXBkYXRlKCksIGFjdGlvbi5jbG9zZSgpCgkJCQl9LCB0cnVlKQoJCQl9LAoJCQlzaG93OiBmdW5jdGlvbiAoZXZlbnQsIHZhbHVlLCB0b3RhbCwgbG9hZGVkKSB7IG5vdyA9IG5ldyBEYXRlKCkKCQkJCXZhbHVlID09IDAgJiYgYWN0aW9uLmJlZ2luKGV2ZW50KQoKCQkJCXVpLnNob3cuaW5uZXJIVE1MID0gdmFsdWUrIiUiCgkJCQl1aS5jb3N0LmlubmVySFRNTCA9IGNhbi5iYXNlLkR1cmF0aW9uKG5vdyAtIGJlZ2luKQoJCQkJdWkuc2l6ZS5pbm5lckhUTUwgPSBjYW4uYmFzZS5TaXplKGxvYWRlZCkraWNlLlBTK2Nhbi5iYXNlLlNpemUodG90YWwpCgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB1aS5wcm9ncmVzcywge3N0eWxlOiB7d2lkdGg6IHZhbHVlKih1aS5vdXRwdXQub2Zmc2V0V2lkdGgtMikvMTAwfX0pCgkJCX0sCgkJfSk7IGNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLmFjdGlvbiwgImlucHV0W3R5cGU9ZmlsZV0iKVswXS5jbGljaygpCgoJCXJldHVybiBhY3Rpb24KCX0sCglkb3dubG9hZDogZnVuY3Rpb24oY2FuLCBwYXRoLCBuYW1lKSB7CgkJdmFyIGEgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBkb2N1bWVudC5ib2R5LCBbe3R5cGU6IGh0bWwuQSwgaHJlZjogcGF0aCwgZG93bmxvYWQ6IG5hbWV8fHBhdGguc3BsaXQoaWNlLlBTKS5wb3AoKX1dKS5maXJzdAoJCWEuY2xpY2soKSwgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgYSkKCX0sCglkb3dubG9hZHM6IGZ1bmN0aW9uKGNhbiwgdGV4dCwgbmFtZSkgeyBjYW4udXNlci5kb3dubG9hZChjYW4sIFVSTC5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW3RleHRdKSksIG5hbWUpIH0sCgljYW1lcmE6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYikgewoJCW5hdmlnYXRvci5nZXRVc2VyTWVkaWEoe3ZpZGVvOiB0cnVlfSwgY2IsIGZ1bmN0aW9uKGVycm9yKSB7CgkJCWNhbi5taXNjLkxvZyhlcnJvcikKCQl9KQoJfSwKfSkKCg==",
        "/page/cache.css": "ZmllbGRzZXQuSGVhZGVyIHsgZm9udC1zaXplOjEuMmVtOyBwYWRkaW5nOjAgNXB4OyBoZWlnaHQ6MzJweDsgb3ZlcmZsb3c6aGlkZGVuOyB6LWluZGV4OjEwOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0IHsgaGVpZ2h0OjMycHg7IG92ZXJmbG93OmhpZGRlbjsgfQpmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dD5kaXYgeyBwYWRkaW5nOjVweDsgaGVpZ2h0OjIycHg7IGN1cnNvcjpwb2ludGVyOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0PmRpdjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgYm9yZGVyLWJvdHRvbTpzb2xpZCAycHggcmVkOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0PmRpdi50aXRsZSB7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnN0YXRlIHsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnN0YXRlLmF2YXRhcj5pbWcgeyBoZWlnaHQ6MS40ZW07IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaCB7IG1hcmdpbi1sZWZ0OjIwcHg7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaD5pbnB1dCB7IG1hcmdpbi10b3A6LTVweDsgaGVpZ2h0OjI1cHg7IGJvcmRlci1yYWRpdXM6MDsgfQpmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dCBkaXYubWVudSB7IHBhZGRpbmc6NXB4OyBoZWlnaHQ6MjFweDsgY3Vyc29yOnBvaW50ZXI7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQgZGl2Lm1lbnU6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyZTUxNWY7IGJvcmRlci1ib3R0b206c29saWQgMnB4IHJlZDsgfQoKZGl2LmhlYWQgewoJYmFja2dyb3VuZC1jb2xvcjojNDA0MDQwOyBwYWRkaW5nOjVweDsgaGVpZ2h0OjQycHg7IGNsZWFyOmJvdGg7Cn0KZGl2LmxlZnQgZGl2LnVzZXJuYW1lIGRpdiB7Cgljb2xvcjp3aGl0ZTsgdGV4dC1hbGlnbjpjZW50ZXI7IHBhZGRpbmc6MTBweDsKfQpkaXYubGVmdCBkaXYudXNlcm5hbWUgaW1nIHsKCXBhZGRpbmc6MCAxMHB4OyB3aWR0aDoxMDBweDsKfQpkaXYuaGVhZCBkaXYudXNlcm5hbWUgaW1nIHsKCWhlaWdodDo0MHB4OyBmbG9hdDpsZWZ0Owp9CmRpdi5oZWFkIGRpdi51c2VybmFtZSBkaXYgewoJcGFkZGluZzoxMnB4OyBmbG9hdDpsZWZ0Owp9CmRpdi5oZWFkIGRpdi51c2VybmFtZSB7Cgljb2xvcjp3aGl0ZTsgZmxvYXQ6cmlnaHQ7CglwYWRkaW5nLXJpZ2h0OjEwcHg7Cn0KZGl2LmhlYWQgZGl2Lm1lbnUgewoJY29sb3I6d2hpdGU7IGN1cnNvcjpwb2ludGVyOyBwYWRkaW5nOjEwcHg7IGZsb2F0OmxlZnQ7Cn0KZGl2LmhlYWQgZGl2Lm1lbnU6aG92ZXIgewoJYmFja2dyb3VuZC1jb2xvcjojMzIzMjMyOwp9CmRpdi5sZWZ0IHsKCXdpZHRoOjEyMHB4OwoJYmFja2dyb3VuZC1jb2xvcjojMzIzMjMyOyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0Owp9CmRpdi5sZWZ0OmhvdmVyIHsKCWJhY2tncm91bmQtY29sb3I6IzMyMzIzMjsKfQpkaXYubGVmdCBkaXYuaXRlbSB7CgliYWNrZ3JvdW5kLWNvbG9yOiMzMjMyMzI7Cgljb2xvcjp3aGl0ZTsgcGFkZGluZzo1cHggMTBweDsKfQpkaXYubGVmdCBkaXYuaXRlbTpob3ZlciB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7Cn0KZGl2Lm1haW4gewoJYmFja2dyb3VuZC1jb2xvcjojY2NjY2NjOyBoZWlnaHQ6MTgwcHg7IHdpZHRoOjE4MHB4OyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0Owp9CmRpdi5tYWluIGlmcmFtZSB7Cglib3JkZXI6MDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gewoJYmFja2dyb3VuZC1jb2xvcjojZjhmOGY4OyBwYWRkaW5nOjEwcHg7IG1hcmdpbjoxMHB4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiBmb3JtLm9wdGlvbiBkaXYuaXRlbSB7CiAJbWFyZ2luOjEwcHg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIGRpdi5hY3Rpb24gZGl2Lml0ZW0gewogCW1hcmdpbjoxMHB4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiBsZWdlbmQgewoJYm94LXNoYWRvdzpub25lOwoJYmFja2dyb3VuZC1jb2xvcjojZTRlNGU0OwoJY29sb3I6YmxhY2s7CglkaXNwbGF5OmJsb2NrOwoJZmxvYXQ6bGVmdDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gZm9ybS5vcHRpb24gewoJZGlzcGxheTpibG9jazsKCWNsZWFyOmJvdGg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIHNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsKIAlib3JkZXI6c29saWQgMXB4IGdyYXk7IG91dGxpbmU6bm9uZTsKCWJveC1zaGFkb3c6bm9uZTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gaW5wdXRbdHlwZT10ZXh0XSB7CgliYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsgcGFkZGluZzoycHggMTBweDsKIAlib3JkZXI6c29saWQgMXB4IGdyYXk7IG91dGxpbmU6bm9uZTsKCWJvcmRlci1yYWRpdXM6M3B4IDNweDsKCWJveC1zaGFkb3c6bm9uZTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gaW5wdXRbdHlwZT1idXR0b25dIHsKCWJhY2tncm91bmQtY29sb3I6Ymx1ZTsgY29sb3I6d2hpdGU7IHBhZGRpbmc6NHB4IDEwcHg7Cglib3JkZXI6bm9uZTsgYm9yZGVyLXJhZGl1czozcHggM3B4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiB0YWJsZS5jb250ZW50IHsKIAlib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7CglkaXNwbGF5OmJsb2NrOwp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiB0YWJsZS5jb250ZW50IHRoZWFkIHsKCXotaW5kZXg6MTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gdGFibGUuY29udGVudCB0ciB7Cglib3JkZXI6c29saWQgMXB4IGxpZ2h0Z3JheTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gdGFibGUuY29udGVudCB0aCB7CgliYWNrZ3JvdW5kLWNvbG9yOiNmYmZiZmI7IGNvbG9yOnJnYmEoMCwwLDAsLjQ1KTsgZm9udC13ZWlnaHQ6MTAwOyBwYWRkaW5nOjEwcHg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIHRhYmxlLmNvbnRlbnQgdGQgewoJYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6ICM1YzVjNWM7IHBhZGRpbmc6MTBweDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gZGl2LnN0YXR1cyB7Cgljb2xvcjpibGFjazsKfQpkaXYuZm9vdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGhlaWdodDozMnB4OyBjbGVhcjpib3RoOwp9CgpkaXYudGFiczpob3ZlciB7CgliYWNrZ3JvdW5kLWNvbG9yOiMyNzI3Mjc7Cn0KZGl2LnRhYnMgZGl2Lm5hbWUgewoJaGVpZ2h0OjQ2cHg7IHdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7Cglwb3NpdGlvbjpzdGlja3k7IHRvcDo1cHg7Cgl6LWluZGV4OjE7Cn0KZGl2LnRhYnMgZGl2Lm5hbWUgZGl2Lml0ZW0gewoJY29sb3I6Z3JheTsgcGFkZGluZzoxMHB4OyBmbG9hdDpsZWZ0Owp9CmRpdi50YWJzIGRpdi5uYW1lIGRpdi5pdGVtLnNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGNvbG9yOndoaXRlOwogCWJvcmRlci1ib3R0b206c29saWQgcmVkIDJweDsKfQpkaXYudGFicyBkaXYucGFnZSB7CglvdmVyZmxvdzphdXRvOyBjbGVhcjpib3RoOwp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5pbnB1dCB7CglwYWRkaW5nOjVweDsgcG9zaXRpb246c3RpY2t5OyB0b3A6MHB4Owp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5pbnB1dCBpbnB1dCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMyMTIxMjE7IGNvbG9yOndoaXRlOyBib3JkZXI6MDsgb3V0bGluZTpub25lOyB3aWR0aDoyMzBweDsKfQpkaXYudGFicyBkaXYucGFnZT5kaXYuaXRlbSB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGNsZWFyOmJvdGg7IGRpc3BsYXk6bm9uZTsKfQpkaXYudGFicyBkaXYucGFnZT5kaXYubGlzdCB7CglwYWRkaW5nLWxlZnQ6MjBweDsgZGlzcGxheTpub25lOyBjbGVhcjpib3RoOwp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5saXN0LnNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMzMjMyMzI7IGRpc3BsYXk6YmxvY2s7Cn0KZGl2LmxlZnQgZGl2Lmxpc3QgewoJcGFkZGluZy1sZWZ0OjIwcHg7Cn0KCmRpdi50YWJzLmxlZnQgZGl2Lm5hbWUgewoJZmxvYXQ6bGVmdDsKfQpkaXYudGFicy5sZWZ0IGRpdi5uYW1lIGRpdi5pdGVtIHsKCWJvcmRlci1ib3R0b206bm9uZTsgZmxvYXQ6bm9uZTsKfQpkaXYudGFicy5sZWZ0IGRpdi5uYW1lIGRpdi5pdGVtLnNlbGVjdCB7Cglib3JkZXItcmlnaHQ6c29saWQgcmVkIDJweDsKfQpkaXYudGFicy5sZWZ0IGRpdi5wYWdlIHsKCXdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7CiAJY2xlYXI6bm9uZTsgZmxvYXQ6bGVmdDsKfQpkaXYudGFicy5sZWZ0IGRpdi5wYWdlPmRpdi5pdGVtIHsKCWRpc3BsYXk6YmxvY2s7Cn0KCmRpdi50YWJzLnZvaWQgZGl2Lm5hbWUgewoJZGlzcGxheTpub25lOwp9CmRpdi50YWJzLnZvaWQgZGl2LnBhZ2U+ZGl2Lml0ZW0gewoJZGlzcGxheTpibG9jazsKfQoKCmZpZWxkc2V0LkFjdGlvbiB7IGJhY2tncm91bmQtY29sb3I6cmdiYSgxMTQsIDE1MywgMTYyLCAwLjU0KTsgbWluLXdpZHRoOjE2MHB4OyB9CmZpZWxkc2V0LkFjdGlvbj5kaXYuYWN0aW9uIHsgYmFja2dyb3VuZC1jb2xvcjojMTU5Y2M3YjA7IHBhZGRpbmc6MDsgbWFyZ2luOjA7IGhlaWdodDoyOHB4OyBkaXNwbGF5Om5vbmU7IHBvc2l0aW9uOmFic29sdXRlOyB9CgpmaWVsZHNldC5BY3Rpb24udGFicz5kaXYuYWN0aW9uIHsgZGlzcGxheTpibG9jazsgfQpmaWVsZHNldC5BY3Rpb24udGFicz5kaXYub3V0cHV0IHsgbWFyZ2luLXRvcDoyOHB4OyB9CmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5vdXRwdXQ+ZmllbGRzZXQ+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luIHsgZGlzcGxheTpub25lOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luLnNlbGVjdCB7IGRpc3BsYXk6YmxvY2s7IH0KZmllbGRzZXQuQWN0aW9uLmdyaWQ+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4geyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkFjdGlvbi5ncmlkPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luPmRpdi5vdXRwdXQgeyBvdmVyZmxvdzphdXRvOyB9CmZpZWxkc2V0LkFjdGlvbi5mcmVlPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luIHsgcG9zaXRpb246YWJzb2x1dGU7IH0KZmllbGRzZXQuQWN0aW9uLmZyZWU+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4uc2VsZWN0IHsgZGlzcGxheTpibG9jazsgfQpmaWVsZHNldC5BY3Rpb24uZmxvdz5kaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbiB7IGZsb2F0OmxlZnQ7IH0KCmZpZWxkc2V0LkFjdGlvbiBkaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbi5GdWxsIHsgYmFja2dyb3VuZC1jb2xvcjojMDczOTQ3ZjI7IHBhZGRpbmc6MDsgbWFyZ2luOjA7IHBvc2l0aW9uOmZpeGVkOyBsZWZ0OjA7IHRvcDowOyBvdmVyZmxvdzphdXRvOyB6LWluZGV4OjEwOyB9CmZpZWxkc2V0LkFjdGlvbiBkaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbi5GdWxsPmxlZ2VuZCB7IGZsb2F0OmxlZnQ7IGRpc3BsYXk6Y29udGVudHM7IH0KZmllbGRzZXQuQWN0aW9uIGRpdi5vdXRwdXQgZmllbGRzZXQuc3RvcnkuRnVsbCB7IGJhY2tncm91bmQtY29sb3I6IzA3Mzk0N2YyOyBwYWRkaW5nOjA7IG1hcmdpbjowOyBwb3NpdGlvbjpmaXhlZDsgbGVmdDowOyB0b3A6MDsgb3ZlcmZsb3c6YXV0bzsgei1pbmRleDoxMDsgfQpmaWVsZHNldC5BY3Rpb24gZGl2Lm91dHB1dCBmaWVsZHNldC5zdG9yeS5GdWxsPmxlZ2VuZCB7IGhlaWdodDozMHB4OyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkFjdGlvbj5kaXYucHJvamVjdC50b2dnbGUgewoJYmFja2dyb3VuZC1jb2xvcjpjb3Juc2lsazsgb3BhY2l0eTowLjQ7IGNvbG9yOnRlYWw7IGZvbnQtc2l6ZTogMjhweDsgcGFkZGluZy10b3A6IDUwcHg7IGhlaWdodDogMTAwcHg7IHdpZHRoOjIwcHg7IHBvc2l0aW9uOiBmaXhlZDsgdG9wOiAzMCU7Cglib3JkZXItdG9wLXJpZ2h0LXJhZGl1czoyMHB4OyBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czoyMHB4Owp9CgpmaWVsZHNldC5wYW5lbC5jbWQ+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4geyBwYWRkaW5nOjA7IG1hcmdpbjowOyB9CmZpZWxkc2V0LnBhbmVsLmNtZD5kaXYub3V0cHV0PmZpZWxkc2V0LnBsdWdpbj5sZWdlbmQgeyBiYWNrZ3JvdW5kLWNvbG9yOmRhcmtjeWFuOyBwYWRkaW5nOjAgMTBweDsgbWFyZ2luLXJpZ2h0OjNweDsgaGVpZ2h0OjMwcHg7IGZsb2F0OmxlZnQ7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQucGFuZWwuY21kPmRpdi5vdXRwdXQ+ZmllbGRzZXQucGx1Z2luPmxlZ2VuZCB7IGhlaWdodDo0MnB4OyB9CgpkaXYub3V0cHV0LmZvcm0gZGl2Lml0ZW0gewoJbWFyZ2luOjEwcHggNDBweDsKfQpkaXYub3V0cHV0LmZvcm0gZGl2Lml0ZW0gZGl2LmxhYmVsIHsKCW1hcmdpbjo1cHggMHB4Owp9CgoKZmllbGRzZXQuU2VhcmNoIHsgYmFja2dyb3VuZDojMDQxYTI1YmQ7IHBhZGRpbmc6MTBweDsgcG9zaXRpb246Zml4ZWQ7IGxlZnQ6MHB4OyB0b3A6MjZweDsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LlNlYXJjaCBpbnB1dC53b3JkIHsgd2lkdGg6LXdlYmtpdC1maWxsLWF2YWlsYWJsZTsgfQpmaWVsZHNldC5TZWFyY2ggZGl2Lm91dHB1dCBkaXYuY29udGVudCB0YWJsZSB7IG1pbi13aWR0aDo0MDBweDsgfQpmaWVsZHNldC5TZWFyY2ggZGl2Lm91dHB1dCBkaXYuZGlzcGxheSB7IG1heC1oZWlnaHQ6MjAwcHg7IH0KZmllbGRzZXQuU2VhcmNoIGRpdi5vdXRwdXQgYSB7IGNvbG9yOnllbGxvdzsgfQoKZmllbGRzZXQuUml2ZXIgeyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgeyB3aWR0aDoxODBweDsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5pdGVtIHsgcGFkZGluZzozcHggMTZweDsgYm9yZGVyLWxlZnQ6c29saWQgM3B4ICMwMGZmYWU7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbS5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyZTUxNWY7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IHsgcGFkZGluZy1sZWZ0OjVweDsgbWFyZ2luLWxlZnQ6OHB4OyB9CmZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lmxpc3QgZGl2Lml0ZW0geyBiYWNrZ3JvdW5kLWNvbG9yOiMwNzM1NDBiNTsgYm9yZGVyLWxlZnQ6c29saWQgM3B4ICNjY2RjNGM7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYubGlzdCBkaXYuaXRlbS5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOnN0ZWVsYmx1ZTsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpzdGVlbGJsdWU7IH0KCmZpZWxkc2V0LkZvb3RlciB7IHBhZGRpbmc6MCA1cHg7IGhlaWdodDozMnB4OyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IHsgaGVpZ2h0OjMycHg7IG92ZXJmbG93OmhpZGRlbjsgfQpmaWVsZHNldC5Gb290ZXI+ZGl2Lm91dHB1dD5kaXYgeyBwYWRkaW5nOjVweDsgaGVpZ2h0OjIycHg7IGN1cnNvcjpwb2ludGVyOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0PmRpdjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgYm9yZGVyLXRvcDpzb2xpZCAycHggcmVkOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IGRpdi50aXRsZSB7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgZGl2LnN0YXRlIHsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgZGl2LnRvYXN0IHsgYmFja2dyb3VuZC1jb2xvcjpkYXJrY3lhbjsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgZGl2LmNtZCB7IHBhZGRpbmc6MHB4OyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IGlucHV0W25hbWU9Y21kXSB7IGhlaWdodDoyNXB4OyB3aWR0aDoxMjBweDsgYm9yZGVyLXJhZGl1czowOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IGlucHV0W25hbWU9Y21kXTpmb2N1cyB7IHdpZHRoOjMyMHB4OyB9CgpmaWVsZHNldC5zdG9yeS5pbm5lcj5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyPmZvcm0ub3B0aW9uIGlucHV0W25hbWU9cGF0aF0geyB3aWR0aDo4MHB4OyB9CmZpZWxkc2V0LmlubmVyPmZvcm0ub3B0aW9uIGlucHV0W25hbWU9ZmlsZV0geyB3aWR0aDoxNjBweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYuYWN0aW9uPmRpdi50YWJzIHsgYmFja2dyb3VuZC1jb2xvcjojNWM4MDljNWM7IGhlaWdodDoxOHB4OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5hY3Rpb24+ZGl2LnRhYnM6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMTNiNjc1YzsgfQpmaWVsZHNldC5pbm5lcj5kaXYuYWN0aW9uPmRpdi50YWJzLnNlbGVjdCB7IGJhY2tncm91bmQtY29sb3I6IzAxM2I2NzVjOyBib3JkZXItYm90dG9tOnNvbGlkIDJweCAjNzk5OWIyOyBmb250LXNpemU6MXJlbTsgaGVpZ2h0OjE5cHg7IH0KCmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgeyBjb2xvcjp3aGl0ZTsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgeyB3aWR0aDoxODBweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IGRpdi5raW5kIHsgYmFja2dyb3VuZC1jb2xvcjpjb3JuZmxvd2VyYmx1ZTsgY29sb3I6d2hpdGU7IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgZm9udC1zaXplOjEuMXJlbTsgdGV4dC1hbGlnbjpjZW50ZXI7IHBhZGRpbmc6NXB4OyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2plY3QgZGl2Lml0ZW0gZGl2Lm5hbWUgeyBwYWRkaW5nOjAgMTZweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHsgY29sb3I6d2hpdGU7IGZvbnQtc2l6ZToxLjFyZW07IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgcG9zaXRpb246cmVsYXRpdmU7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ci5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMDAwZmY2YjsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRyLnNlbGVjdCB0ZC5saW5lIHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyBib3JkZXI6c29saWQgMXB4IHJlZDsgYm9yZGVyLXJpZ2h0OnNvbGlkIDJweCByZWQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC5saW5lOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpncmVlbjsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLmxpbmUgeyBwb3NpdGlvbjpzdGlja3k7IGxlZnQ6MDsgdGV4dC1hbGlnbjpyaWdodDsgcGFkZGluZzowIDZweDsgYm9yZGVyLXJpZ2h0OnNvbGlkIDJweCByZWQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHsgdGV4dC1hbGlnbjpsZWZ0OyB3aGl0ZS1zcGFjZTpwcmU7IHBhZGRpbmctbGVmdDoxMHB4OyBjdXJzb3I6dGV4dDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5jb21tZW50IHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyBjb2xvcjpjeWFuOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmtleXdvcmQgeyBjb2xvcjp5ZWxsb3c7IGZvbnQtd2VpZ2h0OmJvbGQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uZGF0YXR5cGUgeyBjb2xvcjpsaWdodGdyZWVuOyBmb250LXdlaWdodDpib2xkOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmZ1bmN0aW9uIHsgY29sb3I6Y3lhbjsgZm9udC13ZWlnaHQ6Ym9sZDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5jb25zdGFudCB7IGNvbG9yOm1hZ2VudGE7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uc3RyaW5nIHsgY29sb3I6bWFnZW50YTsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IGxlZ2VuZCB7IG1hcmdpbi1yaWdodDo0cHg7IGhlaWdodDozMHB4OyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2ZpbGU+ZGl2Lm91dHB1dD5maWVsZHNldD5sZWdlbmQgeyBwYWRkaW5nOjAuMXJlbTsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5kaXNwbGF5IHsgYm9yZGVyOnNvbGlkIDFweCBncmVlbnllbGxvdzsgfQoKZmllbGRzZXQuaW5uZXIgZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0IHsgcG9zaXRpb246YWJzb2x1dGU7IGJvdHRvbTowcHg7IHJpZ2h0OjBweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGZpZWxkc2V0LnRvb2xraXQ+ZGl2Lm91dHB1dD5maWVsZHNldCB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGZpZWxkc2V0LnRvb2xraXQ+ZGl2Lm91dHB1dD5maWVsZHNldC5zZWxlY3QgeyBkaXNwbGF5OmJsb2NrOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZmllbGRzZXQudG9vbGtpdD5kaXYub3V0cHV0PmZpZWxkc2V0PmxlZ2VuZCB7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5zdGF0dXM+bGVnZW5kIHsgYmFja2dyb3VuZDojMGQ5NjlmOGE7IHBhZGRpbmc6NHB4IDRweDsgYm9yZGVyLWxlZnQ6c29saWQgMnB4IHJlZDsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5zdGF0dXM+bGVnZW5kLnNlbGVjdCB7IGJhY2tncm91bmQ6Z3JlZW47IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5zdGF0dXM+bGVnZW5kOmhvdmVyIHsgYmFja2dyb3VuZDpncmVlbjsgfQpmaWVsZHNldC5pbm5lcj5kaXYuc3RhdHVzIHsgaGVpZ2h0OjI2cHg7IH0KZmllbGRzZXQuaW5uZXI+ZGl2LnN0YXR1cyBsZWdlbmQgeyBiYWNrZ3JvdW5kOiMwZDk2OWY4YTsgZm9udC1zaXplOjEuMXJlbTsgcGFkZGluZzowcHggMTBweDsgYm9yZGVyLWxlZnQ6c29saWQgMnB4IHJlZDsgY3Vyc29yOnBvaW50ZXI7IGZsb2F0OnJpZ2h0OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5zdGF0dXMgbGVnZW5kLnNlbGVjdCB7IGJhY2tncm91bmQ6Z3JlZW47IH0KZmllbGRzZXQuaW5uZXI+ZGl2LnN0YXR1cyBsZWdlbmQ6aG92ZXIgeyBiYWNrZ3JvdW5kOmdyZWVuOyB9CgpmaWVsZHNldC5pbm5lci5mbG9hdCBsZWdlbmQgeyBoZWlnaHQ6MzBweDsgfQpmaWVsZHNldC5pbm5lci5mbG9hdCBkaXYub3V0cHV0IHsgYmFja2dyb3VuZC1jb2xvcjojMzMyZjFlY2Y7IH0KZmllbGRzZXQuaW5uZXIuZmxvYXQgZGl2LnN0YXR1cyB7IGNvbG9yOndoaXRlOyB9CgpmaWVsZHNldC5pbm5lci5mdWxsPmxlZ2VuZCB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lci5mdWxsPmZvcm0ub3B0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyLmZ1bGw+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lci5mdWxsPmRpdi5zdGF0dXMgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5kaXYub3V0cHV0IGRpdi5wcm9maWxlPmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5kaXYub3V0cHV0IGRpdi5kaXNwbGF5PmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5kaXYub3V0cHV0IGRpdi5kaXNwbGF5PmRpdi5zdGF0dXMgeyBkaXNwbGF5Om5vbmU7IH0KCmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYucHJvamVjdCB7IGNvbG9yOiNhMmRhZDI7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHsgYmFja2dyb3VuZC1jb2xvcjojMDEzYjY3NWM7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5zdHJpbmcgeyBjb2xvcjojYTcwM2E3OyB9Cgpib2R5Lm1vYmlsZSBmaWVsZHNldC5pbm5lci5mbG9hdCBsZWdlbmQgeyBoZWlnaHQ6NDJweDsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5pbm5lcj5mb3JtLm9wdGlvbiBpbnB1dFtuYW1lPWZpbGVdIHsgd2lkdGg6OTBweDsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5wbHVnaW4uaW5uZXIgZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQucGx1Z2luLmlubmVyIGRpdi5hY3Rpb24geyBkaXNwbGF5OmNvbnRlbnRzOyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZSBmaWVsZHNldC5wbHVnaW4uaW5uZXIgZm9ybS5vcHRpb24gaW5wdXRbdHlwZT1idXR0b25dIHsgZGlzcGxheTpub25lOyB9CgoudW5zZWxlY3RhYmxlIHsKCS13ZWJraXQtdG91Y2gtY2FsbG91dDpub25lOwoJLXdlYmtpdC11c2VyLXNlbGVjdDpub25lOwoJLWtodG1sLXVzZXItc2VsZWN0Om5vbmU7CgktbW96LXVzZXItc2VsZWN0Om5vbmU7CgktbXMtdXNlci1zZWxlY3Q6bm9uZTsKCS1vLXVzZXItc2VsZWN0Om5vbmU7Cgl1c2VyLXNlbGVjdDpub25lOwp9CgpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi5wYXRoIHsgZGlzcGxheTpub25lOyB9Cgpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgeyBiYWNrZ3JvdW5kOiM1NDZFN0E7IHBhZGRpbmc6MHB4OyBoZWlnaHQ6MzhweDsgb3ZlcmZsb3c6YXV0bzsgZGlzcGxheTpibG9jazsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgZGl2LnRhYnMgeyBiYWNrZ3JvdW5kOiM2OTgxOGQ7IGNvbG9yOndoaXRlOyBmb250LXNpemU6MXJlbTsgcGFkZGluZzoxMHB4OyBmbG9hdDpsZWZ0OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYudGFicyBkaXYudGFicy5zZWxlY3QgeyBiYWNrZ3JvdW5kOiM0NTVBNjQ7IGJveC1zaGFkb3c6MHB4IDBweCA1cHggMXB4IGdyZXk7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi5wYXRoIHsKCWJhY2tncm91bmQ6IzQ1NUE2NDsgY29sb3I6d2hpdGU7IHBhZGRpbmc6NHB4IDEwcHg7CgltYXJnaW4tYm90dG9tOjRweDsgYm94LXNoYWRvdzowcHggMHB4IDVweCAxcHggIzkwQTRBRTsKCWNsZWFyOmJvdGg7IGRpc3BsYXk6YmxvY2s7Cn0KCmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi50YWJzIHsgYmFja2dyb3VuZDojZjNmM2YzOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi50YWJzIGRpdi50YWJzIHsgYmFja2dyb3VuZDojZWNlY2VjOyBjb2xvcjpibGFjazsgZm9udC1zaXplOjFyZW07IHBhZGRpbmc6MTBweDsgZmxvYXQ6bGVmdDsgfQpib2R5LndoaXRlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYudGFicyBkaXYudGFicy5zZWxlY3QgeyBiYWNrZ3JvdW5kOiB3aGl0ZTsgYm94LXNoYWRvdzowcHggMHB4IDVweCAxcHggZ3JleTsgfQpib2R5LndoaXRlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYucGF0aCB7IGJhY2tncm91bmQ6d2hpdGU7IGNvbG9yOmJsYWNrOyBmb250LWZhbWlseTptb25vc3BhY2U7IGJveC1zaGFkb3c6MHB4IDBweCA1cHggMXB4IGdyZXk7IH0KCmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQucHJvamVjdCBkaXYucHJvamVjdCB7IHdpZHRoOjI0MHB4OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQucHJvamVjdCBkaXYucHJvamVjdCBkaXYua2luZCB7IHBhZGRpbmc6MTBweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2LmtpbmQgeyBjb2xvcjogd2hpdGU7IGZvbnQtc2l6ZTogMS4ycmVtOyBmb250LWZhbWlseTogbW9ub3NwYWNlOyBoZWlnaHQ6MThweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2LmtpbmQ6Zmlyc3QtY2hpbGQgeyBwb3NpdGlvbjpzdGlja3k7IHRvcDowIH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB7IGJhY2tncm91bmQtY29sb3I6IzI2MzIzOGMyOyBmb250LXNpemU6MTZweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi50b2dnbGUgeyBkaXNwbGF5Om5vbmU7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYudG9nZ2xlLnByb2ZpbGUgeyBiYWNrZ3JvdW5kLWNvbG9yOiM2NjRmNGY0NTsgZGlzcGxheTpibG9jazsgfQoKYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYucHJvamVjdCBkaXYuYWN0aW9uIGRpdi5pdGVtIHsgZmxvYXQ6bGVmdDsgd2lkdGg6YXV0bzsgcGFkZGluZzp1bnNldDsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IHsgYmFja2dyb3VuZDpsaWdodHllbGxvdzsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IGRpdi5pdGVtIHsgY29sb3I6YmxhY2s7IGZvbnQtc2l6ZToxNnB4OyB3aWR0aDotd2Via2l0LWZpbGwtYXZhaWxhYmxlOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2plY3QgZGl2Lml0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kOiNlM2U2ZjE7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGZvbnQtc2l6ZToxNnB4OyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdHIuc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRyLnNlbGVjdCB0ZC5saW5lIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IGJvcmRlcjpub25lOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdHIuc2VsZWN0IHRkLnRleHQgeyBib3JkZXI6c29saWQgMXB4ICNlN2U3ZTc7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC5saW5lIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6IzIzNzg5MzsgcGFkZGluZy10b3A6NHB4OyBib3JkZXItcmlnaHQ6bm9uZTsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgeyBjb2xvcjpibGFjazsgcGFkZGluZy10b3A6MnB4OyBib3JkZXI6c29saWQgMXB4IHdoaXRlOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLnN0cmluZyB7IGNvbG9yOiNhMzE1MTU7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uZnVuY3Rpb24geyBjb2xvcjojNzk1ZTI2OyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmtleXdvcmQgeyBjb2xvcjpibHVlOyB9CmJvZHkud2hpdGUuc2ltcGxlIHRkLmNvbnRlbnQ+ZGl2LmNvbnRlbnQgeyBiYWNrZ3JvdW5kOiB3aGl0ZTsgYm94LXNoYWRvdzowcHggMHB4IDVweCAxcHggZ3JleTsgfQpib2R5LndoaXRlLnNpbXBsZSBkaXYuc3RhdHVzIHsgY29sb3I6YmxhY2s7IH0KCmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3BhbiB7IGNvbG9yOmJsYWNrOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5rZXkgeyBjb2xvcjpibHVlOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5zdHJpbmcgeyBjb2xvcjptYWdlbnRhOyB9Cgpib2R5Lm1vYmlsZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYudG9nZ2xlIHsgZGlzcGxheTpibG9jazsgfQpib2R5Lm1vYmlsZS5zaW1wbGUgaW5wdXRbdHlwZT1idXR0b25dIHsgaGVpZ2h0OjQ1cHg7IH0KYm9keS5tb2JpbGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgbGVnZW5kIHsgaGVpZ2h0OjQ1cHg7IH0KYm9keS5tb2JpbGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnRvZ2dsZSB7IGJhY2tncm91bmQtY29sb3I6bGlnaHRibHVlOyB3aWR0aDozMHB4OyB9CmJvZHkubW9iaWxlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi50b2dnbGUuZGlzcGxheSB7IGJhY2tncm91bmQtY29sb3I6bGlnaHRibHVlOyBtYXJnaW4tdG9wOi0zM3B4OyBoZWlnaHQ6MzBweDsgd2lkdGg6MTAwcHg7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuQWN0aW9uIGRpdi5vdXRwdXQgZmllbGRzZXQuRnVsbD5sZWdlbmQgeyBmbG9hdDpub25lOyB9Cgpib2R5Lm1vYmlsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IGxlZ2VuZCB7IGhlaWdodDo0NXB4OyB9CgpmaWVsZHNldC53b3JkIGZvcm0ub3B0aW9uIGlucHV0W25hbWU9cGF0aF0geyB3aWR0aDoxMjdweDsgfQoKZmllbGRzZXQud29yZD5kaXYubmF2bWVudSB7IGJhY2tncm91bmQtY29sb3I6aW5oZXJpdDsgb3ZlcmZsb3c6YXV0bzsgbWFyZ2luLXJpZ2h0OjEwcHg7IG1pbi13aWR0aDoxMjBweDsgY2xlYXI6Ym90aDsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC53b3JkPmRpdi5uYXZtZW51IGRpdi5saXN0IHsgbWFyZ2luLWxlZnQ6MjBweDsgfQpmaWVsZHNldC53b3JkPmRpdi5uYXZtZW51IGRpdi5pdGVtIHsgZm9udC1zaXplOjEuNmVtOyBmb250LXdlaWdodDpib2xkOyBmb250LWZhbWlseTpjdXJzaXZlOyBwYWRkaW5nOjRweCAxMHB4OyB9CmZpZWxkc2V0LndvcmQ+ZGl2Lm5hdm1lbnU+ZGl2Lml0ZW0geyBmb250LXNpemU6MmVtOyB9CgpmaWVsZHNldC53b3JkIGEgeyB3b3JkLWJyZWFrOmJyZWFrLXdvcmQ7IH0KZmllbGRzZXQud29yZCBici5zdG9yeSB7IGNsZWFyOmJvdGg7IH0KZmllbGRzZXQud29yZCB1bC5zdG9yeSB7IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgfQpmaWVsZHNldC53b3JkIHVsLnN0b3J5IGxpLkgyIHsgZm9udC1zaXplOjEuNGVtOyBmb250LXdlaWdodDpib2xkOyB9CmZpZWxkc2V0LndvcmQgdWwuc3RvcnkgbGkuSDMgeyBmb250LXNpemU6MS4yZW07IH0KZmllbGRzZXQud29yZCB1bC5zdG9yeVtkYXRhLXR5cGU9cHJlbWVudV0geyBjdXJzb3I6cG9pbnRlcjsgfQpmaWVsZHNldC53b3JkIHVsLnN0b3J5W2RhdGEtdHlwZT1wcmVtZW51XSBsaTpob3ZlciB7IGJhY2tncm91bmQ6Y3lhbjsgY29sb3I6Ymx1ZTsgfQpmaWVsZHNldC53b3JkIHVsLnN0b3J5W2RhdGEtdHlwZT1lbmRtZW51XSB7IGNsZWFyOmJvdGg7IH0KZmllbGRzZXQud29yZCBwLnN0b3J5W2RhdGEtbmFtZT1pbm5lcl0geyBiYWNrZ3JvdW5kLWNvbG9yOiM0YjZjOGE3YTsgcGFkZGluZzo0cHggMTBweDsgYm9yZGVyLWxlZnQ6c29saWQgNHB4IGJsdWU7IG1hcmdpbjoxMHB4IDBweDsgfQpmaWVsZHNldC53b3JkIHAuc3RvcnlbZGF0YS1uYW1lPWlubmVyXTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6I2MxMGM4YTsgY3Vyc29yOmNvcHk7IH0KZmllbGRzZXQud29yZCBzdmcuc3RvcnkgeyBkaXNwbGF5OmJsb2NrOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LndvcmQgc3ZnLnN0b3J5IHsgZm9udC1mYW1pbHk6ZmFuZ3Nvbmc7IH0KZmllbGRzZXQud29yZCB2aWRlby5zdG9yeSB7IG1heC1oZWlnaHQ6MzIwcHg7IH0KZmllbGRzZXQud29yZCBmaWVsZHNldC5zdG9yeSB7IG1hcmdpbjoxMHB4OyB9CgpmaWVsZHNldC53b3JkLmZsb2F0IHsgcGFkZGluZzowOyBtYXJnaW46MDsgd2lkdGg6LXdlYmtpdC1maWxsLWF2YWlsYWJsZTsgcG9zaXRpb246Zml4ZWQ7IGxlZnQ6MDsgdG9wOjA7IHotaW5kZXg6MTA7IH0KZmllbGRzZXQud29yZC5mbG9hdD5kaXYuYWN0aW9uIHsgZGlzcGxheTpjb250ZW50czsgfQpmaWVsZHNldC53b3JkLmZsb2F0PmRpdi5zdGF0dXMgeyBjbGVhcjpub25lOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQ+ZGl2Lm91dHB1dCB7IGJhY2tncm91bmQtY29sb3I6I2YwZjhmZjgwOyBwYWRkaW5nOjIwcHg7IG92ZXJmbG93OmF1dG87IH0KZmllbGRzZXQud29yZC5mbG9hdD5kaXYub3V0cHV0PmRpdi5wcm9qZWN0IHsgYmFja2dyb3VuZDpjb3Juc2lsazsgcGFkZGluZzoxMHB4OyBwb3NpdGlvbjpmaXhlZDsgcmlnaHQ6MDsgdG9wOjI1cHg7IHotaW5kZXg6MTAwOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQgZGl2LmNvbnRlbnQgZGl2LnBhZ2UgeyBtYXJnaW4tdG9wOjMwcHg7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC53b3JkLmZsb2F0IGRpdi5jb250ZW50IGRpdi5wYWdlLnNob3cgeyBkaXNwbGF5OmJsb2NrOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQgZGl2LmNvbnRlbnQuZ3JpZCBkaXYucGFnZSB7IGJhY2tncm91bmQtY29sb3I6I2E0Y2JlY2I1OyBtYXJnaW46MTBweDsgaGVpZ2h0OjIwMHB4OyB3aWR0aDoyMDBweDsgb3ZlcmZsb3c6YXV0bzsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC53b3JkLmZsb2F0IGgxIHsgdGV4dC1hbGlnbjpjZW50ZXI7IH0KZmllbGRzZXQud29yZC5mbG9hdCBoMiB7IHRleHQtYWxpZ246Y2VudGVyOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQgaDMgeyB0ZXh0LWFsaWduOmNlbnRlcjsgfQoKZmllbGRzZXQucGFuZWwuY21kIGZpZWxkc2V0LndvcmQ+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZCBmaWVsZHNldC53b3JkPmZvcm0ub3B0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZCBmaWVsZHNldC53b3JkPmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQucGFuZWwuY21kIGZpZWxkc2V0LndvcmQ+ZGl2LnN0YXR1cyB7IGRpc3BsYXk6bm9uZTsgfQoKZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya11bZGF0YS1uYW1lPXNoZWxsXSBsYWJlbCB7CgktbW96LXVzZXItc2VsZWN0Om5vbmU7IC8q54Gr54uQKi8KCS13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsgLyp3ZWJraXTmtY/op4jlmagqLwoJLW1zLXVzZXItc2VsZWN0Om5vbmU7IC8qSUUxMCovCgkta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTsgLyrml6nmnJ/mtY/op4jlmagqLwoJdXNlci1zZWxlY3Q6bm9uZTsKfQoKCmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgaW5wdXQuY3VycmVudCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMwMDAwMDAwMDsgY29sb3I6IzAwMDAwMDAwOyBmb250LXNpemU6MWVtOyBmb250LWZhbWlseTptb25vc3BhY2U7CglwYWRkaW5nOjA7IHBhZGRpbmctbGVmdDoxMXB4OyBib3JkZXI6bm9uZTsgb3V0bGluZTpub25lOyBtYXJnaW46MDsgbWFyZ2luLXRvcDotMXB4OwogCWhlaWdodDoyMnB4OyBwb3NpdGlvbjphYnNvbHV0ZTsKfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQubm9ybWFsIHsgY2FyZXQtY29sb3I6Z3JheTsgfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQuaW5zZXJ0IHsgY2FyZXQtY29sb3I6eWVsbG93OyB9CgpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB7CgloZWlnaHQ6MjBweDsgcG9zaXRpb246YWJzb2x1dGU7IGxlZnQ6MzJweDsgbWFyZ2luLXRvcDoyMHB4OwoJZGlzcGxheTpub25lOwp9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlLmluc2VydCB7CglkaXNwbGF5OmJsb2NrOwp9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlIGRpdi5wcmUgewoJZm9udC1zaXplOjEuMXJlbTsgY29sb3I6I2YwZjhmZjAwOyBtYXJnaW4tbGVmdDo1cHg7IGZsb2F0OmxlZnQ7Cn0KZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBkaXYuY29tcGxldGUgdGFibGUgewoJYmFja2dyb3VuZDpsaWdodGJsdWU7IG1heC1oZWlnaHQ6NDAwcHg7IG1heC13aWR0aDo4MDBweDsgb3ZlcmZsb3c6YXV0bzsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsKfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB0YWJsZS5jb250ZW50IHRoIHsKCWRpc3BsYXk6bm9uZTsKfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB0YWJsZS5jb250ZW50IHRkIHsKCWZvbnQtc2l6ZToxLjFyZW07Cn0KCmJvZHkuc2ltcGxlIGZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlIGRpdi5wcmUgewoJZm9udC1zaXplOjFyZW07Cn0KYm9keS5zaW1wbGUgZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBkaXYuY29tcGxldGUgdGFibGUuY29udGVudCB0ZCB7Cglmb250LXNpemU6MXJlbTsKfQoKYm9keS53aGl0ZSBmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQuaW5zZXJ0IHsgY2FyZXQtY29sb3I6YmxhY2s7IH0KYm9keS53aGl0ZSBmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQubm9ybWFsIHsgY2FyZXQtY29sb3I6bGlnaHRncmF5OyB9CgpmaWVsZHNldC5wbGFuPmRpdi5vdXRwdXQgdGQgeyB2ZXJ0aWNhbC1hbGlnbjp0b3A7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IHRkLm92ZXIgeyBib3JkZXI6c29saWQgMnB4IHJlZDsgfQpmaWVsZHNldC5wbGFuPmRpdi5vdXRwdXQgdGQgZGl2LmRhdGUgeyBjb2xvcjpncmF5OyB9CmZpZWxkc2V0LnBsYW4+ZGl2Lm91dHB1dCBkaXYucHJlcGFyZSB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgY29sb3I6d2hpdGU7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IGRpdi5wcm9jZXNzIHsgYmFja2dyb3VuZC1jb2xvcjpncmVlbjsgY29sb3I6d2hpdGU7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IGRpdi5jYW5jZWwgeyBiYWNrZ3JvdW5kLWNvbG9yOnllbGxvdzsgY29sb3I6d2hpdGU7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IGRpdi5maW5pc2ggeyBiYWNrZ3JvdW5kLWNvbG9yOnJlZDsgY29sb3I6d2hpdGU7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQucGxhbj5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CgpkaXYub3V0cHV0LmZvcm0gZGl2Lml0ZW0gewoJcGFkZGluZzo0MHB4Owp9CgpmaWVsZHNldC5kcmF3LnNwaWRlIGRpdi5vdXRwdXQgZGl2LnRvZ2dsZSB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5kcmF3LnNwaWRlIGRpdi5vdXRwdXQgZGl2LnRvZ2dsZS5wcm9qZWN0IHsgZGlzcGxheTpibG9jazsgfQoKZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzAwMDA7IH0KZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbSBkaXYuaXRlbSB7IHBhZGRpbmctbGVmdDoxNXB4OyBib3JkZXI6c29saWQgMXB4ICMwMDAwMDAwZDsgYm9yZGVyLWxlZnQ6ZGFzaGVkIDFweCBsaWdodGJsdWU7IG1hcmdpbi1sZWZ0OjVweDsgfQpmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIGRpdi5pdGVtOmhvdmVyIHsgYm9yZGVyOnNvbGlkIDFweCByZWQ7IH0KZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbSBzcGFuLm5vbmNlIHsgY29sb3I6IzljYmVjYTRmOyBjdXJzb3I6cG9pbnRlcjsgfQpmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIHNwYW4ua2V5IHsgY29sb3I6eWVsbG93OyB9CmZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5zdHJpbmcgeyBjb2xvcjptYWdlbnRhOyB9CmZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5jb25zdCB7IGNvbG9yOmN5YW47IH0KCgpmaWVsZHNldC5kaXYgZGl2Lm91dHB1dCB0ZCB7IHZlcnRpY2FsLWFsaWduOnRvcDsgfQpmaWVsZHNldC5kaXYgZGl2Lm91dHB1dCBmaWVsZHNldC5zcGFuPmZpZWxkc2V0IHsgb3ZlcmZsb3c6YXV0bzsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5wYW5lbC5jbWQubWFpbiBmaWVsZHNldC5kaXY+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZC5tYWluIGZpZWxkc2V0LmRpdj5mb3JtLm9wdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5wYW5lbC5jbWQubWFpbiBmaWVsZHNldC5kaXY+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5wYW5lbC5jbWQubWFpbiBmaWVsZHNldC5kaXYgZGl2LnByb2plY3QgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQucGFuZWwuY21kLm1haW4gZmllbGRzZXQuZGl2IGRpdi5wcm9maWxlIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LndvcmQ+ZGl2Lm91dHB1dCBmaWVsZHNldC5zcGFuPmZpZWxkc2V0IHsgb3ZlcmZsb3c6YXV0bzsgZmxvYXQ6bGVmdDsgfQoKZmllbGRzZXQuZHJhdyBkaXYub3V0cHV0IHsgYmFja2dyb3VuZC1jb2xvcjojMWI1YjczOGM7IGZvbnQtc2l6ZToyMHB4OyB9CmZpZWxkc2V0LmRyYXcgZGl2Lm91dHB1dCBkaXYuY29udGVudCBzdmcgeyBiYWNrZ3JvdW5kLWNvbG9yOiMxYjViNzM4YzsgfQpmaWVsZHNldC5kcmF3IGRpdi5vdXRwdXQgZGl2LmRpc3BsYXkgeyBtYXgtaGVpZ2h0OjQwMHB4OyB9CgpmaWVsZHNldC5mZWVsIGRpdi5vdXRwdXQgaW1nIHsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5mZWVsIGRpdi5vdXRwdXQgdmlkZW8geyBkaXNwbGF5OmJsb2NrOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LmZlZWwuZmxvYXQgeyBiYWNrZ3JvdW5kLWNvbG9yOiM0ZWFhZDBjMjsgcG9zaXRpb246YWJzb2x1dGU7IH0KZmllbGRzZXQuZmVlbC5mbG9hdD5sZWdlbmQgeyBkaXNwbGF5Om5vbmU7IH0KCmZpZWxkc2V0LmlucHV0LmRhdGUgZGl2LmFjdGlvbiB7IGhlaWdodDo0cmVtOyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgZGl2LmFjdGlvbiBkaXYuc3BhY2UgeyB3aWR0aDowOyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgZGl2Lm91dHB1dCB0ZC5wcmV2IHsgY29sb3I6Z3JheTsgfQpmaWVsZHNldC5pbnB1dC5kYXRlIGRpdi5vdXRwdXQgdGQubmV4dCB7IGNvbG9yOmdyYXk7IH0KZmllbGRzZXQuaW5wdXQuZGF0ZSBkaXYub3V0cHV0IHRkIHsgcGFkZGluZzoycHggMTFweDsgfQpmaWVsZHNldC5pbnB1dC5kYXRlIHRhYmxlIHsgdGV4dC1hbGlnbjpjZW50ZXI7IHdpZHRoOjI4MHB4OyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgdGFibGUgdGQuc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgdGFibGUgdGQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbnB1dC5kYXRlIHRhYmxlIHsgY29sb3I6d2hpdGU7IH0KCgpmaWVsZHNldC5kcmF3LnRyZW5kIGRpdi5vdXRwdXQgZGl2LnRvZ2dsZSB7IGRpc3BsYXk6bm9uZTsgfQoKCg==",
        "/page/cache.js": "Vm9sY2Fub3MubWV0YS5jYWNoZVsiL3BhbmVsL2hlYWRlci5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wYW5lbC9hY3Rpb24uY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGFuZWwvc2VhcmNoLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BhbmVsL3JpdmVyLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BhbmVsL2Zvb3Rlci5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wbHVnaW4vbG9jYWwvd2lraS93b3JkLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC9jb2RlL3ZpbWVyLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC90ZWFtL3BsYW4uY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL3N0b3J5L2Zvcm0uY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL3N0b3J5L3NwaWRlLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9zdG9yeS9qc29uLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC9jaGF0L2Rpdi5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC93aWtpL2ZlZWwuY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL2lucHV0L2RhdGUuY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL3N0b3J5L3RyZW5kLmNzcyJdID0gW10KCl9jYW5fbmFtZSA9ICIvbGliL3VzZXIuanMiClZvbGNhbm9zKCJ1c2VyIiwge2hlbHA6ICLnlKjmiLfmk43kvZwiLCBpbmZvOiB7fSwgYWdlbnQ6IHsKCQlzY2FuUVJDb2RlOiBmdW5jdGlvbihjYiwgY2FuKSB7CgkJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7dHlwZTogaHRtbC5URVhUQVJFQSwgbmFtZTogInRleHQiLCB0ZXh0OiAiIn1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQljYihsaXN0WzBdLCBjYW4uYmFzZS5QYXJzZUpTT04obGlzdFswXSkpCgkJCX0pCgkJfSwKCQlnZXRMb2NhdGlvbjogZnVuY3Rpb24oY2IpIHsKCQkJbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbihyZXMpIHsKCQkJCWNiKHtsYXRpdHVkZTogcGFyc2VJbnQocmVzLmNvb3Jkcy5sYXRpdHVkZSoxMDAwMDApLCBsb25naXR1ZGU6IHBhcnNlSW50KHJlcy5jb29yZHMubG9uZ2l0dWRlKjEwMDAwMCl9KQoJCQl9LCBmdW5jdGlvbihzb21lKSB7CgkJCQl0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTiAmJiBjYih7bmFtZTogInNvbWUifSkKCQkJfSApOwoJCX0sCgkJb3BlbkxvY2F0aW9uOiBmdW5jdGlvbihtc2cpIHsKCQkJd2luZG93Lm9wZW4oImh0dHBzOi8vbWFwLmJhaWR1LmNvbS9zZWFyY2gvIitlbmNvZGVVUklDb21wb25lbnQobXNnLk9wdGlvbihtZGIuVEVYVCkpCgkJCQkrIi9AMTI5NTg3NTAuMDg1LDQ4MjU3ODUuNTUsMTZ6P3F1ZXJ5dHlwZT1zJmRhX3NyYz1zaGFyZXVybCZ3ZD0iK2VuY29kZVVSSUNvbXBvbmVudChtc2cuT3B0aW9uKG1kYi5URVhUKSkpCgkJfSwKCQljaG9vc2VJbWFnZTogZnVuY3Rpb24oY2IpIHsKCQkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IoW10pCgkJfSwKCX0sCglpc1dlaVhpbjogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNaWNyb01lc3NlbmdlciIpID4gLTEsCglpc0lQaG9uZTogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJpUGhvbmUiKSA+IC0xLAoJaXNNb2JpbGU6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTW9iaWxlIikgPiAtMSwKCWlzTWFjT1NYOiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk1hYyBPUyBYIikgPiAtMSwKCWlzV2luZG93czogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJXaW5kb3dzIikgPiAtMSwKCWlzSUU6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTVNJRSIpID4gLTEsCglpc0V4dGVuc2lvbjogbG9jYXRpb24gJiYgbG9jYXRpb24ucHJvdG9jb2wgJiYgbG9jYXRpb24ucHJvdG9jb2wgPT0gImNocm9tZS1leHRlbnNpb246IiwKCWlzTG9jYWxGaWxlOiBsb2NhdGlvbiAmJiBsb2NhdGlvbi5wcm90b2NvbCAmJiBsb2NhdGlvbi5wcm90b2NvbCA9PSAiZmlsZToiLAoJaXNMYW5kc2NhcGU6IGZ1bmN0aW9uKCkgeyByZXR1cm4gd2luZG93LmlubmVyV2lkdGggPiB3aW5kb3cuaW5uZXJIZWlnaHQgfSwKCWlzUG9ydHJhaXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gd2luZG93LmlubmVyV2lkdGggPCB3aW5kb3cuaW5uZXJIZWlnaHQgfSwKCW1vZDogewoJCWlzUG9kOiBsb2NhdGlvbiAmJiBsb2NhdGlvbi5wYXRobmFtZSAmJiAobG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZigiL2NoYXQvcG9kLyIpID09IDAgfHwgbG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZigiL3gvIikgPT0gMCksCgkJaXNEaXY6IGxvY2F0aW9uICYmIGxvY2F0aW9uLnBhdGhuYW1lICYmIChsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC9kaXYvIikgPT0gMCksCgkJaXNDbWQ6IGxvY2F0aW9uICYmIGxvY2F0aW9uLnBhdGhuYW1lICYmIChsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC9wb2QvIikgPT0gMCAmJiBsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY21kLyIpID4gMCB8fAoJCQlsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC9jbWQvIikgPT0gMCB8fCBsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvaGVscC8iKSA9PSAwKSwKCQlpc1dlYjogbG9jYXRpb24gJiYgbG9jYXRpb24ucGF0aG5hbWUgJiYgKGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9jaGF0L3BvZC8iKSA9PSAwICYmIGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi93ZWJzaXRlLyIpID4gMCB8fAoJCQlsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC93ZWJzaXRlLyIpID09IDApLAoJfSwKCglhbGVydDogZnVuY3Rpb24odGV4dCkgeyBhbGVydChKU09OLnN0cmluZ2lmeSh0ZXh0KSkgfSwKCWNvbmZpcm06IGZ1bmN0aW9uKHRleHQpIHsgcmV0dXJuIGNvbmZpcm0oSlNPTi5zdHJpbmdpZnkodGV4dCkpIH0sCglwcm9tcHQ6IGZ1bmN0aW9uKHRpcCwgZGVmLCBjYiwgc2lsZW50KSB7ICh0ZXh0ID0gc2lsZW50PyBkZWY6IHByb21wdCh0aXAsIGRlZnx8IiIpKSAhPSB1bmRlZmluZWQgJiYgdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IodGV4dCk7IHJldHVybiB0ZXh0IH0sCglyZWxvYWQ6IGZ1bmN0aW9uKGZvcmNlKSB7IChmb3JjZSB8fCBjb25maXJtKCLph43mlrDliqDovb3pobXpnaLvvJ8iKSkgJiYgbG9jYXRpb24ucmVsb2FkKCkgfSwKCWp1bXBzOiBmdW5jdGlvbih1cmwpIHsgbG9jYXRpb24uaHJlZiA9IHVybCB9LAoJb3BlbjogZnVuY3Rpb24odXJsKSB7IHdpbmRvdy5vcGVuKHVybCkgfSwKCXRpbWU6IGZ1bmN0aW9uKGNhbiwgdGltZSwgZm10KSB7IHZhciBub3cgPSBjYW4uYmFzZS5EYXRlKHRpbWUpCgkJdmFyIGxpc3QgPSBjYW4udXNlci5sYW5ndWFnZShjYW4pID09ICJlbiI/IFsiU3VuIiwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0Il06IFsi5ZGo5pelIiwgIuWRqOS4gCIsICLlkajkuowiLCAi5ZGo5LiJIiwgIuWRqOWbmyIsICLlkajkupQiLCAi5ZGo5YWtIl0KCQlyZXR1cm4gY2FuLmJhc2UuVGltZSh0aW1lLCAoZm10fHwiJXktJW0tJWQgJUg6JU06JVMiKS5yZXBsYWNlKCIldyIsIGxpc3Rbbm93LmdldERheSgpXSkpCgl9LAoKCXRpdGxlOiBmdW5jdGlvbih0ZXh0KSB7CgkJaWYgKHdpbmRvdy53ZWJ2aWV3KSB7IHJldHVybiB0aXRsZSh0ZXh0KSB9CgkJcmV0dXJuIHRleHQgJiYgKGRvY3VtZW50LnRpdGxlID0gVm9sY2Fub3MubWV0YS5hcmdzLm5hbWV8fHRleHQpLCBkb2N1bWVudC50aXRsZQoJfSwKCXRvcGljOiBmdW5jdGlvbihjYW4sIG5hbWUpIHsKCQljYW4udXNlci5tb2QuaXNDbWQgJiYgKG5hbWUgKz0gIiBzaW1wbGUiKQoJCWNhbi5Db25mKCJkaXNwbGF5IikgJiYgKG5hbWUgKz0gIiAiK2Nhbi5Db25mKCJkaXNwbGF5IikpCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgKG5hbWUgKz0gIiBtb2JpbGUiKSAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIChuYW1lICs9ICIgbGFuZHNjYXBlIikKCQljYW4udXNlci5sYW5ndWFnZShjYW4pICYmIChuYW1lICs9ICIgIitjYW4udXNlci5sYW5ndWFnZShjYW4pKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGRvY3VtZW50LmJvZHksIHtjbGFzc05hbWU6IG5hbWV9KQoJfSwKCWxhbmd1YWdlOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5taXNjLlNlYXJjaChjYW4sICJsYW5ndWFnZSIpIH0sCgl0cmFuczogZnVuY3Rpb24oY2FuLCB0ZXh0LCBsaXN0KSB7IGlmIChjYW4uYmFzZS5pc09iamVjdCh0ZXh0KSkgewoJCQlyZXR1cm4gY2FuLmNvcmUuSXRlbSh0ZXh0LCBmdW5jdGlvbihrLCB2KSB7IGNhbi5jb3JlLlZhbHVlKGNhbi5fdHJhbnMsIGssIHYpIH0pCgkJfQoKCQlpZiAoY2FuLnVzZXIubGFuZ3VhZ2UoY2FuKSA9PSAiZW4iKSB7IHJldHVybiB0ZXh0IH0KCQlpZiAoY2FuLmJhc2UuaXNGdW5jdGlvbih0ZXh0KSkgeyB0ZXh0ID0gdGV4dC5uYW1lfHwiIiB9CgkJcmV0dXJuIGxpc3QmJmxpc3RbdGV4dF0gfHwgY2FuLkNvbmYoInRyYW5zLiIrdGV4dCkgfHwgY2FuLkNvbmYoImZlYXR1cmUuX3RyYW5zLiIrdGV4dCkgfHwgY2FuLl90cmFucyYmY2FuLl90cmFuc1t0ZXh0XSB8fCB7CgkJCSJjcmVhdGUiOiAi5Yib5bu6IiwgInJlbW92ZSI6ICLliKDpmaQiLCAiaW5zZXJ0IjogIua3u+WKoCIsICJkZWxldGUiOiAi5Yig6ZmkIiwgIm1vZGlmeSI6ICLnvJbovpEiLAoJCQkiaW5wdXRzIjogIuihpeWFqCIsICJwcnVuZXMiOiAi5riF55CGIiwgImV4cG9ydCI6ICLlr7zlh7oiLCAiaW1wb3J0IjogIuWvvOWFpSIsCgkJCSJsaXN0IjogIuafpeeciyIsICJiYWNrIjogIui/lOWbniIsICJydW4iOiAi5omn6KGMIiwgImRvbmUiOiAi5a6M5oiQIiwgInNoYXJlIjogIuWFseS6qyIsCgkJCSJlZGl0IjogIue8lui+kSIsICJzYXZlIjogIuS/neWtmCIsICJjb3B5IjogIuWkjeWItiIsICJzaG93IjogIuaYvuekuiIsICJoaWRlIjogIumakOiXjyIsCgkJCSJwcm9qZWN0IjogIumhueebriIsICJwcm9maWxlIjogIuivpuaDhSIsICJhY3Rpb25zIjogIuWPguaVsCIsCgkJCSJwbHVnaW4iOiAi5o+S5Lu2IiwKCQkJInByZXYiOiAi5LiK5LiA6aG1IiwgIm5leHQiOiAi5LiL5LiA6aG1IiwKCgkJCSJvcGVuIjogIuaJk+W8gCIsICJjbG9zZSI6ICLlhbPpl60iLAoJCQkic3RhcnQiOiAi5ZCv5YqoIiwgInN0b3AiOiAi5YGc5q2iIiwKCQkJImJlZ2luIjogIuW8gOWniyIsICJlbmQiOiAi57uT5p2fIiwKCQkJImNsZWFyIjogIua4heepuiIsICJyZWZyZXNoIjogIuWIt+aWsCIsCgkJCSJzdWJtaXQiOiAi5o+Q5LqkIiwgImNhbmNlbCI6ICLlj5bmtogiLAoJCQkibGFiZWwiOiAi5qCH562+IiwgImV4ZWMiOiAi5omn6KGMIiwKCQl9W3RleHRdfHx0ZXh0Cgl9LAoJdG9hc3RDb25maXJtOiBmdW5jdGlvbihjYW4sIHRpdGxlLCBjb250ZW50LCBhY3Rpb24pIHsKCQlyZXR1cm4gY2FuLnVzZXIudG9hc3QoY2FuLCB7dGl0bGU6IHRpdGxlLCBjb250ZW50OiBjb250ZW50LCBhY3Rpb246IGFjdGlvbnx8W2NsaS5DTE9TRV0sIGR1cmF0aW9uOiAtMSwgd2lkdGg6IC0zMDB9KQoJfSwKCXRvYXN0UHJvY2VzczogZnVuY3Rpb24oY2FuLCB0aXRsZSkgeyByZXR1cm4gY2FuLnVzZXIudG9hc3QoY2FuLCBpY2UuUFJPQ0VTUywgdGl0bGUsIC0xKSB9LAoJdG9hc3RTdWNjZXNzOiBmdW5jdGlvbihjYW4sIHRpdGxlKSB7IHJldHVybiBjYW4udXNlci50b2FzdChjYW4sIGljZS5TVUNDRVNTLCB0aXRsZSkgfSwKCXRvYXN0OiBmdW5jdGlvbihjYW4sIGNvbnRlbnQsIHRpdGxlLCBkdXJhdGlvbiwgcHJvZ3Jlc3MpIHsKCQl2YXIgbWV0YSA9IGNhbi5iYXNlLmlzT2JqZWN0KGNvbnRlbnQpPyBjb250ZW50OiB7Y29udGVudDogY29udGVudCwgdGl0bGU6IHRpdGxlfHxjYW4uX2hlbHAsIGR1cmF0aW9uOiBkdXJhdGlvbiwgcHJvZ3Jlc3M6IHByb2dyZXNzfQoJCXZhciB3aWR0aCA9IG1ldGEud2lkdGh8fDQwMCwgaGVpZ2h0ID0gbWV0YS5oZWlnaHR8fDEwMDsgaWYgKHdpZHRoIDwgMCkgeyB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoICsgd2lkdGggfQoKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBkb2N1bWVudC5ib2R5LCAgW3t2aWV3OiBjaGF0LlRPQVNULCBzdHlsZTogewoJCQlsZWZ0OiAod2luZG93LmlubmVyV2lkdGgtd2lkdGgpLzIsIHdpZHRoOiB3aWR0aCwgYm90dG9tOiAxMDAsCgkJfSwgbGlzdDogWwoJCQl7dGV4dDogW21ldGEudGl0bGV8fCIiLCBodG1sLkRJViwgaHRtbC5USVRMRV0sIHRpdGxlOiAi54K55Ye75aSN5Yi2Iiwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgbWV0YS50aXRsZSkKCQkJfX0sCgkJCXt2aWV3OiAiZHVyYXRpb24iLCB0aXRsZTogIueCueWHu+WFs+mXrSIsIG9uY2xpY2s6IGZ1bmN0aW9uKCkgeyBhY3Rpb24uY2xvc2UoKSB9fSwKCQkJY2FuLmJhc2UuaXNPYmplY3QobWV0YS5jb250ZW50KT8gbWV0YS5jb250ZW50OiB7dGV4dDogW21ldGEuY29udGVudHx8IuaJp+ihjOaIkOWKnyIsIGh0bWwuRElWLCAiY29udGVudCJdfSwKCgkJCXt2aWV3OiBjaGF0LkFDVElPTn0sIG1ldGEucHJvZ3Jlc3MgIT0gdW5kZWZpbmVkICYmIHt2aWV3OiAicHJvZ3Jlc3MiLCBzdHlsZToge3dpZHRoOiB3aWR0aH0sIGxpc3Q6IFsKCQkJCXt2aWV3OiAiY3VycmVudCIsIHN0eWxlOiB7d2lkdGg6IChtZXRhLnByb2dyZXNzfHwwKS8xMDAqd2lkdGh9fSwKCQkJXX0sCgkJXSB9XSkKCgkJdmFyIGFjdGlvbiA9IGNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgbWV0YS5hY3Rpb258fFsiIl0sIHVpLmFjdGlvbiwgewoJCQljbG9zZTogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgYWN0aW9uLl90YXJnZXQpLCBhY3Rpb24udGltZXIuc3RvcCA9IHRydWUgfSwKCQkJdGltZXI6IGNhbi5jb3JlLlRpbWVyKHtpbnRlcnZhbDogMTAwLCBsZW5ndGg6IChwYXJzZUludChtZXRhLmR1cmF0aW9ufHwxMDAwKSkvMTAwfSwgZnVuY3Rpb24oZXZlbnQsIGludGVydmFsLCBpbmRleCkgewoJCQkJaWYgKGluZGV4ID4gMzApIHsgdWkuZHVyYXRpb24uaW5uZXJIVE1MID0gcGFyc2VJbnQoaW5kZXgvMTApK2ljZS5QVCsoaW5kZXglMTApKyJzLi4uIiB9CgkJCX0sIGZ1bmN0aW9uKCkgeyBhY3Rpb24uY2xvc2UoKSB9KSwgX3RhcmdldDogdWkuX3RhcmdldCwgdWk6IHVpLAoJCX0pOyBjYW4ub25tb3Rpb24uc3RvcnkuYXV0byhjYW4sIHVpLl90YXJnZXQpCgoJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBjaGF0Lk9OVE9BU1QsIGNhbi5yZXF1ZXN0KHt9LCB7dGltZTogY2FuLmJhc2UuVGltZSgpLCB0aXRsZTogbWV0YS50aXRsZSwgY29udGVudDogbWV0YS5jb250ZW50LCBmaWxlbGluZTogY2FuLm1pc2MuRmlsZUxpbmUoMiwgMil9KSkKCQlyZXR1cm4gIW1ldGEuYWN0aW9uICYmIGNhbi5vbm1vdGlvbi5mbG9hdC5hZGQoY2FuLCBjaGF0LlRPQVNULCBhY3Rpb24pLCBhY3Rpb24KCX0sCglzaGFyZTogZnVuY3Rpb24oY2FuLCBtc2csIGNtZCkgewoJCWNhbi5ydW4obXNnLl9ldmVudCwgY21kfHxbY3R4LkFDVElPTiwgY2hhdC5TSEFSRV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4udXNlci50b2FzdChjYW4sIHtoZWlnaHQ6IDMwMCwgd2lkdGg6IDUwMCwKCQkJCXRpdGxlOiBtc2cuQXBwZW5kKG1kYi5OQU1FKSwgZHVyYXRpb246IC0xLAoJCQkJY29udGVudDogbXNnLkFwcGVuZChtZGIuVEVYVCksIGFjdGlvbjogW2NsaS5DTE9TRV0sCgkJCX0pLCBjYW4udXNlci5jb3B5KG1zZy5fZXZlbnQsIGNhbiwgbXNnLkFwcGVuZChtZGIuTkFNRSkpCgkJfSkKCX0sCglsb2dpbjogZnVuY3Rpb24oY2FuLCBjYiwgbWV0aG9kLCBhdXRvKSB7IG1ldGhvZCA9IGNhbi5iYXNlLk9iaihtZXRob2QsIFsi55m75b2VIiwgIuaJq+eggSJdKQoJCXZhciBsaXN0ID0gewoJCQki55m75b2VIjogZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQkJY2FuLnJ1bih7fSwgW2FhYS5MT0dJTiwgZGF0YVtodG1sLlVTRVJOQU1FXSwgZGF0YVtodG1sLlBBU1NXT1JEXV0sIGZ1bmN0aW9uKG1zZykgewoJCQkJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfVVNFUk5BTUUpKSB7CgkJCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLl90YXJnZXQpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQkJCQl9IGVsc2UgewoJCQkJCQljYW4udXNlci50b2FzdChjYW4sICLnlKjmiLflkI3miJblr4bnoIHplJnor68iKQoJCQkJCX0KCQkJCX0pCgkJCQlyZXR1cm4gdHJ1ZQoJCQl9LCAKCQkJIuaJq+eggSI6IGZ1bmN0aW9uKCkgewoJCQkJY2FuLm1pc2MuV1NTKGNhbiwge3R5cGU6IGh0bWwuQ0hST01FLCBjbWQ6ICJwd2QifSwgZnVuY3Rpb24oZXZlbnQsIG1zZywgY21kLCBhcmcpIHsgaWYgKCFtc2cpIHsgcmV0dXJuIH0KCQkJCQlpZiAoY21kID09ICJwd2QiKSB7CgkJCQkJCXJldHVybiBjYW4udXNlci50b2FzdChjYW4sIGFyZ1syXSwgYXJnWzFdLCAtMSksIG1zZy5SZXBseSgpCgkJCQkJfQoJCQkJCWlmIChjbWQgPT0gaWNlLk1TR19TRVNTSUQpIHsKCQkJCQkJcmV0dXJuIGNhbi5taXNjLkNvb2tpZVNlc3NpZChjYW4sIGFyZ1swXSksIG1zZy5SZXBseSgpLCBjYW4udXNlci5yZWxvYWQodHJ1ZSkKCQkJCQl9CgkJCQkJY2FuLnNlYXJjaChldmVudCwgbXNnW2ljZS5NU0dfREVUQUlMXXx8W10sIGZ1bmN0aW9uKG1zZykgeyBtc2cuUmVwbHkoKSB9KQoJCQkJfSkKCQkJfSwKCQkJIuaOiOadgyI6IGZ1bmN0aW9uKCkgewoJCQkJY2FuLm1pc2MuV1NTKGNhbiwge3R5cGU6IGh0bWwuQ0hST01FLCBjbWQ6ICJzc28iLCAidXNlci53ZWIiOiBsb2NhdGlvbi5ocmVmfSwgZnVuY3Rpb24oZXZlbnQsIG1zZywgY21kLCBhcmcpIHsgaWYgKCFtc2cpIHsgcmV0dXJuIH0KCQkJCQlpZiAoY21kID09ICJwd2QiKSB7CgkJCQkJCXJldHVybiBsb2NhdGlvbi5ocmVmID0gYXJnWzFdCgkJCQkJfQoJCQkJCWlmIChjbWQgPT0gaWNlLk1TR19TRVNTSUQpIHsKCQkJCQkJcmV0dXJuIGNhbi5taXNjLkNvb2tpZVNlc3NpZChjYW4sIGFyZ1swXSksIG1zZy5SZXBseSgpLCBjYW4udXNlci5yZWxvYWQodHJ1ZSkKCQkJCQl9CgkJCQkJY2FuLnNlYXJjaChldmVudCwgbXNnW2ljZS5NU0dfREVUQUlMXXx8W10sIGZ1bmN0aW9uKG1zZykgeyBtc2cuUmVwbHkoKSB9KQoJCQkJfSkKCQkJfSwKCQkJIumjnuS5piI6IGZ1bmN0aW9uKCkgeyBsb2NhdGlvbi5ocmVmID0gIi9jaGF0L2xhcmsvc3NvIiB9LAoJCX07IGlmIChhdXRvKSB7IHJldHVybiBsaXN0WyLmjojmnYMiXSgpIH0gZWxzZSBpZiAobWV0aG9kLmxlbmd0aCA9PSAxKSB7IGxpc3RbbWV0aG9kWzBdXSgpOyByZXR1cm4gfQoKCQl2YXIgdWkgPSBjYW4udXNlci5pbnB1dCh7fSwgY2FuLCBbe3R5cGU6IGh0bWwuVVNFUk5BTUV9LCB7dHlwZTogaHRtbC5QQVNTV09SRH1dLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7IHJldHVybiBsaXN0W2J1dHRvbl0oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgfSwgbWV0aG9kKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLl90YXJnZXQsIHtjbGFzc05hbWU6ICJpbnB1dCBsb2dpbiIsIHN0eWxlOiB7bGVmdDogKHdpbmRvdy5pbm5lcldpZHRoLXVpLl90YXJnZXQub2Zmc2V0V2lkdGgpLzIsIHRvcDogd2luZG93LmlubmVySGVpZ2h0LzZ9fSkKCX0sCglsb2dvdXQ6IGZ1bmN0aW9uKGNhbiwgZm9yY2UpIHsgaWYgKGZvcmNlfHxjYW4udXNlci5jb25maXJtKCJsb2dvdXQ/IikpIHsKCQljYW4ucnVuKHt9LCBbY3R4LkFDVElPTiwgYWFhLkxPR09VVF0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LlNIQVJFKT8gY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5TSEFSRSwgIiIpOiBjYW4udXNlci5yZWxvYWQodHJ1ZSkKCQl9KQoJfSB9LAoKCXRvUE5HOiBmdW5jdGlvbihjYW4sIG5hbWUsIHRleHQsIGhlaWdodCwgd2lkdGgpIHsKCQlpZiAodGV4dC5pbmRleE9mKCI8c3ZnIikgIT0gMCkgewoJCQl0ZXh0ID0gJzxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4nK3RleHQrIjwvc3ZnPiIKCQl9CgkJdmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaHRtbC5JTUcpCgkJaW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewoJCQl2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIikKCQkJY2FudmFzLmhlaWdodCA9IGhlaWdodCwgY2FudmFzLndpZHRoID0gd2lkdGgKCQkJY2FudmFzLmdldENvbnRleHQoIjJkIikuZHJhd0ltYWdlKGltZywgMCwgMCkKCgkJCXZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpCgkJCWEuaHJlZiA9IGNhbnZhcy50b0RhdGFVUkwoImltYWdlL3BuZyIpCgkJCWEuZG93bmxvYWQgPSBuYW1lLCBhLmNsaWNrKCkKCQl9LCBpbWcuc3JjID0gImRhdGE6aW1hZ2Uvc3ZnK3htbCwiK2VuY29kZVVSSUNvbXBvbmVudCh0ZXh0KQoJfSwKCWNvcHk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRleHQpIHsKCQlpZiAobmF2aWdhdG9yLmNsaXBib2FyZCkgeyB2YXIgb2sgPSBmYWxzZQoJCQluYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0ZXh0KS50aGVuKGZ1bmN0aW9uKCkgeyBvayA9IHRydWUgfSkKCQkJaWYgKG9rKSB7IHJldHVybiBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9CgkJfQoKCQl2YXIgaW5wdXQgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBldmVudC50YXJnZXQucGFyZW50Tm9kZSwgW3t0eXBlOiBodG1sLlRFWFRBUkVBLCB2YWx1ZTogdGV4dH1dKS5maXJzdAoJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIGlucHV0KSwgZG9jdW1lbnQuZXhlY0NvbW1hbmQoIkNvcHkiKQoJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGlucHV0KSwgY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbikKCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQljYW4ubWlzYy5Mb2coImNvcHkiLCB0ZXh0KQoJCXJldHVybiB0ZXh0Cgl9LAoJY2FydGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGxpc3QsIGNiLCBwYXJlbnQpIHsgLy8gZXZlbnQgaXRlbSBtZXRhCgkJbWV0YSA9IG1ldGF8fGNhbi5vbmRldGFpbHx8Y2FuLm9uYWN0aW9ufHx7fSwgbGlzdCA9IGxpc3QmJmxpc3QubGVuZ3RoID4gMD8gbGlzdDogbWV0YS5saXN0fHxbXTsgaWYgKGxpc3QubGVuZ3RoID09IDApIHsgcmV0dXJuIH0KCQljYiA9IGNifHxmdW5jdGlvbihldmVudCwgaXRlbSwgbWV0YSkgeyB2YXIgY2IgPSBtZXRhW2l0ZW1dfHxtZXRhWyJfZW5naW5lIl07IGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGNhbiwgaXRlbSkgfQoKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBkb2N1bWVudC5ib2R5LCBbe3ZpZXc6IGNoYXQuQ0FSVEUsIHN0eWxlOiB7bGVmdDogMCwgdG9wOiAwfSwgb25tb3VzZWxlYXZlOiBmdW5jdGlvbihldmVudCkgewoJCQkvLyBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KQoJCX0sIGxpc3Q6IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJcmV0dXJuIGNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pPyB7dmlldzogaHRtbC5JVEVNLCBsaXN0OiBbe3RleHQ6IGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbSksIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pc01vYmlsZSAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbSwgbWV0YSwgaW5kZXgpCgkJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhcnRlLl9mbG9hdCAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYXJ0ZS5fZmxvYXQuX3RhcmdldCkKCQkJfSB9XSB9OiBjYW4uYmFzZS5pc0FycmF5KGl0ZW0pPyB7dmlldzogaHRtbC5JVEVNLCBsaXN0OiBbe3RleHQ6IGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbVswXSkrIiAtPiAifV0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciBzdWIgPSBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBtZXRhLCBpdGVtLnNsaWNlKDEpLCBjYiwgY2FydGUpCgkJCQljYXJ0ZS5fZmxvYXQgJiYgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FydGUuX2Zsb2F0Ll90YXJnZXQpLCBjYXJ0ZS5fZmxvYXQgPSBzdWIKCQkJCWNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgc3ViLl90YXJnZXQsIHRydWUpCgkJCX0gfToge3ZpZXc6IGh0bWwuSVRFTSwgbGlzdDogW3t0ZXh0OiBjYW4udXNlci50cmFucyhjYW4sIGl0ZW0ubmFtZSksIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pc01vYmlsZSAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbS5uYW1lLCBtZXRhLCBpbmRleCkKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FydGUuX2Zsb2F0ICYmIGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhcnRlLl9mbG9hdC5fdGFyZ2V0KQoJCQl9IH1dIH0KCQl9KSB9XSApCgoJCXVpLl90YXJnZXQub25tb3VzZW92ZXIgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ub25rZXltYXAucHJldmVudChldmVudCkgfQoJCXZhciBjYXJ0ZSA9IHtfdGFyZ2V0OiB1aS5fdGFyZ2V0LCBfcGFyZW50OiBwYXJlbnQsIGxheW91dDogY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuLCB1aS5fdGFyZ2V0KX0KCQlyZXR1cm4gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpLCBjYXJ0ZQoJfSwKCWNhcnRlUmlnaHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGxpc3QsIGNiLCBwYXJlbnQpIHsKCQl2YXIgY2FydGUgPSBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBtZXRhLCBsaXN0LCBjYiwgcGFyZW50KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhcnRlLl90YXJnZXQsIHtzdHlsZTogewoJCQlsZWZ0OiBldmVudC5jbGllbnRYLWV2ZW50Lm9mZnNldFgrZXZlbnQudGFyZ2V0Lm9mZnNldFdpZHRoLTMsCgkJCXRvcDogY2FydGUuX3RhcmdldC5vZmZzZXRUb3AtKGNhcnRlLmxheW91dC5ib3R0b20/IC1ldmVudC50YXJnZXQub2Zmc2V0SGVpZ2h0OiBldmVudC50YXJnZXQub2Zmc2V0SGVpZ2h0KSs1LAoJCQlib3R0b206ICIiLAoJCX19KQoJCXJldHVybiBjYXJ0ZQoJfSwKCWNhcnRlQ2xpZW50OiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBsaXN0LCBjYiwgcGFyZW50KSB7CgkJdmFyIHVpID0gY2FuLnVzZXIuY2FydGUoZXZlbnQsIGNhbiwgbWV0YSwgbGlzdCwgY2IsIHBhcmVudCkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB1aS5fdGFyZ2V0LCB7c3R5bGU6IHtsZWZ0OiBldmVudC5jbGllbnRYLCB0b3A6IGV2ZW50LmNsaWVudFl9fSkKCX0sCgoJaW5wdXQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGZvcm0sIGNiLCBidXR0b24pIHsgaWYgKCFmb3JtIHx8IGZvcm0ubGVuZ3RoID09IDApIHsgcmV0dXJuIGNiKCkgfQoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBkb2N1bWVudC5ib2R5LCBbe3ZpZXc6IFtodG1sLklOUFVUXSwgc3R5bGU6IHtsZWZ0OiAwLCB0b3A6IDB9LCBsaXN0OiBbCgkJCXt2aWV3OiAiY29udGVudCIsIGxpc3Q6IFt7dmlldzogW2NoYXQuT1BUSU9OLCBodG1sLlRBQkxFXSwgbGlzdDogY2FuLmNvcmUuTGlzdChmb3JtLCBmdW5jdGlvbihpdGVtKSB7CgkJCQlpdGVtID0gY2FuLmJhc2UuaXNTdHJpbmcoaXRlbSk/IHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IGl0ZW19OiBpdGVtLmxlbmd0aCA+IDA/IHt0eXBlOiBodG1sLlNFTEVDVCwgbmFtZTogaXRlbVswXSwgdmFsdWVzOiBpdGVtLnNsaWNlKDEpfTogaXRlbQoJCQkJaXRlbS50eXBlID0gaXRlbS50eXBlfHwoaXRlbS52YWx1ZXM/IGh0bWwuU0VMRUNUOiBpdGVtLm5hbWUgPT0gaHRtbC5URVhUPyBodG1sLlRFWFRBUkVBOiBodG1sLlRFWFQpCgoJCQkJaXRlbS5faW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgewoJCQkJCWl0ZW0ucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCQkJCXZhciBfbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtfaGFuZGxlOiBpY2UuVFJVRSwgYWN0aW9uOiBtc2cuT3B0aW9uKGNoYXQuQUNUSU9OKX0sIG1zZywgY2FuLk9wdGlvbigpKQoJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS50YWJsZSwgaHRtbC5PUFRJT05fQVJHUywgZnVuY3Rpb24oaXRlbSkgewoJCQkJCQkJaXRlbS5uYW1lICYmIGl0ZW0udmFsdWUgJiYgX21zZy5PcHRpb24oaXRlbS5uYW1lLCBpdGVtLnZhbHVlKQoJCQkJCQl9KQoJCQkJCQljYW4ucnVuKGV2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkKCQkJCQl9CgoJCQkJCWlmIChpdGVtLm5hbWUgIT0gImFjdGlvbiIgJiYgaXRlbS5uYW1lKSB7CgkJCQkJCXRhcmdldC52YWx1ZSA9IG1zZy5PcHRpb24oaXRlbS5uYW1lKXx8Y2FuLk9wdGlvbihpdGVtLm5hbWUpfHx0YXJnZXQudmFsdWV8fCIiCgkJCQkJfQoJCQkJCWNhbi5vbmFwcGVuZC5maWd1cmUoY2FuLCBpdGVtLCB0YXJnZXQpCgkJCQl9CgoJCQkJLy8gcmV0dXJuIHt0eXBlOiBodG1sLlRSLCBsaXN0OiBbe3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFt7dGV4dDogaXRlbS5fdHJhbnN8fGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbS5uYW1lKXx8IiJ9XX0sIHt0eXBlOiBodG1sLlRELCBsaXN0OiBbY2FuLnBhZ2UuaW5wdXQoY2FuLCBpdGVtKV19IF19CgkJCQlyZXR1cm4ge3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dHlwZTogaHRtbC5URCwgbGlzdDogW3t0ZXh0OiBpdGVtLm5hbWV8fCIifV19LCB7dHlwZTogaHRtbC5URCwgbGlzdDogW2Nhbi5wYWdlLmlucHV0KGNhbiwgaXRlbSldfSBdfQoJCQl9KX1dfSwge3ZpZXc6IGNoYXQuQUNUSU9OfSwKCQldfV0pCgoJCXZhciBsYXlvdXQgPSBjYW4ub25sYXlvdXQuZmlndXJlKGV2ZW50LCBjYW4sIHVpLl90YXJnZXQpCgkJaWYgKGxheW91dC5sZWZ0ID09IHVuZGVmaW5lZCkgeyBpZiAoIWxheW91dC50b3ApIHsgbGF5b3V0LnRvcCA9IDMyIH0KCQkJbGF5b3V0LmxlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aC8yLXVpLl90YXJnZXQub2Zmc2V0V2lkdGgvMiwgbGF5b3V0LnJpZ2h0ID0gIiIKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB1aS5fdGFyZ2V0LCBsYXlvdXQpCgkJfQoJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB1aS5fdGFyZ2V0LCBjaGF0LkZMT0FUKQoJCWlmIChsYXlvdXQudG9wKSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdWkuY29udGVudCwgaHRtbC5NQVhfSEVJR0hULCB3aW5kb3cuaW5uZXJIZWlnaHQgLSBsYXlvdXQudG9wIC0gaHRtbC5BQ1RJT05fSEVJR0hUIC0gMTApCgkJfQoKCQl2YXIgYWN0aW9uID0gY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBidXR0b258fFtodG1sLlNVQk1JVCwgaHRtbC5DQU5DRUxdLCB1aS5hY3Rpb24sIHsKCQkJZm9jdXM6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLmZpcnN0LCBodG1sLklOUFVUX0FSR1MpWzBdLmZvY3VzKCkgfSwKCQkJY2FuY2VsOiBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KSB9LAoJCQlfZW5naW5lOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgYWN0aW9uLnN1Ym1pdChldmVudCwgY2FuLCBidXR0b24pIH0sCgkJCXN1Ym1pdDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IHZhciBkYXRhID0ge30sIGFyZ3MgPSBbXSwgbGlzdCA9IFtdCgkJCQlsaXN0ID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdWkudGFibGUsIGh0bWwuT1BUSU9OX0FSR1MsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQlyZXR1cm4gaXRlbS5uYW1lICYmIGl0ZW0udmFsdWUgJiYgYXJncy5wdXNoKGl0ZW0ubmFtZSwgaXRlbS52YWx1ZSksIGRhdGFbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWUKCQkJCX0pCgkJCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtfaGFuZGxlOiBpY2UuVFJVRX0pCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmICFjYihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSAmJiBhY3Rpb24uY2FuY2VsKCkKCQkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9LCBfdGFyZ2V0OiB1aS5fdGFyZ2V0LAoJCX0pCgkJaWYgKGJ1dHRvbiA9PT0gIHRydWUpIHsgcmV0dXJuIGFjdGlvbi5zdWJtaXQoZXZlbnQsIGNhbiwgInN1Ym1pdCIpLCBhY3Rpb24gfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS5fdGFyZ2V0LCBodG1sLklOUFVUX0FSR1MsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCWluZGV4ID09IDAgJiYgY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsgY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgaXRlbSkgfSkKCQl9KQoJCXJldHVybiBhY3Rpb24KCX0sCglzZWxlY3Q6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHR5cGUsIGZpZWxkcywgY2IsIGNicykgewoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge2ZpZWxkczogZmllbGRzfHwidHlwZSxuYW1lLHRleHQifSkKCQljYW4uc2VhcmNoKG1zZy5fZXZlbnQsIFsiU2VhcmNoLm9uaW1wb3J0LnNlbGVjdCIsIHR5cGUsICIiLCAiIl0sIGZ1bmN0aW9uKGxpc3QpIHsKCQkJY2FuLmNvcmUuTmV4dChsaXN0LCBjYiwgY2JzfHxmdW5jdGlvbigpIHsKCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJCX0pCgkJfSkKCX0sCgl1cGxvYWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIGJlZ2luID0gbmV3IERhdGUoKQoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGRvY3VtZW50LmJvZHksIFt7dmlldzogaHRtbC5VUExPQUQsIHN0eWxlOiB7bGVmdDogMCwgdG9wOiAwfSwgbGlzdDogWwoJCQl7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVQsIGxpc3Q6IFt7dmlldzogInByb2dyZXNzIn1dfSwKCQkJe3ZpZXc6IGh0bWwuU1RBVFVTLCBsaXN0OiBbe3ZpZXc6IGh0bWwuU0hPV30sIHt2aWV3OiAiY29zdCJ9LCB7dmlldzogInNpemUifV19LAoJCV19XSk7IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgdWkuX3RhcmdldCkKCgkJdmFyIGFjdGlvbiA9IGNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgWwoJCQl7dHlwZTogaHRtbC5VUExPQUQsIG9uY2hhbmdlOiBmdW5jdGlvbihldmVudCkgewoJCQkJYWN0aW9uLnNob3coZXZlbnQsIDAsIGV2ZW50LnRhcmdldC5maWxlc1swXS5zaXplLCAwKQoJCQl9fSwgY2xpLkNMT1NFLAoJCV0sIHVpLmFjdGlvbiwgewoJCQljbG9zZTogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdWkuX3RhcmdldCkgfSwKCQkJYmVnaW46IGZ1bmN0aW9uKGV2ZW50KSB7IGJlZ2luID0gbmV3IERhdGUoKQoJCQkJdmFyIHVwbG9hZCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLmFjdGlvbiwgImlucHV0W3R5cGU9ZmlsZV0iKQoJCQkJaWYgKHVwbG9hZFswXS5maWxlcy5sZW5ndGggPT0gMCkgeyByZXR1cm4gdXBsb2FkWzBdLmZvY3VzKCkgfQoKCQkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpLCB7X2hhbmRsZTogInRydWUifSkKCQkJCW1zZy5fdXBsb2FkID0gdXBsb2FkWzBdLmZpbGVzWzBdLCBtc2cuX3Byb2dyZXNzID0gYWN0aW9uLnNob3cKCgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaHRtbC5VUExPQURdLCBmdW5jdGlvbihtc2cpIHsKCQkJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSwgY2FuLlVwZGF0ZSgpLCBhY3Rpb24uY2xvc2UoKQoJCQkJfSwgdHJ1ZSkKCQkJfSwKCQkJc2hvdzogZnVuY3Rpb24gKGV2ZW50LCB2YWx1ZSwgdG90YWwsIGxvYWRlZCkgeyBub3cgPSBuZXcgRGF0ZSgpCgkJCQl2YWx1ZSA9PSAwICYmIGFjdGlvbi5iZWdpbihldmVudCkKCgkJCQl1aS5zaG93LmlubmVySFRNTCA9IHZhbHVlKyIlIgoJCQkJdWkuY29zdC5pbm5lckhUTUwgPSBjYW4uYmFzZS5EdXJhdGlvbihub3cgLSBiZWdpbikKCQkJCXVpLnNpemUuaW5uZXJIVE1MID0gY2FuLmJhc2UuU2l6ZShsb2FkZWQpK2ljZS5QUytjYW4uYmFzZS5TaXplKHRvdGFsKQoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdWkucHJvZ3Jlc3MsIHtzdHlsZToge3dpZHRoOiB2YWx1ZSoodWkub3V0cHV0Lm9mZnNldFdpZHRoLTIpLzEwMH19KQoJCQl9LAoJCX0pOyBjYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS5hY3Rpb24sICJpbnB1dFt0eXBlPWZpbGVdIilbMF0uY2xpY2soKQoKCQlyZXR1cm4gYWN0aW9uCgl9LAoJZG93bmxvYWQ6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgbmFtZSkgewoJCXZhciBhID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgZG9jdW1lbnQuYm9keSwgW3t0eXBlOiBodG1sLkEsIGhyZWY6IHBhdGgsIGRvd25sb2FkOiBuYW1lfHxwYXRoLnNwbGl0KGljZS5QUykucG9wKCl9XSkuZmlyc3QKCQlhLmNsaWNrKCksIGNhbi5wYWdlLlJlbW92ZShjYW4sIGEpCgl9LAoJZG93bmxvYWRzOiBmdW5jdGlvbihjYW4sIHRleHQsIG5hbWUpIHsgY2FuLnVzZXIuZG93bmxvYWQoY2FuLCBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFt0ZXh0XSkpLCBuYW1lKSB9LAoJY2FtZXJhOiBmdW5jdGlvbihjYW4sIG1zZywgY2IpIHsKCQluYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHt2aWRlbzogdHJ1ZX0sIGNiLCBmdW5jdGlvbihlcnJvcikgewoJCQljYW4ubWlzYy5Mb2coZXJyb3IpCgkJfSkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9saWIvY29yZS5qcyIKVm9sY2Fub3MoImNvcmUiLCB7aGVscDogIuaVsOaNrue7k+aehCIsCglLZXlzOiBzaHkoIui/nuaOpeWZqCIsIGZ1bmN0aW9uKCkgeyB2YXIgbGlzdCA9IFtdCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHYgPSBhcmd1bWVudHNbaV0KCQkJc3dpdGNoICh0eXBlb2YgdikgewoJCQkJY2FzZSBsYW5nLk9CSkVDVDogZm9yICh2YXIgaiA9IDA7IGogPCB2Lmxlbmd0aDsgaisrKSB7IGxpc3QucHVzaCh2W2pdKSB9IGJyZWFrCgkJCQljYXNlIGxhbmcuRlVOQ1RJT046IHYgPSB2KCkKCQkJCWRlZmF1bHQ6IHYgJiYgbGlzdC5wdXNoKHYrIiIpCgkJCX0KCQl9CgkJcmV0dXJuIGxpc3Quam9pbihpY2UuUFQpCgl9KSwKCVZhbHVlOiBzaHkoIuWtmOWCqOWZqCIsIGZ1bmN0aW9uKGRhdGEsIGtleSwgdmFsdWUpIHsKCQlpZiAoZGF0YSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIH0KCQlpZiAoa2V5ID09IHVuZGVmaW5lZCkgeyByZXR1cm4gZGF0YSB9CgoJCWlmICh0eXBlb2Yga2V5ID09IGxhbmcuT0JKRUNUICYmIGtleS5sZW5ndGggPiAwKSB7IGtleSA9IGtleS5qb2luKGljZS5QVCkgfQoJCWlmICh0eXBlb2Yga2V5ID09IGxhbmcuT0JKRUNUKSB7IGZvciAodmFyIGsgaW4ga2V5KSB7IGFyZ3VtZW50cy5jYWxsZWUuY2FsbCh0aGlzLCBkYXRhLCBrLCBrZXlba10pIH0gcmV0dXJuIGRhdGEgfQoKCQlpZiAodmFsdWUgIT0gdW5kZWZpbmVkKSB7CgkJCXZhciBfZGF0YSA9IGRhdGEKCgkJCXZhciBscyA9IGtleS5zcGxpdChpY2UuUFQpCgkJCWZvciAodmFyIGkgPSAwOyBpIDwgbHMubGVuZ3RoOyBpKyspIHsKCQkJCXZhciBfc3ViID0gX2RhdGFbbHNbaV1dfHx7fQoJCQkJX2RhdGFbbHNbaV1dID0gX3N1YgoJCQkJaWYgKGkgPT0gbHMubGVuZ3RoIC0gMSkgewoJCQkJCV9kYXRhW2xzW2ldXSA9IHZhbHVlCgkJCQl9IGVsc2UgewoJCQkJCV9kYXRhID0gX3N1YgoJCQkJfQoJCQl9CgkJCS8vIGRhdGFba2V5XSA9IHZhbHVlCgkJfQoJCWlmIChkYXRhW2tleV0gIT0gdW5kZWZpbmVkKSB7IHJldHVybiBkYXRhW2tleV0gfQoKCQl2YXIgcCA9IGRhdGEsIGxzID0ga2V5LnNwbGl0KGljZS5QVCk7IHdoaWxlIChwICYmIGxzLmxlbmd0aCA+IDApIHsKCQkJaWYgKGxzWzBdID09ICItMSIpIHsgbHNbMF0gPSBwLmxlbmd0aC0xIH0KCQkJcCA9IHBbbHNbMF1dLCBscyA9IGxzLnNsaWNlKDEpCgkJfSByZXR1cm4gcAoJfSksCglTcGxpdDogc2h5KCLliIbor43lmagiLCBmdW5jdGlvbihzdHIpIHsgaWYgKCFzdHIgfHwgIXN0ci5sZW5ndGgpIHsgcmV0dXJuIFtdIH0KCQl2YXIgb3B0ID0ge2RldGFpbDogZmFsc2V9LCBhcmcgPSBbXTsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCQkJdHlwZW9mIGFyZ3VtZW50c1tpXSA9PSBsYW5nLk9CSkVDVD8gb3B0ID0gYXJndW1lbnRzW2ldOiBhcmcucHVzaChhcmd1bWVudHNbaV0pCgkJfQoKCQkvLyDlrZfnrKblrprkuYkKCQlmdW5jdGlvbiBfbGlzdChzdHIpIHsgdmFyIHJlcyA9IHt9OyBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgeyByZXNbc3RyW2ldXSA9IHRydWUgfTsgcmV0dXJuIHJlcyB9CgkJdmFyIHNwYWNlID0gX2xpc3QoYXJnWzBdfHwiXHQgLDtcbiIpICAvLyDnqbrnmb3nrKYKCQl2YXIgYmxvY2sgPSBfbGlzdChhcmdbMV18fCJ7WygpXX0iKSAgIC8vIOWIhumalOespgoJCXZhciBxdW90ZSA9IF9saXN0KGFyZ1syXXx8IidcImAiKSAgICAgLy8g5byV55So56ymCgkJdmFyIHRyYW5zID0gX2xpc3QoYXJnWzNdfHwiXFwiKSAgICAgICAvLyDovazkuYnnrKYKCgkJdmFyIHJlcyA9IFtdLCBiZWdpbiA9IDA7IGZ1bmN0aW9uIHB1c2gob2JqKSB7CgkJCW9iaiAmJiByZXMucHVzaCh0eXBlb2Ygb2JqID09IGxhbmcuU1RSSU5HIHx8IG9wdC5kZXRhaWw/IG9iajogb2JqLnRleHQpLCBiZWdpbiA9IC0xCgkJfQoKCQkvLyDlvIDlp4vliIbor40KCQlmb3IgKHZhciBzID0gIiIsIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7CgkJCWlmIChzcGFjZVtzdHJbaV1dKSB7IC8vIOepuueZveespgoJCQkJaWYgKHMpIHsgY29udGludWUgfQoJCQkJYmVnaW4gPiAtMSAmJiBwdXNoKHN0ci5zbGljZShiZWdpbiwgaSkpCgkJCQlvcHQuZGV0YWlsICYmIHB1c2goe3R5cGU6IGh0bWwuU1BBQ0UsIHRleHQ6IHN0ci5zbGljZShpLCBpKzEpfSkKCgkJCX0gZWxzZSBpZiAoYmxvY2tbc3RyW2ldXSkgeyAvLyDliIbpmpTnrKYKCQkJCWlmIChzKSB7IGNvbnRpbnVlIH0KCQkJCWJlZ2luID4gLTEgJiYgcHVzaChzdHIuc2xpY2UoYmVnaW4sIGkpKQoJCQkJcHVzaChzdHIuc2xpY2UoaSwgaSsxKSkKCgkJCX0gZWxzZSBpZiAocXVvdGVbc3RyW2ldXSkgeyAvLyDlvJXnlKjnrKYKCQkJCWlmIChzID09ICIiKSB7CgkJCQkJYmVnaW4gPiAtMSAmJiBwdXNoKHN0ci5zbGljZShiZWdpbiwgaSkpCgkJCQkJcyA9IHN0cltpXSwgYmVnaW4gPSBpKzEKCQkJCX0gZWxzZSBpZiAocyA9PSBzdHJbaV0pIHsKCQkJCQlwdXNoKHt0eXBlOiBsYW5nLlNUUklORywgdGV4dDogc3RyLnNsaWNlKGJlZ2luLCBpKSwgbGVmdDogcywgcmlnaHQ6IHN0cltpXX0pCgkJCQkJcyA9ICIiLCBiZWdpbiA9IC0xCgkJCQl9CgoJCQl9IGVsc2UgaWYgKHRyYW5zW3N0cltpXV0pIHsgLy8g6L2s5LmJ56ymCgkJCQliZWdpbiA9PSAtMSAmJiAoYmVnaW4gPSBpKyspCgoJCQl9IGVsc2UgeyAvLyDmma7pgJrnrKYKCQkJCWJlZ2luID09IC0xICYmIChiZWdpbiA9IGkpCgkJCX0KCQl9CgoJCS8vIOWJqeS9meWtl+espgoJCWJlZ2luID49IDAgJiYgKHM/IHB1c2goe3R5cGU6IGxhbmcuU1RSSU5HLCB0ZXh0OiBzdHIuc2xpY2UoYmVnaW4pLCBsZWZ0OiBzLCByaWdodDogIiJ9KTogcHVzaChzdHIuc2xpY2UoYmVnaW4pKSkKCQlyZXR1cm4gcmVzCgl9KSwKCUNhbGxGdW5jOiBzaHkoIuiwg+eUqOWZqCIsIGZ1bmN0aW9uKGZ1bmMsIGFyZ3MsIG1vZCkgeyBhcmdzID0gYXJnc3x8e30KCQl2YXIgZXZlbnQgPSBhcmdzWyJldmVudCJdfHx7fSwgY2FuID0gYXJnc1siY2FuIl18fGFyZ3NbMF0sIG1zZyA9IGFyZ3NbIm1zZyJdfHxhcmdzWzFdLCBjbWRzID0gYXJnc1siY21kcyJdfHxbXQoKCQkvLyDmn6Xmib7osIPnlKgKCQlmdW5jID0gdHlwZW9mIGZ1bmMgPT0gbGFuZy5GVU5DVElPTj8gZnVuYzogdHlwZW9mIGZ1bmMgPT0gbGFuZy5TVFJJTkc/IHRoaXMuVmFsdWUobW9kfHxjYW4sIGZ1bmMpOgoJCQl0eXBlb2YgZnVuYyA9PSBsYW5nLk9CSkVDVCAmJiBmdW5jLmxlbmd0aCA+IDA/IHRoaXMuVmFsdWUoZnVuY1swXSwgdGhpcy5LZXlzKGZ1bmMuc2xpY2UoMSkpKTogbnVsbAoJCWlmICh0eXBlb2YgZnVuYyAhPSBsYW5nLkZVTkNUSU9OKSB7IHJldHVybiB9CgoJCS8vIOino+aekOWPguaVsAoJCXZhciBsaXN0ID0gW10sIGVjaG8gPSBmYWxzZSwgY2IgPSBhcmdzWyJjYiJdCgkJdGhpcy5MaXN0KGZ1bmMudG9TdHJpbmcoKS5zcGxpdCgiKSIpWzBdLnNwbGl0KCIoIilbMV0uc3BsaXQoaWNlLkZTKSwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsgaXRlbSA9IGl0ZW0udHJpbSgpOyBpZiAoaXRlbSA9PSAiIikgeyByZXR1cm4gfQoJCQl2YXIgYXJnID0gYXJnc1tpdGVtXSB8fCBtc2cmJm1zZy5PcHRpb24mJm1zZy5PcHRpb24oaXRlbSkgfHwgY2FuJiZjYW4uQ29uZiYmY2FuLkNvbmYoaXRlbSkgfHwKCQkJCWV2ZW50JiYhKGV2ZW50IGluc3RhbmNlb2YgRXZlbnQpJiZldmVudFtpdGVtXSB8fCBhcmdzW2luZGV4XSB8fCBjbWRzW2luZGV4XSB8fCBudWxsCgkJCWlmIChpdGVtID09ICJjYiIpIHsgZWNobyA9IHRydWUgfQoJCQlsaXN0LnB1c2goYXJnKQoJCX0pCgoJCS8vIOaJp+ihjOiwg+eUqAoJCXZhciByZXMgPSBmdW5jLmFwcGx5KG1vZHx8Y2FuLCBsaXN0KQoJCWlmICghZWNobyAmJiB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTikgeyByZXMgJiYgbXNnICYmIG1zZy5FY2hvKHJlcyksIGFyZ3VtZW50cy5jYWxsZWUuYXBwbHkodGhpcywgW2NiLCB7bXNnOiBtc2csIHJlczogcmVzfV0pIH0KCQlyZXR1cm4gcmVzCgl9KSwKCglMaXN0OiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKGxpc3QsIGNiLCBpbnRlcnZhbCwgY2JzKSB7CgkJaWYgKHR5cGVvZiBsaXN0ID09IGxhbmcuU1RSSU5HKSB7IC8vIOm7mOiupOW6j+WIlwoJCQlsaXN0ID0gW2xpc3RdCgkJfSBlbHNlIGlmICh0eXBlb2YgbGlzdCA9PSBsYW5nLk5VTUJFUikgeyAvLyDnrYnlt67luo/liJcgW2VuZCBjYiBpbnRlcnZhbF18W2JlZ2luIGVuZCBpbnRlcnZhbF0KCQkJdmFyIGJlZ2luID0gMCwgZW5kID0gbGlzdCwgc3RlcCA9IHR5cGVvZiBpbnRlcnZhbCA9PSBsYW5nLk5VTUJFUj8gaW50ZXJ2YWw6IDEKCQkJaWYgKHR5cGVvZiBjYiA9PSBsYW5nLk5VTUJFUikgeyBiZWdpbiA9IGxpc3QsIGVuZCA9IGNiLCBjYiA9IG51bGwgfQoJCQlsaXN0ID0gW107IGZvciAodmFyIGkgPSBiZWdpbjsgaSA8IGVuZDsgaSArPSBzdGVwKSB7IGxpc3QucHVzaChpKSB9CgkJfQoKCQlsaXN0ID0gbGlzdHx8W10KCQlpZiAoaW50ZXJ2YWwgPiAwKSB7IC8vIOaXtumXtOW6j+WIlwoJCQlmdW5jdGlvbiBsb29wKGkpIHsgaWYgKGkgPj0gbGlzdC5sZW5ndGgpIHsgcmV0dXJuIHR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnMobGlzdCkgfQoJCQkJY2IobGlzdFtpXSwgaSwgbGlzdCksIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IGxvb3AoaSsxKSB9LCBpbnRlcnZhbCkKCQkJfQoJCQl0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTiAmJiBsaXN0Lmxlbmd0aCA+IDAgJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcCgwKSB9LCBpbnRlcnZhbC80KQoJCX0gZWxzZSB7IC8vIOmAieaLqeW6j+WIlwoJCQl2YXIgc2xpY2UgPSBbXSwgcmVzCgkJCWZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewoJCQkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04/IChyZXMgPSBjYihsaXN0W2ldLCBpLCBsaXN0KSkgIT0gdW5kZWZpbmVkICYmIHNsaWNlLnB1c2gocmVzKTogc2xpY2UucHVzaChsaXN0W2ldKQoJCQl9OyBsaXN0ID0gc2xpY2UKCQl9CgkJcmV0dXJuIGxpc3QKCX0pLAoJTmV4dDogc2h5KCLov63ku6PlmagiLCBmdW5jdGlvbihsaXN0LCBjYiwgY2JzKSB7CgkJc3dpdGNoICh0eXBlb2YgbGlzdCkgewoJCQljYXNlIGxhbmcuT0JKRUNUOiBpZiAobGlzdCA9PSBudWxsKSB7IGxpc3QgPSBbXTsgYnJlYWsgfQoJCQkJaWYgKGxpc3QubGVuZ3RoID09IHVuZGVmaW5lZCkgeyB2YXIgbHMgPSBbXTsgZm9yICh2YXIgayBpbiBsaXN0KSB7IGxzLnB1c2goaykgfSBsaXN0ID0gbHMgfSBicmVhawoJCQlkZWZhdWx0OiBpZiAobGlzdCA9PSB1bmRlZmluZWQpIHsgbGlzdCA9IFtdOyBicmVhayB9CgkJCQlsaXN0ID0gW2xpc3RdCgkJfQoKCQlmdW5jdGlvbiBuZXh0KGkpIHsgaSA8IGxpc3QubGVuZ3RoPyAgdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IobGlzdFtpXSwgZnVuY3Rpb24oKSB7IG5leHQoaSsxKSB9LCBpLCBsaXN0KToKCQkJCXR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnMobGlzdCkgfQoJCXJldHVybiBuZXh0KDApLCBsaXN0Cgl9KSwKCUl0ZW1zOiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKG9iaiwgY2IpIHsgdmFyIGxpc3QgPSBbXQoJCWZvciAodmFyIGsgaW4gb2JqKSB7CgkJCWxpc3QgPSBsaXN0LmNvbmNhdCh0aGlzLkxpc3Qob2JqW2tdLCBmdW5jdGlvbih2LCBpKSB7CgkJCQlyZXR1cm4gdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IodiwgaSwgaywgb2JqKQoJCQl9KSkKCQl9CgkJcmV0dXJuIGxpc3QKCX0pLAoJSXRlbVNvcnQ6IHNoeSgi6L+t5Luj5ZmoIiwgZnVuY3Rpb24ob2JqLCBrZXksIGNiKSB7IHZhciBsaXN0ID0gW10KCQl2YXIgb3JkZXIgPSBbXSwga2V5cyA9IHt9LCB2YWxzID0ge30sIGkgPSAwCgkJZm9yICh2YXIgayBpbiBvYmopIHsgbyA9IG9ialtrXVtrZXldfHxpKysKCQkJb3JkZXIucHVzaChvKSwga2V5c1tvXSA9IGssIHZhbHNbb10gPSBvYmpba10KCQl9OyBvcmRlci5zb3J0KCkKCgkJZm9yICh2YXIgaSBpbiBvcmRlcikgeyB2YXIgayA9IG9yZGVyW2ldCgkJCXZhciByZXMgPSB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTj8gY2Ioa2V5c1trXSwgdmFsc1trXSk6IGsKCQkJcmVzICE9IHVuZGVmaW5lZCAmJiBsaXN0LnB1c2gocmVzKQoJCX0KCQlyZXR1cm4gbGlzdAoJfSksCglJdGVtOiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKG9iaiwgY2IpIHsgdmFyIGxpc3QgPSBbXQoJCWZvciAodmFyIGsgaW4gb2JqKSB7CgkJCXZhciByZXMgPSB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTj8gY2Ioaywgb2JqW2tdKTogawoJCQlyZXMgIT0gdW5kZWZpbmVkICYmIGxpc3QucHVzaChyZXMpCgkJfQoJCXJldHVybiBsaXN0Cgl9KSwKCUl0ZW1DQjogc2h5KCLov63ku6PlmagiLCBmdW5jdGlvbihtZXRhLCBjYiwgY2FuLCBpdGVtKSB7IHZhciBsaXN0ID0gW10KCQlmb3IgKHZhciBrIGluIG1ldGEpIHsgKGZ1bmN0aW9uKGspIHsKCQkJaWYgKGsuaW5kZXhPZigib24iKSA9PSAwICYmIHR5cGVvZiBtZXRhW2tdID09IGxhbmcuRlVOQ1RJT04pIHsKCQkJCWlmICh0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTikgewoJCQkJCWNiKGssIG1ldGFba10pCgkJCQl9IGVsc2UgewoJCQkJCWNiW2tdID0gZnVuY3Rpb24oZXZlbnQpIHsgbWV0YVtrXShldmVudCwgY2FuLCBpdGVtKSB9CgkJCQl9CgkJCQlsaXN0LnB1c2goaykKCQkJfQoJCX0pKGspIH0KCQlyZXR1cm4gbGlzdAoJfSksCgoJU3BsaXRJbnB1dDogZnVuY3Rpb24oaXRlbSwgdHlwZSkgeyBpZiAodHlwZW9mIGl0ZW0gPT0gbGFuZy5PQkpFQ1QpIHsgcmV0dXJuIGl0ZW0gfQoJCXR5cGUgPSB0eXBlfHxodG1sLlRFWFQ7IHN3aXRjaCAoaXRlbSkgewoJCQljYXNlIG1kYi5MSVNUOiByZXR1cm4ge3R5cGU6IHR5cGUgPSBodG1sLkJVVFRPTiwgbmFtZTogaXRlbSwgYWN0aW9uOiBpY2UuQVVUT30KCQkJY2FzZSBjbGkuQkFDSzogcmV0dXJuIHt0eXBlOiB0eXBlID0gaHRtbC5CVVRUT04sIG5hbWU6IGl0ZW19CgkJCWNhc2UgbWRiLk5BTUU6IHJldHVybiB7dHlwZTogdHlwZSA9IGh0bWwuVEVYVCwgbmFtZTogaXRlbX0KCQkJY2FzZSBtZGIuVEVYVDogcmV0dXJuIHt0eXBlOiB0eXBlID0gaHRtbC5URVhUQVJFQSwgbmFtZTogaXRlbX0KCQkJZGVmYXVsdDogdmFyIGxzID0gdGhpcy5TcGxpdChpdGVtLCAiICIsICI6PUAiKSwgcmVzID0ge3R5cGU6IHR5cGUsIG5hbWU6IGxzWzBdfTsgZm9yICh2YXIgaSA9IDE7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgewoJCQkJCXN3aXRjaCAobHNbaV0pIHsKCQkJCQkJY2FzZSAiOiI6IHJlc1ttZGIuVFlQRV0gPSBsc1tpKzFdOyBicmVhawoJCQkJCQljYXNlICI9IjoKCQkJCQkJCWlmIChyZXNbbWRiLlRZUEVdID09IGh0bWwuU0VMRUNUKSB7CgkJCQkJCQkJcmVzLnZhbHVlcyA9IHRoaXMuU3BsaXQobHNbaSsxXSkKCQkJCQkJCQlmb3IgKHZhciBqID0gMTsgaiA8IHJlcy52YWx1ZXMubGVuZ3RoOyBqKyspIHsKCQkJCQkJCQkJaWYgKHJlcy52YWx1ZXNbMF0gPT0gIiIgfHwgcmVzLnZhbHVlc1swXSA9PSByZXMudmFsdWVzW2pdKSB7CgkJCQkJCQkJCQlyZXMudmFsdWUgPSByZXMudmFsdWVzWzBdLCByZXMudmFsdWVzID0gcmVzLnZhbHVlcy5zbGljZSgxKQoJCQkJCQkJCQkJYnJlYWsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJcmVzLnZhbHVlID0gbHNbaSsxXQoJCQkJCQkJfQoJCQkJCQkJYnJlYWsKCQkJCQkJY2FzZSAiQCI6IHJlc1tjdHguQUNUSU9OXSA9IGxzW2krMV07IGJyZWFrCgkJCQkJfQoJCQkJfSByZXR1cm4gcmVzCgkJfQoJfSwKCVRpbWVyMzAwbXM6IGZ1bmN0aW9uKGNiKSB7IHRoaXMuVGltZXIoMzAwLCBjYikgfSwKCVRpbWVyMzAwOiBmdW5jdGlvbihjYikgeyB0aGlzLlRpbWVyKDMwMCwgY2IpIH0sCglUaW1lcjNzOiBmdW5jdGlvbihjYikgeyB0aGlzLlRpbWVyKDMwMDAsIGNiKSB9LAoJVGltZXI6IHNoeSgi5a6a5pe25ZmoLCB2YWx1ZSwgWzEsMiwzLDRdLCB7aW50ZXJ2YWwsIGxlbmd0aH0iLCBmdW5jdGlvbihpbnRlcnZhbCwgY2IsIGNicykgewoJCXZhciB0aW1lciA9IHtzdG9wOiBmYWxzZX07IGZ1bmN0aW9uIGxvb3AoaSkgewoJCQl0aW1lci5zdG9wIHx8IGkgPj0gaW50ZXJ2YWwubGVuZ3RoICYmIGludGVydmFsLmxlbmd0aCA+PSAwIHx8IGNiKHRpbWVyLCBpbnRlcnZhbC5pbnRlcnZhbHx8aW50ZXJ2YWxbaV0sIGksIGludGVydmFsKT8KCQkJCXR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnModGltZXIsIGludGVydmFsKTogc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcChpKzEpIH0sIGludGVydmFsLmludGVydmFsfHxpbnRlcnZhbFtpKzFdKQoJCX0KCgkJaW50ZXJ2YWwgPSB0eXBlb2YgaW50ZXJ2YWwgPT0gbGFuZy5PQkpFQ1Q/IGludGVydmFsOiBbaW50ZXJ2YWxdCgkJaWYgKGludGVydmFsLmludGVydmFsID09IDApIHsgY2IoKTsgcmV0dXJuIHRpbWVyIH0KCgkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcCgwKSB9LCBpbnRlcnZhbC5pbnRlcnZhbHx8aW50ZXJ2YWxbMF0pCgkJcmV0dXJuIHRpbWVyCgl9KSwKfSkKCgpfY2FuX25hbWUgPSAiL2xpYi9wYWdlLmpzIgpWb2xjYW5vcygicGFnZSIsIHtoZWxwOiAi55So5oi355WM6Z2iIiwgQ2xhc3NMaXN0OiB7CgkJaGFzOiBmdW5jdGlvbihjYW4sIG9iaiwga2V5KSB7IHZhciBsaXN0ID0gb2JqLmNsYXNzTmFtZT8gb2JqLmNsYXNzTmFtZS5zcGxpdChpY2UuU1ApOiBbXQoJCQlyZXR1cm4gbGlzdC5pbmRleE9mKGtleSkgPiAtMQoJCX0sCgkJYWRkOiBmdW5jdGlvbihjYW4sIG9iaiwga2V5KSB7IHZhciBsaXN0ID0gb2JqLmNsYXNzTmFtZT8gb2JqLmNsYXNzTmFtZS5zcGxpdChpY2UuU1ApOiBbXQoJCQl2YXIgdmFsdWUgPSBjYW4uYmFzZS5BZGRVbmlxKGxpc3QsIGtleSkuam9pbihpY2UuU1ApLnRyaW0oKQoJCQlyZXR1cm4gdmFsdWUgIT0gb2JqLmNsYXNzTmFtZSAmJiAob2JqLmNsYXNzTmFtZSA9IHZhbHVlKSwgdmFsdWUKCQl9LAoJCWRlbDogZnVuY3Rpb24oY2FuLCBvYmosIGtleSkgeyB2YXIgbGlzdCA9IG9iai5jbGFzc05hbWU/IG9iai5jbGFzc05hbWUuc3BsaXQoaWNlLlNQKTogW10KCQkJcmV0dXJuIG9iai5jbGFzc05hbWUgPSBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZSA9PSBrZXk/IHVuZGVmaW5lZDogdmFsdWUgfSkuam9pbihpY2UuU1ApLnRyaW0oKQoJCX0sCgkJc2V0OiBmdW5jdGlvbihjYW4sIG9iaiwga2V5LCBjb25kaXRpb24pIHsKCQkJcmV0dXJuIChjb25kaXRpb24/IHRoaXMuYWRkKGNhbiwgb2JqLCBrZXkpOiB0aGlzLmRlbChjYW4sIG9iaiwga2V5KSkuaW5kZXhPZihrZXkpID4gLTEKCQl9LAoJCW5lZzogZnVuY3Rpb24oY2FuLCBvYmosIGtleSkgewoJCQlyZXR1cm4gKHRoaXMuaGFzKGNhbiwgb2JqLCBrZXkpPyB0aGlzLmRlbChjYW4sIG9iaiwga2V5KTogdGhpcy5hZGQoY2FuLCBvYmosIGtleSkpLmluZGV4T2Yoa2V5KSA+IC0xCgkJfSwKCX0sCglTZWxlY3RBcmdzOiBmdW5jdGlvbihjYW4sIG9wdGlvbiwga2V5LCBjYikgewoJCWlmIChjYW4uYmFzZS5pc1VuZGVmaW5lZChrZXkpKSB7IHZhciB2YWx1ZSA9IHt9CgkJCWNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBvcHRpb24sICIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCQlpdGVtLm5hbWUgJiYgaXRlbS52YWx1ZSAmJiAodmFsdWVbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWUpCgkJCX0pOyByZXR1cm4gW3ZhbHVlXQoJCX0KCQlpZiAoY2FuLmJhc2UuaXNPYmplY3Qoa2V5KSkgewoJCQlyZXR1cm4gY2FuLmNvcmUuSXRlbShrZXksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIG9wdGlvbiwga2V5LCB2YWx1ZSkgfSksIFtrZXldCgkJfQoJCWlmICghY2FuLmJhc2UuaXNGdW5jKGNiKSkgeyB2YXIgdmFsdWUgPSBjYjsgY2IgPSBmdW5jdGlvbihpdGVtKSB7IGlmIChpdGVtLnR5cGUgPT0gaHRtbC5CVVRUT04pIHsgcmV0dXJuIH0KCQkJcmV0dXJuIGl0ZW0ubmFtZSAmJiAoY2FuLmJhc2UuaXNVbmRlZmluZWQodmFsdWUpPyBpdGVtLnZhbHVlOiAoaXRlbS52YWx1ZSA9IHZhbHVlKSl8fCIiCgkJfSB9CgkJaWYgKGtleS5pbmRleE9mKGljZS5QVCkgPiAtMSkgeyByZXR1cm4gWyIiXX0KCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgb3B0aW9uLCBrZXk/ICJ0ZXh0YXJlYVtuYW1lPSIra2V5KyJdLCIrImlucHV0W25hbWU9IitrZXkrIl0sIisic2VsZWN0W25hbWU9IitrZXkrIl0iOiAiLmFyZ3MiLCBjYikKCX0sCglTZWxlY3RBbGw6IHNoeSgi6YCJ5oup6IqC54K5IiwgZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGtleSwgY2IsIGludGVydmFsLCBjYnMpIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuSUZSQU1FLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLlNlbGVjdEFsbChjYW4sIGl0ZW0uY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5LCBrZXksIGNiLCBpbnRlcnZhbCwgY2JzKQoJCX0pCgkJcmV0dXJuIGNhbi5jb3JlLkxpc3QodGFyZ2V0ICYmIHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKGtleSksIGNiLCBpbnRlcnZhbCwgY2JzKQoJfSksCglTZWxlY3Q6IHNoeSgi6YCJ5oup6IqC54K5IiwgZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGtleSwgY2IsIGludGVydmFsLCBjYnMpIHsgaWYgKGtleSA9PSBpY2UuUFQpIHsgY2IodGFyZ2V0KTsgcmV0dXJuIFtdIH0KCQlyZXR1cm4gY2FuLmNvcmUuTGlzdCh0YXJnZXQgJiYgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoY2FuLnBhZ2UuS2V5cyhrZXkpKSwgY2IsIGludGVydmFsLCBjYnMpCgl9KSwKCU1vZGlmeTogc2h5KCLkv67mlLnoioLngrkiLCBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsgdGFyZ2V0ID0gdGFyZ2V0fHx7fQoJCXRhcmdldCA9IGNhbi5iYXNlLmlzT2JqZWN0KHRhcmdldCk/IHRhcmdldDogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpOyBpZiAoIXRhcmdldCkgeyByZXR1cm4gfQoJCWNhbi5iYXNlLmlzU3RyaW5nKHZhbHVlKT8gKHRhcmdldC5pbm5lckhUTUwgPSB2YWx1ZSk6IGNhbi5jb3JlLkl0ZW0odmFsdWUsIGZ1bmN0aW9uKGtleSwgdmFsKSB7CgkJCWtleSA9PSAiY2xhc3NOYW1lIiAmJiBjYW4uYmFzZS5pc0FycmF5KHZhbCkgJiYgKHZhbCA9IHZhbC5qb2luKGljZS5TUCkpCgkJCSFjYW4uYmFzZS5pc09iamVjdCh2YWwpPyAodGFyZ2V0W2tleV0gPSB2YWwpOiBjYW4uY29yZS5JdGVtKHZhbCwgZnVuY3Rpb24oaywgdikgewoJCQkJdmFyIHNpemUgPSB7CgkJCQkJImhlaWdodCI6IHRydWUsICJtYXgtaGVpZ2h0IjogdHJ1ZSwgIm1pbi1oZWlnaHQiOiB0cnVlLAoJCQkJCSJ3aWR0aCI6IHRydWUsICJtYXgtd2lkdGgiOiB0cnVlLCAibWluLXdpZHRoIjogdHJ1ZSwKCQkJCX0KCQkJCWlmIChzaXplW2tdICYmIHBhcnNlSW50KHYpIDwgMCkgeyByZXR1cm4gdGFyZ2V0W2tleV0gJiYgKHRhcmdldFtrZXldW2tdID0gIiIpIH0KCgkJCQl2YXIgc2l6ZSA9IHsKCQkJCQkibWFyZ2luLXRvcCI6IHRydWUsICJtYXJnaW4tbGVmdCI6IHRydWUsICJmb250LXNpemUiOiB0cnVlLAoJCQkJCSJsZWZ0IjogdHJ1ZSwgInJpZ2h0IjogdHJ1ZSwgInRvcCI6IHRydWUsICJib3R0b20iOiB0cnVlLAoJCQkJCSJoZWlnaHQiOiB0cnVlLCAibWF4LWhlaWdodCI6IHRydWUsICJtaW4taGVpZ2h0IjogdHJ1ZSwKCQkJCQkid2lkdGgiOiB0cnVlLCAibWF4LXdpZHRoIjogdHJ1ZSwgIm1pbi13aWR0aCI6IHRydWUsCgkJCQl9CgoJCQkJaWYgKHNpemVba10gJiYgdiAmJiAoY2FuLmJhc2UuaXNOdW1iZXIodikgfHwgdi5pbmRleE9mICYmIHYuaW5kZXhPZigicHgiKSA9PSAtMSkpIHsgdiArPSAicHgiIH0KCQkJCXRhcmdldFtrZXldICYmICh0YXJnZXRba2V5XVtrXSA9IHYpCgkJCX0pCgkJfSkKCQlyZXR1cm4gdGFyZ2V0Cgl9KSwKCVJlbW92ZTogc2h5KCLliKDpmaToioLngrkiLCBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCXJldHVybiB0YXJnZXQgJiYgdGFyZ2V0LnBhcmVudE5vZGUgJiYgdGFyZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGFyZ2V0KSwgdGFyZ2V0Cgl9KSwKCUNyZWF0ZTogc2h5KCLliJvlu7roioLngrkiLCBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChrZXkpLCB2YWx1ZSkKCX0pLAoJQXBwZW5kOiBzaHkoIua3u+WKoOiKgueCuSIsIGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBrZXksIHZhbHVlKSB7IHZhbHVlID0gdmFsdWV8fHt9CgkJaWYgKGNhbi5iYXNlLmlzU3RyaW5nKGtleSkpIHsgdmFyIHJlcyA9IGNhbi5wYWdlLkNyZWF0ZShjYW4sIGtleSwgdmFsdWUpOyByZXR1cm4gdGFyZ2V0LmFwcGVuZENoaWxkKHJlcyksIHJlcyB9CgoJCWNhbi5jb3JlLkxpc3Qoa2V5LCBmdW5jdGlvbihpdGVtLCBpbmRleCkgeyBpZiAoIWl0ZW0pIHsgcmV0dXJuIH0KCQkJaWYgKGNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pKSB7IHRhcmdldC5pbm5lckhUTUwgPSBpdGVtOyByZXR1cm4gfQoJCQlpZiAoaXRlbS5ub2RlTmFtZSkgeyB0YXJnZXQuYXBwZW5kQ2hpbGQoaXRlbSk7IHJldHVybiB9CgoJCQkvLyDln7rmnKznu5PmnoQ6IHR5cGUgbmFtZSBkYXRhIGxpc3QKCQkJdmFyIHR5cGUgPSBpdGVtLnR5cGV8fGh0bWwuRElWLCBkYXRhID0gaXRlbS5kYXRhfHx7fQoJCQl2YXIgbmFtZSA9IGl0ZW0ubmFtZXx8ZGF0YS5uYW1lfHwiIgoKCQkJLy8g5pWw5o2u6LCD5pW0CgkJCWNhbi5jb3JlLkl0ZW0oaXRlbSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewoJCQkJc3dpdGNoIChrZXkpIHsKCQkJCQljYXNlIG1kYi5UWVBFOiBicmVhawoJCQkJCWNhc2UgbWRiLk5BTUU6IGJyZWFrCgkJCQkJY2FzZSBtZGIuREFUQTogYnJlYWsKCQkJCQljYXNlIG1kYi5MSVNUOiBicmVhawoJCQkJCWNhc2UgaHRtbC5JTk5FUjogZGF0YS5pbm5lckhUTUwgPSBpdGVtLmlubmVyOyBicmVhawoJCQkJCWNhc2UgaHRtbC5DTElDSzogZGF0YS5vbmNsaWNrID0gaXRlbS5jbGljazsgYnJlYWsKCQkJCQlkZWZhdWx0OiBkYXRhW2tleV0gPSBpdGVtW2tleV0KCQkJCX0KCQkJfSkKCgkJCS8vIOWfuuacrOexu+WeizogdmlldyB0ZXh0IGJ1dHRvbiBzZWxlY3QgaW5wdXQgdXNlcm5hbWUgcGFzc3dvcmQKCQkJLy8g5Z+65pys57G75Z6LOiBpbWcgcm93IHRoIHRkCgkJCWlmIChpdGVtLnZpZXcpIHsgdmFyIGxpc3QgPSBjYW4uY29yZS5MaXN0KGl0ZW0udmlldykKCQkJCWlmIChjYW4uYmFzZS5pc0FycmF5KGxpc3RbMF0pKSB7IGxpc3RbMF0gPSBsaXN0WzBdLmpvaW4oaWNlLlNQKSB9CgkJCQlsaXN0WzBdICYmIGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBkYXRhLCBsaXN0WzBdKQoJCQkJdHlwZSA9IGxpc3RbMV18fGh0bWwuRElWCgkJCQlkYXRhLmlubmVySFRNTCA9IGxpc3RbMl18fGRhdGEuaW5uZXJIVE1MfHwiIgoJCQkJbmFtZSA9IG5hbWV8fGxpc3RbM118fCIiCgoJCQl9IGVsc2UgaWYgKGl0ZW0udGV4dCkgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS50ZXh0KQoJCQkJZGF0YS5pbm5lckhUTUwgPSBsaXN0WzBdfHxkYXRhLmlubmVySFRNTHx8IiIKCQkJCXR5cGUgPSBsaXN0WzFdfHxodG1sLlNQQU4KCQkJCWxpc3RbMl0gJiYgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGRhdGEsIGxpc3RbMl0pCgoJCQl9IGVsc2UgaWYgKGl0ZW0uYnV0dG9uKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLmJ1dHRvbikKCQkJCXR5cGUgPSBodG1sLkJVVFRPTiwgbmFtZSA9IG5hbWV8fGxpc3RbMF0KCQkJCWRhdGEuaW5uZXJUZXh0ID0gY2FuLnVzZXIudHJhbnMoY2FuLCBsaXN0WzBdKSwgZGF0YS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmN0aW9uKGxpc3RbMV0pICYmIGxpc3RbMV0oZXZlbnQsIG5hbWUpCgkJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCQkJcmV0dXJuIHRydWUKCQkJCX0KCgkJCX0gZWxzZSBpZiAoaXRlbS5zZWxlY3QpIHsgdmFyIGxpc3QgPSBpdGVtLnNlbGVjdAoJCQkJdHlwZSA9IGh0bWwuU0VMRUNULCBkYXRhLm5hbWUgPSBuYW1lID0gbmFtZXx8bGlzdFswXVswXQoJCQkJZGF0YS50aXRsZSA9IGNhbi51c2VyLnRyYW5zKGNhbiwgZGF0YS50aXRsZXx8bmFtZSkKCQkJCWRhdGEuY2xhc3NOYW1lID0gZGF0YS5jbGFzc05hbWV8fGxpc3RbMF1bMF18fCIiCgoJCQkJaXRlbS5saXN0ID0gbGlzdFswXS5zbGljZSgxKS5tYXAoZnVuY3Rpb24odmFsdWUpIHsKCQkJCQlyZXR1cm4ge3R5cGU6IGh0bWwuT1BUSU9OLCB2YWx1ZTogdmFsdWUsIGlubmVyOiBjYW4udXNlci50cmFucyhjYW4sIHZhbHVlKX0KCQkJCX0pCgkJCQlkYXRhLm9uY2hhbmdlID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmN0aW9uKGxpc3RbMV0pICYmIGxpc3RbMV0oZXZlbnQsIGV2ZW50LnRhcmdldC52YWx1ZSwgbmFtZSkKCQkJCX0KCgkJCX0gZWxzZSBpZiAoaXRlbS5pbnB1dCkgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS5pbnB1dCkKCQkJCXR5cGUgPSBodG1sLklOUFVULCBuYW1lID0gbmFtZXx8bGlzdFswXXx8IiIsIGRhdGEubmFtZSA9IGRhdGEubmFtZXx8bmFtZQoJCQkJZGF0YS5jbGFzc05hbWUgPSBkYXRhLmNsYXNzTmFtZXx8ZGF0YS5uYW1lCgkJCQlkYXRhLmF1dG9jb21wbGV0ZSA9ICJvZmYiCgoJCQkJZGF0YS5vbmZvY3VzID0gZGF0YS5vbmZvY3VzfHxmdW5jdGlvbihldmVudCkgewoJCQkJCWV2ZW50LnRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZSgwLCAtMSkKCQkJCX0KCQkJCWRhdGEub25rZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmN0aW9uKGxpc3RbMV0pICYmIGxpc3RbMV0oZXZlbnQpCgkJCQl9CgkJCQlkYXRhLm9ua2V5dXAgPSBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5iYXNlLmlzRnVuY3Rpb24obGlzdFsyXSkgJiYgbGlzdFsyXShldmVudCkKCQkJCX0KCQkJfSBlbHNlIGlmIChpdGVtLnVzZXJuYW1lKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLnVzZXJuYW1lKQoJCQkJdHlwZSA9IGh0bWwuSU5QVVQsIG5hbWUgPSBuYW1lfHxsaXN0WzBdfHxodG1sLlVTRVJOQU1FLCBkYXRhLm5hbWUgPSBkYXRhLm5hbWV8fG5hbWUKCQkJCWRhdGEuY2xhc3NOYW1lID0gbGlzdFsxXXx8ZGF0YS5jbGFzc05hbWV8fGRhdGEubmFtZQoJCQkJZGF0YS5hdXRvY29tcGxldGUgPSBkYXRhLmF1dG9jb21wbGV0ZXx8aHRtbC5VU0VSTkFNRQoKCQkJfSBlbHNlIGlmIChpdGVtLnBhc3N3b3JkKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLnBhc3N3b3JkKQoJCQkJdHlwZSA9IGh0bWwuSU5QVVQsIG5hbWUgPSBuYW1lfHxsaXN0WzBdfHxodG1sLlBBU1NXT1JELCBkYXRhLm5hbWUgPSBkYXRhLm5hbWV8fG5hbWUKCQkJCWRhdGEuY2xhc3NOYW1lID0gbGlzdFsxXXx8ZGF0YS5jbGFzc05hbWV8fGRhdGEubmFtZQoJCQkJZGF0YS5hdXRvY29tcGxldGUgPSBkYXRhLmF1dG9jb21wbGV0ZXx8ImN1cnJlbnQtcGFzc3dvcmQiCgkJCQlkYXRhLnR5cGUgPSBodG1sLlBBU1NXT1JECgoJCQl9IGVsc2UgaWYgKGl0ZW0uaW1nKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLmltZykKCQkJCXR5cGUgPSBodG1sLklNRywgZGF0YS5zcmMgPSBsaXN0WzBdCgoJCQl9IGVsc2UgaWYgKGl0ZW0ucm93KSB7IHR5cGUgPSBodG1sLlRSCgkJCQlpdGVtLmxpc3QgPSBpdGVtLnJvdy5tYXAoZnVuY3Rpb24odGV4dCkgeyByZXR1cm4ge3RleHQ6IFt0ZXh0LCBpdGVtLnN1Ynx8aHRtbC5URF19IH0pCgkJCX0gZWxzZSBpZiAoaXRlbS50aCkgeyB0eXBlID0gaHRtbC5UUgoJCQkJaXRlbS5saXN0ID0gaXRlbS50aC5tYXAoZnVuY3Rpb24odGV4dCkgeyByZXR1cm4ge3RleHQ6IFt0ZXh0LCBodG1sLlRIXX0gfSkKCQkJfSBlbHNlIGlmIChpdGVtLnRkKSB7IHR5cGUgPSBodG1sLlRSCgkJCQlpdGVtLmxpc3QgPSBpdGVtLnRkLm1hcChmdW5jdGlvbih0ZXh0KSB7IHJldHVybiB7dGV4dDogW3RleHQsIGh0bWwuVERdfSB9KQoJCQl9CgoJCQkvLyDor63oqIDovazmjaIKCQkJaWYgKHR5cGUgPT0gaHRtbC5JTlBVVCkgIHsgZGF0YS50eXBlID09IGh0bWwuQlVUVE9OICYmIChkYXRhLnZhbHVlID0gY2FuLnVzZXIudHJhbnMoY2FuLCBkYXRhLnZhbHVlKSkKCQkJCWlmIChkYXRhLnR5cGUgPT0gaHRtbC5URVhUfHxkYXRhLnR5cGUgPT0gaHRtbC5QQVNTV09SRHx8IWRhdGEudHlwZSkgeyBkYXRhLmF1dG9jb21wbGV0ZSA9IGRhdGEuYXV0b2NvbXBsZXRlfHwib2ZmIgoJCQkJCS8vIGRhdGEucGxhY2Vob2xkZXIgPSBjYW4udXNlci50cmFucyhjYW4sIChkYXRhLnBsYWNlaG9sZGVyfHxkYXRhLm5hbWV8fCIiKS5zcGxpdChpY2UuUFQpLnBvcCgpKQoJCQkJCWRhdGEucGxhY2Vob2xkZXIgPSAoZGF0YS5wbGFjZWhvbGRlcnx8ZGF0YS5uYW1lfHwiIikuc3BsaXQoaWNlLlBUKS5wb3AoKQoJCQkJCWRhdGEudGl0bGUgPSBjYW4udXNlci50cmFucyhjYW4sIGRhdGEudGl0bGV8fGRhdGEucGxhY2Vob2xkZXIpCgkJCQl9CgkJCX0KCQkJaWYgKHR5cGUgPT0gaHRtbC5URVhUQVJFQSkgIHsKCQkJCWRhdGEucGxhY2Vob2xkZXIgPSBjYW4udXNlci50cmFucyhjYW4sIChkYXRhLnBsYWNlaG9sZGVyfHxkYXRhLm5hbWV8fCIiKS5zcGxpdChpY2UuUFQpLnBvcCgpKQoJCQl9CgoJCQkvLyDliJvlu7roioLngrkKCQkJIWRhdGEubmFtZSAmJiBpdGVtLm5hbWUgJiYgKGRhdGEubmFtZSA9IGl0ZW0ubmFtZSkKCQkJdmFyIG5vZGUgPSBjYW4ucGFnZS5DcmVhdGUoY2FuLCB0eXBlLCBkYXRhKQoKCQkJLy8g5Yib5bu657Si5byVCgkJCW5hbWUgPSBuYW1lfHxkYXRhLmNsYXNzTmFtZXx8dHlwZXx8IiIKCQkJdmFsdWVbbmFtZXx8IiJdID0gdmFsdWVbZGF0YS5jbGFzc05hbWV8fCIiXSA9IHZhbHVlW3R5cGVdID0gbm9kZQoJCQl2YWx1ZS5maXJzdCA9IHZhbHVlLmZpcnN0fHxub2RlLCB2YWx1ZS5sYXN0ID0gbm9kZQoJCQl2YWx1ZS5fdGFyZ2V0ID0gdmFsdWUuX3RhcmdldHx8bm9kZQoKCQkJLy8g6YCS5b2S6IqC54K5CgkJCWl0ZW0ubGlzdCAmJiBjYW4ucGFnZS5BcHBlbmQoY2FuLCBub2RlLCBpdGVtLmxpc3QsIHZhbHVlKQoJCQl0YXJnZXQgJiYgdGFyZ2V0LmFwcGVuZENoaWxkICYmIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKQoJCQljYW4uYmFzZS5pc0Z1bmMoaXRlbS5faW5pdCkgJiYgaXRlbS5faW5pdChub2RlLCB2YWx1ZSkKCQl9KQoJCXJldHVybiB2YWx1ZQoJfSksCglBcHBlbmRzOiBzaHkoIua3u+WKoOiKgueCuSIsIGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBrZXksIHZhbHVlKSB7CgkJcmV0dXJuIHRhcmdldC5pbm5lckhUTUwgPSAiIiwgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBrZXksIHZhbHVlKQoJfSksCgoJQXBwZW5kVGFibGU6IHNoeSgi5re75Yqg6KGo5qC8IiwgZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCwgbGlzdCwgY2IpIHsKCQlpZiAoIW1zZy5hcHBlbmR8fG1zZy5hcHBlbmQubGVuZ3RoID09IDApIHtyZXR1cm59CgoJCXZhciB0YWJsZSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgaHRtbC5UQUJMRSkKCQl2YXIgdGhlYWQgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YWJsZSwgInRoZWFkIikKCQl2YXIgdGJvZHkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YWJsZSwgInRib2R5IikKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0aGVhZCwgW3t0eXBlOiBodG1sLlRSLCBkYXRhOiB7ZGF0YXNldDoge2luZGV4OiAtMX19LCBsaXN0OiAKCQkJY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihrZXkpIHsKCQkJCXJldHVybiBrZXlbMF0gPT0gIl8iPyB1bmRlZmluZWQ6IHt0ZXh0OiBba2V5LnRyaW0oKSwgaHRtbC5USF19CgkJCX0pCgkJfV0pCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGJvZHksIGNhbi5jb3JlLkxpc3QobXNnLlRhYmxlKCksIGZ1bmN0aW9uKGxpbmUsIGluZGV4LCBhcnJheSkgewoJCQl2YXIgX2xpc3QgPSBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGtleSkgeyBpZiAoa2V5LmluZGV4T2YoIl8iKSA9PSAwKSB7IHJldHVybiB9CgkJCQlyZXR1cm4gY2IoY2FuLnBhZ2UuQ29sb3IobGluZVtrZXldKS50cmltKCksIGtleSwgaW5kZXgsIGxpbmUsIGFycmF5KQoJCQl9KQoJCQlyZXR1cm4gX2xpc3QubGVuZ3RoID4gMD8ge3R5cGU6IGh0bWwuVFIsIGRhdGFzZXQ6IHtpbmRleDogaW5kZXh9LCBsaXN0OiBfbGlzdH06IHVuZGVmaW5lZAoJCX0pKQoJCXJldHVybiBjYW4ucGFnZS5PcmRlclRhYmxlKGNhbiwgdGFibGUpCgl9KSwKCU9yZGVyVGFibGU6IGZ1bmN0aW9uKGNhbiwgdGFibGUpIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YWJsZSwgaHRtbC5USCwgZnVuY3Rpb24odGgsIGluZGV4KSB7CgkJCXRoLm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgeyB2YXIgZGF0YXNldCA9IGV2ZW50LnRhcmdldC5kYXRhc2V0CgkJCQlkYXRhc2V0WyJzb3J0X2FzYyJdID0gKGRhdGFzZXRbInNvcnRfYXNjIl0gPT0gIjEiKSA/IDA6IDEKCQkJCWNhbi5wYWdlLlJhbmdlVGFibGUoY2FuLCB0YWJsZSwgaW5kZXgsIGRhdGFzZXRbInNvcnRfYXNjIl0gPT0gIjEiKQoJCQl9CgkJfSkKCQlyZXR1cm4gdGFibGUKCX0sCglSYW5nZVRhYmxlOiBmdW5jdGlvbihjYW4sIHRhYmxlLCBpbmRleCwgc29ydF9hc2MpIHsKCQl2YXIgbGlzdCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhYmxlLCBodG1sLlRSLCBmdW5jdGlvbih0cikgewoJCQlyZXR1cm4gdHIuc3R5bGUuZGlzcGxheSA9PSBodG1sLk5PTkV8fGNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgImhpZGUiKT8gbnVsbDogdHIKCQl9KS5zbGljZSgxKQoKCQlpbmRleCA9IGNhbi5iYXNlLmlzT2JqZWN0KGluZGV4KT8gaW5kZXg6IFtpbmRleF0KCQlpbmRleCA9IGNhbi5jb3JlLkxpc3QoaW5kZXgsIGZ1bmN0aW9uKGl0ZW0pIHsgaWYgKGl0ZW0gPiAtMSkgeyByZXR1cm4gaXRlbX0gfSkKCQlpZiAoaW5kZXgubGVuZ3RoID09IDApIHsgcmV0dXJuIH0KCgkJdmFyIGlzX3RpbWUgPSB0cnVlLCBpc19udW1iZXIgPSB0cnVlCgkJY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbih0cikgewoJCQl2YXIgdGV4dCA9IHRyLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dAoJCQlpc190aW1lID0gaXNfdGltZSAmJiBEYXRlLnBhcnNlKHRleHQpID4gMAoJCQlpc19udW1iZXIgPSBpc19udW1iZXIgJiYgIWlzTmFOKHBhcnNlSW50KHRleHQpKQoJCX0pCgoJCXZhciBudW1fbGlzdCA9IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24odHIpIHsKCQkJdmFyIHRleHQgPSB0ci5jaGlsZE5vZGVzW2luZGV4WzBdXS5pbm5lclRleHQKCQkJcmV0dXJuIGlzX3RpbWU/IERhdGUucGFyc2UodGV4dCk6CgkJCQlpc19udW1iZXI/IGNhbi5iYXNlLlBhcnNlU2l6ZSh0ZXh0KTogdGV4dAoJCX0pCgkJZnVuY3Rpb24gaXNsZXNzKGEsIGIsIGluZGV4KSB7CgkJCWlmIChhLmNoaWxkTm9kZXNbaW5kZXhbMF1dICYmIGIuY2hpbGROb2Rlc1tpbmRleFswXV0pIHsKCQkJCWlmIChhLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dCA8IGIuY2hpbGROb2Rlc1tpbmRleFswXV0uaW5uZXJUZXh0KSB7IHJldHVybiB0cnVlIH0KCQkJCWlmIChhLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dCA+IGIuY2hpbGROb2Rlc1tpbmRleFswXV0uaW5uZXJUZXh0KSB7IHJldHVybiBmYWxzZSB9CgkJCX0KCQkJcmV0dXJuIGluZGV4Lmxlbmd0aCA+IDEgJiYgaXNsZXNzKGEsIGIsIGluZGV4LnNsaWNlKDEpKQoJCX0KCgkJLy8g6YCJ5oup5o6S5bqPCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBudW1fbGlzdC5sZW5ndGg7IGkrKykgeyB2YXIgbWluID0gaQoJCQlmb3IgKHZhciBqID0gaSsxOyBqIDwgbnVtX2xpc3QubGVuZ3RoOyBqKyspIHsKCQkJCWlmIChudW1fbGlzdFttaW5dID09IG51bV9saXN0W2pdICYmIGluZGV4Lmxlbmd0aCA+IDEgJiYgbGlzdFtpbmRleFsxXV0pIHsKCQkJCQlpZiAoc29ydF9hc2M/IGlzbGVzcyhsaXN0W21pbl0sIGxpc3Rbal0sIGluZGV4LnNsaWNlKDEpKTogaXNsZXNzKGxpc3Rbal0sIGxpc3RbbWluXSwgaW5kZXguc2xpY2UoMSkpKSB7CgkJCQkJCW1pbiA9IGoKCQkJCQl9CgkJCQl9IGVsc2UgaWYgKHNvcnRfYXNjPyBudW1fbGlzdFttaW5dIDwgbnVtX2xpc3Rbal06IG51bV9saXN0W2pdIDwgbnVtX2xpc3RbbWluXSkgewoJCQkJCW1pbiA9IGoKCQkJCX0KCQkJfQoKCQkJaWYgKG1pbiAhPSBpKSB7CgkJCQl2YXIgdGVtcCA9IG51bV9saXN0W2ldOyBudW1fbGlzdFtpXSA9IG51bV9saXN0W21pbl07IG51bV9saXN0W21pbl0gPSB0ZW1wCgkJCQl2YXIgdGVtcCA9IGxpc3RbaV07IGxpc3RbaV0gPSBsaXN0W21pbl07IGxpc3RbbWluXSA9IHRlbXAKCQkJfQoKCQkJdmFyIHRib2R5ID0gbGlzdFtpXS5wYXJlbnRFbGVtZW50CgkJCWxpc3RbaV0ucGFyZW50RWxlbWVudCAmJiB0Ym9keS5yZW1vdmVDaGlsZChsaXN0W2ldKQoJCQl0Ym9keS5hcHBlbmRDaGlsZChsaXN0W2ldKQoJCX0KCX0sCgoJQ2FjaGU6IGZ1bmN0aW9uKG5hbWUsIG91dHB1dCwgZGF0YSkgeyBpZiAoIW5hbWUpIHsgcmV0dXJuIH0KCQl2YXIgY2FjaGUgPSBvdXRwdXQuX2NhY2hlfHx7fTsgb3V0cHV0Ll9jYWNoZSA9IGNhY2hlCgkJaWYgKGRhdGEpIHsgaWYgKG91dHB1dC5jaGlsZHJlbi5sZW5ndGggPT0gMCkgeyByZXR1cm4gfQoJCQl2YXIgdGVtcCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKQoJCQl3aGlsZSAob3V0cHV0LmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyAvLyDlhpnnvJPlrZgKCQkJCXZhciBpdGVtID0gb3V0cHV0LmNoaWxkTm9kZXNbMF0KCQkJCWl0ZW0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpdGVtKSwKCQkJCQl0ZW1wLmFwcGVuZENoaWxkKGl0ZW0pCgkJCX0KCQkJcmV0dXJuIGNhY2hlW25hbWVdID0ge25vZGU6IHRlbXAsIGRhdGE6IGRhdGF9LCBuYW1lCgkJfQoJCW91dHB1dC5pbm5lckhUTUwgPSAiIgoKCQl2YXIgbGlzdCA9IGNhY2hlW25hbWVdOyBpZiAoIWxpc3QpIHsgcmV0dXJuIH0KCQl3aGlsZSAobGlzdC5ub2RlLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyAvLyDor7vnvJPlrZgKCQkJdmFyIGl0ZW0gPSBsaXN0Lm5vZGUuY2hpbGROb2Rlc1swXQoJCQlpdGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaXRlbSkKCQkJb3V0cHV0LmFwcGVuZENoaWxkKGl0ZW0pCgkJfQoJCXJldHVybiBkZWxldGUoY2FjaGVbbmFtZV0pLCBsaXN0LmRhdGEKCX0sCglGb3JtYXQ6IGZ1bmN0aW9uKHR5cGUpIHsKCQlzd2l0Y2ggKHR5cGUpIHsKCQkJY2FzZSBodG1sLkE6IHJldHVybiAiPGEgaHJlZj0nIithcmd1bWVudHNbMV0rIicgdGFyZ2V0PSdfYmxhbmsnPiIrKGFyZ3VtZW50c1syXXx8YXJndW1lbnRzWzFdKSsiPC9hPiIKCQkJY2FzZSBodG1sLklNRzogcmV0dXJuIGFyZ3VtZW50c1syXT8gIjxpbWcgc3JjPSciK2FyZ3VtZW50c1sxXSsiJyBoZWlnaHQ9Iithcmd1bWVudHNbMl0rIj4iOiAiPGltZyBzcmM9JyIrYXJndW1lbnRzWzFdKyInPiIKCQl9Cgl9LAoJcmVwbGFjZTogZnVuY3Rpb24oY2FuLCB0ZXh0LCBrZXksIHZhbHVlKSB7CgkJcmV0dXJuIGNhbi5iYXNlLnJlcGxhY2VBbGwodGV4dCwgIjwiLCAiJmx0OyIsICI+IiwgIiZndDsiLCBrZXksIHZhbHVlKQoJfSwKCUNvbG9yOiBmdW5jdGlvbih0ZXh0KSB7IGlmICh0eXBlb2YgdGV4dCAhPSBsYW5nLlNUUklORykgeyByZXR1cm4gIiIgfQoJCWlmICh0ZXh0LmluZGV4T2YoImh0dHA6Ly8iKSA9PSAwIHx8IHRleHQuaW5kZXhPZigiaHR0cHM6Ly8iKSA9PSAwIHx8IHRleHQuaW5kZXhPZigiZnRwOi8vIikgPT0gMCkgewoJCQl2YXIgbHMgPSB0ZXh0LnNwbGl0KGljZS5TUCk7CgkJCXRleHQgPSAiPGEgaHJlZj0nIitsc1swXSsiJyB0YXJnZXQ9J19ibGFuayc+Iitsc1swXSsiPC9hPiIrbHMuc2xpY2UoMSkuam9pbihpY2UuU1ApCgkJfTsgdGV4dCA9IHRleHQucmVwbGFjZSgvXFxuL2csICI8YnI+IikKCgkJaWYgKHRleHQuaW5kZXhPZigiXDAzM1xbIikgPT0gLTEpIHsgcmV0dXJuIHRleHQgfQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzMxbS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiNmMDAnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzJtL2csICI8c3BhbiBzdHlsZT0nY29sb3I6IzBmMCc+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFszM20vZywgIjxzcGFuIHN0eWxlPSdjb2xvcjojZmYwJz4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzM0bS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiMwMGYnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzZtL2csICI8c3BhbiBzdHlsZT0nY29sb3I6IzBmZic+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFszNDsxbS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiMwMGYnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzc7MW0vZywgIjxzcGFuIHN0eWxlPSdjb2xvcjojZmZmJz4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzFtL2csICI8c3BhbiBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZCc+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFswbS9nLCAiPC9zcGFuPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbbS9nLCAiPC9zcGFuPiIpCgkJcmV0dXJuIHRleHQKCX0sCglpbnB1dDogZnVuY3Rpb24oY2FuLCBpdGVtLCB2YWx1ZSkgewoJCXZhciBpbnB1dCA9IHt0eXBlOiBodG1sLklOUFVULCBuYW1lOiBpdGVtLm5hbWUsIGRhdGE6IGl0ZW0sIGRhdGFzZXQ6IHt9LCBfaW5pdDogaXRlbS5faW5pdCwgc3R5bGU6IGl0ZW0uc3R5bGV8fHt9fQoJCWl0ZW0udmFsdWUgPT0gaWNlLkFVVE8gJiYgKGl0ZW0udmFsdWUgPSAiIiwgaXRlbS5hY3Rpb24gPSBpY2UuQVVUTyksIGl0ZW0uYWN0aW9uID09IGljZS5BVVRPICYmIChpbnB1dC5kYXRhc2V0LmFjdGlvbiA9IGljZS5BVVRPKQoKCQlzd2l0Y2ggKGl0ZW0udHlwZSA9IGl0ZW0udHlwZXx8aHRtbC5URVhUKSB7CgkJCWNhc2UgaHRtbC5URVhUQVJFQTogaW5wdXQudHlwZSA9IGh0bWwuVEVYVEFSRUEKCQkJCWlucHV0LnN0eWxlLmhlaWdodCA9IGlucHV0LnN0eWxlLmhlaWdodHx8Y2FuLkNvbmYoW2N0eC5GRUFUVVJFLCBodG1sLlRFWFRBUkVBLCBpdGVtLm5hbWUsIGh0bWwuSEVJR0hUXS5qb2luKGljZS5QVCkpfHxjYW4uQ29uZihbImZlYXR1cmUiLCBodG1sLlRFWFRBUkVBLCBodG1sLkhFSUdIVF0uam9pbihpY2UuUFQpKQoJCQkJaW5wdXQuc3R5bGUud2lkdGggPSBpbnB1dC5zdHlsZS53aWR0aHx8Y2FuLkNvbmYoW2N0eC5GRUFUVVJFLCBodG1sLlRFWFRBUkVBLCBpdGVtLm5hbWUsIGh0bWwuV0lEVEhdLmpvaW4oaWNlLlBUKSl8fGNhbi5Db25mKFsiZmVhdHVyZSIsIGh0bWwuVEVYVEFSRUEsIGh0bWwuV0lEVEhdLmpvaW4oaWNlLlBUKSkKCQkJCS8vIG5vIGJyZWFrCgkJCWNhc2UgaHRtbC5VU0VSTkFNRToKCQkJY2FzZSBodG1sLlBBU1NXT1JEOgoJCQkJLy8gbm8gYnJlYWsKCQkJY2FzZSBodG1sLlRFWFQ6CgkJCQlpdGVtLmF1dG9jb21wbGV0ZSA9ICJvZmYiCgkJCQlpdGVtLm5hbWUgPSBpdGVtLm5hbWV8fGl0ZW0udHlwZQoJCQkJaXRlbS52YWx1ZSA9IHZhbHVlfHxpdGVtLnZhbHVlfHwiIgoJCQkJaXRlbS5wbGFjZWhvbGRlciA9IGl0ZW0ucGxhY2Vob2xkZXJ8fGl0ZW0ubmFtZXx8aXRlbS50eXBlCgkJCQlpdGVtLnRpdGxlID0gaXRlbS50aXRsZXx8aXRlbS5wbGFjZWhvbGRlcnx8aXRlbS5uYW1lfHxpdGVtLnR5cGUKCQkJCWl0ZW0uY2xhc3NOYW1lIHx8IGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCBjdHguQVJHUykKCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5TRUxFQ1Q6IGlucHV0LnR5cGUgPSBodG1sLlNFTEVDVAoJCQkJaXRlbS52YWx1ZXMgPSBjYW4uYmFzZS5pc1N0cmluZyhpdGVtLnZhbHVlcyk/IGNhbi5jb3JlLlNwbGl0KGl0ZW0udmFsdWVzKTogaXRlbS52YWx1ZXMKCQkJCWlmICghaXRlbS52YWx1ZXMgJiYgaXRlbS52YWx1ZSkgeyBpdGVtLnZhbHVlcyA9IGNhbi5jb3JlLlNwbGl0KGl0ZW0udmFsdWUpLCBpdGVtLnZhbHVlID0gaXRlbS52YWx1ZXNbMF0gfQoKCQkJCWl0ZW0udmFsdWUgPSB2YWx1ZXx8aXRlbS52YWx1ZSwgaW5wdXQubGlzdCA9IGl0ZW0udmFsdWVzLm1hcChmdW5jdGlvbih2YWx1ZSkgewoJCQkJCXJldHVybiB7dHlwZTogaHRtbC5PUFRJT04sIHZhbHVlOiB2YWx1ZSwgaW5uZXI6IHZhbHVlfQoJCQkJfSksIGl0ZW0uY2xhc3NOYW1lIHx8IGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCBjdHguQVJHUykKCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5CVVRUT046IGl0ZW0udmFsdWUgPSBpdGVtLnZhbHVlfHxpdGVtLm5hbWV8fG1kYi5MSVNUOyBicmVhawoJCQljYXNlICJ1cGZpbGUiOiBpdGVtLnR5cGUgPSBodG1sLkZJTEU7IGJyZWFrCgkJCWNhc2UgaHRtbC5VUExPQUQ6IGl0ZW0udHlwZSA9IGh0bWwuRklMRSwgaW5wdXQubmFtZSA9IGh0bWwuVVBMT0FEOyBicmVhawoJCQlkZWZhdWx0OgoJCX0KCQlyZXR1cm4gaW5wdXQKCX0sCgoJc3R5bGVEaXNwbGF5OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuRElTUExBWSwgdmFsdWUpLCB0YXJnZXQuc3R5bGUuZGlzcGxheQoJfSwKCXN0eWxlSGVpZ2h0OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuSEVJR0hULCB2YWx1ZSksIHRhcmdldC5vZmZzZXRIZWlnaHQKCX0sCglzdHlsZVdpZHRoOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuV0lEVEgsIHZhbHVlKSwgdGFyZ2V0Lm9mZnNldFdpZHRoCgl9LAoJc3R5bGU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBzdHlsZSkgeyB2YXIgdmFsdWUgPSB7fQoJCWZvciAodmFyIGkgPSAyOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSArPSAyKSB7CgkJCWlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09IGxhbmcuT0JKRUNUKSB7CgkJCQljYW4uYmFzZS5Db3B5KHZhbHVlLCBhcmd1bWVudHNbaS0tXSkKCQkJfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09IGxhbmcuVU5ERUZJTkVEKSB7CgkJCQljb250aW51ZQoJCQl9IGVsc2UgewoJCQkJdmFsdWVbYXJndW1lbnRzW2ldXSA9IGFyZ3VtZW50c1tpKzFdCgkJCX0KCQl9CgkJcmV0dXJuIGNhbi5wYWdlLk1vZGlmeShjYW4sIHRhcmdldCwge3N0eWxlOiB2YWx1ZX0pLCB2YWx1ZQoJfSwKCUtleXM6IGZ1bmN0aW9uKCkgeyB2YXIgbGlzdCA9IFtdIC8vIEZTIFNQIEdUIFBUCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHYgPSBhcmd1bWVudHNbaV0KCQkJaWYgKHR5cGVvZiB2ID09IGxhbmcuT0JKRUNUKSB7CgkJCQlmb3IgKHZhciBqID0gMDsgaiA8IHYubGVuZ3RoOyBqKyspIHsKCQkJCQlpZiAodHlwZW9mIHZbal0gPT0gbGFuZy5PQkpFQ1QpIHsKCQkJCQkJZm9yICh2YXIgayA9IDA7IGsgPCB2W2pdLmxlbmd0aDsgaysrKSB7CgkJCQkJCQlpZiAodHlwZW9mIHZbal1ba10gPT0gbGFuZy5PQkpFQ1QpIHsgdltqXVtrXSA9IHZbal1ba10uam9pbihpY2UuUFQpIH0KCQkJCQkJfQoJCQkJCQl2W2pdID0gdltqXS5qb2luKGljZS5HVCkKCQkJCQl9CgkJCQl9CgkJCQlsaXN0LnB1c2godi5qb2luKGljZS5TUCkpCgkJCX0gZWxzZSB7CgkJCQlsaXN0LnB1c2godisiIikKCQkJfQoJCX0KCQlyZXR1cm4gbGlzdC5qb2luKGljZS5GUykKCX0sCgljc3M6IGZ1bmN0aW9uKHRleHQpIHsKCQl2YXIgc3R5bGVTaGVldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIikKCQlzdHlsZVNoZWV0LnR5cGUgPSAidGV4dC9jc3MiLCBzdHlsZVNoZWV0LmlubmVyVGV4dCA9IHRleHQKCQlkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlU2hlZXQpCgl9LAoJdGFnaXM6IGZ1bmN0aW9uKHR5cGUsIHRhcmdldCkgeyB0eXBlID0gdHlwZW9mIHR5cGUgPT0gbGFuZy5PQkpFQ1Q/IHR5cGU6IFt0eXBlXQoJCWlmICh0eXBlLmluZGV4T2YodGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSkgPiAtMSkgeyByZXR1cm4gdHJ1ZSB9Cgl9LAoJb2Zmc2V0VG9wOiBmdW5jdGlvbihpdGVtKSB7IHZhciByZXMgPSAwCgkJd2hpbGUgKGl0ZW0pIHsgcmVzICs9IGl0ZW0ub2Zmc2V0VG9wfHwwLCBpdGVtID0gaXRlbS5wYXJlbnROb2RlIH0KCQlyZXR1cm4gcmVzCgl9LAoJb2Zmc2V0TGVmdDogZnVuY3Rpb24oaXRlbSkgeyB2YXIgcmVzID0gMAoJCS8vIGlmIChpdGVtLm9mZnNldExlZnQpIHsgcmV0dXJuIGl0ZW0ub2Zmc2V0TGVmdCB9CgkJd2hpbGUgKGl0ZW0pIHsgcmVzICs9IGl0ZW0ub2Zmc2V0TGVmdHx8MCwgaXRlbSA9IGl0ZW0ucGFyZW50Tm9kZSB9CgkJcmV0dXJuIHJlcwoJfSwKCglBcHBlbmRWdWU6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgbGlzdCwgdGFyZ2V0KSB7CgkJY2FuLnJlcXVpcmUoWyJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL3Z1ZUAyL2Rpc3QvdnVlLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucmVxdWlyZShbImh0dHBzOi8vdW5wa2cuY29tL2VsZW1lbnQtdWkvbGliL2luZGV4LmpzIiwgImh0dHBzOi8vdW5wa2cuY29tL2VsZW1lbnQtdWkvbGliL3RoZW1lLWNoYWxrL2luZGV4LmNzcyJdLCBmdW5jdGlvbigpIHsKCQkJCW5ldyBWdWUoY2FuLmJhc2UuQ29weSh7ZWw6IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldHx8Y2FuLl9vdXRwdXQsIFt7dHlwZTogImRpdiIsIGlubmVyOiBsaXN0fV0pLmZpcnN0fSwgbWV0YSkpCgkJCX0pCgkJfSkKCX0sCgoJaW5zZXJ0QmVmb3JlOiBmdW5jdGlvbihjYW4sIGxpc3QsIGJlZm9yZSkgewoJCXZhciBpdGVtID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgYmVmb3JlLnBhcmVudE5vZGUsIGxpc3QpLmZpcnN0CgkJYmVmb3JlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGl0ZW0sIGJlZm9yZSkKCQlyZXR1cm4gaXRlbQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL2xpYi9iYXNlLmpzIgpWb2xjYW5vcygiYmFzZSIsIHtoZWxwOiAi5pWw5o2u57G75Z6LIiwgSW50OiBmdW5jdGlvbih2YWwsIGRlZikgeyByZXR1cm4gcGFyc2VJbnQodmFsKXx8ZGVmfHwwIH0sCglNaW46IGZ1bmN0aW9uKHZhbCwgbWluKSB7IHJldHVybiB2YWwgPiBtaW4/IHZhbDogbWluIH0sCglPYmo6IGZ1bmN0aW9uKHZhbCwgZGVmKSB7CgkJdHJ5IHsKCQkJaWYgKHR5cGVvZiB2YWwgPT0gbGFuZy5TVFJJTkcpIHsgaWYgKHZhbCA9PSAiIikgeyByZXR1cm4gZGVmIH0gdmFsID0gSlNPTi5wYXJzZSh2YWwpIH0KCQkJaWYgKHZhbC5sZW5ndGggPiAwKSB7IHJldHVybiB2YWwgfSBmb3IgKHZhciBrIGluIHZhbCkgeyByZXR1cm4gdmFsIH0gcmV0dXJuIGRlZgoJCX0gY2F0Y2ggKGUpIHsgcmV0dXJuIHZhbCAmJiB2YWwuc3BsaXQgJiYgdmFsLnNwbGl0KGljZS5GUykgfHwgZGVmIH0KCX0sCglDb3B5OiBmdW5jdGlvbih0bywgZnJvbSkgewoJCWlmIChhcmd1bWVudHMubGVuZ3RoID09IDIpIHsKCQkJZm9yICh2YXIgayBpbiBmcm9tKSB7IHRvW2tdID0gZnJvbVtrXSB9CgkJCXJldHVybiB0bwoJCX0KCQlmb3IgKHZhciBpID0gMjsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJCQl2YXIgayA9IGFyZ3VtZW50c1tpXTsgdG9ba10gPSBmcm9tW2tdCgkJfQoJCXJldHVybiB0bwoJfSwKCUVxOiBmdW5jdGlvbih0bywgZnJvbSkgeyB2YXIgY2FsbCA9IGFyZ3VtZW50cy5jYWxsZWUKCQlpZiAodHlwZW9mIHRvICE9IHR5cGVvZiBmcm9tKSB7IHJldHVybiBmYWxzZSB9CgkJaWYgKHR5cGVvZiB0byA9PSBsYW5nLk9CSkVDVCkgewoJCQlpZiAodG8ubGVuZ3RoICE9IGZyb20ubGVuZ3RoKSB7IHJldHVybiBmYWxzZSB9CgkJCWZvciAodmFyIGkgPSAwOyBpIDwgdG8ubGVuZ3RoOyBpKyspIHsKCQkJCWlmICghY2FsbCh0b1tpXSwgZnJvbVtpXSkpIHsgcmV0dXJuIGZhbHNlIH0KCQkJfQoJCQlmb3IgKHZhciBrIGluIHRvKSB7CgkJCQlpZiAoIWNhbGwodG9ba10sIGZyb21ba10pKSB7IHJldHVybiBmYWxzZSB9CgkJCX0KCQkJcmV0dXJuIHRydWUKCQl9CgkJcmV0dXJuIHRvID09PSBmcm9tCgl9LAoKCUV4dDogZnVuY3Rpb24ocGF0aCkgeyByZXR1cm4gKHBhdGguc3BsaXQoaWNlLlBTKS5wb3AoKS5zcGxpdChpY2UuUFQpLnBvcCgpKS50b0xvd2VyQ2FzZSgpIH0sCglQYXRoOiBmdW5jdGlvbihwYXRoKSB7IHZhciByZXMgPSAiIgoJCWZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IGlmICghYXJndW1lbnRzW2ldKSB7IGNvbnRpbnVlIH0KCQkJcmVzICs9IChhcmd1bWVudHNbaV1bMF09PWljZS5QUyB8fCByZXM9PSIiIHx8IHJlc1tyZXMubGVuZ3RoLTFdPT1pY2UuUFM/ICIiOiBpY2UuUFMpICsgYXJndW1lbnRzW2ldLnRyaW0oKQoJCX0KCQlyZXR1cm4gcmVzCgl9LAoJQXJnczogZnVuY3Rpb24oKSB7IHZhciByZXMgPSBbXQoJCWZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSArPSAyKSB7CgkJCWlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09IGxhbmcuT0JKRUNUKSB7CgkJCQlmb3IgKHZhciBrIGluIGFyZ3VtZW50c1tpXSkgeyByZXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoaykrIj0iK2VuY29kZVVSSUNvbXBvbmVudChhcmd1bWVudHNbaV1ba10pKSB9CgkJCQlpLS07IGNvbnRpbnVlCgkJCX0gZWxzZSBpZiAoYXJndW1lbnRzW2ldKSB7IAoJCQkJcmVzLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGFyZ3VtZW50c1tpXSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChhcmd1bWVudHNbaSsxXSkpCgkJCX0KCQl9CgkJcmV0dXJuIHJlcy5qb2luKCImIikKCX0sCglNZXJnZVVSTDogZnVuY3Rpb24odXJsKSB7CgkJdmFyIGFyZ3MgPSB7fTsgKHVybC5zcGxpdCgiPyIpWzFdfHwiIikuc3BsaXQoIiYiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsgaWYgKCFpdGVtKSB7IHJldHVybiB9CgkJCXZhciBscyA9IGl0ZW0uc3BsaXQoIj0iKTsgYXJnc1tkZWNvZGVVUklDb21wb25lbnQobHNbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChsc1sxXSkKCQl9KQoJCWZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkJCXN3aXRjaCAodHlwZW9mIGFyZ3VtZW50c1tpXSkgewoJCQkJY2FzZSBsYW5nLlNUUklORzogYXJnc1thcmd1bWVudHNbaV1dID0gYXJndW1lbnRzW2krMV0sIGkrKzsgYnJlYWsKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6CgkJCQkJaWYgKGFyZ3VtZW50c1tpXS5sZW5ndGggPiAwKSB7CgkJCQkJCWZvciAodmFyIGogPSAwOyBqIDwgYXJndW1lbnRzW2ldLmxlbmd0aDsgaiArPSAyKSB7IGFyZ3NbYXJndW1lbnRzW2ldW2pdXSA9IGFyZ3VtZW50c1tpXVtqXSB9CgkJCQkJfSBlbHNlIHsKCQkJCQkJZm9yICh2YXIgayBpbiBhcmd1bWVudHNbaV0pIHsgYXJnc1trXSA9IGFyZ3VtZW50c1tpXVtrXSB9CgkJCQkJfQoJCQkJCWJyZWFrCgkJCX0KCQl9CgkJdmFyIGxpc3QgPSBbXTsgZm9yICh2YXIgayBpbiBhcmdzKSB7IGxpc3QucHVzaChlbmNvZGVVUklDb21wb25lbnQoaykrIj0iK2VuY29kZVVSSUNvbXBvbmVudChhcmdzW2tdKSkgfQoJCXJldHVybiB1cmwuc3BsaXQoIj8iKVswXSsobGlzdC5sZW5ndGg+MD8gIj8iK2xpc3Quam9pbigiJiIpOiAiIikKCX0sCglQYXJzZVVSTDogZnVuY3Rpb24odXJsKSB7IHZhciByZXMgPSB7bGluazogdXJsfQoJCXZhciBsaXN0ID0gdXJsLnNwbGl0KCI/Iik7IHJlc1sib3JpZ2luIl0gPSBsaXN0WzBdCgkJbGlzdFsxXSAmJiBsaXN0WzFdLnNwbGl0KCImIikuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CgkJCXZhciBscyA9IGl0ZW0uc3BsaXQoIj0iKTsgcmVzW2RlY29kZVVSSUNvbXBvbmVudChsc1swXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KGxzWzFdKQoJCX0pCgkJcmV0dXJuIHJlcwoJfSwKCVBhcnNlSlNPTjogZnVuY3Rpb24oc3RyKSB7IHZhciByZXMKCQlpZiAodHlwZW9mIHN0ciA9PSBsYW5nLk9CSkVDVCkgeyByZXR1cm4gc3RyIH0KCQlpZiAoc3RyLmluZGV4T2YoImh0dHAiKSA9PSAwKSB7IHZhciBscyA9IHN0ci5zcGxpdCgiPyIpCgkJCXJlcyA9IHt0eXBlOiBtZGIuTElOSywgbmFtZTogIiIsIHRleHQ6IHN0cn0KCQkJcmVzLm5hbWUgPSBsc1swXS5zcGxpdCgiOi8vIikucG9wKCkuc3BsaXQoaWNlLlBTKVswXQoJCQlsc1sxXSAmJiBsc1sxXS5zcGxpdCgiJiIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgeyB2YXIgbHMgPSBpdGVtLnNwbGl0KCI9IikKCQkJCXJlc1tkZWNvZGVVUklDb21wb25lbnQobHNbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChsc1sxXSkKCQkJfSkKCQkJcmV0dXJuIHJlcwoJCX0KCQl0cnkgeyByZXMgPSBKU09OLnBhcnNlKHN0ciksIHJlcy50ZXh0ID0gcmVzLnRleHR8fHN0ciwgcmVzLnR5cGUgPSByZXMudHlwZXx8bmZzLkpTT04KCQl9IGNhdGNoIChlKSB7IHJlcyA9IHt0eXBlOiBtZGIuVEVYVCwgdGV4dDogc3RyfSB9CgkJcmV0dXJuIHJlcwoJfSwKCVBhcnNlU2l6ZTogZnVuY3Rpb24oc2l6ZSkgeyBzaXplID0gc2l6ZS50b0xvd2VyQ2FzZSgpCgkJaWYgKHNpemUuZW5kc1dpdGgoInRiIikgfHwgc2l6ZS5lbmRzV2l0aCgidCIpKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplKSAqIDEwMjQgKiAxMDI0ICogMTAyNCAqIDEwMjQKCQl9CgkJaWYgKHNpemUuZW5kc1dpdGgoImdiIikgfHwgc2l6ZS5lbmRzV2l0aCgiZyIpKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplKSAqIDEwMjQgKiAxMDI0ICogMTAyNAoJCX0KCQlpZiAoc2l6ZS5lbmRzV2l0aCgibWIiKSB8fCBzaXplLmVuZHNXaXRoKCJtIikpIHsKCQkJcmV0dXJuIHBhcnNlSW50KHNpemUpICogMTAyNCAqIDEwMjQKCQl9CgkJaWYgKHNpemUuZW5kc1dpdGgoImtiIikgfHwgc2l6ZS5lbmRzV2l0aCgiayIpKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplKSAqIDEwMjQKCQl9CgkJcmV0dXJuIHBhcnNlSW50KHNpemUpCgl9LAoKCVNpemU6IGZ1bmN0aW9uKHNpemUpIHsgc2l6ZSA9IHBhcnNlSW50KHNpemUpCgkJaWYgKHNpemUgPiAxMDAwMDAwMDAwKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplLzEwMDAwMDAwMDApICsgaWNlLlBUICsgcGFyc2VJbnQoc2l6ZS8xMDAwMDAwMCUxMDApICsgIkciCgkJfQoJCWlmIChzaXplID4gMTAwMDAwMCkgewoJCQlyZXR1cm4gcGFyc2VJbnQoc2l6ZS8xMDAwMDAwKSArIGljZS5QVCArIHBhcnNlSW50KHNpemUvMTAwMDAlMTAwKSArICJNIgoJCX0KCQlpZiAoc2l6ZSA+IDEwMDApIHsKCQkJcmV0dXJuIHBhcnNlSW50KHNpemUvMTAwMCkgKyBpY2UuUFQgKyBwYXJzZUludChzaXplLzEwJTEwMCkgKyAiSyIKCQl9CgkJcmV0dXJuIHNpemUgKyAiQiIKCX0sCglOdW1iZXI6IGZ1bmN0aW9uKGQsIG4pIHsgdmFyIHJlc3VsdCA9IFtdCgkJd2hpbGUgKGQgPiAwKSB7IHJlc3VsdC5wdXNoKGQlMTApOyBkID0gcGFyc2VJbnQoZC8xMCk7IG4tLSB9CgkJd2hpbGUgKG4gPiAwKSB7IHJlc3VsdC5wdXNoKCIwIik7IG4tLSB9CgkJcmV0dXJuIHJlc3VsdC5yZXZlcnNlKCksIHJlc3VsdC5qb2luKCIiKQoJfSwKCUZvcm1hdDogZnVuY3Rpb24ob2JqKSB7IHJldHVybiBKU09OLnN0cmluZ2lmeShvYmopIH0sCglTaW1wbGU6IGZ1bmN0aW9uKCkgeyB2YXIgcmVzID0gW10KCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJCQl2YXIgYXJnID0gYXJndW1lbnRzW2ldOyBzd2l0Y2ggKHR5cGVvZiBhcmd1bWVudHNbaV0pIHsKCQkJCWNhc2UgbGFuZy5OVU1CRVI6IHJlcy5wdXNoKGFyZyk7IGJyZWFrCgkJCQljYXNlIGxhbmcuU1RSSU5HOiByZXMucHVzaChhcmcpOyBicmVhawoJCQkJY2FzZSBsYW5nLk9CSkVDVDoKCQkJCQlpZiAoYXJnLmxlbmd0aCA+IDApIHsgcmVzID0gcmVzLmNvbmNhdChhcmcpOyBicmVhayB9CgkJCQkJZm9yICh2YXIgayBpbiBhcmcpIHsgayAmJiBhcmdba10gJiYgcmVzLnB1c2goaywgYXJnW2tdKSB9CgkJCQkJYnJlYWsKCQkJCWRlZmF1bHQ6IHJlcy5wdXNoKGFyZyk7IAoJCQl9CgkJfQoJCXJldHVybiByZXMKCX0sCglBZGRVbmlxOiBmdW5jdGlvbihsaXN0LCB2YWx1ZSkgeyBsaXN0ID0gbGlzdHx8W107IHJldHVybiBsaXN0LmluZGV4T2YodmFsdWUpID09IC0xICYmIGxpc3QucHVzaCh2YWx1ZSksIGxpc3QgfSwKCglEYXRlOiBmdW5jdGlvbih0aW1lKSB7IHZhciBub3cgPSBuZXcgRGF0ZSgpCgkJaWYgKHR5cGVvZiB0aW1lID09IGxhbmcuU1RSSU5HICYmIHRpbWUgIT0gIiIpIHsgdmFyIGxzID0gdGltZS5zcGxpdChpY2UuU1ApCgkJCXZhciB2cyA9IGxzWzBdLnNwbGl0KCItIikKCQkJbm93LnNldEZ1bGxZZWFyKHBhcnNlSW50KHZzWzBdKSkKCQkJbm93LnNldE1vbnRoKHBhcnNlSW50KHZzWzFdKS0xKQoJCQlub3cuc2V0RGF0ZShwYXJzZUludCh2c1syXSkpCgoJCQl2YXIgdnMgPSBsc1sxXS5zcGxpdCgiOiIpCgkJCW5vdy5zZXRIb3VycyhwYXJzZUludCh2c1swXSkpCgkJCW5vdy5zZXRNaW51dGVzKHBhcnNlSW50KHZzWzFdKSkKCQkJbm93LnNldFNlY29uZHMocGFyc2VJbnQodnNbMl0pKQoJCX0gZWxzZSBpZiAodGltZSkgewoJCQlub3cgPSB0aW1lCgkJfQoJCXJldHVybiBub3cKCX0sCglUaW1lOiBmdW5jdGlvbih0aW1lLCBmbXQpIHsgdmFyIG5vdyA9IHRoaXMuRGF0ZSh0aW1lKQoJCXZhciBsaXN0ID0gWyJTdW4iLCAiTW9uIiwgIlR1ZSIsICJXZWQiLCAiVGh1IiwgIkZyaSIsICJTYXQiXQoJCWZtdCA9IGZtdHx8IiVIOiVNOiVTIgoJCWZtdCA9IGZtdC5yZXBsYWNlKCIleSIsIG5vdy5nZXRGdWxsWWVhcigpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIlbSIsIHRoaXMuTnVtYmVyKG5vdy5nZXRNb250aCgpKzEsIDIpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIlZCIsIHRoaXMuTnVtYmVyKG5vdy5nZXREYXRlKCksIDIpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIldyIsIGxpc3Rbbm93LmdldERheSgpXSkKCQlmbXQgPSBmbXQucmVwbGFjZSgiJUgiLCB0aGlzLk51bWJlcihub3cuZ2V0SG91cnMoKSwgMikpCgkJZm10ID0gZm10LnJlcGxhY2UoIiVNIiwgdGhpcy5OdW1iZXIobm93LmdldE1pbnV0ZXMoKSwgMikpCgkJZm10ID0gZm10LnJlcGxhY2UoIiVTIiwgdGhpcy5OdW1iZXIobm93LmdldFNlY29uZHMoKSwgMikpCgkJcmV0dXJuIGZtdAoJfSwKCVRpbWVBZGQ6IGZ1bmN0aW9uKHQsIGQpIHsgcmV0dXJuIG5ldyBEYXRlKHQgLSB0JSgyNCozNjAwKjEwMDApIC0gOCozNjAwKjEwMDAgKyBkKjI0KjM2MDAqMTAwMCkgfSwKCUR1cmF0aW9uOiBmdW5jdGlvbihuKSB7IHZhciByZXMgPSAiIiwgaCA9IDAKCQloID0gcGFyc2VJbnQobi8zNjAwMDAwLzI0KSwgaCA+IDAgJiYgKHJlcyArPSBoKyJkIiksIG4gPSBuICUgKDM2MDAwMDAqMjQpCgkJaCA9IHBhcnNlSW50KG4vMzYwMDAwMCksIGggPiAwICYmIChyZXMgKz0gaCsiaCIpLCBuID0gbiAlIDM2MDAwMDAKCQloID0gcGFyc2VJbnQobi82MDAwMCksIGggPiAwICYmIChyZXMgKz0gaCsibSIpLCBuID0gbiAlIDYwMDAwCgkJaCA9IHBhcnNlSW50KG4vMTAwMCksIGggPiAwICYmIChyZXMgKz0gaCksIG4gPSBuICUgMTAwMAoJCXJldHVybiByZXMgKyAobiA+IDA/IGljZS5QVCtwYXJzZUludChuLzEwKTogIiIpICsgInMiCgl9LAoKCW1vZDogZnVuY3Rpb24oaW5kZXgsIHRvdGFsKSB7CgkJcmV0dXJuIChpbmRleCt0b3RhbCkgJSB0b3RhbAoJfSwKCWdldFZhbGlkOiBmdW5jdGlvbigpIHsKCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgdiA9IGFyZ3VtZW50c1tpXQoJCQlpZiAodHlwZW9mIHYgPT0gbGFuZy5PQkpFQ1QpIHsKCQkJCWlmICh2ID09IG51bGwpIHsgY29udGludWUgfQoJCQkJZm9yICh2YXIgayBpbiB2KSB7IHJldHVybiB2IH0KCQkJCWlmICh2Lmxlbmd0aCA+IDApIHsgcmV0dXJuIHYgfQoJCQl9IGVsc2UgaWYgKHR5cGVvZiB2ID09IGxhbmcuU1RSSU5HICYmIHYpIHsKCQkJCXJldHVybiB2CgkJCX0gZWxzZSBpZiAodiA9PSB1bmRlZmluZWQpIHsKCQkJCWNvbnRpbnVlCgkJCX0gZWxzZSB7CgkJCQlyZXR1cm4gdgoJCQl9CgkJfQoJfSwKCWlzTnVtYmVyOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5OVU1CRVIgfSwKCWlzU3RyaW5nOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5TVFJJTkcgfSwKCWlzT2JqZWN0OiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5PQkpFQ1QgfSwKCWlzQXJyYXk6IGZ1bmN0aW9uKHZhbCkgeyByZXR1cm4gdHlwZW9mIHZhbCA9PSBsYW5nLk9CSkVDVCAmJiB2YWwubGVuZ3RoICE9IHVuZGVmaW5lZCB9LAoJaXNGdW5jOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5GVU5DVElPTiB9LAoJaXNGdW5jdGlvbjogZnVuY3Rpb24odmFsKSB7IHJldHVybiB0eXBlb2YgdmFsID09IGxhbmcuRlVOQ1RJT04gfSwKCWlzQ2FsbGJhY2s6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGtleS5pbmRleE9mKCJvbiIpID09IDAgJiYgdHlwZW9mIHZhbHVlID09IGxhbmcuRlVOQ1RJT04gfSwKCWlzVW5kZWZpbmVkOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHZhbCA9PSB1bmRlZmluZWQgfSwKCWlzTnVsbDogZnVuY3Rpb24odmFsKSB7IHJldHVybiB2YWwgPT0gbnVsbCB9LAoJcmVwbGFjZUFsbDogZnVuY3Rpb24oc3RyKSB7CgkJZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpICs9IDIpIHsgaWYgKCFhcmd1bWVudHNbaV0pIHsgY29udGludWUgfQoJCQlpZiAoc3RyLnJlcGxhY2VBbGwpIHsgc3RyID0gc3RyLnJlcGxhY2VBbGwoYXJndW1lbnRzW2ldLCBhcmd1bWVudHNbaSsxXSk7IGNvbnRpbnVlIH0KCQkJaWYgKHN0ci5yZXBsYWNlKSB7IHN0ciA9IHN0ci5yZXBsYWNlKGFyZ3VtZW50c1tpXSwgYXJndW1lbnRzW2krMV0pOyBjb250aW51ZSB9CgkJfQoJCXJldHVybiBzdHIKCX0sCgoJY291bnQ6IGZ1bmN0aW9uKHN0ciwgcykgeyB2YXIgbiA9IDAKCQlmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgewoJCQlpZiAoc3RyW2ldID09IHMpIHsgbisrIH0KCQl9CgkJcmV0dXJuIG4KCX0sCglyYW5kb206IGZ1bmN0aW9uKG1heCwgbWluKSB7IG1pbiA9IG1pbnx8MCwgcGFyc2VJbnQoTWF0aC5yYW5kb20oKSoobWF4LW1pbikpK21pbiB9LAoJaXNOaWdodDogZnVuY3Rpb24oKSB7IHZhciBub3cgPSBuZXcgRGF0ZSgpOyByZXR1cm4gbm93LmdldEhvdXJzKCkgPCA3IHx8IG5vdy5nZXRIb3VycygpID4gMTcgfSwKCWJlZ2luV2l0aDogZnVuY3Rpb24oc3RyLCBiZWdpbikgeyByZXR1cm4gc3RyLnRyaW0oKS5pbmRleE9mKGJlZ2luKSA9PSAwIH0sCgllbmRXaXRoOiBmdW5jdGlvbihzdHIsIGVuZCkgeyByZXR1cm4gc3RyLmxhc3RJbmRleE9mKGVuZCkgKyBlbmQubGVuZ3RoID09IHN0ci5sZW5ndGggfSwKCXRyaW06IGZ1bmN0aW9uKGFyZ3MpIHsgaWYgKHRoaXMuaXNTdHJpbmcoYXJncykpIHsgcmV0dXJuIGFyZ3MudHJpbSgpIH0KCQlpZiAodGhpcy5pc0FycmF5KGFyZ3MpKSB7IGZvciAodmFyIGkgPSBhcmdzLmxlbmd0aC0xOyBpID49IDA7IGktLSkgeyBpZiAoIWFyZ3NbaV0pIHsgYXJncy5wb3AoKSB9IGVsc2UgeyBicmVhayB9IH0gfQoJCXJldHVybiBhcmdzCgl9LAoJdHJpbVByZWZpeDogZnVuY3Rpb24oc3RyLCBwcmUpIHsgaWYgKHN0ci5pbmRleE9mKHByZSkgPT0gLTEpIHsgcmV0dXJuIHN0ciB9IHJldHVybiBzdHIuc2xpY2UocHJlLmxlbmd0aCkgfSwKCXRyaW1TdWZmaXg6IGZ1bmN0aW9uKHN0ciwgZW5kKSB7CgkJdmFyIGluZGV4ID0gc3RyLmxhc3RJbmRleE9mKGVuZCkKCQlpZiAoaW5kZXggPT0gLTEgfHwgaW5kZXgrZW5kLmxlbmd0aCAhPSBzdHIubGVuZ3RoKSB7IHJldHVybiBzdHIgfSByZXR1cm4gc3RyLnNsaWNlKDAsIGluZGV4KQoJfSwKCWpvaW46IGZ1bmN0aW9uKGxpc3QsIHNwKSB7IHJldHVybiAobGlzdHx8W10pLmpvaW4oc3B8fGljZS5TUCkgfSwKCWpvaW5zOiBmdW5jdGlvbihsaXN0LCBpbm5lciwgb3V0ZXIpIHsgCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7CgkJCWxpc3RbaV0gPSB0eXBlb2YgbGlzdFtpXSA9PSBsYW5nLlNUUklORz8gbGlzdFtpXTogbGlzdFtpXS5qb2luKGlubmVyfHxpY2UuRlMpCgkJfQoJCXJldHVybiBsaXN0LmpvaW4ob3V0ZXJ8fGljZS5TUCkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9saWIvbWlzYy5qcyIKVm9sY2Fub3MoIm1pc2MiLCB7aGVscDogIumAmuS/oeWNj+iuriIsIE1lc3NhZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IHt9IAoJdmFyIHByb3RvID0ge19ldmVudDogZXZlbnQsIF9jYW46IGNhbiwKCQlSdW5BY3Rpb246IGZ1bmN0aW9uKGV2ZW50LCBzdWIsIGNtZHMsIG1ldGEpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KTsgbWV0YSA9IG1ldGEgfHwgc3ViJiZzdWIub25hY3Rpb24gfHwge30KCQkJaWYgKG1zZy5PcHRpb24oaWNlLk1TR19IQU5ETEUpID09IGljZS5UUlVFKSB7IHJldHVybiB9CgkJCWlmIChjbWRzICYmIGNtZHNbMF0gPT0gY3R4LkFDVElPTiAmJiBjYW4uYmFzZS5pc0Z1bmMobWV0YVtjbWRzWzFdXSkpIHsKCQkJCXJldHVybiBtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFLCBpY2UuVFJVRSksIGNhbi5jb3JlLkNhbGxGdW5jKG1ldGFbY21kc1sxXV0sIHtldmVudDogZXZlbnQsIGNhbjogc3ViLCBtc2c6IG1zZywgYnV0dG9uOiBjbWRzWzFdLCBjbWQ6IGNtZHNbMV19KSwgdHJ1ZQoJCQl9CgkJCXJldHVybiBmYWxzZQoJCX0sCgkJRGlzcGxheTogZnVuY3Rpb24oZmlsZSkgeyBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSwgZmlsZSkgfSwKCQlEaXNwbGF5U3Rvcnk6IGZ1bmN0aW9uKGZpbGUpIHsgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVksICIvcGx1Z2luL3N0b3J5LyIrZmlsZSkgfSwKCQlPcHRpb25TdGF0dXM6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbXNnLk9wdGlvbihpY2UuTVNHX1NUQVRVUykgfSwKCQlPcHRpb25Qcm9jZXNzOiBmdW5jdGlvbigpIHsgcmV0dXJuIG1zZy5PcHRpb24oaWNlLk1TR19QUk9DRVNTKSB9LAoJCU9wdGlvbk9yU2VhcmNoOiBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIGNhbi5taXNjLlNlYXJjaChjYW4sIGtleSl8fG1zZy5PcHRpb24oa2V5KSB9LAoJCU9wdGlvbjogZnVuY3Rpb24oa2V5LCB2YWwpIHsKCQkJaWYgKGtleSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIG1zZyAmJiBtc2cub3B0aW9uIHx8IFtdIH0KCQkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsgY2FuLmNvcmUuSXRlbShrZXksIG1zZy5PcHRpb24pIH0KCQkJaWYgKHZhbCA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIG1zZyAmJiBtc2dba2V5XSAmJiBtc2dba2V5XVswXSB8fCAiIiB9CgkJCXJldHVybiBtc2cub3B0aW9uID0gY2FuLmJhc2UuQWRkVW5pcShtc2cub3B0aW9uLCBrZXkpLCBtc2dba2V5XSA9IGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKS5zbGljZSgxKSwgdmFsCgkJfSwKCQlBcHBlbmQ6IGZ1bmN0aW9uKGtleSwgdmFsKSB7CgkJCWlmIChrZXkgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBtc2cgJiYgbXNnLmFwcGVuZCB8fCBbXSB9CgkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7IGNhbi5jb3JlLkl0ZW0oa2V5LCBtc2cuQXBwZW5kKSB9CgkJCWlmICh2YWwgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBtc2cgJiYgbXNnW2tleV0gJiYgbXNnW2tleV1bMF0gfHwgIiIgfQoJCQlyZXR1cm4gbXNnLmFwcGVuZCA9IGNhbi5iYXNlLkFkZFVuaXEobXNnLmFwcGVuZCwga2V5KSwgbXNnW2tleV0gPSBjYW4uY29yZS5MaXN0KGFyZ3VtZW50cykuc2xpY2UoMSksIHZhbAoJCX0sCgkJUmVzdWx0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1zZy5yZXN1bHQgJiYgbXNnLnJlc3VsdC5qb2luKCIiKSB8fCAiIiB9LAoKCQlMZW5ndGg6IGZ1bmN0aW9uKCkgewoJCQl2YXIgbWF4ID0gIiIsIGxlbiA9IDA7IGNhbi5jb3JlLkxpc3QobXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCBpbmRleCkgewoJCQkJaWYgKG1zZ1trZXldICYmIG1zZ1trZXldLmxlbmd0aCA+IGxlbikgeyBtYXggPSBrZXksIGxlbiA9IG1zZ1trZXldLmxlbmd0aCB9CgkJCX0pCgkJCXJldHVybiBsZW4KCQl9LAoJCVRhYmxlOiBmdW5jdGlvbihjYikgeyBpZiAoIW1zZy5hcHBlbmQgfHwgbXNnLmFwcGVuZC5sZW5ndGggPT0gMCkgeyByZXR1cm4gfQoJCQl2YXIgbWF4ID0gIiIsIGxlbiA9IDA7IGNhbi5jb3JlLkxpc3QobXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCBpbmRleCkgewoJCQkJaWYgKG1zZ1trZXldICYmIG1zZ1trZXldLmxlbmd0aCA+IGxlbikgeyBtYXggPSBrZXksIGxlbiA9IG1zZ1trZXldLmxlbmd0aCB9CgkJCX0pCgoJCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChtc2dbbWF4XSwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBhcnJheSkgeyB2YXIgb25lID0ge30sIHJlcwoJCQkJY2FuLmNvcmUuTGlzdChtc2cuYXBwZW5kLCBmdW5jdGlvbihrZXkpIHsgb25lW2tleV0gPSAobXNnW2tleV0mJm1zZ1trZXldW2luZGV4XXx8IiIpIH0pCgkJCQlyZXR1cm4gY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiAocmVzID0gY2Iob25lLCBpbmRleCwgYXJyYXkpKSAmJiByZXMgIT0gdW5kZWZpbmVkICYmIHJlcyB8fCBvbmUKCQkJfSkKCQl9LAoJCUNsZWFyOiBmdW5jdGlvbihrZXkpIHsgc3dpdGNoIChrZXl8fGljZS5NU0dfQVBQRU5EKSB7CgkJCWNhc2UgaWNlLk1TR19BUFBFTkQ6CgkJCWNhc2UgaWNlLk1TR19PUFRJT046CgkJCQljYW4uY29yZS5MaXN0KG1zZ1trZXldLCBmdW5jdGlvbihpdGVtKSB7IGRlbGV0ZShtc2dbaXRlbV0pIH0pCgkJCWRlZmF1bHQ6IG1zZ1trZXldID0gW10KCQl9IH0sCgkJQ29weTogZnVuY3Rpb24ocmVzKSB7IGlmICghcmVzKSB7IHJldHVybiBtc2cgfQoJCQlyZXMucmVzdWx0ICYmIChtc2cucmVzdWx0ID0gKG1zZy5yZXN1bHR8fFtdKS5jb25jYXQocmVzLnJlc3VsdCkpCgkJCXJlcy5hcHBlbmQgJiYgKG1zZy5hcHBlbmQgPSByZXMuYXBwZW5kKSAmJiByZXMuYXBwZW5kLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgewoJCQkJdmFyIGkgPSBtc2cub3B0aW9uICYmIG1zZy5vcHRpb24uaW5kZXhPZihpdGVtKTsgaWYgKGkgPiAtMSkgewoJCQkJCW1zZy5vcHRpb25baV0gPSAiIiwgZGVsZXRlKG1zZ1tpdGVtXSkKCQkJCX0KCQkJCXJlc1tpdGVtXSAmJiAobXNnW2l0ZW1dID0gKG1zZ1tpdGVtXXx8W10pLmNvbmNhdChyZXNbaXRlbV0pKQoJCQl9KQoJCQlyZXMub3B0aW9uICYmIChtc2cub3B0aW9uID0gcmVzLm9wdGlvbikgJiYgcmVzLm9wdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCXJlc1tpdGVtXSAmJiAobXNnW2l0ZW1dID0gcmVzW2l0ZW1dKQoJCQl9KQoJCQlyZXMuX29wdGlvbiAmJiAobXNnLl9vcHRpb24gPSByZXMuX29wdGlvbikgJiYgcmVzLl9vcHRpb24uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CgkJCQlyZXNbaXRlbV0gJiYgKG1zZ1tpdGVtXSA9IHJlc1tpdGVtXSkKCQkJfSkKCQkJcmV0dXJuIG1zZwoJCX0sCgkJUHVzaDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgZGV0YWlsKSB7CgkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7CgkJCQl2YWx1ZSA9IHZhbHVlfHxjYW4uY29yZS5JdGVtKGtleSksIGNhbi5jb3JlLkxpc3QodmFsdWUsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQlkZXRhaWw/IG1zZy5QdXNoKG1kYi5LRVksIGl0ZW0pLlB1c2gobWRiLlZBTFVFLCBrZXlbaXRlbV18fCIiKTogbXNnLlB1c2goaXRlbSwga2V5W2l0ZW1dfHwiIikKCQkJCX0pCgkJCQlyZXR1cm4gbXNnCgkJCX0KCgkJCW1zZy5hcHBlbmQgPSBjYW4uYmFzZS5BZGRVbmlxKG1zZy5hcHBlbmQsIGtleSksIG1zZ1trZXldID0gbXNnW2tleV0gfHwgW10KCQkJbXNnW2tleV0ucHVzaChjYW4uYmFzZS5pc1N0cmluZyh2YWx1ZSl8fGNhbi5iYXNlLmlzRnVuY3Rpb24odmFsdWUpPyB2YWx1ZTogSlNPTi5zdHJpbmdpZnkodmFsdWUpKQoJCQlyZXR1cm4gbXNnCgkJfSwKCQlTdGF0dXM6IGZ1bmN0aW9uKG9iaikgeyBtc2cuT3B0aW9uKGljZS5NU0dfU1RBVFVTLCBKU09OLnN0cmluZ2lmeShjYW4uY29yZS5JdGVtKG9iaiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4ge25hbWU6IGtleSwgdmFsdWU6IHZhbHVlfSB9KSkpIH0sCgkJU3RhdHVzVGltZUNvdW50OiBmdW5jdGlvbihvYmopIHsgbXNnLmFwcGVuZCAmJiBtc2cuU3RhdHVzKGNhbi5iYXNlLkNvcHkoeyJ0aW1lIjogY2FuLmJhc2UuVGltZSgpLCAiY291bnQiOiBtc2cuTGVuZ3RoKCkrIngiK21zZy5hcHBlbmQubGVuZ3RofSwgb2JqKSkgfSwKCQlFY2hvOiBmdW5jdGlvbihyZXMpIHsgbXNnLnJlc3VsdCA9IG1zZy5yZXN1bHQgfHwgW10KCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgbXNnLnJlc3VsdC5wdXNoKGFyZ3VtZW50c1tpXSkgfQoJCQlyZXR1cm4gbXNnLl9oYW5kID0gdHJ1ZSwgbXNnCgkJfSwKCQlEdW1wOiBmdW5jdGlvbihjYW4pIHsKCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJfSwKCX0KCXJldHVybiBjYW4ubWlzYy5wcm90byhtc2csIHByb3RvKQp9LAoJUE9TVDogZnVuY3Rpb24oY2FuLCBtc2csIHVybCwgZm9ybSwgY2IpIHsgLy8gX21ldGhvZCBfYWNjZXB0IF91cGxvYWQgX3Byb2dyZXNzCgkJdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyBtc2cuX3hociA9IHhocgoJCXhoci5vcGVuKG1zZy5fbWV0aG9kfHwiUE9TVCIsIHVybCksIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9IDQpIHsgcmV0dXJuIH0KCgkJCXRyeSB7IC8vIOino+aekOWTjeW6lAoJCQkJdmFyIHJlcyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkKCQkJfSBjYXRjaCAoZSkgewoJCQkJdmFyIHJlcyA9IHtyZXN1bHQ6IFt4aHIucmVzcG9uc2VUZXh0XX0KCQkJfQoJCQlpZiAoeGhyLnN0YXR1cyA9PSAyMDApIHsKCQkJCXJldHVybiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZy5Db3B5KHJlcykpCgkJCX0KCQkJY2FuLnVzZXIudG9hc3QoY2FuLCByZXMsIHhoci5zdGF0dXMpCgkJfQoKCQlpZiAobXNnLl91cGxvYWQpIHsgLy8g5LiK5Lyg5paH5Lu2CgkJCXZhciBkYXRhID0gbmV3IEZvcm1EYXRhKCk7IGNhbi5jb3JlLkl0ZW1zKGZvcm0sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwga2V5KSB7CgkJCQlkYXRhLmFwcGVuZChrZXksIHZhbHVlKQoJCQl9KSwgZGF0YS5hcHBlbmQoaHRtbC5VUExPQUQsIG1zZy5fdXBsb2FkKSwgZGF0YS5hcHBlbmQoaWNlLk1TR19VUExPQUQsIG1kYi5VUExPQUQpCgoJCQl4aHIudXBsb2FkLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLmJhc2UuaXNGdW5jKG1zZy5fcHJvZ3Jlc3MpICYmIG1zZy5fcHJvZ3Jlc3MoZXZlbnQsIHBhcnNlSW50KGV2ZW50LmxvYWRlZCoxMDAvZXZlbnQudG90YWwpLCBldmVudC50b3RhbCwgZXZlbnQubG9hZGVkKQoJCQl9CgkJfSBlbHNlIHsgLy8g6K+35rGC5pWw5o2uCgkJCXZhciBkYXRhID0gY2FuLmNvcmUuSXRlbXMoZm9ybSwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBrZXkpIHsgcmV0dXJuIGtleSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSB9KS5qb2luKCImIikKCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQoJCX0KCgkJLy8g5Y+R6YCB6K+35rGCCgkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIkFjY2VwdCIsIG1zZy5fYWNjZXB0fHwiYXBwbGljYXRpb24vanNvbiIpCgkJdHJ5IHsgeGhyLnNlbmQoZGF0YSkgfSBjYXRjaChlKSB7IGNhbi5taXNjLkxvZyhlKSB9Cgl9LAoJUnVuOiBmdW5jdGlvbihldmVudCwgY2FuLCBkYXRhc2V0LCBjbWRzLCBjYikgewoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudHx8e30pLCBza2lwID0ge19oYW5kbGU6IHRydWV9CgkJdmFyIGZvcm0gPSB7Y21kczogY21kc3x8bXNnLmNtZH07IG1zZy5vcHRpb24gJiYgbXNnLm9wdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKCQkJIXNraXBbaXRlbV0gJiYgbXNnW2l0ZW1dICYmIChmb3JtW2l0ZW1dID0gbXNnW2l0ZW1dKQoJCX0pCgoJCWNhbi5taXNjLlBPU1QoY2FuLCBtc2csIGNhbi5iYXNlLk1lcmdlVVJMKGRhdGFzZXQubmFtZXMudG9Mb3dlckNhc2UoKSwKCQkJIl8iLCAobXNnLl9jYW4uc3VwfHxtc2cuX2NhbikuX25hbWUsIGljZS5NU0dfREFFTU9OLCBtc2cuX19kYWVtb258fGRhdGFzZXQuZGFlbW9ufHwiIgoJCSksIGZvcm0sIGNiKQoJfSwKCVdTUzogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYiwgb25vcGVuLCBvbmNsb3NlLCBvbmVycm9yKSB7IGlmIChjYW4udXNlci5pc0lFKSB7IHJldHVybiB9CgkJdmFyIHVybCA9IGxvY2F0aW9uLnByb3RvY29sLnJlcGxhY2UoImh0dHAiLCAid3MiKSsiLy8iK2xvY2F0aW9uLmhvc3QrIi9zcGFjZS8iCgkJaWYgKHVybC5pbmRleE9mKCJjaHJvbWUiKSA9PSAwKSB7IHVybCA9ICJ3czovL2xvY2FsaG9zdDo5MDIwL3NwYWNlLyIgfQoKCQl2YXIgc29ja2V0ID0gbmV3IFdlYlNvY2tldChjYW4uYmFzZS5NZXJnZVVSTCh1cmwsIGFyZ3MpKQoJCXNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZyhodG1sLldTUywgY2xpLkNMT1NFLCBhcmdzKQoJCQljYW4uYmFzZS5pc0Z1bmMob25jbG9zZSk/IG9uY2xvc2Uoc29ja2V0KTogY2FuLmNvcmUuVGltZXIoY2FuLmJhc2UucmFuZG9tKDMwMDAsIDEwMDApLCBmdW5jdGlvbigpIHsKCQkJCWNhbi5taXNjLldTUyhjYW4sIGFyZ3MsIGNiLCBvbm9wZW4sIG9uZXJyb3IsIG9uY2xvc2UpCgkJCX0pCgkJfSwgc29ja2V0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHsgY2FuLm1pc2MuTG9nKGh0bWwuV1NTLCBjbGkuRVJST1IsIGFyZ3MpCgkJCWNhbi5iYXNlLmlzRnVuYyhvbmVycm9yKT8gb25lcnJvcihzb2NrZXQpOiBzb2NrZXQuY2xvc2UoKQoKCQl9LCBzb2NrZXQub25vcGVuID0gZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZyhodG1sLldTUywgY2xpLk9QRU4sIGFyZ3MpCgkJCWNhbi5iYXNlLmlzRnVuYyhvbm9wZW4pICYmIG9ub3Blbihzb2NrZXQpCgkJfQoKCQlzb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHsgLy8g6Kej5p6Q5ZG95LukCgkJCXRyeSB7IHZhciBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKSB9IGNhdGNoIChlKSB7IHZhciBkYXRhID0ge2RldGFpbDogW2V2ZW50LmRhdGFdfSB9CgoJCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBtc2cuUmVwbHkgPSBmdW5jdGlvbigpIHsgLy8g5Zue5aSN5ZG95LukCgkJCQltc2cuT3B0aW9uKHtfaGFuZGxlOiB0cnVlLCBfc291cmNlOiAobXNnW2ljZS5NU0dfVEFSR0VUXXx8W10pLnJldmVyc2UoKS5zbGljZSgxKS5qb2luKGljZS5QVCl8fCIiLCBfdGFyZ2V0OiAobXNnW2ljZS5NU0dfU09VUkNFXXx8W10pLnJldmVyc2UoKS5qb2luKGljZS5QVCl9KQoJCQkJbXNnLnJlc3VsdCA9IChtc2cucmVzdWx0fHxbXSkuY29uY2F0KGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKSksIGNhbi5taXNjLkxvZyhodG1sLldTUywgaWNlLk1TR19SRVNVTFQsIG1zZy5yZXN1bHQsIG1zZykKCQkJCWRlbGV0ZShtc2cuX2V2ZW50KSwgZGVsZXRlKG1zZy5fY2FuKSwgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSkKCQkJfSwgbXNnLmRldGFpbCA9IGRhdGEuZGV0YWlsLCBtc2cuQ29weShkYXRhKQoKCQkJdHJ5IHsgLy8g5omn6KGM5ZG95LukCgkJCQljYW4ubWlzYy5Mb2coaHRtbC5XU1MsIGljZS5NU0dfREVUQUlMLCBtc2cuZGV0YWlsLCBtc2cpCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50LCBtc2csIG1zZy5kZXRhaWxbMF0sIG1zZy5kZXRhaWwuc2xpY2UoMSkpCgkJCX0gY2F0Y2ggKGUpIHsgY2FuLm1pc2MuTG9nKGUpLCBtc2cuUmVwbHkoKSB9CgkJfQoJfSwKCglDb29raWVTZXNzaWQ6IHNoeSgi5Lya6K+d5Y+Y6YePIiwgZnVuY3Rpb24oY2FuLCB2YWx1ZSwgcGF0aCkgewoJCXJldHVybiBjYW4ubWlzYy5Db29raWUoY2FuLCBpY2UuTVNHX1NFU1NJRCsiXyIrbG9jYXRpb24uaG9zdC5yZXBsYWNlQWxsKGljZS5QVCwgIl8iKS5yZXBsYWNlQWxsKGljZS5ERiwgIl8iKSwgdmFsdWUsIHBhdGgpCgl9KSwKCUNvb2tpZTogc2h5KCLkvJror53lj5jph48iLCBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUsIHBhdGgpIHsKCQlmdW5jdGlvbiBzZXQoaywgdikgeyBkb2N1bWVudC5jb29raWUgPSBrKyI9Iit2KyI7cGF0aD0iKyhwYXRofHxpY2UuUFMpIH0KCQlpZiAoY2FuLmJhc2UuaXNPYmplY3Qoa2V5KSkgeyBmb3IgKHZhciBrIGluIGtleSkgeyBzZXQoaywga2V5W2tdKSB9IGtleSA9IHVuZGVmaW5lZCB9CgoJCWlmIChrZXkgPT0gdW5kZWZpbmVkKSB7IHZhciBjcyA9IHt9CgkJCWRvY3VtZW50LmNvb2tpZS5zcGxpdCgiOyAiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGxzID0gaXRlbS5zcGxpdCgiPSIpOyBjc1tsc1swXV0gPSBsc1sxXSB9KQoJCQlyZXR1cm4gY3MKCQl9CgoJCXZhbHVlICE9IHVuZGVmaW5lZCAmJiBzZXQoa2V5LCB2YWx1ZSkKCQl2YXIgdmFsID0gKG5ldyBSZWdFeHAoa2V5KyI9KFteO10qKTs/IikpLmV4ZWMoZG9jdW1lbnQuY29va2llKQoJCXJldHVybiB2YWwgJiYgdmFsLmxlbmd0aCA+IDA/IHZhbFsxXTogIiIKCX0pLAoJU2VhcmNoT3JDb25mOiBmdW5jdGlvbihjYW4sIGtleSwgZGVmKSB7IHJldHVybiBjYW4uYmFzZS5nZXRWYWxpZChjYW4ubWlzYy5TZWFyY2goY2FuLCBrZXkpLCBjYW4uQ29uZihrZXkpLCBkZWYpIH0sCglTZWFyY2g6IHNoeSgi6K+35rGC5Y+C5pWwIiwgZnVuY3Rpb24oY2FuLCBrZXksIHZhbHVlKSB7IHZhciBhcmdzID0ge30KCQlpZiAodmFsdWUgPT0gdW5kZWZpbmVkICYmIGNhbi5iYXNlLmlzU3RyaW5nKGtleSkpIHsKCQkJdmFyIGxzID0gbG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoaWNlLlBTKTsgaWYgKGxzWzFdID09IGNoYXQuU0hBUkUpIHsgYXJnc1tjaGF0LlNIQVJFXSA9IGxzWzJdIH0KCQkJZm9yICh2YXIgaSA9IDI7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgeyBpZiAoeyJwb2QiOiB0cnVlLCAiY21kIjogdHJ1ZX1bbHNbaV1dKSB7IGFyZ3NbbHNbaV1dID0gbHNbaSsxXSB9IH0KCQl9CgkJbG9jYXRpb24uc2VhcmNoICYmIGxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKS5zcGxpdCgiJiIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgeyB2YXIgeCA9IGl0ZW0uc3BsaXQoIj0iKQoJCQl4WzFdICE9ICIiICYmIChhcmdzW3hbMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KHhbMV0pKQoJCX0pCgoJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7CgkJCWNhbi5jb3JlLkl0ZW0oa2V5LCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCQlpZiAodmFsdWUgIT0gdW5kZWZpbmVkKSB7IGFyZ3Nba2V5XSA9IHZhbHVlIH0gYXJnc1trZXldID09ICIiICYmIGRlbGV0ZShhcmdzW2tleV0pCgkJCX0pCgkJfSBlbHNlIHsKCQkJaWYgKGtleSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIGFyZ3MgfQoJCQlpZiAodmFsdWUgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBhcmdzW2tleV0gfQoJCQlhcmdzW2tleV0gPSB2YWx1ZSwgYXJnc1trZXldID09ICIiICYmIGRlbGV0ZShhcmdzW2tleV0pCgkJfQoKCQl2YXIgc2VhcmNoID0gY2FuLmNvcmUuSXRlbShhcmdzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiBrZXkrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgfSkuam9pbigiJiIpCgkJcmV0dXJuIHNlYXJjaD8gbG9jYXRpb24uc2VhcmNoID0gc2VhcmNoOiBsb2NhdGlvbi5ocmVmID0gbG9jYXRpb24ucGF0aG5hbWUKCX0pLAoJTWVyZ2VVUkw6IHNoeSgi5Zyw5Z2A6ZO+5o6lIiwgZnVuY3Rpb24oY2FuLCBvYmpzLCBjbGVhcikgewoJCXZhciBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7IG9ianMuX3BhdGggJiYgKHBhdGggPSBvYmpzLl9wYXRoLCBkZWxldGUob2Jqcy5fcGF0aCkpCgkJb2JqcyAmJiBvYmpzLnBvZCAmJiAocGF0aCA9ICIvY2hhdC9wb2QvIitvYmpzLnBvZCwgZGVsZXRlKG9ianMucG9kKSkKCQlyZXR1cm4gY2FuLmJhc2UuTWVyZ2VVUkwobG9jYXRpb24ub3JpZ2luK3BhdGgrKGNsZWFyPyIiOmxvY2F0aW9uLnNlYXJjaCksIG9ianMpCgl9KSwKCglydW5BY3Rpb246IGZ1bmN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwgbGlzdCkgewoJCWlmIChjbWRzWzBdID09IGN0eC5BQ1RJT04gJiYgbGlzdFtjbWRzWzFdXSkgeyByZXR1cm4gbGlzdFtjbWRzWzFdXShjbWRzLnNsaWNlKDIpKSwgdHJ1ZSB9CgkJaWYgKGxpc3RbY21kc1swXV0pIHsgcmV0dXJuIGxpc3RbY21kc1swXV0oY21kcy5zbGljZSgxKSksIHRydWUgfQoJfSwKCWNvbmNhdDogZnVuY3Rpb24oY2FuLCB0bywgZnJvbSkgeyB0byA9IHRvfHxbXSwgZnJvbSA9IGZyb218fFtdCgkJaWYgKGZyb21bMF0gPT0gY3R4LkFDVElPTiAmJiBmcm9tWzFdID09IGljZS5SVU4gJiYgY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2Zyb21bMl1dKSB7IHJldHVybiBmcm9tIH0KCQlpZiAoY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2Zyb21bMF1dKSB7IHJldHVybiBmcm9tIH0KCQlpZiAoZnJvbVswXSA9PSAiX3NlYXJjaCIpIHsgcmV0dXJuIGZyb20gfQoJCXJldHVybiB0by5jb25jYXQoZnJvbSkKCX0sCglwcm90bzogZnVuY3Rpb24oc3ViLCBzdXApIHsgcmV0dXJuIHN1Yi5fX3Byb3RvX18gPSBzdXAsIHN1YiB9LAoKCUxvZzogZnVuY3Rpb24oKSB7CgkJdmFyIGFyZ3MgPSBbdGhpcy5fdGltZSgpLCB0aGlzLkZpbGVMaW5lKDIsIDMpXQoJCWZvciAodmFyIGkgaW4gYXJndW1lbnRzKSB7IGFyZ3MucHVzaChhcmd1bWVudHNbaV0pIH0KCQljb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKQoJfSwKCUluZm86IGZ1bmN0aW9uKCkgewoJCXZhciBhcmdzID0gW3RoaXMuX3RpbWUoKSwgdGhpcy5GaWxlTGluZSgyLCAzKV0KCQlmb3IgKHZhciBpIGluIGFyZ3VtZW50cykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKSB9CgkJY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJncykKCX0sCglXYXJuOiBmdW5jdGlvbigpIHsKCQl2YXIgYXJncyA9IFt0aGlzLl90aW1lKCksIHRoaXMuRmlsZUxpbmUoMiwgMyksICJ3YXJuIl0KCQlmb3IgKHZhciBpIGluIGFyZ3VtZW50cykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKSB9CgkJYXJncy5wdXNoKGljZS5OTCwgdGhpcy5fZmlsZUxpbmUoKS5zcGxpdChpY2UuTkwpLnNsaWNlKDIpLmpvaW4oaWNlLk5MKSkKCQljb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKQoJfSwKCURlYnVnOiBmdW5jdGlvbigpIHsKCQl2YXIgYXJncyA9IFt0aGlzLl90aW1lKCksIHRoaXMuRmlsZUxpbmUoMiwgMyksICJkZWJ1ZyJdCgkJZm9yICh2YXIgaSBpbiBhcmd1bWVudHMpIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSkgfQoJCWFyZ3MucHVzaCh0aGlzLmZpbGVMaW5lKDIsIDMpKQoJCWNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpCgkJbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNb2JpbGUiKSA+IC0xICYmIGFsZXJ0KEpTT04uc3RyaW5naWZ5KGFyZ3Muam9pbihpY2UuU1ApKSkKCX0sCglGaWxlTGluZTogZnVuY3Rpb24oZGVwdGgsIGxlbmd0aCkgewoJCXJldHVybiB0aGlzLmZpbGVMaW5lKGRlcHRoKzEpLnNwbGl0KGljZS5QUykuc2xpY2UoMykuc2xpY2UoLWxlbmd0aCkuam9pbihpY2UuUFMpLnNwbGl0KCIpIilbMF0KCX0sCglmaWxlTGluZTogZnVuY3Rpb24oZGVwdGgpIHsKCQlyZXR1cm4gKHRoaXMuX2ZpbGVMaW5lKCkuc3BsaXQoaWNlLk5MKVsxK2RlcHRoXXx8IiIpLnRyaW0oKQoJfSwKCV9maWxlTGluZTogZnVuY3Rpb24oKSB7IHZhciBvYmogPSB7fQoJCUVycm9yLmNhcHR1cmVTdGFja1RyYWNlICYmIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKG9iaiwgYXJndW1lbnRzLmNhbGxlZSkKCQlyZXR1cm4gb2JqLnN0YWNrIHx8ICIiCgl9LAoJX3RpbWU6IGZ1bmN0aW9uKCkgeyB2YXIgbm93ID0gbmV3IERhdGUoKQoJCXZhciBob3VyID0gbm93LmdldEhvdXJzKCkKCQlpZiAoaG91ciA8IDEwKSB7IGhvdXIgPSAiMCIraG91ciB9CgkJdmFyIG1pbnV0ZSA9IG5vdy5nZXRNaW51dGVzKCkKCQlpZiAobWludXRlIDwgMTApIHsgbWludXRlID0gIjAiK21pbnV0ZSB9CgkJdmFyIHNlY29uZCA9IG5vdy5nZXRTZWNvbmRzKCkKCQlpZiAoc2Vjb25kIDwgMTApIHsgc2Vjb25kID0gIjAiK3NlY29uZCB9CgkJcmV0dXJuIGhvdXIrIjoiK21pbnV0ZSsiOiIrc2Vjb25kCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvaGVhZGVyLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCQljYW4uQ29uZihhYWEuVVNFUk5JQ0ssIG1zZy5PcHRpb24oYWFhLlVTRVJOSUNLKXx8bXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOSUNLKXx8bXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOQU1FKXx8Y2FuLkNvbmYoYWFhLlVTRVJOSUNLKSkKCQljYW4udXNlci5pbmZvLnVzZXJuaWNrID0gY2FuLkNvbmYoYWFhLlVTRVJOSUNLKQoJCWNhbi51c2VyLmluZm8uYXZhdGFyID0gbXNnLk9wdGlvbihhYWEuQVZBVEFSKQoJCWNhbi5vbmRhZW1vbi5faW5pdChjYW4pCgoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAidG9waWMiLCBzaHkoIuS4u+mimCIsIHsKCQkJImRlbW8iOiBmdW5jdGlvbihjYW4sIG1zZywgY21kcykgeyBjYW4ub25sYXlvdXQudG9waWMoY2FuLCBjbWRzWzBdKSB9LAoJCX0sIFsidG9waWM6c2VsZWN0PXdoaXRlLGJsYWNrIiwgInJ1bjpidXR0b24iLCAiZGVtbzpidXR0b24iXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCWNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNtZHNbMF0pCgkJfSkpCgoJCWNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNhbi5Db25mKCJ0b3BpYyIpKQoJCWlmIChjYW4udXNlci5tb2QuaXNDbWQpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fZmllbGRzKQoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgZG9jdW1lbnQuYm9keSwgInNpbXBsZSIpCgkJfQoKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKQoJCWNhbi5vbmltcG9ydC5fYWdlbnQoY2FuLCBtc2csIHRhcmdldCkKCQljYW4ub25pbXBvcnQuX2dyYW50KGNhbiwgbXNnLCB0YXJnZXQpCgkJaWYgKGNhbi5Db25mKCJkaXNwbGF5IikgIT0gInNpbXBsZSIpIHsKCQkJY2FuLm9uaW1wb3J0Ll90aXRsZShjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX3N0YXRlKGNhbiwgbXNnLCB0YXJnZXQpCgkJCWNhbi5vbmltcG9ydC5fc2VhcmNoKGNhbiwgbXNnLCB0YXJnZXQpCgkJCWNhbi5vbmltcG9ydC5fYmFja2dyb3VuZChjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX2F2YXRhcihjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX21lbnVzKGNhbiwgbXNnLCB0YXJnZXQpCgoJCX0KCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCX0sCglfYWdlbnQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4ucnVuKHt9LCBbY2hhdC5BR0VOVF0sIGZ1bmN0aW9uKG1zZykgeyBpZiAoIW1zZy5PcHRpb24obmZzLlNDUklQVCkpIHsgcmV0dXJuIH0KCQkJY2FuLnJlcXVpcmUoY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24obmZzLlNDUklQVCkpLCBmdW5jdGlvbihjYW4pIHsgY2FuLm9uYWN0aW9uLnNvdXJjZShjYW4sIG1zZykgfSkKCQl9KQoJfSwKCV9ncmFudDogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCWlmIChjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LkdSQU5UKSkgewoJCQlpZiAoY2FuLnVzZXIuY29uZmlybShjaGF0LkdSQU5UK2ljZS5TUCtjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LkdSQU5UKSkpIHsKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjaGF0LkdSQU5ULCB3ZWIuU1BBQ0UsIGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuR1JBTlQpXSkKCQkJfQoJCQljYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LkdSQU5ULCAiIikKCQl9Cgl9LAoJX3RpdGxlOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLnVzZXIudGl0bGUoY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5USVRMRSl8fGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpKQoJCSFjYW4udXNlci5pc01vYmlsZSAmJiBjYW4uY29yZS5MaXN0KGNhbi5iYXNlLmdldFZhbGlkKG1zZy5yZXN1bHQsIGNhbi5Db25mKGNoYXQuVElUTEUpfHxbInNoeWxpbnV4LmNvbS94L2NvbnRleHRzIl0pLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2hhdC5USVRMRSwgaHRtbC5ESVYsIGl0ZW1dLCB0aXRsZTogIui/lOWbnuS4u+mhtSIsIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25hY3Rpb24udGl0bGUoZXZlbnQsIGNhbikKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgeyB2YXIgbGlzdCA9IG1zZy5UYWJsZSgpCgkJCQljYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCB7fSwgY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtKSB7IHJldHVybiBpdGVtLm5hbWUgfSksIGZ1bmN0aW9uKGV2ZW50LCBpdGVtLCBtZXRhLCBpbmRleCkgewoJCQkJCWV2ZW50LnNoaWZ0S2V5PyBjYW4udXNlci5vcGVuKGxpc3RbaW5kZXhdLnBhdGgpOiBjYW4udXNlci5qdW1wcyhsaXN0W2luZGV4XS5wYXRoKQoJCQkJfSkKCQkJfX1dKQoJCX0pCgl9LAoJX3N0YXRlOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLmNvcmUuTGlzdChjYW4uYmFzZS5PYmoobXNnLk9wdGlvbihjaGF0LlNUQVRFKXx8Y2FuLkNvbmYoY2hhdC5TVEFURSksIFttZGIuVElNRSwgYWFhLlVTRVJOSUNLXSksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaWYgKGl0ZW0gPT0gYWFhLkFWQVRBUiApIHsgaWYgKGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogY2FuLmJhc2Uuam9pbihbY2hhdC5TVEFURSwgaXRlbV0pLCBsaXN0OiBbe2ltZzogaWNlLlNQfV0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlpZiAobXNnLk9wdGlvbihhYWEuQVZBVEFSKS5pbmRleE9mKCJodHRwIikgPT0gMCkgewoJCQkJCQljYW4ub25hY3Rpb24uY2FydGUoZXZlbnQsIGNhbiwgW2Nhbi5wYWdlLkZvcm1hdChodG1sLklNRywgbXNnLk9wdGlvbihhYWEuQVZBVEFSKSwgMTYwKV0pCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLm9uYWN0aW9uLmNhcnRlKGV2ZW50LCBjYW4sIFtjYW4ucGFnZS5Gb3JtYXQoaHRtbC5JTUcsICIvc2hhcmUvbG9jYWwvYXZhdGFyIiwgMTYwKV0pCgkJCQkJfQoJCQkJfX1dKTsgcmV0dXJuCgkJCX0KCgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2FuLmJhc2Uuam9pbihbY2hhdC5TVEFURSwgaXRlbV0pLCBodG1sLkRJViwgKGNhbi5Db25mKGl0ZW0pfHwiIikuc2xpY2UoMCwgMTApXSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmFjdGlvbiwgaXRlbV0sIFtldmVudCwgY2FuLCBpdGVtXSkKCQkJfSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgeyBpdGVtID09IG1kYi5USU1FICYmIGNhbi5vbmltcG9ydC5fdGltZShjYW4sIHRhcmdldCkgfX1dKQoJCX0pCgl9LAoJX3NlYXJjaDogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCXZhciB1aSA9IGNhbi5vbmFwcGVuZC5pbnB1dChjYW4sIHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IG1kYi5TRUFSQ0gsIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pOyBzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQkJY2FzZSBsYW5nLkVOVEVSOiBjYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9ub3BlbnNlYXJjaCIsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7dHlwZTogIioiLCB3b3JkOiBldmVudC50YXJnZXQudmFsdWV9KSkKCQkJfQoJCX19LCAiIiwgdGFyZ2V0LCAidGl0bGUgc2VhcmNoIikucGFyZW50Tm9kZQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0eXBlOiAic2VhcmNoIiwgbGlzdDogW3t2aWV3OiBbIm1lbnUiLCAiZGl2IiwgY2FuLnVzZXIudHJhbnMoY2FuLCAic2VhcmNoIildLCBvbmNsaWNrOiBmdW5jdGlvbigpIHsKCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbm9wZW5zZWFyY2giLCBjYW4ucmVxdWVzdChldmVudCwge3R5cGU6ICIqIiwgd29yZDogIiJ9KSkKCQl9fV0gfV0pCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdWksIHtzdHlsZToge2Zsb2F0OiBodG1sLlJJR0hUfX0pCgl9LAoJX2JhY2tncm91bmQ6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJaWYgKGNhbi5Db25mKCJiYWNrZ3JvdW5kIikgPT0gIl8iKSB7IHJldHVybiB9CgkJaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uIHx8IGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJbXNnLk9wdGlvbihhYWEuQkFDS0dST1VORCkgJiYgY2FuLm9ubGF5b3V0LmJhY2tncm91bmQoY2FuLCAiL3NoYXJlL2xvY2FsL2JhY2tncm91bmQiLCBkb2N1bWVudC5ib2R5KQoJfSwKCV9hdmF0YXI6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGlmIChjYW4udXNlci5pc0V4dGVuc2lvbiB8fCBjYW4udXNlci5pc0xvY2FsRmlsZSkgeyByZXR1cm4gfSBpZiAoIW1zZy5PcHRpb24oYWFhLkFWQVRBUikpIHsgcmV0dXJuIH0KCQlpZiAobXNnLk9wdGlvbihhYWEuQVZBVEFSKS5pbmRleE9mKCJodHRwIikgPT0gMCkgewoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCAiZGl2LnN0YXRlLmF2YXRhcj5pbWciLCB7c3JjOiBtc2cuT3B0aW9uKGFhYS5BVkFUQVIpfSkKCQl9IGVsc2UgewoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCAiZGl2LnN0YXRlLmF2YXRhcj5pbWciLCB7c3JjOiAiL3NoYXJlL2xvY2FsL2F2YXRhciJ9KQoJCX0KCX0sCglfbWVudXM6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4uc2V0SGVhZGVyTWVudShjYW4udXNlci5tb2QuaXNQb2R8fGNhbi51c2VyLmlzRXh0ZW5zaW9ufHxjYW4udXNlci5pc01vYmlsZT8gW2N0eC5DT05GSUddOgoJCQljYW4uYmFzZS5PYmoobXNnLk9wdGlvbihjaGF0Lk1FTlVTKXx8Y2FuLkNvbmYoY2hhdC5NRU5VUyksIGNhbi5vbmFjdGlvbi5fbWVudXMpLCBmdW5jdGlvbihldmVudCwgYnV0dG9uKSB7CgkJCQljYW4uY29yZS5DYWxsRnVuYyhjYW4ub25hY3Rpb25bYnV0dG9uXXx8ZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJCWNhbi5ydW4oZXZlbnQsIFtidXR0b25dLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCAi5omn6KGM5oiQ5YqfIiwgY2FuLnVzZXIudHJhbnMoY2FuLCBidXR0b24pKSB9KQoJCQkJfSwge2V2ZW50OiBldmVudCwgY2FuOiBjYW4sIGJ1dHRvbjogYnV0dG9ufSkKCQkJfSkKCX0sCgoJX3RpbWU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJY2FuLmNvcmUuVGltZXIoe2ludGVydmFsOiA1MDB9LCBmdW5jdGlvbigpIHsgY2FuLm9uaW1wb3J0LnRpbWUoY2FuLCB0YXJnZXQpIH0pCgkJY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIHthY3Rpb246ICJkYXRlIiwgc3R5bGU6IHsibWluLXdpZHRoIjogMzA2fX0sIHRhcmdldCwgZnVuY3Rpb24oc3ViKSB7CgkJCWNhbi5nZXQoIkFjdGlvbiIsICJzaXplIiwgZnVuY3Rpb24obXNnLCB0b3ApIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IHRvcCwgcmlnaHQ6IDAsIGxlZnQ6IG51bGx9fSkKCQkJfSkKCQl9KSwgdGFyZ2V0Lm9ubW91c2VlbnRlciA9IHRhcmdldC5jbGljawoJfSwKCXRpbWU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4pCgkJdGFyZ2V0LmlubmVySFRNTCA9IGNhbi51c2VyLnRpbWUoY2FuLCBudWxsLCAiJXcgJUg6JU06JVMiKQoJfSwKCXRvcGljOiBmdW5jdGlvbihjYW4sIHRvcGljKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNhbi5fdG9waWMgPSB0b3BpYykgfSwKCWJhY2tncm91bmQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHVybCkgeyBpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24gfHwgY2FuLnVzZXIuaXNMb2NhbEZpbGUpIHsgcmV0dXJuIH0KCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgYWFhLkJBQ0tHUk9VTkQsIHVybF0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ub25pbXBvcnQuX2JhY2tncm91bmQoY2FuLCBtc2cpIH0pCgl9LAoJYXZhdGFyOiBmdW5jdGlvbihldmVudCwgY2FuLCB1cmwpIHsgaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uIHx8IGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGFhYS5BVkFUQVIsIHVybF0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ub25pbXBvcnQuX2F2YXRhcihjYW4sIG1zZykgfSkKCX0sCgltZW51OiBmdW5jdGlvbihjYW4sIGNtZHMsIGNiLCB0cmFucykgewoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgW3t0eXBlOiBjbWRzWzBdLCBsaXN0OiBjYW4uY29yZS5MaXN0KGNtZHMuc2xpY2UoMSksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaWYgKGNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pKSB7CgkJCQlyZXR1cm4ge3ZpZXc6IFtodG1sLk1FTlUsIGh0bWwuRElWLCBjYW4udXNlci50cmFucyhjYW4sIGl0ZW0sIHRyYW5zKV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbSwgY21kcykKCQkJCX19CgoJCQl9IGVsc2UgaWYgKGNhbi5iYXNlLmlzQXJyYXkoaXRlbSkpIHsKCQkJCXZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsgcmV0dXJuIGNhbi51c2VyLnRyYW5zKGNhbiwgdmFsdWUsIHRyYW5zKSB9KQoJCQkJcmV0dXJuIHt2aWV3OiBbaHRtbC5NRU5VLCBodG1sLkRJViwgY2FuLnVzZXIudHJhbnMoY2FuLCBsaXN0WzBdLCB0cmFucyldLCBvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLm9uYWN0aW9uLmNhcnRlKGV2ZW50LCBjYW4sIGxpc3Quc2xpY2UoMSksIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIG1ldGEsIGluZGV4KSB7CgkJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGl0ZW1baW5kZXgrMV0sIGl0ZW0pCgkJCQkJfSwgdHJhbnMpCgkJCQl9fQoKCQkJfSBlbHNlIGlmIChjYW4uYmFzZS5pc09iamVjdChpdGVtKSkgewoJCQkJcmV0dXJuIGl0ZW0KCQkJfQoJCX0pIH1dKS5maXJzdAoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJfSwKCV9tZW51czogW1sic2V0dGluZyIsIGNoYXQuQkxBQ0ssIGNoYXQuV0hJVEUsIGNoYXQuUFJJTlQsICJ3ZWJwYWNrIiwgInRvaW1hZ2UiLCBjdHguQ09ORklHXV0sCglfdHJhbnM6IHsKCQkic2VhcmNoIjogIuaQnOe0oiIsCgkJImNyZWF0ZSI6ICLliJvlu7oiLAoJCSJzaGFyZSI6ICLlhbHkuqsiLAoKCQkic2V0dGluZyI6ICLorr7nva4iLAoJCSJibGFjayI6ICLpu5HoibLkuLvpopgiLAoJCSJ3aGl0ZSI6ICLnmb3oibLkuLvpopgiLAoJCSJwcmludCI6ICLmiZPljbDkuLvpopgiLAoJCSJ0b2ltYWdlIjogIueUn+aIkOWbvueJhyIsCgkJImNvbmZpZyI6ICLmi4nlj5bphY3nva4iLAoKCQkic2hhcmV1c2VyIjogIuWFseS6q+eUqOaItyIsCgkJInNldG5pY2siOiAi6K6+572u5pi156ewIiwKCQkicGFzc3dvcmQiOiAi5L+u5pS55a+G56CBIiwKCQkibGFuZ3VhZ2UiOiAi6K+t6KiA5Zyw5Yy6IiwKCQkiY2hpbmVzZSI6ICLkuK3mlociLAoJCSJjbGVhciI6ICLmuIXpmaTog4zmma8iLAoJfSwKCW9ubWFpbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQlmdW5jdGlvbiBpbml0KCkgeyBjYW4ucnVuKHt9LCBbXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5iYXNlLkNvcHkoY2FuLm9uYWN0aW9uLl90cmFucywgY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5UUkFOUyksIHt9KSkKCQkJY2FuLm9uaW1wb3J0Ll9pbml0KGNhbiwgbXNnLCBmdW5jdGlvbihtc2cpIHsgY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNoYXQuT05MT0dJTiwgbXNnKSB9LCBjYW4uX291dHB1dCkKCQl9KSB9CgoJCS8vIOeZu+W9leajgOafpQoJCWNhbi51c2VyLmlzTG9jYWxGaWxlPyBpbml0KCk6IGNhbi5ydW4oe30sIFtjaGF0LkNIRUNLXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5Db25mKGFhYS5VU0VSTklDSywgbXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOSUNLKXx8bXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOQU1FKSk/IGluaXQoKToKCQkJCW1zZy5PcHRpb24oY2hhdC5TU08pPyBjYW4udXNlci5qdW1wcyhtc2cuT3B0aW9uKGNoYXQuU1NPKSk6CgkJCQljYW4udXNlci5sb2dpbihjYW4sIGluaXQsIG1zZy5PcHRpb24oYWFhLkxPR0lOKSwgbXNnLk9wdGlvbigibG9naW4uZGV2IikpCgkJfSkKCX0sCglvbnN0b3JtX3NlbGVjdDogZnVuY3Rpb24oY2FuLCBtc2csIHJpdmVyLCBzdG9ybSkgeyBjYW4uQ29uZihjaGF0LlJJVkVSLCByaXZlciksIGNhbi5Db25mKGNoYXQuU1RPUk0sIHN0b3JtKSB9LAoJb25zZWFyY2hmb2N1czogZnVuY3Rpb24oY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYuc2VhcmNoIGlucHV0IiwgZnVuY3Rpb24odGFyZ2V0KSB7IHRhcmdldC5mb2N1cygpIH0pCgl9LAoJb253ZWJwYWNrOiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4ub25hY3Rpb25bIndlYnBhY2siXShtc2cuX2V2ZW50LCBjYW4pIH0sCgoJdGl0bGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgYXJncyA9IHt9OyBjYW4uY29yZS5MaXN0KFtjaGF0LlRJVExFLCBjaGF0LlRPUElDLCBjaGF0LkxBWU9VVF0sIGZ1bmN0aW9uKGtleSkgewoJCQl2YXIgdmFsdWUgPSBjYW4ubWlzYy5TZWFyY2goY2FuLCBrZXkpOyB2YWx1ZSAmJiAoYXJnc1trZXldID0gdmFsdWUpCgkJfSkKCQljYW4udXNlci5qdW1wcyhjYW4ubWlzYy5NZXJnZVVSTChjYW4sIGFyZ3MsIHRydWUpKQoJfSwKCglibGFjazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGJ1dHRvbiksIGNhbi5vbmxheW91dC5faW5pdChjYW4pIH0sCgl3aGl0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGJ1dHRvbiksIGNhbi5vbmxheW91dC5faW5pdChjYW4pIH0sCglwcmludDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNhbi5iYXNlLmpvaW4oW2NoYXQuV0hJVEUsIGJ1dHRvbl0pKQoJCWNhbi5zZXQoIlJpdmVyIiwgaHRtbC5IRUlHSFQsIC0xKSwgY2FuLnNldCgiQWN0aW9uIiwgaHRtbC5IRUlHSFQsIC0xKQoJfSwKCWNvbmZpZzogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7bmFtZTogInNjb3BlIiwgdmFsdWU6ICJldGMvbG9jYWwuc2h5In1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBtZXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09ORklHXS5jb25jYXQoYXJncyksIGZ1bmN0aW9uKG1zZykgeyBjYW4udXNlci5qdW1wcyhtc2cuUmVzdWx0KCkpIH0pCgkJfSkKCX0sCgl3ZWJwYWNrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiBtZGIuTkFNRSwgdmFsdWU6IGNhbi51c2VyLnRpdGxlKCl9XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgbWV0YSwgbGlzdCkgewoJCQljYW4uY29yZS5JdGVtKFZvbGNhbm9zLm1ldGEucGFjaywgZnVuY3Rpb24oa2V5LCBtc2cpIHsgCgkJCQljYW4uY29yZS5MaXN0KFsiX2V2ZW50IiwgIl9jYW4iLCAiX3hociIsIGljZS5NU0dfU0VTU0lELCAiIl0sIGZ1bmN0aW9uKGtleSkgeyBkZWxldGUobXNnW2tleV0pIH0pCgkJCX0pCgkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgewoJCQkJdG9waWM6IGNhbi5fdG9waWMsIGxheW91dDogIGNhbi5nZXRBY3Rpb24oY2hhdC5MQVlPVVQpLAoJCQkJcml2ZXI6IGNhbi5Db25mKGNoYXQuUklWRVIpLCBzdG9ybTogY2FuLkNvbmYoY2hhdC5TVE9STSksCgkJCQluYW1lOiBtZXRhLm5hbWUsIGNvbnRlbnQ6IEpTT04uc3RyaW5naWZ5KFZvbGNhbm9zLm1ldGEucGFjayksCgkJCQlhcmdzOiAibmFtZSx0b3BpYyxsYXlvdXQscml2ZXIsc3Rvcm0iLAoJCQl9KQoKCQkJdmFyIHRvYXN0ID0gY2FuLnVzZXIudG9hc3QoY2FuLCAi5omT5YyF5LitLi4uIiwgY29kZS5XRUJQQUNLLCAxMDAwMDAwKQoJCQljYW4ucnVuKGV2ZW50LCBbY29kZS5XRUJQQUNLXSwgZnVuY3Rpb24obXNnKSB7CgkJCQl0b2FzdC5jbG9zZSgpLCBjYW4udXNlci50b2FzdChjYW4sICLmiZPljIXmiJDlip8iLCBjb2RlLldFQlBBQ0spCgkJCQljYW4udXNlci5kb3dubG9hZChjYW4sICIvc2hhcmUvbG9jYWwvIittc2cuUmVzdWx0KCksIG5hbWUrIi5odG1sIikKCQkJfSkKCQl9KQoJfSwKCXRvaW1hZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBjYW4ub25tb3Rpb24udG9pbWFnZShldmVudCwgY2FuLCBkb2N1bWVudC50aXRsZSwgZG9jdW1lbnQuYm9keSkgfSwKCgljYXJ0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbGlzdCwgY2IsIHRyYW5zKSB7IGNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIGNhbi5vbmFjdGlvbiwgbGlzdCwgY2IpIH0sCglzaGFyZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYXJncykgewoJCWNhbi51c2VyLnNoYXJlKGNhbiwgY2FuLnJlcXVlc3QoZXZlbnQpLCBbY3R4LkFDVElPTiwgY2hhdC5TSEFSRV0uY29uY2F0KGFyZ3N8fFtdLAoJCQlbY2hhdC5SSVZFUiwgY2FuLkNvbmYoY2hhdC5SSVZFUiksIGNoYXQuU1RPUk0sIGNhbi5Db25mKGNoYXQuU1RPUk0pXSkpCgl9LAoKCXVzZXJuaWNrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIubW9kLmlzUG9kIHx8IGNhbi51c2VyLmlzRXh0ZW5zaW9uIHx8IGNhbi51c2VyLmlzTG9jYWxGaWxlIHx8IGNhbi5vbmFjdGlvbi5jYXJ0ZShldmVudCwgY2FuLCBbInNoYXJldXNlciIsICJzZXRuaWNrIiwgInBhc3N3b3JkIiwgW2FhYS5MQU5HVUFHRSwgYWFhLkNISU5FU0UsIGFhYS5FTkdMSVNIXSwgY2xpLkNMRUFSLCBhYWEuTE9HT1VUXSkKCX0sCglzaGFyZXVzZXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnVzZXIuc2hhcmUoY2FuLCBjYW4ucmVxdWVzdChldmVudCksIFtjdHguQUNUSU9OLCBjaGF0LlNIQVJFLCBtZGIuVFlQRSwgYWFhLkxPR0lOXSkgfSwKCXNldG5pY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgdWkgPSBjYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGFhYS5VU0VSTklDSywgdmFsdWU6IGNhbi5Db25mKGFhYS5VU0VSTklDSyl9XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgYXJncykgewoJCQljYW4ucnVuKGV2ZW50LCBbYWFhLlVTRVJOSUNLLCBsaXN0WzBdXSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgY2FuLmNvcmUuS2V5cyhodG1sLkRJViwgYWFhLlVTRVJOSUNLKSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIGNhbi5Db25mKGFhYS5VU0VSTklDSywgbGlzdFswXSkpCgkJCQl9KSwgY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbikKCQkJfSwgdHJ1ZSkKCQl9KQoJCWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLl90YXJnZXQsIHtzdHlsZToge3RvcDogNDAsIHJpZ2h0OiAwLCBsZWZ0OiAiIn19KQoJfSwKCXBhc3N3b3JkOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIHVpID0gY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiBodG1sLlBBU1NXT1JELCB0eXBlOiBodG1sLlBBU1NXT1JELCBhY3Rpb246IGljZS5BVVRPfSwge25hbWU6IGh0bWwuUEFTU1dPUkQsIHR5cGU6IGh0bWwuUEFTU1dPUkQsIGFjdGlvbjogaWNlLkFVVE99XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgYXJncykgewoJCQlpZiAobGlzdFswXSAhPSBsaXN0WzFdKSB7CgkJCQljYW4udXNlci50b2FzdChjYW4sICLlr4bnoIHkuI3kuIDoh7QiKQoJCQkJdWkuZm9jdXMoKQoJCQkJcmV0dXJuIHRydWUKCQkJfQoKCQkJY2FuLnJ1bihldmVudCwgW2FhYS5QQVNTV09SRCwgbGlzdFswXV0sIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbikKCQkJfSwgdHJ1ZSkKCQl9KQoJCWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLl90YXJnZXQsIHtzdHlsZToge3RvcDogNDAsIHJpZ2h0OiAwLCBsZWZ0OiAiIn19KQoJfSwKCWNoaW5lc2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm1pc2MuU2VhcmNoKGNhbiwgYWFhLkxBTkdVQUdFLCAiemgiKSB9LAoJZW5nbGlzaDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ubWlzYy5TZWFyY2goY2FuLCBhYWEuTEFOR1VBR0UsICJlbiIpIH0sCgljbGVhcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQuYmFja2dyb3VuZChldmVudCwgY2FuLCAiIiksIGNhbi5vbmltcG9ydC5hdmF0YXIoZXZlbnQsIGNhbiwgIiIpLCBjYW4udXNlci5yZWxvYWQodHJ1ZSkgfSwKCWxvZ291dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4udXNlci5sb2dvdXQoY2FuKSB9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJaGVpZ2h0OiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5fdGFyZ2V0Lm9mZnNldEhlaWdodCB9LAoJdG9waWM6IGZ1bmN0aW9uKGNhbikgeyByZXR1cm4gY2FuLl90b3BpYyB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvYWN0aW9uLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgcml2ZXIgPSBjYW4uQ29uZihjaGF0LlJJVkVSKSwgc3Rvcm0gPSBjYW4uQ29uZihjaGF0LlNUT1JNKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4uY29yZS5OZXh0KG1zZy5UYWJsZSgpLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCWl0ZW0uaGVpZ2h0ID0gY2FuLkNvbmYoaHRtbC5IRUlHSFQpLWNhbi5Db25mKGh0bWwuTUFSR0lOX1kpCgkJCWl0ZW0ud2lkdGggPSBjYW4uQ29uZihodG1sLldJRFRIKS1jYW4uQ29uZihodG1sLk1BUkdJTl9YKQoJCQlpdGVtLmZlYXR1cmUgPSBjYW4uYmFzZS5PYmooaXRlbS5mZWF0dXJlfHxpdGVtLm1ldGEpCgkJCWl0ZW0uaW5wdXRzID0gY2FuLmJhc2UuT2JqKGl0ZW0uaW5wdXRzfHxpdGVtLmxpc3QpCgoJCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwgaXRlbSwgZnVuY3Rpb24oc3ViLCBtZXRhLCBza2lwKSB7CgkJCQljYW4ub25pbXBvcnQuX3BsdWdpbihjYW4sIHJpdmVyLCBzdG9ybSwgc3ViLCBtZXRhKSwgc2tpcCB8fCBuZXh0KCkKCQkJfSkKCQl9LCBmdW5jdGlvbigpIHsKCQkJY2FuLm9uYWN0aW9uLmxheW91dChjYW4sIGNhbi5taXNjLlNlYXJjaE9yQ29uZihjYW4sIGNoYXQuTEFZT1VUKXx8Vm9sY2Fub3MubWV0YS5hcmdzLmxheW91dHx8ImF1dG8iLCB0cnVlKQoJCQljYW4ub25pbXBvcnQuX21lbnUoY2FuLCBtc2cpLCBjYW4ub25rZXltYXAuX2luaXQoY2FuKQoJCX0pCgl9LAoJX3BsdWdpbjogZnVuY3Rpb24oY2FuLCByaXZlciwgc3Rvcm0sIHN1YiwgbWV0YSkgeyBzdWIuX3RhcmdldC5fbWV0YSA9IG1ldGEKCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCkKCQkJcmV0dXJuIGNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtyaXZlciwgc3Rvcm0sIG1ldGEuaWR8fG1ldGEuaW5kZXhdLCBjbWRzKSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQkJfSkKCQl9LCBjYW4uX3BsdWdpbnMgPSBjYW4ubWlzYy5jb25jYXQoY2FuLCBjYW4uX3BsdWdpbnMsIFtzdWJdKQoKCQltZXRhLmlkICYmIChzdWIuX29wdGlvbi5kYXRhc2V0ID0gc3ViLl9vcHRpb24uZGF0YXNldHx8e30sIHN1Yi5fb3B0aW9uLmRhdGFzZXQuaWQgPSBtZXRhLmlkKQoKCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIm9yaWVudGF0aW9uY2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgsIG1ldGEud2lkdGgtKGNhbi51c2VyLmlzV2luZG93cz8gMjA6IDApKQoJCX0pCgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgsIG1ldGEud2lkdGgtKGNhbi51c2VyLmlzV2luZG93cz8gMjA6IDApKQoKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX2FjdGlvbiwgW3t2aWV3OiBbaHRtbC5UQUJTLCBodG1sLkRJViwgbWV0YS5uYW1lXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLkZJRUxEU0VUX1BMVUdJTiwgc3ViLl90YXJnZXQpCgkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4uX2FjdGlvbiwgaHRtbC5ESVZfVEFCUywgZXZlbnQudGFyZ2V0KQoJCX0sIG9ubW91c2VlbnRlcjogc3ViLl9sZWdlbmQub25tb3VzZWVudGVyLCBvbmRibGNsaWNrOiBzdWIuX2xlZ2VuZC5vbmNsaWNrfV0pCgl9LAoJX21lbnU6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGlmIChjYW4udXNlci5tb2QuaXNQb2R8fGNhbi51c2VyLmlzTW9iaWxlKSB7IHJldHVybiB9CgkJY2FuLnNldEhlYWRlck1lbnUoY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5NRU5VUyksIGNhbi5Db25mKGNoYXQuTUVOVVMpfHxjYW4ub25hY3Rpb24uX21lbnVzKSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbGlzdCkgewoJCQljYW4uY29yZS5DYWxsRnVuYyhbY2FuLm9uYWN0aW9uLCBsaXN0WzBdXSwgW2NhbiwgYnV0dG9uXSkKCQl9KQoJfSwKCglfc2hhcmU6IGZ1bmN0aW9uKGNhbiwgc2hhcmUpIHsgc2hhcmUgJiYgY2FuLnJ1bih7fSwgWyJfc2hhcmUiLCBzaGFyZV0sIGZ1bmN0aW9uKG1zZykgewoJCWNhbi51c2VyLnRpdGxlKG1zZy5PcHRpb25PclNlYXJjaChjaGF0LlRJVExFKSkKCQljYW4uc2V0SGVhZGVyKGNoYXQuVE9QSUMsIG1zZy5PcHRpb25PclNlYXJjaChjaGF0LlRPUElDKSkKCgkJaWYgKG1zZy5MZW5ndGgoKSA9PSAxKSB7CgkJCWNhbi5zZWFyY2goZXZlbnQsIFsiSGVhZGVyLm9ubW90aW9uLmhpZGRlbiJdKQoJCQljYW4uc2VhcmNoKGV2ZW50LCBbIkZvb3Rlci5vbm1vdGlvbi5oaWRkZW4iXSkKCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fdGFyZ2V0LCAiY21kIikKCQkJY2FuLkNvbmYoaHRtbC5IRUlHSFQsIHdpbmRvdy5pbm5lckhlaWdodCkKCQkJY2FuLkNvbmYoaHRtbC5XSURUSCwgd2luZG93LmlubmVyV2lkdGgpCgkJfQoKCQljYW4uQ29uZihodG1sLk1BUkdJTl9YLCAwLCBodG1sLk1BUkdJTl9ZLCAyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQljYW4ub25sYXlvdXQuX2luaXQoY2FuLCBkb2N1bWVudC5ib2R5KQoKCQljYW4uQ29uZihjaGF0LlJJVkVSLCAiX3NoYXJlIiwgY2hhdC5TVE9STSwgc2hhcmUpCgkJbXNnLkxlbmd0aCgpID4gMCAmJiBjYW4ub25pbXBvcnQuX2luaXQoY2FuLCBtc2cpCgl9KSB9LAoJX2NtZDogZnVuY3Rpb24oY2FuLCBpdGVtLCBuZXh0KSB7CgkJY2FuLmJhc2UuQ29weShpdGVtLCB7CgkJCWhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LWNhbi5Db25mKGh0bWwuTUFSR0lOX1kpKyhjYW4udXNlci5pc1dpbmRvd3M/IDE3OiAwKSwKCQkJd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLAoJCQlvcHRzOiBjYW4ubWlzYy5TZWFyY2goY2FuKSwKCQl9KQoJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBpdGVtLCBmdW5jdGlvbihzdWIsIG1ldGEsIHNraXApIHsKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgsIHdpbmRvdy5pbm5lcldpZHRoKQoJCQljYW4udXNlci50aXRsZShtZXRhLm5hbWUpLCBza2lwIHx8IG5leHQoKQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25lbmdpbmUiLCB7aGVscDogIuino+aekOW8leaTjiIsIGxpc3Q6IFtdLCBfZW5naW5lOiBmdW5jdGlvbihldmVudCwgcGFnZSwgbXNnLCBjYW4sIGNtZHMsIGNiKSB7Cgl2YXIgc3Rvcm0gPSBjYW4uY29yZS5WYWx1ZShjYW4uX3Jvb3QsIGNhbi5jb3JlLktleXMoY2hhdC5SSVZFUiwgY21kc1swXSwgY2hhdC5TVE9STSwgY21kc1sxXSkpCglpZiAoIXN0b3JtIHx8IGNtZHMubGVuZ3RoICE9IDIpIHsgcmV0dXJuIGZhbHNlIH0KCglpZiAoc3Rvcm0uaW5kZXgpIHsgLy8g5ZG95Luk57Si5byVCgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGN0eC5DT01NQU5EXS5jb25jYXQoc3Rvcm0uaW5kZXgpLCBjYikKCX0gZWxzZSB7IC8vIOWRveS7pOWIl+ihqAoJCWNhbi5jb3JlLkxpc3Qoc3Rvcm0ubGlzdCwgZnVuY3Rpb24odmFsdWUpIHsKCQkJbXNnLlB1c2gobWRiLk5BTUUsIHZhbHVlLm5hbWV8fCIiKQoJCQltc2cuUHVzaChtZGIuSEVMUCwgdmFsdWUuaGVscHx8IiIpCgkJCW1zZy5QdXNoKGN0eC5JTlBVVFMsIEpTT04uc3RyaW5naWZ5KHZhbHVlLmlucHV0cykpCgkJCW1zZy5QdXNoKGN0eC5GRUFUVVJFLCBKU09OLnN0cmluZ2lmeSh2YWx1ZS5mZWF0dXJlKSkKCQkJbXNnLlB1c2goY3R4LklOREVYLCB2YWx1ZS5pbmRleHx8IiIpCgkJCW1zZy5QdXNoKGN0eC5BUkdTLCB2YWx1ZS5hcmdzfHwiW10iKQoJCQltc2cuUHVzaChpY2UuTVNHX0FDVElPTiwgdmFsdWUuX2FjdGlvbnx8IiIpCgkJCW1zZy5QdXNoKCJkaXNwbGF5IiwgdmFsdWUuZGlzcGxheXx8IiIpCgkJfSksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJfQoJcmV0dXJuIHRydWUKfX0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5Lqk5LqS5pON5L2cIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIGNiLCB0YXJnZXQpIHsKCQljYW4uQ29uZihodG1sLk1BUkdJTl9ZLCA0Kmh0bWwuUExVR0lOX01BUkdJTisyKmh0bWwuQUNUSU9OX0hFSUdIVCtodG1sLkFDVElPTl9NQVJHSU4pCgkJY2FuLkNvbmYoaHRtbC5NQVJHSU5fWCwgNCpodG1sLlBMVUdJTl9NQVJHSU4pCgoJCWlmIChjYW4udXNlci5tb2QuaXNQb2QgfHwgY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJdmFyIGd0ID0gIiYjMTAwOTU7IiwgbHQgPSAiJiMxMDA5NDsiOyBmdW5jdGlvbiB0b2dnbGUodmlldykgeyByZXR1cm4gIWNhbi5zZXRSaXZlcigiZGlzcGxheSIpIH0KCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtbaHRtbC5UT0dHTEUsIGNoYXQuUFJPSkVDVF1dLCBsaXN0OiBbe3RleHQ6IFtndCwgaHRtbC5ESVZdfV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlldmVudC50YXJnZXQuaW5uZXJIVE1MID0gdG9nZ2xlKCk/IGd0OiBsdAoJCQl9fV0pCgkJfQoKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgInBhcnNlIiwgc2h5KCLop6PmnpAiLCB7CgkJCSJzaG93IjogZnVuY3Rpb24oY2FuLCBtc2csIGNtZHMpIHsKCQkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX2xlZ2VuZCkKCQkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX29wdGlvbikKCQkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX3N0YXR1cykKCgkJCQljYW4uQ29uZkhlaWdodChjYW4uQ29uZkhlaWdodCgpK2Nhbi5Db25mKGh0bWwuTUFSR0lOX1kpLShjYW4udXNlci5pc1dpbmRvd3M/IDE3OiAwKSkKCgkJCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIm1lbnUiLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCBtc2cuT3B0aW9uKGh0bWwuSVRFTSkpIH0pCgkJCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIumrmOe6p+mFjee9riIsIGZ1bmN0aW9uKG1zZykgeyBjYW4udXNlci50b2FzdChjYW4sIG1zZy5PcHRpb24oaHRtbC5JVEVNKSkgfSkKCQkJCWNhbi5vbmVuZ2luZS5saXN0ZW4oY2FuLCAiaDEiLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCAiaDEiKSB9KQoKCQkJCWNhbi5vbmFwcGVuZC5wYXJzZShjYW4sIGNhbi5vbmFwcGVuZC5fcGFyc2UoY2FuLCBjbWRzWzBdKSkKCQkJfSwKCQl9LCBbInRleHQiLCAic2hvdzpidXR0b25AYXV0byJdLCBmdW5jdGlvbihtc2csIGNtZHMsIGNiKSB7IGNhbi5ydW4oe30sIGNtZHMsIGNiLCB0cnVlKSB9KSkKCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJjb29raWUiLCBzaHkoIuaPkOekuiIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQljYW4uY29yZS5JdGVtKGNhbi5taXNjLkNvb2tpZShjYW4pLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCQltc2cuUHVzaCgia2V5Iiwga2V5KQoJCQkJbXNnLlB1c2goInZhbHVlIiwgdmFsdWUpCgkJCX0pCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJhbGVydCIsIHNoeSgi5o+Q56S6Iiwge30sIFsidGV4dCIsICJsaXN0IiwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCWNhbi51c2VyLmFsZXJ0KGNtZHNbMF0pCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJwbHVnaW4iLCBzaHkoIuaPkuS7tiIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQltc2cuRWNobygiaGVsbG8gd29ybGQiKQoJCX0pKQoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAiaW5mbyIsIHNoeSgi5L+h5oGvIiwge30sIFsidGV4dCIsICJsaXN0IiwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCW1zZy5FY2hvKCJoZWxsbyB3b3JsZCIpCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJsb2ciLCBzaHkoIuaXpeW/lyIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQljb25zb2xlLmxvZyhjbWRzWzBdKQoJCX0pKQoKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgIm5mcy5zYXZlIiwgc2h5KCLkv53lrZjmlofku7YiLCB7fSwgWyJmaWxlPWhpLnR4dCIsICJ0ZXh0OnRleHRhcmVhPSdoZWxsbyB3b3JsZCciLCAic2F2ZTpidXR0b24iXSwgZnVuY3Rpb24obXNnLCBjbWRzLCBjYikgewoJCQljYW4ubWlzYy5ydW5BY3Rpb24oY2FuLCBtc2csIGNtZHMsIGNiLCBraXQuRGljdCgKCQkJCSJzYXZlIiwgZnVuY3Rpb24oY21kcykgeyBjYW4udXNlci5kb3dubG9hZHMoY2FuLCBjbWRzWzFdLCBjbWRzWzBdKSB9CgkJCSkpCgkJfSkpCgoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAicGllIiwgc2h5KCLmr5Tkvovlm74iLCB7fSwgWyJsaXN0IiwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCW1zZy5EaXNwbGF5U3RvcnkoInBpZS5qcyIpCgkJCW1zZy5QdXNoKCJ2YWx1ZSIsIDIwMCkKCQkJbXNnLlB1c2goInZhbHVlIiwgMzAwKQoJCQltc2cuUHVzaCgidmFsdWUiLCA0MDApCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJjYW4uY29kZS5pbm5lci5wbHVnaW4iLCBzaHkoIuaPkuS7tiIsIHt9LCBbe3R5cGU6ICJidXR0b24iLCBuYW1lOiAibGlzdCIsIGFjdGlvbjogImF1dG8ifSwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7fSkpCgoJCXRhcmdldC5vbnRvdWNoc3RhcnQgPSBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uYWN0aW9uX3RvdWNoIiwgY2FuLnJlcXVlc3QoZXZlbnQpKQoJCX0sIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJfSwKCV9tZW51czogWwoJCVtjaGF0LkxBWU9VVCwgImF1dG8iLCAidGFicyIsICJncmlkIiwgImZyZWUiLCAiZmxvdyIsICJwYWdlIiwgInRvaW1hZ2UiXSwKCQlbaWNlLkhFTFAsICJ0dXRvciIsICJtYW51YWwiLCAic2VydmljZSIsICJkZXZvcHMiLCAicmVmZXIiXSwKCV0sCglfdHJhbnM6IHsKCQkibGF5b3V0IjogIuW4g+WxgCIsCgkJImF1dG8iOiAi6buY6K6k5biD5bGAIiwKCQkiZmxvdyI6ICLmtYHliqjluIPlsYAiLAoJCSJncmlkIjogIue9keagvOW4g+WxgCIsCgkJInRhYnMiOiAi5qCH562+5biD5bGAIiwKCQkiZnJlZSI6ICLoh6rnlLHluIPlsYAiLAoJCSJwYWdlIjogIue9kemhteW4g+WxgCIsCgkJInRvaW1hZ2UiOiAi55Sf5oiQ5Zu+54mHIiwKCgkJImhlbHAiOiAi5biu5YqpIiwKCQkidHV0b3IiOiAi5YWl6Zeo566A5LuLIiwKCQkibWFudWFsIjogIuS9v+eUqOaJi+WGjCIsCgkJInNlcnZpY2UiOiAi5pyN5Yqh5omL5YaMIiwKCQkiZGV2b3BzIjogIue8lueoi+aJi+WGjCIsCgkJInJlZmVyIjogIuWPguiAg+aJi+WGjCIsCgl9LAoJb25tYWluOiBmdW5jdGlvbihjYW4pIHsKCQljYW4ub25pbXBvcnQuX3NoYXJlKGNhbiwgY2FuLm1pc2MuU2VhcmNoKGNhbiwgd2ViLlNIQVJFKSkKCX0sCglvbmxvZ2luOiBmdW5jdGlvbihjYW4pIHsgaWYgKCFjYW4uQ29uZihjaGF0LlRPT0wpICYmICFjYW4udXNlci5tb2QuaXNDbWQpIHsgcmV0dXJuIH0KCQljYW4uQ29uZihodG1sLk1BUkdJTl9YLCAwLCBodG1sLk1BUkdJTl9ZLCAyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl90YXJnZXQsIGljZS5DTUQpCgkJY2FuLm9ubGF5b3V0Ll9pbml0KGNhbikKCgkJY2FuLl9uYW1lcyA9IGxvY2F0aW9uLnBhdGhuYW1lCgkJY2FuLkNvbmYoY2hhdC5UT09MKT8gY2FuLmNvcmUuTmV4dChjYW4uQ29uZihjaGF0LlRPT0wpLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCWNhbi5vbmltcG9ydC5fY21kKGNhbiwgaXRlbSwgbmV4dCkKCgkJfSk6IGNhbi5ydW4oY2FuLnJlcXVlc3QoKS5fZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09NTUFORF0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4uY29yZS5OZXh0KG1zZy5UYWJsZSgpLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCQljYW4ub25pbXBvcnQuX2NtZChjYW4sIGl0ZW0sIG5leHQpCgkJCX0pCgkJfSkKCX0sCglvbnN0b3JtX3NlbGVjdDogZnVuY3Rpb24oY2FuLCBtc2csIHJpdmVyLCBzdG9ybSkgeyBjYW4ub25sYXlvdXQuX2luaXQoY2FuKQoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsKCQkJdmFyIGtleSA9IGNhbi5jb3JlLktleXMoY2FuLkNvbmYoY2hhdC5SSVZFUiwgcml2ZXIpLCBjYW4uQ29uZihjaGF0LlNUT1JNLCBzdG9ybSkpCgkJCXJldHVybiBrZXkKCQl9LCBjYW4uX2FjdGlvbiwgY2FuLl9vdXRwdXQpKSB7CgkJCXZhciBjb25mID0gY2FuLmNvcmUuVmFsdWUoY2FuLl9yb290LCBjYW4uY29yZS5LZXlzKGNoYXQuUklWRVIsIHJpdmVyLCBjaGF0LlNUT1JNLCBzdG9ybSkpfHx7fQoJCQljYW4ub25hY3Rpb24ubGF5b3V0KGNhbiwgY29uZi5sYXlvdXR8fGNhbi5taXNjLlNlYXJjaE9yQ29uZihjYW4sIGNoYXQuTEFZT1VUKXx8Vm9sY2Fub3MubWV0YS5hcmdzLmxheW91dHx8ImF1dG8iLCB0cnVlKQoJCQlyZXR1cm4KCQl9CgoJCWNhbi5ydW4oe30sIFtyaXZlciwgc3Rvcm1dLCBmdW5jdGlvbihtc2cpIHsgaWYgKG1zZy5MZW5ndGgoKSA+IDApIHsgcmV0dXJuIGNhbi5vbmltcG9ydC5faW5pdChjYW4sIG1zZykgfQoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uYWN0aW9uX25vdG9vbCIsIGNhbi5yZXF1ZXN0KHt9LCB7cml2ZXI6IHJpdmVyLCBzdG9ybTogc3Rvcm19KSkKCQl9KQoJfSwKCW9uc2VhcmNoOiBmdW5jdGlvbihjYW4sIG1zZywgd29yZCkgewoJCWlmICh3b3JkWzBdID09IG1kYi5QTFVHSU4gfHwgd29yZFsxXSAhPSAiIikgeyBjYW4ub25leHBvcnQucGx1Z2luKGNhbiwgbXNnLCB3b3JkKSB9Cgl9LAoJb25zaXplOiBmdW5jdGlvbihjYW4sIG1zZywgaGVpZ2h0LCB3aWR0aCkgeyBjYW4uQ29uZih7aGVpZ2h0OiBoZWlnaHQsIHdpZHRoOiB3aWR0aH0pIH0sCgoJaGVscDogZnVuY3Rpb24oY2FuLCBidXR0b24pIHsgY2FuLnVzZXIub3BlbigiL2hlbHAvIitidXR0b24rIi5zaHkiKSB9LAoJbGF5b3V0OiBmdW5jdGlvbihjYW4sIGJ1dHRvbiwgc2lsZW50KSB7CgkJaWYgKGJ1dHRvbiA9PSAidG9pbWFnZSIpIHsKCQkJY2FuLm9ubW90aW9uLnRvaW1hZ2UoZXZlbnQsIGNhbiwgZG9jdW1lbnQudGl0bGUsIGNhbi5fb3V0cHV0KQoJCQlyZXR1cm4KCQl9CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIGNhbi5fdGFyZ2V0LCBjYW4uQ29uZihjaGF0LkxBWU9VVCkpCgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fdGFyZ2V0LCBjYW4uQ29uZihjaGF0LkxBWU9VVCwgYnV0dG9uKSkKCgkJaWYgKGJ1dHRvbiA9PSAiYXV0byIpIHsKCQkJY2FuLkNvbmYoY2hhdC5MQVlPVVQsICIiKQoKCQl9IGVsc2UgaWYgKGJ1dHRvbiA9PSAidGFicyIpIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLkZJRUxEU0VUX1BMVUdJTiwgMCkKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fYWN0aW9uLCBodG1sLkRJVl9UQUJTLCAwKQoJCX0gZWxzZSBpZiAoYnV0dG9uID09ICJmcmVlIikgewoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX3RhcmdldCwgW1todG1sLkRJVl9PVVRQVVQsIGh0bWwuRklFTERTRVRfUExVR0lOXV0sIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBpdGVtLCB7c3R5bGU6IHtsZWZ0OiA0MCppbmRleCwgdG9wOiA0MCppbmRleH19KQoJCQkJY2FuLm9ubW90aW9uLm1vdmUoY2FuLCBpdGVtLCB7bGVmdDogNDAqaW5kZXgsIHRvcDogNDAqaW5kZXh9KQoJCQl9KQoJCX0gZWxzZSBpZiAoYnV0dG9uID09ICJncmlkIikgewoJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6ICJtIiwgdmFsdWU6IDJ9LCB7bmFtZTogIm4iLCB2YWx1ZTogMn1dLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQljYW4uZ2V0QWN0aW9uU2l6ZShmdW5jdGlvbihoZWlnaHQsIHdpZHRoKSB7IHZhciBtID0gcGFyc2VJbnQoZGF0YS5tKXx8MiwgbiA9IHBhcnNlSW50KGRhdGEubil8fDIKCQkJCQljYW4ucGFnZS5jc3MoY2FuLmJhc2UucmVwbGFjZUFsbChjaGF0LkFDVElPTl9MQVlPVVRfRk1ULCAiX3dpZHRoIiwgKHdpZHRoLSg0Km0rMSkqaHRtbC5QTFVHSU5fTUFSR0lOKS9tKyJweCIsICJfaGVpZ2h0IiwgKGhlaWdodC0oNCpuKzEpKmh0bWwuUExVR0lOX01BUkdJTikvbisicHgiKSkKCQkJCX0pCgkJCX0sIHNpbGVudCkKCQl9CgkJY2FuLm9ubGF5b3V0Ll9pbml0KGNhbikKCX0sCn0pClZvbGNhbm9zKCJvbmtleW1hcCIsIHtoZWxwOiAi6ZSu55uY5Lqk5LqSIiwgbGlzdDogW10sIF9mb2N1czogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCWNhbi5vbmtleW1hcC5fYnVpbGQoY2FuKSwgY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sICJvbmtleWRvd24iLCBmdW5jdGlvbihtc2csIG1vZGVsKSB7CgkJCWNhbi5fa2V5bGlzdCA9IGNhbi5vbmtleW1hcC5fcGFyc2UobXNnLl9ldmVudCwgY2FuLCBtb2RlbCwgY2FuLl9rZXlsaXN0fHxbXSwgY2FuLl9vdXRwdXQpCgkJfSkKCX0sCglfbW9kZTogewoJCW5vcm1hbDogewoJCQlqOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdGFyZ2V0LnNjcm9sbEJ5KDAsIGV2ZW50LmN0cmxLZXk/IDMwMDogMzApIH0sCgkJCWs6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyB0YXJnZXQuc2Nyb2xsQnkoMCwgZXZlbnQuY3RybEtleT8gLTMwMDogLTMwKSB9LAoKCQkJYjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5zZWFyY2goZXZlbnQsIFsiSGVhZGVyLm9uYWN0aW9uLmJsYWNrIl0pIH0sCgkJCXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIkhlYWRlci5vbmFjdGlvbi53aGl0ZSJdKSB9LAoKCQkJZzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5zZWFyY2goZXZlbnQsIFsiUml2ZXIub25kZXRhaWwu5Yib5bu6576k57uEIl0pIH0sCgkJCXM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIlJpdmVyLm9uZGV0YWlsLua3u+WKoOW6lOeUqCJdKSB9LAoJCQl0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLnNlYXJjaChldmVudCwgWyJSaXZlci5vbmRldGFpbC7mt7vliqDlt6XlhbciXSkgfSwKCgkJCSIgIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uc2VhcmNoZm9jdXMiKQoJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCX0sCgkJCSI6IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uY29tbWFuZGZvY3VzIikKCQkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9LAoJCQllbnRlcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5taXNjLkxvZygiZW50ZXIiKSB9LAoJCQllc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgewoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZG9jdW1lbnQuYm9keSwgaHRtbC5GSUVMRFNFVF9BVVRPLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJLy8gY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGl0ZW0pCgkJCQl9KQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZG9jdW1lbnQuYm9keSwgY2FuLnBhZ2UuS2V5cyhodG1sLkZJRUxEU0VUX0ZMT0FULCBodG1sLkRJVl9GTE9BVCksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBpdGVtKQoJCQkJfSkKCQkJfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW10sCglhcmdzOiBmdW5jdGlvbihjYW4sIGNiLCB0YXJnZXQpIHsKCQljYW4uY29yZS5OZXh0KGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgW1todG1sLkZJRUxEU0VUX1BMVUdJTiwgaHRtbC5GT1JNX09QVElPTl1dKSwgZnVuY3Rpb24oaXRlbSwgbmV4dCwgaW5kZXgsIGFycmF5KSB7CgkJCWl0ZW0uZGF0YXNldC5hcmdzID0gSlNPTi5zdHJpbmdpZnkoY2FuLnBhZ2UuU2VsZWN0KGNhbiwgaXRlbSwgaHRtbC5PUFRJT05fQVJHUywgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS52YWx1ZXx8IiIgfSkpCgkJCWNiKGl0ZW0sIG5leHQsIGluZGV4LCBhcnJheSkKCQl9KQoJfSwKCXNpemU6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJbXNnLk9wdGlvbihodG1sLlRPUCwgY2FuLl90YXJnZXQub2Zmc2V0VG9wKQoJCW1zZy5PcHRpb24oaHRtbC5MRUZULCBjYW4uX3RhcmdldC5vZmZzZXRMZWZ0KQoJCW1zZy5PcHRpb24oaHRtbC5XSURUSCwgY2FuLl90YXJnZXQub2Zmc2V0V2lkdGgpCgkJaWYgKG1zZy5PcHRpb24oaHRtbC5IRUlHSFQsIGNhbi5fdGFyZ2V0Lm9mZnNldEhlaWdodC1jYW4uX2FjdGlvbi5vZmZzZXRIZWlnaHQpID4gd2luZG93LmlubmVySGVpZ2h0KSB7CgkJCW1zZy5PcHRpb24oaHRtbC5IRUlHSFQsIHdpbmRvdy5pbm5lckhlaWdodC0yKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQl9CgkJbXNnLk9wdGlvbihodG1sLlNDUk9MTCwgY2FuLnVzZXIuaXNNb2JpbGU/IGNhbi5fdGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5zY3JvbGxUb3A6IGNhbi5fb3V0cHV0LnNjcm9sbFRvcCkKCQltc2cuT3B0aW9uKGh0bWwuTUFSR0lOX1gsIGNhbi5Db25mKGh0bWwuTUFSR0lOX1gpKQoJCW1zZy5PcHRpb24oaHRtbC5NQVJHSU5fWSwgY2FuLkNvbmYoaHRtbC5NQVJHSU5fWSkpCgl9LAoJbGF5b3V0OiBmdW5jdGlvbihjYW4sIG1zZykgeyByZXR1cm4gY2FuLkNvbmYoY2hhdC5MQVlPVVQpIH0sCglwbHVnaW46IGZ1bmN0aW9uKGNhbiwgbXNnLCB3b3JkKSB7IHZhciBmaWVsZHMgPSBjYW4uY29yZS5TcGxpdChtc2cuT3B0aW9uKGljZS5NU0dfRklFTERTKSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgW1todG1sLkZJRUxEU0VUX1BMVUdJTiwgaHRtbC5MRUdFTkRdXSwgZnVuY3Rpb24oaXRlbSkgewoJCQlpZiAoaXRlbS5pbm5lckhUTUwuaW5kZXhPZih3b3JkWzFdKSA9PSAtMSkgeyByZXR1cm4gfQoKCQkJdmFyIG1ldGEgPSBpdGVtLnBhcmVudE5vZGUuX21ldGEKCQkJdmFyIGxpc3QgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBpdGVtLm5leHRTaWJsaW5nLCBodG1sLk9QVElPTl9BUkdTLCBmdW5jdGlvbihpdGVtKSB7IHJldHVybiBpdGVtLnZhbHVlfHwiIiB9KQoKCQkJdmFyIGRhdGEgPSB7Y3R4OiAid2ViLmNoYXQiLCBjbWQ6IGN0eC5BQ1RJT04sCgkJCQl0eXBlOiBtZGIuUExVR0lOLCBuYW1lOiBpdGVtLmlubmVySFRNTCwgdGV4dDogc2h5KCLot7PovawiLCBmdW5jdGlvbihldmVudCkgewoJCQkJCXZhciBpbnB1dCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGl0ZW0ucGFyZW50Tm9kZSwgaHRtbC5JTlBVVF9BUkdTKVswXQoJCQkJCWlucHV0ICYmIGlucHV0LmZvY3VzKCkKCQkJCX0pLCBhcmd1bWVudDogSlNPTi5zdHJpbmdpZnkobGlzdCksCgkJCX0KCQkJaWYgKG1ldGEuaW5kZXgpIHsKCQkJCWRhdGEuY29udGV4dCA9ICIiLCBkYXRhLmNvbW1hbmQgPSBtZXRhLmluZGV4CgkJCX0gZWxzZSBpZiAobWV0YS5jbWQpIHsKCQkJCWRhdGEuY29udGV4dCA9IG1ldGEuY3R4LCBkYXRhLmNvbW1hbmQgPSBtZXRhLmNtZAoJCQl9IGVsc2UgewoJCQkJcmV0dXJuCgkJCX0KCQkJbXNnLlB1c2goZGF0YSwgZmllbGRzKQoJCX0pCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvc2VhcmNoLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ubGlzdCA9IG1zZy5UYWJsZSgpLCBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkuY29udGVudCkKCQl2YXIgdGFibGUgPSBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkgeyBjYW4uU3RhdHVzKG1kYi5UT1RBTCwgaW5kZXgrMSkKCQkJcmV0dXJuIHt0ZXh0OiBba2V5ID09IG1kYi5URVhUICYmIGNhbi5iYXNlLmlzRnVuYyhsaW5lLnRleHQpICYmIGxpbmUudGV4dC5oZWxwIHx8IHZhbHVlLCBodG1sLlREXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbltjYW4udHlwZSA9PSAiKiJ8fGV2ZW50LmN0cmxLZXk/IGNoYXQuUExVR0lOOiBtZGIuU0VMRUNUXShldmVudCwgY2FuLCBpbmRleCkgCgkJCX19CgkJfSwgY2FuLnVpLmNvbnRlbnQsIGNhbi5jb3JlLkxpc3QoKG1zZy5PcHRpb24oInNvcnQiKXx8ImN0eCxjbWQsdHlwZSxuYW1lLHRleHQiKS5zcGxpdChpY2UuRlMpLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiBsaXN0LmluZGV4T2YoaXRlbSkKCQl9KSk7IHRhYmxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5kaXNwbGF5LCB7c3R5bGU6IHt3aWR0aDogdGFibGUub2Zmc2V0V2lkdGh9fSkKCQljYW4ub25tb3Rpb24uc3RvcnkuYXV0byhjYW4pCgoJCWNhbi5vbmFwcGVuZC5fc3RhdHVzKGNhbiwgY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oIl9zdGF0dXMiKSwgW10pLmNvbmNhdCh7bmFtZTogInNlbGVjdGVkIiwgdmFsdWU6ICIwIn0pKQoJCWNhbi5nZXRBY3Rpb25TaXplKGZ1bmN0aW9uKG1zZywgaGVpZ2h0KSB7CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9maWxlLCBraXQuRGljdChodG1sLk1BWF9IRUlHSFQsIGNhbi5iYXNlLk1pbihoZWlnaHQtKHRhYmxlJiZ0YWJsZS5vZmZzZXRIZWlnaHR8fDApLCBoZWlnaHQvMikpKQoJCX0pCgkJbXNnLkxlbmd0aCgpID09IDEgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFibGUsIGh0bWwuVEQpWzBdLmNsaWNrKCkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgIkEiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi51c2VyLm9wZW4oaXRlbS5ocmVmKSwgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpIH0KCQl9KQoJfSwKCV93b3JkOiBmdW5jdGlvbihjYW4sIG1zZywgY21kcywgZmllbGRzKSB7IGNhbi50eXBlID0gY21kc1swXQoJCXZhciBjYiA9IGNhbi5vbmFjdGlvbltjbWRzWzFdXTsgaWYgKGNiKSB7IGNiKHt9LCBjYW4pOyByZXR1cm4gfQoKCQl2YXIgcmVzID0gY2FuLnJlcXVlc3Qoe30sIHsKCQkJd29yZDogY21kcywgZmllbGRzOiBmaWVsZHMuam9pbihpY2UuRlMpLCBzb3J0OiBtc2cuT3B0aW9uKCJzb3J0IiksCgkJCXJpdmVyOiBtc2cuT3B0aW9uKGNoYXQuUklWRVIpLCBpbmRleDogbXNnLk9wdGlvbigiaW5kZXgiKSwKCQl9KQoKCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTlNFQVJDSCwgcmVzKQoJCWNhbi5ydW4ocmVzLl9ldmVudCwgY21kcywgZnVuY3Rpb24ocmVzKSB7IGNhbi5vbmltcG9ydC5faW5pdChjYW4sIHJlcywgZmllbGRzKSB9KQoJCWNhbi5vbm1vdGlvbi5zaG93KGNhbiksIGNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIGNhbi51aS53b3JkKQoJfSwKCglzZWxlY3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYikgeyBjYW4udWkud29yZC52YWx1ZSA9IGNtZHNbMV0KCQl2YXIgZmllbGRzID0gKGNtZHNbMl18fG1zZy5PcHRpb24oaWNlLk1TR19GSUVMRFMpfHwiY3R4LGNtZCx0eXBlLG5hbWUsdGV4dCIpLnNwbGl0KGljZS5GUykKCQljYW4ucGFnZS5BcHBlbmRzKGNhbiwgY2FuLnVpLmRpc3BsYXksIFt7dGg6IGZpZWxkc31dKSwgY2FuLmNiID0gZnVuY3Rpb24oKSB7CgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoY2FuLm9uZXhwb3J0LnNlbGVjdChjYW4pKSwgY2FuLm9ubW90aW9uLmhpZGUoY2FuKQoJCX0KCgkJY2FuLmlucHV0ID0gZnVuY3Rpb24oZXZlbnQsIHdvcmQpIHsgY21kc1sxXSA9IHdvcmR8fGNtZHNbMV0KCQkJY2FuLm9uaW1wb3J0Ll93b3JkKGNhbiwgbXNnLCBjbWRzLCBmaWVsZHMpCgkJfSwgY2FuLm9uaW1wb3J0Ll93b3JkKGNhbiwgbXNnLCBjbWRzLCBmaWVsZHMpCgoJCWNhbi5nZXRBY3Rpb25TaXplKGZ1bmN0aW9uKG1zZywgdG9wLCBsZWZ0LCB3aWR0aCwgaGVpZ2h0KSB7CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IHRvcCwgbGVmdDogbGVmdH19KQoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4uX291dHB1dCwge3N0eWxlOiBraXQuRGljdChodG1sLk1BWF9IRUlHSFQsIGhlaWdodC03MSwgaHRtbC5NQVhfV0lEVEgsIHdpZHRoLTIqaHRtbC5QTFVHSU5fTUFSR0lOKX0pCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5jb250ZW50LCB7c3R5bGU6IGtpdC5EaWN0KGh0bWwuTUFYX1dJRFRILCB3aWR0aC0yKmh0bWwuUExVR0lOX01BUkdJTil9KQoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkuZGlzcGxheSwge3N0eWxlOiBraXQuRGljdChodG1sLk1BWF9XSURUSCwgd2lkdGgtMipodG1sLlBMVUdJTl9NQVJHSU4pfSkKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmk43kvZwiLCBsaXN0OiBbY2xpLkNMRUFSLCBjbGkuQ0xPU0UsIGNsaS5ET05FXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX3RhcmdldCkKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCX0sCglvbmxvZ2luOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgY2FuLkNvbmYoaHRtbC5BQ1RJT04pfHxjYW4ub25hY3Rpb24ubGlzdCkKCQljYW4udWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgWwoJCQl7aW5wdXQ6IFsid29yZCIsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmtleW1hcC5pbnB1dChldmVudCwgY2FuKQoJCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVTQ0FQRSkgeyBjYW4ub25tb3Rpb24uaGlkZShjYW4pIH0KCgkJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRU5URVIpIHsgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCQkJaWYgKGV2ZW50LnNoaWZ0S2V5KSB7IHZhciBmaXJzdCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBodG1sLlRSKVsxXQoJCQkJCQlyZXR1cm4gY2FuLm9uYWN0aW9uW2Nhbi50eXBlID09ICIqIj8gY2hhdC5QTFVHSU46IGh0bWwuU0VMRUNUXShldmVudCwgY2FuLCBmaXJzdC5kYXRhc2V0LmluZGV4KQoJCQkJCX0KCQkJCQlpZiAoZXZlbnQuY3RybEtleSkgeyByZXR1cm4gY2FuLm9uYWN0aW9uW2NsaS5ET05FXShldmVudCwgY2FuKSB9CgkJCQkJY2FuLmlucHV0KGV2ZW50LCBldmVudC50YXJnZXQudmFsdWUpCgkJCQl9CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24odHIsIGluZGV4KSB7CgkJCQkJaWYgKGluZGV4ID09IDApIHsgcmV0dXJuIH0KCQkJCQl2YXIgaGFzID0gZmFsc2U7IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgewoJCQkJCQloYXMgPSBoYXMgfHwgdGQuaW5uZXJUZXh0LmluZGV4T2YoZXZlbnQudGFyZ2V0LnZhbHVlKSA+IC0xCgkJCQkJfSkKCQkJCQljYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgdHIsIGh0bWwuSElEREVOLCAhaGFzKQoJCQkJfSkKCQkJfV19LAoJCQl7dmlldzogY2hhdC5DT05URU5UfSwge3ZpZXc6IGh0bWwuU1RBVFVTfSwge3ZpZXc6IFtjaGF0LkRJU1BMQVksIGh0bWwuVEFCTEVdfSx7dmlldzogY2hhdC5QUk9GSUxFfSwKCQldKSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi51aS5kaXNwbGF5LCBjaGF0LkNPTlRFTlQpCgl9LAoJb25vcGVuc2VhcmNoOiBmdW5jdGlvbihjYW4sIG1zZywgdHlwZSwgd29yZCkgeyBjYW4ub25pbXBvcnQuc2VsZWN0KGNhbiwgbXNnLCBbdHlwZXx8IioiLCB3b3JkfHwiIl0pIH0sCgoJY2xlYXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLnByb2ZpbGUpIH0sCglkb25lOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5iYXNlLmlzRnVuYyhjYW4uY2IpICYmIGNhbi5jYigpIH0sCgljbG9zZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24uaGlkZShjYW4pIH0sCgoJc2VsZWN0OiBmdW5jdGlvbihldmVudCwgY2FuLCBpbmRleCkgeyB2YXIgbGluZSA9IGNhbi5saXN0W2luZGV4XQoJCWlmIChjYW4uYmFzZS5pc0Z1bmMobGluZS50ZXh0KSkgeyByZXR1cm4gY2FuLm9ubW90aW9uLmhpZGUoY2FuKSwgbGluZS50ZXh0KGV2ZW50KSB9CgoJCWlmIChsaW5lLmN0eCA9PSAid2ViLmNoYXQiICYmIGxpbmUuY21kID09ICIvc2VhcmNoIikgewoJCQlyZXR1cm4gY2FuLm9uaW1wb3J0LnNlbGVjdChjYW4sIG1zZywgW2xpbmUudHlwZSwgbGluZS5uYW1lLCBsaW5lLnRleHRdLCBjYW4uY2IpCgkJfQoKCQl2YXIgZmllbGRzID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmRpc3BsYXksIGh0bWwuVEgsIGZ1bmN0aW9uKGl0ZW0pIHsgcmV0dXJuIGl0ZW0uaW5uZXJUZXh0IH0pCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmRpc3BsYXksIFt7dGQ6IGNhbi5jb3JlLkxpc3QoZmllbGRzLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiBsaW5lW2l0ZW1dCgkJfSksIGRhdGE6IHtpbmRleDogaW5kZXh9LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBldmVudC50YXJnZXQucGFyZW50Tm9kZSkKCQkJY2FuLlN0YXR1cygic2VsZWN0ZWQiLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuZGlzcGxheSwgaHRtbC5UUikubGVuZ3RoLTEpCgkJfX1dKSwgY2FuLlN0YXR1cygic2VsZWN0ZWQiLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuZGlzcGxheSwgaHRtbC5UUikubGVuZ3RoLTEpCgl9LAoKCXBsdWdpbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgaW5kZXgpIHsgdmFyIGxpbmUgPSBjYW4ubGlzdFtpbmRleF0KCQlpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT0gIkEiKSB7IHJldHVybiB9CgkJaWYgKGxpbmUuY3R4ID09ICJ3ZWIud2lraSIgJiYgbGluZS5jbWQgPT0gIndvcmQiKSB7IHJldHVybiB9CgkJaWYgKGNhbi5iYXNlLmlzRnVuYyhsaW5lLnRleHQpKSB7IHJldHVybiBjYW4ub25tb3Rpb24uaGlkZShjYW4pLCBsaW5lLnRleHQoZXZlbnQpIH0KCgkJdmFyIGNtZCA9IGxpbmUuY21kID09IGN0eC5DT01NQU5EPyBjYW4uY29yZS5LZXlzKGxpbmUudHlwZSwgbGluZS5uYW1lLnNwbGl0KGljZS5TUClbMF0pOiBjYW4uY29yZS5LZXlzKGxpbmUuY3R4LCBsaW5lLmNtZCkKCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwge3R5cGU6IGNoYXQuUExVR0lOLCBpbmRleDogY21kfHxtc2cuT3B0aW9uKG1kYi5JTkRFWCl9LCBmdW5jdGlvbihzdWIsIG1ldGEpIHsKCQkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obXNnLCBoZWlnaHQsIHdpZHRoKSB7IGhlaWdodCA9IGNhbi5iYXNlLk1pbihoZWlnaHQgLSBjYW4udWkuY29udGVudC5vZmZzZXRIZWlnaHQrMjA0LCBoZWlnaHQvMikKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fb3V0cHV0LCB7c3R5bGU6IGtpdC5EaWN0KGh0bWwuTUFYX0hFSUdIVCwgaGVpZ2h0LTI2LCBodG1sLk1BWF9XSURUSCwgd2lkdGgtNDApfSkKCQkJCXN1Yi5Db25mKGh0bWwuSEVJR0hULCBoZWlnaHQrMjgpLCBzdWIuQ29uZihodG1sLldJRFRILCB3aWR0aC02MCkKCQkJfSkKCgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIG1ldGEuaW5kZXhdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQkJc3ViLkZvY3VzKCkKCQl9LCBjYW4udWkucHJvZmlsZSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW10sCglzZWxlY3Q6IGZ1bmN0aW9uKGNhbikgewoJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuZGlzcGxheSwgaHRtbC5UUiwgZnVuY3Rpb24odHIpIHsKCQkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgeyByZXR1cm4gdGQuaW5uZXJIVE1MIH0pCgkJfSkuc2xpY2UoMSkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wYW5lbC9mb290ZXIuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pCgkJY2FuLm9uaW1wb3J0Ll90aXRsZShjYW4sIG1zZywgdGFyZ2V0KQoJCWNhbi5vbmltcG9ydC5fc3RhdGUoY2FuLCBtc2csIHRhcmdldCkKCQljYW4ub25pbXBvcnQuX3RvYXN0KGNhbiwgbXNnLCB0YXJnZXQpCgkJY2FuLm9uaW1wb3J0Ll9jbGkoY2FuLCBtc2csIHRhcmdldCkKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCgkJY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsKCQkJd2luZG93LndlYnZpZXcgJiYgY2FuLnNldEhlYWRlck1lbnUoWyLlkI7pgIAiLCAi5YiX6KGoIl0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGxpc3QpIHsKCQkJCXN3aXRjaCAoYnV0dG9uKSB7CgkJCQkJY2FzZSAi5ZCO6YCAIjogaGlzdG9yeS5iYWNrKCk7IGJyZWFrCgkJCQkJY2FzZSAi5YiX6KGoIjogd2luZG93Lm1lbnUoKTsgYnJlYWsKCQkJCX0KCQkJCWNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25hY3Rpb24sIGxpc3RbMF1dLCBbY2FuLCBidXR0b25dKQoJCQl9KQoJCX0pCgl9LAoJX3RpdGxlOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJIWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5jb3JlLkxpc3QobXNnLnJlc3VsdCwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2NoYXQuVElUTEUsIGh0bWwuRElWLCBpdGVtXSwgdGl0bGU6ICLogZTns7vnq5nplb8ifV0pCgkJfSkKCX0sCglfc3RhdGU6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4uY29yZS5MaXN0KGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKGNoYXQuU1RBVEUpfHxjYW4uQ29uZihjaGF0LlNUQVRFKSwgWyJuY21kIl0pLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2FuLmJhc2Uuam9pbihbY2hhdC5TVEFURSwgaXRlbV0pLCBodG1sLkRJViwgY2FuLkNvbmYoaXRlbSldLCBsaXN0OiBbCgkJCQl7dGV4dDogW2l0ZW0sIGh0bWwuTEFCRUxdfSwge3RleHQ6IFsiOiAiLCBodG1sLkxBQkVMXX0sIHt0ZXh0OiBbY2FuLkNvbmYoaXRlbSl8fCIiLCBodG1sLlNQQU4sIGl0ZW1dfSwKCQkJXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5zaG93ID0gY2FuLnNob3c/IChjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uc2hvdyksIG51bGwpOiBjYW4ub25hY3Rpb24uX2NtZChjYW4pCgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4uc2hvdywge3N0eWxlOiB7bGVmdDogIiIsIHRvcDogIiIsIHJpZ2h0OiAwLCBib3R0b206IGNhbi5vbmV4cG9ydC5oZWlnaHQoY2FuKX19KQoJCQl9fV0pCgkJfSkKCX0sCglfdG9hc3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4udG9hc3QgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogY2hhdC5UT0FTVCwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnNob3cgPSBjYW4uc2hvdz8gKGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5zaG93KSwgbnVsbCk6IGNhbi5vbmFwcGVuZC5mbG9hdChjYW4sIGNhbi5fdG9hc3QpLmZpcnN0CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5zaG93LCB7c3R5bGU6IHtsZWZ0OiAiIiwgdG9wOiAiIiwgcmlnaHQ6IDAsIGJvdHRvbTogY2FuLm9uZXhwb3J0LmhlaWdodChjYW4pfX0pCgkJfX1dKS5maXJzdAoJfSwKCV9jbGk6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4ub25hcHBlbmQuaW5wdXQoY2FuLCB7dHlwZTogaHRtbC5URVhULCBuYW1lOiAiY21kIiwgb25rZXlkb3duOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbik7IGlmIChldmVudC5rZXkgIT0gbGFuZy5FTlRFUikgeyByZXR1cm4gfQoJCQlzd2l0Y2ggKGV2ZW50LnRhcmdldC52YWx1ZSkgewoJCQkJY2FzZSBjbGkuQ0xFQVI6IGNhbi5jbGkgJiYgY2FuLmNsaS5jbG9zZSgpOyBicmVhawoJCQkJY2FzZSBjbGkuQ0xPU0U6IGNhbi5jbGkgJiYgY2FuLmNsaS5jbG9zZSgpOyBicmVhawoJCQkJZGVmYXVsdDoKCQkJCQljYW4ucnVuKGV2ZW50LCBbaWNlLlJVTl0uY29uY2F0KGNhbi5jb3JlLlNwbGl0KGV2ZW50LnRhcmdldC52YWx1ZSwgaWNlLlNQKSksIGZ1bmN0aW9uKG1zZykgewoJCQkJCQljYW4uY2xpICYmIGNhbi5jbGkuY2xvc2UoKQoJCQkJCQljYW4uY2xpID0gY2FuLm9uYXBwZW5kLmZsb2F0KGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgbGlzdCkgewoKCQkJCQkJfSksIGNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5jbGkuZmlyc3QsIHtzdHlsZToge2JvdHRvbTogY2FuLm9uZXhwb3J0LmhlaWdodChjYW4pLCB0b3A6ICIifX0pCgkJCQkJfSkKCQkJfQoJCX19LCAiIiwgdGFyZ2V0LCAidGl0bGUgY21kIikKCX0sCgoJdG9hc3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0aXRsZSwgY29udGVudCwgZmlsZWxpbmUsIHRpbWUpIHsgY2FuLl90b2FzdCA9IGNhbi5fdG9hc3R8fGNhbi5yZXF1ZXN0KCkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udG9hc3QsIFt0aW1lLnNwbGl0KGljZS5TUCkucG9wKCksIHRpdGxlLCBjb250ZW50XS5qb2luKGljZS5TUCkpCgkJY2FuLl90b2FzdC5QdXNoKHt0aW1lOiB0aW1lLCBmaWxlbGluZTogZmlsZWxpbmUsIHRpdGxlOiB0aXRsZSwgY29udGVudDogY29udGVudH0pCgl9LAoJbmNtZDogZnVuY3Rpb24oY2FuLCBtc2csIF9mb2xsb3csIF9jbWRzKSB7IHZhciBOQ01EID0gIm5jbWQiOyBjYW4uX2NtZHMgPSBjYW4uX2NtZHN8fGNhbi5yZXF1ZXN0KCkKCQljYW4uX2NtZHMuUHVzaCh7dGltZTogY2FuLmJhc2UuVGltZSgpLCBmb2xsb3c6IF9mb2xsb3csIGNtZHM6IF9jbWRzfSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgY2FuLmNvcmUuS2V5cyhodG1sLlNQQU4sIE5DTUQpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uaW5uZXJIVE1MID0gY2FuLkNvbmYoTkNNRCwgcGFyc2VJbnQoY2FuLkNvbmYoTkNNRCl8fCIwIikrMSsiIikrIiIKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJLy8gY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0KCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCX0sCglvbmxvZ2luOiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4ucnVuKHt9LCBbXSwgZnVuY3Rpb24obXNnKSB7IGNhbi5vbmltcG9ydC5faW5pdChjYW4sIG1zZywgW10sIG51bGwsIGNhbi5fb3V0cHV0KSB9KSB9LAoJb250b2FzdDogZnVuY3Rpb24oY2FuLCBtc2cpIHsgY2FuLmNvcmUuQ2FsbEZ1bmMoY2FuLm9uaW1wb3J0LnRvYXN0LCB7Y2FuOiBjYW4sIG1zZzogbXNnfSkgfSwKCW9ucmVtb3RlOiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4uY29yZS5DYWxsRnVuYyhjYW4ub25pbXBvcnQubmNtZCwge2NhbjogY2FuLCBtc2c6IG1zZ30pIH0sCglvbmNvbW1hbmRmb2N1czogZnVuY3Rpb24oY2FuKSB7IAoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAiZGl2LmNtZCBpbnB1dCIsIGZ1bmN0aW9uKHRhcmdldCkgeyB0YXJnZXQuZm9jdXMoKSB9KQoJfSwKCglfY21kOiBmdW5jdGlvbihjYW4pIHsKCQlyZXR1cm4gY2FuLm9uYXBwZW5kLmZsb2F0KGNhbiwgY2FuLl9jbWRzLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgbGlzdCkgewoJCQl2YXIgY21kcyA9IGNhbi5iYXNlLk9iaihsaW5lLmNtZHMpOyBzd2l0Y2ggKGxpbmUuZm9sbG93KSB7CgkJCQljYXNlICJjaGF0LkFjdGlvbiI6IGNtZHMgPSBjbWRzLnNsaWNlKDIpOyBicmVhawoJCQkJY2FzZSAiY2hhdC5Gb290ZXIiOiBjbWRzID0gY21kcy5zbGljZSgyKTsgYnJlYWsKCQkJfQoJCQlzd2l0Y2ggKGNtZHNbMF0pIHsKCQkJCWNhc2UgIndlYi53aWtpLndvcmQiOiBjbWRzID0gY21kcy5zbGljZSg1KTsgYnJlYWsKCQkJfQoKCQkJY2FuLmdldCgiQWN0aW9uIiwgInNpemUiLCBmdW5jdGlvbihtc2csIHRvcCwgbGVmdCwgd2lkdGgsIGhlaWdodCkgewoJCQkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHtpbmRleDogY21kc1swXSwgYXJnczogY21kcy5zbGljZSgxKSwgaGVpZ2h0OiBoZWlnaHQtMTAwLCB3aWR0aDogd2lkdGh9LCBmdW5jdGlvbihzdWIpIHsKCQkJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZCwgY2IpIHsKCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIGNtZHNbMF1dLCBjbWQpLCBjYikKCQkJCQl9CgoJCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IHRvcCsxMDAsIGxlZnQ6IGxlZnR9fSkKCQkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBzdWIuX2xlZ2VuZCwge3N0eWxlOiB7ZGlzcGxheTogaHRtbC5CTE9DS319KQoJCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fb3V0cHV0LCB7c3R5bGU6IHsibWF4LXdpZHRoIjogd2lkdGh9fSkKCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgc3ViLl90YXJnZXQsIGNoYXQuRkxPQVQpCgkJCQl9LCBkb2N1bWVudC5ib2R5KQoJCQl9KQoJCX0pLmZpcnN0Cgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJaGVpZ2h0OiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5fdGFyZ2V0Lm9mZnNldEhlaWdodCB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvcml2ZXIuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfUklWRVIpID09ICJfc2hhcmUiKSB7IHJldHVybiBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbikgfQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4ucml2ZXJfbGlzdCA9IHt9LCBjYW4uc3Rvcm1fbGlzdCA9IHt9CgoJCWNhbi5vbmltcG9ydC5fbWFpbihjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5fbWVudShjYW4sIG1zZykKCQl2YXIgc2VsZWN0OyBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCXJldHVybiBjYW4ub25pbXBvcnQuX3JpdmVyKGNhbiwgaXRlbSwgZnVuY3Rpb24odGFyZ2V0KSB7CgkJCQkoaW5kZXggPT0gMCB8fCBpdGVtLmhhc2ggPT0gY2FuLl9tYWluX3JpdmVyKSAmJiAoc2VsZWN0ID0gdGFyZ2V0KQoJCQl9KQoJCX0pKSwgc2VsZWN0ICYmIHNlbGVjdC5jbGljaygpCgl9LAoJX21haW46IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGNhbi5fbWFpbl9yaXZlciA9ICJwcm9qZWN0IiwgY2FuLl9tYWluX3N0b3JtID0gInN0dWRpbyIKCQlpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsgdmFyIGFyZ3MgPSBWb2xjYW5vcy5tZXRhLmFyZ3MKCQkJY2FuLl9tYWluX3JpdmVyID0gYXJncy5yaXZlcnx8InByb2R1Y3QiLCBjYW4uX21haW5fc3Rvcm0gPSBhcmdzLnN0b3JtfHwiY2hyb21lIgoJCX0KCQlpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsgY2FuLl9tYWluX3JpdmVyID0gInByb2R1Y3QiLCBjYW4uX21haW5fc3Rvcm0gPSAib2ZmaWNlIiB9CgkJaWYgKGNhbi51c2VyLmlzV2VpWGluKSB7IGNhbi5fbWFpbl9yaXZlciA9ICJzZXJ2aWNlIiwgY2FuLl9tYWluX3N0b3JtID0gInd4IiB9CgoJCWNhbi5fbWFpbl90aXRsZSA9IGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuVElUTEUpfHxtc2cuT3B0aW9uKGljZS5NU0dfVElUTEUpfHxWb2xjYW5vcy5tZXRhLmFyZ3MudGl0bGV8fGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpfHxjYW4uX21haW5fdGl0bGUKCQljYW4uX21haW5fcml2ZXIgPSBjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LlJJVkVSKXx8bXNnLk9wdGlvbihpY2UuTVNHX1JJVkVSKXx8Vm9sY2Fub3MubWV0YS5hcmdzLnJpdmVyfHxjYW4uX21haW5fcml2ZXIKCQljYW4uX21haW5fc3Rvcm0gPSBjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LlNUT1JNKXx8bXNnLk9wdGlvbihpY2UuTVNHX1NUT1JNKXx8Vm9sY2Fub3MubWV0YS5hcmdzLnN0b3JtfHxjYW4uX21haW5fc3Rvcm0KCX0sCglfbWVudTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQlpZiAoY2FuLnVzZXIubW9kLmlzUG9kKSB7IHJldHVybiB9CgkJdmFyIGxpc3QgPSBbXQoJCWNhbi5zZXRIZWFkZXJNZW51KGxpc3QuY29uY2F0KGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKGNoYXQuTUVOVVMpLCBjYW4uQ29uZihjaGF0Lk1FTlVTKXx8Y2FuLm9uZGV0YWlsLl9tZW51cykpLCBmdW5jdGlvbihldmVudCwgYnV0dG9uKSB7CgkJCWNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25kZXRhaWwsIGJ1dHRvbl0sIFtldmVudCwgY2FuLCBidXR0b24sIGNhbi5Db25mKGNoYXQuUklWRVIpLCBjYW4uQ29uZihjaGF0LlNUT1JNKV0pCgkJfSkKCX0sCglfY2FydGU6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgcml2ZXIsIHN0b3JtKSB7IGlmIChjYW4udXNlci5pc01vYmlsZSkgeyByZXR1cm4gfQoJCWlmIChjYW4uY29yZS5WYWx1ZShjYW4uX3Jvb3QsIGNhbi5jb3JlLktleXMoY2hhdC5SSVZFUiwgcml2ZXIpKSkgeyByZXR1cm4gfQoKCQljYW4ub25hY3Rpb24uY2FydGUoZXZlbnQsIGNhbiwgbGlzdCwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbW9kdWxlKSB7CgkJCW1vZHVsZVtidXR0b25dKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKQoJCX0pCgl9LAoJX3JpdmVyOiBmdW5jdGlvbihjYW4sIG1ldGEsIGNiKSB7CgkJcmV0dXJuIHt0ZXh0OiBbbWV0YS5uYW1lLCBodG1sLkRJViwgaHRtbC5JVEVNXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uYWN0aW9uLnN0b3JtKGV2ZW50LCBjYW4sIG1ldGEuaGFzaCkKCgkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25pbXBvcnQuX2NhcnRlKGNhbiwgY2FuLm9uZGV0YWlsLmxpc3QsIG1ldGEuaGFzaCkKCgkJfSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgeyBjYih0YXJnZXQpCgkJCWNhbi5yaXZlcl9saXN0W21ldGEuaGFzaF0gPSB0YXJnZXQKCQl9fQoJfSwKCV9zdG9ybTogZnVuY3Rpb24oY2FuLCBtZXRhLCByaXZlcikgewoJCXJldHVybiB7dGV4dDogW21ldGEubmFtZSwgaHRtbC5ESVYsIGh0bWwuSVRFTV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmFjdGlvbi5hY3Rpb24oZXZlbnQsIGNhbiwgcml2ZXIsIG1ldGEuaGFzaCkKCQkJY2FuLnVzZXIudGl0bGUoY2FuLl9tYWluX3RpdGxlfHxtZXRhLm5hbWUpCgoJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uaW1wb3J0Ll9jYXJ0ZShjYW4sIGNhbi5vbmRldGFpbC5zdWJsaXN0LCByaXZlciwgbWV0YS5oYXNoKQoKCQl9LCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCWNhbi5zdG9ybV9saXN0W2Nhbi5jb3JlLktleXMocml2ZXIsIG1ldGEuaGFzaCldID0gdGFyZ2V0CgkJfX0KCX0sCgkiZGlzcGxheSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgc2hvdyA9IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX3RhcmdldCk7IGNhbi5vbmxheW91dC5faW5pdChjYW4pCgkJcmV0dXJuIHNob3cKCX0sCn0pClZvbGNhbm9zKCJvbmVuZ2luZSIsIHtoZWxwOiAi6Kej5p6Q5byV5pOOIiwgbGlzdDogW10sIF9lbmdpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1zZywgcGFuZWwsIGNtZHMsIGNiKSB7Cgl2YXIgbGlzdCA9IGNhbi5fcm9vdC5yaXZlcgoJY21kcy5sZW5ndGggPT0gMCAmJiBjYW4uY29yZS5JdGVtU29ydChsaXN0LCAib3JkZXIiLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJaWYgKGNhbi5jb3JlLkl0ZW0odmFsdWUuc3Rvcm0pLmxlbmd0aCA9PSAwKSB7IHJldHVybiB9CgkJbXNnLlB1c2goe2hhc2g6IGtleSwgbmFtZTogY2FuLnVzZXIubGFuZ3VhZ2UoY2FuKSA9PSAiZW4iPyBrZXk6IHZhbHVlLm5hbWV9KSAvLyDnvqTnu4TliJfooagKCX0pOyBpZiAoY21kcy5sZW5ndGggIT0gMSAmJiBjbWRzWzFdICE9IGNoYXQuU1RPUk0pIHsgcmV0dXJuIGZhbHNlIH0KCgl2YXIgcml2ZXIgPSBsaXN0W2NtZHNbMF1dOyBpZiAoIXJpdmVyKSB7IHJldHVybiBmYWxzZSB9CgljYW4uY29yZS5JdGVtU29ydChyaXZlci5zdG9ybSwgIm9yZGVyIiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewoJCW1zZy5QdXNoKHtoYXNoOiBrZXksIG5hbWU6IGNhbi51c2VyLmxhbmd1YWdlKGNhbikgPT0gImVuIj8ga2V5OiB2YWx1ZS5uYW1lfSkgLy8g5bqU55So5YiX6KGoCgl9KSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpOyByZXR1cm4gdHJ1ZQp9fSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWlmIChjYW4udXNlci5tb2QuaXNXZWIpIHsKCgkJfSBlbHNlIGlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0KCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgl9LAoJb25sb2dpbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQljYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIGNhbi5Db25mKGN0eC5BQ1RJT04pfHxjYW4ub25hY3Rpb24ubGlzdCkKCQljYW4ucnVuKHt9LCBbXSwgZnVuY3Rpb24obXNnKSB7IGNhbi5vbmltcG9ydC5faW5pdChjYW4sIG1zZywgW10sIG51bGwsIGNhbi5fb3V0cHV0KSB9KQoJfSwKCW9uc2VhcmNoOiBmdW5jdGlvbihjYW4sIG1zZywgd29yZCkgewoJCWlmICh3b3JkWzBdID09IGNoYXQuU1RPUk0gfHwgd29yZFsxXSAhPSAiIikgeyBjYW4ub25leHBvcnQuc3Rvcm0oY2FuLCBtc2csIHdvcmQpIH0KCX0sCglvbnN0b3JtX3NlbGVjdDogZnVuY3Rpb24oY2FuLCBtc2csIHJpdmVyLCBzdG9ybSkgeyB2YXIgYXJncyA9IHtyaXZlcjogcml2ZXIsIHN0b3JtOiBzdG9ybX0KCQlpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY3R4LkFSR1MsIEpTT04uc3RyaW5naWZ5KGFyZ3MpKSB9Cgl9LAoJb25hY3Rpb25fdG91Y2g6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJY2FuLm9ubW90aW9uLmZsb2F0LmRlbChjYW4sIGNoYXQuQ0FSVEUpCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4pCgl9LAoJb25hY3Rpb25fbm90b29sOiBmdW5jdGlvbihjYW4sIG1zZywgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLm9uZGV0YWlsWyLmt7vliqDlt6XlhbciXShtc2cuX2V2ZW50LCBjYW4sICLmt7vliqDlt6XlhbciLCByaXZlciwgc3Rvcm0pCgl9LAoKCWNhcnRlOiBmdW5jdGlvbihldmVudCwgY2FuLCBsaXN0LCBjYikgewoJCWNhbi51c2VyLmNhcnRlUmlnaHQoZXZlbnQsIGNhbiwgY2FuLm9uZGV0YWlsLCBsaXN0LCBjYikKCX0sCglzdG9ybTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcml2ZXIpIHsgY2FuLnN1Ymxpc3QgPSBjYW4uc3VibGlzdHx8e30KCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYuaXRlbSIsIGNhbi5yaXZlcl9saXN0W3JpdmVyXSkKCQl2YXIgbGlzdCA9IGNhbi5zdWJsaXN0W3JpdmVyXTsgaWYgKGxpc3QpIHsgcmV0dXJuIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBsaXN0KSB9CgoJCWNhbi5ydW4oe30sIFtyaXZlciwgY2hhdC5TVE9STV0sIGZ1bmN0aW9uKG1zZykgewoJCQl2YXIgc2VsZWN0ID0gMDsgbGlzdCA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBbe3ZpZXc6IGh0bWwuTElTVCwgbGlzdDogbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCQlyaXZlciA9PSBjYW4uX21haW5fcml2ZXIgJiYgaXRlbS5oYXNoID09IGNhbi5fbWFpbl9zdG9ybSAmJiAoc2VsZWN0ID0gaW5kZXgpCgkJCQlyZXR1cm4gY2FuLm9uaW1wb3J0Ll9zdG9ybShjYW4sIGl0ZW0sIHJpdmVyKQoJCQl9KSB9XSkuZmlyc3QsIGxpc3QuY2hpbGRyZW4ubGVuZ3RoID4gMCAmJiBsaXN0LmNoaWxkcmVuW3NlbGVjdF0uY2xpY2soKQoKCQkJZXZlbnQudGFyZ2V0Lm5leHRTaWJsaW5nICYmIGNhbi5fb3V0cHV0Lmluc2VydEJlZm9yZShsaXN0LCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcpCgkJCWNhbi5zdWJsaXN0W3JpdmVyXSA9IGxpc3QKCQl9KQoJfSwKCWFjdGlvbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnN1Ymxpc3Rbcml2ZXJdLCB7c3R5bGU6IHtkaXNwbGF5OiBodG1sLkJMT0NLfX0pCgkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAiZGl2Lml0ZW0iLCBjYW4ucml2ZXJfbGlzdFtyaXZlcl0pCgkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAiZGl2Lmxpc3QgZGl2Lml0ZW0iLCBjYW4uc3Rvcm1fbGlzdFtjYW4uY29yZS5LZXlzKHJpdmVyLCBzdG9ybSldKQoKCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uc3Rvcm1fc2VsZWN0IiwgY2FuLnJlcXVlc3QoZXZlbnQsIHsKCQkJcml2ZXI6IGNhbi5Db25mKGNoYXQuUklWRVIsIHJpdmVyKSwgc3Rvcm06IGNhbi5Db25mKGNoYXQuU1RPUk0sIHN0b3JtKSwKCQl9KSkKCX0sCgoJY3JlYXRlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIudHJhbnMoY2FuLCB7InB1YmxpYyI6ICLlhazlvIDnvqQiLCAicHJvdGVjdGVkIjogIuWGhemDqOe+pCIsICJwcml2YXRlIjogIuengeaciee+pCJ9KQoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFsKCQkJe25hbWU6IG1kYi5UWVBFLCB2YWx1ZXM6IFtjaGF0LlBVQkxJQywgY2hhdC5QUk9URUNURUQsIGNoYXQuUFJJVkFURV0sIF90cmFuczogIuexu+WeiyJ9LAoJCQl7bmFtZTogbWRiLk5BTUUsIHZhbHVlOiAiaGkiLCBfdHJhbnM6ICLnvqTlkI0ifSwge25hbWU6IG1kYi5URVhULCB2YWx1ZTogImhlbGxvIiwgX3RyYW5zOiAi566A5LuLIn0sCgkJXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbWV0YSwgbGlzdCwgYXJncykgewoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLkNSRUFURV0uY29uY2F0KGFyZ3MpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogbXNnLlJlc3VsdCgpfSkKCQkJfSkKCQl9KQoJfSwKCXJlZnJlc2g6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgYXJncyA9IHtyaXZlcjogY2FuLkNvbmYoY2hhdC5SSVZFUiksIHN0b3JtOiBjYW4uQ29uZihjaGF0LlNUT1JNKSwKCQkJdG9waWM6IGNhbi5nZXRIZWFkZXIoY2hhdC5UT1BJQyksIGxheW91dDogY2FuLmdldEFjdGlvbihjaGF0LkxBWU9VVCksCgkJfQoJCWlmIChjYW4udXNlci5pc0V4dGVuc2lvbikgeyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjdHguQVJHUywgSlNPTi5zdHJpbmdpZnkoYXJncykpIH0KCQljYW4ubWlzYy5TZWFyY2goY2FuLCBhcmdzKQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLoj5zljZXkuqTkupIiLAoJbGlzdDogWyLlhbHkuqvnvqTnu4QiLCAi5re75Yqg5bqU55SoIiwgIua3u+WKoOiuvuWkhyIsICLmt7vliqDnlKjmiLciLCAi6YeN5ZG95ZCN576k57uEIiwgIuWIoOmZpOe+pOe7hCJdLAoJc3VibGlzdDogWyLlhbHkuqvlupTnlKgiLCAi5re75Yqg5bel5YW3IiwgIuS/neWtmOWPguaVsCIsICLph43lkb3lkI3lupTnlKgiLCAi5Yig6Zmk5bqU55SoIl0sCglfbWVudXM6IFsKCQlbImNyZWF0ZSIsICLliJvlu7rnvqTnu4QiLCAi5re75Yqg5bqU55SoIiwgIua3u+WKoOW3peWFtyIsICLmt7vliqDorr7lpIciLCAi5Yib5bu656m66Ze0Il0sCgkJWyJzaGFyZSIsICLlhbHkuqvnvqTnu4QiLCAi5YWx5Lqr5bqU55SoIiwgIuWFseS6q+W3peWFtyIsICLkuIvovb3lupTnlKgiLCAi6K6/6Zeu56m66Ze0Il0sCgldLAoKCSLliJvlu7rnvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5jcmVhdGUoZXZlbnQsIGNhbikgfSwKCSLlhbHkuqvnvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLm9ubW90aW9uLnNoYXJlKGV2ZW50LCBjYW4sIFt7bmFtZTogY2hhdC5USVRMRSwgdmFsdWU6IHJpdmVyfV0sIFttZGIuVFlQRSwgY2hhdC5SSVZFUl0pCgl9LAoJIua3u+WKoOW6lOeUqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsgY2FuLm9uZGV0YWlsLmNyZWF0ZShldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB9LAoJIuWFseS6q+W6lOeUqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLm9ubW90aW9uLnNoYXJlKGV2ZW50LCBjYW4sIFt7bmFtZTogY2hhdC5USVRMRSwgdmFsdWU6IHN0b3JtfV0sIFttZGIuVFlQRSwgY2hhdC5TVE9STV0pCgl9LAoJIua3u+WKoOW3peWFtyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnVzZXIuc2VsZWN0KGV2ZW50LCBjYW4sIGN0eC5DT01NQU5ELCAiY29udGV4dCxjb21tYW5kIiwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQljYW4ucnVuKHt9LCBbcml2ZXIsIGNoYXQuU1RPUk0sIGN0eC5BQ1RJT04sIG1kYi5JTlNFUlQsIG1kYi5IQVNILCBzdG9ybV0uY29uY2F0KFtpY2UuUE9ELCAiIiwgaWNlLkNUWCwgaXRlbVswXSwgaWNlLkNNRCwgaXRlbVsxXV0pLCBmdW5jdGlvbihtc2cpIHsKCQkJCW5leHQoKQoJCQl9KQoJCX0sIGZ1bmN0aW9uKCkgewoJCQljYW4ubWlzYy5TZWFyY2goY2FuLCB7cml2ZXI6IHJpdmVyLCBzdG9ybTogc3Rvcm19KQoJCX0pCgl9LAoJIuWFseS6q+W3peWFtyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnVzZXIuc2VsZWN0KGV2ZW50LCBjYW4sIG1kYi5QTFVHSU4sICJuYW1lLGNvbnRleHQsY29tbWFuZCxhcmd1bWVudCIsIGZ1bmN0aW9uKGl0ZW0sIG5leHQpIHsKCQkJY2FuLnVzZXIuc2hhcmUoY2FuLCBjYW4ucmVxdWVzdChldmVudCksIFtyaXZlciwgY3R4LkFDVElPTiwgY2hhdC5TSEFSRSwgbWRiLlRZUEUsIGNoYXQuRklFTEQsCgkJCQltZGIuTkFNRSwgaXRlbVsyXSwgbWRiLlRFWFQsIGl0ZW1bM10sIGNoYXQuVElUTEUsIGl0ZW1bMF0sIGNoYXQuUklWRVIsIHJpdmVyLCBjaGF0LlNUT1JNLCBzdG9ybSwKCQkJXSkKCQl9KQoJfSwKCgki5re75Yqg6K6+5aSHIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlcikgewoJCWNhbi51c2VyLnNlbGVjdChldmVudCwgY2FuLCB3ZWIuU1BBQ0UsICJ0eXBlLG5hbWUsdGV4dCIsIGZ1bmN0aW9uKGl0ZW0sIG5leHQpIHsKCQkJY2FuLnJ1bih7fSwgW3JpdmVyLCBjaGF0Lk5PREUsIGN0eC5BQ1RJT04sIG1kYi5JTlNFUlQsIG1kYi5UWVBFLCBpdGVtWzBdLCBtZGIuTkFNRSwgaXRlbVsxXV0sIGZ1bmN0aW9uKG1zZykgewoJCQkJbmV4dCgpCgkJCX0pCgkJfSkKCX0sCgki5LiL6L295bqU55SoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgYWFhLklOVklURV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4udXNlci50b2FzdChjYW4sIHsKCQkJCXRpdGxlOiAi5LiL6L295bqU55SoIiwgZHVyYXRpb246IC0xLCB3aWR0aDogLTMwMCwKCQkJCWNvbnRlbnQ6IG1zZy5SZXN1bHQoKSwgYWN0aW9uOiBbY2xpLkNMT1NFXSwKCQkJfSkKCQl9KQoJfSwKCSLliJvlu7rnqbrpl7QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgeyBjYW4ucmVxdWVzdChldmVudCwge2FjdGlvbjogYnV0dG9ufSkKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6ICJuYW1lIiwgdmFsdWU6ICJoaSJ9LCB7bmFtZTogInJlcG9zIn0sIHtuYW1lOiAidGVtcGxhdGUifV0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLnJlcXVlc3QoZXZlbnQsIHtfdG9hc3Q6ICLliJvlu7rkuK0uLi4ifSkKCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGNsaS5TVEFSVF0uY29uY2F0KGFyZ3MsIGNoYXQuUklWRVIsIHJpdmVyKSwgZnVuY3Rpb24obXNnKSB7CgkJCQl2YXIgbGluayA9IGNhbi5taXNjLk1lcmdlVVJMKGNhbiwge19wYXRoOiAiL2NoYXQvcG9kLyIrY2FuLmNvcmUuS2V5cyhjYW4ubWlzYy5TZWFyY2goY2FuLCBpY2UuUE9EKSwgbXNnLk9wdGlvbihtZGIuTkFNRSkpfSkKCQkJCWNhbi51c2VyLnRvYXN0KGNhbiwgbGluayksIGNhbi51c2VyLm9wZW4obGluaykKCQkJfSkKCQl9KQoJfSwKCSLorr/pl67nqbrpl7QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgewoJCWNhbi51c2VyLnNlbGVjdCh7cml2ZXI6IHJpdmVyfSwgY2FuLCB3ZWIuU1BBQ0UsICJ0aW1lLHR5cGUsbmFtZSx0ZXh0IikKCX0sCgoKCSLmt7vliqDnlKjmiLciOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLnVzZXIuc2VsZWN0KGV2ZW50LCBjYW4sIGNoYXQuVVNFUiwgInVzZXJuaWNrLHVzZXJuYW1lIiwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQljYW4ucnVuKHt9LCBbcml2ZXIsIGNoYXQuVVNFUiwgY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgYWFhLlVTRVJOQU1FLCBpdGVtWzBdXSwgZnVuY3Rpb24obXNnKSB7CgkJCQluZXh0KCkKCQkJfSkKCQl9KQoJfSwKCSLph43lkb3lkI3nvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW21kYi5OQU1FXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbWV0YSwgbGlzdCkgewoJCQljYW4ucnVuKGNhbi5yZXF1ZXN0KGV2ZW50LCB7aGFzaDogcml2ZXJ9KS5fZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuTU9ESUZZLCBtZGIuTkFNRSwgbWV0YS5uYW1lXSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4ubWlzYy5TZWFyY2goY2FuLCB7cml2ZXI6IHJpdmVyfSkKCQkJfSkKCQl9KQoJfSwKCSLliKDpmaTnvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLnJ1bihjYW4ucmVxdWVzdChldmVudCwge2hhc2g6IHJpdmVyfSkuX2V2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlJFTU9WRV0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ubWlzYy5TZWFyY2goY2FuLCB7fSkgfSkKCX0sCgoJIuS/neWtmOWPguaVsCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLmdldEFjdGlvbihjdHguQVJHUywgZnVuY3Rpb24oaXRlbSwgbmV4dCwgaW5kZXgsIGFycmF5KSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdCh7fSwge2hhc2g6IHN0b3JtLCBpZDogaXRlbS5kYXRhc2V0LmlkfSkKCQkJdmFyIHRvYXN0ID0gY2FuLnVzZXIudG9hc3QoY2FuLCAoaW5kZXgrMSkraWNlLlBTK2FycmF5Lmxlbmd0aCwgYnV0dG9uLCAxMDAwMCwgKGluZGV4KzEpKjEwMC9hcnJheS5sZW5ndGgpCgkJCWNhbi5ydW4obXNnLl9ldmVudCwgW3JpdmVyLCBjaGF0LlNUT1JNLCBjdHguQUNUSU9OLCBtZGIuTU9ESUZZLCBpY2UuQVJHLCBpdGVtLmRhdGFzZXQuYXJnc10sIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLmNvcmUuVGltZXIoMjAwLCBmdW5jdGlvbigpIHsKCQkJCQl0b2FzdC5jbG9zZSgpLCBuZXh0KCksIGluZGV4ID09IGFycmF5Lmxlbmd0aC0xICYmIGNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4sIGJ1dHRvbikKCQkJCX0pCgkJCX0pCgkJfSkKCX0sCgki6YeN5ZG95ZCN5bqU55SoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbWRiLk5BTUVdLCBmdW5jdGlvbihldiwgYnV0dG9uLCBtZXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5ydW4oY2FuLnJlcXVlc3QoZXZlbnQsIHtoYXNoOiBzdG9ybX0pLl9ldmVudCwgW3JpdmVyLCBjaGF0LlNUT1JNLCBjdHguQUNUSU9OLCBtZGIuTU9ESUZZXS5jb25jYXQoYXJncyksIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLm1pc2MuU2VhcmNoKGNhbiwge3JpdmVyOiByaXZlciwgc3Rvcm06IHN0b3JtfSkKCQkJfSkKCQl9KQoJfSwKCSLliKDpmaTlupTnlKgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgewoJCWNhbi5ydW4oY2FuLnJlcXVlc3QoZXZlbnQsIHtoYXNoOiBzdG9ybX0pLl9ldmVudCwgW3JpdmVyLCBjaGF0LlNUT1JNLCBjdHguQUNUSU9OLCBtZGIuUkVNT1ZFXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogcml2ZXJ9KQoJCX0pCgl9LAoKCgljcmVhdGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsKCQljYW4udXNlci50cmFucyhjYW4sIHsicHVibGljIjogIuWFrOW8gOW6lOeUqCIsICJwcm90ZWN0ZWQiOiAi576k57uE5bqU55SoIiwgInByaXZhdGUiOiAi5Liq5Lq65bqU55SoIn0pCgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgWwoJCQl7bmFtZTogbWRiLlRZUEUsIHZhbHVlczogW2NoYXQuUFVCTElDLCBjaGF0LlBST1RFQ1RFRCwgY2hhdC5QUklWQVRFXSwgX3RyYW5zOiAi57G75Z6LIn0sCgkJCXtuYW1lOiBtZGIuTkFNRSwgdmFsdWU6ICJoaSIsIF90cmFuczogIuWQjeensCJ9LCB7bmFtZTogbWRiLlRFWFQsIHZhbHVlOiAiaGVsbG8iLCBfdHJhbnM6ICLnroDku4sifSwKCQldLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBtZXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5ydW4oe30sIFtyaXZlciwgY2hhdC5TVE9STSwgY3R4LkFDVElPTiwgbWRiLkNSRUFURV0uY29uY2F0KGFyZ3MpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogcml2ZXIsIHN0b3JtOiBtc2cuUmVzdWx0KCl9KQoJCQl9KQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJd2lkdGg6IGZ1bmN0aW9uKGNhbikgeyByZXR1cm4gY2FuLl90YXJnZXQub2Zmc2V0V2lkdGggfSwKCXN0b3JtOiBmdW5jdGlvbihjYW4sIG1zZywgd29yZCkgewoJCXZhciBmaWVsZHMgPSAobXNnLk9wdGlvbihpY2UuTVNHX0ZJRUxEUyl8fCJjdHgsY21kLHR5cGUsbmFtZSx0ZXh0Iikuc3BsaXQoIiwiKQoJCWNhbi5jb3JlLkl0ZW0oY2FuLl9yb290LnJpdmVyLCBmdW5jdGlvbihyaXZlciwgdmFsdWUpIHsKCQkJY2FuLmNvcmUuSXRlbSh2YWx1ZS5zdG9ybSwgZnVuY3Rpb24oc3Rvcm0sIGl0ZW0pIHsKCQkJCWlmICh3b3JkWzFdICE9ICIiICYmIHdvcmRbMV0gIT0gc3Rvcm0gJiYgd29yZFsxXSAhPSBpdGVtLm5hbWUpIHsgcmV0dXJuIH0KCgkJCQl2YXIgZGF0YSA9IHtjdHg6ICJ3ZWIuY2hhdCIsIGNtZDogY2hhdC5TVE9STSwKCQkJCQl0eXBlOiByaXZlciwgbmFtZTogc3Rvcm0sIHRleHQ6IHNoeSgi6Lez6L2sIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJY2FuLm9uYWN0aW9uLmFjdGlvbihldmVudCwgY2FuLCByaXZlciwgc3Rvcm0pCgkJCQkJfSksCgkJCQl9OyBjYW4uY29yZS5MaXN0KGZpZWxkcywgZnVuY3Rpb24oa2V5KSB7IG1zZy5QdXNoKGtleSwgZGF0YVtrZXldfHwiIikgfSkKCQkJfSkKCQl9KQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jb2RlL3ZpbWVyLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCQljYW4ucmVxdWlyZShbImlubmVyLmpzIl0sIGZ1bmN0aW9uKGNhbikgeyBjYW4ub25pbXBvcnQuaW5uZXJfaW5pdChjYW4sIG1zZywgZnVuY3Rpb24oKSB7IGNhbi51bmRvID0gW10sIGNhbi5yZWRvID0gW10KCQkJY2FuLm9ua2V5bWFwLl9idWlsZChjYW4pLCBjYW4ub25pbXBvcnQuX2lucHV0KGNhbiksIGNhbi5vbmtleW1hcC5fcGx1Z2luKHt9LCBjYW4pLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCgkJfSwgdGFyZ2V0KSB9LCBmdW5jdGlvbihjYW4sIG5hbWUsIHN1YikgeyBuYW1lID09IGNoYXQuT05JTVBPUlQgJiYgKGNhbi5vbmltcG9ydC5pbm5lcl9pbml0ID0gc3ViLl9pbml0KQoJCQlpZiAobmFtZSA9PSBjaGF0Lk9OQUNUSU9OKSB7IGNhbi5fdHJhbnMgPSBjYW4uYmFzZS5Db3B5KGNhbi5fdHJhbnN8fHt9LCBzdWIuX3RyYW5zKSB9CgkJCWlmIChuYW1lID09IGNoYXQuT05LRVlNQVApIHsgY2FuLmJhc2UuQ29weShjYW4ub25rZXltYXAuX21vZGUsIHN1Yi5fbW9kZSkKCQkJCWNhbi5jb3JlLkl0ZW0oY2FuLm9ua2V5bWFwLl9tb2RlLm5vcm1hbCwgZnVuY3Rpb24oaywgdikgeyBzdWIuX21vZGUucGx1Z2luW2tdIHx8IChzdWIuX21vZGUucGx1Z2luW2tdID0gdikgfSkKCQkJCWNhbi5jb3JlLkl0ZW0oc3ViLl9tb2RlLnBsdWdpbiwgZnVuY3Rpb24oaywgdikgeyBjYW4ub25rZXltYXAuX21vZGUubm9ybWFsW2tdIHx8IChjYW4ub25rZXltYXAuX21vZGUubm9ybWFsW2tdID0gdikgfSkKCQkJfQoJCX0pCgl9LAoJX2lucHV0OiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkuY29udGVudC5wYXJlbnROb2RlLCBbCgkJCXt2aWV3OiBbImN1cnJlbnQiLCBodG1sLklOUFVUXSwgc3BlbGxjaGVjazogZmFsc2UsIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsgaWYgKGV2ZW50Lm1ldGFLZXkpIHsgcmV0dXJuIH0KCQkJCWlmIChldmVudC5jdHJsS2V5ICYmIGNhbi5vbmFjdGlvbi5fY29tcGxldGUoZXZlbnQsIGNhbikpIHsgcmV0dXJuIH0KCQkJCWNhbi5fa2V5bGlzdCA9IGNhbi5vbmtleW1hcC5fcGFyc2UoZXZlbnQsIGNhbiwgY2FuLm1vZGUrKGV2ZW50LmN0cmxLZXk/ICJfY3RybCI6ICIiKSwgY2FuLl9rZXlsaXN0LCBjYW4udWkuY3VycmVudCkKCQkJCWNhbi5tb2RlID09ICJpbnNlcnQiICYmIGNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSkgfSkKCQkJCWNhbi5tb2RlID09ICJub3JtYWwiICYmIGNhbi5TdGF0dXMoIuaMiemUriIsIGNhbi5fa2V5bGlzdC5qb2luKCIiKSkKCQkJCWNhbi5tb2RlID09ICJub3JtYWwiICYmIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9LCBvbmtleXVwOiBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb24uX2NvbXBsZXRlKGV2ZW50LCBjYW4pCgoJCQl9LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKQoKCQkJfX0sIHt2aWV3OiBbImNvbXBsZXRlIl19LAoJCV0pOyBjYW4udWkuY3VycmVudCA9IHVpLmN1cnJlbnQsIGNhbi51aS5jb21wbGV0ZSA9IHVpLmNvbXBsZXRlCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIumUruebmOS6pOS6kiIsIGxpc3Q6IFtdLAoJX21vZGVsOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7IGNhbi5TdGF0dXMoIuaooeW8jyIsIGNhbi5tb2RlID0gdmFsdWUpCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmN1cnJlbnQsIHtjbGFzc05hbWU6IFsiY3VycmVudCIsIGNhbi5tb2RlXX0pLCB2YWx1ZQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5jb21wbGV0ZSwge2NsYXNzTmFtZTogWyJjb21wbGV0ZSIsIGNhbi5tb2RlXX0pLCB2YWx1ZQoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ua2V5bWFwLl9tb2RlbChjYW4sICJwbHVnaW4iKQoJCWNhbi51aS5jdXJyZW50LmJsdXIoKQoJfSwKCV9ub3JtYWw6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ua2V5bWFwLl9tb2RlbChjYW4sICJub3JtYWwiKQoJCWNhbi51aS5jdXJyZW50LmZvY3VzKCkKCX0sCglfaW5zZXJ0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fbW9kZWwoY2FuLCAiaW5zZXJ0IikKCQljYW4udWkuY3VycmVudC5mb2N1cygpLCBjYW4udWkuY29udGVudC5zY3JvbGxMZWZ0IC09IDEwMDAwCgkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJLy8gY2FuLl9rZXlsaXN0ID0gW10KCX0sCgoJX21vZGU6IHsKCQlub3JtYWxfY3RybDogewoJCQlmOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSB7CgkJCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4pK2Nhbi5jdXJyZW50LndpbmRvdygpLTMtY2FuLmN1cnJlbnQuc2Nyb2xsKCkKCQkJCXJldHVybiBjYW4uY3VycmVudC5zY3JvbGwobGluZSksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUpLCB0cnVlCgkJCX0sCgkJCWI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsKCQkJCXZhciBsaW5lID0gY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiktY2FuLmN1cnJlbnQud2luZG93KCkrMwoJCQkJcmV0dXJuIGNhbi5jdXJyZW50LnNjcm9sbChsaW5lKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgbGluZSksIHRydWUKCQkJfSwKCQl9LAoJCW5vcm1hbDogewoJCQllc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ua2V5bWFwLl9wbHVnaW4oZXZlbnQsIGNhbikgfSwKCQkJQXJyb3dMZWZ0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIC0xKSB9LAoJCQlBcnJvd1JpZ2h0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIDEpIH0sCgkJCUFycm93RG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4uY3VycmVudC5uZXh0KCkpIH0sCgkJCUFycm93VXA6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQucHJldigpKSB9LAoKCQkJIi4iOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdmFyIGNiID0gY2FuLnJlZG8ucG9wKCk7IGNiICYmIGNiKCkgfSwKCQkJdTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHZhciBjYiA9IGNhbi51bmRvLnBvcCgpOyBjYiAmJiBjYigpIH0sCgkJCUo6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgewoJCQkJdmFyIG5leHQgPSBjYW4uY3VycmVudC5uZXh0KCk7IGlmICghbmV4dCkgeyByZXR1cm4gfQoJCQkJdmFyIGxpbmUgPSBjYW4uY3VycmVudC5saW5lLCB0ZXh0ID0gY2FuLmN1cnJlbnQudGV4dCgpCgkJCQl2YXIgcmVzdCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIG5leHQsICJ0ZC50ZXh0IilbMF0uaW5uZXJUZXh0CgkJCQljYW4uY3VycmVudC50ZXh0KHRleHQudHJpbVJpZ2h0KCkraWNlLlNQK3Jlc3QudHJpbUxlZnQoKSksIGNhbi5vbmFjdGlvbi5kZWxldGVMaW5lKGNhbiwgbmV4dCkKCQkJCWNhbi51bmRvLnB1c2goZnVuY3Rpb24oKSB7IGNhbi5vbmFjdGlvbi5tb2RpZnlMaW5lKGNhbiwgbGluZSwgdGV4dCksIGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgcmVzdCwgbGluZS5uZXh0U2libGluZykgfSkKCQkJfSwKCQkJSDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAwLCAwKSB9LAoJCQloOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIC0xKSB9LAoJCQlsOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIDEpIH0sCgkJCUw6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIHRhcmdldCwgMCwgLTEpIH0sCgkJCWo6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQubmV4dCgpKSB9LAoJCQlrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5jdXJyZW50LnByZXYoKSkgfSwKCgkJCWdnOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSB7IHJldHVybiBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjb3VudCksIHRydWUgfSwKCQkJRzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyByZXR1cm4gY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY291bnQgPSBjb3VudD4xPyBjb3VudDogY2FuLm1heCksIHRydWUgfSwKCQkJenQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgcmV0dXJuIGNhbi5jdXJyZW50LnNjcm9sbChjYW4uY3VycmVudC5zY3JvbGwoKS0oY291bnQ+MT8gY291bnQ6IDMpKSwgdHJ1ZSB9LAoJCQl6ejogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyByZXR1cm4gY2FuLmN1cnJlbnQuc2Nyb2xsKGNhbi5jdXJyZW50LnNjcm9sbCgpLShjb3VudCA9IGNvdW50PjE/IGNvdW50OiBjYW4uY3VycmVudC53aW5kb3coKS8yKSksIHRydWUgfSwKCQkJemI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgcmV0dXJuIGNhbi5jdXJyZW50LnNjcm9sbChjYW4uY3VycmVudC5zY3JvbGwoKS1jYW4uY3VycmVudC53aW5kb3coKSsoY291bnQ+MT8gY291bnQ6IDUpKSwgdHJ1ZSB9LAoKCQkJaTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSB9LAoJCQlJOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAwLCAwKSB9LAoJCQlhOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAxKSB9LAoJCQlBOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAwLCAtMSkgfSwKCQkJbzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKQoJCQkJdGV4dCA9IHRleHQuc3Vic3RyKDAsIHRleHQuaW5kZXhPZih0ZXh0LnRyaW1MZWZ0KCkpKSsodGV4dC5lbmRzV2l0aCgieyIpPyJcdCI6IiIpCgkJCQljYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCB0ZXh0LCBjYW4uY3VycmVudC5uZXh0KCkpKQoJCQkJY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCBjYW4udWkuY3VycmVudCwgMTAwMCkKCQkJfSwKCQkJTzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKQoJCQkJdGV4dCA9IHRleHQuc3Vic3RyKDAsIHRleHQuaW5kZXhPZih0ZXh0LnRyaW1MZWZ0KCkpKSsodGV4dC5lbmRzV2l0aCgifSIpPyJcdCI6IiIpCgkJCQljYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCB0ZXh0LCBjYW4uY3VycmVudC5saW5lKSkKCQkJCWNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgY2FuLnVpLmN1cnJlbnQsIDEwMDApCgkJCX0sCgoJCQl5eTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyBjYW4uX2xhc3RfdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKSB9LAoJCQlkZDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyB2YXIgdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKSwgbGluZSA9IGNhbi5vbmFjdGlvbi5fZ2V0TGluZW5vKGNhbiwgY2FuLmN1cnJlbnQubGluZSkKCQkJCWNhbi5fbGFzdF90ZXh0ID0gY2FuLmN1cnJlbnQudGV4dCgpLCBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4ub25hY3Rpb24uZGVsZXRlTGluZShjYW4sIGNhbi5jdXJyZW50LmxpbmUpKQoJCQkJY2FuLnVuZG8ucHVzaChmdW5jdGlvbigpIHsgY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCB0ZXh0LCBsaW5lKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgbGluZSkgfSkKCQkJCXZhciBjYWxsZWUgPSBhcmd1bWVudHMuY2FsbGVlCgkJCQljYW4ucmVkby5wdXNoKGZ1bmN0aW9uKCkgeyBjYWxsZWUoZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgfSkKCQkJfSwKCQkJcDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJdmFyIGxpbmUgPSBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGNhbi5fbGFzdF90ZXh0LCBjYW4uY3VycmVudC5uZXh0KCkpCgkJCQljYW4udW5kby5wdXNoKGZ1bmN0aW9uKCkgeyBjYW4ub25hY3Rpb24uZGVsZXRlTGluZShjYW4sIGxpbmUpLCBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBsaW5lLTEpIH0pCgkJCX0sCgkJCVA6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCXZhciBsaW5lID0gY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCBjYW4uX2xhc3RfdGV4dCwgY2FuLmN1cnJlbnQubGluZSkKCQkJCWNhbi51bmRvLnB1c2goZnVuY3Rpb24oKSB7IGNhbi5vbmFjdGlvbi5kZWxldGVMaW5lKGNhbiwgbGluZSksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUrMSkgfSkKCQkJfSwKCgkJCXM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLnNhdmUoZXZlbnQsIGNhbikgfSwKCQkJbTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uYXV0b2dlbihldmVudCwgY2FuLCAiYXV0b2dlbiIpIH0sCgkJCWM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLmNvbXBpbGUoZXZlbnQsIGNhbiwgImNvbXBpbGUiKSB9LAoJCX0sCgkJaW5zZXJ0OiB7CgkJCWprOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9ub3JtYWwoZXZlbnQsIGNhbikKCQkJCWNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0LTEsIDEpCgkJCQljYW4uY3VycmVudC50ZXh0KGNhbi51aS5jdXJyZW50LnZhbHVlKQoJCQl9LAoJCQlFc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkVzY2FwZSIpIHsgcmV0dXJuIH0KCQkJCWNhbi5vbmtleW1hcC5fbm9ybWFsKGV2ZW50LCBjYW4pCgkJCX0sCgkJCVRhYjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJaWYgKGV2ZW50LmtleSAhPSAiVGFiIikgeyByZXR1cm4gfQoJCQkJY2FuLm9ua2V5bWFwLmluc2VydFRleHQoY2FuLnVpLmN1cnJlbnQsICJcdCIpCgkJCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQkJfSwKCgkJCUVudGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkVudGVyIikgeyByZXR1cm4gfQoJCQkJdmFyIHJlc3QgPSBjYW4ub25rZXltYXAuZGVsZXRlVGV4dCh0YXJnZXQsIHRhcmdldC5zZWxlY3Rpb25FbmQpLCB0ZXh0ID0gY2FuLnVpLmN1cnJlbnQudmFsdWUKCQkJCXZhciBsZWZ0ID0gdGV4dC5zdWJzdHIoMCwgdGV4dC5pbmRleE9mKHRleHQudHJpbUxlZnQoKSkpfHwodGV4dC50cmltUmlnaHQoKSA9PSAiIj8gdGV4dDogIiIpCgkJCQlpZiAodGV4dC5lbmRzV2l0aCgieyIpKSB7IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCsifSIsIGNhbi5jdXJyZW50Lm5leHQoKSksIGxlZnQgKz0gIlx0IiB9CgkJCQlpZiAodGV4dC5lbmRzV2l0aCgiWyIpKSB7IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCsiXSIsIGNhbi5jdXJyZW50Lm5leHQoKSksIGxlZnQgKz0gIlx0IiB9CgkJCQlpZiAodGV4dC5lbmRzV2l0aCgiKCIpKSB7IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCsiKSIsIGNhbi5jdXJyZW50Lm5leHQoKSksIGxlZnQgKz0gIlx0IiB9CgkJCQlpZiAodGV4dC5lbmRzV2l0aCgiYCIpICYmIGNhbi5iYXNlLmNvdW50KHRleHQsICJgIiklMj09MSkgeyBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGxlZnQrImAiLCBjYW4uY3VycmVudC5uZXh0KCkpIH0KCgkJCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCtyZXN0LnRyaW1MZWZ0KCksIGNhbi5jdXJyZW50Lm5leHQoKSkKCQkJCWNhbi5jdXJyZW50LnRleHQodGV4dC50cmltUmlnaHQoKXx8dGV4dCksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUpCgkJCQljYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIGNhbi51aS5jdXJyZW50LCBsZWZ0Lmxlbmd0aCwgMCkKCQkJfSwKCQkJQmFja3NwYWNlOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkJhY2tzcGFjZSIpIHsgcmV0dXJuIH0KCQkJCWlmICh0YXJnZXQuc2VsZWN0aW9uU3RhcnQgPiAwKSB7IHJldHVybiB9CgkJCQlpZiAoIWNhbi5jdXJyZW50LnByZXYoKSkgeyByZXR1cm4gfQoJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgoJCQkJdmFyIHJlc3QgPSBjYW4uY3VycmVudC50ZXh0KCkKCQkJCWNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5jdXJyZW50LnByZXYoKSkKCQkJCWNhbi5vbmFjdGlvbi5kZWxldGVMaW5lKGNhbiwgY2FuLmN1cnJlbnQubmV4dCgpKQoJCQkJdmFyIHBvcyA9IGNhbi5jdXJyZW50LnRleHQoKS5sZW5ndGgKCgkJCQljYW4udWkuY3VycmVudC52YWx1ZSA9IGNhbi5jdXJyZW50LnRleHQoKStyZXN0CgkJCQljYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIGNhbi51aS5jdXJyZW50LCAwLCBwb3MpCgkJCX0sCgkJCUFycm93VXA6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkFycm93VXAiKSB7IHJldHVybiB9CgkJCQljYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4uY3VycmVudC5wcmV2KCkpCgkJCX0sCgkJCUFycm93RG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJaWYgKGV2ZW50LmtleSAhPSAiQXJyb3dEb3duIikgeyByZXR1cm4gfQoJCQkJY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQubmV4dCgpKQoJCQl9LAoJCX0sCgl9LCBfZW5naW5lOiB7fSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbbmZzLlNBVkUsIGNvZGUuQVVUT0dFTiwgY29kZS5DT01QSUxFLCBuZnMuU0NSSVBULCBjaGF0LldFQlNJVEUsIHdlYi5EUkVBTSwgY29kZS5QVUJMSVNIXSwKCV9ydW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgYXJncywgY2IpIHsKCQljYW4ucnVuQWN0aW9uKGV2ZW50LCBidXR0b24sIGFyZ3MsIGNifHxmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgbXNnLk9wdGlvbihuZnMuRklMRSkpCgkJCWNhbi5vbmltcG9ydC5wcm9qZWN0KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCkpLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuLCBidXR0b24pCgkJfSkKCX0sCglfcnVuczogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKTsgY2FuLnJlcXVlc3QoZXZlbnQsIHthY3Rpb246IGJ1dHRvbn0pCgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgbWV0YS5mZWF0dXJlW2J1dHRvbl0sIGZ1bmN0aW9uKGV2LCBidG4sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLm9uYWN0aW9uLl9ydW4oZXZlbnQsIGNhbiwgYnV0dG9uLCBhcmdzKQoJCX0pCgl9LAoJc2F2ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5yZXF1ZXN0KGV2ZW50LCB7ZmlsZTogY2FuLk9wdGlvbihuZnMuRklMRSksIGNvbnRlbnQ6IGNhbi5vbmV4cG9ydC5jb250ZW50KGNhbil9KQoJCWNhbi5ydW5BY3Rpb24oZXZlbnQsIG5mcy5TQVZFLCBbY2FuLnBhcnNlLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuUEFUSCldLCBmdW5jdGlvbigpIHsKCQkJY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbiwgYnV0dG9uKQoJCX0pCgl9LAoJYXV0b2dlbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmFjdGlvbi5fcnVucyhldmVudCwgY2FuLCBidXR0b24pIH0sCgljb21waWxlOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgdmFyIHRvYXN0MCA9IGNhbi51c2VyLnRvYXN0UHJvY2VzcyhjYW4sICLnvJbor5HkuK0uLi4iKQoJCWNhbi5ydW5BY3Rpb24oZXZlbnQsIGJ1dHRvbiwgW10sIGZ1bmN0aW9uKG1zZykgeyB0b2FzdDAuY2xvc2UoKQoJCQlpZiAobXNnLkxlbmd0aCgpID09IDApIHsgdmFyIHRvYXN0MSA9IGNhbi51c2VyLnRvYXN0UHJvY2VzcyhjYW4sICLph43lkK/kuK0uLi4iKQoJCQkJY2FuLmNvcmUuVGltZXIoMzAwMCwgZnVuY3Rpb24oKSB7IHRvYXN0MS5jbG9zZSgpLCBjYW4ub25hY3Rpb25bIuWxleekuiJdKHt9LCBjYW4pIH0pCgkJCX0gZWxzZSB7IGNhbi51aS5zZWFyY2guX3Nob3cobXNnKSB9CgkJfSkKCX0sCglzY3JpcHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoJCWNhbi5yZXF1ZXN0KGV2ZW50LCB7ZmlsZTogImhpL2hpLmpzIn0pCgkJY2FuLm9uYWN0aW9uLl9ydW5zKGV2ZW50LCBjYW4sIGJ1dHRvbikKCX0sCgl3ZWJzaXRlOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQljYW4ucmVxdWVzdChldmVudCwge2ZpbGU6ICJoaS56bWwifSkKCQljYW4ub25hY3Rpb24uX3J1bnMoZXZlbnQsIGNhbiwgYnV0dG9uKQoJfSwKCXB1Ymxpc2g6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoJCWNhbi5ydW5BY3Rpb24oZXZlbnQsIGJ1dHRvbiwgW10sIGZ1bmN0aW9uKG1zZykgeyBjYW4udXNlci50b2FzdENvbmZpcm0oY2FuLCBidXR0b24sIG1zZy5SZXN1bHQoKSkgfSkKCX0sCgoJbGlzdFRhZ3M6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyB2YXIgbGlzdCA9IFtdCgkJY2FuLmNvcmUuSXRlbShjYW4ucmVxdWVzdChldmVudCksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgaWYgKGtleS5pbmRleE9mKCJfIikgPT0gMCkgeyByZXR1cm4gfQoJCQlsaXN0LnB1c2goe3pvbmU6ICJtc2ciLCB0eXBlOiB0eXBlb2YgdmFsdWUsIG5hbWU6IGtleSwgdGV4dDogY2FuLmJhc2UuaXNPYmplY3QodmFsdWUpPyAiIjogKHZhbHVlKyIiKS5zcGxpdChpY2UuTkwpWzBdLAoJCQkJcGF0aDogInVzci92b2xjYW5vcy8iLCBmaWxlOiAibGliL21pc2MuanMiLCBsaW5lOiAxLAoJCQl9KQoJCX0pCgkJY2FuLmNvcmUuTGlzdChbY2FuLmJhc2UsIGNhbi5jb3JlLCBjYW4ubWlzYywgY2FuLnBhZ2UsIGNhbi51c2VyLCBjYW4ub25lbmdpbmUsIGNhbi5vbmRhZW1vbiwgY2FuLm9uYXBwZW5kLCBjYW4ub25sYXlvdXQsIGNhbi5vbm1vdGlvbiwgY2FuLm9ua2V5bWFwXSwgZnVuY3Rpb24obGliKSB7CgkJCWNhbi5jb3JlLkl0ZW0obGliLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGlmIChrZXkuaW5kZXhPZigiXyIpID09IDAgfHwgIWxpYi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7IHJldHVybiB9CgkJCQlsaXN0LnB1c2goe3pvbmU6IGxpYi5fbmFtZSwgdHlwZTogdHlwZW9mIHZhbHVlLCBuYW1lOiBrZXksIHRleHQ6IGNhbi5iYXNlLmlzT2JqZWN0KHZhbHVlKT8gIiI6ICh2YWx1ZSsiIikuc3BsaXQoaWNlLk5MKVswXSwKCQkJCQlwYXRoOiAidXNyL3ZvbGNhbm9zLyIsIGZpbGU6IGxpYi5fcGF0aCwgbGluZTogMSwKCQkJCX0pCgkJCX0pCgkJfSkKCQljYW4ucmVxdWVzdChldmVudCwge3RleHQ6IGNhbi5iYXNlLkZvcm1hdChsaXN0KX0pCgkJY2FuLnJ1bkFjdGlvbihldmVudCwgYnV0dG9uKQoJfSwKCV9jb21wbGV0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLnVpLmNvbXBsZXRlCgkJaWYgKGV2ZW50ID09IHVuZGVmaW5lZCkgeyByZXR1cm4gfQoJCXZhciBwcmUgPSBjYW4udWkuY3VycmVudC52YWx1ZS5zbGljZSgwLCBjYW4udWkuY3VycmVudC5zZWxlY3Rpb25TdGFydCkKCQl2YXIgZW5kID0gY2FuLnVpLmN1cnJlbnQudmFsdWUuc2xpY2UoY2FuLnVpLmN1cnJlbnQuc2VsZWN0aW9uU3RhcnQpCgkJdmFyIHR5cGUgPSBjYW4uY29yZS5TcGxpdChwcmUpLnBvcCgpfHwiIgoJCXZhciBuYW1lID0gY2FuLmNvcmUuU3BsaXQodHlwZSwgIiIsIGljZS5QVCkucG9wKCl8fCIiCgkJdHlwZSA9IGNhbi5iYXNlLnRyaW1TdWZmaXgodHlwZSwgbmFtZSkKCQl0eXBlID0gY2FuLmJhc2UudHJpbVN1ZmZpeCh0eXBlLCBpY2UuUFQpCgkJY29uc3QgUFJFID0gInByZSIKCgkJZnVuY3Rpb24gdXBkYXRlKHRhcmdldCkgeyBjYW4ucmVxdWVzdChldmVudCwge3R5cGU6IHR5cGUsIG5hbWU6IG5hbWUsIHRleHQ6IHByZSwgZmlsZTogY2FuLk9wdGlvbihuZnMuRklMRSl9KQoJCQljYW4ucnVuQWN0aW9uKGV2ZW50LCAiY29tcGxldGUiLCBbXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51aS5jb21wbGV0ZS5fbXNnID0gbXNnCgkJCQlpZiAobXNnLkxlbmd0aCgpID09IDAgJiYgY2FuLmJhc2UuRXh0KGNhbi5PcHRpb24obmZzLkZJTEUpKSA9PSBuZnMuSlMpIHsKCQkJCQltc2cubmFtZSA9IFtdLCBtc2cudHlwZSA9IFtdLCBtc2cudGV4dCA9IFtdCgkJCQkJY2FuLmNvcmUuSXRlbShjYW4uY29yZS5WYWx1ZSh3aW5kb3csIHR5cGUpLCBmdW5jdGlvbihrLCB2KSB7CgkJCQkJCW1zZy5QdXNoKG1kYi5OQU1FLCBrKSwgbXNnLlB1c2gobWRiLlRZUEUsIHR5cGVvZiB2KQoJCQkJCQl0cnkgeyBtc2cuUHVzaChtZGIuVEVYVCwgdikgfSBjYXRjaCAoZSkgeyBtc2cuUHVzaChtZGIuVEVYVCwgIiIpIH0KCQkJCQl9KQoJCQkJCW1zZy5hcHBlbmQgPSBbbWRiLk5BTUUsIG1kYi5UWVBFLCBtZGIuVEVYVF0KCQkJCX0KCQkJCW1zZy5MZW5ndGgoKSA9PSAwICYmIHByZS50cmltKCkgPT0gIiIgJiYgY2FuLmNvcmUuSXRlbShjYW4uY29yZS5WYWx1ZShjYW4ub25zeW50YXhbY2FuLnBhcnNlXSwgY29kZS5LRVlXT1JEKSwgZnVuY3Rpb24oaykgewoJCQkJCW1zZy5QdXNoKG1kYi5OQU1FLCBrKQoJCQkJfSkKCQkJCQoJCQkJY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIHRhcmdldCwgW3t2aWV3OiBbUFJFLCBodG1sLkRJViwgcHJlXX1dKQoJCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCkgeyByZXR1cm4ge3RleHQ6IFt2YWx1ZSwgaHRtbC5URF0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJdmFyIGxlZnQgPSBjYW4udWkuY3VycmVudC52YWx1ZS5zbGljZSgwLCBjYW4udWkuY3VycmVudC5zZWxlY3Rpb25TdGFydCkrdmFsdWUKCQkJCQljYW4uY3VycmVudC50ZXh0KGNhbi51aS5jdXJyZW50LnZhbHVlID0gbGVmdCtjYW4udWkuY3VycmVudC52YWx1ZS5zbGljZShjYW4udWkuY3VycmVudC5zZWxlY3Rpb25FbmQpKQoJCQkJCWNhbi51aS5jdXJyZW50LmZvY3VzKCksIGNhbi51aS5jb250ZW50LnNjcm9sbExlZnQgLT0gMTAwMDAsIGNhbi51aS5jdXJyZW50LnNldFNlbGVjdGlvblJhbmdlKGxlZnQubGVuZ3RoLCBsZWZ0Lmxlbmd0aCkKCQkJCX19IH0sIHRhcmdldCkKCQkJfSkKCQl9CgoJCWZ1bmN0aW9uIGZpbHRlcigpIHsKCQkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgW2h0bWwuVEJPRFksICBodG1sLlRSXSwgZnVuY3Rpb24odHIpIHsKCQkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIHRyLCBodG1sLkhJREUsIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgewoJCQkJCWlmICh0ZC5pbm5lclRleHQudG9Mb3dlckNhc2UoKS5pbmRleE9mKGNhbi5iYXNlLnRyaW1TdWZmaXgoKG5hbWUgPT0gaWNlLlBUPyB0eXBlOiBuYW1lKS50b0xvd2VyQ2FzZSgpLCAiKCIpKSA9PSAwKSB7IHJldHVybiB0ZCB9CgkJCQl9KS5sZW5ndGggPT0gMCkpIHsgcmV0dXJuIHRyIH0KCQkJfSkubGVuZ3RoID4gKG5hbWUgPT0gaWNlLlBUPyAxOiAwKQoJCX0KCgkJZnVuY3Rpb24gc2VsZWN0KGluZGV4LCB0b3RhbCkgeyBpbmRleCA9IChpbmRleCsodG90YWwrMSkpJSh0b3RhbCsxKQoJCQlpZiAoaW5kZXggPT0gdG90YWwpIHsgY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSA9IGNhbi51aS5jb21wbGV0ZS5fbXNnLk9wdGlvbihQUkUpKSB9CgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgW2h0bWwuVEJPRFksICJ0cjpub3QoLmhpZGUpIl0sIGZ1bmN0aW9uKHRyLCBpKSB7IGlmIChjYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgdHIsIGh0bWwuU0VMRUNULCBpID09IGluZGV4KSkgewoJCQkJY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSA9IGNhbi51aS5jb21wbGV0ZS5fbXNnLk9wdGlvbihQUkUpK2Nhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlREKVswXS5pbm5lclRleHQpCgkJCX0gfSkKCQkJcmV0dXJuIGluZGV4CgkJfQoKCQlpZiAoZXZlbnQuY3RybEtleSkgewoJCQlpZiAoZXZlbnQudHlwZSA9PSAia2V5dXAiKSB7CgkJCQl2YXIgdG90YWwgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtodG1sLlRCT0RZLCAidHI6bm90KC5oaWRlKSJdKS5sZW5ndGgKCQkJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCQkJY2FzZSAibiI6IGNhbi51aS5jb21wbGV0ZS5faW5kZXggPSBzZWxlY3QoY2FuLnVpLmNvbXBsZXRlLl9pbmRleCsxLCB0b3RhbCk7IGJyZWFrCgkJCQkJY2FzZSAicCI6IGNhbi51aS5jb21wbGV0ZS5faW5kZXggPSBzZWxlY3QoY2FuLnVpLmNvbXBsZXRlLl9pbmRleC0xLCB0b3RhbCk7IGJyZWFrCgkJCQkJZGVmYXVsdDogcmV0dXJuIGZhbHNlCgkJCQl9CgkJCQlyZXR1cm4gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCX0KCQkJcmV0dXJuCgkJfQoKCQljYW4uY3VycmVudC5saW5lLmFwcGVuZENoaWxkKGNhbi51aS5jb21wbGV0ZSksIGNhbi5wYWdlLnN0eWxlKGNhbiwgY2FuLnVpLmNvbXBsZXRlLCBodG1sLkxFRlQsIGNhbi51aS5jdXJyZW50Lm9mZnNldExlZnQtMSwgaHRtbC5NQVJHSU5fVE9QLCBjYW4udWkuY3VycmVudC5vZmZzZXRIZWlnaHQrNCkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsICJkaXYucHJlIiwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLmlubmVyVGV4dCA9IGNhbi51aS5jb21wbGV0ZS5fbXNnLk9wdGlvbihQUkUpfHxwcmUgfSkKCQlpZiAocHJlID09ICIiKSB7IHJldHVybiB1cGRhdGUodGFyZ2V0KSB9CgoJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCWNhc2UgaHRtbC5FTlRFUjogdXBkYXRlKHRhcmdldCk7IGJyZWFrCgkJCWNhc2UgaHRtbC5UQUI6IHVwZGF0ZSh0YXJnZXQpOyBicmVhawoJCQljYXNlIGljZS5TUDogdXBkYXRlKHRhcmdldCk7IGJyZWFrCgkJCWNhc2UgaWNlLlBUOiB1cGRhdGUodGFyZ2V0KTsgYnJlYWsKCQkJZGVmYXVsdDogZmlsdGVyKCkgfHwgdXBkYXRlKHRhcmdldCk7IGJyZWFrCgkJfSBjYW4udWkuY29tcGxldGUuX2luZGV4ID0gLTEKCX0sCgoJX3NlbGVjdExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uY3VycmVudC5saW5lLCAidGQudGV4dCIsIGZ1bmN0aW9uKHRkKSB7IGNhbi51aS5jdXJyZW50LnZhbHVlID0gdGQuaW5uZXJUZXh0CgkJCWNhbi5jdXJyZW50LmxpbmUuYXBwZW5kQ2hpbGQoY2FuLnVpLmN1cnJlbnQpLCBjYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5jdXJyZW50LCBodG1sLkxFRlQsIHRkLm9mZnNldExlZnQtMSwgaHRtbC5XSURUSCwgY2FuLnVpLmNvbnRlbnQuc3R5bGUud2lkdGgpCgkJCWlmIChldmVudCkgewoJCQkJaWYgKGV2ZW50LnR5cGUgPT0gImNsaWNrIiAmJiBjYW4ubW9kZSAhPSAiaW5zZXJ0IikgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgY2FuLm9uYWN0aW9uLl9jb21wbGV0ZShldmVudCwgY2FuKSB9KQoJCQkJfQoJCQkJY2FuLnVpLmN1cnJlbnQuZm9jdXMoKSwgY2FuLnVpLmNvbnRlbnQuc2Nyb2xsTGVmdCAtPSAxMDAwMAoJCQkJY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCBjYW4udWkuY3VycmVudCwgMCwgKGV2ZW50Lm9mZnNldFgpLzEyLTEpCgkJCX0KCQl9KQoJfSwKCXJlcmFua0xpbmU6IGZ1bmN0aW9uKGNhbiwgdmFsdWUpIHsgY2FuLm1heCA9IDAKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJY2FuLm1heCsrLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBpdGVtLCAidGQubGluZSIsIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS5pbm5lclRleHQgPSBpbmRleCsxIH0pCgkJfSkKCX0sCglpbnNlcnRMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlLCBiZWZvcmUpIHsKCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5hcHBlbmRMaW5lKGNhbiwgdmFsdWUpCgkJYmVmb3JlICYmIGNhbi51aS5jb250ZW50Lmluc2VydEJlZm9yZShsaW5lLCBjYW4ub25hY3Rpb24uX2dldExpbmUoY2FuLCBiZWZvcmUpKQoJCXJldHVybiBjYW4ub25hY3Rpb24ucmVyYW5rTGluZShjYW4pLCBjYW4ub25hY3Rpb24uX2dldExpbmVubyhjYW4sIGxpbmUpCgl9LAoJZGVsZXRlTGluZTogZnVuY3Rpb24oY2FuLCBsaW5lKSB7IGxpbmUgPSBjYW4ub25hY3Rpb24uX2dldExpbmUoY2FuLCBsaW5lKQoJCXZhciBuZXh0ID0gbGluZS5uZXh0U2libGluZ3x8bGluZS5wcmV2aW91c1NpYmxpbmcKCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBsaW5lKSwgY2FuLm9uYWN0aW9uLnJlcmFua0xpbmUoY2FuKQoJCXJldHVybiBuZXh0Cgl9LAoJbW9kaWZ5TGluZTogZnVuY3Rpb24oY2FuLCBsaW5lLCB2YWx1ZSkgewoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBodG1sLlRSLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQlpZiAoaXRlbSAhPSBsaW5lICYmIGluZGV4KzEgIT0gbGluZSkgeyByZXR1cm4gfQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBpdGVtLCAidGQudGV4dCIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLkFwcGVuZHMoY2FuLCBpdGVtLCBbY2FuLm9uc3ludGF4Ll9wYXJzZShjYW4sIHZhbHVlKV0pCgkJCX0pCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyLmlofku7bmlbAiLCAi5qih5byPIiwgIuaMiemUriIsICLop6PmnpDlmagiLCAi5paH5Lu25ZCNIiwgIuW9k+WJjeihjCIsICLot7PovazmlbAiXX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgImNhbi5jb2RlLmlubmVyLnBsdWdpbiIsIHNoeSgi5o+S5Lu2Iiwge30sIFtpY2UuTElTVCwgaWNlLkJBQ0tdLCBmdW5jdGlvbihtc2csIGNtZHMpIHsKCQkJY29uc29sZS5sb2coIndoYXQiKQoJCX0pKQoJCWNhbi5Db25mKGNhbi5fYXJncykKCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJjYW4uY29kZS5pbm5lci5rZXltYXAiLCBzaHkoIuaMiemUriIsIHt9LCBbIm1vZGUiLCAia2V5IiwgaWNlLkxJU1QsIGljZS5CQUNLXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCWNhbi5jb3JlLkl0ZW0oY2FuLm9ua2V5bWFwLl9tb2RlLCBmdW5jdGlvbihtb2RlLCB2YWx1ZSkgewoJCQkJKCFjbWRzWzBdIHx8IGNtZHNbMF0gPT0gbW9kZSkgJiYgY2FuLmNvcmUuSXRlbSh2YWx1ZSwgZnVuY3Rpb24oa2V5LCBmdW5jKSB7CgkJCQkJaWYgKGNtZHNbMF0gPT0gbW9kZSAmJiBjbWRzWzFdID09IGtleSkgewoJCQkJCQltc2cuUHVzaCgia2V5IiwgIm1vZGUiKQoJCQkJCQltc2cuUHVzaCgidmFsdWUiLCBtb2RlKQoJCQkJCQltc2cuUHVzaCgia2V5IiwgImtleSIpCgkJCQkJCW1zZy5QdXNoKCJ2YWx1ZSIsIGtleSkKCQkJCQkJbXNnLlB1c2goImtleSIsICJoZWxwIikKCQkJCQkJbXNnLlB1c2goInZhbHVlIiwgZnVuYy5oZWxwKQoJCQkJCQltc2cuUHVzaCgia2V5IiwgImZ1bmMiKQoJCQkJCQltc2cuUHVzaCgidmFsdWUiLCBmdW5jLnRvU3RyaW5nKCkpCgkJCQkJfSBlbHNlIGlmICghY21kc1swXSB8fCAhY21kc1sxXSkgewoJCQkJCQlmdW5jLmhlbHAgJiYgbXNnLlB1c2goa2l0LkRpY3QoIm1vZGUiLCBtb2RlLCAia2V5Iiwga2V5LCAiaGVscCIsIGZ1bmMuaGVscCkpCgkJCQkJfQoJCQkJfSkKCQkJfSksIG1zZy5TdGF0dXNUaW1lQ291bnQoKQoJCX0pKQoKCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIm9yaWVudGF0aW9uY2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJaWYgKGNhbi51c2VyLm1vZC5pc0NtZCkgeyBjYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQpLCBjYW4uQ29uZldpZHRoKHdpbmRvdy5pbm5lcldpZHRoKSB9CgkJCWNhbi51c2VyLnRvYXN0KGNhbiwgY2FuLkNvbmZIZWlnaHQoKSsiIikKCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJfSkKCgkJdmFyIHBhdGhzID0gY2FuLmNvcmUuU3BsaXQoY2FuLk9wdGlvbihuZnMuUEFUSCksIGljZS5GUyk7IGNhbi5PcHRpb24obmZzLlBBVEgsIHBhdGhzWzBdKQoJCXZhciBmaWxlcyA9IGNhbi5jb3JlLlNwbGl0KGNhbi5PcHRpb24obmZzLkZJTEUpLCBpY2UuRlMpOyBjYW4uT3B0aW9uKG5mcy5GSUxFLCBmaWxlc1swXSkKCQkvLyBjYW4udGFidmlldyA9IGNhbi50YWJ2aWV3fHx7fSwgY2FuLnRhYnZpZXdbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBtc2cKCQljYW4udGFidmlldyA9IGNhbi50YWJ2aWV3fHx7fQoJCWNhbi5oaXN0b3J5ID0gY2FuLmhpc3Rvcnl8fFtdLCBjYW4udG9vbGtpdCA9IHt9LCBjYW4uZXh0ZW50aW9ucyA9IHt9LCBjYW4ucHJvZmlsZV9zaXplID0ge30KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5vbmxheW91dC5wcm9maWxlKGNhbikKCQljYW4ub25pbXBvcnQuX3Byb2plY3QoY2FuLCBjYW4udWkucHJvamVjdCkKCQljYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBjYW4udWkucHJvZmlsZSkKCQljYW4ub25pbXBvcnQuX2Rpc3BsYXkoY2FuLCBjYW4udWkuZGlzcGxheSkKCgkJY2FuLnVpLl90YWJzID0gY2FuLnBhZ2UuaW5zZXJ0QmVmb3JlKGNhbiwgW3t2aWV3OiAidGFicyJ9XSwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLnVpLl9wYXRoID0gY2FuLnBhZ2UuaW5zZXJ0QmVmb3JlKGNhbiwgW3t2aWV3OiAicGF0aCJ9XSwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgoJCWNhbi5Db25mKCJtb2RlIikgPT0gInNpbXBsZSI/IGNhbi5vbmltcG9ydC5fc2ltcGxlKGNhbik6IGNhbi5vbmltcG9ydC5wcm9qZWN0KGNhbiwgcGF0aHMsIGZ1bmN0aW9uKCkgewoJCQljYW4ub25pbXBvcnQuX3Rvb2xraXQoY2FuLCBjYW4udWkudG9vbGtpdCksIGNhbi5vbmltcG9ydC5fc2Vzc2lvbihjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5fa2V5ZG93bihjYW4pCgkJCWNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgewoJCQkJY2FuLmNvcmUuTmV4dChmaWxlcy5zbGljZSgxKSwgZnVuY3Rpb24oZmlsZSwgbmV4dCkgewoJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGZpbGUsIGNhbi5PcHRpb24obmZzLkxJTkUpLCBuZXh0KQoJCQkJfSkKCQkJfSkKCQl9KQoJCWlmIChsb2NhdGlvbi5oYXNoKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGRlY29kZVVSSUNvbXBvbmVudChsb2NhdGlvbi5oYXNoKS5zbGljZSgxKSwgMSkKCQl9IGVsc2UgewoJCQljYW4ub25pbXBvcnQudGFidmlldyhjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuTElORSkpCgkJfQoKCQljYW4udXNlci5pc01vYmlsZSAmJiAhY2FuLnVzZXIuaXNMYW5kc2NhcGUoKSAmJiBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgl9LAoJX3NpbXBsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQljYW4udGFidmlld1tjYW4ub25leHBvcnQua2V5cyhjYW4pXSA9IGNhbi5fbXNnCgkJY2FuLkNvbmYoaHRtbC5IRUlHSFQsICIiKSwgY2FuLnVpLnByb2plY3QuX3RvZ2dsZSgpCgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fZmllbGRzLCBjaGF0Lk9VVFBVVCkKCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJzaW1wbGUiKQoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkuX3RhYnMpCgl9LAoJX3Byb2plY3Q6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgdGFyZ2V0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIH0KCX0sCglfcHJvZmlsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVR9XSk7IGNhbi51aS5wcm9maWxlX291dHB1dCA9IHVpLm91dHB1dAoJCXZhciBhY3Rpb24gPSBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIGtpdC5EaWN0KAoJCQljbGkuQ0xPU0UsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCB0YXJnZXQpLCBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikgfSwKCQkJY2xpLkNMRUFSLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB1aS5vdXRwdXQpIH0sCgkJCWNsaS5TSE9XLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuWxleekuiJdKGV2ZW50LCBjYW4pIH0sCgkJCSLliqDovb0iLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuWKoOi9vSJdKGV2ZW50LCBjYW4pLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9LAoKCQkJIumTvuaOpSIsIGZ1bmN0aW9uKGV2ZW50KSB7IHZhciBwb2QgPSBjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikKCQkJCWlmIChwb2QpIHsKCQkJCQljYW4udXNlci5vcGVuKGNhbi5iYXNlLlBhdGgoIi9jaGF0LyIsICJwb2QiLCBwb2QsICJjbWQiLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpKQoJCQkJfSBlbHNlIHsKCQkJCQljYW4udXNlci5vcGVuKGNhbi5iYXNlLlBhdGgoIi9jaGF0LyIsICJjbWQiLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpKQoJCQkJfQoJCQl9LAoJCQltZGIuUExVR0lOLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW2N0eC5JTkRFWCwgY3R4LkFSR1NdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIGRhdGEsIHVpLm91dHB1dCkKCQkJCX0pCgkJCX0sCgkJCWh0bWwuV0lEVEgsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGh0bWwuV0lEVEgsIHZhbHVlOiA1MH1dLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCQkJY2FuLnByb2ZpbGVfc2l6ZVtjYW4ub25leHBvcnQua2V5cyhjYW4pXSA9IGNhbi5Db25mV2lkdGgoKSpwYXJzZUludChkYXRhLndpZHRoKS8xMDAKCQkJCQljYW4ub25hY3Rpb25bIuWxleekuiJdKGV2ZW50LCBjYW4pCgkJCQl9KQoJCQl9LAoJCSkpCgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCwgc2hvdykgeyBhY3Rpb25bc2hvdz8gY2xpLlNIT1c6IGNsaS5DTE9TRV0oZXZlbnQpIH0KCX0sCglfZGlzcGxheTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVR9LCB7dmlldzogaHRtbC5TVEFUVVN9XSkKCQljYW4udWkuZGlzcGxheV9vdXRwdXQgPSB1aS5vdXRwdXQsIGNhbi51aS5kaXNwbGF5X3N0YXR1cyA9IHVpLnN0YXR1cwoJCXZhciBhY3Rpb24gPSBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIGtpdC5EaWN0KAoJCQljbGkuQ0xPU0UsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCB0YXJnZXQpLCBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikgfSwKCQkJY2xpLkNMRUFSLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB1aS5vdXRwdXQpIH0sCgkJCWNsaS5FWEVDLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuaJp+ihjCJdKGV2ZW50LCBjYW4pIH0sCgkJCW1kYi5QTFVHSU4sIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbY3R4LklOREVYLCBjdHguQVJHU10sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEpIHsKCQkJCQljYW4ub25pbXBvcnQucGx1Z2luKGNhbiwgZGF0YSwgdWkub3V0cHV0KQoJCQkJfSkKCQkJfSwKCQkJaHRtbC5IRUlHSFQsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGh0bWwuSEVJR0hULCB2YWx1ZTogNTB9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQkJCWNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBjYW4uQ29uZkhlaWdodCgpKnBhcnNlSW50KGRhdGEuaGVpZ2h0KS8xMDAKCQkJCQljYW4ub25hY3Rpb25bIuaJp+ihjCJdKGV2ZW50LCBjYW4pCgkJCQl9KQoJCQl9LAoJCSkpCgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCwgc2hvdykgeyBhY3Rpb25bc2hvdz8gY2xpLkVYRUM6IGNsaS5DTE9TRV0oZXZlbnQpIH0KCX0sCglfdG9vbGtpdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQljYW4udWkudG9vbGtpdCA9IGNhbi5vbmFwcGVuZC5maWVsZChjYW4sICJ0b29sa2l0Iiwge30sIGNhbi5fb3V0cHV0KQoJfSwKCV9zZXNzaW9uOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5vbmltcG9ydC5zZXNzKGNhbiwgIiIsIGZ1bmN0aW9uKCkgeyBjYW4ub25pbXBvcnQuc2VzcyhjYW4sIHsKCQkJcGx1ZzogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJwbHVnIikpLnJldmVyc2UoKSwKCQkJZXh0czogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJleHRzIikpLnJldmVyc2UoKSwKCQkJdGFiczogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJ0YWJzIikpLAoJCX0pIH0pCgl9LAoJX2tleWRvd246IGZ1bmN0aW9uKGNhbikgeyBjYW4ub25rZXltYXAuX2J1aWxkKGNhbikKCQljYW4udXNlci5tb2QuaXNDbWQgJiYgY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sIGNoYXQuT05LRVlET1dOLCBmdW5jdGlvbihldmVudCkgewoJCQljYW4uX2tleV9saXN0ID0gY2FuLm9ua2V5bWFwLl9wYXJzZShldmVudCwgY2FuLCAicGx1Z2luIiwgY2FuLl9rZXlfbGlzdCwgY2FuLnVpLmNvbnRlbnQpCgkJfSkKCX0sCgoJcHJvamVjdDogZnVuY3Rpb24oY2FuLCBwYXRoLCBjYikgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkucHJvamVjdCkKCQkvLyBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFsi5omn6KGMIiwgIumihOiniCIsICLkv53lrZgiXSwgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLnByb2plY3QsIFt7dmlldzogImFjdGlvbiJ9XSkuZmlyc3QsIHsKCQkvLyAJIuaJp+ihjCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5omn6KGMIl0oZXZlbnQsIGNhbikgfSwKCQkvLyAJIumihOiniCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5bGV56S6Il0oZXZlbnQsIGNhbikgfSwKCQkvLyAJIuS/neWtmCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5L+d5a2YIl0oZXZlbnQsIGNhbikgfSwKCQkvLyB9KQoJCS8vIGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5wcm9qZWN0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogW3t0eXBlOiAiaW5wdXQiLCBkYXRhOiB7dHlwZTogInRleHQifSwgb25rZXl1cDogZnVuY3Rpb24oZXZlbnQpIHsKCQkvLyAJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLnByb2plY3QsICJkaXYuaXRlbSIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkvLyAJCWlmIChpdGVtLmlubmVyVGV4dC5pbmRleE9mKGV2ZW50LnRhcmdldC52YWx1ZSkgPT0gLTEpIHsKCQkvLyAJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgaXRlbSwgImhpZGUiKQoJCS8vIAkJfSBlbHNlIHsKCQkvLyAJCQljYW4ucGFnZS5DbGFzc0xpc3QuZGVsKGNhbiwgaXRlbSwgImhpZGUiKQoJCS8vIAkJfQoJCS8vIAl9KQoJCS8vIH19IF19LCBdKQoJCXZhciBwcm9qZWN0ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLnByb2plY3QsIFsKCQkJe3ZpZXc6ICJraW5kIiwgaW5uZXI6ICJzb3VyY2UiLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGV2ZW50LnRhcmdldC5uZXh0U2libGluZykKCQkJfX0sIHt2aWV3OiAic291cmNlIn0sCgkJCXt2aWV3OiAia2luZCIsIGlubmVyOiAibW9kdWxlIiwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcpCgkJCX19LCB7dmlldzogIm1vZHVsZSJ9LAoJCQl7dmlldzogImtpbmQiLCBpbm5lcjogInBsdWdpbiIsIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgZXZlbnQudGFyZ2V0Lm5leHRTaWJsaW5nKQoJCQl9fSwge3ZpZXc6ICJwbHVnaW4ifSwKCQldKQoKCQljYW4uY29yZS5OZXh0KHBhdGgsIGZ1bmN0aW9uKHBhdGgsIG5leHQsIGluZGV4LCBhcnJheSkgewoJCQl2YXIgbGlzdCA9IHByb2plY3Quc291cmNlOyBpZiAoYXJyYXkubGVuZ3RoID4gMSkgewoJCQkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgcHJvamVjdC5zb3VyY2UsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIHBhdGhdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCB1aS5saXN0KQoJCQkJfX0sIHt2aWV3OiBodG1sLkxJU1R9XSk7IGxpc3QgPSB1aS5saXN0CgkJCQlpZiAoaW5kZXggPiAwKSB7IHVpLml0ZW0uY2xpY2soKSB9CgkJCX0KCQkJY2FuLnJ1bihjYW4ucmVxdWVzdCh7fSwge2Rpcl9yb290OiBwYXRoLCBkaXJfZGVlcDogdHJ1ZX0pLl9ldmVudCwgW2ljZS5QV0RdLCBmdW5jdGlvbihtc2cpIHsgY2FuLl9maWxlID0gbXNnLlRhYmxlKCkKCQkJCWNhbi5jb3JlLkxpc3QoY2FuLl9maWxlLCBmdW5jdGlvbihpdGVtKSB7IGlmIChjYW4uT3B0aW9uKG5mcy5GSUxFKS5pbmRleE9mKGl0ZW0ucGF0aCkgPT0gMCkgeyBpdGVtLmV4cGFuZCA9IHRydWUgfSB9KQoJCQkJY2FuLm9uYXBwZW5kLnRyZWUoY2FuLCBjYW4uX2ZpbGUsIG5mcy5QQVRILCBpY2UuUFMsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBwYXRoLCBpdGVtLnBhdGgpCgkJCQl9LCBsaXN0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pLCBjYW4uU3RhdHVzKCLmlofku7bmlbAiLCBtc2cuTGVuZ3RoKCkpLCBuZXh0KCkKCQkJfSwgdHJ1ZSkKCQl9LCBmdW5jdGlvbigpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpIH0pCgoJCWNhbi5ydW4oY2FuLnJlcXVlc3Qoe30sIHtmaWVsZHM6ICJpbmRleCJ9KS5fZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09NTUFORCwgInNlYXJjaCIsICJjb21tYW5kIl0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQudHJlZShjYW4sIG1zZy5UYWJsZSgpLCBjdHguSU5ERVgsIGljZS5QVCwgZnVuY3Rpb24oZXZlbnQsIGl0ZW0pIHsKCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGl0ZW0uaW5kZXgsIGN0eC5JTkRFWCkKCQkJfSwgcHJvamVjdC5tb2R1bGUpCgkJfSkKCgkJY2FuLm9uYXBwZW5kLnRyZWUoY2FuLCBjYW4uY29yZS5JdGVtKGNhbi5vbmVuZ2luZS5wbHVnaW4ubWV0YSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB7aW5kZXg6IGNhbi5iYXNlLnRyaW1QcmVmaXgoa2V5LCAiY2FuLiIpfSB9KSwgY3R4LklOREVYLCBpY2UuUFQsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksICJjYW4uIitpdGVtLmluZGV4LCBjdHguSU5ERVgpCgkJfSwgcHJvamVjdC5wbHVnaW4pCgl9LAoJdGFidmlldzogZnVuY3Rpb24oY2FuLCBwYXRoLCBmaWxlLCBsaW5lLCBjYiwgc2tpcCwgc2tpcDIpIHsgdmFyIGtleSA9IGNhbi5vbmV4cG9ydC5rZXlzKGNhbiwgZmlsZSwgcGF0aCkKCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kKSB7IGxvY2F0aW9uLmhhc2ggPSBmaWxlIH0KCQlpZiAoIXNraXAgJiYgY2FuLnRhYnZpZXdba2V5XSkgeyBjYW4udXNlci5tb2QuaXNDbWQgJiYgY2FuLnVzZXIudGl0bGUocGF0aCtmaWxlKQoJCQljYW4uX21zZyAmJiBjYW4uX21zZy5PcHRpb24obmZzLkxJTkUsIGNhbi5PcHRpb24obmZzLkxJTkUpKSwgY2FuLl9tc2cgPSBjYW4udGFidmlld1trZXldCgkJCWNhbi5PcHRpb24oe3BhdGg6IHBhdGgsIGZpbGU6IGZpbGUsIGxpbmU6IGxpbmV8fGNhbi5fbXNnLk9wdGlvbihuZnMuTElORSl8fDF9KQoJCQlyZXR1cm4gY2FuLl9tc2cuT3B0aW9uKGNhbi5PcHRpb24oKSksIGNhbi5vbnN5bnRheC5faW5pdChjYW4sIGNhbi5fbXNnLCBjYiwgc2tpcDIpCgkJfQoKCQlmdW5jdGlvbiBzaG93KG1zZykgeyBjYW4udGFidmlld1trZXldID0gbXNnCgkJCXZhciBza2lwMiA9IHNraXAKCQkJbXNnLl90YWIgPSBjYW4ub25hcHBlbmQudGFicyhjYW4sIFt7bmFtZTogZmlsZS5zcGxpdChtc2cuT3B0aW9uKG5mcy5MSU5FKSA9PSBjdHguSU5ERVg/IGljZS5QVDogaWNlLlBTKS5wb3AoKSwgdGV4dDogZmlsZX1dLCBmdW5jdGlvbihldmVudCwgbWV0YSkgewoJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBwYXRoLCBmaWxlLCAiIiwgY2IsIGZhbHNlLCBza2lwMiksIGNiID0gbnVsbCwgc2tpcDIgPSBmYWxzZQoJCQl9LCBmdW5jdGlvbihpdGVtKSB7IGRlbGV0ZShjYW4udGFidmlld1trZXldKSB9LCBjYW4udWkuX3RhYnMsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIHtvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl9fSkKCQkJfSkKCQl9CgoJCWNhbi5PcHRpb24oe3BhdGg6IHBhdGgsIGZpbGU6IGZpbGUsIGxpbmU6IGxpbmV8fDF9KQoJCWxpbmUgPT0gY3R4LklOREVYPyBzaG93KGNhbi5yZXF1ZXN0KHt9LCB7aW5kZXg6IGZpbGUsIGxpbmU6IGxpbmV9KSk6IGNhbi5ydW4oe30sIFtwYXRoLCBmaWxlXSwgc2hvdywgdHJ1ZSkKCX0sCglwcm9maWxlOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciB3aWR0aCA9IGNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV18fChjYW4uQ29uZldpZHRoKCktY2FuLnVpLnByb2plY3Qub2Zmc2V0V2lkdGgpLzIKCQltc2cgJiYgY2FuLm9uaW1wb3J0LnByb2Nlc3MoY2FuLCBtc2csIGNhbi51aS5wcm9maWxlX291dHB1dCwgd2lkdGgtMzIpCgkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9maWxlLCB0cnVlKSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgl9LAoJZGlzcGxheTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVpZ2h0ID0gY2FuLnByb2ZpbGVfc2l6ZVtjYW4ub25leHBvcnQua2V5cyhjYW4pXXx8e3NoOiBjYW4uQ29uZkhlaWdodCgpLzJ9W2Nhbi5wYXJzZV18fGNhbi5Db25mSGVpZ2h0KCkvNAoJCW1zZyAmJiBjYW4ub25pbXBvcnQucHJvY2VzcyhjYW4sIG1zZywgY2FuLnVpLmRpc3BsYXlfb3V0cHV0LCBjYW4uQ29uZldpZHRoKCkpCgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4udWkuZGlzcGxheV9vdXRwdXQsIGh0bWwuTUFYX0hFSUdIVCwgaGVpZ2h0KQoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkuZGlzcGxheSwgdHJ1ZSksIGNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJfSwKCXRvb2xraXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgY2IpIHsKCQltZXRhLm9wdHMgPSBtZXRhLm9wdHN8fHtyZXBvczogY2FuLmJhc2UudHJpbVN1ZmZpeChjYW4uYmFzZS50cmltUHJlZml4KGNhbi5PcHRpb24obmZzLlBBVEgpLCAidXNyLyIpLCBpY2UuUFMpIH0KCQljYW4ub25pbXBvcnQucGx1Z2luKGNhbiwgbWV0YSwgY2FuLnVpLnRvb2xraXQub3V0cHV0LCBmdW5jdGlvbihzdWIpIHsKCQkJc3ViLkNvbmZIZWlnaHQoY2FuLkNvbmZIZWlnaHQoKS00Kmh0bWwuQUNUSU9OX0hFSUdIVCksIHN1Yi5Db25mV2lkdGgoY2FuLkNvbmZXaWR0aCgpKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIHN1Yi5Db25mSGVpZ2h0KCkpCgkJCXN1Yi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCkpCgkJCXN1Yi5zZWxlY3QgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHN1Yi5fbGVnZW5kLmNsaWNrKCksIHN1YiB9CgoJCQljYW4uX3N0YXR1cy5hcHBlbmRDaGlsZChzdWIuX2xlZ2VuZCksIHN1Yi5fbGVnZW5kLm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewoJCQkJaWYgKGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fc3RhdHVzLCBpY2UuUFQraHRtbC5TRUxFQ1QpWzBdID09IGV2ZW50LnRhcmdldCkgewoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBldmVudC50YXJnZXQsIGh0bWwuU0VMRUNUKQoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBzdWIuX3RhcmdldCwgaHRtbC5TRUxFQ1QpCgkJCQkJcmV0dXJuCgkJCQl9CgkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9zdGF0dXMsIGh0bWwuTEVHRU5ELCBldmVudC50YXJnZXQpCgkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLnVpLnRvb2xraXQub3V0cHV0LCBodG1sLkZJRUxEU0VULCBzdWIuX3RhcmdldCkKCQkJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIGNhbi5wYWdlLlNlbGVjdChjYW4sIHN1Yi5fb3B0aW9uLCBodG1sLk9QVElPTl9BUkdTKVswXSkKCQkJfSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpCgkJCWNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7IGNhbi5vbmFwcGVuZC5fb3B0aW9uKHN1Yiwge2lucHV0czogW3t0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogY2xpLkNMT1NFLCBfY2I6IGZ1bmN0aW9uKCkgewoJCQkJc3ViLl9sZWdlbmQuY2xpY2soKQoJCQl9fV19KSB9KQoJCX0pCgl9LAoJcHJvY2VzczogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCwgd2lkdGgpIHsKCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHRhcmdldCkKCQlpZiAobXNnLk9wdGlvbihpY2UuTVNHX1BST0NFU1MpID09ICJfZmllbGQiKSB7CgkJCW1zZy5UYWJsZShmdW5jdGlvbihtZXRhKSB7IG1ldGEuZGlzcGxheSA9IG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKQoJCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIG1ldGEsIHRhcmdldCwgZnVuY3Rpb24oc3ViKSB7IHdpZHRoICYmIHN1Yi5Db25mV2lkdGgod2lkdGgpCgkJCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgc3ViLl9vcHRpb24sIGh0bWwuT1BUSU9OX0FSR1MpWzBdKQoJCQkJfSkKCQkJfSkKCQl9IGVsc2UgaWYgKG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKSAhPSAiIikgewoJCQljYW4ub25hcHBlbmQuX291dHB1dChjYW4sIG1zZywgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVkpLCB0YXJnZXQsIGZhbHNlLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJCQl9KQoJCX0gZWxzZSB7CgkJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgbnVsbCwgdGFyZ2V0KQoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2csIHRhcmdldCkKCQl9Cgl9LAoJcGx1Z2luOiBmdW5jdGlvbihjYW4sIG1ldGEsIHRhcmdldCwgY2IpIHsKCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwgbWV0YSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5PcHRpb24oKSkKCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBtZXRhLmluZGV4XSwgY21kcyksIGNiLCB0cnVlKQoJCQl9LCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YikKCQl9LCB0YXJnZXQpCgl9LAoJbGF5b3V0OiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgd2lkdGggPSBjYW4uQ29uZldpZHRoKCkrKGNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi51c2VyLm1vZC5pc0NtZCAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAxNjogMCktKGNhbi51c2VyLmlzV2luZG93cyAmJiAhY2FuLnVzZXIubW9kLmlzQ21kPyAyMDogMCkKCQljYW4ucGFnZS5zdHlsZVdpZHRoKGNhbiwgY2FuLnVpLnByb2ZpbGVfb3V0cHV0LCBjYW4ucHJvZmlsZV9zaXplW2Nhbi5vbmV4cG9ydC5rZXlzKGNhbildfHwod2lkdGgtY2FuLnVpLnByb2plY3Qub2Zmc2V0V2lkdGgpLzIpCgkJY2FuLnBhZ2Uuc3R5bGVXaWR0aChjYW4sIGNhbi51aS5jb250ZW50LCB3aWR0aC1jYW4udWkucHJvamVjdC5vZmZzZXRXaWR0aC1jYW4udWkucHJvZmlsZS5vZmZzZXRXaWR0aCkKCQljYW4ucGFnZS5zdHlsZVdpZHRoKGNhbiwgY2FuLnVpLmRpc3BsYXksIHdpZHRoLWNhbi51aS5wcm9qZWN0Lm9mZnNldFdpZHRoKQoKCQlpZiAoIWhlaWdodCAmJiBjYW4uQ29uZigibW9kZSIpID09ICJzaW1wbGUiKSB7IHJldHVybiB9CgkJdmFyIGhlaWdodCA9IGNhbi5Db25mSGVpZ2h0KCktKGNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi51c2VyLm1vZC5pc0NtZD8gKGNhbi51c2VyLmlzTGFuZHNjYXBlKCk/IDE0OiA1NCk6IDApLShjYW4udXNlci5pc1dpbmRvd3M/IDIwOiAwKQoJCWlmICghaGVpZ2h0IHx8IGhlaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCkgeyBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSAyMDAgfQoJCWlmIChjYW4udXNlci5pc01vYmlsZSAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIGhlaWdodCA8IDIwMCkgeyBoZWlnaHQgPSA0MDAgfQoKCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kKSB7IGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLnByb2plY3QsIGhlaWdodCsyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQkJaWYgKGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodCkgewoJCQkJdmFyIHJlc3QgPSBjYW4udWkuZGlzcGxheS5vZmZzZXRIZWlnaHQrY2FuLnVpLl9wYXRoLm9mZnNldEhlaWdodCtjYW4udWkuX3RhYnMub2Zmc2V0SGVpZ2h0KzUKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodC1yZXN0KQoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodC1yZXN0K2h0bWwuQUNUSU9OX0hFSUdIVCs2KQoJCQl9IGVsc2UgewoJCQkJdmFyIHJlc3QgPSBjYW4udWkuZGlzcGxheS5vZmZzZXRIZWlnaHQrNQoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkuY29udGVudCwgaGVpZ2h0LTgpCgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi51aS5wcm9maWxlX291dHB1dCwgaGVpZ2h0K2h0bWwuQUNUSU9OX0hFSUdIVCs2LTgpCgkJCX0KCQl9IGVsc2UgewoJCQl2YXIgcmVzdCA9IGNhbi51aS5kaXNwbGF5Lm9mZnNldEhlaWdodCtjYW4udWkuX3BhdGgub2Zmc2V0SGVpZ2h0K2Nhbi51aS5fdGFicy5vZmZzZXRIZWlnaHQrNQoJCQljYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5jb250ZW50LCBjYW4udXNlci5tb2QuaXNDbWQgfHwgY2FuLnVzZXIuaXNNb2JpbGU/IGh0bWwuSEVJR0hUOiBodG1sLk1BWF9IRUlHSFQsIGhlaWdodCkKCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkucHJvamVjdCwgY2FuLnVpLmNvbnRlbnQub2Zmc2V0SGVpZ2h0K3Jlc3QpCgkJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QuaGFzKGNhbiwgY2FuLl9maWVsZHMsICJmdWxsIikpIHsKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLnByb2ZpbGVfb3V0cHV0LCBjYW4udWkuY29udGVudC5vZmZzZXRIZWlnaHQpCgkJCX0gZWxzZSB7CgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi51aS5wcm9maWxlX291dHB1dCwgY2FuLnVpLmNvbnRlbnQub2Zmc2V0SGVpZ2h0LWh0bWwuQUNUSU9OX0hFSUdIVC0yKQoJCQl9CgkJfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGh0bWwuSUZSQU1FLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwKCQkJCWh0bWwuSEVJR0hULCBjYW4udWkucHJvZmlsZV9vdXRwdXQub2Zmc2V0SGVpZ2h0LTQsCgkJCQlodG1sLldJRFRILCBjYW4udWkucHJvZmlsZV9vdXRwdXQub2Zmc2V0V2lkdGgtNSwKCQkJCSJtYXJnaW4tbGVmdCIsICItMTBweCIsICJtYXJnaW4tdG9wIiwgIi0xMHB4IiwKCQkJCSJwb3NpdGlvbiIsICJhYnNvbHV0ZSIsICJib3JkZXIiLCAiMCIKCQkJKQoJCX0pCgl9LAoJZXh0czogZnVuY3Rpb24oY2FuLCB1cmwsIGNiKSB7CgkJY2FuLnJlcXVpcmUoW3VybF0sIGZ1bmN0aW9uKCkge30sIGZ1bmN0aW9uKGNhbiwgbmFtZSwgc3ViKSB7IHN1Yi5faW5pdChjYW4sIGNhbi5iYXNlLlBhcnNlVVJMKHN1Yi5fcGF0aCksIGZ1bmN0aW9uKHN1YikgewoJCQljYW4uZXh0ZW50aW9uc1t1cmwuc3BsaXQoIj8iKVswXV0gPSBzdWIsIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJCX0pIH0pCgl9LAoJc2VzczogZnVuY3Rpb24oY2FuLCBzZXNzLCBjYikgeyBzZXNzID0gc2Vzc3x8Y2FuLmJhc2UuT2JqKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ3ZWIuY29kZS5pbm5lci5zZXNzIiksIHt9KQoJCWNhbi5jb3JlLk5leHQoc2Vzcy5wbHVnLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGNhbi5vbmltcG9ydC50b29sa2l0KGNhbiwge2luZGV4OiBpdGVtfSwgZnVuY3Rpb24oc3ViKSB7IGNhbi50b29sa2l0W2l0ZW1dID0gc3ViLCBuZXh0KCkgfSkgfSwgZnVuY3Rpb24oKSB7CgkJCWNhbi5jb3JlLk5leHQoc2Vzcy5leHRzLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGNhbi5vbmltcG9ydC5leHRzKGNhbiwgaXRlbSwgbmV4dCkgfSwgZnVuY3Rpb24oKSB7CgkJCQljYW4uY29yZS5OZXh0KHNlc3MudGFicywgZnVuY3Rpb24oaXRlbSwgbmV4dCkgeyB2YXIgbHMgPSBpdGVtLnNwbGl0KGljZS5ERik7IGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbHNbMF0sIGxzWzFdLCBsc1syXSwgbmV4dCkgfSwgY2IpCgkJCX0pCgkJfSkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbnN5bnRheCIsIHtoZWxwOiAi6K+t5rOV6auY5LquIiwgbGlzdDogWyJrZXl3b3JkIiwgInByZWZpeCIsICJsaW5lIl0sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHNraXApIHsKCQlpZiAobXNnLk9wdGlvbihjdHguSU5ERVgpKSB7CgkJCWNhbi51aS5fcGF0aC5pbm5lclRleHQgPSBtc2cuT3B0aW9uKG5mcy5GSUxFKQoJCX0gZWxzZSB7CgkJCWNhbi51aS5fcGF0aC5pbm5lclRleHQgPSBjYW4uYmFzZS5QYXRoKG1zZy5PcHRpb24obmZzLlBBVEgpLCBtc2cuT3B0aW9uKG5mcy5GSUxFKSkKCQl9CgoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbihjYWNoZV9kYXRhKSB7CgkJCWNhbi5maWxlICYmIChjYWNoZV9kYXRhW2Nhbi5maWxlXSA9IHtjdXJyZW50OiBjYW4uY3VycmVudCwgbWF4OiBjYW4ubWF4LAoJCQkJcHJvZmlsZV9kaXNwbGF5OiBjYW4udWkucHJvZmlsZS5zdHlsZS5kaXNwbGF5LCBkaXNwbGF5X2Rpc3BsYXk6IGNhbi51aS5kaXNwbGF5LnN0eWxlLmRpc3BsYXksCgkJCX0pCgkJCWNhbi5maWxlID0gY2FuLmJhc2UuUGF0aChtc2cuT3B0aW9uKG5mcy5QQVRIKSwgbXNnLk9wdGlvbihuZnMuRklMRSkpCgkJCWNhbi5wYXJzZSA9IGNhbi5iYXNlLkV4dChjYW4uZmlsZSksIGNhbi5TdGF0dXMoIuaooeW8jyIsICJwbHVnaW4iKQoKCQkJdmFyIHAgPSBjYWNoZV9kYXRhW2Nhbi5maWxlXTsgcCAmJiAoY2FuLmN1cnJlbnQgPSBwLmN1cnJlbnQsIGNhbi5tYXggPSBwLm1heCkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLnByb2ZpbGUsIHtzdHlsZToge2Rpc3BsYXk6IHA/IHAucHJvZmlsZV9kaXNwbGF5OiBodG1sLk5PTkV9fSkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmRpc3BsYXksIHtzdHlsZToge2Rpc3BsYXk6IHA/IHAuZGlzcGxheV9kaXNwbGF5OiBodG1sLk5PTkV9fSkKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fYWN0aW9uLCBodG1sLkRJVl9UQUJTLCBtc2cuX3RhYikKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi51aS5fdGFicywgaHRtbC5ESVZfVEFCUywgbXNnLl90YWIpCgkJCWNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgeyBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikKCQkJCW1zZy5PcHRpb24oY3R4LklOREVYKSAmJiBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5PUFRJT05fQVJHUylbMF0pCgkJCX0pCgkJCXJldHVybiBjYW4uZmlsZQoJCX0sIGNhbi51aS5jb250ZW50LCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGNhbi51aS5kaXNwbGF5X291dHB1dCkgJiYgIXNraXApIHsKCQkJcmV0dXJuIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKG51bGwsIGNhbiwgbXNnLk9wdGlvbihuZnMuTElORSkpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQl9CgoJCWlmIChtc2cuT3B0aW9uKGN0eC5JTkRFWCkpIHsKCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIHtpbmRleDogbXNnLk9wdGlvbihjdHguSU5ERVgpfSwgY2FuLnVpLmNvbnRlbnQsIGZ1bmN0aW9uKHN1YikgewoJCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9XSURUSCwgc3ViLkNvbmZXaWR0aChjYW4udWkuY29udGVudC5vZmZzZXRXaWR0aCkpCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIHN1Yi5Db25mSGVpZ2h0KGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodC0yKmh0bWwuQUNUSU9OX0hFSUdIVCkpCgkJCQljYW4ub25tb3Rpb24uZGVsYXkoY2FuLCBmdW5jdGlvbigpIHsKCQkJCQljYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5PUFRJT05fQVJHUylbMF0pCgkJCQl9KSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgkJCX0pCgkJCXJldHVybgoJCX0KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmNvbnRlbnQpCgkJZnVuY3Rpb24gaW5pdChwKSB7IGNhbi5tYXggPSAwLCBjYW4uY29yZS5MaXN0KGNhbi5scyA9IG1zZy5SZXN1bHQoKS5zcGxpdChpY2UuTkwpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5vbmFjdGlvbi5hcHBlbmRMaW5lKGNhbiwgaXRlbSkKCQl9KSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUobnVsbCwgY2FuLCBtc2cuT3B0aW9uKG5mcy5MSU5FKSksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJCQltc2cuT3B0aW9uKG5mcy5GSUxFKS5pbmRleE9mKCJ3ZWJzaXRlLyIpID09IDAgJiYgY2FuLm9uYWN0aW9uWyLlsZXnpLoiXSh7fSwgY2FuKQoJCQlpZiAoY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGNhbi5fZmllbGRzLCBjaGF0LlBMVUdJTikpIHsKCQkJCXAgJiYgcC5yZW5kZXIgJiYgY2FuLm9uYWN0aW9uWyLlsZXnpLoiXSh7fSwgY2FuKQoJCQkJcCAmJiBwLmVuZ2luZSAmJiBjYW4ub25hY3Rpb25bIuaJp+ihjCJdKHt9LCBjYW4pCgkJCX0KCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGNhbi5fZmllbGRzLCBjaGF0LlNUT1JZKSAmJiAhY2FuLnVzZXIubW9kLmlzQ21kKSB7CgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5wcm9qZWN0LCBodG1sLk1JTl9IRUlHSFQsIGNhbi5Db25mSGVpZ2h0KCktMjAwKQoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5NSU5fSEVJR0hULCBjYW4uQ29uZkhlaWdodCgpLTIwMCkKCQkJfQoJCX0KCQljYW4uQ29uZigicGx1ZyIpICYmIChjYW4ub25zeW50YXhbY2FuLnBhcnNlXSA9IGNhbi5Db25mKCJwbHVnIikpCgkJdmFyIHAgPSBjYW4ub25zeW50YXhbY2FuLnBhcnNlXTsgIXA/IGNhbi5ydW4oe30sIFtjdHguQUNUSU9OLCBtZGIuUExVR0lOLCBjYW4ucGFyc2UsIG1zZy5PcHRpb24obmZzLkZJTEUpLCBtc2cuT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgewoJCQlpbml0KHAgPSBjYW4ub25zeW50YXhbY2FuLnBhcnNlXSA9IGNhbi5iYXNlLk9iaihtc2cuUmVzdWx0KCkpKQoJCX0sIHRydWUpOiBpbml0KHApCgl9LAoJX3BhcnNlOiBmdW5jdGlvbihjYW4sIGxpbmUpIHsgaWYgKGxpbmUuaW5kZXhPZigiPGh0bWwiKSA9PSAwKSB7IHJldHVybiBsaW5lIH0KCQlsaW5lID0gY2FuLnBhZ2UucmVwbGFjZShjYW4sIGxpbmV8fCIiKQoKCQlmdW5jdGlvbiB3cmFwKHR5cGUsIHN0cikgeyByZXR1cm4gdHlwZT8gJzxzcGFuIGNsYXNzPSInK3R5cGUrJyI+JytzdHIrJzwvc3Bhbj4nOiBzdHIgfQoJCXZhciBwID0gY2FuLm9uc3ludGF4W2Nhbi5wYXJzZV07IGlmICghcCkgeyByZXR1cm4gbGluZSB9IHAgPSBjYW4ub25zeW50YXhbcC5saW5rXXx8cCwgcC5zcGxpdCA9IHAuc3BsaXR8fHt9CgkJcC5rZXl3b3JkICYmIChsaW5lID0gY2FuLmNvcmUuTGlzdChjYW4uY29yZS5TcGxpdChsaW5lLCBwLnNwbGl0LnNwYWNlfHwiXHQgIiwgcC5zcGxpdC5vcGVyYXRvcnx8IntbKC4sOjshfDw+KV19Iiwge2RldGFpbDogdHJ1ZX0pLCBmdW5jdGlvbihpdGVtLCBpbmRleCwgYXJyYXkpIHsKCQkJaXRlbSA9IGNhbi5iYXNlLmlzT2JqZWN0KGl0ZW0pPyBpdGVtOiB7dGV4dDogaXRlbX0KCQkJdmFyIHRleHQgPSBpdGVtLnRleHQ7IHZhciB0eXBlID0gaXRlbS5rZXl3b3JkfHxwLmtleXdvcmRbdGV4dF0KCgkJCXN3aXRjaCAoaXRlbS50eXBlKSB7IGNhc2UgaHRtbC5TUEFDRTogcmV0dXJuIHRleHQKCQkJCWNhc2UgbGFuZy5TVFJJTkc6IHJldHVybiB3cmFwKGxhbmcuU1RSSU5HLCBpdGVtLmxlZnQrdGV4dCtpdGVtLnJpZ2h0KQoJCQkJZGVmYXVsdDogcmV0dXJuIHdyYXAodHlwZSwgdGV4dCkKCQkJfQoJCX0pLmpvaW4oIiIpKQoKCQlwLnByZWZpeCAmJiBjYW4uY29yZS5JdGVtKHAucHJlZml4LCBmdW5jdGlvbihwcmUsIHR5cGUpIHsKCQkJaWYgKGNhbi5iYXNlLmJlZ2luV2l0aChsaW5lLCBwcmUpKSB7CgkJCQlsaW5lID0gd3JhcCh0eXBlLCBsaW5lKQoJCQl9IGVsc2UgewoJCQkJdmFyIGxzID0gbGluZS5zcGxpdChwcmUpOyBpZiAobHMubGVuZ3RoID4gMSkgewoJCQkJCWxpbmUgPSBsc1swXSArIHdyYXAodHlwZSwgcHJlICsgbHNbMV0pCgkJCQl9CgkJCX0KCQl9KQoJCXAuc3VmZml4ICYmIGNhbi5jb3JlLkl0ZW0ocC5zdWZmaXgsIGZ1bmN0aW9uKGVuZCwgdHlwZSkgewoJCQlpZiAoY2FuLmJhc2UuZW5kV2l0aChsaW5lLCBlbmQpKSB7IGxpbmUgPSB3cmFwKHR5cGUsIGxpbmUpIH0KCQl9KQoJCXJldHVybiBsaW5lCgl9LAp9KQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHt9LAoJX25vcm1hbDogZnVuY3Rpb24oZXZlbnQsIGNhbikge30sCglfaW5zZXJ0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7fSwKCV9tb2RlOiB7CgkJcGx1Z2luOiB7CgkJCUVzY2FwZTogc2h5KCLmuIXlsY8iLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5riF5bGPIikgfSksCgkJCWc6IHNoeSgi5pCc57SiIiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuaQnOe0oiIpIH0pLAoJCQlmOiBzaHkoIuaJk+W8gOaWh+S7tiIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmiZPlvIAiKSB9KSwKCQkJdDogc2h5KCLmt7vliqDlkb3ku6QiLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5re75YqgIikgfSksCgkJCXA6IHNoeSgi5re75Yqg5o+S5Lu2IiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuaPkuS7tiIpIH0pLAoJCQllOiBzaHkoIua3u+WKoOaJqeWxlSIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmianlsZUiKSB9KSwKCgkJCW06IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICJhdXRvZ2VuIikgfSwKCQkJYzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgImNvbXBpbGUiKSB9LAoJCQl3OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAid2Vic2l0ZSIpIH0sCgoJCQlyOiBzaHkoIuaJp+ihjOWRveS7pCIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmiafooYwiKSB9KSwKCQkJdjogc2h5KCLlsZXnpLoiLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5bGV56S6IikgfSksCgkJCWE6IHNoeSgi5YWo5bGPIiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuWFqOWxjyIpIH0pLAoKCQkJajogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uY3VycmVudC5zY3JvbGwoMSkgfSwKCQkJazogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uY3VycmVudC5zY3JvbGwoLTEpIH0sCgkJCUo6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKGNhbi5jdXJyZW50LndpbmRvdygpLTMpIH0sCgkJCUs6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKC1jYW4uY3VycmVudC53aW5kb3coKSszKSB9LAoKCQkJaTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSB9LAoJCQluOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fbm9ybWFsKGV2ZW50LCBjYW4pIH0sCgkJCSI6IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIHtpbmRleDogImNsaS5zeXN0ZW0ifSwgZnVuY3Rpb24oc3ViKSB7IGNhbi50b29sa2l0WyJjbGkuc3lzdGVtIl0gPSBzdWIuc2VsZWN0KCkgfSkgfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5o6n5Lu25Lqk5LqSIiwgbGlzdDogWyLmkJzntKIiLCAi5omT5byAIiwgIua3u+WKoCIsICLmj5Lku7YiLCAi5omp5bGVIl0sCglfdHJhbnM6IHt3aWR0aDogIuWuveW6piIsIGhlaWdodDogIumrmOW6piIsIHdlYnNpdGU6ICLnvZHpobUifSwKCSLliqDovb0iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIGZpbGUgPSBjYW4uYmFzZS5QYXRoKCIvcmVxdWlyZS8iLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpCgkJZGVsZXRlKFZvbGNhbm9zLm1ldGEuY2FjaGVbZmlsZV0pLCBldmFsKGBcbl9jYW5fbmFtZSA9ICJgK2ZpbGUrYCJcbmArY2FuLm9uZXhwb3J0LmNvbnRlbnQoY2FuKStgXG5fY2FuX25hbWUgPSAiIlxuY29uc29sZS5sb2coIm9uY2UiKWApCgl9LAoJIuWIt+aWsCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCAic3JjLyIsICJtYWluLmdvIiwgIiIsIGZ1bmN0aW9uKCkge30sIHNraXApIH0sCgki5pCc57SiIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFttZGIuTkFNRSwgW2N0eC5BQ1RJT04sIG5mcy5UQUdTLCBuZnMuR1JFUCwgY2xpLk1BS0VdXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQljYW4udWkuc2VhcmNoLlVwZGF0ZSh7fSwgW2N0eC5BQ1RJT04sIGRhdGEuYWN0aW9uLCBkYXRhLm5hbWVdKQoJCX0pCgl9LAoJIuaJk+W8gCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbmZzLkZJTEVdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGRhdGEuZmlsZSkKCQkJY2FuLm9uaW1wb3J0LnByb2plY3QoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkKCQl9KQoJfSwKCSLmt7vliqAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW2N0eC5JTkRFWF0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEpIHsKCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgZGF0YS5pbmRleCwgY3R4LklOREVYKQoJCX0pCgl9LAoJIuaPkuS7tiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbY3R4LklOREVYXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQl2YXIgc3ViID0gY2FuLnRvb2xraXRbZGF0YS5pbmRleF07IGlmIChzdWIpIHsgc3ViLnNlbGVjdCgpOyByZXR1cm4gfQoJCQljYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIGRhdGEsIGZ1bmN0aW9uKHN1YikgeyBjYW4udG9vbGtpdFtkYXRhLmluZGV4XSA9IHN1Yi5zZWxlY3QoKSB9KQoJCX0pCgl9LAoJIuaJqeWxlSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbInVybCJdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCXZhciBzdWIgPSBjYW4uZXh0ZW50aW9uc1tkYXRhLnVybF07IGlmIChzdWIpIHsgc3ViLnNlbGVjdCgpOyByZXR1cm4gfQoJCQljYW4ub25pbXBvcnQuZXh0cyhjYW4sIGRhdGEudXJsLCBmdW5jdGlvbihzdWIpIHsgY2FuLmV4dGVudGlvbnNbZGF0YS51cmxdID0gc3ViLnNlbGVjdCgpIH0pCgkJfSkKCX0sCgki5L+d5a2YIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25leHBvcnQuc2VzcyhjYW4pLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9LAoJIumhueebriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi51aS5wcm9qZWN0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIH0sCgki5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLnVpLnRvb2xraXQuZmllbGRzZXQpIH0sCgki5omn6KGMIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQuZGlzcGxheShjYW4pLCBjYW4ucmVxdWVzdChldmVudCwge190b2FzdDogIuaJp+ihjOS4rS4uLiJ9KQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuRU5HSU5FLCBjYW4ucGFyc2UsIGNhbi5PcHRpb24obmZzLkZJTEUpLCBjYW4uT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQuX3N0YXR1cyhjYW4sIG1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMpLCBjYW4udWkuZGlzcGxheV9zdGF0dXMpCgkJCWNhbi5vbmltcG9ydC5kaXNwbGF5KGNhbiwgbXNnKSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIAoJCX0sIHRydWUpCgl9LAoJIuWxleekuiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0LnByb2ZpbGUoY2FuKSwgY2FuLnJlcXVlc3QoZXZlbnQsIHtfdG9hc3Q6ICLmuLLmn5PkuK0uLi4ifSkKCQlpZiAoY2FuLk9wdGlvbihuZnMuRklMRSkuaW5kZXhPZigid2Vic2l0ZS8iKSA9PSAwKSB7CgkJCWNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBjYW4ucHJvZmlsZV9zaXplW2Nhbi5vbmV4cG9ydC5rZXlzKGNhbildIHx8IGNhbi5Db25mV2lkdGgoKSpwYXJzZUludCg3MCkvMTAwCgkJfQoJCWNhbi5wYXJzZSA9PSAianMiICYmIGNhbi5vbmFjdGlvblsi5Yqg6L29Il0oZXZlbnQsIGNhbikKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlJFTkRFUiwgY2FuLnBhcnNlLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuUEFUSCldLCBmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm9uaW1wb3J0LnByb2ZpbGUoY2FuLCBtc2cpCgkJfSwgdHJ1ZSkKCX0sCgki5riF5bGPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBkb2N1bWVudC5ib2R5LCAiLmlucHV0LmZsb2F0IiwgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaXRlbSkKCQl9KS5sZW5ndGggPiAwKSB7IHJldHVybiB9CgoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkudG9vbGtpdC5zdGF0dXMsICJsZWdlbmQuc2VsZWN0IiwgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gaXRlbS5jbGljaygpLCBpdGVtCgkJfSkubGVuZ3RoID4gMCkgeyByZXR1cm4gfQoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX3N0YXR1cywgImxlZ2VuZC5zZWxlY3QiLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiBpdGVtLmNsaWNrKCksIGl0ZW0KCQl9KS5sZW5ndGggPiAwKSB7IHJldHVybiB9CgoJCWlmIChjYW4udWkucHJvZmlsZS5zdHlsZS5kaXNwbGF5ID09ICIiKSB7CgkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkucHJvZmlsZSkKCQl9IGVsc2UgaWYgKGNhbi51aS5kaXNwbGF5LnN0eWxlLmRpc3BsYXkgPT0gIiIpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCX0gZWxzZSBpZiAoY2FuLnVpLnByb2plY3Quc3R5bGUuZGlzcGxheSA9PSAiIikgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgkJfSBlbHNlIHsKCQkJY2FuLm9uYWN0aW9uWyLlhajlsY8iXShldmVudCwgY2FuKQoJCX0KCQljYW4ub25pbXBvcnQubGF5b3V0KGNhbikKCX0sCgki5YWo5bGPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgY2FuLl9maWVsZHMsICJmdWxsIikpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQpCgkJfSBlbHNlIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0LCB0cnVlKQoJCQljYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQtMipodG1sLkFDVElPTl9IRUlHSFQpCgkJfQoJCWNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJfSwKCWJhY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmhpc3RvcnkucG9wKCk7IHZhciBsYXN0ID0gY2FuLmhpc3RvcnkucG9wKCkKCQlsYXN0ICYmIGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbGFzdC5wYXRoLCBsYXN0LmZpbGUsIGxhc3QubGluZSkKCQljYW4uU3RhdHVzKCLot7PovazmlbAiLCBjYW4uaGlzdG9yeS5sZW5ndGgpCgl9LAoKCXNjcm9sbExpbmU6IGZ1bmN0aW9uKGNhbiwgY291bnQpIHsgdmFyIHNpemUgPSAyMDsgY2FuLmN1cnJlbnQuc2Nyb2xsKGNvdW50KnNpemUpIH0sCglhcHBlbmRMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7CgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmNvbnRlbnQsIFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQl7dmlldzogWyJsaW5lIHVuc2VsZWN0YWJsZSIsIGh0bWwuVEQsICsrY2FuLm1heF0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCB1aS50cikKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbi5mYXZvckxpbmUoY2FuLCB1aS50ZXh0LmlubmVyVGV4dCkKCQkJfX0sCgoJCQl7dmlldzogW2h0bWwuVEVYVCwgaHRtbC5URF0sIGxpc3Q6IFtjYW4ub25zeW50YXguX3BhcnNlKGNhbiwgdmFsdWUpXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIHVpLnRyKQoKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciBzID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKSwgc3RyID0gdWkudGV4dC5pbm5lclRleHQKCQkJCXZhciBiZWdpbiA9IHN0ci5pbmRleE9mKHMpLCBlbmQgPSBiZWdpbitzLmxlbmd0aAoKCQkJCWZvciAodmFyIGkgPSBiZWdpbjsgaSA+PSAwOyBpLS0pIHsKCQkJCQlpZiAoc3RyW2ldLm1hdGNoKC9bYS16QS1aMC05Xy5dLykpIHsgcyA9IHN0ci5zbGljZShpLCBlbmQpIH0gZWxzZSB7IGJyZWFrIH0KCQkJCX0KCgkJCQlpZiAocy5pbmRleE9mKCJraXQuIikgPT0gMCkgeyBzID0gcy5yZXBsYWNlKCJraXQuIiwgInRvb2xraXRzLiIpIH0KCQkJCWlmIChzLmluZGV4T2YoIi4iKSA9PSAwKSB7IHMgPSBzLnNsaWNlKDEpIH0KCQkJCWNhbi5vbmFjdGlvbi5zZWFyY2hMaW5lKGV2ZW50LCBjYW4sIHMpCgkJCX19CgkJXX1dKTsgcmV0dXJuIHVpLnRyCgl9LAoJX2dldExpbmU6IGZ1bmN0aW9uKGNhbiwgbGluZSkgewoJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycmF5KSB7IGlmIChpdGVtID09IGxpbmUgfHwgaW5kZXgrMSA9PSBsaW5lKSB7IHJldHVybiBpdGVtIH0gfSlbMF0KCX0sCglfZ2V0TGluZW5vOiBmdW5jdGlvbihjYW4sIGxpbmUpIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVFIsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnJheSkgeyBpZiAoaXRlbSA9PSBsaW5lIHx8IGluZGV4KzEgPT0gbGluZSkgeyByZXR1cm4gaW5kZXgrMSB9IH0pWzBdCgl9LAoJc2VsZWN0TGluZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbGluZSkgeyBpZiAoIWxpbmUpIHsgcmV0dXJuIHBhcnNlSW50KGNhbi5jb3JlLlZhbHVlKGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBbW1todG1sLlRSLCBodG1sLlNFTEVDVF0sIFtodG1sLlRELCAibGluZSJdXV0pWzBdLCAiaW5uZXJUZXh0IikpIH0KCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycmF5KSB7IGlmIChsaW5lIDwgMCB8fCBsaW5lID4gYXJyYXkubGVuZ3RoKSB7IHJldHVybiB9CgkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIGl0ZW0sIGh0bWwuU0VMRUNULCBpdGVtID09IGxpbmUgfHwgaW5kZXgrMSA9PSBsaW5lKSkgeyByZXR1cm4gfQoJCQl2YXIgbHMgPSBjYW4uZmlsZS5zcGxpdChpY2UuUFMpCgkJCWlmIChscy5sZW5ndGggPiA0KSB7IGxzID0gW2xzLnNsaWNlKDAsIDIpLmpvaW4oaWNlLlBTKSsiLy4uLi8iK2xzLnNsaWNlKC0yKS5qb2luKGljZS5QUyldIH0KCQkJbGluZSA9IGl0ZW0sIGNhbi5TdGF0dXMoa2l0LkRpY3QoIuaWh+S7tuWQjSIsIGxzLmpvaW4oaWNlLlBTKSwgIuino+aekOWZqCIsIGNhbi5wYXJzZSwgIuW9k+WJjeihjCIsIGNhbi5vbmV4cG9ydC5wb3NpdGlvbihjYW4sIGNhbi5PcHRpb24obmZzLkxJTkUsIGluZGV4KzEpKSkpCgkJfSkKCgkJY2FuLmJhc2UuaXNPYmplY3QobGluZSkgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgbGluZSwgInRkLnRleHQiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5jdXJyZW50ID0gewoJCQkJd2luZG93OiBmdW5jdGlvbigpIHsgcmV0dXJuIHBhcnNlSW50KGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodC9jYW4uY3VycmVudC5saW5lLm9mZnNldEhlaWdodCkgfSwKCQkJCXNjcm9sbDogZnVuY3Rpb24oY291bnQpIHsgaWYgKGNvdW50KSB7IGNhbi51aS5jb250ZW50LnNjcm9sbFRvcCArPSBjb3VudCpjYW4uY3VycmVudC5saW5lLm9mZnNldEhlaWdodCB9CgkJCQkJcmV0dXJuIHBhcnNlSW50KChjYW4uY3VycmVudC5saW5lLm9mZnNldFRvcC1jYW4udWkuY29udGVudC5zY3JvbGxUb3ApL2Nhbi5jdXJyZW50LmxpbmUub2Zmc2V0SGVpZ2h0KQoJCQkJfSwKCgkJCQlwcmV2OiBmdW5jdGlvbigpIHsgcmV0dXJuIGxpbmUucHJldmlvdXNTaWJsaW5nIH0sCgkJCQluZXh0OiBmdW5jdGlvbigpIHsgcmV0dXJuIGxpbmUubmV4dFNpYmxpbmcgfSwKCQkJCWxpbmU6IGxpbmUsIHRleHQ6IGZ1bmN0aW9uKHRleHQpIHsKCQkJCQlyZXR1cm4gdGV4dCAhPSB1bmRlZmluZWQgJiYgY2FuLm9uYWN0aW9uLm1vZGlmeUxpbmUoY2FuLCBsaW5lLCB0ZXh0KSwgaXRlbS5pbm5lclRleHQKCQkJCX0sCgkJCX0KCgkJCWlmICghZXZlbnQpIHsKCQkJCXZhciBzY3JvbGwgPSBjYW4uY3VycmVudC5zY3JvbGwoKTsgaWYgKHNjcm9sbCA8IDUpIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKHNjcm9sbC01KSB9IGVsc2UgewoJCQkJCXZhciB3aW5kb3cgPSBjYW4uY3VycmVudC53aW5kb3coKTsgaWYgKHNjcm9sbCA+IHdpbmRvdy8yKSB7IGNhbi5jdXJyZW50LnNjcm9sbChzY3JvbGwtd2luZG93LzIpIH0KCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXZhciBzY3JvbGwgPSBjYW4uY3VycmVudC5zY3JvbGwoKTsgaWYgKHNjcm9sbCA8IDMpIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKHNjcm9sbC0zKSB9IGVsc2UgewoJCQkJCXZhciB3aW5kb3cgPSBjYW4uY3VycmVudC53aW5kb3coKTsgaWYgKHNjcm9sbCA+IHdpbmRvdy00KSB7IGNhbi5jdXJyZW50LnNjcm9sbChzY3JvbGwtd2luZG93KzQpIH0KCQkJCX0KCQkJfQoKCQkJdmFyIHB1c2ggPSB7cGF0aDogY2FuLk9wdGlvbihuZnMuUEFUSCksIGZpbGU6IGNhbi5PcHRpb24obmZzLkZJTEUpLCBsaW5lOiBjYW4uT3B0aW9uKG5mcy5MSU5FKSwgdGV4dDogY2FuLmN1cnJlbnQudGV4dCgpfQoJCQljYW4uYmFzZS5FcSh7cGF0aDogcHVzaC5wYXRoLCBmaWxlOiBwdXNoLmZpbGUsIGxpbmU6IHB1c2gubGluZX0sIGNhbi5oaXN0b3J5W2Nhbi5oaXN0b3J5Lmxlbmd0aC0xXSkgfHwgY2FuLmhpc3RvcnkucHVzaChwdXNoKQoJCQljYW4uU3RhdHVzKCLot7PovazmlbAiLCBjYW4uaGlzdG9yeS5sZW5ndGgpCgkJCWNhbi5vbmFjdGlvbi5fc2VsZWN0TGluZShldmVudCwgY2FuKQoJCX0pCgl9LAoJX3NlbGVjdExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgfSwKCXNlYXJjaExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHZhbHVlKSB7IGlmICghY2FuLnVpLnNlYXJjaCkgeyByZXR1cm4gfQoJCWNhbi51aS5zZWFyY2guVXBkYXRlKGV2ZW50LCBbY3R4LkFDVElPTiwgbmZzLlRBR1MsIHZhbHVlLnRyaW0oKV0pCgl9LAoJZmF2b3JMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiAiem9uZSIsIHZhbHVlOiAiaGkifSwge25hbWU6ICJuYW1lIiwgdmFsdWU6ICJoZWxsbyJ9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY29kZS5GQVZPUiwgY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgbWRiLlpPTkUsIGRhdGEuem9uZXx8IiIsCgkJCQltZGIuVFlQRSwgY2FuLnBhcnNlLCBtZGIuTkFNRSwgZGF0YS5uYW1lfHwiIiwgbWRiLlRFWFQsICh2YWx1ZXx8IiIpLnRyaW1SaWdodCgpLAoJCQkJbmZzLlBBVEgsIGNhbi5PcHRpb24obmZzLlBBVEgpLCBuZnMuRklMRSwgY2FuLk9wdGlvbihuZnMuRklMRSksIG5mcy5MSU5FLCBjYW4uT3B0aW9uKG5mcy5MSU5FKSwKCQkJXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pIH0sIHRydWUpCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyLmlofku7bmlbAiLCAi6Kej5p6Q5ZmoIiwgIuaWh+S7tuWQjSIsICLlvZPliY3ooYwiLCAi6Lez6L2s5pWwIiwgIuagh+etvuaVsCJdLAoJc2VzczogZnVuY3Rpb24oY2FuKSB7CgkJbG9jYWxTdG9yYWdlLnNldEl0ZW0oIndlYi5jb2RlLmlubmVyLnNlc3MiLCBKU09OLnN0cmluZ2lmeSh7CgkJCSJ0YWJzIjogY2FuLm9uZXhwb3J0LnRhYnMoY2FuKSwgInBsdWciOiBjYW4ub25leHBvcnQucGx1ZyhjYW4pLCAiZXh0cyI6IGNhbi5vbmV4cG9ydC5leHRzKGNhbiksCgkJfSkpCgl9LAoJa2V5czogZnVuY3Rpb24oY2FuLCBmaWxlLCBwYXRoKSB7IHJldHVybiAocGF0aHx8Y2FuLk9wdGlvbihuZnMuUEFUSCkpKyI6IisoZmlsZXx8Y2FuLk9wdGlvbihuZnMuRklMRSkpIH0sCgl0YWJzOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnRhYnZpZXcsIGZ1bmN0aW9uKGtleSwgbXNnKSB7IHJldHVybiBrZXkraWNlLkRGK21zZy5PcHRpb24obmZzLkxJTkUpIH0pIH0sCglwbHVnOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnRvb2xraXQpIH0sCglleHRzOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnBsdWdpbnMpIH0sCglwb3NpdGlvbjogZnVuY3Rpb24oY2FuLCBpbmRleCwgdG90YWwpIHsgdG90YWwgPSB0b3RhbHx8Y2FuLm1heAoJCXJldHVybiAocGFyc2VJbnQoaW5kZXgpKStpY2UuUFMrcGFyc2VJbnQodG90YWwpKyIgPSAiK3BhcnNlSW50KChpbmRleCkqMTAwL3RvdGFsKSsiJSIKCX0sCgljb250ZW50OiBmdW5jdGlvbihjYW4pIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ZC50ZXh0IiwgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS5pbm5lclRleHQgfSkuam9pbihpY2UuTkwpCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL3N0YXRlLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBjb25mLCBsaXN0LCBjYiwgdGFyZ2V0KSB7fSwKCV9wcm9jZXNzOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCW1zZy5PcHRpb25TdGF0dXMoKSAmJiBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uX3N0YXR1cykgJiYgY2FuLm9uYXBwZW5kLl9zdGF0dXMoY2FuLCBjYW4uYmFzZS5PYmoobXNnLk9wdGlvblN0YXR1cygpKSkKCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmltcG9ydCwgbXNnLk9wdGlvblByb2Nlc3MoKV0sIFtjYW4sIG1zZ10pCgl9LAoKCV9jb25maXJtOiBmdW5jdGlvbihjYW4sIG1zZywgX2FyZykgeyB2YXIgc3ViID0gY2FuLnJlcXVlc3Qoe30sIGNhbi5PcHRpb24oKSkKCQlpZiAoY2FuLnVzZXIuY29uZmlybShfYXJnKSkgeyBjYW4ucnVuKHN1Yi5fZXZlbnQsIFtjdHguQUNUSU9OLCAiY29uZmlybSJdLCBmdW5jdGlvbigpIHt9LCB0cnVlKSB9Cgl9LAoJX2xvY2F0aW9uOiBmdW5jdGlvbihjYW4sIG1zZykgeyBsb2NhdGlvbi5ocmVmID0gbXNnLl9hcmdbMF0gfSwKCV9yZXBsYWNlOiBmdW5jdGlvbihjYW4sIG1zZykgeyBsb2NhdGlvbi5yZXBsYWNlKG1zZy5fYXJnWzBdKSB9LAoJX2hpc3Rvcnk6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGhpc3RvcnkuYmFjaygpIH0sCglfcmV3cml0ZTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQlmb3IgKHZhciBpID0gMDsgaSA8IG1zZy5fYXJnLmxlbmd0aDsgaSArPSAyKSB7CgkJCWNhbi5PcHRpb24obXNnLl9hcmdbaV0sIG1zZy5fYXJnW2krMV0pCgkJCWNhbi5BY3Rpb24obXNnLl9hcmdbaV0sIG1zZy5fYXJnW2krMV0pCgkJfQoJCWNhbi5VcGRhdGUoKQoJCXJldHVybiB0cnVlCgl9LAoJX3JlZnJlc2g6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQobXNnLk9wdGlvbigiX2RlbGF5Iil8fCI1MDAiKSwgZnVuY3Rpb24oKSB7CgkJCXZhciBzdWIgPSBjYW4ucmVxdWVzdCh7fSwge19jb3VudDogcGFyc2VJbnQobXNnLk9wdGlvbigiX2NvdW50IikpLTF9KQoJCQljYW4uVXBkYXRlKCkKCQl9KQoJCXJldHVybiB0cnVlCgl9LAoJX2Rpc3BsYXk6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJVm9sY2Fub3MoInNvbWUiLCB7fSwgW21zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKV0uY29uY2F0KFZvbGNhbm9zLm1ldGEubGlicywgVm9sY2Fub3MubWV0YS52b2xjYW5vKSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5Db25mKGNhbi5Db25mKCkpLCBzdWIucnVuID0gY2FuLnJ1bgoJCQlzdWIuX29wdGlvbiA9IGNhbi5fb3B0aW9uLCBzdWIuX2FjdGlvbiA9IGNhbi5fYWN0aW9uCgkJCXN1Yi5vbmltcG9ydC5faW5pdChzdWIsIG1zZywgW10sIGZ1bmN0aW9uKCkge30sIGNhbi5fb3V0cHV0KQoJCX0pCgkJcmV0dXJuIHRydWUKCX0sCglfZmllbGQ6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS50eXBlID0gY2hhdC5TVE9SWSwgY2FuLm9uYXBwZW5kLl9wbHVnaW4oY2FuLCBpdGVtLCB7dHlwZTogY2hhdC5TVE9SWSwgYXJnOiBjYW4uYmFzZS5PYmooaXRlbVtpY2UuQVJHXSwgW10pfSwgZnVuY3Rpb24oc3ViLCBtZXRhKSB7CgkJCXN1Yi5Db25mKGNhbi5iYXNlLk9iaihpdGVtLmNvbmYpKQoJCQlpZiAoc3ViLkNvbmYoIm1vZGUiKSA9PSAic2ltcGxlIikgewoJCQkJdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KCkKCQkJCW1zZy5FY2hvKHN1Yi5Db25mKCJyZXN1bHQiKSkKCQkJCXN1Yi5Db25mKGh0bWwuSEVJR0hULCBjYW4uQ29uZihodG1sLkhFSUdIVCkvMikKCQkJCWNhbi5vbmFwcGVuZC5fb3V0cHV0KHN1YiwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSl8fHN1Yi5Db25mKCJmZWF0dXJlLmRpc3BsYXkiKXx8Ii9wbHVnaW4vdGFibGUuanMiKQoJCQkJcmV0dXJuCgkJCX0KCQkJdmFyIG9wdCA9IGNhbi5iYXNlLk9iaihpdGVtW2ljZS5PUFRdLCBbXSkKCQkJc3ViLkNvbmYoaHRtbC5IRUlHSFQsIGNhbi5Db25mKGh0bWwuSEVJR0hUKSkKCQkJc3ViLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCktNCpodG1sLlBMVUdJTl9NQVJHSU4pCgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgewoJCQkJdmFyIHJlcyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCBjYW4uT3B0aW9uKCkpCgkJCQlmb3IgKHZhciBpID0gMDsgaSA8IG9wdC5sZW5ndGg7IGkgKz0gMikgeyByZXMuT3B0aW9uKG9wdFtpXSwgb3B0W2krMV0pIH0KCQkJCWNhbi5ydW4oZXZlbnQsIChtc2dbaWNlLk1TR19QUkVGSVhdfHxbXSkuY29uY2F0KGNtZHMpLCBjYiwgdHJ1ZSkKCQkJfQoJCX0pIH0pCgkJcmV0dXJuIHRydWUKCX0sCglfaW5uZXI6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZykKCQljYW4ub25tb3Rpb24uc3RvcnkuYXV0byhjYW4pCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLl9vdXRwdXQsIHtzdHlsZToge2Rpc3BsYXk6IGh0bWwuQkxPQ0t9fSkKCQlyZXR1cm4gdHJ1ZQoJfSwKCglfb3BlbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQljYW4udXNlci5vcGVuKG1zZy5PcHRpb24oIl9hcmciKSksIGNhbi5VcGRhdGUoKQoJCXJldHVybiB0cnVlCgl9LAoJX2hvbGQ6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IHJldHVybiB0cnVlIH0sCglfYmFjazogZnVuY3Rpb24oY2FuKSB7CgkJY2FuLl9oaXN0b3J5LnBvcCgpOyBmb3IgKHZhciBoaXMgPSBjYW4uX2hpc3RvcnkucG9wKCk7IGhpczsgaGlzID0gY2FuLl9oaXN0b3J5LnBvcCgpKSB7IGlmIChoaXNbMF0gPT0gY3R4LkFDVElPTikgeyBjb250aW51ZSB9CgkJCXZhciBpbmRleCA9IDAKCQkJY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGNhbi5fb3B0aW9uLCAiIiwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLnZhbHVlID0gaGlzW2luZGV4KytdfHwiIiB9KQoJCQljYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgY2FuLl9hY3Rpb24sICIiLCBmdW5jdGlvbihpdGVtKSB7IGl0ZW0udmFsdWUgPSBoaXNbaW5kZXgrK118fCIiIH0pCgkJCWNhbi5VcGRhdGUoKQoJCQlicmVhawoJCX0KCQkhaGlzICYmIGNhbi5VcGRhdGUoKQoJCXJldHVybiB0cnVlCgl9LAoKCV9ncm93OiBmdW5jdGlvbihjYW4sIHN0cikgewoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgImRpdi5jb2RlIiwgZnVuY3Rpb24oZGl2KSB7CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGRpdiwge3N0eWxlOiB7Im1heC1oZWlnaHQiOiA0MDB9fSkKCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgZGl2LCBbe3RleHQ6IFtzdHJdfV0pCgkJCWRpdi5zY3JvbGxCeSgwLCAxMDAwMCkKCQkJcmV0dXJuIHRydWUKCQl9KS5sZW5ndGggPT0gMCkgewoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBzdHIpCgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmk43kvZwiLCBsaXN0OiBbCgkJIuWFseS6q+W3peWFtyIsICLliLfmlrDmlbDmja4iLCAi5YiH5o2i5YWo5bGPIiwgIuaJk+W8gOmTvuaOpSIsICLnlJ/miJDpk77mjqUiLCAi55Sf5oiQ5Zu+54mHIiwgIueUn+aIkOiEmuacrCIsIFsKCQkJIuWFtuWugyIsICLmianlsZXlj4LmlbAiLCAi5riF56m65Y+C5pWwIiwgIuWkjeWItuaVsOaNriIsICLkuIvovb3mlbDmja4iLCAi5riF56m65pWw5o2uIiwgIuWIoOmZpOW3peWFtyIsCgkJXSwKCV0sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkge30sCglfZW5naW5lOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgY2FuLlVwZGF0ZShldmVudCwgW2N0eC5BQ1RJT04sIGJ1dHRvbl0uY29uY2F0KGNhbi5JbnB1dChbXSwgdHJ1ZSkpKSB9LAoKCSLmianlsZXlj4LmlbAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi5fYWN0aW9uKQoJfSwKCSLlhbHkuqvlt6XlhbciOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKQoJCWNhbi5vbm1vdGlvbi5zaGFyZShldmVudCwgY2FuLCBbe25hbWU6IGNoYXQuVElUTEUsIHZhbHVlOiBtZXRhLm5hbWV9LCB7bmFtZTogY2hhdC5UT1BJQywgdmFsdWVzOiBbY2xpLldISVRFLCBjbGkuQkxBQ0tdfV0sIFsKCQkJbWRiLk5BTUUsIG1ldGEuaW5kZXgsIG1kYi5URVhULCBKU09OLnN0cmluZ2lmeShjYW4uSW5wdXQoW10sIHRydWUpKSwKCQldKQoJfSwKCSLliIfmjaLlhajlsY8iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBzdWIgPSBjYW4uX291dHB1dHNbY2FuLl9vdXRwdXRzLmxlbmd0aC0xXQoJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgY2FuLl90YXJnZXQsICJGdWxsIikpIHsKCQkJc3ViLl9oZWlnaHRfYmFrID0gc3ViLkNvbmZIZWlnaHQoKSwgc3ViLl93aWR0aF9iYWsgPSBzdWIuQ29uZldpZHRoKCkKCQkJdmFyIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodC0oY2FuLl9zdGF0dXMuaW5uZXJUZXh0PyAyOiAxKSpodG1sLkFDVElPTl9IRUlHSFQKCQkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgKGhlaWdodCAtPSAyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4uX291dHB1dCwgImhlaWdodCIsIHN1Yi5Db25mSGVpZ2h0KGhlaWdodCksICJtaW4td2lkdGgiLCBzdWIuQ29uZldpZHRoKHdpbmRvdy5pbm5lcldpZHRoKSkKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW3N1YiwgIm9uaW1wb3J0LmxheW91dCJdLCB7Y2FuOiBzdWJ9KQoJCX0gZWxzZSB7CgkJCXN1Yi5Db25mSGVpZ2h0KHN1Yi5faGVpZ2h0X2JhayksIHN1Yi5Db25mV2lkdGgoc3ViLl93aWR0aF9iYWspCgkJCWNhbi5jb3JlLkNhbGxGdW5jKFtzdWIsICJvbmltcG9ydC5sYXlvdXQiXSwge2Nhbjogc3VifSkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4uX291dHB1dCwgImhlaWdodCIsICIiLCAibWluLXdpZHRoIiwgIiIpCgkJfQoJfSwKCSLmiZPlvIDpk77mjqUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKQoJCXZhciBwcmUgPSAiL2NoYXQvY21kLyI7IGlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsgcHJlID0gIi9jaGF0L3BvZC8iK2Nhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpKyIvY21kLyIgfQoJCXZhciBhcmdzID0gY2FuLk9wdGlvbigpOyBhcmdzLl9wYXRoID0gcHJlKyhtZXRhLmluZGV4fHxjYW4uY29yZS5LZXlzKG1ldGEuY3R4LCBtZXRhLmNtZCkpCgkJYXJncy5fcGF0aC5pbmRleE9mKCIvY21kL3dlYi53aWtpLndvcmQiKSA+IC0xICYmIChhcmdzID0ge19wYXRoOiBwcmUrYXJncy5wYXRofSkKCgkJY2FuLnVzZXIuaXNXZWlYaW4/IGNhbi51c2VyLmp1bXBzKGNhbi5taXNjLk1lcmdlVVJMKGNhbiwgYXJncykpOiBjYW4udXNlci5vcGVuKGNhbi5taXNjLk1lcmdlVVJMKGNhbiwgYXJncykpCgl9LAoJIueUn+aIkOmTvuaOpSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1ldGEgPSBjYW4uQ29uZigpCgkJdmFyIHByZSA9ICIvY2hhdC9jbWQvIjsgaWYgKGNhbi51c2VyLm1vZC5pc1BvZCkgeyBwcmUgPSAiL2NoYXQvcG9kLyIrY2FuLm1pc2MuU2VhcmNoKGNhbiwgaWNlLlBPRCkrIi9jbWQvIiB9CgkJdmFyIGFyZ3MgPSBjYW4uT3B0aW9uKCk7IGFyZ3MuX3BhdGggPSBwcmUrKG1ldGEuaW5kZXh8fGNhbi5jb3JlLktleXMobWV0YS5jdHgsIG1ldGEuY21kKSkKCQlhcmdzLl9wYXRoLmluZGV4T2YoIi9jbWQvd2ViLndpa2kud29yZCIpID4gLTEgJiYgKGFyZ3MgPSB7X3BhdGg6IHByZSthcmdzLnBhdGh9KQoJCXZhciB1cmwgPSBjYW4ubWlzYy5NZXJnZVVSTChjYW4sIGFyZ3MpCgkJY2FuLnVzZXIuY29weShldmVudCwgY2FuLCB1cmwpCgkJY2FuLm9ubW90aW9uLnNoYXJlKGV2ZW50LCBjYW4sIFtdLCBbbWRiLkxJTkssIHVybF0pCgl9LAoJIueUn+aIkOWbvueJhyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvaW1hZ2UoZXZlbnQsIGNhbiwgY2FuLl9uYW1lKSB9LAoJLy8gIueUn+aIkOWbvueJhyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCS8vICAgICBjYW4udXNlci50b1BORyhjYW4sICJoaS5wbmciLCBjYW4uX3RhcmdldC5vdXRlckhUTUwsIGNhbi5Db25mKGh0bWwuSEVJR0hUKSwgY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkvLyB9LAoKCSLnlJ/miJDohJrmnKwiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgdmFyIGNvbmYgPSBjYW4uQ29uZigpCgkJdmFyIGFyZ3MgPSBjYW4uSW5wdXQoIiIsIHRydWUpLmpvaW4oaWNlLlNQKTsgdmFyIGxpc3QgPSBbCgkJCSJleHBvcnQgY3R4X2Rldj0iK2xvY2F0aW9uLm9yaWdpbisiOyBjdHhfdGVtcD0kKG1rdGVtcCk7IGN1cmwgLWZzU0wgJGN0eF9kZXYgLW8gJGN0eF90ZW1wOyIrIiBzb3VyY2UgJGN0eF90ZW1wICIrKGNvbmYuaW5kZXh8fCIiKStpY2UuU1ArYXJncywKCQkJImlzaF9zeXNfZGV2X3J1bl9jb21tYW5kICIrYXJncywgImlzaF9zeXNfZGV2X3J1bl9hY3Rpb24iLCAiaXNoX3N5c19kZXZfcnVuX3NvdXJjZSIsCgkJXQoJCXZhciB1aSA9IGNhbi51c2VyLnRvYXN0KGNhbiwge3RpdGxlOiBidXR0b24sIGR1cmF0aW9uOiAtMSwgd2lkdGg6IC0zMDAsCgkJCWNvbnRlbnQ6ICc8ZGl2IGNsYXNzPSJzdG9yeSIgZGF0YS10eXBlPSJzcGFyayIsIGRhdGEtbmFtZT0ic2hlbGwiPicrCgkJCSc8bGFiZWw+JCA8L2xhYmVsPicrJzxzcGFuPicrbGlzdC5qb2luKCI8L3NwYW4+PGJyLz48bGFiZWw+JCA8L2xhYmVsPjxzcGFuPiIpKyc8L3NwYW4+JysnPC9kaXY+JywKCQkJYWN0aW9uOiBbY2xpLkNMT1NFXSwKCQl9KQoJCWNhbi5vbm1vdGlvbi5zdG9yeS5hdXRvKGNhbiwgdWkuX3RhcmdldCkKCQljYW4udXNlci5jb3B5KGV2ZW50LCBjYW4sIGxpc3RbMF0pCgl9LAoJIuWIt+aWsOaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLlVwZGF0ZSh7fSwgY2FuLklucHV0KFtdLCB0cnVlKSkgfSwKCSLmiZPljIXpobXpnaIiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCAib253ZWJwYWNrIiwgY2FuLnJlcXVlc3QoZXZlbnQpKSB9LAoJIuWIt+aWsOmhtemdoiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgc3ViID0gY2FuLmNvcmUuVmFsdWUoY2FuLl9vdXRwdXRzLCAiLTEiKSwgbXNnID0gc3ViLl9tc2cKCQljYW4uY29yZS5DYWxsRnVuYyhbc3ViLCBjaGF0Lk9OSU1QT1JULCAiX2luaXQiXSwge2Nhbjogc3ViLCBtc2c6IG1zZywgbGlzdDogbXNnLnJlc3VsdHx8bXNnLmFwcGVuZHx8W10sIGNiOiBmdW5jdGlvbihtc2cpIHsKCQl9LCB0YXJnZXQ6IGNhbi5fb3V0cHV0fSkKCX0sCgki5L+d5a2Y5Y+C5pWwIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIlJpdmVyLm9uZGV0YWlsLuS/neWtmOWPguaVsCJdKSB9LAoKCSLmuIXnqbrlj4LmlbAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGNhbi5fb3B0aW9uLCAiIiwgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS52YWx1ZSA9ICIiIH0pCgl9LAoJIuWkjeWItuaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1ldGEgPSBjYW4uQ29uZigpLCBtc2cgPSBjYW4uX21zZwoJCXZhciByZXMgPSBbbXNnLmFwcGVuZCAmJiBtc2cuYXBwZW5kLmpvaW4oIiwiKV07IG1zZy5UYWJsZShmdW5jdGlvbihsaW5lLCBpbmRleCwgYXJyYXkpIHsKCQkJcmVzLnB1c2goY2FuLmNvcmUuSXRlbShsaW5lLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiB2YWx1ZSB9KS5qb2luKCIsIikpCgkJfSkKCgkJcmVzLmxlbmd0aCA+IDEgJiYgY2FuLnVzZXIuY29weShldmVudCwgY2FuLCByZXMuam9pbihpY2UuU1ApKQoJCW1zZy5yZXN1bHQgJiYgY2FuLnVzZXIuY29weShldmVudCwgY2FuLCBtc2cuUmVzdWx0KCkpCgl9LAoJIuS4i+i9veaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1ldGEgPSBjYW4uQ29uZigpLCBtc2cgPSBjYW4uX21zZwoJCXZhciByZXMgPSBbbXNnLmFwcGVuZCAmJiBtc2cuYXBwZW5kLmpvaW4oIiwiKV07IG1zZy5UYWJsZShmdW5jdGlvbihsaW5lLCBpbmRleCwgYXJyYXkpIHsKCQkJcmVzLnB1c2goY2FuLmNvcmUuSXRlbShsaW5lLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiB2YWx1ZSB9KS5qb2luKCIsIikpCgkJfSkKCgkJcmVzLmxlbmd0aCA+IDEgJiYgY2FuLnVzZXIuZG93bmxvYWRzKGNhbiwgcmVzLmpvaW4oIlxuIiksIG1ldGEubmFtZSsiLmNzdiIpCgkJbXNnLnJlc3VsdCAmJiBjYW4udXNlci5kb3dubG9hZHMoY2FuLCBtc2cuUmVzdWx0KCksIG1ldGEubmFtZSsiLnR4dCIpCgl9LAoJIua4heepuuaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLl9vdXRwdXQpIH0sCgki5Yig6Zmk5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uX3RhcmdldCkgfSwKCSLmkYTlg4/lpLQiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIGNvbnN0cmFpbnRzID0ge2F1ZGlvOiBmYWxzZSwgdmlkZW86IHt3aWR0aDogMjAwLCBoZWlnaHQ6IDIwMH19CgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLl9vdXRwdXQsIFt7dmlldzogY3R4LkFDVElPTn0sIHt2aWV3OiAiY2FwdHVyZSIsIGxpc3Q6IFt7dHlwZTogInZpZGVvIiwgX2luaXQ6IGZ1bmN0aW9uKGl0ZW0pIHsKCQkJbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CgkJCQlpdGVtLnNyY09iamVjdCA9IHN0cmVhbSwgaXRlbS5vbmxvYWRlZG1ldGFkYXRhID0gZnVuY3Rpb24oZSkgewoJCQkJCWl0ZW0ucGxheSgpCgkJCQl9LCB1aS5zdHJlYW0gPSBzdHJlYW0KCQkJfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7IGNvbnNvbGUubG9nKGVyci5uYW1lICsgIjogIiArIGVyci5tZXNzYWdlKTsgfSkKCQl9fV19XSkKCgkJY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBbIuWFs+mXrSIsICLmipPmi40iXSwgdWkuYWN0aW9uLCB7CgkJCSLmipPmi40iOiBmdW5jdGlvbihldmVudCkgewoJCQkJdmFyIGNhbnZhcyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLmNhcHR1cmUsIFt7dHlwZTogImNhbnZhcyIsIHdpZHRoOiB1aS52aWRlby5vZmZzZXRXaWR0aCwgaGVpZ2h0OiB1aS52aWRlby5vZmZzZXRIZWlnaHR9XSkuZmlyc3QKCQkJCWNhbnZhcy5nZXRDb250ZXh0KCIyZCIpLmRyYXdJbWFnZSh1aS52aWRlbywgMCwgMCkKCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLmNhcHR1cmUsIFt7aW1nOiBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKSwgc3R5bGU6IHt3aWR0aDogdWkudmlkZW8ub2Zmc2V0V2lkdGgsIGhlaWdodDogdWkudmlkZW8ub2Zmc2V0SGVpZ2h0fX1dKQoJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FudmFzKQoJCQl9LAoJCQki5YWz6ZetIjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5jb3JlLkxpc3QodWkuc3RyZWFtLmdldFRyYWNrcygpLCBmdW5jdGlvbih0cmFjaykgeyB0cmFjay5zdG9wKCkgfSkKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLmFjdGlvbikKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLnZpZGVvKQoJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdWkuY2FwdHVyZSkKCQkJfSwKCQl9KQoJfSwKCglhY3Rpb25zOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX2FjdGlvbikgfSwKCWNsZWFyOiBmdW5jdGlvbihldmVudCwgY2FuLCBuYW1lKSB7IGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fb3V0cHV0KSB9LAoJY2xvc2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLl90YXJnZXQpIH0sCgl1cGxvYWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnVzZXIudXBsb2FkKGV2ZW50LCBjYW4pIH0sCgljaGFuZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG5hbWUsIHZhbHVlLCBjYikgewoJCXJldHVybiBjYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgY2FuLl9vcHRpb24sICIiLCBmdW5jdGlvbihpbnB1dCkgewoJCQlpZiAoaW5wdXQubmFtZSA9PSBuYW1lICYmIHZhbHVlICE9IGlucHV0LnZhbHVlKSB7IGlucHV0LnZhbHVlID0gdmFsdWUKCQkJCXZhciBkYXRhID0gaW5wdXQuZGF0YXNldHx8e307IGNhbi5VcGRhdGUoZXZlbnQsIGNhbi5JbnB1dCgpLCBjYikKCQkJCXJldHVybiBpbnB1dAoJCQl9CgkJfSkKCX0sCgoJbmV4dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5VcGRhdGUoZXZlbnQsIFtjdHguQUNUSU9OLCAibmV4dCIsIGNhbi5TdGF0dXMoInRvdGFsIil8fDAsIGNhbi5PcHRpb24oImxpbWl0Iil8fGNhbi5BY3Rpb24oImxpbWl0Iil8fCIiLCBjYW4uT3B0aW9uKCJvZmZlbmQiKXx8Y2FuLkFjdGlvbigib2ZmZW5kIil8fCIiXSkKCX0sCglwcmV2OiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLlVwZGF0ZShldmVudCwgW2N0eC5BQ1RJT04sICJwcmV2IiwgY2FuLlN0YXR1cygidG90YWwiKXx8MCwgY2FuLk9wdGlvbigibGltaXQiKXx8Y2FuLkFjdGlvbigibGltaXQiKXx8IiIsIGNhbi5PcHRpb24oIm9mZmVuZCIpfHxjYW4uQWN0aW9uKCJvZmZlbmQiKXx8IiJdKQoJfSwKCglnZXRDbGlwYm9hcmREYXRhOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQlmdW5jdGlvbiBhZGQodGV4dCkgewoJCQljYW4ucnVuKGV2ZW50LCBjYW4uYmFzZS5TaW1wbGUoY3R4LkFDVElPTiwgYnV0dG9uLCBjYW4uYmFzZS5QYXJzZUpTT04odGV4dCkpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pLCBjYW4uVXBkYXRlKCkKCQkJfSwgdHJ1ZSkKCQl9CgkJaWYgKG5hdmlnYXRvci5jbGlwYm9hcmQpIHsKCQkJbmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpLnRoZW4oYWRkKS5jYXRjaChmdW5jdGlvbihlcnIpIHsgY2FuLm1pc2MuTG9nKGVycikgfSkKCQl9IGVsc2UgewoJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe3R5cGU6IGh0bWwuVEVYVEFSRUEsIG5hbWU6IG1kYi5URVhUfV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsgYWRkKGxpc3RbMF0pIH0pCgkJfQoJfSwKCWdldExvY2F0aW9uOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQljYW4udXNlci5hZ2VudC5nZXRMb2NhdGlvbihmdW5jdGlvbihkYXRhKSB7IGNhbi5yZXF1ZXN0KGV2ZW50LCBkYXRhKQoJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbWRiLlRZUEUsIG1kYi5OQU1FLCBtZGIuVEVYVCwgImxhdGl0dWRlIiwgImxvbmdpdHVkZSJdLCBmdW5jdGlvbihldiwgYnUsIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBidXR0b25dLmNvbmNhdChjYW4uYmFzZS5TaW1wbGUoYXJncywgZGF0YSkpLCBmdW5jdGlvbihtc2cpIHsKCQkJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSwgY2FuLlVwZGF0ZSgpCgkJCQl9LCB0cnVlKQoJCQl9KQoJCX0pCgl9LAoJb3BlbkxvY2F0aW9uOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi51c2VyLmFnZW50Lm9wZW5Mb2NhdGlvbihjYW4ucmVxdWVzdChldmVudCkpIH0sCgp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9zdG9yeS90cmVuZC5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMCkgeyByZXR1cm4gfQoJCWlmIChtc2cuT3B0aW9uKCJicmFuY2giKSkgeyByZXR1cm4gY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKSB9CgoJCWNhbi5vbmFwcGVuZC5fc3RhdHVzKGNhbiwgWyJmcm9tIiwgImNvbW1pdCIsICJ0b3RhbCIsICJtYXgiLCAiZGF0ZSIsICJ0ZXh0IiwgImFkZCIsICJkZWwiXSkKCQljYW4uZGF0YSA9IG1zZy5UYWJsZSgpLCBjYW4ub25pbXBvcnQuX3N1bShjYW4pCgkJY2FuLkFjdGlvbihodG1sLkhFSUdIVCwgbXNnLk9wdGlvbihodG1sLkhFSUdIVCl8fGljZS5BVVRPKQoJCWNhbi5BY3Rpb24oInNwZWVkIiwgcGFyc2VJbnQobXNnLk9wdGlvbigic3BlZWQiKXx8IjEwMCIpKQoKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgkJY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy5qcyIsICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9wYXRoLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJkcmF3IikKCQkJY2FuLm9uaW1wb3J0Ll9zaG93KGNhbiwgbXNnKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4ub25hY3Rpb25bY2FuLkFjdGlvbihpY2UuVklFVyldKGV2ZW50LCBjYW4pCgkJfSkKCX0sCglfc3VtOiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgYmVnaW4gPSAiIiwgY291bnQgPSAwLCByZXN0ID0gMCwgYWRkID0gMCwgZGVsID0gMCwgbWF4ID0gMAoJCWNhbi5tYXggPSAwLCBjYW4ubWluID0gMCwgY2FuLmxpc3QgPSBjYW4uY29yZS5MaXN0KGNhbi5kYXRhLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsKCQkJdmFyIGxpbmUgPSB7CgkJCQlkYXRlOiB2YWx1ZVtjYW4uX21zZy5hcHBlbmRbMF1dLAoJCQkJdGV4dDogdmFsdWVbY2FuLl9tc2cuYXBwZW5kWzRdXSwKCQkJCWFkZDogcGFyc2VJbnQodmFsdWVbY2FuLl9tc2cuYXBwZW5kWzFdXSksCgkJCQlkZWw6IHBhcnNlSW50KHZhbHVlW2Nhbi5fbXNnLmFwcGVuZFsyXV0pLAoJCQl9CgoJCQlsaW5lLmJlZ2luID0gcmVzdAoJCQlsaW5lLm1heCA9IHJlc3QgKyBsaW5lLmFkZAoJCQlsaW5lLm1pbiA9IHJlc3QgLSBsaW5lLmRlbAoJCQlsaW5lLmNsb3NlID0gcmVzdCArIGxpbmUuYWRkIC0gbGluZS5kZWwKCgkJCWJlZ2luID0gYmVnaW4gfHwgdmFsdWUuZGF0ZSwgY291bnQrKwoJCQlyZXN0ID0gbGluZS5jbG9zZSwgYWRkICs9IGxpbmUuYWRkLCBkZWwgKz0gbGluZS5kZWwKCgkJCWlmIChsaW5lLm1heCAtIGxpbmUubWluID4gbWF4KSB7IG1heCA9IGxpbmUubWF4IC0gbGluZS5taW4gfQoJCQlpZiAobGluZS5tYXggPiBjYW4ubWF4KSB7IGNhbi5tYXggPSBsaW5lLm1heCB9CgkJCWlmIChsaW5lLm1pbiA8IGNhbi5taW4pIHsgY2FuLm1pbiA9IGxpbmUubWluIH0KCQkJcmV0dXJuIGxpbmUKCQl9KQoJCWNhbi5TdGF0dXMoeyJmcm9tIjogYmVnaW4sICJjb21taXQiOiBjb3VudCwgInRvdGFsIjogYWRkK2RlbCwgIm1heCI6IG1heH0pCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFsiZWRpdCIsIFtpY2UuVklFVywgIui2i+WKv+WbviIsICLmn7Hnirblm74iLCAi5pWw5o2u5rqQIl0sIFsiaGVpZ2h0IiwgIjEwMCIsICIyMDAiLCAiNDAwIiwgIjYwMCIsICI4MDAiLCAiYXV0byJdLCBbInNwZWVkIiwgIjEwIiwgIjIwIiwgIjUwIiwgIjEwMCJdXSwKCSJlZGl0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLl9hY3Rpb24pLCBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLl9zdGF0dXMpIH0sCgoJIui2i+WKv+WbviI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIGhlaWdodCA9IGNhbi5BY3Rpb24oaHRtbC5IRUlHSFQpCgkJaWYgKGhlaWdodCA9PSBpY2UuQVVUTykgeyBoZWlnaHQgPSBjYW4uQ29uZihodG1sLkhFSUdIVCkgfQoJCWhlaWdodCA9IHBhcnNlSW50KGhlaWdodCkKCgkJdmFyIHNwYWNlID0gMTAsIHdpZHRoID0gcGFyc2VJbnQoY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkJdmFyIHN0ZXAgPSBwYXJzZUludCgod2lkdGgtMipzcGFjZSkgLyBjYW4ubGlzdC5sZW5ndGgpCgoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGhlaWdodCkKCQljYW4uc3ZnLlZhbChodG1sLldJRFRILCB3aWR0aCkKCgkJZnVuY3Rpb24gc2NhbGUoeSkgeyByZXR1cm4gKHkgLSBjYW4ubWluKS8oY2FuLm1heCAtIGNhbi5taW4pKihoZWlnaHQtMipzcGFjZSkgfQoJCWZ1bmN0aW9uIG9yZGVyKGluZGV4LCB4LCB5KSB7IHJldHVybiB7eDogc3BhY2Urc3RlcCppbmRleCt4LCB5OiBoZWlnaHQtc3BhY2Utc2NhbGUoeSl9IH0KCgkJY2FuLmNvcmUuTmV4dChjYW4ubGlzdCwgZnVuY3Rpb24obGluZSwgbmV4dCwgaW5kZXgpIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwgewoJCQkJc2hhcGU6IHN2Zy5MSU5FLCBwb2ludDogWwoJCQkJCW9yZGVyKGluZGV4LCBzdGVwLzIsIGxpbmUubWluKSwgb3JkZXIoaW5kZXgsIHN0ZXAvMiwgbGluZS5tYXgpLAoJCQkJXSwgc3R5bGU6IGtpdC5EaWN0KGh0bWwuU1RST0tFX1dJRFRILCAxLCBodG1sLlNUUk9LRSwgbGluZS5iZWdpbiA8IGxpbmUuY2xvc2U/IGNoYXQuV0hJVEU6IGNoYXQuQkxBQ0spLAoJCQl9KQoKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwgewoJCQkJc2hhcGU6IHN2Zy5SRUNULCBwb2ludDogWwoJCQkJCW9yZGVyKGluZGV4LCBzdGVwLzQsIGxpbmUuY2xvc2UpLCBvcmRlcihpbmRleCwgc3RlcC80KjMsIGxpbmUuYmVnaW4pLAoJCQkJXSwgc3R5bGU6IGNhbi5iYXNlLkNvcHkoa2l0LkRpY3QoaHRtbC5TVFJPS0VfV0lEVEgsIDEsIHN2Zy5SWCwgMCwgc3ZnLlJZLCAwKSwgbGluZS5iZWdpbiA8IGxpbmUuY2xvc2U/CgkJCQkJa2l0LkRpY3QoaHRtbC5TVFJPS0UsIGNoYXQuV0hJVEUsIGh0bWwuRklMTCwgY2hhdC5XSElURSk6IGtpdC5EaWN0KGh0bWwuU1RST0tFLCBjaGF0LkJMQUNLLCBodG1sLkZJTEwsIGNoYXQuQkxBQ0spCgkJCQkpLAoJCQkJX2luaXQ6IGZ1bmN0aW9uKHZpZXcpIHsKCQkJCQljYW4uY29yZS5JdGVtQ0IoY2FuLm9uZGV0YWlsLCBmdW5jdGlvbihrZXksIGNiKSB7IHZpZXdba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCBjYW4sIGxpbmUpIH0gfSkKCQkJCX0sCgkJCX0pCgoJCQljYW4uU3RhdHVzKGxpbmUsIFsiZGF0ZSIsICJ0ZXh0IiwgImFkZCIsICJkZWwiXSkKCQkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQoY2FuLkFjdGlvbigic3BlZWQiKSksIG5leHQpCgkJfSkKCX0sCgki5p+x54q25Zu+IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBtYXggPSB7fSwgbWluID0ge30KCQljYW4uY29yZS5MaXN0KGNhbi5fbXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCB3aGljaCkgewoJCQljYW4uY29yZS5MaXN0KGNhbi5kYXRhLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsKCQkJCXZhciB2ID0gcGFyc2VJbnQodmFsdWVba2V5XSl8fDA7IGlmIChpbmRleCA9PSAwKSB7CgkJCQkJbWF4W2tleV0gPSB2LCBtaW5ba2V5XSA9IHYKCQkJCQlyZXR1cm4KCQkJCX0KCQkJCWlmICh2ID4gbWF4W2tleV0pIHsgbWF4W2tleV0gPSB2IH0KCQkJCWlmICh2IDwgbWluW2tleV0pIHsgbWluW2tleV0gPSB2IH0KCQkJfSkKCQl9KQoKCQl2YXIgaGVpZ2h0ID0gcGFyc2VJbnQoY2FuLkFjdGlvbihodG1sLkhFSUdIVCkpCgkJdmFyIHNwYWNlID0gMTAsIHdpZHRoID0gcGFyc2VJbnQoY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkJdmFyIHN0ZXAgPSBwYXJzZUludCgod2lkdGgtMipzcGFjZSkgLyBjYW4ubGlzdC5sZW5ndGgpCgoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGhlaWdodCkKCQljYW4uc3ZnLlZhbChodG1sLldJRFRILCB3aWR0aCkKCgkJZnVuY3Rpb24gc2NhbGUoa2V5LCB5KSB7IHJldHVybiAoeSAtIG1pbltrZXldKS8obWF4W2tleV0gLSBtaW5ba2V5XSkqKGhlaWdodC0yKnNwYWNlKSB9CgkJZnVuY3Rpb24gb3JkZXIoaW5kZXgsIGtleSwgeCwgeSkgeyByZXR1cm4ge3g6IHNwYWNlK3N0ZXAqaW5kZXgreCwgeTogc3BhY2Urc2NhbGUoa2V5LCB5KX0gfQoKCQl2YXIgd2lkdGggPSAoc3RlcC00KS9jYW4uX21zZy5hcHBlbmQubGVuZ3RoCgkJY2FuLmNvcmUuTGlzdChjYW4uX21zZy5hcHBlbmQsIGZ1bmN0aW9uKGtleSwgd2hpY2gpIHsKCQkJbWF4W2tleV0gIT0gbWluW2tleV0gJiYgY2FuLmNvcmUuTmV4dChjYW4uZGF0YSwgZnVuY3Rpb24obGluZSwgbmV4dCwgaW5kZXgpIHsKCQkJCXZhciB5ID0gc2NhbGUoa2V5LCBwYXJzZUZsb2F0KGxpbmVba2V5XSkpCgkJCQl5ICYmIGNhbi5vbmltcG9ydC5kcmF3KHt9LCBjYW4sIHsKCQkJCQlzaGFwZTogc3ZnLlJFQ1QsIHBvaW50OiBbCgkJCQkJCW9yZGVyKGluZGV4LCBrZXksIHdpZHRoKndoaWNoKzIsIDApLCBvcmRlcihpbmRleCwga2V5LCB3aWR0aCp3aGljaCsyK3dpZHRoLCB5KSwKCQkJCQldLCBzdHlsZToga2l0LkRpY3QoaHRtbC5TVFJPS0VfV0lEVEgsIDEsIGh0bWwuU1RST0tFLCBjbGkuV0hJVEUsIGh0bWwuRklMTCwgY2xpLldISVRFLCBzdmcuUlgsIDAsIHN2Zy5SWSwgMCksCgkJCQkJX2luaXQ6IGZ1bmN0aW9uKHZpZXcpIHsKCQkJCQkJY2FuLmNvcmUuSXRlbUNCKGNhbi5vbmRldGFpbCwgZnVuY3Rpb24oa2V5LCBjYikgeyB2aWV3W2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgY2FuLCBsaW5lKSB9IH0pCgkJCQkJfSwKCQkJCX0pCgoJCQkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQoY2FuLkFjdGlvbigic3BlZWQiKSksIG5leHQpCgkJCX0pCgkJfSkKCX0sCgki5pWw5o2u5rqQIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIGNhbi5fbXNnLCBudWxsLCBjYW4udWkuZGlzcGxheSkKCQljYW4ub25tb3Rpb24uc2hvdyhjYW4sIGNhbi51aS5kaXNwbGF5KQoJfSwKCgloZWlnaHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uW2Nhbi5BY3Rpb24oaWNlLlZJRVcpXShldmVudCwgY2FuKSB9LAoJc3BlZWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uW2Nhbi5BY3Rpb24oaWNlLlZJRVcpXShldmVudCwgY2FuKSB9LAp9KQpWb2xjYW5vcygib25kZXRhaWwiLCB7aGVscDogIueUqOaIt+S6pOS6kiIsIGxpc3Q6IFtdLAoJb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCBsaW5lKSB7IGNhbi5TdGF0dXMobGluZSwgWyJkYXRlIiwgInRleHQiLCAiYWRkIiwgImRlbCJdKSB9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9zdG9yeS9zcGlkZS5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMCkgeyByZXR1cm4gfQoKCQljYW4uX2FyZ3MgPSBjYW4uYmFzZS5Db3B5KHtyb290OiAiaWNlIiwgZmllbGQ6IG1zZy5hcHBlbmRbMF0sIHNwbGl0OiBpY2UuUFN9LCBjYW4uYmFzZS5QYXJzZVVSTChjYW4uX2Rpc3BsYXkpKQoJCWNhbi5kaXJfcm9vdCA9IG1zZy5PcHRpb24obmZzLkRJUl9ST09UKXx8Y2FuLl9hcmdzLnJvb3R8fCIiCgkJY2FuLl90cmVlID0gY2FuLm9uaW1wb3J0Ll90cmVlKGNhbiwgbXNnLlRhYmxlKCksIGNhbi5fYXJncy5maWVsZCwgY2FuLl9hcmdzLnNwbGl0KQoJCWlmICghY2FuLl90cmVlWyIiXSkgeyByZXR1cm4gfSBjYW4uX3RyZWVbIiJdLm5hbWUgPSBjYW4uX2FyZ3Mucm9vdAoKCQljYW4uc2l6ZSA9IDMwLCBjYW4ubWFyZ2luID0gMzAKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgkJY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy5qcyIsICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9wYXRoLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJkcmF3IikKCQkJY2FuLm9uaW1wb3J0Ll9zaG93KGNhbiwgbXNnKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQl2YXIgcCA9IGNhbi5BY3Rpb24oaWNlLlZJRVcsIGNhbi5zdXAudmlld3x8Y2FuLkFjdGlvbihpY2UuVklFVykpCgkJCWNhbi5vbmFjdGlvbltwXShldmVudCwgY2FuLCBwKQoJCX0pCgl9LAoKCV90cmVlOiBmdW5jdGlvbihjYW4sIGxpc3QsIGZpZWxkLCBzcGxpdCkgewoJCXZhciBub2RlID0ge307IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpZiAoIWl0ZW1bZmllbGRdKSB7IHJldHVybiB9CgkJCWNhbi5jb3JlLkxpc3QoY2FuLmJhc2UudHJpbVByZWZpeChpdGVtW2ZpZWxkXSwgY2FuLmRpcl9yb290K2Nhbi5fYXJncy5zcGxpdCkuc3BsaXQoc3BsaXQpLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGFycmF5KSB7CgkJCQl2YXIgbGFzdCA9IGFycmF5LnNsaWNlKDAsIGluZGV4KS5qb2luKHNwbGl0KXx8IiIsIG5hbWUgPSBhcnJheS5zbGljZSgwLCBpbmRleCsxKS5qb2luKHNwbGl0KQoJCQkJaWYgKCF2YWx1ZSB8fCBub2RlW25hbWVdKSB7IHJldHVybiB9CgoJCQkJbm9kZVtsYXN0XSA9IG5vZGVbbGFzdF18fHtuYW1lOiBsYXN0LCBtZXRhOiB7fSwgbGlzdDogW119CgkJCQlub2RlW2xhc3RdLmxpc3QucHVzaChub2RlW25hbWVdID0gewoJCQkJCW5hbWU6IHZhbHVlKyhpbmRleD09YXJyYXkubGVuZ3RoLTE/ICIiOiBzcGxpdCksCgkJCQkJbWV0YTogaXRlbSwgbGlzdDogW10sIGxhc3Q6IG5vZGVbbGFzdF0sCgkJCQkJZmlsZTogaXRlbVtmaWVsZF18fGl0ZW0uZmlsZSwgaGlkZTogdHJ1ZSwKCQkJCX0pCgkJCX0pCgkJfSkKCQlyZXR1cm4gbm9kZQoJfSwKCV9oZWlnaHQ6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgZGVlcCkgeyBpZiAoIXRyZWUpIHsgcmV0dXJuIDAgfQoJCXRyZWUuZGVlcCA9IGRlZXB8fDAKCQlpZiAodHJlZS5saXN0Lmxlbmd0aCA9PSAwIHx8IHRyZWUuaGlkZSkgeyByZXR1cm4gdHJlZS5oZWlnaHQgPSAxIH0KCgkJdmFyIGhlaWdodCA9IDA7IGNhbi5jb3JlLkxpc3QodHJlZS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCWhlaWdodCArPSBjYW4ub25pbXBvcnQuX2hlaWdodChjYW4sIGl0ZW0sIChkZWVwfHwwKSsxKQoJCX0pCgkJcmV0dXJuIHRyZWUuaGVpZ2h0ID0gaGVpZ2h0Cgl9LAoJX3dpZHRoOiBmdW5jdGlvbihjYW4sIHRyZWUsIGRlZXApIHsgaWYgKCF0cmVlKSB7IHJldHVybiAwIH0KCQl0cmVlLmRlZXAgPSBkZWVwfHwwCgkJaWYgKHRyZWUubGlzdC5sZW5ndGggPT0gMCB8fCB0cmVlLmhpZGUpIHsKCQkJdHJlZS52aWV3ID0gY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBodG1sLlRFWFQsIHBvaW50OiBbe3g6IDAsIHk6IDB9XSwgc3R5bGU6IHtpbm5lcjogdHJlZS5uYW1lfX0pCgkJCXJldHVybiB0cmVlLndpZHRoID0gdHJlZS52aWV3LlZhbCgidGV4dExlbmd0aCIpK2Nhbi5tYXJnaW4KCQl9CgoJCXZhciB3aWR0aCA9IDA7IGNhbi5jb3JlLkxpc3QodHJlZS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCXdpZHRoICs9IGNhbi5vbmltcG9ydC5fd2lkdGgoY2FuLCBpdGVtLCAoZGVlcHx8MCkrMSkKCQl9KQoJCXJldHVybiB0cmVlLndpZHRoID0gd2lkdGgKCX0sCglfY29sb3I6IGZ1bmN0aW9uKGNhbiwgdHJlZSkgewoJCXJldHVybiB0cmVlLm1ldGEmJnRyZWUubWV0YS5jb2xvciB8fCAodHJlZS5saXN0ID09IDA/IGNsaS5QVVJQTEU6IGNsaS5ZRUxMT1cpCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIueUqOaIt+aTjeS9nCIsIGxpc3Q6IFsiZWRpdCIsIFtpY2UuVklFVywgIuaoquWQkSIsICLnurXlkJEiXSwgIueUn+aIkOWbvueJhyJdLAoJImVkaXQiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX2FjdGlvbiksIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX3N0YXR1cykgfSwKCgki5qiq5ZCRIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbmltcG9ydC5faGVpZ2h0KGNhbiwgY2FuLl90cmVlWyIiXSkKCQljYW4uc3VwLnZpZXcgPSAi5qiq5ZCRIiwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZykKCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGNhbi5fdHJlZVsiIl0uaGVpZ2h0KmNhbi5zaXplKzIqY2FuLm1hcmdpbikKCQljYW4ud2lkdGggPSAwLCBjYW4ub25hY3Rpb24uX2RyYXdfaG9yaXpvbnRhbChjYW4sIGNhbi5fdHJlZVsiIl0sIGNhbi5tYXJnaW4sIGNhbi5tYXJnaW4pCgkJY2FuLnN2Zy5WYWwoaHRtbC5XSURUSCwgY2FuLndpZHRoK2Nhbi5tYXJnaW4pCgl9LAoJIue6teWQkSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25pbXBvcnQuX3dpZHRoKGNhbiwgY2FuLl90cmVlWyIiXSkKCQljYW4uc3VwLnZpZXcgPSAi57q15ZCRIiwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZykKCgkJY2FuLnN2Zy5WYWwoaHRtbC5XSURUSCwgY2FuLl90cmVlWyIiXS53aWR0aCsyKmNhbi5tYXJnaW4pCgkJY2FuLmhlaWdodCA9IDAsIGNhbi5vbmFjdGlvbi5fZHJhd192ZXJ0aWNhbChjYW4sIGNhbi5fdHJlZVsiIl0sIGNhbi5tYXJnaW4sIGNhbi5tYXJnaW4rY2FuLnNpemUpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGNhbi5oZWlnaHQrY2FuLm1hcmdpbikKCX0sCgki55Sf5oiQ5Zu+54mHIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi50b2ltYWdlKGV2ZW50LCBjYW4sIGNhbi5fbGVnZW5kLmlubmVyVGV4dCwgY2FuLl9vdXRwdXQpCgl9LAoJX2RyYXc6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgeCwgeSwgc3R5bGUpIHsKCQl2YXIgY29sb3IgPSBjYW4ub25pbXBvcnQuX2NvbG9yKGNhbiwgdHJlZSkKCQl0cmVlLnZpZXcgPSBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7CgkJCXNoYXBlOiBodG1sLlRFWFQsIHBvaW50OiBbe3g6IHgsIHk6IHl9XSwgc3R5bGU6IGNhbi5iYXNlLkNvcHkoewoJCQkJc3Ryb2tlOiBjb2xvciwgZmlsbDogY29sb3IsICJ0ZXh0LWFuY2hvciI6ICJzdGFydCIsIGlubmVyOiB0cmVlLm5hbWV8fHRyZWUuZmlsZSwKCQkJfSwgc3R5bGUpLAoJCX0pLCBjYW4uY29yZS5JdGVtQ0IoY2FuLm9uZGV0YWlsLCB0cmVlLnZpZXcsIGNhbiwgdHJlZSkKCX0sCglfZHJhd192ZXJ0aWNhbDogZnVuY3Rpb24oY2FuLCB0cmVlLCB4LCB5KSB7IHRyZWUueCA9IHgsIHRyZWUueSA9IHkKCQljYW4ub25hY3Rpb24uX2RyYXcoY2FuLCB0cmVlLCB4K3RyZWUud2lkdGgvMiwgeSwgeyJ0ZXh0LWFuY2hvciI6ICJtaWRkbGUifSkKCgkJdHJlZS5oZWlnaHQgPSBjYW4uc2l6ZQoJCWlmICh5K3RyZWUuaGVpZ2h0ID4gY2FuLmhlaWdodCkgeyBjYW4uaGVpZ2h0ID0geSt0cmVlLmhlaWdodCB9CgkJaWYgKHRyZWUuaGlkZSkgeyByZXR1cm4gfQoKCQl2YXIgb2Zmc2V0ID0gMDsgY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBzdmcuUEFUSDJWLCBwb2ludDogWwoJCQkJe3g6IHgrdHJlZS53aWR0aC8yLCB5OiB5K3RyZWUuaGVpZ2h0LWNhbi5tYXJnaW4vMn0sCgkJCQl7eDogeCtvZmZzZXQraXRlbS53aWR0aC8yLCB5OiB5K3RyZWUuaGVpZ2h0K2Nhbi5tYXJnaW4vMn0sCgkJCV0sIHN0eWxlOiB7c3Ryb2tlOiBjbGkuQ1lBTn19KQoKCQkJY2FuLm9uYWN0aW9uLl9kcmF3X3ZlcnRpY2FsKGNhbiwgaXRlbSwgeCtvZmZzZXQsIHkrdHJlZS5oZWlnaHQrY2FuLm1hcmdpbikKCQkJb2Zmc2V0ICs9IGl0ZW0ud2lkdGgKCQl9KQoJfSwKCV9kcmF3X2hvcml6b250YWw6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgeCwgeSkgeyB0cmVlLnggPSB4LCB0cmVlLnkgPSB5CgkJY2FuLm9uYWN0aW9uLl9kcmF3KGNhbiwgdHJlZSwgeCwgeSt0cmVlLmhlaWdodCpjYW4uc2l6ZS8yLCB7InRleHQtYW5jaG9yIjogInN0YXJ0In0pCgoJCXRyZWUud2lkdGggPSB0cmVlLnZpZXcuVmFsKCJ0ZXh0TGVuZ3RoIil8fCh0cmVlLm5hbWV8fCIiKS5sZW5ndGgqMTAKCQlpZiAoeCt0cmVlLndpZHRoID4gY2FuLndpZHRoKSB7IGNhbi53aWR0aCA9IHgrdHJlZS53aWR0aCB9CgkJaWYgKHRyZWUuaGlkZSkgeyByZXR1cm4gfQoKCQl2YXIgb2Zmc2V0ID0gMDsgY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBzdmcuUEFUSDJILCBwb2ludDogWwoJCQkJe3g6IHgrdHJlZS53aWR0aCtjYW4ubWFyZ2luLzgsIHk6IHkrdHJlZS5oZWlnaHQqY2FuLnNpemUvMn0sCgkJCQl7eDogeCt0cmVlLndpZHRoK2Nhbi5tYXJnaW4qMi0yKmNhbi5tYXJnaW4vOCwgeTogeStvZmZzZXQraXRlbS5oZWlnaHQqY2FuLnNpemUvMn0KCQkJXSwgc3R5bGU6IHtzdHJva2U6IGNsaS5DWUFOfX0pCgoJCQljYW4ub25hY3Rpb24uX2RyYXdfaG9yaXpvbnRhbChjYW4sIGl0ZW0sIHgrdHJlZS53aWR0aCsyKmNhbi5tYXJnaW4sIHkrb2Zmc2V0KQoJCQlvZmZzZXQgKz0gaXRlbS5oZWlnaHQqY2FuLnNpemUKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLnlKjmiLfkuqTkupIiLCBsaXN0OiBbXSwKCW9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdHJlZSkgeyB2YXIgeSA9IHRyZWUueSt0cmVlLmhlaWdodCpjYW4uc2l6ZS8yCgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLnBvcyksIGNhbi5wb3MgPSBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7CgkJCXNoYXBlOiBzdmcuUkVDVCwgcG9pbnQ6IFsKCQkJCXt4OiB0cmVlLngtY2FuLm1hcmdpbi80LCB5OiB5LWNhbi5zaXplLzJ9LAoJCQkJe3g6IHRyZWUueCt0cmVlLndpZHRoK2Nhbi5tYXJnaW4vOCwgeTogeStjYW4uc2l6ZS8yfSwKCQkJXSwgc3R5bGU6IHtzdHJva2U6IGNsaS5SRUQsIGZpbGw6IGh0bWwuTk9ORX0sCgkJfSksIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJfSwKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRyZWUpIHsKCQlpZiAodHJlZS5saXN0Lmxlbmd0aCA+IDAgfHwgdHJlZS50YWdzIHx8IHRyZWUubmFtZS5lbmRzV2l0aChjYW4uX2FyZ3Muc3BsaXQpKSB7CgkJCXJldHVybiB0cmVlLmhpZGUgPSAhdHJlZS5oaWRlLCBjYW4ub25hY3Rpb25bY2FuLkFjdGlvbihpY2UuVklFVyldKGV2ZW50LCBjYW4pCgkJfQoKCQlmb3IgKHZhciBub2RlID0gdHJlZTsgbm9kZTsgbm9kZSA9IG5vZGUubGFzdCkgewoJCQljYW4ucmVxdWVzdChldmVudCwgbm9kZS5tZXRhKQoJCX0KCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5PcHRpb24oKSkKCQljYW4ucnVuKGV2ZW50LCBjYW4uYmFzZS5PYmooY2FuLl9hcmdzLnByZWZpeCwgW10pLmNvbmNhdChbY2FuLk9wdGlvbigicmVwb3MiKXx8IiIsIHRyZWUuZmlsZXx8IiIsIHRyZWUubmFtZV0pLCBmdW5jdGlvbihtc2cpIHsKCQkJaWYgKG1zZy5MZW5ndGgoKSA9PSAwKSB7CgkJCQlyZXR1cm4gY2FuLm9uZGV0YWlsLnBsdWdpbihjYW4sIHRyZWUsIHt9LCAid2ViLmNvZGUuaW5uZXIiLCBbY2FuLmRpcl9yb290LCB0cmVlLmZpbGUsIHRyZWUubGluZV0sIFtjdHguQUNUSU9OLCAiaW5uZXIiXSkKCQkJfQoJCQlpZiAobXNnLkFwcGVuZChtZGIuSU5ERVgpKSB7IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSkgewoJCQkJY2FuLm9uZGV0YWlsLnBsdWdpbihjYW4sIHRyZWUsIHZhbHVlLCB2YWx1ZS5pbmRleCwgW10sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCB2YWx1ZS5pbmRleF0pCgkJCX0pOyByZXR1cm4gfQoKCQkJdHJlZS50YWdzID0gdHJ1ZQoJCQlpZiAobXNnLk9wdGlvbihsZXguU1BMSVQpKSB7CgkJCQl0cmVlLmxpc3QgPSBjYW4ub25pbXBvcnQuX3RyZWUoY2FuLCBtc2cuVGFibGUoKSwgbXNnLk9wdGlvbihtZGIuRklFTEQpfHxtc2cuYXBwZW5kWzBdLCBtc2cuT3B0aW9uKGxleC5TUExJVCkpWyIiXS5saXN0fHxbXQoJCQkJY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS5sYXN0ID0gdHJlZSB9KQoJCQl9IGVsc2UgewoJCQkJbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0pIHsgdHJlZS5saXN0LnB1c2goewoJCQkJCXR5cGU6ICJ0YWdzIiwgbmFtZTogaXRlbS5uYW1lfHxpdGVtLmZpbGV8fGl0ZW1bbXNnLmFwcGVuZFswXV0sCgkJCQkJbWV0YTogaXRlbSwgbGlzdDogW10sIGxhc3Q6IHRyZWUsCgkJCQkJZmlsZTogaXRlbS5maWxlLCBsaW5lOiBpdGVtLmxpbmUsIGhpZGU6IHRydWUsCgkJCQl9KSB9KQoJCQl9CgkJCXRyZWUuaGlkZSA9ICF0cmVlLmhpZGUsIGNhbi5vbmFjdGlvbltjYW4uQWN0aW9uKGljZS5WSUVXKV0oZXZlbnQsIGNhbikKCQl9LCB0cnVlKQoJfSwKCglwbHVnaW46IGZ1bmN0aW9uKGNhbiwgdHJlZSwgdmFsdWUsIGluZGV4LCBhcmdzLCBwcmVmaXgpIHsKCQlmb3IgKHZhciBub2RlID0gdHJlZTsgbm9kZTsgbm9kZSA9IG5vZGUubGFzdCkgewoJCQljYW4uYmFzZS5Db3B5KHZhbHVlLCBub2RlLm1ldGEpCgkJfQoJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBjYW4uYmFzZS5Db3B5KHt0eXBlOiBjaGF0LkZMT0FULCBpbmRleDogaW5kZXgsIGFyZ3M6IGFyZ3N9KSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgcHJlZml4LCBjbWRzKSwgY2IsIHRydWUpCgkJCX0sIGNhbi5vbmRldGFpbC5maWd1cmUoY2FuLCBzdWIpCgkJfSkKCX0sCglmaWd1cmU6IGZ1bmN0aW9uKGNhbiwgc3ViLCBtc2csIGNiKSB7CgkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KSB7IGxlZnQgPSBsZWZ0fHwwCgkJCXZhciB0b3AgPSAxMjA7IGlmIChjYW4udXNlci5pc01vYmlsZSkgeyB0b3AgPSBjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAwOiA0OCB9CgkJCXN1Yi5Db25mSGVpZ2h0KGhlaWdodC10b3AtaHRtbC5BQ1RJT05fSEVJR0hULShjYW4udXNlci5pc01vYmlsZSYmIWNhbi51c2VyLmlzTGFuZHNjYXBlKCk/IDIqaHRtbC5BQ1RJT05fSEVJR0hUOiAwKSksIHN1Yi5Db25mV2lkdGgod2lkdGgpCgoJCQljYW4ub25tb3Rpb24ubW92ZShjYW4sIHN1Yi5fdGFyZ2V0LCB7cG9zaXRpb246IGh0bWwuRklYRUQsIGxlZnQ6IGxlZnQsIHRvcDogdG9wfSkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgpCgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCX0pCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvd29yZC5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPiAwKSB7IHJldHVybiBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpIH0KCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCBtc2cuUmVzdWx0KCkpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCB3aWtpLklURU0sIGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGRhdGEgPSBpdGVtLmRhdGFzZXR8fHt9CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIHtzdHlsZTogY2FuLmJhc2UuT2JqKGRhdGEuc3R5bGUpfSkKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmltcG9ydCwgZGF0YS50eXBlXSwgW2NhbiwgZGF0YSwgaXRlbV0pCgkJCS8vIGNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwgaHRtbC5NQVhfV0lEVEgsIGNhbi5Db25mV2lkdGgoKS0oY2FuLnVzZXIuaXNXaW5kb3dzPyA0MDogMzApKQoJCX0pCgl9LAoJaW1hZ2U6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKS8yLCBodG1sLk1BWF9XSURUSCwgY2FuLkNvbmZXaWR0aCgpKQoKCQkvLyBpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJaWYgKGNhbi51c2VyLmlzTGFuZHNjYXBlKCkpIHsKCQkJfSBlbHNlewoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKSwgaHRtbC5NQVhfV0lEVEgsIGNhbi5Db25mV2lkdGgoKSkKCQkJfQoJCS8vIAlyZXR1cm4KCQkvLyB9CgkJLy8gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKS80KQoJfSwKCW5hdm1lbnU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IHZhciBuYXYgPSBjYW4uc3VwLl9uYXZtZW51CgkJbmF2ID0gbmF2fHxjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX2ZpZWxkcywgW3t2aWV3OiB3aWtpLk5BVk1FTlV9XSkuZmlyc3QKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBuYXYpLCBjYW4uX2ZpZWxkcy5pbnNlcnRCZWZvcmUobmF2LCBjYW4uX291dHB1dCkKCgkJY2FuLm9uYXBwZW5kLmxpc3QoY2FuLCBjYW4uYmFzZS5PYmooZGF0YS5kYXRhKSwgZnVuY3Rpb24oZXZlbnQsIGl0ZW0pIHsKCQkJdmFyIGxpbmsgPSBpdGVtLm1ldGEubGluaywgbGlzdCA9IGNhbi5jb3JlLlNwbGl0KGl0ZW0ubWV0YS5saW5rKQoJCQlpZiAoY2FuLmNvcmUuVmFsdWUoY2FuLCBsaXN0WzBdKSkgeyByZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoW2NhbiwgbGlzdFswXV0sIGxpc3Quc2xpY2UoMSkpIH0KCQkJaWYgKCFsaW5rIHx8IGxpbmsgPT0gY2FuLk9wdGlvbihuZnMuUEFUSCkpIHsgcmV0dXJuIGZhbHNlIH0KCgkJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsgY2FuLnVzZXIubW9kLmlzQ21kICYmIGNhbi51c2VyLnRpdGxlKGl0ZW0ubWV0YS5uYW1lKTsgcmV0dXJuIGNhbi5PcHRpb24obmZzLlBBVEgsIGxpbmspIH0pKSB7IHJldHVybiB9CgkJCXJldHVybiBjYW4uc3VwLlVwZGF0ZShldmVudCwgW2xpbmtdKQoJCX0sIG5hdiksIGNhbi5zdXAuX25hdm1lbnUgPSBuYXYKCgkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obXNnKSB7IAoJCQljYW4ucGFnZS5zdHlsZShjYW4sIG5hdiwgaHRtbC5IRUlHSFQsIGNhbi5Db25mKGh0bWwuSEVJR0hUKSsoY2FuLnVzZXIubW9kLmlzQ21kPyBtc2cuT3B0aW9uKGh0bWwuTUFSR0lOX1kpOiAwKSkKCQkJY2FuLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCktbmF2Lm9mZnNldFdpZHRoLShjYW4udXNlci5tb2QuaXNDbWQ/IDEwOiAyMCktMTApCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5fb3V0cHV0LCB7c3R5bGU6IGtpdC5EaWN0KAoJCQkJaHRtbC5IRUlHSFQsIGNhbi5zdXAuX25hdm1lbnUub2Zmc2V0SGVpZ2h0LCBodG1sLk1BWF9XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCksCgkJCQlodG1sLkZMT0FULCBodG1sLkxFRlQsIGh0bWwuQ0xFQVIsIGh0bWwuTk9ORQoJCQkpfSkKCQl9KQoJfSwKCXByZW1lbnU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIGNhbi5wYWdlLktleXMod2lraS5IMiwgd2lraS5IMyksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IFtpdGVtLmlubmVySFRNTCwgaHRtbC5MSSwgaXRlbS50YWdOYW1lXSwgb25jbGljazogZnVuY3Rpb24oKSB7CgkJCQlpdGVtLnNjcm9sbEludG9WaWV3KCkKCQkJfX1dKSwgaXRlbS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsgdGFyZ2V0LnNjcm9sbEludG9WaWV3KCkgfQoJCX0pCgl9LAoJdGl0bGU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnVzZXIubW9kLmlzQ21kICYmIHRhcmdldC50YWdOYW1lID09ICJIMSIgJiYgY2FuLnVzZXIudGl0bGUoZGF0YS50ZXh0KQoJfSwKCXJlZmVyOiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5BLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLkNSRUFURSwgbWRiLlRZUEUsICJyZWZlciIsIG1kYi5OQU1FLCBpdGVtLmRhdGFzZXQubmFtZSwgbWRiLlRFWFQsIGl0ZW0uaHJlZl0sIG51bGwsIHRydWUpCgkJCX0KCQl9KQoJfSwKCXNwYXJrOiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCWlmIChkYXRhW21kYi5OQU1FXSA9PSBjaGF0LkZJRUxEKSB7CgkJCWZ1bmN0aW9uIGRlZXAodGV4dCkgeyB2YXIgZCA9IDAKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykgewoJCQkJCXN3aXRjaCAodGV4dFtpXSkgewoJCQkJCQljYXNlICJcdCI6IGQgKz0gNDsgYnJlYWsKCQkJCQkJY2FzZSAiICI6IGQrKzsgYnJlYWsKCQkJCQkJZGVmYXVsdDogcmV0dXJuIGQKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gZAoJCQl9CgkJCXZhciBsaXN0ID0gW107IGNhbi5jb3JlLkxpc3QodGFyZ2V0LmlubmVyVGV4dC5zcGxpdChpY2UuTkwpLCBmdW5jdGlvbihsaW5lKSB7IHZhciBfZGVlcCA9IGRlZXAobGluZSkKCQkJCXdoaWxlIChsaXN0Lmxlbmd0aCA+IDApIHsgaWYgKF9kZWVwIDw9IGxpc3RbbGlzdC5sZW5ndGgtMV0uX2RlZXApIHsgbGlzdC5wb3AoKSB9IGVsc2UgeyBicmVhayB9IH0KCQkJCXZhciBscyA9IGNhbi5jb3JlLlNwbGl0KGxpbmUpLCBpdGVtID0ge19kZWVwOiBfZGVlcCwgbWV0YToge2luZGV4OiBsc1swXSwgbmFtZTogbHNbMV0sIGFyZ3M6IGxzLnNsaWNlKDIpfSwgbGlzdDogW119CgkJCQlpZiAobGlzdC5sZW5ndGggPiAwKSB7IGxpc3RbbGlzdC5sZW5ndGgtMV0ubGlzdC5wdXNoKGl0ZW0pIH0gbGlzdC5wdXNoKGl0ZW0pCgkJCX0pCgoJCQl2YXIgZmlyc3Q7IGZ1bmN0aW9uIHNob3coaXRlbSwgaW5kZXgsIHRhcmdldCwgb3V0cHV0KSB7CgkJCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIGl0ZW0ubWV0YS5uYW1lfHxpdGVtLm1ldGEuaW5kZXhdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWlmICh1aS5saXN0LmlubmVyVGV4dCkgeyByZXR1cm4gY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIHVpLmxpc3QpIH0KCQkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgdmlldy5tZW51LCBodG1sLkRJVl9JVEVNLCBldmVudC50YXJnZXQpCgkJCQkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gaW5kZXggfSwgb3V0cHV0KSkgeyByZXR1cm4gfQoJCQkJCWNhbi5jb3JlLkxpc3QoaXRlbS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBpdGVtLm1ldGEsIGZ1bmN0aW9uKHN1YikgewoJCQkJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYiwgc2lsZW50KSB7CgkJCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIGl0ZW0ubWV0YS5pbmRleF0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJCQkJCX0KCQkJCQkJCXN1Yi5Db25mV2lkdGgoaXRlbS5tZXRhLndpZHRoID0gY2FuLkNvbmZXaWR0aCgpLTE2NSkKCQkJCQkJCXN1Yi5Db25mSGVpZ2h0KGl0ZW0ubWV0YS5oZWlnaHQgPSBjYW4uQ29uZkhlaWdodCgpLTMwMCkKCQkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCktMipodG1sLlBMVUdJTl9NQVJHSU4pCgkJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fc3RhdHVzLCBodG1sLk1BWF9XSURUSCwgc3ViLkNvbmZXaWR0aCgpLTIqaHRtbC5QTFVHSU5fTUFSR0lOKQoJCQkJCQl9LCBvdXRwdXQpCgkJCQkJfSkKCQkJCX19LCB7dmlldzogaHRtbC5MSVNUfV0pCgkJCQljYW4uY29yZS5MaXN0KGl0ZW0ubGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLmxpc3QubGVuZ3RoID4gMCAmJiBzaG93KGl0ZW0sIGNhbi5jb3JlLktleXMoaW5kZXgsIGl0ZW0ubWV0YS5pbmRleCksIHVpLmxpc3QsIG91dHB1dCkgfSkKCQkJCXVpLmxpc3QuaW5uZXJUZXh0ID09ICIiICYmIChmaXJzdCA9IGZpcnN0fHx1aS5pdGVtKQoJCQl9CgoJCQl2YXIgdmlldyA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5NRU5VfSwge3ZpZXc6IGh0bWwuTElTVH1dKQoJCQlyZXR1cm4gc2hvdyhsaXN0WzBdLCBsaXN0WzBdLl9pbmRleCwgdmlldy5tZW51LCB2aWV3Lmxpc3QpLCBmaXJzdC5jbGljaygpCgkJfQoJCWlmIChkYXRhW21kYi5OQU1FXSA9PSBodG1sLklOTkVSKSB7IHJldHVybiBjYW4ub25tb3Rpb24uY29weShjYW4sIHRhcmdldCkgfQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5BLCBmdW5jdGlvbihpdGVtKSB7IGNhbi5vbm1vdGlvbi5saW5rKGNhbiwgaXRlbSkgfSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuU1BBTiwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ub25tb3Rpb24uY29weShjYW4sIGl0ZW0sICIiLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5DUkVBVEUsIG1kYi5UWVBFLCAic3BhcmsiLCBtZGIuTkFNRSwgInNoZWxsIiwgbWRiLlRFWFQsIGl0ZW0uaW5uZXJUZXh0XSwgbnVsbCwgdHJ1ZSkKCQkJfSkKCQl9KQoJfSwKCWNoYXJ0OiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCXRhcmdldC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnVzZXIuY2FydGVDbGllbnQoZXZlbnQsIGNhbiwga2l0LkRpY3QobWRiLkVYUE9SVCwgZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJCQljYW4ub25tb3Rpb24udG9pbWFnZShldmVudCwgY2FuLCAiaGkucG5nIiwgdGFyZ2V0KQoJCQl9KSwgW21kYi5FWFBPUlRdKQoJCX0KCX0sCgl0YWJsZTogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKCQljYW4ucGFnZS5PcmRlclRhYmxlKGNhbiwgdGFyZ2V0KSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgY2hhdC5DT05URU5UKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5URCwgZnVuY3Rpb24oaXRlbSkgeyBjYW4ub25tb3Rpb24uY29weShjYW4sIGl0ZW0pIH0pCgl9LAoJZmllbGQ6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0LCB3aWR0aCkgeyB2YXIgaXRlbSA9IGNhbi5iYXNlLk9iaihkYXRhLm1ldGEpCgkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgaXRlbSwgW2NoYXQuUExVR0lOX1NUQVRFX0pTXSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgewoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGNoYXQuU1RPUlksIGRhdGEudHlwZSwgZGF0YS5uYW1lLCBkYXRhLnRleHRdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQkJc3ViLkNvbmZIZWlnaHQoY2FuLkNvbmZIZWlnaHQoKSkKCQkJc3ViLkNvbmZXaWR0aChpdGVtLndpZHRoID0gKHdpZHRofHxjYW4uQ29uZldpZHRoKCkpLShjYW4udXNlci5pc1dpbmRvd3M/IDQwOiAyMCkpCgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCkpCgoJCQljYW4uY29yZS5WYWx1ZShpdGVtLCAiYXV0by5jbWQiKSAmJiBjYW4uY29yZS5UaW1lcjMwMG1zKGZ1bmN0aW9uKCkgewoJCQkJdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KHt9LCBjYW4uY29yZS5WYWx1ZShpdGVtLCAib3B0cyIpKTsgbXNnLk9wdGlvbihpY2UuTVNHX0hBTkRMRSwgaWNlLlRSVUUpCgkJCQlzdWIuVXBkYXRlKG1zZy5fZXZlbnQsIFtjdHguQUNUSU9OLCBjYW4uY29yZS5WYWx1ZShpdGVtLCAiYXV0by5jbWQiKV0pCgkJCX0pCgkJfSwgY2FuLl9vdXRwdXQsIHRhcmdldCkKCX0sCglpZnJhbWU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IHZhciBtZXRhID0gY2FuLmJhc2UuT2JqKGRhdGEubWV0YSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB0YXJnZXQsIHt3aWR0aDogY2FuLkNvbmYoaHRtbC5XSURUSCktMjAwfSkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbmtleW1hcCIsIHtoZWxwOiAi6ZSu55uY5Lqk5LqSIiwgbGlzdDogW10sCglfbW9kZTogewoJCW5vcm1hbDogewoJCQkibiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsLm5leHQoY2FuLnN1YikgfSwKCQkJImoiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbC5uZXh0KGNhbi5zdWIpIH0sCgkJCSJBcnJvd1JpZ2h0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25kZXRhaWwubmV4dChjYW4uc3ViKSB9LAoJCQkiQXJyb3dMZWZ0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25kZXRhaWwucHJldihjYW4uc3ViKSB9LAoJCQkiayI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsLnByZXYoY2FuLnN1YikgfSwKCQkJInAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbC5wcmV2KGNhbi5zdWIpIH0sCgoJCQkicSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsWyLnu5PmnZ8iXShldmVudCwgY2FuLnN1YikgfSwKCQkJImgiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbFsi6ZqQ6JePIl0oZXZlbnQsIGNhbi5zdWIpIH0sCgkJfSwKCX0sIF9lbmdpbmU6IHt9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaOp+S7tuS6pOS6kiIsIGxpc3Q6IFtdLAoJX3RyYW5zOiB7dmlldzogIuinhuWbviJ9LAoJcGxheTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbGlzdCA9IFtdLCBjdXJyZW50ID0gW10KCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgd2lraS5JVEVNLCBmdW5jdGlvbihpdGVtKSB7CgkJCXN3aXRjaCAoaXRlbS50YWdOYW1lKSB7CgkJCQljYXNlICJIMSI6CgkJCQljYXNlICJIMiI6CgkJCQljYXNlICJIMyI6CgkJCQkJbGlzdC5wdXNoKGN1cnJlbnQgPSBbXSkKCQkJCQlicmVhawoJCQl9CgkJCWN1cnJlbnQucHVzaChpdGVtKQoJCX0pCgoJCWNhbi5vbmFwcGVuZC5faW5pdChjYW4sIHt0eXBlOiAic3Rvcnkgd29yZCBmbG9hdCJ9LCBbXSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBjYW4ucnVuLCBzdWIuc3VwID0gY2FuLCBjYW4uc3ViID0gc3ViLCBjYW4ub25hcHBlbmQuX2FjdGlvbihzdWIsIFsKCQkJCVsi5biD5bGAIiwgIuW8gOiusiIsICLlv6vpl6oiLCAi572R5qC8Il0sICLlpKfnurIiLCAi6aaW6aG1IiwgIuS4iuS4gOmhtSIsCgkJCQlbIuiPnOWNlSJdLmNvbmNhdChjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIHBhZ2VbMF0uaW5uZXJIVE1MIH0pKSwKCQkJCSLkuIvkuIDpobUiLCAi6ZqQ6JePIiwgIue7k+adnyIsCgkJCV0sIHN1Yi5fYWN0aW9uLCBjYW4ub25kZXRhaWwpCgoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgImtleW1hcC5mb2N1cyIsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7Y2I6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ua2V5bGlzdCA9IGNhbi5vbmtleW1hcC5fcGFyc2UoZXZlbnQsIGNhbiwgIm5vcm1hbCIsIGNhbi5rZXlsaXN0KQoJCQl9fSkpLCBjYW4ub25rZXltYXAuX2J1aWxkKGNhbikKCgkJCXN1Yi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl90YXJnZXQsIGh0bWwuQkFDS0dST1VORCwgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLkhFSUdIVCwgd2luZG93LmlubmVySGVpZ2h0LTQqaHRtbC5QTFVHSU5fTUFSR0lOLTIqaHRtbC5BQ1RJT05fSEVJR0hUKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLldJRFRILCB3aW5kb3cuaW5uZXJXaWR0aC00Kmh0bWwuUExVR0lOX01BUkdJTikKCgkJCXN1Yi51aSA9IHN1Yi5wYWdlLkFwcGVuZChzdWIsIHN1Yi5fb3V0cHV0LCBbe3ZpZXc6IGNoYXQuUFJPSkVDVH0sIHt2aWV3OiBjaGF0LkNPTlRFTlR9XSkKCQkJY2FuLmNvcmUuTGlzdChzdWIubGlzdCA9IGxpc3QsIGZ1bmN0aW9uKHBhZ2UsIGluZGV4KSB7CgkJCQljYW4ub25hcHBlbmQuaXRlbShjYW4sIGh0bWwuSVRFTSwge25hbWU6IHBhZ2VbMF0uaW5uZXJIVE1MfSwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4ub25kZXRhaWwuc2hvdyhzdWIsIGluZGV4KSAKCQkJCX0sIGZ1bmN0aW9uKGV2ZW50KSB7fSwgc3ViLnVpLnByb2plY3QpCgoJCQkJc3ViLnBhZ2UuQXBwZW5kKHN1Yiwgc3ViLnVpLmNvbnRlbnQsIFt7dmlldzogInBhZ2UiKyhpbmRleD09MD8gIiBmaXJzdCI6ICIiKSwgbGlzdDogY2FuLmNvcmUuTGlzdChwYWdlLCBmdW5jdGlvbihpdGVtKSB7IHZhciBkYXRhID0gaXRlbS5kYXRhc2V0fHx7fQoJCQkJCXN3aXRjaCAoZGF0YS50eXBlKSB7CgkJCQkJCWNhc2Ugd2lraS5QUkVNRU5VOiBpdGVtID0gaXRlbS5jbG9uZU5vZGUoZmFsc2UpOyBicmVhawoJCQkJCQljYXNlIGNoYXQuRklFTEQ6IGl0ZW0gPSBjYW4ub25hcHBlbmQuZmllbGQoY2FuLCBjaGF0LlNUT1JZLCBjYW4uYmFzZS5PYmooZGF0YS5tZXRhKSwgc3ViLnVpLmNvbnRlbnQpLmZpcnN0OyBicmVhawoJCQkJCQlkZWZhdWx0OiBpdGVtID0gaXRlbS5jbG9uZU5vZGUodHJ1ZSkKCQkJCQl9CgkJCQkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25pbXBvcnQsIGRhdGEudHlwZV0sIFtzdWIsIGRhdGEsIGl0ZW0sIHdpbmRvdy5pbm5lcldpZHRoLTQqaHRtbC5QTFVHSU5fTUFSR0lOXSksIGl0ZW0KCQkJCX0pLCB9XSkKCQkJfSksIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBzdWIudWkucHJvamVjdCksIGNhbi5vbmRldGFpbC5zaG93KHN1YiwgMCkgCgoJCQlzdWIub25hcHBlbmQuX3N0YXR1cyhzdWIsIFttZGIuUEFHRSwgY2xpLkZST00sIGNsaS5DT1NUXSksIHN1Yi5TdGF0dXMoY2xpLkZST00sIGNhbi5iYXNlLlRpbWUoKSkKCQkJdmFyIGZyb20gPSBuZXcgRGF0ZSgpOyBjYW4uY29yZS5UaW1lcih7aW50ZXJ2YWw6IDEwMH0sIGZ1bmN0aW9uKCkgeyB2YXIgbm93ID0gbmV3IERhdGUoKQoJCQkJc3ViLlN0YXR1cyhjbGkuQ09TVCwgY2FuLmJhc2UuRHVyYXRpb24obm93LWZyb20pKQoJCQl9KQoJCX0sIGRvY3VtZW50LmJvZHkpCgl9LAoJdmlldzogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4uX2hlaWdodCkgewoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0LCBjYW4uX2hlaWdodCksIGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnN1cC5fbmF2bWVudSwgY2FuLl9oZWlnaHQpLCBkZWxldGUoY2FuLl9oZWlnaHQpCgkJfSBlbHNlIHsgY2FuLl9oZWlnaHQgPSBjYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0KQoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0LCAiIiksIGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnN1cC5fbmF2bWVudSwgIiIpCgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLkuqTkupLmk43kvZwiLCBsaXN0OiBbIuWIoOmZpCJdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCX0sCglzaG93OiBmdW5jdGlvbihzdWIsIHdoaWNoKSB7IHN1Yi5wYWdlLk1vZGlmeShzdWIsIHN1Yi51aS5jb250ZW50LCB7Y2xhc3NOYW1lOiBjaGF0LkNPTlRFTlR9KQoJCXN1Yi5wYWdlLlNlbGVjdChzdWIsIHN1Yi51aS5jb250ZW50LCB3aWtpLkRJVl9QQUdFLCBmdW5jdGlvbihwYWdlLCBpbmRleCkgewoJCQlpZiAoaW5kZXggPT0gd2hpY2ggfHwgcGFnZSA9PSB3aGljaCkgewoJCQkJc3ViLnBhZ2UuU2VsZWN0KHN1YiwgcGFnZSwgc3ViLnBhZ2UuS2V5cyhodG1sLkgxLCBodG1sLkgyLCBodG1sLkgzKSwgZnVuY3Rpb24oaXRlbSkgeyBzdWIuQWN0aW9uKCLoj5zljZUiLCBpdGVtLmlubmVySFRNTCkgfSkKCQkJCXN1Yi5vbm1vdGlvbi5zZWxlY3Qoc3ViLCBzdWIudWkucHJvamVjdCwgaHRtbC5ESVZfSVRFTSwgaW5kZXgpCgkJCQlzdWIuU3RhdHVzKG1kYi5QQUdFLCBpbmRleCsxK2ljZS5QUytzdWIubGlzdC5sZW5ndGgpCgkJCQlzdWIucGFnZS5DbGFzc0xpc3QuYWRkKHN1YiwgcGFnZSwgaHRtbC5TSE9XKQoJCQl9IGVsc2UgewoJCQkJc3ViLnBhZ2UuQ2xhc3NMaXN0LmRlbChzdWIsIHBhZ2UsIGh0bWwuU0hPVykKCQkJfQoJCX0pCgl9LAoJbmV4dDogZnVuY3Rpb24oc3ViKSB7CgkJc3ViLnBhZ2UuU2VsZWN0KHN1Yiwgc3ViLnVpLmNvbnRlbnQsIHN1Yi5jb3JlLktleXMod2lraS5ESVZfUEFHRSwgaWNlLlNIT1cpLCBmdW5jdGlvbihwYWdlKSB7CgkJCXBhZ2UubmV4dFNpYmxpbmc/IHN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UubmV4dFNpYmxpbmcpOiBzdWIudXNlci50b2FzdChzdWIsIGNsaS5FTkQpCgkJfSkKCX0sCglwcmV2OiBmdW5jdGlvbihzdWIpIHsKCQlzdWIucGFnZS5TZWxlY3Qoc3ViLCBzdWIudWkuY29udGVudCwgc3ViLmNvcmUuS2V5cyh3aWtpLkRJVl9QQUdFLCBpY2UuU0hPVyksIGZ1bmN0aW9uKHBhZ2UpIHsKCQkJcGFnZS5wcmV2aW91c1NpYmxpbmc/IHN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UucHJldmlvdXNTaWJsaW5nKTogc3ViLnVzZXIudG9hc3Qoc3ViLCBjbGkuRU5EKQoJCX0pCgl9LAoJZmxhc2g6IGZ1bmN0aW9uKHN1YikgewoJCXN1Yi5jb3JlLk5leHQoc3ViLnBhZ2UuU2VsZWN0KHN1Yiwgc3ViLnVpLmNvbnRlbnQsIHdpa2kuRElWX1BBR0UpLCBmdW5jdGlvbihwYWdlLCBuZXh0KSB7CgkJCXN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UpLCBzdWIuY29yZS5UaW1lcig1MDAsIGZ1bmN0aW9uKCkgeyBuZXh0KCkgfSkKCQl9KQoJfSwKCWdyaWQ6IGZ1bmN0aW9uKHN1YikgeyBzdWIucGFnZS5Nb2RpZnkoc3ViLCBzdWIudWkuY29udGVudCwge2NsYXNzTmFtZTogImNvbnRlbnQgZ3JpZCJ9KSB9LAoKCSLlvIDorrIiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwuc2hvdyhjYW4sIDApIH0sCgki5b+r6ZeqIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc3VwLm9uZGV0YWlsLmZsYXNoKGNhbikgfSwKCSLnvZHmoLwiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwuZ3JpZChjYW4pIH0sCgoJIuWkp+e6siI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi51aS5wcm9qZWN0KSB9LAoJIummlumhtSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmRldGFpbC5zaG93KGNhbiwgMCkgfSwKCSLkuIrkuIDpobUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwucHJldihjYW4sIGNhbi51aS5jb250ZW50KSB9LAoJIuiPnOWNlSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmRldGFpbC5zaG93KGNhbiwgZXZlbnQudGFyZ2V0LnNlbGVjdGVkSW5kZXgpIH0sCgki5LiL5LiA6aG1IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc3VwLm9uZGV0YWlsLm5leHQoY2FuLCBjYW4udWkuY29udGVudCkgfSwKCSLpmpDol48iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX291dHB1dCkgfSwKCSLnu5PmnZ8iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5fdGFyZ2V0KSB9LAoJIuWIoOmZpCI6IGZ1bmN0aW9uKGV2ZW50LCBzdWIpIHsgc3ViLnBhZ2UuUmVtb3ZlKHN1Yiwgc3ViLl90YXJnZXQpIH0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vdGFibGUuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJCWNhbi51c2VyLmlzTW9iaWxlICYmICFjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX2FjdGlvbikKCQl2YXIgY2JzID0gY2FuLm9uaW1wb3J0W2Nhbi5fYXJnc1sic3R5bGUiXV07IGlmIChjYW4uYmFzZS5pc0Z1bmMoY2JzKSkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdGFyZ2V0LCBjYW4uX2FyZ3NbInN0eWxlIl0pCgkJCXJldHVybiBjYnMoY2FuLCBtc2csIHRhcmdldCkKCQl9CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgdGFyZ2V0KQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgbnVsbCwgdGFyZ2V0KQoJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZywgdGFyZ2V0KQoJCWNhbi5vbm1vdGlvbi5zdG9yeS5hdXRvKGNhbiwgdGFyZ2V0KQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJfSwKCglfcHJvY2VzczogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQltc2cuT3B0aW9uKGljZS5NU0dfVE9BU1QpICYmIGNhbi51c2VyLnRvYXN0KGNhbiwgbXNnLk9wdGlvbihpY2UuTVNHX1RPQVNUKSkKCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmltcG9ydCwgbXNnLk9wdGlvbihpY2UuTVNHX1BST0NFU1MpXSwgW2NhbiwgbXNnXSkKCX0sCgljYXJkOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIHRhcmdldCwgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7CgkJCXJldHVybiB7dmlldzogIml0ZW0iLCBsaXN0OiBbCgkJCQl7dmlldzogWyJ0aXRsZSIsICJkaXYiLCB2YWx1ZS5uYW1lXX0sCgkJCQl7dmlldzogWyJjb250ZW50IiwgImRpdiIsIHZhbHVlLnRleHRdfSwKCQkJCXt2aWV3OiAib3BlcmF0ZSIsIGlubmVyOiB2YWx1ZS5hY3Rpb24sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLnJlcXVlc3QoZXZlbnQsIHZhbHVlKQoJCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBldmVudC50YXJnZXQubmFtZV0pCgkJCQl9fSwKCQkJXX0KCQl9KSkKCX0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5o6n5Lu25Lqk5LqSIiwgbGlzdDogW119KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9pbnB1dC5qcyIKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgY2IsIHRhcmdldCkgewoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKTsgc3dpdGNoIChtZXRhLnR5cGUpIHsKCQkJY2FzZSBodG1sLlNFTEVDVDogbWV0YS52YWx1ZSAmJiAodGFyZ2V0LnZhbHVlID0gbWV0YS52YWx1ZSk7IGJyZWFrCgkJCWNhc2UgaHRtbC5CVVRUT046IG1ldGEuYWN0aW9uID09IGljZS5BVVRPICYmIHRhcmdldC5jbGljaygpOyBicmVhawoJCX0KCX0sCglydW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnJ1bihldmVudCkgfSwKCWxpc3Q6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5Db25mKCJtb2RlIikgIT0gInNpbXBsZSIgJiYgY2FuLnJ1bihldmVudCkgfSwKCWJhY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmltcG9ydC5fYmFjayhjYW4uc3VwKSB9LAoJcmVmcmVzaDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ucnVuKGV2ZW50KSB9LAoKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5yZXF1ZXN0KGV2ZW50LCB7X3RvYXN0OiAi5omn6KGM5LitLi4uIn0pCgkJY2FuLkNvbmYobWRiLlRZUEUpID09IGh0bWwuQlVUVE9OICYmIGNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjYW4uQ29uZihtZGIuTkFNRSldLmNvbmNhdChjYW4uc3VwLklucHV0KCkpKQoJfSwKCW9uY2hhbmdlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAucmVxdWVzdChldmVudCwge190b2FzdDogIuaJp+ihjOS4rS4uLiJ9KQoJCWlmIChjYW4uQ29uZihtZGIuVFlQRSkgPT0gaHRtbC5TRUxFQ1QpIHsgY2FuLnJ1bihldmVudCkgfQoJfSwKCW9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KQoJCWlmIChjYW4uQ29uZihtZGIuVFlQRSkgPT0gaHRtbC5URVhUQVJFQSkgeyBpZiAoIWV2ZW50LmN0cmxLZXkpIHsgcmV0dXJuIH0gfQoJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FTlRFUikgewoJCQljYW4ucnVuKGV2ZW50KSwgY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgZXZlbnQudGFyZ2V0KQoJCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQl9IGlmICghZXZlbnQuY3RybEtleSkgeyByZXR1cm4gfQoKCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQljYXNlICJiIjogY2FuLkNsb25lSW5wdXQoKTsgYnJlYWsKCQkJY2FzZSAibSI6IGNhbi5DbG9uZUZpZWxkKCk7IGJyZWFrCgkJCWRlZmF1bHQ6IHJldHVybgoJCX0gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL3N0b3J5L2Zvcm0uanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YXJnZXQsICJmb3JtIikKCQltc2cuUHVzaCgidHlwZSIsICJ0ZXh0IikKCQltc2cuUHVzaCgibmFtZSIsICJuYW1lIikKCQltc2cuUHVzaCgidmFsdWUiLCAiaGFydmV5c2hhbyIpCgkJbXNnLlB1c2goImFjdGlvbiIsICJrZXkiKQoKCQltc2cuUHVzaCgidHlwZSIsICJ0ZXh0IikKCQltc2cuUHVzaCgibmFtZSIsICJhZ2UiKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICIxOCIpCgkJbXNnLlB1c2goImFjdGlvbiIsICIiKQoKCQltc2cuUHVzaCgidHlwZSIsICJzZWxlY3QiKQoJCW1zZy5QdXNoKCJuYW1lIiwgIm1hbGUiKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICJtYWxlLGZlbWFsZSIpCgkJbXNnLlB1c2goImFjdGlvbiIsICIiKQoKCQltc2cuUHVzaCgidHlwZSIsICJ0ZXh0YXJlYSIpCgkJbXNnLlB1c2goIm5hbWUiLCAiaW50cm8iKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICJwcm9ncmFtIikKCQltc2cuUHVzaCgiYWN0aW9uIiwgIiIpCgoJCW1zZy5QdXNoKCJ0eXBlIiwgImJ1dHRvbiIpCgkJbXNnLlB1c2goIm5hbWUiLCAic3VibWl0IikKCQltc2cuUHVzaCgidmFsdWUiLCAi5o+Q5LqkIikKCQltc2cuUHVzaCgiYWN0aW9uIiwgIiIpCgoJCXZhciBhY3Rpb24gPSAiIjsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpIHsKCQkJc3dpdGNoICh2YWx1ZS50eXBlKSB7CgkJCQljYXNlIGh0bWwuQlVUVE9OOiBhY3Rpb24gPSBhY3Rpb258fHZhbHVlLm5hbWUKCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogIml0ZW0iLCBsaXN0OiBbCgkJCQkJCXt2aWV3OiBbImlucHV0Il0sIGxpc3Q6IFt7dHlwZTogaHRtbC5JTlBVVCwgc3R5bGU6IHt3aWR0aDogKGNhbi5Db25mV2lkdGgoKS05MCkvMn0sIGRhdGE6IHt0eXBlOiB2YWx1ZS50eXBlLCB2YWx1ZTogdmFsdWUudmFsdWV9LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQkJdmFyIGFyZ3MgPSBbY3R4LkFDVElPTiwgYWN0aW9uXQoJCQkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCAiLmFyZ3MiLCBmdW5jdGlvbihpdGVtKSB7IGFyZ3MucHVzaChpdGVtLm5hbWUsIGl0ZW0udmFsdWUpfSkKCQkJCQkJCWNhbi5ydW4oZXZlbnQsIGFyZ3MpCgkJCQkJCX19XX0sCgkJCQkJXX1dKQoJCQkJCWJyZWFrCgkJCQljYXNlIGh0bWwuU0VMRUNUOgoJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiAiaXRlbSIsIGxpc3Q6IFsKCQkJCQkJe3ZpZXc6IFsibGFiZWwiXSwgbGlzdDogW3t0ZXh0OiB2YWx1ZS5uYW1lfV19LAoJCQkJCQl7dmlldzogWyJpbnB1dCJdLCBsaXN0OiBbe3R5cGU6IGh0bWwuU0VMRUNULCBjbGFzc05hbWU6ICJhcmdzIiwgc3R5bGU6IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpLTEwMH0sCgkJCQkJCQlkYXRhOiB2YWx1ZSwgbGlzdDogY2FuLmNvcmUuTGlzdChjYW4uY29yZS5TcGxpdCh2YWx1ZS52YWx1ZSksIGZ1bmN0aW9uKHYpIHsgcmV0dXJuIHt0eXBlOiBodG1sLk9QVElPTiwgbmFtZTogdiwgdmFsdWU6IHYsIGlubmVyOiB2fSB9KSB9XX0sCgkJCQkJXX1dKQoJCQkJCWJyZWFrCgkJCQljYXNlIGh0bWwuVEVYVEFSRUE6CgkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogWwoJCQkJCQl7dmlldzogWyJsYWJlbCJdLCBsaXN0OiBbe3RleHQ6IHZhbHVlLm5hbWV9XX0sCgkJCQkJCXt2aWV3OiBbImlucHV0Il0sIGxpc3Q6IFt7dHlwZTogaHRtbC5URVhUQVJFQSwgY2xhc3NOYW1lOiAiYXJncyIsIHN0eWxlOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKS0xMDB9LCBkYXRhOiB2YWx1ZX1dfSwKCQkJCQldfV0pCgkJCQkJYnJlYWsKCQkJCWRlZmF1bHQ6CgkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogWwoJCQkJCQl7dmlldzogWyJsYWJlbCJdLCBsaXN0OiBbe3RleHQ6IHZhbHVlLm5hbWV9XX0sCgkJCQkJCXt2aWV3OiBbImlucHV0Il0sIGxpc3Q6IFt7dHlwZTogImlucHV0IiwgY2xhc3NOYW1lOiAiYXJncyIsIHN0eWxlOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKS0xMDB9LCBkYXRhOiB2YWx1ZX1dfSwKCQkJCQldfV0pCgkJCX0KCQl9KQoJfSwKfSwgWyIiXSkKCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvdGVhbS9wbGFuLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB0YXJnZXQpCgkJY2FuLnVpID0gY2FuLm9ubGF5b3V0LnByb2ZpbGUoY2FuKQoJCWNhbi5vbmltcG9ydFtjYW4uT3B0aW9uKCJzY2FsZSIpfHwid2VlayJdKGNhbiwgbXNnKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9qZWN0LCB7c3R5bGU6IHsibWF4LWhlaWdodCI6IGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodH19KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9maWxlLCB7c3R5bGU6IHsibWF4LWhlaWdodCI6IGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodH19KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9maWxlLCB7c3R5bGU6IHtkaXNwbGF5OiAiYmxvY2sifX0pCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgIWNhbi51c2VyLmlzTGFuZHNjYXBlKCkgJiYgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJfSwKCV9jb250ZW50OiBmdW5jdGlvbihjYW4sIG1zZywgaGVhZCwgbGlzdCwga2V5LCBnZXQsIHNldCkgewoJCXZhciBoYXNoID0ge307IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsgdmFyIGsgPSBrZXkoY2FuLmJhc2UuRGF0ZSh2YWx1ZS5iZWdpbl90aW1lKSk7IGhhc2hba10gPSAoaGFzaFtrXXx8W10pLmNvbmNhdChbdmFsdWVdKSB9KQoKCQljYW4uc3VwLnRhc2sgJiYgKGNhbi5zdXAudGFzay5fdGFyZ2V0ID0gbnVsbCkKCQl2YXIgYmVnaW5fdGltZSA9IGNhbi5iYXNlLkRhdGUoY2FuLk9wdGlvbigiYmVnaW5fdGltZSIpKQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5jb250ZW50LCBbe3ZpZXc6IFtjaGF0LkNPTlRFTlQsIGh0bWwuVEFCTEVdLCBsaXN0OiBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGhvdXIsIHJvdykgewoJCQlyZXR1cm4ge3R5cGU6IGh0bWwuVFIsIGxpc3Q6IGNhbi5jb3JlLkxpc3QoaGVhZCwgZnVuY3Rpb24od2VlaywgY29sKSB7CgkJCQlpZiAocm93ID09IDApIHsgcmV0dXJuIHt0ZXh0OiBbd2VlaywgaHRtbC5USF19IH0KCQkJCWlmIChjb2wgPT0gMCkgeyByZXR1cm4ge3RleHQ6IFtob3VyLCBodG1sLlREXX0gfQoJCQkJcmV0dXJuIGNhbi5vbmltcG9ydC5fdGFzayhjYW4sIG1zZywgZ2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93LCBoYXNoKSwgc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSkKCQkJfSl9CgkJfSkgfV0pCgkJaWYgKG1zZy5MZW5ndGgoKSA9PSAwKSB7IHJldHVybiB9CgkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBpZiAoIWNhbi5zdXAudGFzaykgeyByZXR1cm4gfQoJCQl2YXIgdGFyZ2V0ID0gY2FuLnN1cC50YXNrLl90YXJnZXR8fGNhbi50YXNrLl90YXJnZXQKCQkJY2FuLnN1cC50YXNrID0gbnVsbCwgdGFyZ2V0LmNsaWNrKCkKCQkJY2FuLlN0YXR1cygiY291bnQiLCBtc2cuTGVuZ3RoKCkpCgkJfSkKCX0sCglfdGFzazogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIHRpbWUpIHsgcmV0dXJuIHt0ZXh0OiBbIiIsIGh0bWwuVERdLAoJCW9uZGJsY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmFjdGlvbi5pbnNlcnRUYXNrKGV2ZW50LCBjYW4sIHRpbWUrY2FuLmJhc2UuVGltZShudWxsLCAiJXktJW0tJWQgJUg6JU06JVMiKS5zbGljZSh0aW1lLmxlbmd0aCkpCgkJfSwKCQlvbmRyb3A6IGZ1bmN0aW9uKGV2ZW50KSB7IGV2ZW50LnByZXZlbnREZWZhdWx0KCkKCQkJY2FuLmRyb3AoZXZlbnQsIGV2ZW50LnRhcmdldCwgdGltZSkKCQl9LAoJCW9uZHJhZ292ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7IGV2ZW50LnByZXZlbnREZWZhdWx0KCkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVEQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdFtldmVudC50YXJnZXQgPT0gaXRlbT8gImFkZCI6ICJkZWwiXShjYW4sIGl0ZW0sICJvdmVyIikKCQkJfSkKCQl9LAoJCWxpc3Q6IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24odGFzaykgeyByZXR1cm4gY2FuLmJhc2UuaXNTdHJpbmcodGFzayk/IHt0ZXh0OiBbdGFzaywgaHRtbC5ESVYsICJkYXRlIl19OgoJCQkJe3RleHQ6IFtjYW4ub25leHBvcnRbY2FuLkFjdGlvbigidmlldyIpfHwidGV4dCJdKGNhbiwgdGFzayksIGh0bWwuRElWLCBjYW4ub25leHBvcnQuc3R5bGUoY2FuLCB0YXNrKV0sCgkJCQkJb25kcmFnc3RhcnQ6IGZ1bmN0aW9uKGV2ZW50KSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7IGNhbi5kcm9wID0gZnVuY3Rpb24oZXZlbnQsIHRkLCB0aW1lKSB7IHRkLmFwcGVuZCh0YXJnZXQpCgkJCQkJCWNhbi5vbmFjdGlvbi5tb2RpZnlUYXNrKGV2ZW50LCBjYW4sIHRhc2ssICJiZWdpbl90aW1lIiwgdGltZSt0YXNrLmJlZ2luX3RpbWUuc2xpY2UodGltZS5sZW5ndGgpLCB0YXNrLmJlZ2luX3RpbWUpCgkJCQkJfSB9LCBkcmFnZ2FibGU6IHRpbWUgIT0gdW5kZWZpbmVkLAoKCQkJCQl0aXRsZTogY2FuLm9uZXhwb3J0LnRpdGxlKGNhbiwgdGFzayksIF9pbml0OiBmdW5jdGlvbih0YXJnZXQpIHsKCQkJCQkJdmFyIGl0ZW0gPSBjYW4ub25hcHBlbmQuaXRlbShjYW4sIGh0bWwuSVRFTSwge25pY2s6IHRhc2submFtZSsiOiIrdGFzay50ZXh0fSwgZnVuY3Rpb24oKSB7CgkJCQkJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IGNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5URCwgdGFyZ2V0LnBhcmVudE5vZGUpIH0pCgkJCQkJCQljYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCB0YXNrKQoJCQkJCQl9LCBmdW5jdGlvbigpIHsKCgkJCQkJCX0sIGNhbi51aS5wcm9qZWN0KTsgdGFzay5fdGFyZ2V0ID0gdGFyZ2V0LCBjYW4udGFzayA9IGNhbi50YXNrfHx0YXNrLCBjYW4uc3VwLnRhc2sgPSBjYW4uc3VwLnRhc2t8fHRhc2sKCQkJCQkJY2FuLnN1cC50YXNrLnpvbmUgPT0gdGFzay56b25lICYmIGNhbi5zdXAudGFzay5pZCA9PSB0YXNrLmlkICYmIChjYW4uc3VwLnRhc2suX3RhcmdldCA9IHRhcmdldCkKCQkJCQkJdGFyZ2V0Lm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgeyBpdGVtLmNsaWNrKCkgfQoJCQkJCX0sCgkJCQl9CgkJfSksCgl9IH0sCglfcHJvZmlsZTogZnVuY3Rpb24oY2FuLCB0YXNrKSB7CgkJaWYgKGNhbi5zdXAudGFzayAmJiBjYW4uc3VwLnRhc2sucG9kID09IHRhc2sucG9kICYmIGNhbi5zdXAudGFzay5pZCA9PSB0YXNrLmlkKSB7IHJldHVybiB9CgkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gY2FuLnN1cC50YXNrID0gdGFzaywgY2FuLlN0YXR1cyh0YXNrKSwgW3Rhc2sucG9kLCB0YXNrLnpvbmUsIHRhc2suaWRdLmpvaW4oaWNlLlBUKSB9LCBjYW4udWkucHJvZmlsZSwgY2FuLnVpLmRpc3BsYXkpKSB7IHJldHVybiB9CgoJCXRhc2suZXh0cmEgJiYgY2FuLmNvcmUuSXRlbShjYW4uYmFzZS5PYmoodGFzay5leHRyYSksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgdGFza1siZXh0cmEuIitrZXldID0gdmFsdWUgfSksIGRlbGV0ZSh0YXNrLmV4dHJhKQoJCXZhciB0YWJsZSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCBjYW4udWkucHJvZmlsZSwgW3t2aWV3OiBbY2hhdC5DT05URU5ULCBodG1sLlRBQkxFXSwgbGlzdDogW3t0aDogWyJrZXkiLCAidmFsdWUiXX1dfV0pLmZpcnN0CgkJY2FuLmNvcmUuSXRlbSh0YXNrLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGtleSAhPSAiX3RhcmdldCIgJiYgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFibGUsIFt7CgkJCXRkOiBba2V5LCBrZXkgPT0gInBvZCIgJiYgdmFsdWUgIT0gIiI/IGNhbi5wYWdlLkZvcm1hdCgiYSIsIGNhbi5taXNjLk1lcmdlVVJMKGNhbiwge3BvZDogdmFsdWV9KSwgdmFsdWUpOiB2YWx1ZV0sCgkJCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7IGlmIChldmVudC50YXJnZXQudHlwZSA9PSAiYnV0dG9uIikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5zdXAudGFzaykKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBldmVudC50YXJnZXQubmFtZV0sIGZ1bmN0aW9uKG1zZykgeyBjYW4uVXBkYXRlKCkgfSwgdHJ1ZSkKCQkJfSB9LAoJCQlvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24ubW9kaWZ5KGNhbiwgZXZlbnQudGFyZ2V0LCBmdW5jdGlvbihldiwgdmFsdWUsIG9sZCkgewoJCQkJY2FuLm9uYWN0aW9uLm1vZGlmeVRhc2soZXZlbnQsIGNhbiwgdGFzaywga2V5LCB2YWx1ZSkKCQkJfSwge25hbWU6IGtleSwgYWN0aW9uOiBrZXkuaW5kZXhPZigidGltZSIpID4gMD8gImRhdGUiOiAia2V5In0pIH0sCgkJfV0pIH0pLCBjYW4ub25pbXBvcnQuX2Rpc3BsYXkoY2FuLCB0YXNrKQoJfSwKCV9kaXNwbGF5OiBmdW5jdGlvbihjYW4sIHRhc2spIHsgaWYgKCF0YXNrWyJleHRyYS5jbWQiXSkgeyByZXR1cm4gfQoJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCB7dHlwZTogY2hhdC5TVE9SWSwgY3R4OiB0YXNrWyJleHRyYS5jdHgiXSwgY21kOiB0YXNrWyJleHRyYS5jbWQiXSwgYXJnOiB0YXNrWyJleHRyYS5hcmciXX0sIGZ1bmN0aW9uKHN1YiwgbWV0YSkgewoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwga2l0LkRpY3QoInRhc2sucG9kIiwgdGFza1sicG9kIl0sICJ0YXNrLnpvbmUiLCB0YXNrLnpvbmUsICJ0YXNrLmlkIiwgdGFzay5pZCkpCgkJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgdGFza1ttZGIuWk9ORV0sIHRhc2tbbWRiLklEXV0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJfQoJCX0sIGNhbi51aS5kaXNwbGF5KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5kaXNwbGF5LCB7c3R5bGU6IHtkaXNwbGF5OiBodG1sLkJMT0NLfX0pCgl9LAoKCWRheTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVhZCA9IFsiaG91ciIsICJ0YXNrIl0KCQl2YXIgbGlzdCA9IFswXTsgZm9yICh2YXIgaSA9IDc7IGkgPCAyNDsgaSsrKSB7IGxpc3QucHVzaChjYW4uYmFzZS5OdW1iZXIoaSwgMikpIH0KCgkJZnVuY3Rpb24ga2V5KHRpbWUpIHsgcmV0dXJuIGNhbi5iYXNlLk51bWJlcih0aW1lLmdldEhvdXJzKCksIDIpIH0KCQlmdW5jdGlvbiBnZXQoYmVnaW5fdGltZSwgY29sLCByb3csIGhhc2gpIHsgcmV0dXJuIGhhc2hbbGlzdFtyb3ddXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBjYW4uYmFzZS5UaW1lKGJlZ2luX3RpbWUsICIleS0lbS0lZCAiKStsaXN0W3Jvd10gfQoKCQljYW4ub25pbXBvcnQuX2NvbnRlbnQoY2FuLCBtc2csIGhlYWQsIGxpc3QsIGtleSwgZ2V0LCBzZXQpCgl9LAoJd2VlazogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVhZCA9IFsiaG91ciJdLmNvbmNhdChbIuWRqOaXpSIsICLlkajkuIAiLCAi5ZGo5LqMIiwgIuWRqOS4iSIsICLlkajlm5siLCAi5ZGo5LqUIiwgIuWRqOWFrSJdKQoJCXZhciBsaXN0ID0gWzBdOyBmb3IgKHZhciBpID0gNzsgaSA8IDI0OyBpKyspIHsgbGlzdC5wdXNoKGNhbi5iYXNlLk51bWJlcihpLCAyKSkgfQoKCQlmdW5jdGlvbiBrZXkodGltZSkgeyByZXR1cm4gdGltZS5nZXREYXkoKSsiICIrY2FuLmJhc2UuTnVtYmVyKHRpbWUuZ2V0SG91cnMoKSwgMikgfQoJCWZ1bmN0aW9uIGdldChiZWdpbl90aW1lLCBjb2wsIHJvdywgaGFzaCkgeyByZXR1cm4gaGFzaFtjb2wtMSsiICIrbGlzdFtyb3ddXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBjYW4uYmFzZS5UaW1lKGNhbi5iYXNlLlRpbWVBZGQoYmVnaW5fdGltZSwgLWJlZ2luX3RpbWUuZ2V0RGF5KCkrY29sLTEpLCAiJXktJW0tJWQgIikrbGlzdFtyb3ddIH0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKCW1vbnRoOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciBoZWFkID0gWyJvcmRlciJdLmNvbmNhdChbIuWRqOaXpSIsICLlkajkuIAiLCAi5ZGo5LqMIiwgIuWRqOS4iSIsICLlkajlm5siLCAi5ZGo5LqUIiwgIuWRqOWFrSJdKQoJCXZhciBsaXN0ID0gWzBdOyBmb3IgKHZhciBpID0gMTsgaSA8IDY7IGkrKykgeyBsaXN0LnB1c2goaSkgfQoKCQlmdW5jdGlvbiBrZXkodGltZSkgeyByZXR1cm4gY2FuLmJhc2UuVGltZSh0aW1lLCAiJXktJW0tJWQiKSB9CgkJZnVuY3Rpb24gZ2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93LCBoYXNoKSB7CgkJCXZhciBiZWdpbiA9IGNhbi5iYXNlLlRpbWVBZGQoYmVnaW5fdGltZSwgLShiZWdpbl90aW1lLmdldERhdGUoKS0xKSkKCQkJdmFyIGxhc3QgPSBjYW4uYmFzZS5UaW1lQWRkKGJlZ2luX3RpbWUsIC0oYmVnaW5fdGltZS5nZXREYXRlKCktMSktYmVnaW4uZ2V0RGF5KCkpCgkJCXZhciBkYXkgPSBjYW4uYmFzZS5UaW1lQWRkKGxhc3QsIChyb3ctMSkqNytjb2wpCgkJCXJldHVybiBbZGF5LmdldERhdGUoKSsiIl0uY29uY2F0KGhhc2hba2V5KGRheSldfHxbXSkKCQl9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7CgkJCXZhciBiZWdpbiA9IGNhbi5iYXNlLlRpbWVBZGQoYmVnaW5fdGltZSwgLShiZWdpbl90aW1lLmdldERhdGUoKS0xKSkKCQkJdmFyIGxhc3QgPSBjYW4uYmFzZS5UaW1lQWRkKGJlZ2luX3RpbWUsIC0oYmVnaW5fdGltZS5nZXREYXRlKCktMSktYmVnaW4uZ2V0RGF5KCkpCgkJCXZhciBkYXkgPSBjYW4uYmFzZS5UaW1lQWRkKGxhc3QsIChyb3ctMSkqNytjb2wpCgkJCXJldHVybiBrZXkoZGF5KQoJCX0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKCXllYXI6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJdmFyIGhlYWQgPSBbIm1vbnRoIl0uY29uY2F0KFsi5ZGo5pelIiwgIuWRqOS4gCIsICLlkajkuowiLCAi5ZGo5LiJIiwgIuWRqOWbmyIsICLlkajkupQiLCAi5ZGo5YWtIl0pOwoJCXZhciBsaXN0ID0gWzBdOyBmb3IgKHZhciBpID0gMTsgaSA8IDEzOyBpKyspIHsgbGlzdC5wdXNoKGkpIH0KCgkJZnVuY3Rpb24ga2V5KHRpbWUpIHsgcmV0dXJuIGNhbi5iYXNlLlRpbWUodGltZSwgIiV5LSVtICIpK3RpbWUuZ2V0RGF5KCkgfQoJCWZ1bmN0aW9uIGdldChiZWdpbl90aW1lLCBjb2wsIHJvdywgaGFzaCkgeyByZXR1cm4gaGFzaFtiZWdpbl90aW1lLmdldEZ1bGxZZWFyKCkrIi0iK2Nhbi5iYXNlLk51bWJlcihyb3csIDIpKyIgIisoY29sLTEpXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBiZWdpbl90aW1lLmdldEZ1bGxZZWFyKCkrIi0iK2Nhbi5iYXNlLk51bWJlcihsaXN0W3Jvd10sIDIpIH0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKCWxvbmc6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJdmFyIGJlZ2luX3RpbWUgPSBjYW4uYmFzZS5EYXRlKGNhbi5iYXNlLlRpbWUoY2FuLk9wdGlvbigiYmVnaW5fdGltZSIpLCAiJXktJW0tJWQgJUg6JU06JVMiKSkKCQl2YXIgYmVnaW4gPSBiZWdpbl90aW1lLmdldEZ1bGxZZWFyKCkgLSA1CgoJCXZhciBoZWFkID0gWyJtb250aCJdOyBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHsgaGVhZC5wdXNoKGJlZ2luK2kpIH0KCQl2YXIgbGlzdCA9IFswXTsgZm9yICh2YXIgaSA9IDE7IGkgPCAxMzsgaSsrKSB7IGxpc3QucHVzaChpKSB9CgoJCWZ1bmN0aW9uIGtleSh0aW1lKSB7IHJldHVybiBjYW4uYmFzZS5UaW1lKHRpbWUsICIleS0lbSIpIH0KCQlmdW5jdGlvbiBnZXQoYmVnaW5fdGltZSwgY29sLCByb3csIGhhc2gpIHsgcmV0dXJuIGhhc2hbYmVnaW4rY29sLTErIi0iK2Nhbi5iYXNlLk51bWJlcihyb3csIDIpXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBiZWdpbitjb2wtMSsiLSIrY2FuLmJhc2UuTnVtYmVyKHJvdywgMikgfQoKCQljYW4ub25pbXBvcnQuX2NvbnRlbnQoY2FuLCBtc2csIGhlYWQsIGxpc3QsIGtleSwgZ2V0LCBzZXQpCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIue7hOS7tuS6pOS6kiIsIGxpc3Q6IFsKCQkiaW5zZXJ0IiwgImV4cG9ydCIsICJpbXBvcnQiLAoJCVsibGV2ZWwiLCAiYWxsIiwgImwxIiwgImwyIiwgImwzIiwgImw0IiwgImw1Il0sCgkJWyJzdGF0dXMiLCAiYWxsIiwgInByZXBhcmUiLCAicHJvY2VzcyIsICJjYW5jZWwiLCAiZmluaXNoIl0sCgkJWyJzY29yZSIsICJhbGwiLCAiczEiLCAiczIiLCAiczMiLCAiczQiLCAiczUiXSwKCQlbInZpZXciLCAiIiwgIm5hbWUiLCAidGV4dCIsICJsZXZlbCIsICJzY29yZSJdLAoJXSwKCWluc2VydFRhc2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRpbWUpIHsgdmFyIG1zZyA9IGNhbi5zdXAucmVxdWVzdChldmVudCwge2JlZ2luX3RpbWU6IHRpbWV9KQoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIGNhbi5Db25mKCJmZWF0dXJlLmluc2VydCIpLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0KSB7CgkJCWNhbi5ydW4oZXZlbnQsIGNhbi5iYXNlLlNpbXBsZShjdHguQUNUSU9OLCBtZGIuSU5TRVJULCBkYXRhLCAiYmVnaW5fdGltZSIsIHRpbWUpLCB0cnVlKQoJCX0pCgl9LAoJbW9kaWZ5VGFzazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFzaywga2V5LCB2YWx1ZSkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHRhc2spCgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5NT0RJRlksIGtleSwgdmFsdWUsIHRhc2tba2V5XV0pCgl9LAoKCV9maWx0ZXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgdmFyIGNvdW50ID0gMAoJCWlmICh2YWx1ZSA9PSAiYWxsIikgewoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgImRpdi5pdGVtIiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIGl0ZW0sICJoaWRlIiksIGNvdW50KysKCQkJfSkKCQl9IGVsc2UgewoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgImRpdi5pdGVtIiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGl0ZW0sICJoaWRlIikKCQkJfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJkaXYuIit2YWx1ZSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIGl0ZW0sICJoaWRlIiksIGNvdW50KysKCQkJfSkKCQl9CgkJY2FuLkFjdGlvbihrZXksIHZhbHVlKSwgY2FuLlN0YXR1cygiY291bnQiLCBjb3VudCkKCX0sCglsZXZlbDogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2ZpbHRlcihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB9LAoJc3RhdHVzOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fZmlsdGVyKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIH0sCglzY29yZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2ZpbHRlcihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB9LAoJdmlldzogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgewoJCWNhbi5BY3Rpb24oa2V5LCB2YWx1ZSkKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkucHJvamVjdCkKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkuY29udGVudCkKCQljYW4ub25pbXBvcnRbY2FuLk9wdGlvbigic2NhbGUiKV0oY2FuLCBjYW4uX21zZykKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyJjb3VudCIsICJiZWdpbl90aW1lIiwgInpvbmUiLCAiaWQiLCAidHlwZSIsICJuYW1lIiwgInRleHQiXSwKCW5hbWU6IGZ1bmN0aW9uKGNhbiwgdGFzaykgeyByZXR1cm4gdGFzay5uYW1lIH0sCgl0ZXh0OiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuIHRhc2submFtZSsiOiAiKyh0YXNrLnRleHR8fCIiKSB9LAoJbGV2ZWw6IGZ1bmN0aW9uKGNhbiwgdGFzaykgeyByZXR1cm4gImwtIisodGFzay5sZXZlbHx8MykrIjogIisodGFzay5uYW1lfHwiIikgfSwKCXNjb3JlOiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuICJzLSIrKHRhc2subGV2ZWx8fDMpKyI6ICIrKHRhc2submFtZXx8IiIpIH0sCgl0aXRsZTogZnVuY3Rpb24oY2FuLCB0YXNrKSB7IHJldHVybiB0YXNrLnpvbmUrIjogIisodGFzay50eXBlfHwiIikgfSwKCXN0eWxlOiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuIFsiaXRlbSIsIHRhc2suc3RhdHVzLCAiaWQiK3Rhc2suaWQsICJsIisodGFzay5sZXZlbHx8IiIpLCAicyIrKHRhc2suc2NvcmV8fCIiKV0uam9pbigiICIpIH0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vc3RvcnkvanNvbi5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgImpzb24iKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHRhcmdldCksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5zaG93KGNhbiwgY2FuLmJhc2UuT2JqKG1zZy5SZXN1bHQoKSwge30pLCB0YXJnZXQpCgl9LAoJc2hvdzogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKCQlmdW5jdGlvbiBzaG93KGRhdGEsIHRhcmdldCwgaW5kZXgsIHRvdGFsKSB7IHZhciBsaXN0CgkJCXN3aXRjaCAodHlwZW9mIGRhdGEpIHsKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6CgkJCQkJaWYgKGRhdGEgPT0gbnVsbCkgewoJCQkJCQlsaXN0ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6ICJudWxsIn1dKS5pdGVtCgkJCQkJCWJyZWFrCgkJCQkJfQoJCQkJCWZ1bmN0aW9uIHdyYXAoYmVnaW4sIGVuZCwgYWRkLCBjYikgewoJCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dGV4dDogYmVnaW59XSkKCQkJCQkJYWRkICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBbIi4uLiIsIGh0bWwuU1BBTiwgIm5vbmNlIl19XSksIGNiKCkKCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IGVuZH1dKQoJCQkJCX0KCQkJCQlmdW5jdGlvbiB0b2dnbGUobGlzdCkgeyBsaXN0ICYmIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBsaXN0KSB9CgkJCQkJZnVuY3Rpb24gX2l0ZW0oKSB7CgkJCQkJCWxpc3QgPSBsaXN0IHx8IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBodG1sLkxJU1R9XSkubGlzdAoJCQkJCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgbGlzdCwgW3t2aWV3OiBodG1sLklURU19XSkuaXRlbQoJCQkJCX0KCgkJCQkJaWYgKGNhbi5iYXNlLmlzQXJyYXkoZGF0YSkpIHsgLy8g5pWw57uECgkJCQkJCXdyYXAoIlsiLCAiXSIsIGRhdGEubGVuZ3RoID4gMCwgZnVuY3Rpb24oKSB7IGNhbi5jb3JlLkxpc3QoZGF0YSwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7IHZhciBpdGVtID0gX2l0ZW0oKQoJCQkJCQkJc2hvdyh2YWx1ZSwgaXRlbSwgaW5kZXgsIGRhdGEubGVuZ3RoKQoJCQkJCQl9KSB9KQoJCQkJCX0gZWxzZSB7IC8vIOWvueixoQoJCQkJCQl2YXIgbGVuZ3RoID0gY2FuLmNvcmUuSXRlbShkYXRhKS5sZW5ndGgsIGNvdW50ID0gMAoJCQkJCQl3cmFwKCJ7IiwgIn0iLCBsZW5ndGggPiAwLCBmdW5jdGlvbigpIHsgY2FuLmNvcmUuSXRlbShkYXRhLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHZhciBpdGVtID0gX2l0ZW0oKQoJCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgaXRlbSwgW3t0ZXh0OiBbJyInK2tleSsnIicsIGh0bWwuU1BBTiwgImtleSJdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyB0b2dnbGUoc3ViKSB9fSwge3RleHQ6ICc6ICd9XSkKCQkJCQkJCXZhciBzdWIgPSBzaG93KHZhbHVlLCBpdGVtLCBjb3VudCsrLCBsZW5ndGgpCgkJCQkJCX0pIH0pCgkJCQkJfQoJCQkJCWJyZWFrCgkJCQljYXNlIGxhbmcuU1RSSU5HOiAvKiDlrZfkuLIgKi8gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IFsnIicrZGF0YSsnIicsIGh0bWwuU1BBTiwgbGFuZy5TVFJJTkddfV0pOyBicmVhawoJCQkJZGVmYXVsdDogLyog5YW25a6DICovIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBbJycrZGF0YSsnJywgaHRtbC5TUEFOLCAiY29uc3QiXX1dKQoJCQl9CgkJCShpbmRleCA8IHRvdGFsLTEpICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBpY2UuRlN9XSkKCQkJcmV0dXJuIGxpc3QKCQl9OyBzaG93KGRhdGEsIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBodG1sLklURU19XSkuaXRlbSwgMCwgMCkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogWyLlsZXlvIAiLCAi5oqY5Y+gIiwgIuWkjeWItiJdLAoJIuWxleW8gCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgImRpdi5saXN0IGRpdi5saXN0IiwgZnVuY3Rpb24obGlzdCkgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgbGlzdCwgdHJ1ZSkKCQl9KQoJfSwKCSLmipjlj6AiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYubGlzdCBkaXYubGlzdCIsIGZ1bmN0aW9uKGxpc3QpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGxpc3QpCgkJfSkKCX0sCgki5aSN5Yi2IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgY2FuLl9tc2cuUmVzdWx0KCkpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9pbnB1dC9rZXkuanMiClZvbGNhbm9zKCJvbmZpZ3VyZSIsIHtoZWxwOiAi5o6n5Lu26K+m5oOFIiwgbGlzdDogW10sIGtleTogewoJX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsgdmFyIGNhbGwgPSBhcmd1bWVudHMuY2FsbGVlOyB0YXJnZXQuX21zZyA9IG1zZwoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKSB7CgkJCXJldHVybiB7dGV4dDogW3ZhbHVlLCBodG1sLlREXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsgdGFyZ2V0LnZhbHVlID0gbGluZVtrZXldCgkJCQlpZiAobXNnLk9wdGlvbihpY2UuTVNHX1BST0NFU1MpICE9IGljZS5QUk9DRVNTX0FHQUlOKSB7IHJldHVybiBjYW4uY2xvc2UoKSB9CgkJCQl0YXJnZXQuX2hvbGQgPSB0cnVlCgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLklOUFVUUywgY2FuLkNvbmYobWRiLk5BTUUpLCB0YXJnZXQudmFsdWVdLCBmdW5jdGlvbihtc2cpIHsgY2FsbChjYW4sIG1zZywgdGFyZ2V0KSB9KQoJCQl9fQoJCX0pLCBjYW4uU3RhdHVzKG1kYi5UT1RBTCwgbXNnLkxlbmd0aCgpKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0LCBtc2cuTGVuZ3RoKCkgPiAwKQoJfSwKCV9zaG93OiBmdW5jdGlvbihldmVudCwgY2FuLCBuYW1lLCBjYnMsIHRhcmdldCwgdmFsdWUpIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLklOUFVUUywgbmFtZSwgdmFsdWV8fHRhcmdldC52YWx1ZV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25maWd1cmUua2V5Ll9pbml0KGNhbiwgbXNnLCB0YXJnZXQpLCBjYW4uYmFzZS5pc0Z1bmMoY2JzKSAmJiBjYnMoY2FuLCBtc2cuTGVuZ3RoKCkgPT0gMCkKCQl9KQoJfSwKCS8vIG9uZm9jdXM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgaWYgKHRhcmdldC5fZmlndXJlKSB7IHJldHVybiB9IHRhcmdldC5fZmlndXJlID0ge307IGNiKGZ1bmN0aW9uKGNhbiwgY2JzKSB7CgkvLyAJdGFyZ2V0Ll9maWd1cmUgPSBjYW4ub25sYXlvdXQuZmlndXJlKGV2ZW50LCBjYW4sIGNhbi5fdGFyZ2V0LCBmYWxzZSwge3RvcDogY2FuLnBhZ2Uub2Zmc2V0VG9wKHRhcmdldCkrdGFyZ2V0Lm9mZnNldEhlaWdodCwgbGVmdDogY2FuLnBhZ2Uub2Zmc2V0TGVmdCh0YXJnZXQpfSkKCS8vIAljYW4ub25maWd1cmUua2V5Ll9zaG93KGV2ZW50LCBjYW4sIG1ldGEubmFtZSwgY2JzLCB0YXJnZXQpLCBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgkvLyB9KSB9LAoJb25ibHVyOiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBjYiwgdGFyZ2V0KSB7CgkJdGFyZ2V0Ll9ob2xkIHx8IGNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgeyBkZWxldGUodGFyZ2V0Ll9maWd1cmUpLCB0YXJnZXQuX2NhbiAmJiB0YXJnZXQuX2Nhbi5jbG9zZSgpIH0pCgkJdGFyZ2V0Ll9ob2xkID0gZmFsc2UKCX0sCglvbmNsaWNrOiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBjYiwgdGFyZ2V0KSB7IGlmICh0YXJnZXQuX2ZpZ3VyZSkgeyB0YXJnZXQuX2ZpZ3VyZSA9IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgY2FuLmNvcmUuVmFsdWUodGFyZ2V0LCAiX2Nhbi5fdGFyZ2V0Iil8fHt9KTsgcmV0dXJuIH0gdGFyZ2V0Ll9maWd1cmUgPSB7fTsgY2IoZnVuY3Rpb24oY2FuLCBjYnMpIHsKCQl0YXJnZXQuX2ZpZ3VyZSA9IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbikKCQljYW4ub25maWd1cmUua2V5Ll9zaG93KGV2ZW50LCBjYW4sIG1ldGEubmFtZSwgY2JzLCB0YXJnZXQpLCBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgl9KSB9LAoJb25rZXlkb3duOiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBjYiwgdGFyZ2V0LCBsYXN0KSB7IHZhciBzdWIgPSB0YXJnZXQuX2NhbgoJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCWNhc2UgbGFuZy5TSElGVDogYnJlYWsKCQkJY2FzZSBsYW5nLkNPTlRST0w6IGJyZWFrCgkJCWNhc2UgbGFuZy5FTlRFUjoKCQkJCWlmIChldmVudC5jdHJsS2V5ICYmIGNhbi5wYWdlLnRhZ2lzKGh0bWwuVEVYVEFSRUEsIHRhcmdldCkpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmMobGFzdCkgJiYgbGFzdChldmVudCwgY2FuKQoJCQkJfQoJCQkJc3ViICYmIHN1Yi5jbG9zZSgpOyBicmVhawoJCQljYXNlIGxhbmcuRVNDQVBFOiBldmVudC50YXJnZXQuYmx1cigpOyBicmVhawoJCQljYXNlIGxhbmcuUFM6IGNhbi5vbmZpZ3VyZS5rZXkuX3Nob3coZXZlbnQsIHN1YiwgbWV0YS5uYW1lLCBudWxsLCB0YXJnZXQsIHRhcmdldC52YWx1ZStpY2UuUFMpOyBicmVhawoJCQljYXNlIGxhbmcuVEFCOiAKCQkJCWlmIChjYW4ucGFnZS50YWdpcyhodG1sLlRFWFRBUkVBLCB0YXJnZXQpKSB7CgkJCQkJY2FuLm9ua2V5bWFwLmluc2VydFRleHQoZXZlbnQudGFyZ2V0LCAiXHQiKSwgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCQkJYnJlYWsKCQkJCX0KCQkJZGVmYXVsdDoKCQkJCXN1YiAmJiBjYW4ub25tb3Rpb24uc2VsZWN0VGFibGVJbnB1dChldmVudCwgc3ViLCB0YXJnZXQsIGZ1bmN0aW9uKCkgewoJCQkJCWNhbi5vbmZpZ3VyZS5rZXkuX3Nob3coZXZlbnQsIHN1YiwgbWV0YS5uYW1lLCBudWxsLCB0YXJnZXQpCgkJCQl9KSwgY2FuLmJhc2UuaXNGdW5jKGxhc3QpICYmIGxhc3QoZXZlbnQsIGNhbikKCQl9Cgl9LAp9fSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC93aWtpL2ZlZWwuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWNhbi5wYXRoID0gY2FuLnJlcXVlc3QoKSwgY2FuLmxpc3QgPSBbXSwgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7CgkJCXZhbHVlLnBhdGgubGFzdEluZGV4T2YoaWNlLlBTKT09dmFsdWUucGF0aC5sZW5ndGgtMT8gY2FuLnBhdGguUHVzaCh2YWx1ZSk6IGNhbi5saXN0LnB1c2godmFsdWUpCgkJfSkKCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJY2FuLnVpID0gY2FuLm9ubGF5b3V0LmRpc3BsYXkoY2FuLCB0YXJnZXQpCgkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgY2FuLnBhdGgsIG51bGwsIGNhbi51aS5jb250ZW50KQoJCWNhbi5kaXJfcm9vdCA9IG1zZy5PcHRpb24oImRpcl9yb290IikKCgkJY2FuLkFjdGlvbigiaGVpZ2h0IiwgbXNnLk9wdGlvbigiaGVpZ2h0Iil8fCIxMDAiKQoJCWNhbi5BY3Rpb24oImxpbWl0IiwgbXNnLk9wdGlvbigibGltaXQiKXx8IjYiKQoJCWNhbi5BY3Rpb24oInJhdGUiLCBtc2cuT3B0aW9uKCJyYXRlIil8fCIxIikKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgoJCWNhbi5iZWdpbiA9IG1zZy5PcHRpb24oImJlZ2luIil8fCIwIgoJCWNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpCgl9LAoJX2ZpbGU6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgaW5kZXgpIHsgdmFyIHAgPSBsb2NhdGlvbi5ocmVmLmluZGV4T2YoImh0dHAiKSA9PSAwPyAiIjogImh0dHA6Ly9sb2NhbGhvc3Q6OTAyMCIKCQlyZXR1cm4gcGF0aC5pbmRleE9mKCJodHRwIikgPT0gMD8gcGF0aDogcCtjYW4uYmFzZS5QYXRoKCIvc2hhcmUvbG9jYWwiLCBjYW4uZGlyX3Jvb3R8fCIiLCBwYXRoKQoJfSwKCWZpbGU6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgaW5kZXgpIHsgcGF0aCA9IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIHBhdGgsIGluZGV4KQoJCXZhciBjYiA9IGNhbi5vbmZpZ3VyZVtjYW4uYmFzZS5FeHQocGF0aCldOyBjYW4uU3RhdHVzKCJmaWxlIiwgcGF0aCkKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5kaXNwbGF5LCBbY2IoY2FuLCBwYXRoLCBpbmRleCldKQoJfSwKCXBhZ2U6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgYmVnaW4sIGxpbWl0KSB7IGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCWJlZ2luID0gcGFyc2VJbnQoYmVnaW58fGNhbi5iZWdpbiksIGxpbWl0ID0gcGFyc2VJbnQobGltaXR8fGNhbi5BY3Rpb24oImxpbWl0IikpCgkJZm9yICh2YXIgaSA9IGJlZ2luOyBpIDwgYmVnaW4rbGltaXQ7IGkrKykgeyBsaXN0ICYmIGxpc3RbaV0gJiYgY2FuLm9uaW1wb3J0LmZpbGUoY2FuLCBsaXN0W2ldLnBhdGgsIGkpIH0KCQljYW4uU3RhdHVzKHtiZWdpbjogYmVnaW4sIGxpbWl0OiBsaW1pdCwgdG90YWw6IGNhbi5saXN0Lmxlbmd0aH0pCgl9LAp9LCBbIi9wbHVnaW4vbG9jYWwvd2lraS9mZWVsLmNzcyJdKQpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFtdLAoJcG5nOiBmdW5jdGlvbihjYW4sIHBhdGgsIGluZGV4KSB7IHJldHVybiBjYW4ub25maWd1cmUuaW1hZ2UoY2FuLCBwYXRoLCBpbmRleCkgfSwKCWpwZzogZnVuY3Rpb24oY2FuLCBwYXRoLCBpbmRleCkgeyByZXR1cm4gY2FuLm9uZmlndXJlLmltYWdlKGNhbiwgcGF0aCwgaW5kZXgpIH0sCglqcGVnOiBmdW5jdGlvbihjYW4sIHBhdGgsIGluZGV4KSB7IHJldHVybiBjYW4ub25maWd1cmUuaW1hZ2UoY2FuLCBwYXRoLCBpbmRleCkgfSwKCWltYWdlOiBmdW5jdGlvbihjYW4sIHBhdGgsIGluZGV4KSB7IHJldHVybiB7aW1nOiBwYXRoLCBoZWlnaHQ6IGNhbi5BY3Rpb24oImhlaWdodCIpLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCWNhbi5vbmRldGFpbC5faW5pdChjYW4sIGluZGV4KQoJfSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgeyBjYW4uU3RhdHVzKCJmaWxlIiwgcGF0aCkgfSwKCQlvbm1vdXNlb3ZlcjogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLlN0YXR1cygiZmlsZSIsIHBhdGgpIH0sCgl9IH0sCgoJdmlkZW86IGZ1bmN0aW9uKGNhbiwgcGF0aCkgeyB2YXIgYXV0byA9IGNhbi51c2VyLmlzTW9iaWxlJiZjYW4uQWN0aW9uKCJsaW1pdCIpIT0iMSI/IGZhbHNlOiB0cnVlLCBsb29wID0gdHJ1ZSwgdG90YWwgPSAwOyBmdW5jdGlvbiBjYihldmVudCkgeyB9CgkJcmV0dXJuIHt0eXBlOiAidmlkZW8iLCBzdHlsZToge2hlaWdodDogcGFyc2VJbnQoY2FuLkFjdGlvbigiaGVpZ2h0IikpfSwgY2xhc3NOYW1lOiAicHJldmlldyIsCgkJCWRhdGE6IHtzcmM6IHBhdGgsIGNvbnRyb2xzOiAiY29udHJvbHMiLCBhdXRvcGxheTogYXV0bywgbG9vcDogbG9vcCwgcGxheWJhY2tSYXRlOiBwYXJzZUZsb2F0KGNhbi5BY3Rpb24oInJhdGUiKSl9LAoJCQlvbmNvbnRleHRtZW51OiBjYiwgb25wbGF5OiBjYiwgb25wYXVzZTogY2IsIG9uZW5kZWQ6IGNiLAoJCQlvbm1vdXNlb3ZlcjogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLlN0YXR1cygiZmlsZSIsIHBhdGgpIH0sCgkJCW9ubG9hZGVkbWV0YWRhdGE6IGZ1bmN0aW9uKGV2ZW50KSB7IHRvdGFsID0gZXZlbnQudGltZVN0YW1wCgkJCQlldmVudC50YXJnZXQuY3VycmVudFRpbWUgPSBjYW4uX21zZy5jdXJyZW50VGltZSB8fCAwCgkJCX0sIG9ubG9hZGVkZGF0YTogY2IsIG9udGltZXVwZGF0ZTogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5TdGF0dXMoImZpbGUiKSA9PSBwYXRoICYmIGNhbi5TdGF0dXMoInBvc2l0aW9uIiwgY2FuLm9uZXhwb3J0LnBvc2l0aW9uKGNhbiwgKGNhbi5fbXNnLmN1cnJlbnRUaW1lPWV2ZW50LnRhcmdldC5jdXJyZW50VGltZSktMSwgZXZlbnQudGFyZ2V0LmR1cmF0aW9uKSkKCQkJfSwKCQl9Cgl9LAoJbXA0OiBmdW5jdGlvbihjYW4sIHBhdGgpIHsgcmV0dXJuIGNhbi5vbmZpZ3VyZS52aWRlbyhjYW4sIHBhdGgpIH0sCgltNHY6IGZ1bmN0aW9uKGNhbiwgcGF0aCkgeyByZXR1cm4gY2FuLm9uZmlndXJlLnZpZGVvKGNhbiwgcGF0aCkgfSwKCW1vdjogZnVuY3Rpb24oY2FuLCBwYXRoKSB7IHJldHVybiBjYW4ub25maWd1cmUudmlkZW8oY2FuLCBwYXRoKSB9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFsKCQlbImhlaWdodCIsIDEwMCwgMjAwLCA0MDAsIDYwMCwgODAwXSwKCQlbImxpbWl0IiwgMSwgMywgNiwgOSwgMTIsIDE1LCAyMCwgMzBdLAoJCVsicmF0ZSIsIDAuMSwgMC4yLCAwLjUsIDEsIDIsIDMsIDUsIDEwXSwKCV0sCgki5LiK5LiA6aG1IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgewoJCWNhbi5iZWdpbiA+IDAgJiYgKGNhbi5iZWdpbiAtPSBwYXJzZUludChjYW4uQWN0aW9uKCJsaW1pdCIpKSwgY2FuLm9uaW1wb3J0LnBhZ2UoY2FuLCBjYW4ubGlzdCkpCgl9LAoJIuS4i+S4gOmhtSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsKCQljYW4uYmVnaW4gKyBwYXJzZUludChjYW4uQWN0aW9uKCJsaW1pdCIpKSA8IGNhbi5saXN0Lmxlbmd0aCAmJiAoY2FuLmJlZ2luICs9IHBhcnNlSW50KGNhbi5BY3Rpb24oImxpbWl0IikpLCBjYW4ub25pbXBvcnQucGFnZShjYW4sIGNhbi5saXN0KSkKCX0sCgoJImhlaWdodCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgCgkJY2FuLkFjdGlvbigiaGVpZ2h0IiwgdmFsdWUpLCBjYW4ub25pbXBvcnQucGFnZShjYW4sIGNhbi5saXN0KQoJfSwKCSJsaW1pdCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgCgkJY2FuLkFjdGlvbigibGltaXQiLCB2YWx1ZSksIGNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpCgl9LAoJInJhdGUiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IAoJCWNhbi5BY3Rpb24oInJhdGUiLCB2YWx1ZSksIGNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpCgl9LAoKCWNob29zZUltYWdlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQljYW4udXNlci5hZ2VudC5jaG9vc2VJbWFnZShmdW5jdGlvbihsaXN0KSB7IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgW3tpbWc6IGl0ZW0sIGhlaWdodDogMjAwfV0pCgkJfSkgfSkKCX0sCn0pClZvbGNhbm9zKCJvbmRldGFpbCIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogWyLlhbPpl60iLCAi5LiL6L29IiwgIuWIoOmZpCIsICLkuIrkuIDkuKoiLCAi5LiL5LiA5LiqIiwgIuiuvue9ruWktOWDjyIsICLorr7nva7og4zmma8iLCAi5aSN5Yi26ZO+5o6lIl0sIF9pbml0OiBmdW5jdGlvbihjYW4sIGluZGV4KSB7CgkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwge3R5cGU6ICJzdG9yeSBmZWVsIGZsb2F0In0sIFtdLCBmdW5jdGlvbihzdWIpIHsgY2FuLnN1YiA9IHN1YgoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHJldHVybiBjYW4ucnVuKGV2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkgfQoKCQkJc3ViLmdldEFjdGlvblNpemUoZnVuY3Rpb24obXNnLCBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpIHsKCQkJCXN1Yi5wYWdlLk1vZGlmeShzdWIsIHN1Yi5fdGFyZ2V0LCB7c3R5bGU6IHtsZWZ0OiBsZWZ0LCB0b3A6IHRvcH19KQoJCQkJc3ViLnBhZ2UuTW9kaWZ5KHN1Yiwgc3ViLl9vdXRwdXQsIHtzdHlsZTogeyJtYXgtd2lkdGgiOiB3aWR0aCwgIm1heC1oZWlnaHQiOiBoZWlnaHR9fSkKCQkJCXN1Yi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgY2FuLm9uZGV0YWlsLmxpc3QsIHN1Yi5fYWN0aW9uLCBjYW4ub25kZXRhaWwpCgoJCQkJY2FuLm9yZGVyID0gaW5kZXgsIGNhbi5zaG93ID0gZnVuY3Rpb24ob3JkZXIpIHsKCQkJCQlwYXRoID0gY2FuLm9uaW1wb3J0Ll9maWxlKGNhbiwgY2FuLmxpc3Rbb3JkZXJdLnBhdGgpCgkJCQkJc3ViLnBhZ2UuQXBwZW5kcyhzdWIsIHN1Yi5fb3V0cHV0LCBbe2ltZzogcGF0aCwgc3R5bGU6IHsibWF4LXdpZHRoIjogd2lkdGgsICJtYXgtaGVpZ2h0IjogaGVpZ2h0LTIqaHRtbC5BQ1RJT05fSEVJR0hUfX1dKQoJCQkJCXN1Yi5TdGF0dXMoImJlZ2luIiwgb3JkZXIrMStpY2UuUFMrY2FuLmxpc3QubGVuZ3RoKSwgc3ViLlN0YXR1cygiZmlsZSIsIHBhdGgpCgkJCQl9LCBjYW4uc2hvdyhjYW4ub3JkZXIpCgkJCX0pCgkJfSwgZG9jdW1lbnQuYm9keSkKCX0sCgki5YWz6ZetIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uc3ViLl90YXJnZXQpIH0sCgki5LiL6L29IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4udXNlci5kb3dubG9hZChjYW4sIHBhdGggPSBjYW4ub25pbXBvcnQuX2ZpbGUoY2FuLCBjYW4ubGlzdFtjYW4ub3JkZXJdLnBhdGgpKSB9LAoJIuWIoOmZpCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlJFTU9WRSwgY2FuLmxpc3RbY2FuLm9yZGVyXS5wYXRoXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0KGNhbiwgIuWIoOmZpOaIkOWKnyIpIH0sIHRydWUpCgl9LAoJIuS4iuS4gOS4qiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9yZGVyID4gMD8gY2FuLnNob3coLS1jYW4ub3JkZXIpOiBjYW4udXNlci50b2FzdChjYW4sICLlt7Lnu4/mmK/nrKzkuIDlvKDllaYhIikgfSwKCSLkuIvkuIDkuKoiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vcmRlciA8IGNhbi5saXN0Lmxlbmd0aC0xPyBjYW4uc2hvdygrK2Nhbi5vcmRlcik6IGNhbi51c2VyLnRvYXN0KGNhbiwgIuW3sue7j+aYr+acgOWQjuS4gOW8oOWVpiEiKSB9LAoJIuiuvue9ruWktOWDjyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB7dXJsOiBjYW4ub25pbXBvcnQuX2ZpbGUoY2FuLCBjYW4ubGlzdFtjYW4ub3JkZXJdLnBhdGgpfSkKCQljYW4uc2VhcmNoKGV2ZW50LCBbIkhlYWRlci5vbmltcG9ydC5hdmF0YXIiXSwgbnVsbCwgdHJ1ZSkKCX0sCgki6K6+572u6IOM5pmvIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHt1cmw6IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIGNhbi5saXN0W2Nhbi5vcmRlcl0ucGF0aCl9KQoJCWNhbi5zZWFyY2goZXZlbnQsIFsiSGVhZGVyLm9uaW1wb3J0LmJhY2tncm91bmQiXSwgbnVsbCwgdHJ1ZSkKCX0sCgki5aSN5Yi26ZO+5o6lIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgY2FuLm1pc2MuTWVyZ2VVUkwoY2FuLCB7X3BhdGg6IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIGNhbi5saXN0W2Nhbi5vcmRlcl0ucGF0aCl9LCB0cnVlKSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyJiZWdpbiIsICJsaW1pdCIsICJ0b3RhbCIsICJwb3NpdGlvbiIsICJmaWxlIl0sCglwb3NpdGlvbjogZnVuY3Rpb24oY2FuLCBpbmRleCwgdG90YWwpIHsgdG90YWwgPSB0b3RhbCB8fCBjYW4ubWF4CgkJcmV0dXJuIHBhcnNlSW50KChpbmRleCsxKSoxMDAvdG90YWwpKyIlIisiID0gIisocGFyc2VJbnQoaW5kZXgpKzEpK2ljZS5QUytwYXJzZUludCh0b3RhbCkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vc3RvcnkvbWVkaWEuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCn19KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaTjeS9nOaVsOaNriIsIGxpc3Q6IFsi5omT5byA5bGP5bmVIiwgIuaJk+W8gOaRhOWDjyIsICLmiZPlvIDlvZXpn7MiXSwKCV9hY3Rpb246IGZ1bmN0aW9uKGNhbiwgY2IpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgW3t2aWV3OiBodG1sLkFDVElPTn0sIHt2aWV3OiBodG1sLk9VVFBVVCwgbGlzdDogW3t0eXBlOiBodG1sLlZJREVPLCBzdHlsZToge3dpZHRoOiBjYW4uQ29uZldpZHRoKCl9LCBfaW5pdDogZnVuY3Rpb24oaXRlbSkgewoJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IGNiKGl0ZW0sIHVpKSB9KQoJCX19XX1dKQoKCQljYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIHsKCQkJIuWFs+mXrSI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4uY29yZS5MaXN0KHVpLnN0cmVhbS5nZXRUcmFja3MoKSwgZnVuY3Rpb24odHJhY2spIHsgdHJhY2suc3RvcCgpIH0pCgkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5hY3Rpb24pLCBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5vdXRwdXQpCgkJCX0sCgkJCSLmipPmi40iOiBmdW5jdGlvbihldmVudCkgewoJCQkJdmFyIGNhbnZhcyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLm91dHB1dCwgW3t0eXBlOiBodG1sLkNBTlZBU31dKS5maXJzdDsgY2FudmFzLmdldENvbnRleHQoIjJkIikuZHJhd0ltYWdlKHVpLnZpZGVvLCAwLCAwKQoJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdWkub3V0cHV0LCBbe2ltZzogY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyksIHN0eWxlOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKX19XSkKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbnZhcykKCQkJfSwKCQkJIuW9leWItiI6IGZ1bmN0aW9uKGV2ZW50KSB7IHVpLmJsb2JzID0gW10KCQkJCXVpLm1lZGlhUmVjb3JkZXIgPSBuZXcgTWVkaWFSZWNvcmRlcih1aS5zdHJlYW0sIHttaW1lVHlwZTogJ3ZpZGVvL3dlYm0nfSkKCQkJCXVpLm1lZGlhUmVjb3JkZXIub25kYXRhYXZhaWxhYmxlID0gKGUpID0+IHsgdWkuYmxvYnMucHVzaChlLmRhdGEpLCBjYW4ubWlzYy5Mb2codWkuYmxvYnMubGVuZ3RoKSB9CgkJCQl1aS5tZWRpYVJlY29yZGVyLnN0YXJ0KDEwMCkKCQkJfSwKCQkJIuWbnuaUviI6IGZ1bmN0aW9uKGV2ZW50KSB7IHZhciBibG9icyA9IHVpLmJsb2JzOyB1aS5ibG9icyA9IFtdCgkJCQl2YXIgdmlkZW8gPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB1aS5vdXRwdXQsIFt7dHlwZTogaHRtbC5WSURFTywgc3R5bGU6IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpfX1dKS52aWRlbwoJCQkJdmlkZW8uc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihibG9icywge3R5cGUgOiAndmlkZW8vd2VibSd9KSksIHZpZGVvLnBsYXkoKQoJCQl9LAoJCQki5LiL6L29IjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi51c2VyLmRvd25sb2FkKGNhbiwgVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYih1aS5ibG9icywge3R5cGU6ICd2aWRlby93ZWJtJ30pKSwgJ3JlY29yZC53ZWJtJykKCQkJfSwKCQl9KQoJfSwKCSLmiZPlvIDlsY/luZUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLm9uYWN0aW9uLl9hY3Rpb24oY2FuLCBmdW5jdGlvbihpdGVtLCB1aSkgewoJCQluYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYSh7dmlkZW86IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpfX0pLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7IHVpLnN0cmVhbSA9IHN0cmVhbQoJCQkJaXRlbS5zcmNPYmplY3QgPSBzdHJlYW0sIGl0ZW0ub25sb2FkZWRtZXRhZGF0YSA9IGZ1bmN0aW9uKGUpIHsgaXRlbS5wbGF5KCkgfQoJCQl9KS5jYXRjaChmdW5jdGlvbihlcnIpIHsgY2FuLm1pc2MuTG9nKGVyci5uYW1lICsgIjogIiArIGVyci5tZXNzYWdlKSB9KQoJCX0pCgl9LAoJIuaJk+W8gOaRhOWDjyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25hY3Rpb24uX2FjdGlvbihjYW4sIGZ1bmN0aW9uKGl0ZW0sIHVpKSB7CgkJCW5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHt2aWRlbzoge3dpZHRoOiBjYW4uQ29uZldpZHRoKCl9fSkudGhlbihmdW5jdGlvbihzdHJlYW0pIHsgdWkuc3RyZWFtID0gc3RyZWFtCgkJCQlpdGVtLnNyY09iamVjdCA9IHN0cmVhbSwgaXRlbS5vbmxvYWRlZG1ldGFkYXRhID0gZnVuY3Rpb24oZSkgeyBpdGVtLnBsYXkoKSB9CgkJCX0pLmNhdGNoKGZ1bmN0aW9uKGVycikgeyBjYW4ubWlzYy5Mb2coZXJyLm5hbWUgKyAiOiAiICsgZXJyLm1lc3NhZ2UpIH0pCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW119KQoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vc3RvcnkvcGllLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ucmVxdWlyZShbIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmpzIiwgIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3L3BhdGguanMiXSwgZnVuY3Rpb24oKSB7CgkJCXZhciBoZWlnaHQgPSBtc2cuT3B0aW9uKGh0bWwuSEVJR0hUKXx8Y2FuLkNvbmZIZWlnaHQoKQoJCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4ub25pbXBvcnQuX3Nob3coY2FuLCBtc2cpCgkJCXZhciByID0gaGVpZ2h0LzItMjAsIG1hcmdpbiA9IDIwOyBjYW4uc3ZnLlZhbChodG1sLldJRFRILCAyKihyK21hcmdpbikpLCBjYW4uc3ZnLlZhbChodG1sLkhFSUdIVCwgMioocittYXJnaW4pKQoJCQljYW4uX2FyZ3MgPSBjYW4uYmFzZS5Db3B5KHtmaWVsZDogInZhbHVlIn0sIGNhbi5iYXNlLlBhcnNlVVJMKGNhbi5fZGlzcGxheSkpCgkJCWNhbi5vbmltcG9ydC5fZHJhdyhjYW4sIG1zZywgY2FuLl9hcmdzLmZpZWxkLCByK21hcmdpbiwgcittYXJnaW4sIHIsIG1hcmdpbiwgMCkKCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLnByb2plY3QpLCBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIG51bGwsIGNhbi51aS5wcm9qZWN0KQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QsIHRydWUpCgkJCXZhciByZXN0ID0gY2FuLkNvbmZXaWR0aCgpLWhlaWdodAoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkucHJvamVjdCwge3N0eWxlOiB7Im1heC13aWR0aCI6IHJlc3R9fSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLnByb2plY3QsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyLCBpbmRleCkgewoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdHIsIHtvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZyksIGNhbi5vbmltcG9ydC5fZHJhdyhjYW4sIG1zZywgY2FuLl9hcmdzLmZpZWxkLCByK21hcmdpbiwgcittYXJnaW4sIHIsIG1hcmdpbiwgaW5kZXgtMSkKCQkJCX19KQoJCQl9KQoJCX0pCgl9LAoJX2RyYXc6IGZ1bmN0aW9uKGNhbiwgbXNnLCBmaWVsZCwgeCwgeSwgciwgbWFyZ2luLCB3aGljaCkgewoJCWZ1bmN0aW9uIHBvcyh4LCB5LCByLCBhbmdsZSkgeyBhbmdsZSAtPSA5MAoJCQlyZXR1cm4gW3ggKyByICogTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKSwgeSArIHIgKiBNYXRoLnNpbihhbmdsZSAqIE1hdGguUEkgLyAxODApXQoJCX0KCQlmdW5jdGlvbiBwaWUoeCwgeSwgciwgYmVnaW4sIHNwYW4sIGNvbG9yLCBjYikgeyBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7c2hhcGU6ICJwYXRoIiwgc3R5bGU6IHsKCQkJInN0cm9rZS13aWR0aCI6IDEsIHN0cm9rZTogY29sb3IsIGZpbGw6IGNvbG9yLCBkOiBjYW4uYmFzZS5qb2lucyhbCgkJCQlbIk0iLCB4LCB5XSwgWyJMIl0uY29uY2F0KHBvcyh4LCB5LCByLCBiZWdpbikpLCBbIkEiLCByLCByLCAiMCIsIHNwYW4+MTgwPyAiMSI6ICIwIiwgIjEiXS5jb25jYXQocG9zKHgsIHksIHIsIGJlZ2luK3NwYW4pKSwgWyJaIl0KCQkJXSwgaWNlLlNQLCBpY2UuRlMpLAoJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCkKCQl9IH0pIH0KCgkJdmFyIHRvdGFsID0gMDsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7IHRvdGFsICs9IHBhcnNlSW50KHZhbHVlW2ZpZWxkXSkgfSkKCQl2YXIgY29sb3IgPSBbY2xpLlJFRCwgY2xpLllFTExPVywgY2xpLkdSRUVOLCBjbGkuQ1lBTiwgY2xpLkJMVUUsIGNsaS5QVVJQTEUsIGNsaS5XSElURSwgY2xpLkJMQUNLXQoJCXZhciBiZWdpbiA9IDA7IG1zZ1siY29sb3IiXSA9IFtdLCBtc2dbIndlaWdodCJdID0gW10sIG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsgdmFyIHNwYW4gPSBwYXJzZUludCh2YWx1ZVtmaWVsZF0pL3RvdGFsKjM2MAoJCQl2YXIgcCA9IGluZGV4PT13aGljaD8gcG9zKHgsIHksIG1hcmdpbiwgYmVnaW4rc3Bhbi8yKTogW3gsIHldOyBpbmRleCA9PSB3aGljaCAmJiBjYW4uU3RhdHVzKHZhbHVlKQoJCQl2YXIgYyA9IGNvbG9yW2luZGV4JWNvbG9yLmxlbmd0aF07IHBpZShwWzBdLCBwWzFdLCByLCBiZWdpbiwgc3BhbiwgYywgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWlmIChpbmRleCA9PSBjYW4uX2xhc3QpIHsgcmV0dXJuIH0gY2FuLl9sYXN0ID0gaW5kZXgKCQkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpLCBjYW4uc3ZnLlZhbHVlKCJjb3VudCIsIDApCgkJCQljYW4ub25pbXBvcnQuX2RyYXcoY2FuLCBtc2csIGZpZWxkLCB4LCB5LCByLCBtYXJnaW4sIGluZGV4KQoJCQkJY2FuLm9uaW1wb3J0Ll9wcm9maWxlKGNhbiwgZXZlbnQudGFyZ2V0KQoJCQl9KSwgYmVnaW4gKz0gc3BhbiwgbXNnLlB1c2goImNvbG9yIiwgJzxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOicrYysnIj4gICAgIDwvc3Bhbj4nKQoJCQltc2cuUHVzaCgid2VpZ2h0IiwgcGFyc2VJbnQocGFyc2VJbnQodmFsdWVbZmllbGRdKSoxMDAwMC90b3RhbCkvMTAwKyIlIikKCQl9KQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9pbnB1dC9kYXRlLmpzIgpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIuaOp+S7tuivpuaDhSIsIGxpc3Q6IFtdLCBkYXRlOiB7b25jbGljazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbWV0YSwgY2IsIHRhcmdldCkgeyBjYihmdW5jdGlvbihjYW4sIGNicykgewoJZnVuY3Rpb24gc2V0KG5vdykgeyB0YXJnZXQudmFsdWUgPSBjYW4udXNlci50aW1lKGNhbiwgbm93KSwgY2FuLmNsb3NlKCksIG1ldGEgJiYgbWV0YS5hY3Rpb24gPT0gaWNlLkFVVE8gJiYgY2FuLnJ1bih7fSkgfQoKCS8vIOa3u+WKoOaOp+S7tgoJdmFyIG5vdyA9IHRhcmdldC52YWx1ZT8gbmV3IERhdGUodGFyZ2V0LnZhbHVlKTogbmV3IERhdGUoKQoJY2FuLl90cmFucyA9IHsidG9kYXkiOiAi5LuK5aSpIiwgIm5leHQiOiAi5LiL5LiA5pyIIiwgInByZXYiOiAi5LiK5LiA5pyIIn0KCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fYWN0aW9uKSwgY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBbY2xpLkNMT1NFLAoJCVsiaG91ciJdLmNvbmNhdChjYW4uY29yZS5MaXN0KDI0KSksIFsibWludXRlIl0uY29uY2F0KGNhbi5jb3JlLkxpc3QoMCwgNjAsIDUpKSwgWyJzZWNvbmQiXS5jb25jYXQoY2FuLmNvcmUuTGlzdCgwLCA2MCwgNSkpLAoJCSJ0b2RheSIsICIiLCAicHJldiIsIFsieWVhciJdLmNvbmNhdChjYW4uY29yZS5MaXN0KG5vdy5nZXRGdWxsWWVhcigpIC0gMTAsIG5vdy5nZXRGdWxsWWVhcigpICsgMTApKSwKCQlbIm1vbnRoIl0uY29uY2F0KGNhbi5jb3JlLkxpc3QoMSwgMTMpKSwgIm5leHQiLAoJXSwgY2FuLl9hY3Rpb24sIHsgY2xvc2U6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5jbG9zZSgpIH0sCgkJImhvdXIiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0SG91cnMocGFyc2VJbnQodmFsdWUpfHwwKSwgc2hvdyhub3cpIH0sCgkJIm1pbnV0ZSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgIG5vdy5zZXRNaW51dGVzKHBhcnNlSW50KHZhbHVlKXx8MCksIHNob3cobm93KSB9LAoJCSJzZWNvbmQiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0U2Vjb25kcyhwYXJzZUludCh2YWx1ZSl8fDApLCBzaG93KG5vdykgfSwKCQkidG9kYXkiOiBmdW5jdGlvbihldmVudCkgeyAgbm93ID0gbmV3IERhdGUoKSwgc2V0KHNob3cobm93KSkgfSwKCgkJInByZXYiOiBmdW5jdGlvbihldmVudCkgeyAgbm93LnNldE1vbnRoKG5vdy5nZXRNb250aCgpLTEpLCBzaG93KG5vdykgfSwKCQkieWVhciI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgIG5vdy5zZXRGdWxsWWVhcihwYXJzZUludCh2YWx1ZSkpLCBzaG93KG5vdykgfSwKCQkibW9udGgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0TW9udGgocGFyc2VJbnQodmFsdWUpLTEpLCBzaG93KG5vdykgfSwKCQkibmV4dCI6IGZ1bmN0aW9uKGV2ZW50KSB7ICBub3cuc2V0TW9udGgobm93LmdldE1vbnRoKCkrMSksIHNob3cobm93KSB9LAoKCQki6ZqP5py6IjogZnVuY3Rpb24oZXZlbnQpIHsgIG5vdy5zZXREYXRlKChNYXRoLnJhbmRvbSgpICogMTAwIC0gNTApICsgbm93LmdldERhdGUoKSksIHNob3cobm93KSB9LAoJCSLliY3kuIDlubQiOiBmdW5jdGlvbihldmVudCkgeyAgbm93LnNldEZ1bGxZZWFyKG5vdy5nZXRGdWxsWWVhcigpLTEpLCBzaG93KG5vdykgfSwKCQki5ZCO5LiA5bm0IjogZnVuY3Rpb24oZXZlbnQpIHsgIG5vdy5zZXRGdWxsWWVhcihub3cuZ2V0RnVsbFllYXIoKSsxKSwgc2hvdyhub3cpIH0sCgl9KQoKCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fc3RhdHVzKQoJY2FuLl90YWJsZSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCBjYW4uX291dHB1dCwgW3t2aWV3OiBbY2hhdC5DT05URU5ULCBodG1sLlRBQkxFXX1dKS5maXJzdAoJdmFyIHRvZGF5ID0gbmV3IERhdGUoKTsgZnVuY3Rpb24gc2hvdyhub3cpIHsKCQkvLyDorr7nva7mjqfku7YKCQljYW4uQWN0aW9uKCJ5ZWFyIiwgbm93LmdldEZ1bGxZZWFyKCkpCgkJY2FuLkFjdGlvbigibW9udGgiLCBub3cuZ2V0TW9udGgoKSsxKQoJCWNhbi5BY3Rpb24oImhvdXIiLCBub3cuZ2V0SG91cnMoKSkKCQljYW4uQWN0aW9uKCJtaW51dGUiLCBwYXJzZUludChub3cuZ2V0TWludXRlcygpLzUpKjUpCgkJY2FuLkFjdGlvbigic2Vjb25kIiwgcGFyc2VJbnQobm93LmdldFNlY29uZHMoKS81KSo1KQoKCQkvLyDorr7nva7nu4Tku7YKCQljYW4ucGFnZS5BcHBlbmRzKGNhbiwgY2FuLl90YWJsZSwgW3t0aDogWyLml6UiLCAi5LiAIiwgIuS6jCIsICLkuIkiLCAi5ZubIiwgIuS6lCIsICLlha0iXX1dKQoJCXZhciB0cjsgZnVuY3Rpb24gYWRkKGRheSwgdHlwZSkgeyBpZiAoZGF5LmdldERheSgpID09IDApIHsgdHIgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX3RhYmxlLCBbe3R5cGU6IGh0bWwuVFJ9XSkubGFzdCB9CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRyLCBbe3RleHQ6IFtkYXkuZ2V0RGF0ZSgpLCBodG1sLlRELCBjYW4uYmFzZS5UaW1lKHRvZGF5LCAiJXktJW0tJWQiKSA9PSBjYW4uYmFzZS5UaW1lKGRheSwgIiV5LSVtLSVkIik/IGh0bWwuU0VMRUNUOiB0eXBlXSwKCQkJCWRhdGFzZXQ6IHtkYXRlOiBkYXkuZ2V0VGltZSgpfSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlzZXQobm93ID0gbmV3IERhdGUocGFyc2VJbnQoZXZlbnQudGFyZ2V0LmRhdGFzZXQuZGF0ZSkpKQoJCQkJfSwKCQkJfV0pCgkJfQoKCQkvLyDml7bpl7TljLrpl7QKCQl2YXIgb25lID0gbmV3IERhdGUobm93KTsgb25lLnNldERhdGUoMSkKCQl2YXIgZW5kID0gbmV3IERhdGUobm93KTsgZW5kLnNldE1vbnRoKG5vdy5nZXRNb250aCgpKzEpLCBlbmQuc2V0RGF0ZSgxKQoJCXZhciBoZWFkID0gbmV3IERhdGUob25lKTsgaGVhZC5zZXREYXRlKG9uZS5nZXREYXRlKCktb25lLmdldERheSgpKQoJCXZhciB0YWlsID0gbmV3IERhdGUoZW5kKTsgdGFpbC5zZXREYXRlKGVuZC5nZXREYXRlKCkrNy1lbmQuZ2V0RGF5KCkpCgoJCS8vIOaXtumXtOW6j+WIlwoJCWZvciAodmFyIGRheSA9IG5ldyBEYXRlKGhlYWQpOyBkYXkgPCBvbmU7IGRheS5zZXREYXRlKGRheS5nZXREYXRlKCkrMSkpIHsgYWRkKGRheSwgbWRiLlBSRVYpIH0KCQlmb3IgKHZhciBkYXkgPSBuZXcgRGF0ZShvbmUpOyBkYXkgPCBlbmQ7IGRheS5zZXREYXRlKGRheS5nZXREYXRlKCkrMSkpIHsgYWRkKGRheSwgbWRiLk1BSU4pIH0KCQlmb3IgKHZhciBkYXkgPSBuZXcgRGF0ZShlbmQpOyBlbmQuZ2V0RGF5KCkgIT0gMCAmJiBkYXkgPCB0YWlsOyBkYXkuc2V0RGF0ZShkYXkuZ2V0RGF0ZSgpKzEpKSB7IGFkZChkYXksIG1kYi5ORVhUKSB9CgoJCXJldHVybiBub3cKCX0gc2hvdyhub3cpLCBjYW4ub25sYXlvdXQuZmlndXJlKGV2ZW50LCBjYW4pLCBjYW4uYmFzZS5pc0Z1bmMoY2JzKSAmJiBjYnMoY2FuKQp9KX19IH0sIFsiIl0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9zbmlwcGV0LmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKQoJCWlmIChtc2cuT3B0aW9uKCJjb250ZW50IikpIHsKCQkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHtpbmRleDogIndlYi5jb2RlLnZpbWVyIiwgc3R5bGU6ICJmdWxsIn0sIGZ1bmN0aW9uKHN1YikgewoJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgcmVzID0gY2FuLnJlcXVlc3QoZXZlbnQpCgkJCQkJaWYgKGNtZHNbMV0gPT0gInBsdWdpbiIpIHsKCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgWyJhY3Rpb24iLCAidmltZXIiXSwgY21kcyksIGNiLCB0cnVlKQoJCQkJCQlyZXR1cm4KCQkJCQl9CgkJCQkJaWYgKGNtZHNbMV0gPT0gIm1haW4uZ28iKSB7IHJlcy5FY2hvKG1zZy5PcHRpb24oImNvbnRlbnQiKSkKCQkJCQkJY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsgY2FuLnN1YiAmJiBjYW4uc3ViLm9uYWN0aW9uWyLpobnnm64iXSh7fSwgY2FuLnN1YikgfSkKCQkJCQl9CgkJCQkJY2IocmVzKSwgY2FuLnN1YiA9IGNhbi5jb3JlLlZhbHVlKHN1YiwgIl9vdXRwdXRzLi0xIikKCQkJCX0KCQkJfSwgY2FuLl9vdXRwdXQpCgkJCXJldHVybgoJCX0KCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpCgkJY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgbXNnKQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmk43kvZzmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7Cgl9LAoJcnVuOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2cpIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgImdvIiwgImhpLmdvIiwgY2FuLnN1Yi5vbmV4cG9ydC5jb250ZW50KGNhbi5zdWIpXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZykKCQl9LCB0cnVlKQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7Cn19KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL2NoYXQvbWVkaWEuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWNhbi51aSA9IGNhbi5vbmxheW91dC5kaXNwbGF5KGNhbiwgdGFyZ2V0KQoJCWNhbi51aS5jYW52YXMgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkuZGlzcGxheSwgW3t0eXBlOiAiY2FudmFzIiwgd2lkdGg6IDMyMCwgaGVpZ2h0OiAyNDAsIHN0eWxlOiB7ZGlzcGxheTogIm5vbmUifX1dKS5maXJzdAoKCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkgewoJCQlyZXR1cm4ge3RleHQ6IFt2YWx1ZSwgInRkIl0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4uc3VwLm9uYWN0aW9uLmNoYW5nZShldmVudCwgY2FuLnN1cCwga2V5LCB2YWx1ZSwgZnVuY3Rpb24obXNnKSB7CgkJCQkJY2FuLnJ1bihldmVudCkKCQkJCX0pCgkJCX19CgkJfSwgY2FuLnVpLmNvbnRlbnQpCgoJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZy5SZXN1bHQoKSwgY2FuLnVpLmRpc3BsYXkpCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgl9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaTjeS9nOaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCX0sCgoJb3BlbjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCW5hdmlnYXRvci5nZXRVc2VyTWVkaWEoe3ZpZGVvOiB7d2lkdGg6IDMyMCwgaGVpZ2h0OiAyNDB9fSwgZnVuY3Rpb24oc3RyZWFtKSB7CgkJCXZhciB2aWRlbyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5jb250ZW50LCAidmlkZW8iKQoJCQl2aWRlby5zcmNPYmplY3QgPSBzdHJlYW0sIHZpZGVvLnBsYXkoKQoJCQljYW4udWkudmlkZW8gPSB2aWRlbwoJCX0sIGZ1bmN0aW9uKGVycm9yKSB7CgkJCWNhbi5taXNjLkxvZygib3BlbiBjYW1lcmEiLCBlcnJvcikKCQl9KQoJfSwKCXNuYXBzaG90OiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVpLmNhbnZhcy5nZXRDb250ZXh0KCIyZCIpLmRyYXdJbWFnZShjYW4udWkudmlkZW8sIDAsIDApCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmRpc3BsYXksIFt7dHlwZTogImltZyIsIHNyYzogY2FuLnVpLmNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3dlYnAnKX1dKQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXSwgCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY2hhdC90cmFucy5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQljYW4uZnJvbSA9IGNhbi5vbmltcG9ydC5fcGx1Z2luKGNhbiwgbmZzLkRJUiwgaHRtbC5MRUZULCAiZnJvbSIsICJ0byIpCgkJY2FuLnRvID0gY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBuZnMuRElSLCBodG1sLlJJR0hULCAidG8iLCAiZnJvbSIpCgkJY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBuZnMuVFJBU0gsIGh0bWwuTEVGVCwgImZyb20iKQoJCWNhbi5vbmltcG9ydC5fcGx1Z2luKGNhbiwgbmZzLlRSQVNILCBodG1sLlJJR0hULCAidG8iKQoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGNhbiwgaW5kZXgsIHBvcywgZnJvbSwgdG8pIHsKCQlyZXR1cm4gY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHt0eXBlOiBjaGF0LlNUT1JZLCBpbmRleDogaW5kZXh9LCBmdW5jdGlvbihzdWIpIHsKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl90YXJnZXQsIHtzdHlsZToge2Zsb2F0OiBwb3MsIGNsZWFyOiBwb3N9fSkKCQkJc3ViLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCkvMikKCQkJc3ViLl9sZWdlbmQuaW5uZXJIVE1MID0gY2FuLk9wdGlvbihmcm9tKStpY2UuU1AraW5kZXgKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl9vdXRwdXQsIHtzdHlsZTogeyJtYXgtd2lkdGgiOiBjYW4uQ29uZihodG1sLldJRFRIKS8yfX0pCgoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCQlpZiAoY2FuLm9uYWN0aW9uW2NtZHNbMV1dKSB7IHJldHVybiBjYW4ub25hY3Rpb25bY21kc1sxXV0oY2FuLCBmcm9tLCB0bywgZXZlbnQsIGNtZHMsIGNiKSB9CgoJCQkJdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KGV2ZW50LCB7X3BvZDogY2FuLk9wdGlvbihmcm9tKX0pCgkJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgaW5kZXhdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7Cgl9LAoJc2VuZDogZnVuY3Rpb24oY2FuLCBmcm9tLCB0bywgZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBfZnJvbSA9IGNhbltmcm9tXSwgX3RvID0gY2FuW3RvXQoJCXZhciBwYXRoID0gY2FuLnJlcXVlc3QoZXZlbnQpLk9wdGlvbihuZnMuUEFUSCkKCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtfaGFuZGxlOiBpY2UuVFJVRSwKCQkJZnJvbTogY2FuLk9wdGlvbihmcm9tKSwgZnJvbV9wYXRoOiBwYXRoLAoJCQl0bzogY2FuLk9wdGlvbih0byksIHRvX3BhdGg6IF90by5PcHRpb24obmZzLlBBVEgpK3BhdGguc3BsaXQoaWNlLlBTKS5wb3AoKSwKCQl9KQoJCWNhbi5ydW4oZXZlbnQsIGNtZHMsIGZ1bmN0aW9uKCkgeyBfdG8uVXBkYXRlKCkgfSwgdHJ1ZSkKCX0sCn0pCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jaGF0L3d4LmpzIgpWb2xjYW5vcygib25hY3Rpb24iLCB7c291cmNlOiBmdW5jdGlvbihjYW4sIG1zZykgewoJY2FuLnJlcXVpcmUoWyJodHRwczovL3Jlcy53eC5xcS5jb20vb3Blbi9qcy9qd2VpeGluLTEuNi4wLmpzIl0sIGZ1bmN0aW9uKGNhbikgewoJCXd4LmNvbmZpZyh7ZGVidWc6IG1zZy5PcHRpb24oImRlYnVnIikgPT0gaWNlLlRSVUUsCgkJCWFwcElkOiBtc2cuT3B0aW9uKCJhcHBpZCIpLCBzaWduYXR1cmU6IG1zZy5PcHRpb24oInNpZ25hdHVyZSIpLAoJCQlub25jZVN0cjogbXNnLk9wdGlvbigibm9uY2VzdHIiKSwgdGltZXN0YW1wOiBtc2cuT3B0aW9uKCJ0aW1lc3RhbXAiKSwKCgkJCWpzQXBpTGlzdDogY2FuLmNvcmUuSXRlbSh7CgkJCQlzY2FuUVJDb2RlOiBmdW5jdGlvbihjYikgeyB3eC5zY2FuUVJDb2RlKHtuZWVkUmVzdWx0OiBjYj8gMTogMCwgc2NhblR5cGU6IFsicXJDb2RlIiwiYmFyQ29kZSJdLCBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihyZXMucmVzdWx0U3RyLCBjYW4uYmFzZS5QYXJzZUpTT04ocmVzLnJlc3VsdFN0cikpCgkJCQl9IH0pIH0sCgkJCQlnZXRMb2NhdGlvbjogZnVuY3Rpb24oY2IpIHsgd3guZ2V0TG9jYXRpb24oe3R5cGU6ICJnY2owMiIsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHt0eXBlOiAiZ2NqMDIiLCBuYW1lOiAi5b2T5YmN5L2N572uIiwgdGV4dDogIuW9k+WJjeS9jee9riIsIGxhdGl0dWRlOiBwYXJzZUludChyZXMubGF0aXR1ZGUqMTAwMDAwKSwgbG9uZ2l0dWRlOiBwYXJzZUludChyZXMubG9uZ2l0dWRlKjEwMDAwMCkgfSkKCQkJCX0gfSkgfSwKCQkJCW9wZW5Mb2NhdGlvbjogZnVuY3Rpb24obXNnKSB7IHd4Lm9wZW5Mb2NhdGlvbih7CgkJCQkJbGF0aXR1ZGU6IHBhcnNlSW50KG1zZy5PcHRpb24oImxhdGl0dWRlIikpLzEwMDAwMCwKCQkJCQlsb25naXR1ZGU6IHBhcnNlSW50KG1zZy5PcHRpb24oImxvbmdpdHVkZSIpKS8xMDAwMDAsCgkJCQkJbmFtZTogbXNnLk9wdGlvbihtZGIuTkFNRSksIGFkZHJlc3M6IG1zZy5PcHRpb24obWRiLlRFWFQpLAoJCQkJCXNjYWxlOiBtc2cuT3B0aW9uKCJzY2FsZSIpfHwxNCwgaW5mb1VybDogbXNnLk9wdGlvbihtZGIuTElOSyksCgkJCQl9KSB9LAoJCQkJY2hvb3NlSW1hZ2U6IGZ1bmN0aW9uKGNiLCBjb3VudCkgeyB3eC5jaG9vc2VJbWFnZSh7Y291bnQ6IGNvdW50fHw5LCBzaXplVHlwZTogWydvcmlnaW5hbCcsICdjb21wcmVzc2VkJ10sIHNvdXJjZVR5cGU6IFsnYWxidW0nLCAnY2FtZXJhJ10sIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHJlcy5sb2NhbElkcykKCQkJCX0gfSkgfSwKCQkJfSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4gY2FuLnVzZXIuYWdlbnRba2V5XSA9IHZhbHVlLCBrZXkgfSksCgkJfSkKCQl3eC5lcnJvcihmdW5jdGlvbihlcnIpIHsgY2FuLnVzZXIudG9hc3QoZXJyLCAid3ggbG9hZCIpIH0pCgkJd3gucmVhZHkoZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZygicmVhZHkiKSB9KQoJfSkKfX0pCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jb2RlL2lubmVyL2Zhdm9yLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIF9pbml0OiBmdW5jdGlvbihjYW4sIGFyZ3MsIGNiKSB7CgljYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIHtpbmRleDogIndlYi5jb2RlLmZhdm9yIn0sIGZ1bmN0aW9uKHN1YikgewoJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQlpZiAoY2FuLm1pc2MucnVuQWN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwga2l0LkRpY3QoCgkJCQljb2RlLklOTkVSLCBmdW5jdGlvbihjbWRzKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBtc2cuT3B0aW9uKG5mcy5QQVRIKSwgbXNnLk9wdGlvbihuZnMuRklMRSksIG1zZy5PcHRpb24obmZzLkxJTkUpKQoJCQkJfSwKCQkJKSkpIHsgcmV0dXJuIH0KCgkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBjb2RlLkZBVk9SXSwgY21kcyksIGZ1bmN0aW9uKG1zZykgeyB2YXIgc3ViID0gbXNnLl9jYW4KCQkJCXN1Yi5vbm1vdGlvbi5jbGVhcihzdWIpLCBzdWIub25hcHBlbmQudGFibGUoc3ViLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKSB7CgkJCQkJaWYgKG1zZy5hcHBlbmQubGVuZ3RoID09IDIgJiYgbXNnLmFwcGVuZFswXSA9PSBtZGIuS0VZICYmIG1zZy5hcHBlbmRbMV0gPT0gbWRiLlZBTFVFKSB7CgkJCQkJCWlmIChrZXkgPT0gbWRiLlZBTFVFKSB7IGtleSA9IGxpbmUua2V5IH0KCQkJCQl9CgkJCQkJaWYgKGtleSAhPSBjdHguQUNUSU9OKSB7IHZhbHVlID0gc3ViLnBhZ2UucmVwbGFjZShzdWIsIHZhbHVlLCBpY2UuUFdELCAiIikgfQoKCQkJCQlyZXR1cm4ge3RleHQ6IFsiIiwgaHRtbC5URF0sIGxpc3Q6IFt7dGV4dDogW3ZhbHVlLCBodG1sLkRJVl19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldAoJCQkJCQlpZiAoW21kYi5aT05FLCBtZGIuSURdLmluZGV4T2Yoa2V5KSA+IC0xKSB7IHJldHVybiBzdWIub25hY3Rpb24uY2hhbmdlKGV2ZW50LCBzdWIsIGtleSwgdmFsdWUpIH0KCgkJCQkJCWlmICh0YXJnZXQudGFnTmFtZSA9PSAiSU5QVVQiICYmIHRhcmdldC50eXBlID09IGh0bWwuQlVUVE9OKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCwgbGluZSwgc3ViLk9wdGlvbigpKQoJCQkJCQkJcmV0dXJuIHN1Yi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCB0YXJnZXQubmFtZV0sIGZ1bmN0aW9uKG1zZykgeyBzdWIucnVuKCkgfSwgdHJ1ZSkKCQkJCQkJfQoKCQkJCQkJbGluZS5saW5lICYmIGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbGluZS5wYXRoLCBsaW5lLmZpbGUucmVwbGFjZShpY2UuUFdELCAiIiksIHBhcnNlSW50KGxpbmUubGluZSkpCgkJCQkJfX0KCQkJCX0sIHN1Yi5fb3V0cHV0KSwgc3ViLm9uYXBwZW5kLl9zdGF0dXMoc3ViLCBtc2cuT3B0aW9uKGljZS5NU0dfU1RBVFVTKSksIGNhbi5TdGF0dXMoIuagh+etvuaVsCIsIG1zZy5MZW5ndGgoKSkKCQkJfSwgdHJ1ZSkKCQl9LCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YikKCX0pCn19KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvZGF0YS5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYikgewoJCWNhbi51aSA9IGNhbi5vbmxheW91dC5kaXNwbGF5KGNhbikKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCgkJY2FuLnRhYmxlID0gY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSkgewoJCQlyZXR1cm4ge3RleHQ6IFt2YWx1ZSwgInRkIl0sIG9uY29udGV4dG1lbnU6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBjYW4ub25kZXRhaWwsIGNhbi5vbmRldGFpbC5saXN0LCBmdW5jdGlvbihldiwgY21kLCBtZXRhKSB7CgkJCQkJdmFyIGNiID0gbWV0YVtjbWRdOyBjYiAmJiBjYihldmVudCwgY2FuLCBjbWQsIHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKQoJCQkJfSkKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGV2ZW50LnRhcmdldCwge2NvbnRlbnRlZGl0YWJsZTogdHJ1ZX0pCgkJCX0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoa2V5ID09ICJwYXRoIikgeyBjYW4ucnVuKGV2ZW50LCBbY2FuLk9wdGlvbigicGF0aCIsIHZhbHVlKV0pIH0KCQkJfX0KCQl9LCBjYW4udWkuY29udGVudCkKCgkJY2FuLm9uZXhwb3J0Lmxpc3QgPSBtc2cuYXBwZW5kCgkJY2FuLm9uYWN0aW9uLl9jb21wdXRlKGV2ZW50LCBjYW4pCgl9LAp9KQpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFtdLAoJIuaxguWSjCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHJlcywgdGQsIGluZGV4KSB7CgkJcmVzW2luZGV4XSA9IHBhcnNlSW50KHRkLmlubmVyVGV4dCkgKyAocmVzW2luZGV4XXx8MCk7Cgl9LAoJIuacgOWkpyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHJlcywgdGQsIGluZGV4KSB7CgkJdmFyIG4gPSBwYXJzZUludCh0ZC5pbm5lclRleHQpOwoJCW4gPiAocmVzW2luZGV4XXx8LTEwMDAwKSAmJiAocmVzW2luZGV4XSA9IG4pOwoJfSwKCSLmnIDlsI8iOiBmdW5jdGlvbihldmVudCwgY2FuLCByZXMsIHRkLCBpbmRleCkgewoJCXZhciBuID0gcGFyc2VJbnQodGQuaW5uZXJUZXh0KTsKCQluIDwgKHJlc1tpbmRleF18fDEwMDAwKSAmJiAocmVzW2luZGV4XSA9IG4pOwoJfSwKCSLlubPlnYciOiBmdW5jdGlvbihldmVudCwgY2FuLCByZXMsIHRkLCBuY29sLCBjb2xzLCByb3dzLCBucm93KSB7CgkJcmVzW25jb2xdID0gcGFyc2VJbnQodGQuaW5uZXJUZXh0KSArIChyZXNbbmNvbF18fDApOwoJCWlmIChucm93ID09IHJvd3MubGVuZ3RoIC0gMSkgewoJCQlyZXNbbmNvbF0gPSByZXNbbmNvbF0gLyBucm93CgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLnu4Tku7boj5zljZUiLCBsaXN0OiBbIuS/neWtmCIsIFsibW9kZSIsICLlhajpgIkiLCAi5Z2X6YCJIiwgIuWPjemAiSIsICLlpJrpgIkiLCAi5ouW5YqoIiwgIue8lui+kSJdLCBbInNvbWUiLCAi5rGC5ZKMIiwgIuacgOWkpyIsICLmnIDlsI8iLCAi5bmz5Z2HIl1dLAoJX2NvbXB1dGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgbXVsID0gInRyIiArIChjYW4uQWN0aW9uKCJtb2RlIikgPT0gIuWFqOmAiSI/ICIiOiAiLnNlbGVjdCIpCgkJdmFyIG1ldGhvZCA9IGNhbi5vbmZpZ3VyZVtjYW4uQWN0aW9uKCJzb21lIildLCByZXMgPSB7fQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgbXVsLCBmdW5jdGlvbih0ciwgbnJvdywgcm93cykgewoJCQkobXVsICE9ICJ0ciIgfHwgbnJvdyA+IDApICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCAidGQiLCBmdW5jdGlvbih0ZCwgbmNvbCwgY29scykgewoJCQkJbWV0aG9kICYmIG1ldGhvZChldmVudCwgY2FuLCByZXMsIHRkLCBuY29sLCBjb2xzLCByb3dzLCBucm93KQoJCQl9KQoJCX0pCgoJCWNhbi5jb3JlLkl0ZW0ocmVzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCWNhbi5TdGF0dXMoY2FuLl9tc2cuYXBwZW5kW2tleV0sIHZhbHVlfHwiIikKCQl9KQoJfSwKCgki5L+d5a2YIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGNtZCwgY2FuLk9wdGlvbigicGF0aCIpLCBjYW4ub25leHBvcnQuZmlsZShjYW4pXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJfSwgdHJ1ZSkKCX0sCglzb21lOiBmdW5jdGlvbihldmVudCwgY2FuLCBjbWQpIHsKCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCX0sCgoJIuWFqOmAiSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNtZCAmJiBjYW4uQWN0aW9uKCJtb2RlIiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAib3ZlciIpCgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJaXRlbS5zZXRBdHRyaWJ1dGUoImNvbnRlbnRlZGl0YWJsZSIsIGZhbHNlKQoJCQlpdGVtLnNldEF0dHJpYnV0ZSgiZHJhZ2dhYmxlIiwgZmFsc2UpCgkJCWl0ZW0ub25tb3VzZWVudGVyID0gbnVsbAoJCQlpdGVtLm9uY2xpY2sgPSBudWxsCgkJfSkKCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCX0sCgki5Z2X6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbm1vdXNlZW50ZXIgPSBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJCWNhbi5vbmFjdGlvbi5fY29tcHV0ZShldmVudCwgY2FuKQoJCQl9CgkJfSkKCX0sCgki5Y+N6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbm1vdXNlZW50ZXIgPSBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJCWNhbi5vbmFjdGlvbi5fY29tcHV0ZShldmVudCwgY2FuKQoJCQl9CgkJfSkKCX0sCgki5aSa6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7CgkJCQljYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgaXRlbSwgInNlbGVjdCIpCgkJCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCQkJfQoJCX0pCgl9LAoJIuaLluWKqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNhbi5vbmFjdGlvblsi5YWo6YCJIl0oZXZlbnQsIGNhbiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uc2V0QXR0cmlidXRlKCJkcmFnZ2FibGUiLCB0cnVlKQoJCQlpdGVtLm9uZHJhZ3N0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpIHsgY2FuLmRyYWcgPSBpdGVtIH0KCQkJaXRlbS5vbmRyYWdvdmVyID0gZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGl0ZW0sICJvdmVyIil9CgkJCWl0ZW0ub25kcmFnbGVhdmUgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5DbGFzc0xpc3QuZGVsKGNhbiwgaXRlbSwgIm92ZXIiKSB9CgkJCWl0ZW0ub25kcm9wID0gZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0YWJsZSIsIGZ1bmN0aW9uKHRhYmxlKSB7CgkJCQkJdGFibGUuaW5zZXJ0QmVmb3JlKGNhbi5kcmFnLCBpdGVtKQoJCQkJfSkKCQkJfQoJCX0pCgl9LAoJIue8lui+kSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNtZCAmJiBjYW4uQWN0aW9uKCJtb2RlIiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uc2V0QXR0cmlidXRlKCJjb250ZW50ZWRpdGFibGUiLCB0cnVlKQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25kZXRhaWwiLCB7aGVscDogIue7hOS7tuivpuaDhSIsIGxpc3Q6IFsi5aSN5Yi2IiwgIuWIoOmZpCJdLAoJIuWkjeWItiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCwgdmFsdWUsIGtleSwgaW5kZXgsIGxpbmUpIHsKCQl2YXIgZW5kID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnRhYmxlLCBbe3R5cGU6ICJ0ciIsIGxpc3Q6IGNhbi5jb3JlLkxpc3QoY2FuLl9tc2cuYXBwZW5kLCBmdW5jdGlvbihrZXkpIHsKCQkJcmV0dXJuIHt0ZXh0OiBbbGluZVtrZXldLCAidGQiXX0KCQl9KX1dKS50cgoJCWNhbi50YWJsZS5pbnNlcnRCZWZvcmUoZW5kLCBldmVudC50YXJnZXQucGFyZW50Tm9kZSkKCX0sCgki5Yig6ZmkIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJZmlsZTogZnVuY3Rpb24oY2FuKSB7CgkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbih0cikgewoJCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdHIsICJ0aCx0ZCIsIGZ1bmN0aW9uKHRkKSB7cmV0dXJuIHRkLmlubmVySFRNTH0pLmpvaW4oIiwiKQoJCX0pLmpvaW4oIlxuIikKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci9zZWFyY2guanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgYXJncywgY2IpIHsgdmFyIGhpc3RvcnkgPSBbXTsgY29uc3QgU0VBUkNIID0gImNhbi5jb2RlLmlubmVyLnNlYXJjaCIKCWZ1bmN0aW9uIHNob3cobXNnLCB3b3JkKSB7IGlmICghbXNnKSB7IHJldHVybiB9IGhpc3RvcnkucHVzaChtc2cpOyB2YXIgc3ViID0gbXNnLl9jYW47IHN1Yi5PcHRpb24oIndvcmQiLCB3b3JkfHxtc2cuX3dvcmQpCgkJIXN1Yi5wYWdlLkNsYXNzTGlzdC5oYXMoc3ViLCBzdWIuX2xlZ2VuZCwgInNlbGVjdCIpICYmIGNhbi51aS5zZWFyY2guc2VsZWN0KCkKCQlzdWIub25tb3Rpb24uY2xlYXIoc3ViKSwgc3ViLm9uYXBwZW5kLnRhYmxlKHN1YiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSkgewoJCQlyZXR1cm4ge3RleHQ6IFsiIiwgaHRtbC5URF0sIGxpc3Q6IFt7dGV4dDogW2Nhbi5wYWdlLnJlcGxhY2UoY2FuLCB2YWx1ZSwgaWNlLlBXRCwgIiIpLCBodG1sLkRJVl19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWxpbmUubGluZSAmJiBjYW4ub25pbXBvcnQudGFidmlldyhjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpLCBsaW5lLmZpbGUucmVwbGFjZShpY2UuUFdELCAiIiksIHBhcnNlSW50KGxpbmUubGluZSkpCgkJCX19CgkJfSwgc3ViLl9vdXRwdXQpLCBzdWIub25hcHBlbmQuYm9hcmQoc3ViLCBtc2cuUmVzdWx0KCkpLCBzdWIub25hcHBlbmQuX3N0YXR1cyhzdWIsIG1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMpKSwgY2FuLlN0YXR1cygi5qCH562+5pWwIiwgbXNnLkxlbmd0aCgpKQoJfQoJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sIFNFQVJDSCwgc2h5KCLmkJzntKIiLCB7fSwgWwoJCXt0eXBlOiBodG1sLlRFWFQsIG5hbWU6ICJ3b3JkIiwgdmFsdWU6IGNsaS5NQUlOLCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdFRhYmxlKGV2ZW50LCBjYW4uc3VwLCBldmVudC50YXJnZXQsIGZ1bmN0aW9uKHRyKSB7CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQsIGluZGV4KSB7IGluZGV4ID09IDAgJiYgdGQuY2xpY2soKSB9KQoJCQkJdHIuc2Nyb2xsSW50b1ZpZXcoKSwgY2FuLl9vdXRwdXQuc2Nyb2xsVG9wIC09IDYwCgkJCX0pCgkJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FTlRFUikgeyBjYW4uc3VwLlVwZGF0ZShldmVudCwgW2N0eC5BQ1RJT04sIGV2ZW50LmN0cmxLZXk/IG5mcy5HUkVQOiBuZnMuVEFHUywgY2FuLnN1cC5PcHRpb24oIndvcmQiKV0pIH0KCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVTQ0FQRSkgeyBldmVudC50YXJnZXQuYmx1cigpIH0KCQl9fSwKCQl7dHlwZTogaHRtbC5URVhULCBuYW1lOiAiZmlsdGVyIiwgdmFsdWU6ICIiLCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdFRhYmxlSW5wdXQoZXZlbnQsIGNhbi5zdXAsIGV2ZW50LnRhcmdldCkKCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVOVEVSKSB7IGNhbi5zdXAuVXBkYXRlKGV2ZW50LCBbY3R4LkFDVElPTiwgZXZlbnQuY3RybEtleT8gbmZzLkdSRVA6IG5mcy5UQUdTLCBjYW4uc3VwLk9wdGlvbigid29yZCIpXSkgfQoJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRVNDQVBFKSB7IGV2ZW50LnRhcmdldC5ibHVyKCkgfQoJCX19LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogbmZzLlRBR1N9LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogbmZzLkdSRVB9LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogY2xpLk1BS0V9LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogImhpc3RvcnkifSwKCQl7dHlwZTogaHRtbC5CVVRUT04sIG5hbWU6ICJsYXN0IiwgX3RyYW5zOiAi6L+U5ZueIn0sCgldLCBmdW5jdGlvbihtc2csIGNtZHMsIGNiKSB7IGlmIChjYW4ubWlzYy5ydW5BY3Rpb24oY2FuLCBtc2csIGNtZHMsIGNiLCBraXQuRGljdCgKCQkiaGlzdG9yeSIsIGZ1bmN0aW9uKGNtZHMpIHsKCQkJY2FuLmNvcmUuTGlzdChjYW4uaGlzdG9yeSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJbXNnLlB1c2gobmZzLkZJTEUsIGl0ZW0uZmlsZSkKCQkJCW1zZy5QdXNoKG5mcy5MSU5FLCBpdGVtLmxpbmUpCgkJCQltc2cuUHVzaChtZGIuVEVYVCwgaXRlbS50ZXh0KQoJCQl9KQoJCQlzaG93KG1zZykKCQl9LAoJCW5mcy5UQUdTLCBmdW5jdGlvbihjbWRzKSB7IG1zZy5PcHRpb24oa2l0LkRpY3QoaWNlLk1TR19IQU5ETEUsIGljZS5UUlVFLCBpY2UuTVNHX0ZJRUxEUywgImZpbGUsbGluZSx0ZXh0IikpCgkJCWNhbi5ydW4obXNnLl9ldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5TRUFSQ0gsIGNhbi5wYXJzZSwgY21kc1swXSwgY2FuLk9wdGlvbihuZnMuUEFUSCldLCBmdW5jdGlvbihtc2cpIHsgdmFyIHN1YiA9IG1zZy5fY2FuCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIGNhbi5Db25mSGVpZ2h0KCkvNCksIHNob3cobXNnLCBtc2cuX3dvcmQgPSBjbWRzWzBdKQoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhzdWIsIHN1Yi5fdGFyZ2V0LCBodG1sLlNFTEVDVCkgfHwgc3ViLl9sZWdlbmQuY2xpY2soKQoJCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgbXNnLl9jYW4uX2lucHV0c1sid29yZCJdLl90YXJnZXQpCgkJCX0sIHRydWUpCgkJfSwKCQluZnMuR1JFUCwgZnVuY3Rpb24oY21kcykgeyBtc2cuT3B0aW9uKGtpdC5EaWN0KGljZS5NU0dfSEFORExFLCBpY2UuVFJVRSwgaWNlLk1TR19GSUVMRFMsICJmaWxlLGxpbmUsdGV4dCIsIG5mcy5QQVRILCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkpCgkJCWNhbi5ydW4obXNnLl9ldmVudCwgW2N0eC5BQ1RJT04sIG5mcy5HUkVQLCBjbWRzWzBdXSwgZnVuY3Rpb24obXNnKSB7IHZhciBzdWIgPSBtc2cuX2NhbgoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfSEVJR0hULCBjYW4uQ29uZkhlaWdodCgpLzQpLCBzaG93KG1zZywgbXNnLl93b3JkID0gY21kc1swXSkKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoc3ViLCBzdWIuX3RhcmdldCwgaHRtbC5TRUxFQ1QpIHx8IHN1Yi5fbGVnZW5kLmNsaWNrKCkKCQkJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIG1zZy5fY2FuLl9pbnB1dHNbIndvcmQiXS5fdGFyZ2V0KQoJCQl9LCB0cnVlKQoJCX0sCgkJImxhc3QiLCBmdW5jdGlvbihjbWRzKSB7IGhpc3RvcnkucG9wKCksIHNob3coaGlzdG9yeS5wb3AoKSkgfSwKCSkpKSB7IHJldHVybiB9IGNhbi5ydW4obXNnLl9ldmVudCwgY21kcywgZnVuY3Rpb24obXNnKSB7IHNob3cobXNnKSB9LCB0cnVlKSB9KSkKCWNhbi5vbmltcG9ydC50b29sa2l0KGNhbiwge2luZGV4OiBTRUFSQ0h9LCBmdW5jdGlvbihzdWIpIHsKCQljYW4udWkuc2VhcmNoID0gc3ViLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YikKCQljYW4udWkuc2VhcmNoLl9zaG93ID0gc2hvdwoJfSkKfX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fYWN0aW9uKQoJCWNhbi5vbmltcG9ydC5fc2hvdyhjYW4sIG1zZyksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWNhbi5rZXlsaXN0ID0gW10sIGNhbi5vbmtleW1hcC5fYnVpbGQoY2FuKQoJfSwKCV9zaG93OiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4ucG9pbnQgPSBbXQoJCWNhbi5zdmcgPSBudWxsLCBjYW4uZ3JvdXAgPSBudWxsLCBjYW4udGVtcCA9IG51bGwsIGNhbi5jdXJyZW50ID0gbnVsbAoKCQkvLyDliqDovb3lm77lvaIKCQljYW4udWkgPSBjYW4ub25sYXlvdXQucHJvZmlsZShjYW4pLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmNvbnRlbnQsIG1zZy5SZXN1bHQoKXx8Y2FuLm9uZXhwb3J0LmNvbnRlbnQoY2FuKSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5TVkcsIGZ1bmN0aW9uKHN2ZykgewoJCQljYW4uc3ZnID0gY2FuLmdyb3VwID0gY2FuLm9uaW1wb3J0Ll9ibG9jayhjYW4sIHN2ZyksIGNhbi5vbmltcG9ydC5fZ3JvdXAoY2FuLCBzdmcpLmNsaWNrKCkKCQkJY2FuLmNvcmUuSXRlbUNCKGNhbi5vbmFjdGlvbiwgZnVuY3Rpb24oa2V5LCBjYikgeyBzdmdba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCBjYW4pIH0gfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgc3ZnLCAiKiIsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7IGNhbi5vbmltcG9ydC5fYmxvY2soY2FuLCBpdGVtKQoJCQkJaXRlbS50YWdOYW1lID09IHN2Zy5HICYmIGl0ZW0uVmFsdWUoaHRtbC5DTEFTUykgJiYgY2FuLm9uaW1wb3J0Ll9ncm91cChjYW4sIGl0ZW0pCgkJCX0pCgkJfSkKCQkvLyDpu5jorqTlj4LmlbAKCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7CgkJCWNhbi5jb3JlLkl0ZW0oewoJCQkJInN0cm9rZS13aWR0aCI6IDIsIHN0cm9rZTogY2xpLllFTExPVywgZmlsbDogY2xpLlBVUlBMRSwKCQkJCSJmb250LXNpemUiOiAyNCwgImZvbnQtZmFtaWx5IjogaHRtbC5NT05PU1BBQ0UsCgkJCQlnbzogaWNlLlJVTiwgc2hhcGU6ICJyZWN0IiwgZ3JpZDogMTAsCgkJCX0sIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgY2FuLnN2Zy5WYWx1ZShrZXksIGNhbi5BY3Rpb24oa2V5LCBjYW4uc3ZnLlZhbHVlKGtleSl8fHZhbHVlKSkgfSkKCgkJCXZhciBwaWQgPSBjYW4uT3B0aW9uKCJwaWQiKXx8Y2FuLnN2Zy5WYWx1ZSgicGlkIik7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkucHJvZmlsZSwgdHJ1ZSkKCQkJcGlkICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtwaWQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5vbmRldGFpbC5ydW4oe3RhcmdldDogaXRlbX0sIGNhbiksIGNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGl0ZW0pCgkJCX0pIHx8IGNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGNhbi5zdmcpLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2ZpbGUpCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5kaXNwbGF5LCB7c3R5bGU6IHsibWluLWhlaWdodCI6IDgwLCAibWF4LWhlaWdodCI6IGNhbi5Db25mKCJoZWlnaHQiKS1jYW4uc3ZnLlZhbCgiaGVpZ2h0IiktNTJ9fSkKCQl9KSAKCX0sCglfZ3JvdXA6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHZhciBuYW1lID0gdGFyZ2V0Lkdyb3VwcygpCgkJZnVuY3Rpb24gc2hvdyhldmVudCkgeyBjYW4uZ3JvdXAgPSB0YXJnZXQKCQkJY2FuLmNvcmUuTGlzdChbaHRtbC5TVFJPS0VfV0lEVEgsIGh0bWwuU1RST0tFLCBodG1sLkZJTEwsIGh0bWwuRk9OVF9TSVpFXSwgZnVuY3Rpb24oa2V5KSB7CgkJCQljYW4uQWN0aW9uKGtleSwgdGFyZ2V0LlZhbHVlKGtleSl8fGNhbi5BY3Rpb24oa2V5KSkKCQkJfSkKCQl9CgkJcmV0dXJuIChuYW1lIHx8IHRhcmdldCA9PSBjYW4uc3ZnKSAmJiBjYW4ub25hcHBlbmQuaXRlbShjYW4sIGh0bWwuSVRFTSwge25hbWU6IG5hbWV8fGh0bWwuU1ZHfSwgZnVuY3Rpb24oZXZlbnQpIHsgc2hvdyhldmVudCkKCQkJY2FuLm9uYWN0aW9uLnNob3coZXZlbnQsIGNhbikKCQl9LCBmdW5jdGlvbihldmVudCkgewoJCQljYW4udXNlci5jYXJ0ZVJpZ2h0KGV2ZW50LCBjYW4sIGNhbi5vbmFjdGlvbiwgW2ljZS5ISURFLCBpY2UuU0hPVywgbWRiLkNSRUFURSwgY2xpLkNMRUFSLCBtZGIuUkVNT1ZFXSkKCQl9LCBjYW4udWkucHJvamVjdCkKCX0sCglfYmxvY2s6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJdGFyZ2V0Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbihldmVudCkgewoJCQl2YXIgY2FydGUgPSBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBjYW4ub25kZXRhaWwsIG51bGwsIGZ1bmN0aW9uKGV2LCBidXR0b24sIG1ldGEpIHsKCQkJCW1ldGFbYnV0dG9uXShldmVudCwgY2FuLCBidXR0b24pCgkJCX0pOyBjYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYXJ0ZS5fdGFyZ2V0LCB7c3R5bGU6IHtsZWZ0OiBldmVudC5jbGllbnRYLCB0b3A6IGV2ZW50LmNsaWVudFl9fSkKCQl9CgkJdGFyZ2V0LlZhbCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKCQkJcmV0dXJuIHBhcnNlSW50KHRhcmdldC5WYWx1ZShrZXksIHZhbHVlID09IHVuZGVmaW5lZD8gdmFsdWU6IHBhcnNlSW50KHZhbHVlKXx8MCkpfHwwCgkJfQoJCXRhcmdldC5WYWx1ZSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgaWYgKGNhbi5iYXNlLmlzVW5kZWZpbmVkKGtleSkpIHsgcmV0dXJuIH0KCQkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsgY2FuLmNvcmUuSXRlbShrZXksIHRhcmdldC5WYWx1ZSk7IHJldHVybiB9CgoJCQl2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCB0YXJnZXQpCgkJCWtleSA9IGZpZ3VyZSAmJiBmaWd1cmUuZGF0YSAmJiBmaWd1cmUuZGF0YS5zaXplICYmIGZpZ3VyZS5kYXRhLnNpemVba2V5XSB8fCBrZXkKCQkJaWYgKGZpZ3VyZSAmJiBmaWd1cmUuZGF0YSAmJiBjYW4uYmFzZS5pc0Z1bmMoZmlndXJlLmRhdGFba2V5XSkpIHsKCQkJCXJldHVybiBmaWd1cmUuZGF0YVtrZXldKGNhbiwgdmFsdWUsIGtleSwgdGFyZ2V0KQoJCQl9CgoJCQlpZiAoa2V5ID09IGh0bWwuSU5ORVIpIHsKCQkJCXJldHVybiB2YWx1ZSAhPSB1bmRlZmluZWQgJiYgKHRhcmdldC5pbm5lckhUTUwgPSB2YWx1ZSksIHRhcmdldC5pbm5lckhUTUwKCQkJfQoJCQlpZiAoa2V5ID09IGljZS5TSElQKSB7CgkJCQlyZXR1cm4gdmFsdWUgIT0gdW5kZWZpbmVkICYmIHRhcmdldC5zZXRBdHRyaWJ1dGUoa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpLCBjYW4uYmFzZS5PYmoodGFyZ2V0LmdldEF0dHJpYnV0ZShrZXkpLCBbXSkKCQkJfQoJCQlyZXR1cm4gdmFsdWUgIT0gdW5kZWZpbmVkICYmIHRhcmdldC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSksIHRhcmdldC5nZXRBdHRyaWJ1dGUoa2V5fHxodG1sLkNMQVNTKQoJCQkJfHwgdGFyZ2V0W2tleV0mJnRhcmdldFtrZXldLmJhc2VWYWwmJnRhcmdldFtrZXldLmJhc2VWYWwudmFsdWUgfHwgdGFyZ2V0W2tleV0mJnRhcmdldFtrZXldLmJhc2VWYWwgfHwgIiIKCQl9CgkJdGFyZ2V0Lkdyb3VwID0gZnVuY3Rpb24oKSB7IHZhciBpdGVtID0gdGFyZ2V0CgkJCXdoaWxlIChpdGVtKSB7IGlmIChbaHRtbC5TVkcsIHN2Zy5HXS5pbmRleE9mKGl0ZW0udGFnTmFtZSkgPiAtMSkgeyByZXR1cm4gaXRlbSB9OyBpdGVtID0gaXRlbS5wYXJlbnROb2RlIH0KCQkJcmV0dXJuIGNhbi5zdmcKCQl9CgkJdGFyZ2V0Lkdyb3VwcyA9IGZ1bmN0aW9uKCkgeyB2YXIgaXRlbSA9IHRhcmdldAoJCQl2YXIgbGlzdCA9IFtdOyB3aGlsZSAoaXRlbSAmJiBpdGVtLnRhZ05hbWUgIT0gaHRtbC5TVkcpIHsKCQkJCWl0ZW0udGFnTmFtZSA9PSBzdmcuRyAmJiBpdGVtLlZhbHVlKGh0bWwuQ0xBU1MpICYmIGxpc3QucHVzaChpdGVtLlZhbHVlKGh0bWwuQ0xBU1MpKQoJCQkJaXRlbSA9IGl0ZW0ucGFyZW50Tm9kZQoJCQl9CgkJCXJldHVybiBsaXN0LnJldmVyc2UoKS5qb2luKGljZS5QVCkKCQl9CgkJcmV0dXJuIHRhcmdldAoJfSwKCV9wcm9maWxlOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgbGlzdCkgeyBjYW4uT3B0aW9uKCJwaWQiLCBjYW4ub25maWd1cmUuX3BpZChjYW4sIHRhcmdldCkpCgkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gdGFyZ2V0LlZhbHVlKCJwaWQiKSB9LCBjYW4udWkucHJvZmlsZSkpIHsgcmV0dXJuIH0KCgkJdmFyIGFjdGlvbiA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5wcm9maWxlLCBbe3ZpZXc6ICJhY3Rpb24ifV0pLmZpcnN0CgkJY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBjYW4ub25kZXRhaWwubGlzdCwgYWN0aW9uLCB7X2VuZ2luZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJCWNhbi5vbmRldGFpbFtidXR0b25dKHt0YXJnZXQ6IHRhcmdldH0sIGNhbiwgYnV0dG9uKQoJCX19KQoKCQl2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCB0YXJnZXQpCgkJbGlzdCA9IChsaXN0fHxbXSkuY29uY2F0KGZpZ3VyZS5kYXRhLmNvcHksIFtzdmcuWCwgc3ZnLlksIG1kYi5JTkRFWCwgY3R4LkFSR1NdKQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5wcm9maWxlLCBbe3R5cGU6IGh0bWwuVEFCTEUsIGNsYXNzTmFtZTogImNvbnRlbnQiLCBsaXN0OiBbCgkJCXt0aDogW21kYi5LRVksIG1kYi5WQUxVRV19LCB7dGQ6IFttZGIuVFlQRSwgdGFyZ2V0LnRhZ05hbWVdfSwge3RkOiBbInBpZCIsIHRhcmdldC5WYWx1ZSgicGlkIildfSwKCQldLmNvbmNhdChjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGtleSkgewoJCQlyZXR1cm4ga2V5ID0gZmlndXJlLmRhdGEuc2l6ZVtrZXldfHxrZXksIHt0ZDogW2tleSwgdGFyZ2V0LlZhbHVlKGtleSldLCBvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9ubW90aW9uLm1vZGlmeShjYW4sIGV2ZW50LnRhcmdldCwgZnVuY3Rpb24oZXZlbnQsIHZhbHVlLCBvbGQpIHsKCQkJCQl0YXJnZXQuVmFsdWUoa2V5LCB2YWx1ZSksIGNhbi5vbmZpZ3VyZS5fbW92ZShjYW4sIHRhcmdldCkKCQkJCX0pCgkJCX19CgkJfSkpIH1dKQoKCX0sCglkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCB2YWx1ZSkgewoJCXZhciBmaWd1cmUgPSBjYW4ub25maWd1cmVbdmFsdWUuc2hhcGVdCgkJdmFyIGRhdGEgPSBmaWd1cmUuZHJhdyhldmVudCwgY2FuLCB2YWx1ZS5wb2ludCwgdmFsdWUuc3R5bGUpCgkJY2FuLmNvcmUuSXRlbSh2YWx1ZS5zdHlsZSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyBkYXRhW2tleV0gPSB2YWx1ZSB9KQoJCXZhciBpdGVtID0gY2FuLm9uZmlndXJlLl9wdXNoKGNhbiwgZmlndXJlLmRhdGEubmFtZXx8dmFsdWUuc2hhcGUsIGRhdGEsIGNhbi5ncm91cHx8Y2FuLnN2ZykKCQljYW4uY29yZS5JdGVtQ0IodmFsdWUsIGZ1bmN0aW9uKGtleSwgY2IpIHsgaXRlbVtrZXldID0gY2IgfSkKCQljYW4ub25pbXBvcnQuX2Jsb2NrKGNhbiwgaXRlbSksIGNhbi5vbmZpZ3VyZS5fcGlkKGNhbiwgaXRlbSkKCQlyZXR1cm4gdmFsdWUuX2luaXQgJiYgdmFsdWUuX2luaXQoaXRlbSksIGl0ZW0KCX0sCn0sIFsiL3BsdWdpbi9sb2NhbC93aWtpL2RyYXcuY3NzIl0pClZvbGNhbm9zKCJvbmZpZ3VyZSIsIHtoZWxwOiAi5Zu+5b2i57uY5Yi2IiwgbGlzdDogW10sCglfZ2V0OiBmdW5jdGlvbihjYW4sIGl0ZW0sIG5hbWUpIHsKCQlyZXR1cm4gY2FuLm9uZmlndXJlW25hbWVdfHxjYW4ub25maWd1cmVbaXRlbS5nZXRBdHRyaWJ1dGUobWRiLk5BTUUpXXx8Y2FuLm9uZmlndXJlW2l0ZW0udGFnTmFtZV0KCX0sCglfcGlkOiBmdW5jdGlvbihjYW4sIGl0ZW0pIHsgaWYgKGl0ZW0uVmFsdWUoInBpZCIpKSB7IHJldHVybiBpdGVtLlZhbHVlKCJwaWQiKSB9CgkJdmFyIHBpZCA9ICJwIitjYW4uc3ZnLlZhbChtZGIuQ09VTlQsIGNhbi5zdmcuVmFsKG1kYi5DT1VOVCkrMSkKCQlpdGVtLlZhbHVlKGh0bWwuQ0xBU1MsIChpdGVtLlZhbHVlKGh0bWwuQ0xBU1MpK2ljZS5TUCtpdGVtLlZhbHVlKCJwaWQiLCBwaWQpKS50cmltKCkpCgkJcmV0dXJuIHBpZAoJfSwKCV9wdXNoOiBmdW5jdGlvbihjYW4sIHR5cGUsIGRhdGEsIHRhcmdldCkgewoJCXZhciBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsIHR5cGUpCgkJdGFyZ2V0LmFwcGVuZENoaWxkKGNhbi5vbmltcG9ydC5fYmxvY2soY2FuLCBpdGVtKSksIGl0ZW0uVmFsdWUoZGF0YSkKCQlyZXR1cm4gaXRlbQoJfSwKCV9jb3B5OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQl2YXIgZGF0YSA9IHt9LCBmaWd1cmUgPSBjYW4ub25maWd1cmUuX2dldChjYW4sIHRhcmdldCksIHNpemUgPSBmaWd1cmUuZGF0YS5zaXplCgkJY2FuLmNvcmUuTGlzdChmaWd1cmUuZGF0YS5jb3B5LCBmdW5jdGlvbihpdGVtKSB7IGRhdGFbaXRlbV0gPSB0YXJnZXQuVmFsdWUoaXRlbSkgfSkKCQlkYXRhW3NpemUueHx8c3ZnLlhdID0gdGFyZ2V0LlZhbChzaXplLnh8fHN2Zy5YKSsxMAoJCWRhdGFbc2l6ZS55fHxzdmcuWV0gPSB0YXJnZXQuVmFsKHNpemUueXx8c3ZnLlkpKzEwCgkJcmV0dXJuIGNhbi5vbmZpZ3VyZS5fcHVzaChjYW4sIHRhcmdldC50YWdOYW1lLCBkYXRhLCBjYW4uZ3JvdXB8fGNhbi5zdmcpCgl9LAoJX21vdmU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBsaXN0KSB7CgkJY2FuLmNvcmUuTGlzdChsaXN0fHx0YXJnZXQuVmFsdWUoaWNlLlNISVApLCBmdW5jdGlvbihzaGlwKSB7CgkJCXNoaXAudGFyZ2V0ID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK3NoaXAucGlkKVswXQoJCQl2YXIgcCA9IGNhbi5vbmV4cG9ydC5hbmNob3IodGFyZ2V0LCBzaGlwLmFuY2hvciwge30pIAoJCQlpZiAoc2hpcC53aGljaCA9PSAxKSB7CgkJCQlzaGlwLnRhcmdldC5WYWwoIngxIiwgcC54KSwgc2hpcC50YXJnZXQuVmFsKCJ5MSIsIHAueSkKCQkJfSBlbHNlIGlmIChzaGlwLndoaWNoID09IDIpIHsKCQkJCXNoaXAudGFyZ2V0LlZhbCgieDIiLCBwLngpLCBzaGlwLnRhcmdldC5WYWwoInkyIiwgcC55KQoJCQl9CgkJfSkKCX0sCgoJc3ZnOiB7IC8vIDxzdmcgaGVpZ2h0PSIyMDAiIHdpZHRoPSI2MDAiIGNvdW50PSIwIiBncmlkPSIxMCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9InllbGxvdyIgZmlsbD0icHVycGxlIiBmb250LXNpemU9IjI0Ii8+CgkJZGF0YToge3NpemU6IHt9LCBjb3B5OiBbXX0sCgkJc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgeyByZXR1cm4gY2FuLm9uZXhwb3J0Ll9zaXplKGNhbiwgdGFyZ2V0LCBmaWd1cmUpIH0KCX0sCgl0ZXh0OiB7IC8vIDx0ZXh0IHg9IjYwIiB5PSIxMCI+aGk8dGV4dD4KCQlkYXRhOiB7cG9pbnRzOiAxLCBzaXplOiB7fSwgY29weTogW2h0bWwuSU5ORVJdfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCwgc3R5bGUpIHsgaWYgKHBvaW50Lmxlbmd0aCA8IDEgfHwgZXZlbnQudHlwZSA9PSAibW91c2Vtb3ZlIikgeyByZXR1cm4gfQoJCQl2YXIgcDAgPSBwb2ludFswXSwgdGV4dCA9IHN0eWxlJiZzdHlsZS5pbm5lcnx8Y2FuLnVzZXIucHJvbXB0KG1kYi5URVhUKQoJCQlyZXR1cm4gdGV4dD8ge3g6IHAwLngsIHk6IHAwLnksIGlubmVyOiB0ZXh0fTogbnVsbAoJCX0sCgkJc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgeyByZXR1cm4gY2FuLm9uZXhwb3J0Ll9wb3NpdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB9Cgl9LAoJY2lyY2xlOiB7IC8vIDxjaXJjbGUgcj0iMjAiIGN4PSIyNSIgY3k9Ijc1Ii8+CgkJZGF0YToge3BvaW50czogMiwgc2l6ZToge2hlaWdodDogc3ZnLlIsIHdpZHRoOiBzdmcuUiwgeDogImN4IiwgeTogImN5In0sIGNvcHk6IFtzdmcuUl19LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdCgkJCXJldHVybiB7cjogcGFyc2VJbnQoTWF0aC5zcXJ0KE1hdGgucG93KHAwLngtcDEueCwgMikrTWF0aC5wb3cocDAueS1wMS55LCAyKSkpLCBjeDogcDAueCwgY3k6IHAwLnl9CgkJfSwKCX0sCgllbGxpcHNlOiB7IC8vIDxlbGxpcHNlIHJ5PSI1IiByeD0iMjAiIGN4PSI3NSIgY3k9Ijc1Ii8+CgkJZGF0YToge3BvaW50czogMiwgc2l6ZToge2hlaWdodDogInJ5Iiwgd2lkdGg6ICJyeCIsIHg6ICJjeCIsIHk6ICJjeSJ9LCBjb3B5OiBbInJ5IiwgInJ4Il19LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdCgkJCXJldHVybiB7cnk6IE1hdGguYWJzKHAwLnkgLSBwMS55KSwgcng6IE1hdGguYWJzKHAwLnggLSBwMS54KSwgY3g6IHAwLngsIGN5OiBwMC55fQoJCX0sCgl9LAoJcmVjdDogeyAvLyA8cmVjdCBoZWlnaHQ9IjMwIiB3aWR0aD0iMzAiIHJ5PSIxMCIgcng9IjEwIiB4PSI2MCIgeT0iMTAiLz4KCQlkYXRhOiB7cG9pbnRzOiAyLCByeTogNCwgcng6IDQsIHNpemU6IHt9LCBjb3B5OiBbaHRtbC5IRUlHSFQsIGh0bWwuV0lEVEgsICJyeSIsICJyeCJdfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyBpZiAocG9pbnQubGVuZ3RoIDwgMikgeyByZXR1cm4gfQoJCQl2YXIgcDAgPSBwb2ludFswXSwgcDEgPSBwb2ludFsxXQoJCQlyZXR1cm4gewoJCQkJaGVpZ2h0OiBNYXRoLmFicyhwMC55LXAxLnkpLCB3aWR0aDogTWF0aC5hYnMocDAueC1wMS54KSwgcnk6IHRoaXMuZGF0YS5yeSwgcng6IHRoaXMuZGF0YS5yeCwKCQkJCXg6IHAwLnggPiBwMS54PyBwMS54OiBwMC54LCB5OiBwMC55ID4gcDEueT8gcDEueTogcDAueSwKCQkJfQoJCX0sCgkJdGV4dDogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsgcmV0dXJuIGRhdGEueCA9IHRhcmdldC5WYWwoc3ZnLlgpK3RhcmdldC5WYWwoaHRtbC5XSURUSCkvMiwgZGF0YS55ID0gdGFyZ2V0LlZhbChzdmcuWSkrdGFyZ2V0LlZhbChodG1sLkhFSUdIVCkvMiwgZGF0YSB9LAoJfSwKCWJsb2NrOiB7IC8vIDxyZWN0IGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgcnk9IjEwIiByeD0iMTAiIHg9IjYwIiB5PSIxMCIvPgoJCWRhdGE6IHtwb2ludHM6IDIsIHJ5OiA0LCByeDogNCwgc2l6ZToge30sIGNvcHk6IFtodG1sLkhFSUdIVCwgaHRtbC5XSURUSCwgInJ5IiwgInJ4Il19LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXRoaXMuX3RlbXAgJiYgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdGhpcy5fdGVtcCkgJiYgZGVsZXRlKHRoaXMuX3RlbXApCgkJCXRoaXMuX3RlbXAgPSBjYW4ub25maWd1cmUuX3B1c2goY2FuLCBzdmcuRywge30sIGNhbi5ncm91cHx8Y2FuLnN2ZykKCgkJCXZhciByZWN0ID0gY2FuLm9uZmlndXJlLl9wdXNoKGNhbiwgInJlY3QiLCBjYW4ub25maWd1cmUucmVjdC5kcmF3KGV2ZW50LCBjYW4sIHBvaW50KSwgdGhpcy5fdGVtcCkKCQkJaWYgKGV2ZW50LnR5cGUgPT0gaHRtbC5DTElDSykgewoJCQkJY2FuLm9uZmlndXJlLl9waWQoY2FuLCByZWN0KSwgZGVsZXRlKHRoaXMuX3RlbXApCgkJCX0KCQl9LAoJCXRleHQ6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IGNhbi5vbmZpZ3VyZS5yZWN0LnRleHQoY2FuLCBkYXRhLCB0YXJnZXQpIH0sCgl9LAoJbGluZTogeyAvLyA8bGluZSB4MT0iMTAiIHkxPSI1MCIgeDI9IjExMCIgeTI9IjE1MCIgeHg9IjEwMCIgeXk9IjEwMCIvPgoJCWRhdGE6IHtwb2ludHM6IDIsIHNpemU6IHt4OiAieDEiLCB5OiAieTEifSwgY29weTogWyJ4MSIsICJ5MSIsICJ4MiIsICJ5MiJdfSwKCQlncmlkOiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJCWlmICh0YXJnZXQgPT0gY2FuLnN2ZykgeyByZXR1cm4gfQoJCQl2YXIgcCA9IHBvaW50W3BvaW50Lmxlbmd0aC0xXSwgcG9zID0gY2FuLm9uZXhwb3J0LmN1cnNvcihldmVudCwgY2FuLCB0YXJnZXQpCgkJCXRhcmdldC5WYWwgJiYgY2FuLm9uZXhwb3J0LmFuY2hvcih0YXJnZXQsIHBvcywgcCkKCQkJcmV0dXJuIHAudGFyZ2V0ID0gdGFyZ2V0LCBwLmFuY2hvciA9IHBvcywgcG9pbnQKCQl9LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdLCBzaGlwID0gW10KCQkJcDAudGFyZ2V0ICYmIHAwLnRhcmdldC5WYWx1ZSAmJiBzaGlwLnB1c2goe3BpZDogcDAudGFyZ2V0LlZhbHVlKCJwaWQiKX0pCgkJCXAxLnRhcmdldCAmJiBwMS50YXJnZXQuVmFsdWUgJiYgc2hpcC5wdXNoKHtwaWQ6IHAxLnRhcmdldC5WYWx1ZSgicGlkIil9KQoJCQlyZXR1cm4ge3gxOiBwMC54LCB5MTogcDAueSwgeDI6IHAxLngsIHkyOiBwMS55LCBzaGlwOiBzaGlwfQoJCX0sCgkJdGV4dDogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGRhdGEpIHsgcmV0dXJuIGRhdGEueCA9ICh0YXJnZXQuVmFsKCJ4MSIpK3RhcmdldC5WYWwoIngyIikpLzIsIGRhdGEueSA9ICh0YXJnZXQuVmFsKCJ5MSIpK3RhcmdldC5WYWwoInkyIikpLzIsIGRhdGEgfSwKCQlzaG93OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB7IHJldHVybiAiPCgiKyh0YXJnZXQuVmFsKCJ5MiIpLXRhcmdldC5WYWwoInkxIikpK2ljZS5GUysodGFyZ2V0LlZhbCgieDIiKS10YXJnZXQuVmFsKCJ4MSIpKSsiKSIrY2FuLm9uZXhwb3J0Ll9wb3NpdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB9LAoJfSwKfSwgW10pClZvbGNhbm9zKCJvbmtleW1hcCIsIHtoZWxwOiAi6ZSu55uY5Lqk5LqSIiwgbGlzdDogW10sCglfbW9kZTogewoJCW5vcm1hbDogewoJCQlncjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJnbyIsICJydW4iKSB9LAoJCQlnYTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJnbyIsICJhdXRvIikgfSwKCQkJZ206IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLkFjdGlvbigiZ28iLCAibWFudWFsIikgfSwKCgkJCWFkOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oIm1vZGUiLCAiZHJhdyIpIH0sCgkJCWFyOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oIm1vZGUiLCAicmVzaXplIikgfSwKCgkJCXN0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oInNoYXBlIiwgInRleHQiKSB9LAoJCQlzcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJzaGFwZSIsICJyZWN0IikgfSwKCQkJc2w6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLkFjdGlvbigic2hhcGUiLCAibGluZSIpIH0sCgkJCXNjOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oInNoYXBlIiwgImNpcmNsZSIpIH0sCgkJCXNlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oInNoYXBlIiwgImVsbGlwc2UiKSB9LAoKCQkJY3I6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAic3Ryb2tlIiwgInJlZCIpIH0sCgkJCWNiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJibHVlIikgfSwKCQkJY2c6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAic3Ryb2tlIiwgImdyZWVuIikgfSwKCQkJY3k6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAic3Ryb2tlIiwgInllbGxvdyIpIH0sCgkJCWNwOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJwdXJwbGUiKSB9LAoJCQljYzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJzdHJva2UiLCAiY3lhbiIpIH0sCgkJCWNoOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJibGFjayIpIH0sCgkJCWN3OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJ3aGl0ZSIpIH0sCgoJCQlmcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgInJlZCIpIH0sCgkJCWZiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAiYmx1ZSIpIH0sCgkJCWZnOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAiZ3JlZW4iKSB9LAoJCQlmeTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgInllbGxvdyIpIH0sCgkJCWZwOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAicHVycGxlIikgfSwKCQkJZmM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAiZmlsbCIsICJjeWFuIikgfSwKCQkJZmg6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAiZmlsbCIsICJibGFjayIpIH0sCgkJCWZ3OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAid2hpdGUiKSB9LAoJCX0sCgl9LCBfZW5naW5lOiB7fSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLnu4Tku7boj5zljZUiLCBsaXN0OiBbCgkJWyJzdHJva2Utd2lkdGgiLCAxLCAyLCAzLCA0LCA1XSwKCQlbInN0cm9rZSIsIGNsaS5SRUQsIGNsaS5ZRUxMT1csIGNsaS5HUkVFTiwgY2xpLkNZQU4sIGNsaS5CTFVFLCBjbGkuUFVSUExFLCBjbGkuQkxBQ0ssIGNsaS5XSElURV0sCgkJWyJmaWxsIiwgY2xpLlJFRCwgY2xpLllFTExPVywgY2xpLkdSRUVOLCBjbGkuQ1lBTiwgY2xpLkJMVUUsIGNsaS5QVVJQTEUsIGNsaS5CTEFDSywgY2xpLldISVRFLCAiIzAwMDAiXSwKCQlbImZvbnQtc2l6ZSIsIDEyLCAxNiwgMTgsIDI0LCAzMl0sCgoJCVsiZ28iLCBpY2UuUlVOLCBpY2UuQVVUTywgIm1hbnVhbCJdLAoJCVsibW9kZSIsICJkcmF3IiwgInJlc2l6ZSJdLAoJCVsic2hhcGUiLCAidGV4dCIsICJjaXJjbGUiLCAiZWxsaXBzZSIsICJyZWN0IiwgImJsb2NrIiwgImxpbmUiXSwKCQlbImdyaWQiLCAxLCAyLCAzLCA0LCA1LCAxMCwgMjBdLAoJXSwKCV9jaGFuZ2U6IGZ1bmN0aW9uKGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4uQWN0aW9uKGtleSwgdmFsdWUpLCBjYW4uZ3JvdXAuVmFsdWUoa2V5LCB2YWx1ZSkgfSwKCSJzdHJva2Utd2lkdGgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwga2V5LCB2YWx1ZSkgfSwKCXN0cm9rZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sIGtleSwgdmFsdWUpIH0sCglmaWxsOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwga2V5LCB2YWx1ZSkgfSwKCSJmb250LXNpemUiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwga2V5LCB2YWx1ZSkgfSwKCglnbzogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4uQWN0aW9uKGtleSwgdmFsdWUpIH0sCgltb2RlOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5BY3Rpb24oa2V5LCB2YWx1ZSkgfSwKCXNoYXBlOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5BY3Rpb24oa2V5LCB2YWx1ZSkgfSwKCgllZGl0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oImdvIiwgY2FuLkFjdGlvbigiZ28iKSA9PSBpY2UuUlVOPyBpY2UuQVVUTzogaWNlLlJVTikgfSwKCXNhdmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge2NvbnRlbnQ6IGNhbi5vbmV4cG9ydC5jb250ZW50KGNhbiwgY2FuLnN2Zyl9KQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBidXR0b24sIGNhbi5PcHRpb24obmZzLlBBVEgpXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJfSwgdHJ1ZSkKCX0sCgoJcHJvamVjdDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLnVpLnByb2plY3QpIH0sCglwcm9maWxlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4udWkucHJvZmlsZSkgfSwKCXNob3c6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnNob3coY2FuLCB7aW50ZXJ2YWw6IDEwMCwgbGVuZ3RoOiAxMH0sIG51bGwsIGNhbi5ncm91cCkgfSwKCWhpZGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLmhpZGUoY2FuLCB7aW50ZXJ2YWw6IDEwMCwgbGVuZ3RoOiAxMH0sIG51bGwsIGNhbi5ncm91cCkgfSwKCWNyZWF0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLnByb21wdCgiZ3JvdXAiLCAic29tZSIsIGZ1bmN0aW9uKG5hbWUpIHsKCQkJdmFyIGdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIHN2Zy5HKQoJCQljYW4uZ3JvdXAuYXBwZW5kKGdyb3VwKSwgY2FuLm9uaW1wb3J0Ll9ibG9jayhjYW4sIGdyb3VwKQoJCQlncm91cC5WYWx1ZShodG1sLkNMQVNTLCBuYW1lKSwgY2FuLmNvcmUuTGlzdChbaHRtbC5TVFJPS0VfV0lEVEgsIGh0bWwuU1RST0tFLCBodG1sLkZJTEwsIGh0bWwuRk9OVF9TSVpFXSwgZnVuY3Rpb24obmFtZSkgewoJCQkJZ3JvdXAuVmFsdWUobmFtZSwgY2FuLkFjdGlvbihuYW1lKSkKCQkJfSksIGNhbi5vbmltcG9ydC5fZ3JvdXAoY2FuLCBncm91cCkuY2xpY2soKQoJCX0pCgl9LAoJcmVtb3ZlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGlmIChjYW4uZ3JvdXAgPT0gY2FuLnN2ZykgeyByZXR1cm4gfQoJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5ncm91cCkKCX0sCgljbGVhcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5ncm91cCksIGNhbi5wb2ludCA9IFtdLCBkZWxldGUoY2FuLnRlbXApCgl9LAoKCV9tb2RlOiB7CgkJZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKCQkJdmFyIHNoYXBlID0gY2FuLkFjdGlvbigic2hhcGUiKQoJCQl2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlW3NoYXBlXQoJCQlmaWd1cmUuZ3JpZCAmJiBmaWd1cmUuZ3JpZChldmVudCwgY2FuLCBwb2ludCkKCgkJCXZhciBkYXRhID0gZmlndXJlLmRyYXcgJiYgZmlndXJlLmRyYXcoZXZlbnQsIGNhbiwgcG9pbnQpCgkJCXZhciBpdGVtID0gZGF0YSAmJiBjYW4ub25maWd1cmUuX3B1c2goY2FuLCBmaWd1cmUuZGF0YS5uYW1lfHxzaGFwZSwgZGF0YSwgY2FuLmdyb3VwfHxjYW4uc3ZnKQoJCQlldmVudC50eXBlID09IGh0bWwuQ0xJQ0sgJiYgcG9pbnQubGVuZ3RoID09PSBmaWd1cmUuZGF0YS5wb2ludHMgJiYgKGNhbi5wb2ludCA9IFtdKSAKCgkJCWlmIChldmVudC50eXBlID09IGh0bWwuQ0xJQ0sgJiYgaXRlbSkgewoJCQkJdmFyIHBpZCA9IGNhbi5vbmZpZ3VyZS5fcGlkKGNhbiwgaXRlbSk7IGNhbi5jb3JlLkxpc3QocG9pbnQsIGZ1bmN0aW9uKHAsIGkpIHsgaWYgKCFwLnRhcmdldCkgeyByZXR1cm4gfQoJCQkJCXAudGFyZ2V0LlZhbHVlKGljZS5TSElQLCBwLnRhcmdldC5WYWx1ZShpY2UuU0hJUCkuY29uY2F0KFt7cGlkOiBwaWQsIHdoaWNoOiBpKzEsIGFuY2hvcjogcC5hbmNob3J9XSkpCgkJCQl9KQoJCQl9CgkJCXJldHVybiBpdGVtCgkJfSwKCQlyZXNpemU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50LCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxldmVudC50YXJnZXQKCQkJaWYgKGV2ZW50LnR5cGUgPT0gaHRtbC5DTElDSykgewoJCQkJaWYgKHBvaW50Lmxlbmd0aCA9PSAxKSB7CgkJCQkJY2FuLmN1cnJlbnQgPSB7dGFyZ2V0OiB0YXJnZXQsIGJlZ2luOiBjYW4uY29yZS5MaXN0KFt0YXJnZXRdLCBmdW5jdGlvbihpdGVtKSB7IGlmIChpdGVtLnRhZ05hbWUgPT0gc3ZnLkcpIHsgcmV0dXJuIH0KCQkJCQkJcmV0dXJuIHsKCQkJCQkJCWhlaWdodDogaXRlbS5WYWwoaHRtbC5IRUlHSFQpLCB3aWR0aDogaXRlbS5WYWwoaHRtbC5XSURUSCksIHg6IGl0ZW0uVmFsKHN2Zy5YKSwgeTogaXRlbS5WYWwoc3ZnLlkpLAoJCQkJCQkJdGFyZ2V0OiBpdGVtLCBzaGlwOiBjYW4uY29yZS5MaXN0KGl0ZW0uVmFsdWUoaWNlLlNISVApLCBmdW5jdGlvbihzaGlwKSB7CgkJCQkJCQkJcmV0dXJuIHNoaXAucGlkICYmIChzaGlwLnRhcmdldCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtzaGlwLnBpZClbMF0pICYmIHNoaXAKCQkJCQkJCX0pCgkJCQkJCX0KCQkJCQl9KSwgcG9zOiBjYW4ub25leHBvcnQuY3Vyc29yKGV2ZW50LCBjYW4sIHRhcmdldCl9CgkJCQkJcmV0dXJuCgkJCQl9CgkJCQlyZXR1cm4gY2FuLnBvaW50ID0gW10sIGRlbGV0ZShjYW4uY3VycmVudCkKCQkJfQoKCQkJY2FuLmN1cnJlbnQgJiYgY2FuLmNvcmUuTGlzdChjYW4uY3VycmVudC5iZWdpbiwgZnVuY3Rpb24oaXRlbSkgeyB2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCBpdGVtLnRhcmdldCkKCQkJCWNhbi5vbmV4cG9ydC5yZXNpemUoZXZlbnQsIGl0ZW0udGFyZ2V0LCBpdGVtLCBwb2ludFswXSwgcG9pbnRbMV0sIGNhbi5jdXJyZW50LnBvcykKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtpdGVtLnRhcmdldC5WYWx1ZShtZGIuVEVYVCksIGZ1bmN0aW9uKHRleHQpIHsKCQkJCQl0ZXh0LlZhbHVlKGNhbi5vbmV4cG9ydC5fdGV4dChjYW4sIGl0ZW0udGFyZ2V0LCBmaWd1cmUsIHt9KSkKCQkJCX0pCgkJCQljYW4ub25maWd1cmUuX21vdmUoY2FuLCBpdGVtLnRhcmdldCwgaXRlbS5zaGlwKQoJCQl9KQoJCX0sCgkJcnVuOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJCWNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGV2ZW50LnRhcmdldCkKCQl9LAoJfSwKCV9hdXRvOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCWlmIChjYW4ucG9pbnQubGVuZ3RoID4gMCkgeyByZXR1cm4gfQoJCWlmICh0YXJnZXQudGFnTmFtZSA9PSBtZGIuVEVYVCkgeyByZXR1cm4gfQoKCQl2YXIgcG9zID0gY2FuLm9uZXhwb3J0LmN1cnNvcihldmVudCwgY2FuLCBldmVudC50YXJnZXQpCgkJaWYgKHRhcmdldCA9PSBjYW4uc3ZnKSB7CgkJCWlmIChwb3MgPT0gNSkgewoJCQkJY2FuLkFjdGlvbihpY2UuTU9ERSwgImRyYXciKSwgY2FuLkFjdGlvbigic2hhcGUiLCBodG1sLkJMT0NLKQoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCB7c3R5bGU6IHtjdXJzb3I6ICJjcm9zc2hhaXIifX0pCgkJCX0gZWxzZSB7CgkJCQljYW4uQWN0aW9uKGljZS5NT0RFLCAicmVzaXplIikKCQkJfQoJCX0gZWxzZSB7CgkJCXN3aXRjaCAocG9zKSB7CgkJCQljYXNlIDU6CgkJCQljYXNlIDk6IGNhbi5BY3Rpb24oaWNlLk1PREUsICJyZXNpemUiKTsgYnJlYWsKCQkJCWRlZmF1bHQ6IGNhbi5BY3Rpb24oaWNlLk1PREUsICJkcmF3IiksIGNhbi5BY3Rpb24oInNoYXBlIiwgImxpbmUiKQoJCQl9CgkJfQoJfSwKCV9maWd1cmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50cywgdGFyZ2V0KSB7CgkJY2FuLnRlbXAgJiYgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLnRlbXApICYmIGRlbGV0ZShjYW4udGVtcCkKCQljYW4udGVtcCA9IGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25hY3Rpb24uX21vZGUsIGNhbi5BY3Rpb24oaWNlLk1PREUpXSwgW2V2ZW50LCBjYW4sIHBvaW50cywgdGFyZ2V0XSkKCQljYW4ucG9pbnQubGVuZ3RoID09IDAgJiYgZGVsZXRlKGNhbi50ZW1wKQoJfSwKCglvbm1vdXNlb3ZlcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25leHBvcnQuX3Nob3coY2FuLCBldmVudC50YXJnZXQpIH0sCglvbm1vdXNlbW92ZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgcG9pbnQgPSBjYW4ub25leHBvcnQuX3BvaW50KGV2ZW50LCBjYW4pCgkJaWYgKGNhbi5BY3Rpb24oImdvIikgPT0gaWNlLlJVTikgeyByZXR1cm4gfQoJCWNhbi5vbmV4cG9ydC5jdXJzb3IoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KQoJCWlmIChjYW4uQWN0aW9uKCJnbyIpID09IGljZS5BVVRPKSB7IGNhbi5vbmFjdGlvbi5fYXV0byhjYW4sIGV2ZW50LnRhcmdldCkgfQoJCWNhbi5vbmFjdGlvbi5fZmlndXJlKGV2ZW50LCBjYW4sIGNhbi5wb2ludC5jb25jYXQocG9pbnQpKQoJfSwKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIHBvaW50ID0gY2FuLm9uZXhwb3J0Ll9wb2ludChldmVudCwgY2FuKQoJCWlmIChjYW4uQWN0aW9uKCJnbyIpID09IGljZS5SVU4pIHsgY2FuLm9uaW1wb3J0Ll9wcm9maWxlKGNhbiwgZXZlbnQudGFyZ2V0KQoJCQlyZXR1cm4gZXZlbnQuc2hpZnRLZXk/IGNhbi5vbmFjdGlvbi5fbW9kZS5ydW4oZXZlbnQsIGNhbik6IGNhbi5vbmRldGFpbC5ydW4oZXZlbnQsIGNhbikKCQl9CgkJY2FuLm9uYWN0aW9uLl9maWd1cmUoZXZlbnQsIGNhbiwgY2FuLnBvaW50ID0gY2FuLnBvaW50LmNvbmNhdChwb2ludCkpCgl9LAoJb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbmRldGFpbC5sYWJlbChldmVudCwgY2FuKQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLnu4Tku7bor6bmg4UiLCBsaXN0OiBbY2xpLlNUQVJULCBpY2UuUlVOLCBpY2UuQ09QWSwgaHRtbC5MQUJFTCwgbWRiLk1PRElGWSwgInRvaW1hZ2UiLCBtZGIuREVMRVRFXSwKCXN0YXJ0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQl2YXIgbGlzdCA9IFt0YXJnZXRdLCBkaWN0ID0ge30KCQlmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsgdmFyIHNoaXAgPSBsaXN0W2ldLlZhbHVlKCJzaGlwIikKCQkJZm9yICh2YXIgaiA9IDA7IGogPCBzaGlwLmxlbmd0aDsgaisrKSB7IHZhciBwaWQgPSBzaGlwW2pdLnBpZAoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK3BpZCwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCXZhciBwaWQgPSBpdGVtLlZhbHVlKCJzaGlwIilbMV0ucGlkCgkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK3BpZCwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCQkhZGljdFtwaWRdICYmIGxpc3QucHVzaChpdGVtKSwgZGljdFtwaWRdID0gdHJ1ZQoJCQkJCX0pCgkJCQl9KQoJCQl9CgkJfQoJCWNhbi5jb3JlLk5leHQobGlzdCwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgeyBjYW4uY29yZS5UaW1lcigzMDAwLCBmdW5jdGlvbigpIHsKCQkJY2FuLm9ubW90aW9uLnNob3coY2FuLCB7aW50ZXJ2YWw6IDMwMCwgbGVuZ3RoOiAxMH0sIG51bGwsIGl0ZW0pIAoJCQljYW4udXNlci50b2FzdChjYW4sIGl0ZW0uVmFsdWUoImluZGV4IikpCgkJCWNhbi5vbmRldGFpbC5ydW4oe3RhcmdldDogaXRlbX0sIGNhbiksIG5leHQoKQoJCX0pIH0pCgl9LAoJcnVuOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQlpZiAoIXRhcmdldC5WYWx1ZSgicGlkIikpIHsgY2FuLm9uZmlndXJlLl9waWQoY2FuLCB0YXJnZXQpIH0KCgkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gdGFyZ2V0LlZhbHVlKCJwaWQiKSB9LCBjYW4udWkuZGlzcGxheSkpIHsgcmV0dXJuIH0KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmRpc3BsYXkpLCBjYW4uc3ZnLlZhbHVlKCJwaWQiLCB0YXJnZXQuVmFsdWUoInBpZCIpKQoJCXZhciBpbmRleCA9IHRhcmdldC5WYWx1ZShtZGIuSU5ERVgpOyBpbmRleCAmJiBjYW4ub25hcHBlbmQucGx1Z2luKGNhbiwge3R5cGU6IGNoYXQuU1RPUlksIGluZGV4OiBpbmRleCwgYXJnczogdGFyZ2V0LlZhbHVlKGN0eC5BUkdTKX0sIGZ1bmN0aW9uKHN1YikgewoJCQlzdWIuQ29uZigiaGVpZ2h0IiwgY2FuLkNvbmYoImhlaWdodCIpLWNhbi5zdmcuVmFsKCJoZWlnaHQiKS01MiksIHN1Yi5Db25mKCJ3aWR0aCIsIGNhbi5Db25mKCJ3aWR0aCIpKQoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IGNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtpY2UuUlVOLCBpbmRleF0sIGNtZHMpLCBjYiwgdHJ1ZSkgfQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgc3ViLl9sZWdlbmQpLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLmRpc3BsYXksIHRydWUpCgkJfSwgY2FuLnVpLmRpc3BsYXkpCgl9LAoJY29weTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25maWd1cmUuX2NvcHkoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KSB9LAoJbGFiZWw6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldAoJCXZhciBkZWYgPSB0YXJnZXQuVmFsdWUobWRiLlRFWFQpOyBkZWYgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK2RlZiwgZnVuY3Rpb24oaXRlbSkgewoJCQlkZWYgPSBpdGVtLlZhbHVlKGh0bWwuSU5ORVIpCgkJfSkKCQljYW4udXNlci5wcm9tcHQoaHRtbC5MQUJFTCwgZGVmLCBmdW5jdGlvbih0ZXh0KSB7CgkJCWlmICh0YXJnZXQudGFnTmFtZSA9PSBodG1sLlRFWFQpIHsgcmV0dXJuIHRhcmdldC5pbm5lckhUTUwgPSB0ZXh0IH0KCgkJCWlmIChkZWYgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK2RlZiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJaXRlbS5WYWx1ZShodG1sLklOTkVSLCB0ZXh0KQoJCQl9KS5sZW5ndGggPiAwKSB7CgkJCQlyZXR1cm4KCQkJfQoKCQkJdmFyIGZpZ3VyZSA9IGNhbi5vbmZpZ3VyZS5fZ2V0KGNhbiwgdGFyZ2V0KQoJCQl2YXIgZGF0YSA9IGNhbi5vbmV4cG9ydC5fdGV4dChjYW4sIHRhcmdldCwgZmlndXJlLCB7aW5uZXI6IHRleHR9KQoJCQl2YXIgaXRlbSA9IGNhbi5vbmZpZ3VyZS5fcHVzaChjYW4sIGh0bWwuVEVYVCwgZGF0YSwgdGFyZ2V0Lkdyb3VwKCkpCgkJCXRhcmdldC5WYWx1ZShtZGIuVEVYVCwgY2FuLm9uZmlndXJlLl9waWQoY2FuLCBpdGVtKSkKCQl9KQoJfSwKCW1vZGlmeTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBldmVudC50YXJnZXQpIH0sCgl0b2ltYWdlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2ltYWdlKGV2ZW50LCBjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpLnNwbGl0KCIvIikucG9wKCkuc3BsaXQoIi4iKVswXSwgY2FuLnN2ZykgfSwKCSJkZWxldGUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQlpZiAodGFyZ2V0ID09IGNhbi5zdmcpIHsgcmV0dXJuIH0KCQljYW4uY29yZS5MaXN0KHRhcmdldC5WYWx1ZShpY2UuU0hJUCksIGZ1bmN0aW9uKHZhbHVlKSB7CgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCt2YWx1ZS5waWQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGl0ZW0pCgkJCX0pCgkJfSkKCQl0YXJnZXQuVmFsdWUobWRiLlRFWFQpICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCt0YXJnZXQuVmFsdWUobWRiLlRFWFQpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGl0ZW0pCgkJfSkKCQljYW4ucGFnZS5SZW1vdmUoY2FuLCB0YXJnZXQpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFsiZ3JvdXAiLCAiZmlndXJlIiwgImluZGV4IiwgInBvcyJdLAoJX3Nob3c6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHZhciBmaWd1cmUgPSBjYW4ub25maWd1cmUuX2dldChjYW4sIHRhcmdldCkKCQlmdW5jdGlvbiBzaG93KCkgeyByZXR1cm4gY2FuLm9uZXhwb3J0Ll9zaXplKGNhbiwgdGFyZ2V0LCBmaWd1cmUpK2ljZS5TUCtjYW4ub25leHBvcnQuX3Bvc2l0aW9uKGNhbiwgdGFyZ2V0LCBmaWd1cmUpIH0KCQljYW4uU3RhdHVzKCJmaWd1cmUiLCB0YXJnZXQudGFnTmFtZSsiOiIrdGFyZ2V0LlZhbHVlKCJwaWQiKStpY2UuU1ArKGZpZ3VyZT8gKGZpZ3VyZS5zaG93fHxzaG93KShjYW4sIHRhcmdldCwgZmlndXJlKTogIiIpKQoJCWNhbi5TdGF0dXMoImdyb3VwIiwgdGFyZ2V0Lkdyb3VwcygpfHxjYW4uZ3JvdXAuR3JvdXBzKCl8fGh0bWwuU1ZHKQoJCWNhbi5TdGF0dXMoImluZGV4IiwgdGFyZ2V0LlZhbHVlKCJpbmRleCIpKQoJfSwKCV9zaXplOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB7IHZhciBzaXplID0gZmlndXJlLmRhdGEuc2l6ZXx8e30KCQlyZXR1cm4gIjwoIit0YXJnZXQuVmFsKHNpemVbaHRtbC5IRUlHSFRdfHxodG1sLkhFSUdIVCkraWNlLkZTK3RhcmdldC5WYWwoc2l6ZVtodG1sLldJRFRIXXx8aHRtbC5XSURUSCkrIikiCgl9LAoJX3Bvc2l0aW9uOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB7IHZhciBzaXplID0gZmlndXJlLmRhdGEuc2l6ZXx8e30KCQlyZXR1cm4gIkAoIit0YXJnZXQuVmFsKHNpemVbc3ZnLlhdfHxzdmcuWCkraWNlLkZTK3RhcmdldC5WYWwoc2l6ZVtzdmcuWV18fHN2Zy5ZKSsiKSIKCX0sCglfdGV4dDogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSwgZGF0YSkgeyB2YXIgc2l6ZSA9IGZpZ3VyZS5kYXRhLnNpemV8fHt9CgkJaWYgKGZpZ3VyZS50ZXh0KSB7IHJldHVybiBmaWd1cmUudGV4dChjYW4sIGRhdGEsIHRhcmdldCkgfQoJCXJldHVybiBkYXRhLnggPSB0YXJnZXQuVmFsKHNpemVbc3ZnLlhdfHxzdmcuWCksIGRhdGEueSA9IHRhcmdldC5WYWwoc2l6ZVtzdmcuWV18fHN2Zy5ZKSwgZGF0YQoJfSwKCV9wb2ludDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBwID0gY2FuLnN2Zy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQoJCXZhciBwb2ludCA9IHt4OiBldmVudC5jbGllbnRYLXAueCwgeTogZXZlbnQuY2xpZW50WS1wLnl9CgkJcG9pbnQueCA9IHBvaW50LnggLSBwb2ludC54ICUgcGFyc2VJbnQoY2FuLkFjdGlvbigiZ3JpZCIpKQoJCXBvaW50LnkgPSBwb2ludC55IC0gcG9pbnQueSAlIHBhcnNlSW50KGNhbi5BY3Rpb24oImdyaWQiKSkKCQlyZXR1cm4gY2FuLlN0YXR1cygicG9zIiwgcG9pbnQueCtpY2UuRlMrcG9pbnQueSksIHBvaW50Cgl9LAoKCWNvbnRlbnQ6IGZ1bmN0aW9uKGNhbiwgc3ZnKSB7CgkJcmV0dXJuIFsnPHN2ZyB2ZXJ0aW9uPSIxLjEiIHhtbG5zPSJodHRwczovL3d3dy53My5vcmcvMjAwMC9zdmciIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiJ10uY29uY2F0KAoJCQlzdmc/IGNhbi5jb3JlLkxpc3QoW2h0bWwuSEVJR0hULCBodG1sLldJRFRILCBtZGIuQ09VTlQsICJwaWQiLCAiZ3JpZCIsIGh0bWwuU1RST0tFX1dJRFRILCBodG1sLlNUUk9LRSwgaHRtbC5GSUxMLCBodG1sLkZPTlRfU0laRV0sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCXJldHVybiBzdmcuVmFsdWUoaXRlbSk/IGljZS5TUCArIGl0ZW0gKyAnPSInICsgc3ZnLlZhbHVlKGl0ZW0pICsgJyInOiAiIgoJCQl9KTogWyIgaGVpZ2h0PSIrKChjYW4uQ29uZihodG1sLkhFSUdIVCl8fDQ1MCktNTApKyIgd2lkdGg9IisoY2FuLkNvbmYoaHRtbC5XSURUSCl8fDYwMCldKS5jb25jYXQoWyc+Jywgc3ZnPyBzdmcuaW5uZXJIVE1MOiAiIiwgIjwvc3ZnPiJdKS5qb2luKCIiKQoJfSwKCWN1cnNvcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgaXRlbSwgc2hvdykgewoJCXZhciBwID0gaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQoJCXZhciBxID0ge3g6IGV2ZW50LmNsaWVudFgsIHk6IGV2ZW50LmNsaWVudFl9CgoJCXZhciBwb3MgPSA1LCBtYXJnaW4gPSAyMAoJCXZhciB5ID0gKHEueS1wLnkpL3AuaGVpZ2h0CgkJaWYgKHkgPCAwLjIgJiYgcS55LXAueSA8IG1hcmdpbikgewoJCQlwb3MgLT0gMwoJCX0gZWxzZSBpZiAoeSA+IDAuOCAmJiBxLnktcC55LXAuaGVpZ2h0ID4gLW1hcmdpbikgewoJCQlwb3MgKz0gMwoJCX0KCQl2YXIgeCA9IChxLngtcC54KS9wLndpZHRoCgkJaWYgKHggPCAwLjIgJiYgcS54LXAueCA8IG1hcmdpbikgewoJCQlwb3MgLT0gMQoJCX0gZWxzZSBpZiAoeCA+IDAuOCAmJiBxLngtcC54LSBwLndpZHRoID4gLW1hcmdpbikgewoJCQlwb3MgKz0gMQoJCX0KCgkJcmV0dXJuIChzaG93fHxjYW4uc3ZnKS5zdHlsZS5jdXJzb3IgPSBbCgkJCSJudy1yZXNpemUiLCAibi1yZXNpemUiLCAibmUtcmVzaXplIiwKCQkJInctcmVzaXplIiwgIm1vdmUiLCAiZS1yZXNpemUiLAoJCQkic3ctcmVzaXplIiwgInMtcmVzaXplIiwgInNlLXJlc2l6ZSIsCgkJXVtwb3MtMV0sIHBvcwoJfSwKCWFuY2hvcjogZnVuY3Rpb24odGFyZ2V0LCBwb3MsIHBvaW50KSB7CgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAxOgoJCQljYXNlIDI6CgkJCWNhc2UgMzoKCQkJCXBvaW50LnkgPSB0YXJnZXQuVmFsKHN2Zy5ZKQoJCQkJYnJlYWsKCQkJY2FzZSA0OgoJCQljYXNlIDU6CgkJCWNhc2UgNjoKCQkJCXBvaW50LnkgPSB0YXJnZXQuVmFsKHN2Zy5ZKSArIHRhcmdldC5WYWwoaHRtbC5IRUlHSFQpIC8gMgoJCQkJYnJlYWsKCQkJY2FzZSA3OgoJCQljYXNlIDg6CgkJCWNhc2UgOToKCQkJCXBvaW50LnkgPSB0YXJnZXQuVmFsKHN2Zy5ZKSArIHRhcmdldC5WYWwoaHRtbC5IRUlHSFQpCgkJCQlicmVhawoJCX0KCgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAxOgoJCQljYXNlIDQ6CgkJCWNhc2UgNzoKCQkJCXBvaW50LnggPSB0YXJnZXQuVmFsKHN2Zy5YKQoJCQkJYnJlYWsKCQkJY2FzZSAyOgoJCQljYXNlIDU6CgkJCWNhc2UgODoKCQkJCXBvaW50LnggPSB0YXJnZXQuVmFsKHN2Zy5YKSArIHRhcmdldC5WYWwoaHRtbC5XSURUSCkgLyAyCgkJCQlicmVhawoJCQljYXNlIDM6CgkJCWNhc2UgNjoKCQkJY2FzZSA5OgoJCQkJcG9pbnQueCA9IHRhcmdldC5WYWwoc3ZnLlgpICsgdGFyZ2V0LlZhbChodG1sLldJRFRIKQoJCQkJYnJlYWsKCQl9CgkJcmV0dXJuIHBvaW50Cgl9LAoJcmVzaXplOiBmdW5jdGlvbihldmVudCwgaXRlbSwgYmVnaW4sIHAwLCBwMSwgcG9zKSB7CgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSA1OgoJCQkJaXRlbS5WYWx1ZShzdmcuWCwgYmVnaW4ueCArIHAxLnggLSBwMC54KQoJCQkJaXRlbS5WYWx1ZShzdmcuWSwgYmVnaW4ueSArIHAxLnkgLSBwMC55KQoJCQkJcmV0dXJuCgkJfQoKCQlzd2l0Y2ggKHBvcykgewoJCQljYXNlIDE6CgkJCWNhc2UgMjoKCQkJY2FzZSAzOgoJCQkJaXRlbS5WYWx1ZShzdmcuWSwgYmVnaW4ueSArIHAxLnkgLSBwMC55KQoJCQkJaXRlbS5WYWx1ZShodG1sLkhFSUdIVCwgYmVnaW4uaGVpZ2h0IC0gcDEueSArIHAwLnkpCgkJCQlicmVhawoJCX0KCQlzd2l0Y2ggKHBvcykgewoJCQljYXNlIDE6CgkJCWNhc2UgNDoKCQkJY2FzZSA3OgoJCQkJaXRlbS5WYWx1ZShzdmUuWCwgYmVnaW4ueCArIHAxLnggLSBwMC54KQoJCQkJaXRlbS5WYWx1ZShodG1sLldJRFRILCBiZWdpbi53aWR0aCAtIHAxLnggKyBwMC54KQoJCQkJYnJlYWsKCQl9CgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAzOgoJCQljYXNlIDY6CgkJCWNhc2UgOToKCQkJCWl0ZW0uVmFsdWUoaHRtbC5XSURUSCwgYmVnaW4ud2lkdGggKyBwMS54IC0gcDAueCkKCQkJCWJyZWFrCgkJfQoJCXN3aXRjaCAocG9zKSB7CgkJCWNhc2UgNzoKCQkJY2FzZSA4OgoJCQljYXNlIDk6CgkJCQlpdGVtLlZhbHVlKGh0bWwuSEVJR0hULCBiZWdpbi5oZWlnaHQgKyBwMS55IC0gcDAueSkKCQkJCWJyZWFrCgkJfQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jb2RlL2lubmVyL3Nlc3MuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgYXJncywgY2IpIHsgdmFyIFNFU1MgPSAid2ViLmNvZGUuc2VzcyIKCWNhbi5vbmltcG9ydC50b29sa2l0KGNhbiwge2luZGV4OiBTRVNTfSwgZnVuY3Rpb24oc3ViKSB7CgkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpCgkJCWlmIChjYW4ubWlzYy5ydW5BY3Rpb24oY2FuLCBtc2csIGNtZHMsIGNiLCBraXQuRGljdCgKCQkJCW5mcy5TQVZFLCBmdW5jdGlvbihjbWRzKSB7CgkJCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIFNFU1NdLmNvbmNhdChbY3R4LkFDVElPTiwgbWRiLkNSRUFURSwKCQkJCQkJInRvb2wiLCBKU09OLnN0cmluZ2lmeShjYW4ub25leHBvcnQudG9vbChjYW4pKSwKCQkJCQkJInRhYnMiLCBKU09OLnN0cmluZ2lmeShjYW4ub25leHBvcnQudGFicyhjYW4pKSwKCQkJCQldKSwgY2IsIHRydWUpCgkJCQl9LAoJCQkJbmZzLkxPQUQsIGZ1bmN0aW9uKGNtZHMpIHsKCQkJCQljYW4ub25pbXBvcnQuc2VzcyhjYW4sIHsKCQkJCQkJdG9vbDogSlNPTi5wYXJzZShtc2cuT3B0aW9uKCJ0b29sIikpLAoJCQkJCQl0YWJzOiBKU09OLnBhcnNlKG1zZy5PcHRpb24oInRhYnMiKSksCgkJCQkJfSkKCQkJCX0sCgkJCSkpKSB7IHJldHVybiB9CgkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBTRVNTXS5jb25jYXQoY21kcyksIGNiLCB0cnVlKQoJCX0sIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJfSkKfX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci90ZW1wbGF0ZS5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYikgewoJY2FuLm9uaW1wb3J0LnRvb2xraXQoY2FuLCB7aW5kZXg6ICJ3ZWIuY29kZS50ZW1wbGF0ZSJ9LCBmdW5jdGlvbihzdWIpIHsKCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCQlpZiAoY2FuLm1pc2MucnVuQWN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwga2l0LkRpY3QoCgkJCQluZnMuREVGUywgZnVuY3Rpb24oY21kcykgewoJCQkJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKCJhcmdzIil8fCJbXSIpLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCk7IGNhbi5jb3JlLkl0ZW0oZGF0YSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyBtc2cuT3B0aW9uKGtleSwgdmFsdWUpIH0pCgkJCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBpY2UuUlVOLCAid2ViLmNvZGUudGVtcGxhdGUiLCBuZnMuREVGU10uY29uY2F0KGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQkJCQkJY2FuLm9uaW1wb3J0LnByb2plY3QoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkKCQkJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIG1zZy5PcHRpb24oIm1haW4iKSwgIiIsIGZ1bmN0aW9uKCkgewoJCQkJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGNtZHNbMV0sIDEsIGZ1bmN0aW9uKCkge30pCgkJCQkJCQl9LCB0cnVlKQoJCQkJCQl9LCB0cnVlKQoJCQkJCX0pCgkJCQl9LAoJCQkpKSkgeyByZXR1cm4gfQoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgIndlYi5jb2RlLnRlbXBsYXRlIl0uY29uY2F0KGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQl9LCB0cnVlKQoJCX0sIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJfSkKfX0pCgoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2lucHV0L3Byb3ZpbmNlLmpzIgpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIuaOp+S7tuivpuaDhSIsIGxpc3Q6IFtdLCBwcm92aW5jZToge29uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgY2IoZnVuY3Rpb24oY2FuLCBjYnMpIHsKCWNhbi5yZXF1aXJlKFsiL3JlcXVpcmUvc2h5bGludXguY29tL3gvZWNoYXJ0cy9lY2hhcnRzLmpzIiwgIi9yZXF1aXJlL3NoeWxpbnV4LmNvbS94L2VjaGFydHMvY2hpbmEuanMiXSwgZnVuY3Rpb24oKSB7CgkJdmFyIGNoaW5hX2NoYXJ0ID0gZWNoYXJ0cy5pbml0KGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBbe3R5cGU6IGh0bWwuRElWLCBzdHlsZToge3dpZHRoOiA2MDAsIGhlaWdodDogNDAwfX1dKS5maXJzdCkKCQljaGluYV9jaGFydC5zZXRPcHRpb24oe2dlbzoge21hcDogJ2NoaW5hJ319KSwgY2hpbmFfY2hhcnQub24oaHRtbC5DTElDSywgZnVuY3Rpb24gKHBhcmFtcykgewoJCQl0YXJnZXQudmFsdWUgPSBwYXJhbXMubmFtZSwgY2FuLmNsb3NlKCkKCQl9KSwgY2FuLlN0YXR1cyhtZGIuVE9UQUwsIDM0KSwgY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuKSwgY2FuLmJhc2UuaXNGdW5jKGNicykgJiYgY2JzKGNhbikKCX0pCn0pIH19LCB9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL3N0b3J5L3ZpZGVvLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25pbXBvcnQuc2VsZWN0KGNhbiwgbXNnKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpLCBjYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJY2FuLmNvcmUuVGltZXIoMTIwMDAsIGZ1bmN0aW9uKCkgeyBjYW4ub25hY3Rpb24ucGxheShldmVudCwgY2FuKSB9KQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAidGQgYSIsIGZ1bmN0aW9uKGEpIHsKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgYSwge3RhcmdldDogIiJ9KQoJCX0pCgl9LAoJc2VsZWN0OiBmdW5jdGlvbihjYW4sIG1zZykgewoJCW1zZy5DbGVhcigpLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBkb2N1bWVudC5ib2R5LCBjYW4uT3B0aW9uKCJ0YWdzIiksIGZ1bmN0aW9uKGEsIGluZGV4KSB7CgkJCW1zZy5QdXNoKG1kYi5JTkRFWCwgaW5kZXgpCgkJCW1zZy5QdXNoKG1kYi5OQU1FLCBhLmlubmVyVGV4dCkKCQkJbXNnLlB1c2gobWRiLkxJTkssIGEuaHJlZikKCQkJYS5ocmVmID09IGxvY2F0aW9uLmhyZWYgJiYgY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0ciwgaSkgewoJCQkJCWktMSA9PSBpbmRleCAmJiBjYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdHIsICJzZWxlY3QiKQoJCQkJfSkKCQkJfSkKCQl9KQoJCW1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMsIEpTT04uc3RyaW5naWZ5KFsKCQkJe25hbWU6ICJ0aW1lIiwgdmFsdWU6IGNhbi5iYXNlLlRpbWUobnVsbCwgIiV5LSVtLSVkICVIOiVNOiVTIil9LAoJCQl7bmFtZTogImNvdW50IiwgdmFsdWU6IG1zZy5MZW5ndGgoKX0sCgkJXSkpCgl9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaOp+S7tuS6pOS6kiIsIGxpc3Q6IFtdLAoJbmV4dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbXNnID0gY2FuLl9tc2cKCQltc2cuVGFibGUoZnVuY3Rpb24obGluZSwgaW5kZXgpIHsKCQkJaWYgKGxpbmUubGluayA9PSBsb2NhdGlvbi5ocmVmKSB7CgkJCQlsb2NhdGlvbi5ocmVmID0gbXNnLmxpbmtbaW5kZXgrMV0KCQkJfQoJCX0pCgl9LAoJcGxheTogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5wYWdlLlNlbGVjdEFsbChjYW4sIGRvY3VtZW50LmJvZHksIGh0bWwuVklERU8sIGZ1bmN0aW9uKHZpZGVvKSB7CgkJCXZpZGVvLnBsYXliYWNrUmF0ZSA9IHBhcnNlRmxvYXQoY2FuLk9wdGlvbigicmF0ZSIpKQoJCQl2aWRlby5jdXJyZW50VGltZSA9IHBhcnNlSW50KGNhbi5PcHRpb24oInNraXAiKSkKCQkJdmlkZW8ub250aW1ldXBkYXRlID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWlmICh2aWRlby5jdXJyZW50VGltZSA+IHBhcnNlSW50KGNhbi5PcHRpb24oIm5leHQiKSkpIHsKCQkJCQljYW4ub25hY3Rpb24ubmV4dChldmVudCwgY2FuKQoJCQkJfQoJCQl9LCB2aWRlby5wbGF5KCksIHZpZGVvLnJlcXVlc3RGdWxsc2NyZWVuKCkKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY2hhdC9kaXYuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCXZhciBtZXRhID0ge307IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSkgeyBtZXRhW3ZhbHVlLmtleV0gPSB2YWx1ZS52YWx1ZSB9KQoJCWNhbi5fbWV0YSA9IGNhbi5iYXNlLk9iaihtZXRhLnRleHQsIHttZXRhOiB7bmFtZTogbWV0YS5uYW1lfHwiaGkifSwgbGlzdDogW119KQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoKCQljYW4udWkgPSBjYW4ucGFnZS5BcHBlbmRzKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjaGF0LkxBWU9VVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQl7dHlwZTogaHRtbC5URCwgbGlzdDogW3t2aWV3OiBjaGF0LlBST0pFQ1R9XX0sCgkJCXt0eXBlOiBodG1sLlRELCBsaXN0OiBbe3ZpZXc6IGNoYXQuRElTUExBWX1dfSwKCQkJe3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFt7dmlldzogY2hhdC5QUk9GSUxFfV19LAoJCV19XSB9XSksIGNhbi51aS5wcm9qZWN0Ll9maWVsZHNldCA9IGNhbi51aS5kaXNwbGF5CgoJCWNhbi5vbmltcG9ydC5faXRlbShjYW4sIGNhbi5fbWV0YSwgY2FuLnVpLnByb2plY3QsIGNhbi5vbmltcG9ydC5fc2l6ZShjYW4pKS5jbGljaygpCgl9LAoJX3NpemU6IGZ1bmN0aW9uKGNhbikgewoJCXZhciB3aWR0aCA9IGNhbi5Db25mKGh0bWwuV0lEVEgpLTI2MCwgaGVpZ2h0ID0gY2FuLkNvbmYoaHRtbC5IRUlHSFQpLTEwMAoJCWlmIChjYW4uQ29uZigiYXV0by5jbWQiKSkgewoJCQl3aWR0aCA9IGNhbi5Db25mKGh0bWwuV0lEVEgpLCBoZWlnaHQgPSBjYW4uQ29uZihodG1sLkhFSUdIVCkKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2ZpbGUpCgkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX29wdGlvbikKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fYWN0aW9uKQoJCX0KCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kIHx8IGNhbi51c2VyLm1vZC5pc0RpdikgewoJCQl3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoLCBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLl9vdXRwdXQsIHtzdHlsZToge3dpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHR9fSkKCQl9CgkJcmV0dXJuIHdpZHRoCgl9LAoJX2l0ZW06IGZ1bmN0aW9uKGNhbiwgbm9kZSwgdGFyZ2V0LCB3aWR0aCkgeyB3aWR0aCA9IHdpZHRofHxub2RlLm1ldGEud2lkdGgKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIG5vZGUubWV0YS5uYW1lfHwiaGkiXX0sIHt2aWV3OiBbaHRtbC5MSVNUXX1dKQoJCXVpLmxpc3QuX2ZpZWxkc2V0ID0gY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBub2RlLm1ldGEsIHRhcmdldC5fZmllbGRzZXQsIHdpZHRoKQoKCQl2YXIgbXNnID0gY2FuLnJlcXVlc3Qoe30pOyBtc2cuUHVzaChub2RlLm1ldGEsICIiLCB0cnVlKQoJCXVpLml0ZW0ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4udWkucHJvamVjdCwgImRpdi5pdGVtIiwgdWkuaXRlbSkKCQkJY2FuLmN1cnJlbnQgPSB1aS5pdGVtLCBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkucHJvZmlsZSkKCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgYXJyYXkpIHsKCQkJCXJldHVybiB7dGV4dDogW3ZhbHVlLCBodG1sLlREXSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlrZXkgPT0gInZhbHVlIiAmJiBjYW4ub25tb3Rpb24ubW9kaWZ5cyhjYW4sIGV2ZW50LnRhcmdldCwgZnVuY3Rpb24oZXZlbnQsIHZhbHVlLCBvbGQpIHsKCQkJCQkJbm9kZS5tZXRhW2xpbmUua2V5XSA9IHZhbHVlCgkJCQkJfSkKCQkJCX19CgkJCX0sIGNhbi51aS5wcm9maWxlKQoJCX0KCgkJdWkuaXRlbS5fYWRkID0gZnVuY3Rpb24oZGF0YSkgewoJCQlpZiAobm9kZS5tZXRhLnN0eWxlID09IGh0bWwuU1BBTikgeyB3aWR0aCA9IHdpZHRoICogbm9kZS5saXN0Lmxlbmd0aCB9CgkJCW5vZGUubGlzdC5wdXNoKGRhdGEpCgkJCWlmIChub2RlLm1ldGEuc3R5bGUgPT0gaHRtbC5TUEFOKSB7IHdpZHRoID0gd2lkdGggLyBub2RlLmxpc3QubGVuZ3RoIH0KCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgdWkubGlzdCksIGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHVpLmxpc3QuX2ZpZWxkc2V0KQoJCQljYW4uY29yZS5MaXN0KG5vZGUubGlzdCwgZnVuY3Rpb24obm9kZSkgeyBjYW4ub25pbXBvcnQuX2l0ZW0oY2FuLCBub2RlLCB1aS5saXN0LCB3aWR0aCkgfSkKCQl9CgkJaWYgKG5vZGUubWV0YS5zdHlsZSA9PSBodG1sLlNQQU4pIHsgd2lkdGggPSB3aWR0aCAvIG5vZGUubGlzdC5sZW5ndGggfQoJCWNhbi5jb3JlLkxpc3Qobm9kZS5saXN0LCBmdW5jdGlvbihub2RlKSB7IGNhbi5vbmltcG9ydC5faXRlbShjYW4sIG5vZGUsIHVpLmxpc3QsIHdpZHRoKSB9KQoJCXJldHVybiB1aS5pdGVtCgl9LAoJX3BsdWdpbjogZnVuY3Rpb24oY2FuLCBtZXRhLCB0YXJnZXQsIHdpZHRoKSB7CgkJdmFyIHNpemUgPSB7d2lkdGg6IHdpZHRoLCBoZWlnaHQ6IG1ldGEuaGVpZ2h0fQoJCXZhciBmaWVsZCA9IGNhbi5vbmFwcGVuZC5maWVsZChjYW4sIGNoYXQuTEFZT1VULCB7fSwgdGFyZ2V0KS5maWVsZHNldAoJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBmaWVsZCwgbWV0YS5zdHlsZSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBmaWVsZCwge3N0eWxlOiBzaXplfSkKCgkJbWV0YS5pbmRleCAmJiBjYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY3R4LkNPTU1BTkQsIG1ldGEuaW5kZXhdLCBmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgY2FuLmJhc2UuQ29weSh7CgkJCQlmZWF0dXJlOiBjYW4uYmFzZS5PYmoobXNnLkFwcGVuZCgibWV0YSIpKSwgCgkJCQlpbnB1dHM6IGNhbi5iYXNlLk9iaihtc2cuQXBwZW5kKCJsaXN0IikpLAoJCQkJYXJnczogbWV0YS5hcmdzLAoJCQkJbmFtZTogbWV0YS5uYW1lLAoJCQl9LCBzaXplKSwgWyIvcGx1Z2luL3N0YXRlLmpzIl0sIGZ1bmN0aW9uKHN1YikgewoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl9vdXRwdXQsICB7c3R5bGU6IHNpemV9KQoJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgewoJCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBtZXRhLmluZGV4XSwgY21kcyksIGNiLCB0cnVlKQoJCQkJfQoJCQl9LCB0YXJnZXQsIGZpZWxkKQoJCX0sIHRydWUpCgkJcmV0dXJuIGZpZWxkCgl9LCAKfSwgWyIvcGx1Z2luL2xvY2FsL2NoYXQvZGl2LmNzcyJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaTjeS9nOaVsOaNriIsIGxpc3Q6IFtdLAoJIua3u+WKoCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbWRiLk5BTUUsIGN0eC5JTkRFWCwgY3R4LkFSR1MsIGN0eC5TVFlMRSwgaHRtbC5IRUlHSFQsIGh0bWwuV0lEVEhdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5jdXJyZW50Ll9hZGQoe21ldGE6IGRhdGEsIGxpc3Q6IFtdfSkKCQl9KQoJfSwKCSLkv53lrZgiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCWNhbi5ydW4oZXZlbnQsIFttZGIuTU9ESUZZLCBtZGIuVEVYVCwgSlNPTi5zdHJpbmdpZnkoY2FuLl9tZXRhKV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKQoJCX0sIHRydWUpCgl9LAoJIumihOiniCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25tb3Rpb24uc2hhcmUoZXZlbnQsIGNhbiwgW10sIFttZGIuTElOSywgY2FuLm1pc2MuTWVyZ2VVUkwoY2FuLCB7X3BhdGg6ICIvY2hhdC9kaXYvIitjYW4uT3B0aW9uKCJoYXNoIil9KV0pCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC93aWtpL2RyYXcvcGF0aC5qcyIKVm9sY2Fub3MoIm9uZmlndXJlIiwge2hlbHA6ICLlm77lvaLnu5jliLYiLCBsaXN0OiBbXSwKICAgIHBhdGgydjogeyAvLyA8cGF0aCBkPSJNIHgwLHkwIFEgeDIseTIgeDMseTMgVCB4MSx5MSIvPgogICAgICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LCBjb3B5OiBbXX0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gbGluZShwMCwgcDEpIHsgcmV0dXJuIGNhbi5iYXNlLmpvaW5zKFsKICAgICAgICAgICAgICAgIHN2Zy5NLCBbcDAueCwgcDAueV0sIHN2Zy5RLCBbcDAueCwgcDAueSsocDEueS1wMC55KS8zXSwgWyhwMC54K3AxLngpLzIsIChwMC55K3AxLnkpLzJdLCBzdmcuVCwgW3AxLngsIHAxLnldCiAgICAgICAgICAgIF0pIH0KICAgICAgICAgICAgcmV0dXJuIHtmaWxsOiBodG1sLk5PTkUsIGQ6IGxpbmUocG9pbnRbMF0sIHBvaW50WzFdKX0KICAgICAgICB9LAogICAgfSwKICAgIHBhdGgyaDogeyAvLyA8cGF0aCBkPSJNIHgwLHkwIFEgeDIseTIgeDMseTMgVCB4MSx5MSIvPgogICAgICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LCBjb3B5OiBbXX0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gbGluZShwMCwgcDEpIHsgcmV0dXJuIGNhbi5iYXNlLmpvaW5zKFsKICAgICAgICAgICAgICAgIHN2Zy5NLCBbcDAueCwgcDAueV0sIHN2Zy5RLCBbcDAueCsocDEueC1wMC54KS8zLCBwMC55XSwgWyhwMC54K3AxLngpLzIsIChwMC55K3AxLnkpLzJdLCBzdmcuVCwgW3AxLngsIHAxLnldCiAgICAgICAgICAgIF0pIH0KICAgICAgICAgICAgcmV0dXJuIHtmaWxsOiBodG1sLk5PTkUsIGQ6IGxpbmUocG9pbnRbMF0sIHBvaW50WzFdKX0KICAgICAgICB9LAogICAgfSwKICAgIHBhdGg6IHsgLy8gPHBhdGggZD0iTTEwIDEwIEggOTAgViA5MCBIIDEwIFoiLz4KICAgICAgICBkYXRhOiB7c2l6ZToge30sIGNvcHk6IFsiZCIsICJ0dCIsICJ4eCIsICJ5eSJdLAogICAgICAgICAgICB4OiBmdW5jdGlvbihjYW4sIHZhbHVlLCBjbWQsIHRhcmdldCkgewogICAgICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0dC50eCA9IHZhbHVlLXRhcmdldC5WYWwoInh4IikKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieHgiKSt0dC50eAogICAgICAgICAgICB9LAogICAgICAgICAgICB5OiBmdW5jdGlvbihjYW4sIHZhbHVlLCBjbWQsIHRhcmdldCkgewogICAgICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0dC50eSA9IHZhbHVlLXRhcmdldC5WYWwoInl5IikKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieXkiKSt0dC50eQogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQsIHN0eWxlKSB7CiAgICAgICAgICAgIGlmIChzdHlsZSAmJiBzdHlsZS5kKSB7IHJldHVybiBzdHlsZSB9CiAgICAgICAgICAgIGlmIChwb2ludC5sZW5ndGggPT0gMSkgeyBjYW4uX3RlbXAgPSB7fSB9CiAgICAgICAgICAgIGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgogICAgICAgICAgICBpZiAoY2FuLmtleXMgJiYgY2FuLmtleXMubGVuZ3RoID4gMCkgeyB2YXIgazsKICAgICAgICAgICAgICAgIGsgPSBjYW4uX3RlbXBbcG9pbnQubGVuZ3RoLTFdID0gY2FuLmtleXNbMF0KICAgICAgICAgICAgICAgIHN3aXRjaCAoay50b1VwcGVyQ2FzZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiQyI6IGNhbi5fdGVtcFtwb2ludC5sZW5ndGgrMV0gPSAiLCIKICAgICAgICAgICAgICAgICAgICBjYXNlICJRIjogY2FuLl90ZW1wW3BvaW50Lmxlbmd0aF0gPSAiLCI7IGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhbi5rZXlzID0gY2FuLmtleXMuc2xpY2UoMSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHNraXAgPSAwCiAgICAgICAgICAgIHZhciBlbmQgPSBmYWxzZQogICAgICAgICAgICB2YXIgZGF0YSA9IHsKICAgICAgICAgICAgICAgIGQ6IGNhbi5jb3JlLkxpc3QocG9pbnQsIGZ1bmN0aW9uKHAsIGkpIHsgdmFyIGsgPSBwLmsKICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHNraXApIHtyZXR1cm59CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDogayA9ICJNIjsgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogayA9IGNhbi5fdGVtcFtpXSB8fCBwLmsgfHwgIkwiOyBicmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kKSB7cmV0dXJufQoKICAgICAgICAgICAgICAgICAgICBrID0gay50b1VwcGVyQ2FzZSgpCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIloiOiByZXR1cm4gY2FuLnBvaW50ID0gW10sIGNhbi5fdGVtcCA9IHt9LCBrCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIkwiOiByZXR1cm4gaysiICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiTSI6IHJldHVybiBrKyIgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJIIjogcmV0dXJuIGsrIiAiICsgcC54CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIlYiOiByZXR1cm4gaysiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiQSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBvaW50Lmxlbmd0aCAtIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IGVuZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIgMCAwIDAgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGguc3FydChNYXRoLnBvdyhwb2ludFtpKzFdLnggLSBwLngsIDIpICsgTWF0aC5wb3cocG9pbnRbaSsxXS55IC0gcC55LCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgciArICIgIiArIHIgKyAiIDAgMCAwICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGguc3FydChNYXRoLnBvdyhwb2ludFtpKzFdLnggLSBwLngsIDIpICsgTWF0aC5wb3cocG9pbnRbaSsxXS55IC0gcC55LCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcG9pbnRbaV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBwb2ludFtpXSA9IHBvaW50W2krMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50W2krMV0gPSB0ZW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGNhbi5wb2ludFtpXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGNhbi5wb2ludFtpXSA9IGNhbi5wb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW4ucG9pbnRbaSsxXSA9IHRlbXAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAueCA9IHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAueSA9IHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuZG9uZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXJnID0gIiAwIDAgMCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwID0gaSArIDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgcC54ICsgIiAiICsgcC55ICsgIiAwIDAgMCAiICsgcG9pbnRbaSsxXS54ICsgIiAiICsgcG9pbnRbaSsxXS55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJDIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocG9pbnQubGVuZ3RoIC0gaSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyAocG9pbnRbaS0xXS54K3AueCkvMiArICIgIiArIChwb2ludFtpLTFdLnkrcC55KS8yICsgIiwiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIsIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyAocG9pbnRbaS0xXS54K3AueCkvMiArICIgIiArIChwb2ludFtpLTFdLnkrcC55KS8yICsgIiwiICsgcC54ICsgIiAiICsgcC55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyBwb2ludFtpKzJdLnggKyAiICIgKyBwb2ludFtpKzJdLnkgKyAiLCIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50W2ldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcG9pbnRbaV0gPSBwb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludFtpKzFdID0gdGVtcAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcG9pbnRbaSsxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRbaSsxXSA9IHBvaW50W2krMl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50W2krMl0gPSB0ZW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmRvbmUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiUSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBvaW50Lmxlbmd0aCAtIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IGVuZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIsIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50W2ldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcG9pbnRbaV0gPSBwb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludFtpKzFdID0gdGVtcAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5kb25lID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgcC54ICsgIiAiICsgcC55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBrKyIgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLmpvaW4oIiAiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBkYXRhCiAgICAgICAgfSwKICAgICAgICB0ZXh0OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZGF0YSkgewogICAgICAgICAgICBkYXRhLnggPSAodGFyZ2V0LngxLmJhc2VWYWwudmFsdWUgKyB0YXJnZXQueDIuYmFzZVZhbC52YWx1ZSkgLyAyCiAgICAgICAgICAgIGRhdGEueSA9ICh0YXJnZXQueTEuYmFzZVZhbC52YWx1ZSArIHRhcmdldC55Mi5iYXNlVmFsLnZhbHVlKSAvIDIKICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICB9LAogICAgICAgIHNob3c6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHJldHVybiB0YXJnZXQudGFnTmFtZSArICIgIiArIHRhcmdldC5WYWx1ZSgiZCIpIH0sCiAgICB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy93YWxrX3RyYXNoLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLAogICAgaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCBvdXRwdXQsIGFjdGlvbiwgb3B0aW9uKSB7b3V0cHV0LmlubmVySFRNTCA9ICIiOwogICAgICAgIGlmICghbXNnLnJlc3VsdCB8fCBtc2cucmVzdWx0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIHZhciB0YWJsZSA9IGNhbi5wYWdlLkFwcGVuZFRhYmxlKGNhbiwgbXNnLCBvdXRwdXQsIG1zZy5hcHBlbmQpOwogICAgICAgICAgICB0YWJsZS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtzd2l0Y2ggKGV2ZW50LnRhcmdldC50YWdOYW1lKSB7CiAgICAgICAgICAgICAgICBjYXNlICJURCI6CiAgICAgICAgICAgICAgICAgICAgY2FuLm9uaW1wb3J0LndoaWNoKGV2ZW50LCB0YWJsZSwgbXNnLmFwcGVuZCwgZnVuY3Rpb24oaW5kZXgsIGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYW4uT3B0aW9uKCJmaWxlIiwgZXZlbnQudGFyZ2V0LmlubmVySFRNTC50cmltKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbi5ydW4oZXZlbnQsIFtldmVudC50YXJnZXQuaW5uZXJIVE1MLnRyaW0oKV0sIGZ1bmN0aW9uKG1zZykge30pCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgY2FzZSAiVEgiOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlICJUUiI6CiAgICAgICAgICAgICAgICBjYXNlICJUQUJMRSI6CiAgICAgICAgICAgIH19CiAgICAgICAgICAgIHJldHVybiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZyksIHRhYmxlOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgYWN0aW9uLCBbe3R5cGU6ICJzY3JpcHQiLCBzcmM6ICJodHRwczovL2Nkbi5ib290Y3NzLmNvbS9lY2hhcnRzLzQuMi4wLXJjLjIvZWNoYXJ0cy5qcyJ9XSk7CiAgICAgICAgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgb3V0cHV0LCBbe2luY2x1ZGU6IFsicmVxdWlyZS9zaHlsaW51eC5jb20veC9lY2hhcnRzL2VjaGFydHMuanMiLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjYW4ucGFnZS5BcHBlbmQoY2FuLCBvdXRwdXQsIFt7aW5jbHVkZTogWyJyZXF1aXJlL3NoeWxpbnV4LmNvbS94L2VjaGFydHMvY2hpbmEuanMiLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICAgICAgdmFyIGNoaW5hX2NoYXJ0ID0gZWNoYXJ0cy5pbml0KGNhbi5wYWdlLkFwcGVuZChjYW4sIG91dHB1dCwgW3t0eXBlOiAiZGl2Iiwgc3R5bGU6IHt3aWR0aDogIjYwMHB4IiwgaGVpZ2h0OiAiNDAwcHgifX1dKS5sYXN0KTsKICAgICAgICAgICAgICAgIHZhciBkYXRhID0gbXNnLlRhYmxlKCkKCiAgICAgICAgICAgICAgICB2YXIgeURhdGEgPSBbXTsKICAgICAgICAgICAgICAgIHZhciBiYXJEYXRhID0gW107CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IChkYXRhLmxlbmd0aD4xMD8gMTA6IGRhdGEubGVuZ3RoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgeURhdGEucHVzaChpICsgZGF0YVtpXS5uYW1lKTsKICAgICAgICAgICAgICAgICAgICBiYXJEYXRhLnB1c2goZGF0YVtpXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogW3sKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbXNnLk9wdGlvbigidGl0bGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogdHJ1ZSwgcmlnaHQ6IDI1MCwgdG9wOiAxMCwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFN0eWxlOiB7Y29sb3I6ICcjMkQzRTUzJywgZm9udFNpemU6IDE4fSwKICAgICAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHRydWUsIGZvcm1hdHRlcjogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyYW1zLm5hbWUgKyI6ICIrcGFyYW1zLnZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB2aXN1YWxNYXA6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NvbnRpbnVvdXMnLAogICAgICAgICAgICAgICAgICAgICAgICBvcmllbnQ6ICdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVdpZHRoOiAxMCwKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbUhlaWdodDogODAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFsn6auYJywgJ+S9jiddLAogICAgICAgICAgICAgICAgICAgICAgICBzaG93TGFiZWw6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcmllc0luZGV4OiBbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgbWF4OiBkYXRhWzFdLnZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICBpblJhbmdlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogWycjNkZDRjZBJywgJyNGRkZENjQnLCAnI0ZGNTAwMCddCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTdHlsZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjN0I5M0E3JwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBib3R0b206IDMwLAogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAnbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBncmlkOiB7cmlnaHQ6IDEwLCB0b3A6IDEzNSwgYm90dG9tOiAxMDAsIHdpZHRoOiAnMjAlJ30sCiAgICAgICAgICAgICAgICAgICAgeEF4aXM6IHtzaG93OiBmYWxzZX0sCiAgICAgICAgICAgICAgICAgICAgeUF4aXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NhdGVnb3J5JywKICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJzZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZUdhcDogMTYsCiAgICAgICAgICAgICAgICAgICAgICAgIGF4aXNMaW5lOiB7c2hvdzogZmFsc2UsIGxpbmVTdHlsZToge2NvbG9yOiAnI2RkZCd9fSwKICAgICAgICAgICAgICAgICAgICAgICAgYXhpc1RpY2s6IHtzaG93OiBmYWxzZSwgbGluZVN0eWxlOiB7Y29sb3I6ICcjZGRkJ319LAogICAgICAgICAgICAgICAgICAgICAgICBheGlzTGFiZWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmFsOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFN0eWxlOiB7Y29sb3I6ICcjNDU1QTc0JywgYWxpZ246ICdsZWZ0JywgZm9udFNpemU6IDE0fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpY2g6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNGQUFBMzknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyM0MTk3RkQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHBhcmFtcy5zbGljZSgwLCAxKSkgPCAzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAne2F8JyArIChwYXJzZUludChwYXJhbXMuc2xpY2UoMCwgMSkpICsgMSkgKyAnfScgKyAnICAnICsgcGFyYW1zLnNsaWNlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbignXG4nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAne2J8JyArIChwYXJzZUludChwYXJhbXMuc2xpY2UoMCwgMSkpICsgMSkgKyAnfScgKyAnICAnICsgcGFyYW1zLnNsaWNlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbignXG4nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeURhdGEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGdlbzogewogICAgICAgICAgICAgICAgICAgICAgICBtYXA6ICdjaGluYScsIGxlZnQ6ICdsZWZ0JywgcmlnaHQ6ICcxMDAnLAogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDoge2VtcGhhc2lzOiB7c2hvdzogZmFsc2V9fSwKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVN0eWxlOiB7ZW1waGFzaXM6IHthcmVhQ29sb3I6ICcjZmZmNDY0J319LAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgc2VyaWVzOiBbewogICAgICAgICAgICAgICAgICAgICAgICByb2FtOiBmYWxzZSwgdHlwZTogJ21hcCcsIG5hbWU6ICdtYXBTZXInLAogICAgICAgICAgICAgICAgICAgICAgICBnZW9JbmRleDogMCwgbGFiZWw6IHtzaG93OiBmYWxzZX0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJvYW06IGZhbHNlLCB0eXBlOiAnYmFyJywgbmFtZTogJ2JhclNlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbE1hcDogZmFsc2UsIGJhckdhcDogMCwgYmFyTWF4V2lkdGg6IDgsCiAgICAgICAgICAgICAgICAgICAgICAgIHpsZXZlbDogMTAwLCBpdGVtU3R5bGU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBmdW5jdGlvbihwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnVpbGQgYSBjb2xvciBtYXAgYXMgeW91ciBuZWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JMaXN0ID0gW3tjb2xvclN0b3BzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAwLCBjb2xvcjogJyNGRkQxMTknfSwgLy8gMCUg5aSE55qE6aKc6ImyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAxLCBjb2xvcjogJyNGRkFDNEMnfSwgLy8gMTAwJSDlpITnmoTpopzoibIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX0sIHtjb2xvclN0b3BzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAwLCBjb2xvcjogJyMwMEMwRkEnfSwgLy8gMCUg5aSE55qE6aKc6ImyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAxLCBjb2xvcjogJyMyRjk1RkEnfSwgLy8gMTAwJSDlpITnmoTpopzoibIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX1dOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyYW1zLmRhdGFJbmRleCA8IDM/IGNvbG9yTGlzdFswXTogY29sb3JMaXN0WzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXJCb3JkZXJSYWRpdXM6IDE1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGJhckRhdGEKICAgICAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGNoaW5hX2NoYXJ0LnNldE9wdGlvbihvcHRpb24pOwogICAgICAgICAgICB9XX1dKTsKICAgICAgICB9XX1dKTsKICAgIH0sCiAgICB3aGljaDogZnVuY3Rpb24oZXZlbnQsIHRhYmxlLCBsaXN0LCBjYikge2lmIChldmVudC50YXJnZXQgPT0gdGFibGUpIHtyZXR1cm4gY2IoLTEsICIiKX0KICAgICAgICBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YWJsZSwgInRyIiwgZnVuY3Rpb24odHIsIGluZGV4KSB7aWYgKGV2ZW50LnRhcmdldCA9PSB0cikge3JldHVybiBjYihpbmRleC0xLCAiIil9CiAgICAgICAgICAgIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCAidGgsdGQiLCBmdW5jdGlvbih0ZCwgb3JkZXIpIHsKICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQgPT0gdGQpIHtyZXR1cm4gY2IoaW5kZXgtMSwgbGlzdFtvcmRlcl0pfQogICAgICAgICAgICB9KQogICAgICAgIH0pCiAgICB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9oZWFydC5qcyIKVm9sY2Fub3MoImhlYXJ0Iiwge2hlbHA6ICLlv4PlvaIiLCBsaXN0OiBbXSwKICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LAogICAgICAgIGNvcHk6IFsiZCIsICJuYW1lIiwgIm1ldGEiLCAidHQiLCAieHgiLCAieXkiXSwKICAgICAgICB4OiBmdW5jdGlvbihldmVudCwgY2FuLCB2YWx1ZSwgY21kLCB0YXJnZXQpIHsKICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgaWYgKHZhbHVlICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgdHQudHggPSB2YWx1ZS10YXJnZXQuVmFsKCJ4eCIpCiAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgdGFyZ2V0LlZhbHVlKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKCIrdHQudHgrIiwiK3R0LnR5KyIpIikKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieHgiKSt0dC50eAogICAgICAgIH0sCiAgICAgICAgeTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdmFsdWUsIGNtZCwgdGFyZ2V0KSB7CiAgICAgICAgICAgIHZhciB0dCA9IEpTT04ucGFyc2UodGFyZ2V0LlZhbHVlKCJ0dCIpfHwneyJ0eCI6MCwgInR5IjowfScpCiAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHR0LnR5ID0gdmFsdWUtdGFyZ2V0LlZhbCgieXkiKQogICAgICAgICAgICAgICAgdGFyZ2V0LlZhbHVlKCJ0dCIsIEpTT04uc3RyaW5naWZ5KHR0KSkKICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5WYWwoInl5IikrdHQudHkKICAgICAgICB9LAogICAgfSwgLy8gPGhlYXJ0IGN4PSIyNSIgY3k9Ijc1IiByPSIyMCIvPgogICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsgaWYgKHBvaW50Lmxlbmd0aCA8IDIpIHtyZXR1cm59CgogICAgICAgIHZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdLCBwMiA9IHBvaW50WzJdOwogICAgICAgIHBsID0ge3g6IDIqcDAueCAtIHAxLngsIHk6MipwMC55LXAxLnl9CiAgICAgICAgdmFyIHIwID0gTWF0aC5zcXJ0KE1hdGgucG93KHAwLnggLSBwMS54LCAyKSwgTWF0aC5wb3cocDAueSAtIHAxLnksIDIpKSAvIDIKICAgICAgICB2YXIgZCA9IFsKICAgICAgICAgICAgICAgICJNIiwgcGwueCwgcGwueSwKICAgICAgICAgICAgICAgICJBIiwgcjAsIHIwLCAwLCAwLCAwLCBwMC54LCBwMC55LAogICAgICAgICAgICAgICAgIkEiLCByMCwgcjAsIDAsIDAsIDAsIHAxLngsIHAxLnksCiAgICAgICAgICAgIF0KCiAgICAgICAgaWYgKHBvaW50Lmxlbmd0aCA9PSAzKSB7CiAgICAgICAgICAgIHZhciByMSA9IE1hdGguc3FydChNYXRoLnBvdyhwMi54IC0gcDEueCwgMiksIE1hdGgucG93KHAyLnkgLSBwMS55LCAyKSkKICAgICAgICAgICAgZCA9IGQuY29uY2F0KFsKICAgICAgICAgICAgICAgICJBIiwgcjEsIHIxLCAxODAsIDAsIDAsIHAyLngsIHAyLnksCiAgICAgICAgICAgICAgICAiQSIsIHIxLCByMSwgMTgwLCAwLCAwLCBwbC54LCBwbC55LAogICAgICAgICAgICBdKQogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgICAgIG5hbWU6ICJoZWFydCIsIGQ6IGQuam9pbigiICIpLAogICAgICAgICAgICBtZXRhOiBKU09OLnN0cmluZ2lmeShwb2ludCksCiAgICAgICAgICAgIHR0OiBKU09OLnN0cmluZ2lmeSh7dHg6IDAsIHR5OiAwfSksCiAgICAgICAgICAgIHh4OiBwMC54LCB5eTpwMS55LAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGV2ZW50LnR5cGUgPT0gImNsaWNrIiAmJiBwb2ludC5sZW5ndGggPT0gMyAmJiAoY2FuLnBvaW50ID0gW10pLCBkYXRhCiAgICB9LAogICAgdGV4dDogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKICAgICAgICBkYXRhLnggPSB0YXJnZXQuVmFsKCJjeCIpCiAgICAgICAgZGF0YS55ID0gdGFyZ2V0LlZhbCgiY3kiKQogICAgICAgIHJldHVybiBkYXRhCiAgICB9LAogICAgc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKICAgICAgICByZXR1cm4gImhlYXJ0ICIgKyB0YXJnZXQuVmFsdWUoInR0IikKICAgIH0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wdWJsaXNoL29yZGVyLmpzIgpWb2xjYW5vcygib25lbmdpbmUiLCB7fSkKCgpfY2FuX25hbWUgPSAiL2ZyYW1lLmpzIgpWb2xjYW5vcygib25lbmdpbmUiLCB7aGVscDogIuaQnOe0ouW8leaTjiIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtZXRhLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBjbWRzID0gY21kc3x8W10KCQkJcmV0dXJuIChjYW4ub25lbmdpbmVbY21kc1swXV18fGNhbi5vbmVuZ2luZS5fcmVtb3RlKShldmVudCwgY2FuLCBtc2csIGNhbiwgY21kcywgY2IpCgkJfQoKCQlpZiAoY2FuLm1pc2MuU2VhcmNoKGNhbiwgaWNlLk1TR19TRVNTSUQpKSB7CgkJCWNhbi5taXNjLkNvb2tpZVNlc3NpZChjYW4sIGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5NU0dfU0VTU0lEKSkKCQkJcmV0dXJuIGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5NU0dfU0VTU0lELCAiIikgCgkJfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuSUZSQU1FLCBmdW5jdGlvbihpdGVtKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIGl0ZW0pIH0pCgkJaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uKSB7IFZvbGNhbm9zLm1ldGEuYXJncyA9IGNhbi5iYXNlLk9iaihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShjdHguQVJHUyksIHt9KSB9CgoJCWNhbi5vbmVuZ2luZS5saXN0ZW4oY2FuLCBjaGF0Lk9OU0VBUkNILCBmdW5jdGlvbihtc2csIHdvcmQpIHsgaWYgKHdvcmRbMF0gPT0gY3R4LkNPTU1BTkQgfHwgd29yZFsxXSAhPSAiIikgeyB2YXIgbWV0YSA9IGNhbi5vbmVuZ2luZS5wbHVnaW4ubWV0YQoJCQl2YXIgbGlzdCA9IHdvcmRbMV0gPT0gIiI/IG1ldGE6IG1ldGFbd29yZFsxXV0/IGtpdC5EaWN0KHdvcmRbMV0sIG1ldGFbd29yZFsxXV0pOiB7fQoJCQljYW4uY29yZS5JdGVtKGxpc3QsIGZ1bmN0aW9uKG5hbWUsIGNvbW1hbmQpIHsgbmFtZSA9IGNhbi5iYXNlLnRyaW1QcmVmaXgobmFtZSwgImNhbi4iKQoJCQkJY2FuLmNvcmUuTGlzdChtc2cuT3B0aW9uKGljZS5NU0dfRklFTERTKS5zcGxpdChpY2UuRlMpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJbXNnLlB1c2goaXRlbSwga2l0LkRpY3QoaWNlLkNUWCwgIm9uZW5naW5lIiwgaWNlLkNNRCwgImNvbW1hbmQiLAoJCQkJCQltZGIuVFlQRSwgImNhbiIsIG1kYi5OQU1FLCBuYW1lLCBtZGIuVEVYVCwgY29tbWFuZC5oZWxwLAoJCQkJCQljdHguQ09OVEVYVCwgImNhbiIsIGN0eC5DT01NQU5ELCBuYW1lCgkJCQkJKVtpdGVtXXx8IiIpCgkJCQl9KQoJCQl9KQoJCX0gfSkKCgkJY2FuLmNvcmUuTmV4dChsaXN0LCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGl0ZW0udHlwZSA9IGNoYXQuUEFORUwKCQkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgY2FuLmJhc2UuQ29weShpdGVtLCBjYW4uY29yZS5WYWx1ZShjYW4uX3Jvb3QsIFtjaGF0LlJJVkVSLCBpdGVtLm5hbWVdKSksIGl0ZW0ubGlzdCwgZnVuY3Rpb24ocGFuZWwpIHsKCQkJCXBhbmVsLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gcGFuZWwucmVxdWVzdChldmVudCk7IGNtZHMgPSBjbWRzfHxbXQoJCQkJCXJldHVybiAoY2FuLm9uZW5naW5lW2NtZHNbMF1dfHxjYW4ub25lbmdpbmUuX3JlbW90ZSkoZXZlbnQsIGNhbiwgbXNnLCBwYW5lbCwgY21kcywgY2IpCgkJCQl9LCBjYW5baXRlbS5uYW1lXSA9IHBhbmVsLCBwYW5lbC5fcm9vdCA9IGNhbiwgcGFuZWwuX3RyYW5zID0gcGFuZWwub25hY3Rpb24gJiYgcGFuZWwub25hY3Rpb24uX3RyYW5zfHx7fQoKCQkJCWNhbi5jb3JlLkl0ZW1DQihwYW5lbC5vbmFjdGlvbiwgZnVuY3Rpb24oa2V5LCBjYikgewoJCQkJCWNhbi5vbmVuZ2luZS5saXN0ZW4oY2FuLCBrZXksIGZ1bmN0aW9uKG1zZykgeyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2NhbjogcGFuZWwsIG1zZzogbXNnfSkgfSkKCQkJCX0pLCBjYW4uY29yZS5DYWxsRnVuYyhbcGFuZWwub25hY3Rpb24sICJfaW5pdCJdLCB7Y2FuOiBwYW5lbCwgY2I6IG5leHQsIHRhcmdldDogcGFuZWwuX3RhcmdldH0pCgkJCX0sIHRhcmdldCkKCQl9LCBmdW5jdGlvbigpIHsgY2FuLm1pc2MuTG9nKGNhbi51c2VyLnRpdGxlKCksIGljZS5SVU4sIGNhbikKCQkJY2FuLnJlcXVpcmUoW2Nhbi52b2xjYW5vXSwgbnVsbCwgZnVuY3Rpb24oY2FuLCBuYW1lLCBzdWIpIHsgY2FuW25hbWVdID0gc3ViIH0pCgkJCWNhbi5vbmxheW91dC50b3BpYyhjYW4pLCBjYW4ub25tb3Rpb24uX2luaXQoY2FuLCB0YXJnZXQpLCBjYW4ub25rZXltYXAuX2luaXQoY2FuKQoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTk1BSU4sIGNhbi5yZXF1ZXN0KCkpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQl9KQoJfSwKCV9zZWFyY2g6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1zZywgcGFuZWwsIGNtZHMsIGNiKSB7CgkJdmFyIHN1YiwgbW9kID0gY2FuLCBmdW4gPSBjYW4sIGtleSA9ICIiOyBjYW4uY29yZS5MaXN0KGNtZHNbMV0uc3BsaXQoaWNlLlBUKSwgZnVuY3Rpb24odmFsdWUpIHsKCQkJZnVuICYmIChzdWIgPSBtb2QsIG1vZCA9IGZ1biwgZnVuID0gbW9kW3ZhbHVlXSwga2V5ID0gdmFsdWUpCgkJfSk7IGlmICghc3ViIHx8ICFtb2QgfHwgIWZ1bikgeyBjYW4ubWlzYy5XYXJuKGljZS5FcnJOb3RGb3VuZCwgY21kcykKCQkJcmV0dXJuIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnLkVjaG8oaWNlLkVycldhcm4sIGljZS5FcnJOb3RGb3VuZCwgY21kcykpCgkJfQoKCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoZnVuLCB7CgkJCWV2ZW50OiBldmVudCwgY2FuOiBzdWIsIG1zZzogbXNnLCBjbWRzOiBjbWRzLnNsaWNlKDIpLCBjYjogY2IsIHRhcmdldDogc3ViLl90YXJnZXQsCgkJCWJ1dHRvbjoga2V5LCBjbWQ6IGtleSwgYXJnOiBjbWRzLnNsaWNlKDIpLCBsaXN0OiBjbWRzLnNsaWNlKDIpLAoJCX0sIG1vZCkKCX0sCglfZW5naW5lOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikgeyByZXR1cm4gZmFsc2UgfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1zZywgcGFuZWwsIGNtZHMsIGNiKSB7CgkJaWYgKGNtZHNbMF0gPT0gY3R4LkFDVElPTiAmJiBjbWRzWzFdID09IGljZS5SVU4gJiYgY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2NtZHNbMl1dKSB7CgkJCXJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhjYW4ub25lbmdpbmUucGx1Z2luLm1ldGFbY21kc1syXV0sIHttc2c6IG1zZywgY21kczogY21kcy5zbGljZSgzKSwgY2I6IGNifSksIHRydWUKCQl9CgkJdmFyIHAgPSBjYW4ub25lbmdpbmUucGx1Z2luLm1ldGFbY21kc1swXV07IGlmIChwKSB7CgkJCWlmIChwLm1ldGEgJiYgcC5tZXRhW2NtZHNbMV1dICYmIGNtZHNbMF0gPT0gY3R4LkFDVElPTikgewoJCQkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKHAubWV0YVtjbWRzWzFdXSwge2NhbjogY2FuLCBtc2c6IG1zZywgY21kczogY21kcy5zbGljZSgzKSwgY2I6IGNifSksIHRydWUKCQkJfSBlbHNlIGlmIChwLm1ldGEgJiYgcC5tZXRhW2NtZHNbMF1dKSB7CgkJCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMocC5tZXRhW2NtZHNbMF1dLCB7Y2FuOiBjYW4sIG1zZzogbXNnLCBjbWRzOiBjbWRzLnNsaWNlKDIpLCBjYjogY2J9KSwgdHJ1ZQoJCQl9CgkJCXJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhwLCB7Y2FuOiBjYW4sIG1zZzogbXNnLCBjbWRzOiBjbWRzLnNsaWNlKDEpLCBjYjogY2J9KSwgdHJ1ZQoJCX0KCQlyZXR1cm4gZmFsc2UKCX0sCglfcmVtb3RlOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikgewoJCW1zZy5vcHRpb24gPSBjYW4uY29yZS5MaXN0KG1zZy5vcHRpb24sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJcmV0dXJuIHtfdG9hc3Q6IHRydWUsIF9oYW5kbGU6IHRydWV9W2l0ZW1dICYmIGRlbGV0ZShtc2dbaXRlbV0pPyB1bmRlZmluZWQ6IGl0ZW0KCQl9KQoKCQlpZiAocGFuZWwub25lbmdpbmUuX2VuZ2luZShldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikpIHsgcmV0dXJuIH0KCQlpZiAocGFuZWwub25lbmdpbmUuX3BsdWdpbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikpIHsgcmV0dXJuIH0KCgkJdmFyIGtleSA9IGNhbi5jb3JlLktleXMocGFuZWwuX25hbWUsIGNtZHMuam9pbihpY2UuRlMpKQoJCWlmIChjYW4udXNlci5pc0xvY2FsRmlsZSkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBtc2cuQ2xlYXIoaWNlLk1TR19BUFBFTkQpCgkJCXZhciByZXMgPSBWb2xjYW5vcy5tZXRhLnBhY2tba2V5XTsgcmVzPyBtc2cuQ29weShyZXMpOiBjYW4udXNlci50b2FzdChjYW4sICLnvLrlpLHmlbDmja4iKQoJCQlyZXR1cm4gY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJfQoKCQl2YXIgdG9hc3Q7IGlmIChtc2cuT3B0aW9uKCJfdG9hc3QiKSkgeyBjYW4uY29yZS5UaW1lcigxMDAwLCBmdW5jdGlvbigpIHsKCQkJdG9hc3QgPSB0b2FzdHx8Y2FuLnVzZXIudG9hc3QoY2FuLCBtc2cuT3B0aW9uKCJfdG9hc3QiKSwgbXNnLl9jYW4uX25hbWUsIC0xKQoJCX0pIH0KCQl2YXIgbmFtZXMgPSBtc2cuT3B0aW9uKCJfbmFtZXMiKXx8cGFuZWwuX25hbWVzfHwoKGNhbi5Db25mKCJpY2ViZXJnIil8fCIvY2hhdC8iKStwYW5lbC5fbmFtZSkKCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTlJFTU9URSwgY2FuLnJlcXVlc3Qoe30sIHtfZm9sbG93OiBwYW5lbC5fZm9sbG93LCBfbXNnOiBtc2csIF9jbWRzOiBjbWRzfSkpCgkJY2FuLm1pc2MuUnVuKGV2ZW50LCBjYW4sIHtuYW1lczogbmFtZXMsIGRhZW1vbjogY2FuLmNvcmUuS2V5cyhjYW4ub25kYWVtb24uX2xpc3RbMF0sIG1zZy5fZGFlbW9uKX0sIGNtZHMsIGZ1bmN0aW9uKG1zZykgewoJCQlWb2xjYW5vcy5tZXRhLnBhY2tba2V5XSA9IG1zZywgZGVsZXRlKG1zZy5faGFuZGxlKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJCXRvYXN0ICYmIHRvYXN0LmNsb3NlKCksIHRvYXN0ID0gdHJ1ZSwgZGVsZXRlKG1zZy5fdG9hc3QpCgkJfSkKCX0sCgoJcGx1Z2luOiBzaHkoIua3u+WKoOaPkuS7tiIsIHt9LCBbXSwgZnVuY3Rpb24oY2FuLCBuYW1lLCBjb21tYW5kKSB7IG5hbWUgPSBjYW4uYmFzZS50cmltUHJlZml4KG5hbWUsICJjYW4uIikKCQl2YXIgdHlwZSA9IGh0bWwuVEVYVDsgY29tbWFuZC5saXN0ID0gY2FuLmNvcmUuTGlzdChjb21tYW5kLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJc3dpdGNoICh0eXBlb2YgaXRlbSkgewoJCQkJY2FzZSBsYW5nLlNUUklORzogcmV0dXJuIGNhbi5jb3JlLlNwbGl0SW5wdXQoaXRlbSkKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6IHJldHVybiB0eXBlID0gaXRlbS50eXBlfHx0eXBlLCBpdGVtCgkJCX0KCQl9KSwgYXJndW1lbnRzLmNhbGxlZS5tZXRhW2Nhbi5jb3JlLktleXMoImNhbiIsIG5hbWUpXSA9IGNvbW1hbmQKCX0pLAoJbGlzdGVuOiBzaHkoIuebkeWQrOS6i+S7tiIsIHt9LCBbXSwgZnVuY3Rpb24oY2FuLCBuYW1lLCBjYikgeyBhcmd1bWVudHMuY2FsbGVlLm1ldGFbbmFtZV0gPSAoYXJndW1lbnRzLmNhbGxlZS5tZXRhW25hbWVdfHxbXSkuY29uY2F0KGNiKSB9KSwKCXNpZ25hbDogc2h5KCLop6blj5Hkuovku7YiLCBmdW5jdGlvbihjYW4sIG5hbWUsIG1zZykgeyBtc2cgPSBtc2d8fGNhbi5yZXF1ZXN0KCkKCQljYW4ubWlzYy5Mb2coZ2RiLlNJR05BTCwgbmFtZSwgbmFtZSA9PSBjaGF0Lk9OUkVNT1RFPyBtc2cuT3B0aW9uKCJfbXNnIik6IG1zZykKCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChjYW4ub25lbmdpbmUubGlzdGVuLm1ldGFbbmFtZV0sIGZ1bmN0aW9uKGNiKSB7IGNhbi5jb3JlLkNhbGxGdW5jKGNiLCB7ZXZlbnQ6IG1zZy5fZXZlbnQsIG1zZzogbXNnfSkgfSkubGVuZ3RoCgl9KSwKfSkKVm9sY2Fub3MoIm9uZGFlbW9uIiwge2hlbHA6ICLmjqjojZDlvJXmk44iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbmFtZSkgeyBpZiAoY2FuLnVzZXIuaXNMb2NhbEZpbGUpIHsgcmV0dXJuIH0KCQljYW4ubWlzYy5XU1MoY2FuLCB7dHlwZTogaHRtbC5DSFJPTUUsIG5hbWU6IGNhbi5taXNjLlNlYXJjaChjYW4sIGNsaS5EQUVNT04pfHxuYW1lfHwiIn0sIGZ1bmN0aW9uKGV2ZW50LCBtc2csIGNtZCwgYXJnKSB7IGlmICghbXNnKSB7IHJldHVybiB9CgkJCXZhciBzdWIgPSBjYW4ub25kYWVtb24uX2xpc3RbbXNnLk9wdGlvbihpY2UuTVNHX1RBUkdFVCldCgkJCWNhbi5iYXNlLmlzRnVuYyhjYW4ub25kYWVtb25bY21kXSk/IGNhbi5jb3JlLkNhbGxGdW5jKGNhbi5vbmRhZW1vbltjbWRdLCB7CgkJCQljYW46IGNhbiwgc3ViOiBzdWIsIG1zZzogbXNnLCBjbWQ6IGNtZCwgYXJnOiBhcmcsIGNiOiBmdW5jdGlvbigpIHsgbXNnLlJlcGx5KCkgfSwKCQkJfSk6IGNhbi5vbmVuZ2luZS5fc2VhcmNoKHt9LCBjYW4sIG1zZywgY2FuLCBbIl9zZWFyY2giLCBjbWRdLmNvbmNhdChhcmcpLCBmdW5jdGlvbigpIHsgbXNnLlJlcGx5KCkgfSkKCQl9KQoJfSwgX2xpc3Q6IFsiIl0sCglyZWZyZXNoOiBmdW5jdGlvbihjYW4sIG1zZywgc3ViKSB7IHN1Yi5VcGRhdGUoKSB9LAoJcHdkOiBmdW5jdGlvbihjYW4sIG1zZywgYXJnKSB7IGNhbi5vbmRhZW1vbi5fbGlzdFswXSA9IGFyZ1swXSB9LAoJZ3JvdzogZnVuY3Rpb24oY2FuLCBtc2csIHN1YiwgYXJnKSB7IHN1Yi5vbmltcG9ydC5fZ3JvdyhzdWIsIGNhbi5wYWdlLkNvbG9yKGFyZy5qb2luKCIiKSkpIH0sCgl0b2FzdDogZnVuY3Rpb24oY2FuLCBtc2csIGFyZykgeyBjYW4uY29yZS5DYWxsRnVuYyhjYW4udXNlci50b2FzdCwge2NhbjogY2FuLCBtc2c6IG1zZywgY21kczogYXJnfSkgfSwKfSkKVm9sY2Fub3MoIm9uYXBwZW5kIiwge2hlbHA6ICLmuLLmn5PlvJXmk44iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgbGlzdCwgY2IsIHRhcmdldCwgZmllbGQpIHsKCQltZXRhLm5hbWUgPSAobWV0YS5uYW1lfHwiIikuc3BsaXQoaWNlLlNQKVswXS5zcGxpdChpY2UuUFQpLnBvcCgpCgkJZmllbGQgPSBmaWVsZHx8Y2FuLm9uYXBwZW5kLmZpZWxkKGNhbiwgbWV0YS50eXBlLCBtZXRhLCB0YXJnZXQpLmZpcnN0CgkJdmFyIGxlZ2VuZCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkxFR0VORClbMF0KCQl2YXIgb3B0aW9uID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZmllbGQsIGh0bWwuRk9STV9PUFRJT04pWzBdCgkJdmFyIGFjdGlvbiA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkRJVl9BQ1RJT04pWzBdCgkJdmFyIG91dHB1dCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkRJVl9PVVRQVVQpWzBdCgkJdmFyIHN0YXR1cyA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkRJVl9TVEFUVVMpWzBdCgoJCXZhciBzdWIgPSBWb2xjYW5vcyhtZXRhLm5hbWUsIHtfZm9sbG93OiBjYW4uY29yZS5LZXlzKGNhbi5fZm9sbG93LCBtZXRhLm5hbWUpLCBfdGFyZ2V0OiBmaWVsZCwKCQkJX2xlZ2VuZDogbGVnZW5kLCBfb3B0aW9uOiBvcHRpb24sIF9hY3Rpb246IGFjdGlvbiwgX291dHB1dDogb3V0cHV0LCBfc3RhdHVzOiBzdGF0dXMsCgkJCV9pbnB1dHM6IHt9LCBfb3V0cHV0czogW10sIF9oaXN0b3J5OiBbXSwKCgkJCVN0YXR1czogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewoJCQkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oa2V5LCBzdWIuU3RhdHVzKSwga2V5IH0KCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHN0YXR1cywgW1tbaHRtbC5ESVYsIGtleV0sIGh0bWwuU1BBTl1dLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJcmV0dXJuIHZhbHVlID09IHVuZGVmaW5lZD8gKHZhbHVlID0gaXRlbS5pbm5lckhUTUwpOiAoaXRlbS5pbm5lckhUTUwgPSB2YWx1ZSkKCQkJCX0pOyByZXR1cm4gdmFsdWUKCQkJfSwKCQkJQWN0aW9uOiBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiBjYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgYWN0aW9uLCBrZXksIHZhbHVlKVswXSB9LAoJCQlPcHRpb246IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBvcHRpb24sIGtleSwgdmFsdWUpWzBdIH0sCgkJCVVwZGF0ZTogZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiLCBzaWxlbnQpIHsgc3ViLm9uYXBwZW5kLl9vdXRwdXQwKHN1Yiwgc3ViLkNvbmYoKSwgZXZlbnR8fHt9LCBjbWRzfHxzdWIuSW5wdXQoKSwgY2IsIHNpbGVudCk7IHJldHVybiB0cnVlIH0sCgkJCUZvY3VzOiBmdW5jdGlvbigpIHsgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgb3B0aW9uLCBodG1sLklOUFVUX0FSR1MsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7IGluZGV4ID09IDAgJiYgaXRlbS5mb2N1cygpIH0pIH0sCgkJCUlucHV0OiBmdW5jdGlvbihjbWRzLCBzaWxlbnQpIHsKCQkJCWNtZHMgPSBjbWRzICYmIGNtZHMubGVuZ3RoID4gMD8gY21kczogY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIG9wdGlvbiwgIiIpLmNvbmNhdChjYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgYWN0aW9uLCAiIikpLCBjbWRzID0gY2FuLmJhc2UudHJpbShjbWRzKQoJCQkJc2lsZW50IHx8IGNtZHNbMF0gPT0gY3R4LkFDVElPTiB8fCBjYW4uYmFzZS5FcShzdWIuX2hpc3Rvcnlbc3ViLl9oaXN0b3J5Lmxlbmd0aC0xXSwgY21kcykgfHwgc3ViLl9oaXN0b3J5LnB1c2goY21kcykKCQkJCXJldHVybiBjbWRzCgkJCX0sCgkJCUNsb25lOiBmdW5jdGlvbigpIHsgbWV0YS5hcmdzID0gY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIG9wdGlvbiwgIiIpCgkJCQljYW4ub25hcHBlbmQuX2luaXQoY2FuLCBtZXRhLCBsaXN0LCBmdW5jdGlvbihzdWIpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIsIHRydWUpCgkJCQkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBmb3IgKHZhciBrIGluIHN1Yi5faW5wdXRzKSB7IGNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIHN1Yi5faW5wdXRzW2tdLl90YXJnZXQpOyBicmVhayB9IH0pCgkJCQl9LCB0YXJnZXQpCgkJCX0sCgkJfSwgbGlzdCwgZnVuY3Rpb24oc3ViKSB7IHN1Yi5Db25mKG1ldGEpLCBtZXRhLmZlYXR1cmUgPSBjYW4uYmFzZS5PYmoobWV0YS5mZWF0dXJlLCB7fSkKCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGZpZWxkLCBtZXRhLmluZGV4PyBtZXRhLmluZGV4LnNwbGl0KGljZS5QVCkucG9wKCk6IG1ldGEubmFtZSkKCQkJdmFyIHN0eWxlID0gY2FuLmJhc2UuZ2V0VmFsaWQobWV0YS5zdHlsZSwgbWV0YS5mZWF0dXJlLnN0eWxlKTsgc3dpdGNoICh0eXBlb2Ygc3R5bGUpIHsKCQkJCWNhc2UgbGFuZy5TVFJJTkc6IGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBmaWVsZCwgc3R5bGUpOyBicmVhawoJCQkJY2FzZSBsYW5nLk9CSkVDVDogY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX3RhcmdldCwgc3R5bGUpOyBicmVhawoJCQl9CgoJCQltZXRhLmlucHV0cyAmJiBzdWIub25hcHBlbmQuX29wdGlvbihzdWIsIG1ldGEsIHN1Yi5fb3B0aW9uLCBtZXRhLm1zZykKCQkJaWYgKG1ldGEubXNnKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdCgpOyBtc2cuQ29weShjYW4uYmFzZS5PYmoobWV0YS5tc2cpKSwgc3ViLm9uYXBwZW5kLl9vdXRwdXQoc3ViLCBtc2csIG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKXx8bWV0YS5mZWF0dXJlLmRpc3BsYXkpIH0KCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fbGVnZW5kLCBraXQuRGljdChjYW4uQ29uZigibGVnZW5kX2V2ZW50Iil8fCJvbm1vdXNlZW50ZXIiLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnVzZXIuY2FydGUoZXZlbnQsIHN1Yiwgc3ViLm9uYWN0aW9uLCBzdWIub25hY3Rpb24ubGlzdC5jb25jYXQoW1si5omA5pyJIl0uY29uY2F0KGNhbi5jb3JlLkl0ZW0obWV0YS5mZWF0dXJlLl90cmFucykpXSksIGZ1bmN0aW9uKGV2ZW50LCBpdGVtLCBtZXRhKSB7CgkJCQkJdmFyIGNiID0gY2FuLmNvcmUuVmFsdWUoc3ViLCBbIl9vdXRwdXRzLi0xLm9uYWN0aW9uIiwgaXRlbV0pCgkJCQkJaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikpIHsgcmV0dXJuIGNiKGV2ZW50LCBjYW4uY29yZS5WYWx1ZShzdWIsICJfb3V0cHV0cy4tMSIpLCBpdGVtKSB9CgkJCQkJdmFyIGNiID0gbWV0YVtpdGVtXXx8bWV0YVsiX2VuZ2luZSJdCgkJCQkJaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikpIHsgcmV0dXJuIGNiKGV2ZW50LCBzdWIsIGl0ZW0pIH0KCQkJCX0pCgkJCX0pKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpCgkJfSk7IHJldHVybiBzdWIKCX0sCglfb3B0aW9uOiBmdW5jdGlvbihjYW4sIG1ldGEsIG9wdGlvbiwgc2tpcCkgeyBtZXRhID0gbWV0YXx8e307IHZhciBpbmRleCA9IC0xLCBhcmdzID0gY2FuLmJhc2UuT2JqKG1ldGEuYXJnc3x8bWV0YS5hcmd8fG1ldGEub3B0LCBbXSksIG9wdHMgPSBjYW4uYmFzZS5PYmoobWV0YS5vcHRzLCB7fSkKCQlmdW5jdGlvbiBhZGQoaXRlbSwgbmV4dCkgeyBpdGVtID0gY2FuLmJhc2UuaXNTdHJpbmcoaXRlbSk/IHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IGl0ZW19OiBpdGVtLCBpdGVtLnR5cGUgIT0gaHRtbC5CVVRUT04gJiYgaW5kZXgrKwoJCQlyZXR1cm4gVm9sY2Fub3MoaXRlbS5uYW1lLCB7X2ZvbGxvdzogY2FuLmNvcmUuS2V5cyhjYW4uX2ZvbGxvdywgaXRlbS5uYW1lKSwKCQkJCV90YXJnZXQ6IGNhbi5vbmFwcGVuZC5pbnB1dChjYW4sIGl0ZW0sIGFyZ3NbaW5kZXhdfHxvcHRzW2l0ZW0ubmFtZV0sIG9wdGlvbnx8Y2FuLl9vcHRpb24pLAoJCQkJX29wdGlvbjogb3B0aW9ufHxjYW4uX29wdGlvbiwgX2FjdGlvbjogY2FuLl9hY3Rpb24sIF9vdXRwdXQ6IGNhbi5fb3V0cHV0LCBfc3RhdHVzOiBjYW4uX3N0YXR1cywKCQkJCU9wdGlvbjogY2FuLk9wdGlvbiwgQWN0aW9uOiBjYW4uQWN0aW9uLCBTdGF0dXM6IGNhbi5TdGF0dXMsIENsb25lRmllbGQ6IGNhbi5DbG9uZSwKCQkJCUNsb25lSW5wdXQ6IGZ1bmN0aW9uKCkgeyBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBhZGQoaXRlbSkuX3RhcmdldCkgfSwKCQkJfSwgW2l0ZW0uZGlzcGxheSwgY2hhdC5QTFVHSU5fSU5QVVRfSlNdLCBmdW5jdGlvbihpbnB1dCkgeyBpbnB1dC5Db25mKGl0ZW0pCgkJCQlpbnB1dC5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpCgkJCQkJaWYgKGl0ZW0uX2NiKSB7IHJldHVybiBpdGVtLl9jYihldmVudCkgfQoJCQkJCWlmIChtc2cuUnVuQWN0aW9uKGV2ZW50LCBjYW4uY29yZS5WYWx1ZShjYW4sICJfb3V0cHV0cy4tMSIpLCBjbWRzKSkgeyByZXR1cm4gfQoJCQkJCWlmIChtc2cuUnVuQWN0aW9uKGV2ZW50LCBpbnB1dCwgY21kcykpIHsgcmV0dXJuIH0KCQkJCQlyZXR1cm4gY2FuLlVwZGF0ZShldmVudCwgY2FuLklucHV0KGNtZHMsIHNpbGVudCksIGNiLCBzaWxlbnQpCgkJCQl9LCBjYW4uX2lucHV0c1tpdGVtLm5hbWVdID0gaW5wdXQsIGlucHV0LnN1cCA9IGNhbgoKCQkJCWNhbi5jb3JlLkl0ZW1DQihpbnB1dC5vbmFjdGlvbiwgZnVuY3Rpb24oa2V5LCBjYikgeyBpbnB1dC5fdGFyZ2V0W2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgaW5wdXQpIH0gfSkKCQkJCWNhbi5jb3JlLkl0ZW1DQihpdGVtLCBmdW5jdGlvbihrZXksIGNiKSB7IGlucHV0Ll90YXJnZXRba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCBpbnB1dCkgfSB9KQoJCQkJc2tpcD8gbmV4dCgpOiBjYW4uY29yZS5DYWxsRnVuYyhbaW5wdXQub25hY3Rpb24sICJfaW5pdCJdLCBbaW5wdXQsIGl0ZW0sIG5leHQsIGlucHV0Ll90YXJnZXRdKTsKCQkJCShpdGVtLmFjdGlvbnx8Y2FuLmNvcmUuVmFsdWUobWV0YSwgW2N0eC5GRUFUVVJFLCBjdHguSU5QVVRTXSkpICYmIGNhbi5vbmFwcGVuZC5maWd1cmUoaW5wdXQsIGl0ZW0sIGlucHV0Ll90YXJnZXQpCgkJCX0pCgkJfTsgY2FuLmNvcmUuTmV4dChjYW4uYmFzZS5PYmoobWV0YS5pbnB1dHMsIGNhbi5jb3JlLlZhbHVlKGNhbiwgW2NoYXQuT05JTVBPUlQsIG1kYi5MSVNUXSkpLmNvbmNhdChtZXRhLnR5cGUgPT0gY2hhdC5GTE9BVD8gW3t0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogY2xpLkNMT1NFfV06IFtdKSwgYWRkKQoJfSwKCV9hY3Rpb246IGZ1bmN0aW9uKGNhbiwgbGlzdCwgYWN0aW9uLCBtZXRhKSB7CgkJbGlzdCA9IGNhbi5iYXNlLmdldFZhbGlkKGxpc3QsIGNhbi5jb3JlLkl0ZW0obWV0YSkpCgkJbGlzdCA9IGNhbi5iYXNlLk9iaihsaXN0LCBjYW4uY29yZS5WYWx1ZShjYW4sIFtjaGF0Lk9OQUNUSU9OLCBtZGIuTElTVF0pKQoJCXZhciBfbGlzdCA9IFtdOyBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsKCQkJc3dpdGNoIChsaXN0W2ldKSB7IGNhc2UgIiI6IF9saXN0LnB1c2goIiIpOyBicmVhawoJCQkJY2FzZSBtZGIuUEFHRToKCQkJCQlfbGlzdC5wdXNoKHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IG1kYi5MSU1JVCwgdmFsdWU6IGNhbi5fbXNnLk9wdGlvbihtZGIuTElNSVQpfSkKCQkJCQlfbGlzdC5wdXNoKHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IG1kYi5PRkZFTkQsIHZhbHVlOiBjYW4uX21zZy5PcHRpb24obWRiLk9GRkVORCl9KQoJCQkJCV9saXN0LnB1c2gobWRiLlBSRVYsIG1kYi5ORVhUKQoJCQkJCWJyZWFrCgkJCQlkZWZhdWx0OgoJCQkJCShmdW5jdGlvbigpIHsKCQkJCQkJdmFyIGl0ZW0gPSBjYW4uY29yZS5TcGxpdElucHV0KGxpc3RbaV0sIGh0bWwuQlVUVE9OKTsKCQkJCQkJaWYgKGl0ZW0udHlwZSA9PSBodG1sLlNFTEVDVCkgewoJCQkJCQkJaXRlbS5faW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgewoJCQkJCQkJCXRhcmdldC52YWx1ZSA9IGl0ZW0udmFsdWV8fGl0ZW0udmFsdWVzWzBdCgkJCQkJCQkJdGFyZ2V0Lm9uY2hhbmdlID0gZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnJ1bihldmVudCkgfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWl0ZW0uYWN0aW9uICYmIChmdW5jdGlvbigpIHsKCQkJCQkJCWl0ZW0uX2luaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsgY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIGl0ZW0sIHRhcmdldCkgfQoJCQkJCQl9KSgpLCBpdGVtLnR5cGUgPT0gaHRtbC5CVVRUT04/IF9saXN0LnB1c2gobGlzdFtpXSk6IF9saXN0LnB1c2goaXRlbSkKCQkJCQl9KSAoKQoJCQl9CgkJfQoJCW1ldGEgPSBtZXRhfHxjYW4ub25hY3Rpb24sIGFjdGlvbiA9IGFjdGlvbnx8Y2FuLl9hY3Rpb24sIGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGFjdGlvbikKCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChfbGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpZiAoaXRlbSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIH0gY2FuLm9uYXBwZW5kLmlucHV0KGNhbiwgaXRlbSA9PSAiIj8gLyrnqbrnmb0qLyB7dHlwZTogaHRtbC5TUEFDRX06CgkJCWNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pPyAvKuaMiemUriovIHt0eXBlOiBodG1sLkJVVFRPTiwgdmFsdWU6IGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbSksIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl2YXIgY2IgPSBtZXRhW2l0ZW1dfHxtZXRhWyJfZW5naW5lIl07IGNiPyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2V2ZW50OiBldmVudCwgY2FuOiBjYW4sIGJ1dHRvbjogaXRlbX0pOiBjYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaXRlbV0uY29uY2F0KGNhbi5zdXAuSW5wdXQoKSkpCgoJCQl9LCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRU5URVIpIHsKCQkJCQl2YXIgY2IgPSBtZXRhW2l0ZW1dfHxtZXRhWyJfZW5naW5lIl07IGNiPyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2V2ZW50OiBldmVudCwgY2FuOiBjYW4sIGJ1dHRvbjogaXRlbX0pOiBjYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaXRlbV0uY29uY2F0KGNhbi5zdXAuSW5wdXQoKSkpCgkJCQl9CgoJCQl9fTogaXRlbS5sZW5ndGggPiAwPyAvKuWIl+ihqCovIHt0eXBlOiBodG1sLlNFTEVDVCwgbmFtZTogaXRlbVswXSwgdmFsdWVzOiBpdGVtLnNsaWNlKDEpLCBvbmNoYW5nZTogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciB3aGljaCA9IGl0ZW1bZXZlbnQudGFyZ2V0LnNlbGVjdGVkSW5kZXgrMV0KCQkJCWNhbi5jb3JlLkNhbGxGdW5jKG1ldGFbd2hpY2hdLCBbZXZlbnQsIGNhbiwgd2hpY2hdKQoJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMobWV0YVtpdGVtWzBdXSwgW2V2ZW50LCBjYW4sIGl0ZW1bMF0sIHdoaWNoXSkKCgkJCX19OiAvKuWFtuWugyovIGl0ZW0sICIiLCBhY3Rpb24pfSksIG1ldGEKCX0sCglfb3V0cHV0MDogZnVuY3Rpb24oY2FuLCBtZXRhLCBldmVudCwgY21kcywgY2IsIHNpbGVudCkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBpZiAobXNnLlJ1bkFjdGlvbihldmVudCwgY2FuLCBjbWRzKSkgeyByZXR1cm4gfQoJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFKSAhPSBpY2UuVFJVRSAmJiBjbWRzICYmIGNtZHNbMF0gPT0gY3R4LkFDVElPTiAmJiBtZXRhLmZlYXR1cmVbY21kc1sxXV0pIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB7YWN0aW9uOiBjbWRzWzFdfSkKCQkJaWYgKGNhbi5iYXNlLmlzRnVuYyhtZXRhLmZlYXR1cmVbY21kc1sxXV0pKSB7IHJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhtZXRhLmZlYXR1cmVbY21kc1sxXV0sIHtjYW46IGNhbiwgbXNnOiBtc2csIGNtZHM6IGNtZHMuc2xpY2UoMil9KSB9CgkJCXJldHVybiBjYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBtZXRhLmZlYXR1cmVbY21kc1sxXV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB7X2hhbmRsZTogaWNlLlRSVUV9LCBjYW4uT3B0aW9uKCkpCgkJCQljYW4uVXBkYXRlKGV2ZW50LCBjbWRzLnNsaWNlKDAsIDIpLmNvbmNhdChhcmdzKSwgY2J8fGZ1bmN0aW9uKCkgewoJCQkJCWlmIChjYW4uY29yZS5DYWxsRnVuYyhbY2FuLnN1cCwgY2hhdC5PTklNUE9SVCwgaWNlLk1TR19QUk9DRVNTXSwge2NhbjogY2FuLnN1cCwgbXNnOiBtc2d9KSkgeyByZXR1cm4gfQoJCQkJCWlmIChjYW4uY29yZS5DYWxsRnVuYyhbY2FuLCBjaGF0Lk9OSU1QT1JULCBpY2UuTVNHX1BST0NFU1NdLCB7Y2FuOiBjYW4sIG1zZzogbXNnfSkpIHsgcmV0dXJuIH0KCQkJCQlpZiAobXNnLlJlc3VsdCgpLmxlbmd0aCA+IDAgfHwgbXNnLkxlbmd0aCgpID4gMCkgewoJCQkJCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpCgkJCQkJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZykKCQkJCQl9IGVsc2UgewoJCQkJCQljYW4uVXBkYXRlKCkKCQkJCQl9CgkJCQl9LCB0cnVlKQoJCQl9KQoJCX0KCgkJaWYgKGNhbi5iYXNlLmlzVW5kZWZpbmVkKG1zZy5fZGFlbW9uKSkgewoJCQljYW4uYmFzZS5pc1VuZGVmaW5lZChjYW4uX2RhZW1vbikgJiYgY2FuLm9uZGFlbW9uLl9saXN0WzBdICYmIChjYW4uX2RhZW1vbiA9IGNhbi5vbmRhZW1vbi5fbGlzdC5wdXNoKGNhbiktMSkKCQkJaWYgKGNhbi5fZGFlbW9uKSB7IG1zZy5PcHRpb24oaWNlLk1TR19EQUVNT04sIGNhbi5jb3JlLktleXMoY2FuLm9uZGFlbW9uLl9saXN0WzBdLCBjYW4uX2RhZW1vbikpIH0KCQl9CgkJaWYgKG1ldGEgJiYgbWV0YS5pbmRleCAmJiBtZXRhLmluZGV4LmluZGV4T2YoImNhbi4iKSA9PSAwKSB7CgkJCWNhbi5vbmVuZ2luZS5fcGx1Z2luKGV2ZW50LCBjYW4sIG1zZywgY2FuLCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbbWV0YS5pbmRleF0sIGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWlmIChjYW4uYmFzZS5pc0Z1bmMoY2IpKSB7IGNhbi5jb3JlLkNhbGxGdW5jKGNiLCB7Y2FuOiBjYW4sIG1zZzogbXNnfSk7IHJldHVybiB9CgkJCQkhc2lsZW50ICYmIGNhbi5vbmFwcGVuZC5fb3V0cHV0KGNhbiwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSl8fG1ldGEuZGlzcGxheXx8bWV0YS5mZWF0dXJlLmRpc3BsYXkpCgkJCX0pCgkJCXJldHVybgoJCX0KCgkJcmV0dXJuIGNhbi5ydW4oZXZlbnQsIGNtZHMsIGZ1bmN0aW9uKG1zZykgeyB2YXIgc3ViID0gY2FuLmNvcmUuVmFsdWUoY2FuLCAiX291dHB1dHMuLTEiKXx8e307IGNhbi5fbXNnID0gbXNnLCBzdWIuX21zZyA9IG1zZwoJCQlpZiAoY2FuLmJhc2UuaXNGdW5jKGNiKSkgeyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2NhbjogY2FuLCBtc2c6IG1zZ30pOyByZXR1cm4gfQoJCQl2YXIgcHJvY2VzcyA9IG1zZy5fY2FuID09IGNhbiB8fCBtc2cuX2NhbiA9PSBzdWIKCQkJaWYgKHByb2Nlc3MgJiYgY2FuLmNvcmUuQ2FsbEZ1bmMoW3N1YiwgY2hhdC5PTklNUE9SVCwgaWNlLk1TR19QUk9DRVNTXSwge2Nhbjogc3ViLCBtc2c6IG1zZ30pKSB7IHJldHVybiB9CgkJCWlmIChwcm9jZXNzICYmIGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4sIGNoYXQuT05JTVBPUlQsIGljZS5NU0dfUFJPQ0VTU10sIHtjYW46IGNhbiwgbXNnOiBtc2d9KSkgeyByZXR1cm4gfQoJCQkhc2lsZW50ICYmIGNhbi5vbmFwcGVuZC5fb3V0cHV0KGNhbiwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSl8fG1ldGEuZGlzcGxheXx8bWV0YS5mZWF0dXJlLmRpc3BsYXkpCgkJfSkKCX0sCglfb3V0cHV0OiBmdW5jdGlvbihjYW4sIG1zZywgZGlzcGxheSwgb3V0cHV0LCBhY3Rpb24sIGNiKSB7IGRpc3BsYXkgPSBkaXNwbGF5fHxjaGF0LlBMVUdJTl9UQUJMRV9KUywgb3V0cHV0ID0gb3V0cHV0fHxjYW4uX291dHB1dAoJCVZvbGNhbm9zKGRpc3BsYXksIHtfZm9sbG93OiBjYW4uY29yZS5LZXlzKGNhbi5fZm9sbG93LCBkaXNwbGF5KSwgX2Rpc3BsYXk6IGRpc3BsYXksIF90YXJnZXQ6IG91dHB1dCwgX2ZpZWxkczogY2FuLl90YXJnZXQsCgkJCV9vcHRpb246IGNhbi5fb3B0aW9uLCBfYWN0aW9uOiBjYW4uX2FjdGlvbiwgX291dHB1dDogY2FuLl9vdXRwdXQsIF9zdGF0dXM6IGNhbi5fc3RhdHVzLCBfbGVnZW5kOiBjYW4uX2xlZ2VuZCwgX2lucHV0czoge30sCgkJCVVwZGF0ZTogY2FuLlVwZGF0ZSwgT3B0aW9uOiBjYW4uT3B0aW9uLCBBY3Rpb246IGNhbi5BY3Rpb24sIFN0YXR1czogY2FuLlN0YXR1cywKCQl9LCBbZGlzcGxheSwgY2hhdC5QTFVHSU5fVEFCTEVfSlNdLCBmdW5jdGlvbih0YWJsZSkgeyB0YWJsZS5Db25mKGNhbi5Db25mKCkpCgkJCXRhYmxlLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYiwgc2lsZW50KSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQkJCWlmIChtc2cuUnVuQWN0aW9uKGV2ZW50LCB0YWJsZSwgY21kcykpIHsgcmV0dXJuIH0KCQkJCXJldHVybiBjYW4uVXBkYXRlKGV2ZW50LCBjYW4uSW5wdXQoY21kcywgc2lsZW50KSwgY2IsIHNpbGVudCkKCQkJfSwgY2FuLl9vdXRwdXRzICYmIGNhbi5fb3V0cHV0cy5wdXNoKHRhYmxlKSwgdGFibGUuc3VwID0gY2FuLCB0YWJsZS5fbXNnID0gbXNnCgoJCQlpZiAoY2FuLkNvbmYoY3R4LklOREVYKSA9PSAiY2FuLmNvZGUuaW5uZXIucGx1Z2luIiAmJiB0YWJsZS5vbmltcG9ydCAmJiB0YWJsZS5vbmltcG9ydC5saXN0Lmxlbmd0aCA+IDApIHsKCQkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fb3B0aW9uKSwgY2FuLm9uYXBwZW5kLl9vcHRpb24oY2FuLCB7aW5wdXRzOiB0YWJsZS5vbmltcG9ydC5saXN0fSkKCQkJfQoKCQkJdGFibGUuX2FyZ3MgPSBjYW4uYmFzZS5QYXJzZVVSTCh0YWJsZS5fZGlzcGxheSkKCQkJdGFibGUuX3RyYW5zID0gY2FuLmJhc2UuQ29weSh0YWJsZS5fdHJhbnN8fHt9LCBjYW4uY29yZS5WYWx1ZSh0YWJsZSwgIm9uYWN0aW9uLl90cmFucyIpKQoJCQljYW4uY29yZS5DYWxsRnVuYyhbdGFibGUsIGNoYXQuT05JTVBPUlQsICJfaW5pdCJdLCB7Y2FuOiB0YWJsZSwgbXNnOiBtc2csIGxpc3Q6IG1zZy5yZXN1bHR8fG1zZy5hcHBlbmR8fFtdLCBjYjogZnVuY3Rpb24obXNnKSB7CgkJCQlhY3Rpb24gPT09IGZhbHNlIHx8IHRhYmxlLm9uYXBwZW5kLl9hY3Rpb24odGFibGUsIG1zZy5PcHRpb24oaWNlLk1TR19BQ1RJT04pfHxjYW4uQ29uZihpY2UuTVNHX0FDVElPTiksIGFjdGlvbikKCQkJCWFjdGlvbiA9PT0gZmFsc2UgfHwgdGFibGUub25hcHBlbmQuX3N0YXR1cyh0YWJsZSwgbXNnLk9wdGlvbihpY2UuTVNHX1NUQVRVUykpCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQkJfSwgdGFyZ2V0OiBvdXRwdXR8fGNhbi5fb3V0cHV0fSkKCQl9KQoJfSwKCV9zdGF0dXM6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgc3RhdHVzKSB7IHN0YXR1cyA9IHN0YXR1c3x8Y2FuLl9zdGF0dXMsIGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHN0YXR1cykKCQljYW4uY29yZS5MaXN0KGNhbi5iYXNlLk9iaihsaXN0LCBjYW4uY29yZS5WYWx1ZShjYW4sIFtjaGF0Lk9ORVhQT1JULCBtZGIuTElTVF0pKSwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtID0gY2FuLmJhc2UuaXNPYmplY3QoaXRlbSk/IGl0ZW06IHtuYW1lOiBpdGVtfQoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBzdGF0dXMsIFt7dmlldzogY2FuLmJhc2Uuam9pbihbaHRtbC5JVEVNLCBpdGVtLm5hbWVdKSwgdGl0bGU6IGl0ZW0ubmFtZSwgbGlzdDogWwoJCQkJe3RleHQ6IFtpdGVtLm5hbWUsIGh0bWwuTEFCRUxdfSwge3RleHQ6IFsiOiAiLCBodG1sLkxBQkVMXX0sIHt0ZXh0OiBbKGl0ZW0udmFsdWV8fCIiKSsiIiwgaHRtbC5TUEFOLCBpdGVtLm5hbWVdfSwKCQkJXSwgfV0pCgkJfSkKCX0sCgoJdGFiczogZnVuY3Rpb24oY2FuLCBsaXN0LCBjYiwgY2JzLCBhY3Rpb24sIGVhY2gpIHsgYWN0aW9uID0gYWN0aW9ufHxjYW4uX2FjdGlvbgoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCBhY3Rpb24sIGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24obWV0YSkgewoJCQlyZXR1cm4ge3RleHQ6IFttZXRhLm5hbWUsIGh0bWwuRElWLCBodG1sLlRBQlNdLCB0aXRsZTogbWV0YS50ZXh0LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGFjdGlvbiwgImRpdi50YWJzIiwgZXZlbnQudGFyZ2V0KQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgbWV0YSkKCQkJfSwgX2luaXQ6IGZ1bmN0aW9uKGl0ZW0pIHsgY29uc3QgT1ZFUiA9ICJvdmVyIgoJCQkJZnVuY3Rpb24gY2xvc2UoaXRlbSkgeyB2YXIgbmV4dCA9IGl0ZW0ubmV4dFNpYmxpbmd8fGl0ZW0ucHJldmlvdXNTaWJsaW5nCgkJCQkJaXRlbS5fY2xvc2UoaXRlbSkgfHwgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaXRlbSksIG5leHQgJiYgbmV4dC5jbGljaygpCgkJCQl9CgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBpdGVtLCB7ZHJhZ2dhYmxlOiB0cnVlLCBfY2xvc2U6IGNicywKCQkJCQlvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCWNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIGtpdC5EaWN0KAoJCQkJCQkJImNsb3NlIHRhYiIsIGZ1bmN0aW9uKGV2ZW50KSB7IGNsb3NlKGl0ZW0pIH0sCgkJCQkJCQkiY2xvc2Ugb3RoZXIiLCBmdW5jdGlvbihldmVudCkgewoJCQkJCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGFjdGlvbiwgaHRtbC5ESVZfVEFCUywgZnVuY3Rpb24oX2l0ZW0pIHsgX2l0ZW0gPT0gaXRlbSB8fCBjbG9zZShfaXRlbSkgfSkKCQkJCQkJCX0sCgkJCQkJCQkiY2xvc2UgYWxsIiwgZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgYWN0aW9uLCBodG1sLkRJVl9UQUJTLCBjbG9zZSkgfQoJCQkJCQkpLCBbImNsb3NlIHRhYiIsICJjbG9zZSBvdGhlciIsICJjbG9zZSBhbGwiXSkKCQkJCQl9LAoJCQkJCW9uZHJhZ3N0YXJ0OiBmdW5jdGlvbihldmVudCkgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OyB0YXJnZXQuY2xpY2soKQoJCQkJCQlhY3Rpb24uX2Ryb3AgPSBmdW5jdGlvbihldmVudCwgYmVmb3JlKSB7IGFjdGlvbi5pbnNlcnRCZWZvcmUodGFyZ2V0LCBiZWZvcmUpIH0KCQkJCQl9LAoJCQkJCW9uZHJhZ292ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7IGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGFjdGlvbi5fZHJvcChldmVudCwgZXZlbnQudGFyZ2V0KSB9LAoJCQkJCW9uZHJvcDogZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKSwgYWN0aW9uLl9kcm9wKGV2ZW50LCBldmVudC50YXJnZXQpIH0sCgkJCQl9KSwgY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBpdGVtLmNsaWNrKCkgfSkKCQkJCWNhbi5iYXNlLmlzRnVuYyhlYWNoKSAmJiBlYWNoKGl0ZW0pCgkJCX19CgkJfSkpLmZpcnN0Cgl9LAoJbGlzdDogZnVuY3Rpb24oY2FuLCByb290LCBjYiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl9vdXRwdXQKCQljYW4uY29yZS5MaXN0KHJvb3QubGlzdCwgZnVuY3Rpb24oaXRlbSkgewoJCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIGl0ZW0ubWV0YS5uYW1lXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGl0ZW0pIHx8IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCB1aS5saXN0KQoJCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5ESVZfSVRFTSwgZXZlbnQudGFyZ2V0KQoJCQl9fSwge3ZpZXc6IGh0bWwuTElTVH1dKTsgY2FuLm9uYXBwZW5kLmxpc3QoY2FuLCBpdGVtLCBjYiwgdWkubGlzdCkKCQl9KQoJfSwKCWl0ZW06IGZ1bmN0aW9uKGNhbiwgdHlwZSwgaXRlbSwgY2IsIGNicywgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl9vdXRwdXQKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW3R5cGUsIGh0bWwuRElWLCBpdGVtLm5pY2t8fGl0ZW0ubmFtZV0sCgkJCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCB1aS5maXJzdCkKCQkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCB0YXJnZXQsIGNhbi5jb3JlLktleXMoaHRtbC5ESVYsIHR5cGUpLCB1aS5maXJzdCkKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgeyBjYnMoZXZlbnQsIHVpLmZpcnN0KSB9LAoJCX1dKTsgcmV0dXJuIHVpLmZpcnN0Cgl9LAoJdHJlZTogZnVuY3Rpb24oY2FuLCBsaXN0LCBmaWVsZCwgc3BsaXQsIGNiLCB0YXJnZXQsIG5vZGUpIHsKCQlub2RlID0gbm9kZXx8eyIiOiB0YXJnZXR9OyBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbVtmaWVsZF0gJiYgY2FuLmNvcmUuTGlzdChpdGVtW2ZpZWxkXS5zcGxpdChzcGxpdCksIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpIHsgaWYgKCF2YWx1ZSkgeyByZXR1cm4gfQoJCQkJdmFyIGxhc3QgPSBhcnJheS5zbGljZSgwLCBpbmRleCkuam9pbihzcGxpdCksIG5hbWUgPSBhcnJheS5zbGljZSgwLCBpbmRleCsxKS5qb2luKHNwbGl0KQoJCQkJaWYgKG5vZGVbbmFtZV0pIHsgcmV0dXJuIH0KCQkJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIG5vZGVbbGFzdF0sIFt7dmlldzogIml0ZW0iLCBsaXN0OiBbe3ZpZXc6IFsic3dpdGNoIiwgImRpdiIsIChpbmRleD09YXJyYXkubGVuZ3RoLTE/IiI6IiYjODk2MzsiKV19LCB7dmlldzogWyJuYW1lIiwgaHRtbC5ESVYsIHZhbHVlKyhpbmRleD09YXJyYXkubGVuZ3RoLTE/IiI6IiIpXX1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWluZGV4IDwgYXJyYXkubGVuZ3RoIC0gMT8gY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIG5vZGVbbmFtZV0sIGZ1bmN0aW9uKCkgewoJCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdWlbInN3aXRjaCJdLCAib3BlbiIpCgkJCQkJfSwgZnVuY3Rpb24oKSB7CgkJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCB1aVsic3dpdGNoIl0sICJvcGVuIikKCQkJCQl9KTogY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbSkKCQkJCQlpZiAobm9kZVtuYW1lXS5jaGlsZEVsZW1lbnRDb3VudCA9PSAyKSB7IG5vZGVbbmFtZV0uZmlyc3RDaGlsZC5jbGljaygpIH0KCQkJCX19LCB7dmlldzogaHRtbC5MSVNULCBzdHlsZToge2Rpc3BsYXk6IGh0bWwuTk9ORX0sIF9pbml0OiBmdW5jdGlvbihsaXN0KSB7IGl0ZW0uZXhwYW5kICYmIGNhbi5wYWdlLnN0eWxlKGNhbiwgbGlzdCwgaHRtbC5ESVNQTEFZLCBodG1sLkJMT0NLKSB9fV0pCgkJCQlub2RlW25hbWVdID0gdWkubGlzdAoJCQl9KQoJCX0pOyByZXR1cm4gbm9kZQoJfSwKCWZpZWxkOiBmdW5jdGlvbihjYW4sIHR5cGUsIGl0ZW0sIHRhcmdldCkgeyB0eXBlID0gdHlwZXx8aHRtbC5QTFVHSU4sIGl0ZW0gPSBpdGVtfHx7fQoJCXZhciBuYW1lID0gKGl0ZW0ubmlja3x8aXRlbS5uYW1lfHwiIikuc3BsaXQoaWNlLlNQKVswXQoJCXZhciB0aXRsZSA9ICFpdGVtLmhlbHAgfHwgY2FuLnVzZXIubGFuZ3VhZ2UoY2FuKSA9PSAiZW4iPyBuYW1lOiBuYW1lKyIoIitpdGVtLmhlbHAuc3BsaXQoaWNlLlNQKVswXSsiKSIKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgW3t2aWV3OiBbY2FuLmJhc2Uuam9pbihbdHlwZXx8IiIsIGl0ZW0ubmFtZXx8IiIsIGl0ZW0ucG9zfHwiIl0pLCBodG1sLkZJRUxEU0VUXSwgbGlzdDogWwoJCQluYW1lICYmIHt0ZXh0OiBbdGl0bGUsIGh0bWwuTEVHRU5EXX0sIHt2aWV3OiBbaHRtbC5PUFRJT04sIGh0bWwuRk9STV19LCB7dmlldzogW2h0bWwuQUNUSU9OXX0sIHt2aWV3OiBbaHRtbC5PVVRQVVRdfSwge3ZpZXc6IFtodG1sLlNUQVRVU119LAoJCV19XSkKCX0sCglpbnB1dDogZnVuY3Rpb24oY2FuLCBpdGVtLCB2YWx1ZSwgdGFyZ2V0LCBzdHlsZSkgewoJCXN3aXRjaCAoaXRlbS50eXBlKSB7CgkJCWNhc2UgIiI6IHJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFtpdGVtXSkKCQkJY2FzZSBodG1sLlNQQUNFOiByZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IGNhbi5iYXNlLmpvaW4oW2h0bWwuSVRFTSwgaHRtbC5TUEFDRV0pfV0pCgkJfQoKCQl2YXIgaW5wdXQgPSBjYW4ucGFnZS5pbnB1dChjYW4sIGl0ZW0sIHZhbHVlKQoJCXZhciBiciA9IGlucHV0LnR5cGUgPT0gaHRtbC5URVhUQVJFQT8gW3t0eXBlOiBodG1sLkJSLCBzdHlsZToge2NsZWFyOiBodG1sLkJPVEh9fV06IFtdCgkJdmFyIHRpdGxlID0gY2FuLkNvbmYoW2N0eC5GRUFUVVJFLCBjaGF0LlRJVExFLCBpdGVtLm5hbWVdLmpvaW4oaWNlLlBUKSl8fCIiOyB0aXRsZSAmJiAoaW5wdXQudGl0bGUgPSB0aXRsZSkKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCAoW3t2aWV3OiBzdHlsZXx8Y2FuLmJhc2Uuam9pbihbaHRtbC5JVEVNLCBpdGVtLnR5cGVdKSwgb25rZXlkb3duOiBmdW5jdGlvbihldmVudCkgewoJCQlpdGVtLnR5cGUgPT0gaHRtbC5URVhUQVJFQSAmJiBldmVudC5rZXkgPT0gbGFuZy5UQUIgICYmIGNhbi5vbmtleW1hcC5pbnNlcnRUZXh0KGV2ZW50LnRhcmdldCwgIlx0IikKCQkJaXRlbS50eXBlID09IGh0bWwuVEVYVCAmJiBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbiksIGNhbi5vbm1vdGlvbi5zZWxlY3RGaWVsZChldmVudCwgY2FuKQoJCX0sIGxpc3Q6IFtpbnB1dF19XSkuY29uY2F0KGJyKSlbaXRlbS5uYW1lXQoJfSwKCXRhYmxlOiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCwgc29ydCkgeyBpZiAobXNnLkxlbmd0aCgpID09IDApIHsgcmV0dXJuIH0KCQl2YXIgdGFibGUgPSBjYW4ucGFnZS5BcHBlbmRUYWJsZShjYW4sIG1zZywgdGFyZ2V0fHxjYW4uX291dHB1dCwgbXNnLmFwcGVuZCwgY2J8fGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkgewoJCQlpZiAobXNnLmFwcGVuZC5sZW5ndGggPT0gMiAmJiBtc2cuYXBwZW5kWzBdID09IG1kYi5LRVkgJiYgbXNnLmFwcGVuZFsxXSA9PSBtZGIuVkFMVUUpIHsKCQkJCWlmIChrZXkgPT0gbWRiLlZBTFVFKSB7IGtleSA9IGxpbmUua2V5IH0KCQkJCWxpbmUgPSB7fSwgY2FuLmNvcmUuTGlzdChhcnJheSwgZnVuY3Rpb24oaXRlbSkgeyBsaW5lW2l0ZW0ua2V5XSA9IGl0ZW0udmFsdWUgfSkKCQkJfQoKCQkJaWYgKGtleSA9PSAiZXh0cmEuY21kIikgewoJCQkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHtjdHg6IGxpbmVbImV4dHJhLmN0eCJdLCBjbWQ6IGxpbmVbImV4dHJhLmNtZCJdLCBhcmc6IGxpbmVbImV4dHJhLmFyZyJdfSwgZnVuY3Rpb24oc3ViKSB7CgkJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGxpbmUsIGNhbi5PcHRpb24oKSkKCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIGNhbi5jb3JlLktleXMobGluZVsiZXh0cmEuY3R4Il0sIGxpbmVbImV4dHJhLmNtZCJdKV0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJCQl9CgkJCQl9LCB0YXJnZXR8fGNhbi5fb3V0cHV0KQoJCQl9CgoJCQlmdW5jdGlvbiBydW4oY21kcykgeyB2YXIgbXNnID0gY2FuLnN1cC5yZXF1ZXN0KGV2ZW50LCBsaW5lLCBjYW4uT3B0aW9uKCkpCgkJCQlyZXR1cm4gY2FuLnJ1bihldmVudCwgY21kcywgZnVuY3Rpb24obXNnKSB7CgkJCQkJaWYgKGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4uc3VwLCBjaGF0Lk9OSU1QT1JULCBpY2UuTVNHX1BST0NFU1NdLCB7Y2FuOiBjYW4uc3VwLCBtc2c6IG1zZ30pKSB7IHJldHVybiB9CgkJCQkJaWYgKG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKSAhPSAiIikgewoJCQkJCQljYW4ub25hcHBlbmQuX291dHB1dChjYW4uc3VwLCBtc2csIG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKSkKCQkJCQl9IGVsc2UgaWYgKG1zZy5SZXN1bHQoKS5sZW5ndGggPiAwIHx8IG1zZy5MZW5ndGgoKSA+IDApIHsKCQkJCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCQkJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLlVwZGF0ZSgpCgkJCQkJfQoJCQkJfSwgdHJ1ZSkKCQkJfQoKCQkJcmV0dXJuIHt0ZXh0OiBbdmFsdWUsIGh0bWwuVERdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJCQlpZiAodGFyZ2V0LnRhZ05hbWUgPT0gIklOUFVUIiAmJiB0YXJnZXQudHlwZSA9PSBodG1sLkJVVFRPTikgeyByZXR1cm4gcnVuKFtjdHguQUNUSU9OLCB0YXJnZXQubmFtZV0pIH0KCQkJCWlmIChrZXkgPT0gbWRiLkhBU0ggJiYgY2FuLnVzZXIubW9kLmlzRGl2KSB7IHJldHVybiBjYW4udXNlci5qdW1wcygiL2NoYXQvZGl2LyIrdmFsdWUpIH0KCQkJCWNhbi5zdXAub25hY3Rpb24uY2hhbmdlKGV2ZW50LCBjYW4uc3VwLCBrZXksIGV2ZW50LnRhcmdldC5pbm5lclRleHQpCgoJCQl9LCBvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBpZiAoW21kYi5LRVldLmluZGV4T2Yoa2V5KSA+IC0xKSB7IHJldHVybiB9CgkJCQl2YXIgaXRlbSA9IGNhbi5jb3JlLkxpc3QoY2FuLkNvbmYoImZlYXR1cmUuaW5zZXJ0IiksIGZ1bmN0aW9uKGl0ZW0pIHsgaWYgKGl0ZW0ubmFtZSA9PSBrZXkpIHsgcmV0dXJuIGl0ZW0gfSB9KVswXXx8e25hbWU6IGtleSwgdmFsdWU6IHZhbHVlfQoJCQkJaXRlbS5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgY2FuLnJ1bihjYW4ucmVxdWVzdChldmVudCwgbGluZSkuX2V2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkgfQoJCQkJY2FuLm9ubW90aW9uLm1vZGlmeXMoY2FuLCBldmVudC50YXJnZXQsIGZ1bmN0aW9uKGV2ZW50LCB2YWx1ZSwgb2xkKSB7IHJ1bihbY3R4LkFDVElPTiwgbWRiLk1PRElGWSwga2V5LCB2YWx1ZV0pIH0sIGl0ZW0pCgkJCX19CgkJfSk7IHRhYmxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIHRhYmxlLCB7Y2xhc3NOYW1lOiBjaGF0LkNPTlRFTlR9KQoJCWlmIChtc2cuYXBwZW5kICYmIG1zZy5hcHBlbmRbbXNnLmFwcGVuZC5sZW5ndGgtMV0gPT0gImFjdGlvbiIpIHsgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhYmxlLCAiYWN0aW9uIikgfQoJCWNhbi5fdGFibGUgPSB0YWJsZSwgY2FuLnN1cCAmJiAoY2FuLnN1cC5fdGFibGUgPSB0YWJsZSkKCQlyZXR1cm4gc29ydCAmJiBjYW4ucGFnZS5SYW5nZVRhYmxlKGNhbiwgdGFibGUsIHNvcnQpLCB0YWJsZQoJfSwKCWJvYXJkOiBmdW5jdGlvbihjYW4sIHRleHQsIHRhcmdldCkgeyB0ZXh0ICYmIHRleHQuUmVzdWx0ICYmICh0ZXh0ID0gdGV4dC5SZXN1bHQoKSk7IGlmICghdGV4dCkgeyByZXR1cm4gfQoJCXZhciBjb2RlID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgW3t0ZXh0OiBbY2FuLnBhZ2UuQ29sb3IodGV4dCksIGh0bWwuRElWLCBodG1sLkNPREVdfV0pLmNvZGUKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjb2RlLCBodG1sLklOUFVUX0JVVFRPTiwgZnVuY3Rpb24odGFyZ2V0KSB7CgkJCXRhcmdldC5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsgdmFyIG1zZyA9IGNhbi5zdXAucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCQkJcmV0dXJuIGNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCB0YXJnZXQubmFtZV0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ucnVuKCkgfSwgdHJ1ZSkKCQkJfQoJCX0pCgkJcmV0dXJuIChjb2RlLnNjcm9sbEJ5ICYmIGNvZGUuc2Nyb2xsQnkoMCwgMTAwMDApKSwgY29kZQoJfSwKCXBhcnNlOiBmdW5jdGlvbihjYW4sIGxpc3QsIHRhcmdldCwga2V5cywgZGF0YSwgdHlwZSkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi5fb3V0cHV0LCBkYXRhID0gZGF0YXx8e30KCQlpZiAoIWxpc3QpIHsgcmV0dXJuIH0gZWxzZSBpZiAoY2FuLmJhc2UuaXNBcnJheShsaXN0KSkgewoJCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihtZXRhLCBpbmRleCkgewoJCQkJcmV0dXJuIGNhbi5vbmFwcGVuZC5wYXJzZShjYW4sIG1ldGEsIHRhcmdldCwga2V5cywgZGF0YSwgdHlwZSkKCQkJfSkKCgkJfSBlbHNlIGlmIChjYW4uYmFzZS5pc1N0cmluZyhsaXN0KSkgewoJCQl2YXIgbHMgPSBjYW4uY29yZS5TcGxpdChsaXN0LCAiIiwgIjo9QCIpOyBpZiAobHMubGVuZ3RoID09IDEpIHsKCQkJCXZhciBtZXRhID0gdHlwZT8ge3R5cGU6IHR5cGUsIG5hbWU6IGxzWzBdfToge3R5cGU6IGxzWzBdfQoJCQl9IGVsc2UgewoJCQkJdmFyIG1ldGEgPSB7bmFtZTogbHNbMF19OyBmb3IgKHZhciBpID0gMTsgaSA8IGxzLmxlbmd0aDsgaSArPSAyKSB7IHN3aXRjaCAobHNbaV0pIHsKCQkJCQljYXNlICI6IjogbWV0YS50eXBlID0gbHNbaSsxXTsgYnJlYWsKCQkJCQljYXNlICI9IjogbWV0YS52YWx1ZSA9IGxzW2krMV07IGJyZWFrCgkJCQkJY2FzZSAiQCI6IG1ldGEuYWN0aW9uID0gbHNbaSsxXTsgYnJlYWsKCQkJCX0gfQoJCQl9CgoJCX0gZWxzZSBpZiAoY2FuLmJhc2UuaXNPYmplY3QobGlzdCkpIHsgdmFyIG1ldGEgPSBsaXN0IH0KCgkJa2V5cyA9IGNhbi5jb3JlLktleXMoa2V5cywgbWV0YS5uYW1lfHxtZXRhLnR5cGUpIAoJCXZhciBpdGVtID0ge3ZpZXc6IG1ldGEudHlwZX0sIGluaXQsIHN1YnR5cGU7IHN3aXRjaCAobWV0YS50eXBlKSB7CgkJCWNhc2UgaHRtbC5IRUFEOiBzdWJ0eXBlID0gIm1lbnUiLCBkYXRhID0ge30KCQkJCWluaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsgZGF0YS5oZWFkID0gdGFyZ2V0CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgaHRtbC5MQVlPVVQpCgkJCQl9CgkJCQlicmVhawoJCQljYXNlIGh0bWwuTEVGVDogc3VidHlwZSA9ICJpdGVtIgoJCQkJaW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgewoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YXJnZXQsIGh0bWwuTEFZT1VUKQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgdmFyIGhlaWdodCA9IHRhcmdldC5wYXJlbnROb2RlLm9mZnNldEhlaWdodAoJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQucGFyZW50Tm9kZSwgY2FuLnBhZ2UuS2V5cyhodG1sLkRJVl9MQVlPVVRfSEVBRCwgaHRtbC5ESVZfTEFZT1VUX0ZPT1QpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCQloZWlnaHQgLT0gaXRlbS5vZmZzZXRIZWlnaHQKCQkJCQkJfSksIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkhFSUdIVCwgaGVpZ2h0KQoJCQkJCX0pCgkJCQl9CgkJCQlicmVhawoJCQljYXNlIGh0bWwuTUFJTjoKCQkJCWluaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsgZGF0YS5tYWluID0gdGFyZ2V0CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgaHRtbC5MQVlPVVQpCgkJCQkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyB2YXIgaGVpZ2h0ID0gdGFyZ2V0LnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0CgkJCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldC5wYXJlbnROb2RlLCBjYW4ucGFnZS5LZXlzKGh0bWwuRElWX0xBWU9VVF9IRUFELCBodG1sLkRJVl9MQVlPVVRfRk9PVCksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQkJCWhlaWdodCAtPSBpdGVtLm9mZnNldEhlaWdodAoJCQkJCQl9KSwgY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuSEVJR0hULCBoZWlnaHQpCgkJCQkJfSkKCgkJCQkJY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsKCQkJCQkJdmFyIHdpZHRoID0gdGFyZ2V0LnBhcmVudE5vZGUub2Zmc2V0V2lkdGgKCQkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LnBhcmVudE5vZGUsIGh0bWwuRElWX0xBWU9VVF9MRUZULCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCQl3aWR0aCAtPSBpdGVtLm9mZnNldFdpZHRoKzEKCQkJCQkJfSksIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLldJRFRILCB3aWR0aCkKCQkJCQl9KQoKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5GT09UOgoJCQkJaW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgeyBkYXRhLmZvb3QgPSB0YXJnZXQKCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdGFyZ2V0LCBodG1sLkxBWU9VVCkKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5UQUJTOgoJCQkJaXRlbS5saXN0ID0gW3t2aWV3OiAibmFtZSJ9LCB7dmlldzogaHRtbC5QQUdFfV0sIGl0ZW0uX2luaXQgPSBmdW5jdGlvbihfdGFyZ2V0LCB1aSkgewoJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLnBhZ2UsIFt7dmlldzogaHRtbC5JTlBVVCwgbGlzdDogW3t0eXBlOiBodG1sLklOUFVULCBvbmtleXVwOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBfdGFyZ2V0LCBbaHRtbC5ESVZfUEFHRSwgaHRtbC5ESVZfSVRFTV0sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5zZXQoY2FuLCBpdGVtLCBodG1sLkhJREUsIGl0ZW0uaW5uZXJUZXh0LmluZGV4T2YoZXZlbnQudGFyZ2V0LnZhbHVlKSA9PSAtMSkKCQkJCQkJfSkKCQkJCQl9fV19XSkKCQkJCQljYW4uY29yZS5MaXN0KG1ldGEubGlzdCwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdWkubmFtZSwgW3t2aWV3OiBbaHRtbC5JVEVNLCBodG1sLkRJViwgaXRlbS5uYW1lfHxpdGVtXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBfdGFyZ2V0LCBbW2h0bWwuRElWX1BBR0UsIGh0bWwuRElWX0xJU1RdXSwgaW5kZXgpCgkJCQkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgdWkubmFtZSwgaHRtbC5ESVZfSVRFTSwgaW5kZXgpCgkJCQkJCQl1aS5wYWdlLnNjcm9sbFRvKDAsIDApCgkJCQkJCX19XSkKCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdWkucGFnZSwgW3t2aWV3OiBbaHRtbC5JVEVNLCBodG1sLkRJViwgaXRlbS5uYW1lXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5uZWcoY2FuLCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcsIGh0bWwuU0VMRUNUKQoJCQkJCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIHVpLm5hbWUsIGh0bWwuRElWX0lURU0sIGluZGV4KQoJCQkJCQl9fSwge3ZpZXc6IFtodG1sLkxJU1RdLCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCQkJCQljYW4ub25hcHBlbmQucGFyc2UoY2FuLCBpdGVtLmxpc3QsIHRhcmdldCwgY2FuLmNvcmUuS2V5cyhrZXlzLCBpdGVtLm5hbWUpLCBkYXRhLCBodG1sLklURU0pCgkJCQkJCX19XSkKCQkJCQl9KQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7IHZhciBoZWlnaHQgPSB0YXJnZXQub2Zmc2V0SGVpZ2h0CgkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdWkucGFnZSwgaHRtbC5IRUlHSFQsIGhlaWdodC0xMC0obWV0YS5zdHlsZT8gMDogdWkubmFtZS5vZmZzZXRIZWlnaHQpKQoJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIF90YXJnZXQsIGh0bWwuSEVJR0hULCBoZWlnaHQtMTApCgkJCQkJfSksIGNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLm5hbWUsIGh0bWwuRElWX0lURU0pWzBdLmNsaWNrKCkKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgInVzZXJuYW1lIjoKCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgWwoJCQkJCWNhbi5iYXNlLkNvcHkoe3ZpZXc6IFsidXNlcm5hbWUiLCAiZGl2Il0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl9LCBsaXN0OiBbe3ZpZXc6IFsic29tZSIsIGh0bWwuRElWLCBjYW4udXNlci5pbmZvLnVzZXJuaWNrXX0sIHtpbWc6IGNhbi51c2VyLmluZm8uYXZhdGFyfV19KV0pCgkJCQlyZXR1cm4KCQl9CgoJCWl0ZW0uX2luaXQgPSBpdGVtLl9pbml0fHxmdW5jdGlvbih0YXJnZXQpIHsKCQkJbWV0YS5saXN0ICYmIGNhbi5vbmFwcGVuZC5wYXJzZShjYW4sIG1ldGEubGlzdCwgdGFyZ2V0LCBrZXlzLCBkYXRhLCB0eXBlfHxzdWJ0eXBlKQoJCQljYW4uYmFzZS5pc0Z1bmMoaW5pdCkgJiYgaW5pdCh0YXJnZXQpLCBjYW4uYmFzZS5pc0Z1bmMobWV0YS5pbml0KSAmJiBtZXRhLmluaXQodGFyZ2V0KQoJCX0KCQlpZiAoY2FuLmJhc2UuaXNTdHJpbmcobWV0YS5zdHlsZSkpIHsgaXRlbS5jbGFzc05hbWUgPSBtZXRhLnN0eWxlIH0KCQlpZiAoY2FuLmJhc2UuaXNPYmplY3QobWV0YS5zdHlsZSkpIHsgaXRlbS5zdHlsZSA9IG1ldGEuc3R5bGUgfQoKCQlpZiAoKG1ldGEudHlwZXx8dHlwZSkgPT0gaHRtbC5NRU5VKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW2Nhbi5iYXNlLkNvcHkoe3ZpZXc6IFtodG1sLk1FTlUsIGh0bWwuRElWLCBtZXRhLm5hbWV8fG1ldGFdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJaWYgKG1ldGEubGlzdCAmJiBtZXRhLmxpc3QubGVuZ3RoID4gMCkgeyByZXR1cm4gfQoJCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIG1ldGEubmFtZSkgfHwgY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGh0bWwuTUVOVSwgY2FuLnJlcXVlc3QoZXZlbnQsIHtpdGVtOiBtZXRhLm5hbWV9KSkKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJbWV0YS5saXN0ICYmIG1ldGEubGlzdC5sZW5ndGggPiAwICYmIGNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIHt9LCBtZXRhLmxpc3QsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGl0ZW0pIHx8IGNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBtZXRhLm5hbWUsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7aXRlbTogaXRlbX0pKQoJCQkJfSkKCQkJfX0pXSkuZmlyc3QKCQkJcmV0dXJuCgkJfQoJCWlmICgodHlwZXx8c3VidHlwZSkgPT0gaHRtbC5JVEVNKSB7IGl0ZW0udmlldyA9IGl0ZW0udmlld3x8aHRtbC5MSVNUCgkJCWlmIChtZXRhLmFjdGlvbiA9PSAiYXV0byIpIHsKCQkJCW1ldGEuaW5pdCA9IG1ldGEuaW5pdHx8ZnVuY3Rpb24oaXRlbSkgeyBjYW4uY29yZS5UaW1lcigxMDAsIGZ1bmN0aW9uKCkgeyBpdGVtLmNsaWNrKCkgfSkgfQoJCQl9CgkJCWlmIChkZWNvZGVVUklDb21wb25lbnQobG9jYXRpb24uaGFzaCkgPT0gIiMiK2Nhbi5jb3JlLktleXMoa2V5cywgaXRlbS5uYW1lKSkgewoJCQkJbWV0YS5pbml0ID0gbWV0YS5pbml0fHxmdW5jdGlvbihpdGVtKSB7IGNhbi5jb3JlLlRpbWVyKDMwMCwgZnVuY3Rpb24oKSB7IGl0ZW0uY2xpY2soKSB9KSB9CgkJCX0gCgoJCQl2YXIgX2l0ZW0gPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFtjYW4uYmFzZS5Db3B5KHt2aWV3OiBbaHRtbC5JVEVNLCBodG1sLkRJViwgbWV0YS5uYW1lfHxtZXRhXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWxvY2F0aW9uLmhhc2ggPSBjYW4uY29yZS5LZXlzKGtleXMsIGl0ZW0ubmFtZSkKCgkJCQlpZiAobWV0YS5hY3Rpb24gPT0gIm9wZW4iKSB7CgkJCQkJaWYgKGNhbi5taXNjLlNlYXJjaChjYW4sICJwb2QiKSkgewoJCQkJCQljYW4udXNlci5vcGVuKCIvY2hhdC9wb2QvIitjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikrIi9jbWQvIittZXRhLmluZGV4KQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNhbi51c2VyLm9wZW4oIi9jaGF0L2NtZC8iK21ldGEuaW5kZXgpCgkJCQkJfQoJCQkJCXJldHVybgoJCQkJfQoJCQkJaWYgKG1ldGEuYWN0aW9uID09ICJwdXNoIikgewoJCQkJCWlmIChjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikpIHsKCQkJCQkJY2FuLnVzZXIuanVtcHMoIi9jaGF0L3BvZC8iK2Nhbi5taXNjLlNlYXJjaChjYW4sICJwb2QiKSsiL2NtZC8iK21ldGEuaW5kZXgpCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLnVzZXIuanVtcHMoIi9jaGF0L2NtZC8iK21ldGEuaW5kZXgpCgkJCQkJfQoJCQkJCXJldHVybgoJCQkJfQoJCQkJc3dpdGNoIChtZXRhLnR5cGUpIHsKCQkJCQljYXNlIGh0bWwuUExVR0lOOgoJCQkJCQlpZiAoY2FuLm9ubW90aW9uLmNhY2hlKGNhbiwgZnVuY3Rpb24oKSB7IHJldHVybiBrZXlzIH0sIGRhdGEubWFpbikpIHsgYnJlYWsgfQoJCQkJCQlpZiAoY2FuLmJhc2UuRXh0KG1ldGEuaW5kZXgpID09IG5mcy5aTUwgfHwgY2FuLmJhc2UuRXh0KG1ldGEuaW5kZXgpID09IG5mcy5JTUwpIHsKCQkJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGRhdGEubWFpbiwgW3t0eXBlOiBodG1sLklGUkFNRSwgc3JjOiAiL2NoYXQvY21kLyIrbWV0YS5pbmRleCwKCQkJCQkJCQloZWlnaHQ6IGRhdGEubWFpbi5vZmZzZXRIZWlnaHQsIHdpZHRoOiBkYXRhLm1haW4ub2Zmc2V0V2lkdGgsCgkJCQkJCQl9XSkKCQkJCQkJCWJyZWFrCgkJCQkJCX0KCgkJCQkJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCB7aW5kZXg6IG1ldGEuaW5kZXgsIGFyZ3M6IGNhbi5iYXNlLk9iaihtZXRhLmFyZ3MpfSwgZnVuY3Rpb24oc3ViKSB7CgkJCQkJCQlzdWIuQ29uZkhlaWdodChkYXRhLm1haW4ub2Zmc2V0SGVpZ2h0LTE2MCkKCQkJCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgewoJCQkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKGRhdGEubWFpbi5vZmZzZXRXaWR0aC00MCkpCgkJCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIHN1Yi5faW5kZXh8fG1ldGEuaW5kZXhdLCBjbWRzKSwgZnVuY3Rpb24obXNnKSB7CgkJCQkJCQkJCWNiKG1zZyksIGNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsKCQkJCQkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl90YWJsZSwgaHRtbC5NQVhfSEVJR0hULCBkYXRhLm1haW4ub2Zmc2V0SGVpZ2h0LTE1MCkKCQkJCQkJCQkJfSkKCQkJCQkJCQl9LCB0cnVlKQoJCQkJCQkJfQoJCQkJCQl9LCBkYXRhLm1haW4pCgkJCQkJZGVmYXVsdDoKCQkJCQkJbWV0YS5saXN0ICYmIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcpCgkJCQl9CgkJCX19KV0pLmZpcnN0OyBjYW4uY29yZS5JdGVtQ0IobWV0YSwgZnVuY3Rpb24oa2V5LCBjYikgeyBfaXRlbVtrZXldID0gY2FuLmJhc2UuaXNGdW5jKGNiKT8gY2I6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2IsIGNhbi5yZXF1ZXN0KGV2ZW50KSkKCQkJfSB9KQoJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IG1ldGEuaW5pdCAmJiBtZXRhLmluaXQoX2l0ZW0pIH0pCgkJCWlmICghbWV0YS5saXN0KSB7IHJldHVybiB9CgkJfQoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFtpdGVtXSkuZmlyc3QKCX0sCglfcGFyc2U6IGZ1bmN0aW9uKGNhbiwgdGV4dCkgeyB2YXIgc3RhY2sgPSBbe19kZWVwOiAtMSwgbGlzdDogW119XQoJCWNhbi5jb3JlLkxpc3QoY2FuLmNvcmUuU3BsaXQodGV4dCwgaWNlLk5MLCBpY2UuTkwsIGljZS5OTCksIGZ1bmN0aW9uKGxpbmUpIHsgaWYgKGxpbmUgPT0gIiIpIHsgcmV0dXJuIH0KCQkJdmFyIGRlZXAgPSAwOyBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmUubGVuZ3RoOyBpKyspIHsgaWYgKGxpbmVbaV0gPT0gaWNlLlNQKSB7IGRlZXArKyB9IGVsc2UgaWYgKGxpbmVbaV0gPT0gaWNlLlRCKSB7IGRlZXAgKz0gNCB9IGVsc2UgeyBicmVhayB9IH0KCQkJZm9yICh2YXIgaSA9IHN0YWNrLmxlbmd0aC0xOyBpID4gMDsgaS0tKSB7IGlmIChkZWVwIDw9IHN0YWNrW2ldLl9kZWVwKSB7IHN0YWNrLnBvcCgpIH0gfQoKCQkJdmFyIGl0ZW0gPSB7X2RlZXA6IGRlZXAsIGxpc3Q6IFtdfTsgdmFyIGxpc3QgPSBzdGFja1tzdGFjay5sZW5ndGgtMV07IGxpc3QubGlzdC5wdXNoKGl0ZW0pOyBpZiAoZGVlcCA+IGxpc3QuX2RlZXApIHsgc3RhY2sucHVzaChpdGVtKSB9CgkJCXZhciBscyA9IGNhbi5jb3JlLlNwbGl0KGxpbmUpOyBzd2l0Y2ggKGxzWzBdKSB7CgkJCQljYXNlIGh0bWwuSEVBRDoKCQkJCWNhc2UgaHRtbC5MRUZUOgoJCQkJY2FzZSBodG1sLk1BSU46CgkJCQljYXNlIGh0bWwuRk9PVDoKCQkJCWNhc2UgaHRtbC5UQUJTOgoJCQkJY2FzZSAidXNlcm5hbWUiOgoJCQkJY2FzZSBodG1sLk1FTlU6IGl0ZW0udHlwZSA9IGxzWzBdOyBicmVhawoJCQkJZGVmYXVsdDogaXRlbS5uYW1lID0gbHNbMF07IGJyZWFrCgkJCX0KCQkJZm9yICh2YXIgaSA9IDE7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgeyBjYW4uY29yZS5WYWx1ZShpdGVtLCBsc1tpXSwgbHNbaSsxXSkKCQkJCWlmIChsc1tpXSA9PSBjdHguSU5ERVgpIHsgaXRlbS50eXBlID0gaXRlbS50eXBlfHxodG1sLlBMVUdJTiB9CgkJCX0KCQl9KQoJCXJldHVybiB7dHlwZTogImRlbW8iLCBzdHlsZToge2hlaWdodDogY2FuLkNvbmZIZWlnaHQoKXx8d2luZG93LmlubmVySGVpZ2h0fSwgbGlzdDogc3RhY2tbMF0ubGlzdH0KCX0sCgoJX3BsdWdpbjogZnVuY3Rpb24oY2FuLCB2YWx1ZSwgbWV0YSwgY2IsIHRhcmdldCkgewoJCW1ldGEuZmVhdHVyZSA9IGNhbi5iYXNlLmdldFZhbGlkKG1ldGEuZmVhdHVyZSwgY2FuLmJhc2UuT2JqKHZhbHVlLm1ldGEpKXx8e30KCQltZXRhLmlucHV0cyA9IGNhbi5iYXNlLmdldFZhbGlkKG1ldGEuaW5wdXRzLCBjYW4uYmFzZS5PYmoodmFsdWUubGlzdCkpfHxbXQoJCW1ldGEuYXJncyA9IGNhbi5iYXNlLmdldFZhbGlkKGNhbi5iYXNlLk9iaihtZXRhLmFyZ3MpLCBjYW4uYmFzZS5PYmoobWV0YS5hcmcpLCBjYW4uYmFzZS5PYmoodmFsdWUuYXJncyksIGNhbi5iYXNlLk9iaih2YWx1ZS5hcmcpKXx8W10KCQltZXRhLmRpc3BsYXkgPSBtZXRhLmRpc3BsYXl8fHZhbHVlLmRpc3BsYXkKCgkJbWV0YS5oZWlnaHQgPSBtZXRhLmhlaWdodHx8Y2FuLkNvbmYoaHRtbC5IRUlHSFQpCgkJbWV0YS53aWR0aCA9IG1ldGEud2lkdGh8fGNhbi5Db25mKGh0bWwuV0lEVEgpCgoJCW1ldGEudHlwZSA9IG1ldGEudHlwZXx8Y2hhdC5QTFVHSU4KCQltZXRhLm5hbWUgPSBtZXRhLm5hbWV8fHZhbHVlLm5hbWUKCQltZXRhLmhlbHAgPSBtZXRhLmhlbHB8fHZhbHVlLmhlbHAKCgkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgbWV0YSwgW2NoYXQuUExVR0lOX1NUQVRFX0pTXSwgZnVuY3Rpb24oc3ViLCBza2lwKSB7CgkJCXN1Yi5faW5kZXggPSB2YWx1ZS5pbmRleHx8bWV0YS5pbmRleAoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IGNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBzdWIuX2luZGV4XSwgY21kcyksIGNiKSB9CgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViLCBtZXRhLCBza2lwKQoJCX0sIHRhcmdldHx8Y2FuLl9vdXRwdXQpCgl9LAoJcGx1Z2luOiBmdW5jdGlvbihjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgbWV0YSA9IG1ldGF8fHt9LCBtZXRhLmluZGV4ID0gbWV0YS5pbmRleHx8Y2FuLmNvcmUuS2V5cyhtZXRhLmN0eCwgbWV0YS5jbWQpCgkJdmFyIHAgPSBjYW4ub25lbmdpbmUucGx1Z2luLm1ldGFbbWV0YS5pbmRleF0sIHJlcyA9IHt9OyBmdW5jdGlvbiBjYnMoc3ViLCBtZXRhLCBza2lwKSB7IHJlcy5fX3Byb3RvX18gPSBzdWIsIGNiKHN1YiwgbWV0YSwgc2tpcCkgfQoJCShtZXRhLm1ldGEgfHwgbWV0YS5pbnB1dHMgJiYgbWV0YS5pbnB1dHMubGVuZ3RoID4gMCk/IC8qIOWxgOmDqOWRveS7pCAqLyBjYW4ub25hcHBlbmQuX3BsdWdpbihjYW4sIHttZXRhOiBtZXRhLm1ldGEsIGxpc3Q6IG1ldGEubGlzdH0sIG1ldGEsIGNicywgdGFyZ2V0KToKCQkJcD8gLyog5YmN56uv5ZG95LukICovIGNhbi5vbmFwcGVuZC5fcGx1Z2luKGNhbiwge25hbWU6IG1ldGEuaW5kZXgsIGhlbHA6IHAuaGVscCwgbWV0YTogcC5tZXRhLCBsaXN0OiBwLmxpc3R9LCBtZXRhLCBmdW5jdGlvbihzdWIsIG1ldGEsIHNraXApIHsKCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsKCQkJCQlpZiAocC5tZXRhICYmIHAubWV0YVtjbWRzWzFdXSAmJiBjbWRzWzBdID09IGN0eC5BQ1RJT04pIHsKCQkJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMocC5tZXRhW2NtZHNbMV1dLCB7Y2FuOiBzdWIsIG1zZzogY2FuLnJlcXVlc3QoZXZlbnQpLCBjbWRzOiBjbWRzLnNsaWNlKDIpLCBjYjogY2J9KQoJCQkJCX0gZWxzZSBpZiAocC5tZXRhICYmIHAubWV0YVtjbWRzWzBdXSkgewoJCQkJCQljYW4uY29yZS5DYWxsRnVuYyhwLm1ldGFbY21kc1swXV0sIHtjYW46IHN1YiwgbXNnOiBjYW4ucmVxdWVzdChldmVudCksIGNtZHM6IGNtZHMuc2xpY2UoMSksIGNiOiBjYn0pCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMocCwge2Nhbjogc3ViLCBtc2c6IGNhbi5yZXF1ZXN0KGV2ZW50KSwgY21kczogY21kcywgY2I6IGNifSkKCQkJCQl9CgkJCQl9CgkJCQljYW4uYmFzZS5pc0Z1bmMoY2JzKSAmJiBjYnMoc3ViLCBtZXRhLCBza2lwKQoJCQl9LCB0YXJnZXQpOiAvKiDlkI7nq6/lkb3ku6QgKi8gY2FuLnJ1bihjYW4ucmVxdWVzdCh7fSwgbWV0YSkuX2V2ZW50LCBbY3R4LkFDVElPTiwgY3R4LkNPTU1BTkQsIG1ldGEuaW5kZXhdLCBmdW5jdGlvbihtc2cpIHsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7CgkJCQljYW4ub25hcHBlbmQuX3BsdWdpbihjYW4sIHZhbHVlLCBtZXRhLCBjYnMsIHRhcmdldCkKCQkJfSkgfSwgdHJ1ZSkKCQlyZXR1cm4gcmVzCgl9LAoJZmlndXJlOiBmdW5jdGlvbihjYW4sIG1ldGEsIHRhcmdldCwgY2JzKSB7IGlmIChbaHRtbC5CVVRUT04sIGh0bWwuU0VMRUNUXS5pbmRleE9mKG1ldGEudHlwZSkgPiAtMSkgeyByZXR1cm4gfQoJCXZhciBpbnB1dCA9IG1ldGEuYWN0aW9ufHxtZGIuS0VZOyBpbnB1dCAhPSBpY2UuQVVUTyAmJiBjYW4ucmVxdWlyZShbIi9wbHVnaW4vaW5wdXQvIitpbnB1dCsiLmpzIl0sIGZ1bmN0aW9uKGNhbikgewoJCQljYW4uY29yZS5JdGVtQ0IoY2FuLm9uZmlndXJlW2lucHV0XSwgZnVuY3Rpb24oa2V5LCBvbikgeyB2YXIgbGFzdCA9IHRhcmdldFtrZXldOyB0YXJnZXRba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IG9uKGV2ZW50LCBjYW4sIG1ldGEsIGZ1bmN0aW9uKGNiKSB7CgkJCQlpZiAodGFyZ2V0Ll9jYW4pIHsgcmV0dXJuIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IodGFyZ2V0Ll9jYW4sIGNicykgfQoJCQkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwge3R5cGU6IGh0bWwuSU5QVVQsIG5hbWU6IGlucHV0LCBwb3M6IGNoYXQuRkxPQVR9LCBbIi9wbHVnaW4vaW5wdXQvIitpbnB1dCsiLmpzIl0sIGZ1bmN0aW9uKHN1YikgeyBzdWIuQ29uZihtZXRhKQoJCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KGV2ZW50LCBjYW4uT3B0aW9uKCkpOyAobWV0YS5ydW58fGNhbi5ydW4pKGV2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkgfQoJCQkJCXN1Yi5jbG9zZSA9IGZ1bmN0aW9uKCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBzdWIuX3RhcmdldCksIGRlbGV0ZSh0YXJnZXQuX2NhbikgfSwgdGFyZ2V0Ll9jYW4gPSBzdWIKCgkJCQkJY2FuLm9uYXBwZW5kLl9hY3Rpb24oc3ViLCBbY2xpLkNMT1NFLCBjbGkuQ0xFQVIsIGNsaS5SRUZSRVNIXSwgc3ViLl9hY3Rpb24sIGtpdC5EaWN0KAoJCQkJCQljbGkuUkVGUkVTSCwgZnVuY3Rpb24oZXZlbnQpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpIH0sCgkJCQkJCWNsaS5DTEVBUiwgZnVuY3Rpb24oZXZlbnQpIHsgdGFyZ2V0LnZhbHVlID0gIiIgfSwKCQkJCQkJY2xpLkNMT1NFLCBmdW5jdGlvbihldmVudCkgeyBzdWIuY2xvc2UoKSB9LAoJCQkJCSkpLCBjYW4ub25hcHBlbmQuX3N0YXR1cyhzdWIsIFttZGIuVE9UQUwsIG1kYi5JTkRFWF0pCgoJCQkJCWNhbi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl90YXJnZXQsIG1ldGEuc3R5bGUpLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgc3ViLl90YXJnZXQpCgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIsIGZ1bmN0aW9uKHN1YiwgaGlkZSkgeyBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgc3ViLl90YXJnZXQsICFoaWRlKSwgY2FuLmJhc2UuaXNGdW5jKGNicykgJiYgY2JzKHN1YikgfSkKCQkJCX0sIGRvY3VtZW50LmJvZHkpCgkJCX0sIHRhcmdldCwgbGFzdCkgfSB9KQoJCX0pCgl9LAoJZmxvYXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYikgewoJCXZhciB1aSA9IGNhbi5vbmFwcGVuZC5maWVsZChjYW4sICJzdG9yeSB0b2FzdCBmbG9hdCIsIHt9LCBkb2N1bWVudC5ib2R5KQoJCXVpLmNsb3NlID0gZnVuY3Rpb24oKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLmZpcnN0KSB9CgoJCWNhbi5nZXRBY3Rpb25TaXplKGZ1bmN0aW9uKGxlZnQsIHRvcCwgaGVpZ2h0LCB3aWR0aCkgewoJCQljYW4ucGFnZS5zdHlsZShjYW4sIHVpLm91dHB1dCwgaHRtbC5NQVhfSEVJR0hULCBoZWlnaHQtMjgsIGh0bWwuTUFYX1dJRFRILCB3aWR0aCkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB1aS5maXJzdCwgaHRtbC5MRUZULCBsZWZ0LCBodG1sLlRPUCwgdG9wKQoJCX0pCgoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgW2NsaS5DTE9TRSwgY2xpLlJFRlJFU0gsIHtpbnB1dDogaHRtbC5URVhULCBwbGFjZWhvbGRlcjogImZpbHRlciIsIF9pbml0OiBmdW5jdGlvbihpbnB1dCkgewoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgImtleW1hcC5mb2N1cyIsIGNhbi5yZXF1ZXN0KHt9LCB7Y2I6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT0gIklOUFVUIikgeyByZXR1cm4gfQoJCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVTQ0FQRSkgeyB1aS5jbG9zZSgpOyByZXR1cm4gfQoJCQkJaWYgKGV2ZW50LmtleSA9PSBpY2UuU1ApIHsgaW5wdXQuZm9jdXMoKSwgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpIH0KCQkJfX0pKQoJCX0sIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pCgkJCWlmIChldmVudC5rZXkgIT0gbGFuZy5FTlRFUikgeyByZXR1cm4gfQoJCQlldmVudC50YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgLTEpCgoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS5vdXRwdXQsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyLCBpbmRleCkgeyBpZiAoaW5kZXggPT0gMCkgeyByZXR1cm4gfQoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRyLCBodG1sLkhJRERFTikKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgeyBpZiAodGQuaW5uZXJUZXh0LmluZGV4T2YoZXZlbnQudGFyZ2V0LnZhbHVlKSA+IC0xKSB7CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIHRyLCBodG1sLkhJRERFTikKCQkJCX0gfSkKCQkJfSkKCQl9fV0sIHVpLmFjdGlvbiwga2l0LkRpY3QoY2xpLkNMT1NFLCB1aS5jbG9zZSwgY2xpLlJFRlJFU0gsIGZ1bmN0aW9uKGV2ZW50KSB7IHVpLmNsb3NlKCksIGNhbi50b2FzdC5jbGljaygpfSkpCgoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgZnVuY3Rpb24odmFsdWUsIGtleSwgaW5kZXgsIGxpbmUsIGxpc3QpIHsKCQkJcmV0dXJuIHt0ZXh0OiBbdmFsdWUsIGh0bWwuVERdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgbGlzdCkKCQkJfX0KCQl9LCB1aS5vdXRwdXQpLCBjYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cuUmVzdWx0KCksIHVpLm91dHB1dCkKCQlyZXR1cm4gdWkKCX0sCgp9KQpWb2xjYW5vcygib25sYXlvdXQiLCB7aGVscDogIumhtemdouW4g+WxgCIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxkb2N1bWVudC5ib2R5CgkJaWYgKGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5GSUVMRFNFVF9NQUlOKyIucGFnZSIpLmxlbmd0aCA+IDApIHsKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBodG1sLkZJRUxEU0VUX0xFRlQsIGZ1bmN0aW9uKGZpZWxkLCBpbmRleCkgewoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBmaWVsZCwgIiIpCgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9MRUZULCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBvdXRwdXQsICIiKQoJCQkJfSkKCQkJfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBodG1sLkZJRUxEU0VUX01BSU4sIGZ1bmN0aW9uKGZpZWxkLCBpbmRleCkgewoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBmaWVsZCwgIiIpCgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9NQUlOLCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBvdXRwdXQsICIiKQoJCQkJfSkKCQkJfSkKCQkJcmV0dXJuCgkJfQoKCQl2YXIgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCwgaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBjYW4ucGFnZS5LZXlzKGh0bWwuRklFTERTRVRfSEVBRCwgaHRtbC5GSUVMRFNFVF9GT09UKSwgZnVuY3Rpb24oZmllbGQpIHsKCQkJaGVpZ2h0IC09IGZpZWxkLm9mZnNldEhlaWdodAoJCX0pCgoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5GSUVMRFNFVF9MRUZULCBmdW5jdGlvbihmaWVsZCwgaW5kZXgpIHsKCQkJdmFyIG9mZnNldCA9IGNhbi51c2VyLmlzTW9iaWxlICYmICFjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAxMDA6IDAKCQkJY2FuLnVzZXIuaXNNb2JpbGUgfHwgKHdpZHRoIC09IGZpZWxkLm9mZnNldFdpZHRoKQoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGZpZWxkLCBoZWlnaHQtb2Zmc2V0KQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9MRUZULCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIG91dHB1dCwgaGVpZ2h0LWh0bWwuQUNUSU9OX0hFSUdIVC0xLW9mZnNldCkKCQkJfSkKCQl9KQoKCQljYW4udXNlci5pc01vYmlsZSB8fCBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuRklFTERTRVRfTUFJTiwgZnVuY3Rpb24oZmllbGQsIGluZGV4KSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgZmllbGQsIGh0bWwuSEVJR0hULCBoZWlnaHQsIGh0bWwuV0lEVEgsIHdpZHRoKQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9NQUlOLCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQloZWlnaHQgLT0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZmllbGQsIGh0bWwuRElWX0FDVElPTilbMF0ub2Zmc2V0SGVpZ2h0CgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIG91dHB1dCwgaGVpZ2h0KQoJCQl9KQoJCX0pCgoJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBjaGF0Lk9OU0laRSwgY2FuLnJlcXVlc3Qoe30sIHt3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0fSkpCgl9LAoJdG9waWM6IGZ1bmN0aW9uKGNhbiwgdG9waWMpIHsgdG9waWMgJiYgKGNhbi5fdG9waWMgPSB0b3BpYykKCQljYW4udXNlci50b3BpYyhjYW4sIGNhbi5fdG9waWMgfHwgY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5UT1BJQykgfHwgVm9sY2Fub3MubWV0YS5hcmdzLnRvcGljIHx8IChjYW4uYmFzZS5pc05pZ2h0KCk/IGNoYXQuQkxBQ0s6IGNoYXQuV0hJVEUpKQoJfSwKCWJhY2tncm91bmQ6IGZ1bmN0aW9uKGNhbiwgdXJsLCB0YXJnZXQpIHsKCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldHx8ZG9jdW1lbnQuYm9keSwgaHRtbC5CQUNLR1JPVU5ELCB1cmwgPT0gIiIgfHwgdXJsID09ICJ2b2lkIj8gIiI6ICd1cmwoIicrdXJsKyciKScpCgl9LAoJZmlndXJlOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIHJpZ2h0LCBsYXlvdXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCWlmIChsYXlvdXQpIHsgcmV0dXJuIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBsYXlvdXQpLCBjYW4ub25tb3Rpb24ubW92ZShjYW4sIHRhcmdldCwgbGF5b3V0KSwgbGF5b3V0IH0KCQlpZiAoIWV2ZW50IHx8ICFldmVudC50YXJnZXQgfHwgIWV2ZW50LmNsaWVudFgpIHsgcmV0dXJuIHt9IH0KCgkJdmFyIGxlZnQgPSBldmVudC5jbGllbnRYLWV2ZW50Lm9mZnNldFgsIHRvcCA9IGV2ZW50LmNsaWVudFktZXZlbnQub2Zmc2V0WStldmVudC50YXJnZXQub2Zmc2V0SGVpZ2h0LTU7IGlmIChyaWdodCkgewoJCQl2YXIgbGVmdCA9IGV2ZW50LmNsaWVudFgtZXZlbnQub2Zmc2V0WCtldmVudC50YXJnZXQub2Zmc2V0V2lkdGgsIHRvcCA9IGV2ZW50LmNsaWVudFktZXZlbnQub2Zmc2V0WQoJCX0KCgkJbGF5b3V0ID0ge2xlZnQ6IGxlZnQsIHRvcDogdG9wfQoJCWlmIChsYXlvdXQudG9wIDwgMCkgeyBsYXlvdXQudG9wID0gMCB9CgkJaWYgKGxheW91dC5sZWZ0IDwgMCkgeyBsYXlvdXQubGVmdCA9IDAgfQoJCWlmIChsYXlvdXQubGVmdCt0YXJnZXQub2Zmc2V0V2lkdGg+d2luZG93LmlubmVyV2lkdGgpIHsKCQkJbGF5b3V0LnJpZ2h0ID0gMCwgbGF5b3V0LmxlZnQgPSAiIgoJCX0KCQlpZiAoIShjYW4udXNlci5pc01vYmlsZSAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpKSAmJiB0b3ArdGFyZ2V0Lm9mZnNldEhlaWdodD53aW5kb3cuaW5uZXJIZWlnaHQtMzIpIHsKCQkJbGF5b3V0LmJvdHRvbSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGV2ZW50LmNsaWVudFkrZXZlbnQub2Zmc2V0WSwgbGF5b3V0LnRvcCA9ICIiCgkJCWlmIChyaWdodCkgeyBsYXlvdXQuYm90dG9tIC09IHRhcmdldC5vZmZzZXRIZWlnaHQgfQoJCX0KCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGxheW91dCksIGNhbi5vbm1vdGlvbi5tb3ZlKGNhbiwgdGFyZ2V0LCBsYXlvdXQpLCBsYXlvdXQKCX0sCgoJZGlzcGxheTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmRzKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjaGF0LkxBWU9VVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFsKCQkJe3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dmlldzogY2hhdC5DT05URU5UfV19LAoJCQl7dHlwZTogaHRtbC5UUiwgbGlzdDogW3t2aWV3OiBjaGF0LkRJU1BMQVl9XX0sCgkJXX1dKQoJfSwKCXByb2plY3Q6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjaGF0LkxBWU9VVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQl7dHlwZTogaHRtbC5URCwgbGlzdDogW3t2aWV3OiBjaGF0LlBST0pFQ1QsIHN0eWxlOiB7ZGlzcGxheTogaHRtbC5OT05FfX1dfSwge3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFsKCQkJCXt2aWV3OiBbY2hhdC5MQVlPVVQsIGh0bWwuVEFCTEVdLCBsaXN0OiBbCgkJCQkJe3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dmlldzogY2hhdC5DT05URU5UfV19LAoJCQkJCXt0eXBlOiBodG1sLlRSLCBsaXN0OiBbe3ZpZXc6IGNoYXQuRElTUExBWX1dfSwKCQkJCV19CgkJCV19CgkJXX1dIH1dKQoJfSwKCXByb2ZpbGU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl9vdXRwdXQKCQlmdW5jdGlvbiB0b2dnbGUodmlldykgewoJCQl2aWV3Ll90b2dnbGU/IHZpZXcuX3RvZ2dsZShldmVudCwgdmlldy5zdHlsZS5kaXNwbGF5ID09IGh0bWwuTk9ORSk6IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCB2aWV3KQoJCQlyZXR1cm4gdmlldy5zdHlsZS5kaXNwbGF5ID09IGh0bWwuTk9ORQoJCX0KCgkJdmFyIGd0ID0gIiYjMTAwOTU7IiwgbHQgPSAiJiMxMDA5NDsiLCBkb3duID0gIiYjNzA5OyIsIHVwID0gIiYjNzA4OyIKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2NoYXQuTEFZT1VULCBodG1sLlRBQkxFXSwgbGlzdDogWwoJCQl7dmlldzogW2NoYXQuUFJPSkVDVCwgaHRtbC5URF0sIGxpc3Q6IFt7dmlldzogW2NoYXQuUFJPSkVDVF19XX0sCgkJCXt0eXBlOiBodG1sLlRELCBsaXN0OiBbCgkJCQl7dHlwZTogaHRtbC5UUiwgbGlzdDogW3t0eXBlOiBodG1sLlRSLCBsaXN0OiBbCgkJCQkJe3ZpZXc6IFtjaGF0LkNPTlRFTlQsIGh0bWwuVERdLCBsaXN0OiBbe3ZpZXc6IFtjaGF0LkNPTlRFTlRdfSwKCQkJCQkJe3ZpZXc6IFtbaHRtbC5UT0dHTEUsIGNoYXQuUFJPSkVDVF1dLCBsaXN0OiBbe3RleHQ6IFtndCwgaHRtbC5ESVZdfV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCQlldmVudC50YXJnZXQuaW5uZXJIVE1MID0gdG9nZ2xlKGNhbi51aS5wcm9qZWN0KT8gZ3Q6IGx0CgkJCQkJCX19LAoJCQkJCQl7dmlldzogW1todG1sLlRPR0dMRSwgY2hhdC5QUk9GSUxFXV0sIGxpc3Q6IFt7dGV4dDogW2x0LCBodG1sLkRJVl19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCWV2ZW50LnRhcmdldC5pbm5lckhUTUwgPSB0b2dnbGUoY2FuLnVpLnByb2ZpbGUpPyBsdDogZ3QKCQkJCQkJfX0sCgkJCQkJCXt2aWV3OiBbW2h0bWwuVE9HR0xFLCBjaGF0LkRJU1BMQVldXSwgbGlzdDogW3t0ZXh0OiBbdXAsIGh0bWwuRElWXX1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQkJZXZlbnQudGFyZ2V0LmlubmVySFRNTCA9IHRvZ2dsZShjYW4udWkuZGlzcGxheSk/IHVwOiBkb3duCgkJCQkJCX19LAoJCQkJCV19LAoJCQkJCXt2aWV3OiBbY2hhdC5QUk9GSUxFLCBodG1sLlREXSwgbGlzdDogW3t2aWV3OiBbY2hhdC5QUk9GSUxFXSwgc3R5bGU6IHtkaXNwbGF5OiBodG1sLk5PTkV9fV19LAoJCQkJXX1dfSwKCQkJCXt2aWV3OiBbY2hhdC5ESVNQTEFZLCBodG1sLlRSXSwgbGlzdDogW3t2aWV3OiBbY2hhdC5ESVNQTEFZXSwgc3R5bGU6IHtkaXNwbGF5OiBodG1sLk5PTkV9fV19CgkJCV19CgkJXSB9XSk7IHJldHVybiBjYW4udWkgPSB1aQoJfSwKfSkKVm9sY2Fub3MoIm9ubW90aW9uIiwge2hlbHA6ICLliqjmgIHnibnmlYgiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIm9yaWVudGF0aW9uY2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvcmllbnRhdGlvbmNoYW5nZSIpCgkJfSksIGNhbi5vbm1vdGlvbi5mbG9hdC5hdXRvKGNhbiwgdGFyZ2V0KQoJfSwKCWZvY3VzOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyBpZiAoIXRhcmdldCkgeyByZXR1cm4gfQoJCXRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZSAmJiB0YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgLTEpLCB0YXJnZXQuZm9jdXMoKQoJfSwKCXNoYXJlOiBmdW5jdGlvbihldmVudCwgY2FuLCBpbnB1dCwgYXJncykgewoJCXJldHVybiBjYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBpbnB1dCwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgX2FyZ3MpIHsKCQkJY2FuLnNlYXJjaChjYW4ucmVxdWVzdChldmVudCwge2FyZ3M6IFttZGIuVFlQRSwgY2hhdC5GSUVMRF0uY29uY2F0KGFyZ3N8fFtdLCBfYXJnc3x8W10pfSkuX2V2ZW50LCBbWyJIZWFkZXIiLCBjaGF0Lk9OQUNUSU9OLCB3ZWIuU0hBUkVdXSkKCQl9KQoJfSwKCXN0b3J5OiB7CgkJX2hhc2g6IHsKCQkJc3Bhcms6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgdGFyZ2V0KSB7CgkJCQltZXRhW21kYi5OQU1FXSA9PSBodG1sLklOTkVSPyBjYW4ub25tb3Rpb24uY29weShjYW4sIHRhcmdldCk6IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5TUEFOLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJY2FuLm9ubW90aW9uLmNvcHkoY2FuLCBpdGVtKQoJCQkJfSkKCQkJfSwKCQl9LAoJCWF1dG86IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHZhciB0aGF0ID0gdGhpcwoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXR8fGNhbi5fb3V0cHV0LCAiLnN0b3J5IiwgZnVuY3Rpb24oaXRlbSkgeyB2YXIgbWV0YSA9IGl0ZW0uZGF0YXNldAoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBpdGVtLCBjYW4uYmFzZS5PYmoobWV0YS5zdHlsZSkpCgkJCQljYW4uY29yZS5DYWxsRnVuYyh0aGF0Ll9oYXNoW21ldGEudHlwZV0sIFtjYW4sIG1ldGEsIHRhcmdldHx8Y2FuLl9vdXRwdXRdKQoJCQl9KQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXR8fGNhbi5fb3V0cHV0LCBodG1sLklGUkFNRSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBpdGVtLCBodG1sLkhFSUdIVCwgY2FuLkNvbmYoaHRtbC5IRUlHSFQpLTg4LCBodG1sLldJRFRILCBjYW4uQ29uZihodG1sLldJRFRIKS0zMCkKCQkJfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgaHRtbC5TVkcsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWl0ZW0ub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLnVzZXIuY2FydGUoZXZlbnQsIGNhbiwga2l0LkRpY3QobWRiLkVYUE9SVCwgZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgoJCQkJCX0pLCBbbWRiLkVYUE9SVF0pCgkJCQl9CgkJCX0pCgkJfSwKCX0sCglmbG9hdDoge19oYXNoOiB7fSwKCQlkZWw6IGZ1bmN0aW9uKGNhbiwga2V5KSB7CgkJCWtleSA9PSBjaGF0LkNBUlRFICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGRvY3VtZW50LmJvZHksIGNhbi5jb3JlLktleXMoaHRtbC5ESVYsIGNoYXQuQ0FSVEUpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBpdGVtKQoJCQl9KQoJCQl2YXIgbGFzdCA9IHRoaXMuX2hhc2hba2V5XTsgaWYgKCFsYXN0KSB7IHJldHVybiB9CgkJCWxhc3QuY2xvc2U/IGxhc3QuY2xvc2UoKTogY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgbGFzdC5fdGFyZ2V0KQoJCX0sCgkJYWRkOiBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUpIHsgcmV0dXJuIHRoaXMuZGVsKGNhbiwga2V5KSwgdGhpcy5faGFzaFtrZXldID0gdmFsdWUgfSwKCQlhdXRvOiBmdW5jdGlvbihjYW4sIHRhcmdldCwga2V5KSB7IHZhciB0aGF0ID0gdGhpcwoJCQl2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKS5zbGljZSgyKQoJCQlpZiAobGlzdC5sZW5ndGggPT0gMCkgeyBsaXN0ID0gW2NoYXQuQ0FSVEUsIGNoYXQuSU5QVVRdIH0KCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCB7b25tb3VzZW92ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7IAoJCQkJaWYgKGNhbi5wYWdlLnRhZ2lzKGh0bWwuSU1HLCBldmVudC50YXJnZXQpKSB7IHJldHVybiB9CgkJCQljYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGtleSwgaW5kZXgpIHsgdGhhdC5kZWwoY2FuLCBrZXkpIH0pCgkJCX19KQoJCX0sCgl9LAoJY2FjaGU6IGZ1bmN0aW9uKGNhbiwgbmV4dCkgeyB2YXIgbGlzdCA9IGNhbi5iYXNlLk9iaihjYW4uY29yZS5MaXN0KGFyZ3VtZW50cykuc2xpY2UoMiksIFtjYW4uX291dHB1dF0pCgkJY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtKSB7IGNhbi5wYWdlLkNhY2hlKGl0ZW0uX2NhY2hlX2tleSwgaXRlbSwgaXRlbS5zY3JvbGxUb3ArMSkgfSkKCQl2YXIga2V5ID0gbmV4dChjYW4uX2NhY2hlX2RhdGEgPSBjYW4uX2NhY2hlX2RhdGF8fHt9KQoJCXJldHVybiBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIHBvcyA9IGNhbi5wYWdlLkNhY2hlKGl0ZW0uX2NhY2hlX2tleSA9IGtleSwgaXRlbSkKCQkJaWYgKHBvcykgeyBpdGVtLnNjcm9sbFRvICYmIGl0ZW0uc2Nyb2xsVG8oMCwgcG9zLTEpOyByZXR1cm4gaXRlbSB9CgkJfSkubGVuZ3RoID4gMAoJfSwKCWNsZWFyOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyByZXR1cm4gY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgIiIpLCB0cnVlIH0sCglkZWxheTogZnVuY3Rpb24oY2FuLCBjYikgeyBjYW4uY29yZS5UaW1lcigxMDAsIGNiKSB9LAoKCWhpZGRlbjogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHNob3cpIHsKCQljYW4ucGFnZS5zdHlsZURpc3BsYXkoY2FuLCB0YXJnZXR8fGNhbi5fdGFyZ2V0LCBzaG93PyAiIjogaHRtbC5OT05FKQoJfSwKCXRvZ2dsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHNob3csIGhpZGUpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCXZhciBzdGF0dXMgPSB0YXJnZXQuc3R5bGUuZGlzcGxheSA9PSBodG1sLk5PTkUKCQlpZiAoIShzdGF0dXM/IGNhbi5iYXNlLmlzRnVuYyhzaG93KSAmJiBzaG93KCk6IGNhbi5iYXNlLmlzRnVuYyhoaWRlKSAmJiBoaWRlKCkpKSB7CgkJCWNhbi5wYWdlLnN0eWxlRGlzcGxheShjYW4sIHRhcmdldCwgc3RhdHVzPyAiIjogaHRtbC5OT05FKQoJCX0KCQlyZXR1cm4gc3RhdHVzCgl9LAoJc2VsZWN0OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgbmFtZSwgd2hpY2gpIHsKCQl2YXIgb2xkID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBuYW1lLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQlpZiAoY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGl0ZW0sICJzZWxlY3QiKSkgeyByZXR1cm4gaW5kZXggfQoJCX0pWzBdCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBuYW1lLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgaXRlbSwgaHRtbC5TRUxFQ1QsIGl0ZW0gPT0gd2hpY2ggfHwgd2hpY2ggPT0gaW5kZXgpCgkJfSkKCQlyZXR1cm4gb2xkCgl9LAoJbW9kaWZ5OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgY2IsIGl0ZW0pIHsgdmFyIGJhY2sgPSB0YXJnZXQuaW5uZXJIVE1MLCB0ZXh0ID0gdGFyZ2V0LmlubmVyVGV4dAoJCWlmIChiYWNrLmxlbmd0aCA+IDEyMCB8fCBiYWNrLmluZGV4T2YoaWNlLk5MKSA+IC0xKSB7CgkJCXJldHVybiBjYW4ub25tb3Rpb24ubW9kaWZ5cyhjYW4sIHRhcmdldCwgY2IpCgkJfQoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dHlwZTogaHRtbC5JTlBVVCwgdmFsdWU6IHRhcmdldC5pbm5lclRleHQsIHN0eWxlOiB7CgkJCXdpZHRoOiB0YXJnZXQub2Zmc2V0V2lkdGggPiA0MDA/IDQwMDogdGFyZ2V0Lm9mZnNldFdpZHRoLTIwLAoJCX0sIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJc3dpdGNoIChldmVudC5rZXkpIHsKCQkJCWNhc2UgbGFuZy5FTlRFUjogdGFyZ2V0LmlubmVySFRNTCA9IGV2ZW50LnRhcmdldC52YWx1ZQoJCQkJCWV2ZW50LnRhcmdldC52YWx1ZSA9PSBiYWNrIHx8IGNiKGV2ZW50LCBldmVudC50YXJnZXQudmFsdWUsIGJhY2spCgkJCQkJYnJlYWsKCQkJCWNhc2UgbGFuZy5FU0NBUEU6IHRhcmdldC5pbm5lckhUTUwgPSBiYWNrOyBicmVhawoJCQkJZGVmYXVsdDogY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pCgkJCX0KCQl9LCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCWl0ZW0gJiYgY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIGl0ZW0sIHRhcmdldCksIHRhcmdldC52YWx1ZSA9IHRleHQKCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgdGFyZ2V0KQoJCX19XSkKCX0sCgltb2RpZnlzOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgY2IsIGl0ZW0pIHsgdmFyIGJhY2sgPSB0YXJnZXQuaW5uZXJIVE1MCgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIHRhcmdldCwgW3t0eXBlOiBodG1sLlRFWFRBUkVBLCB2YWx1ZTogdGFyZ2V0LmlubmVyVGV4dCwgc3R5bGU6IHsKCQkJd2lkdGg6IHRhcmdldC5vZmZzZXRXaWR0aCA+IDQwMD8gNDAwOiB0YXJnZXQub2Zmc2V0V2lkdGgtMjAsIGhlaWdodDogdGFyZ2V0Lm9mZnNldEhlaWdodCA8IDYwPyA2MDogdGFyZ2V0Lm9mZnNldEhlaWdodC0yMCwKCQl9LCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCQljYXNlIGxhbmcuRU5URVI6CgkJCQkJaWYgKGV2ZW50LmN0cmxLZXkpIHsgdGFyZ2V0LmlubmVySFRNTCA9IGV2ZW50LnRhcmdldC52YWx1ZQoJCQkJCQlldmVudC50YXJnZXQudmFsdWUgPT0gYmFjayB8fCBjYihldmVudCwgZXZlbnQudGFyZ2V0LnZhbHVlLCBiYWNrKQoJCQkJCX0KCQkJCQlicmVhawoJCQkJY2FzZSBsYW5nLkVTQ0FQRTogdGFyZ2V0LmlubmVySFRNTCA9IGJhY2s7IGJyZWFrCgkJCQlkZWZhdWx0OiBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbikKCQkJfQoJCX0sIF9pbml0OiBmdW5jdGlvbih0YXJnZXQpIHsKCQkJaXRlbSAmJiBjYW4ub25hcHBlbmQuZmlndXJlKGNhbiwgaXRlbSwgdGFyZ2V0KQoJCQljYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgkJfX1dKQoJfSwKCXRvaW1hZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG5hbWUsIHRhcmdldCkgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7bmFtZTogIm5hbWUiLCB2YWx1ZTogbmFtZX1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhKSB7CgkJCWNhbi5yZXF1aXJlKFsiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9odG1sMmNhbnZhc0AxLjAuMC1yYy41L2Rpc3QvaHRtbDJjYW52YXMubWluLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQkJaHRtbDJjYW52YXModGFyZ2V0fHxjYW4uX3RhcmdldCkudGhlbihmdW5jdGlvbiAoY2FudmFzKSB7CgkJCQkJY2FuLnBhZ2UuQ3JlYXRlKGNhbiwgaHRtbC5BLCB7aHJlZjogY2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIiksIGRvd25sb2FkOiBkYXRhLm5hbWV9KS5jbGljaygpCgkJCQl9KQoJCQl9KQoJCX0pCgl9LAoKCWxpbms6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCB0ZXh0KSB7CgkJaWYgKHRhcmdldC5pbm5lclRleHQgPT0gIiIpIHsgdGFyZ2V0LmlubmVyVGV4dCA9IHRhcmdldC5ocmVmIH0KCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB0YXJnZXQsIHt0YXJnZXQ6ICJfYmxhbmsifSkKCX0sCgljb3B5OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdGV4dCwgY2IpIHsKCQl0YXJnZXQudGl0bGUgPSAi54K55Ye75aSN5Yi2IiwgdGFyZ2V0Lm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewoJCQljYW4udXNlci5jb3B5KGV2ZW50LCBjYW4sIHRleHR8fHRhcmdldC5pbm5lclRleHQpCgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQpCgkJfQoJfSwKCW1vdmU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBsYXlvdXQsIGNiKSB7IHZhciBiZWdpbjsgbGF5b3V0ID0gbGF5b3V0fHx7fQoJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBsYXlvdXQpLCB0YXJnZXQub25tb3VzZWRvd24gPSBmdW5jdGlvbihldmVudCkgewoJCQlsYXlvdXQuaGVpZ2h0ID0gdGFyZ2V0Lm9mZnNldEhlaWdodCwgbGF5b3V0LndpZHRoID0gdGFyZ2V0Lm9mZnNldFdpZHRoCgkJCWxheW91dC5sZWZ0ID0gdGFyZ2V0Lm9mZnNldExlZnQsIGxheW91dC50b3AgPSB0YXJnZXQub2Zmc2V0VG9wCgkJCWJlZ2luID0gY2FuLmJhc2UuQ29weSh7eDogZXZlbnQueCwgeTogZXZlbnQueX0sIGxheW91dCkKCQl9LCB0YXJnZXQub25tb3VzZXVwID0gZnVuY3Rpb24oZXZlbnQpIHsgYmVnaW4gPSBudWxsIH0KCgkJdGFyZ2V0Lm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24oZXZlbnQpIHsgaWYgKCFiZWdpbiB8fCAhZXZlbnQuY3RybEtleSkgeyByZXR1cm4gfQoJCQlpZiAoZXZlbnQuc2hpZnRLZXkpIHsKCQkJCWxheW91dC53aWR0aCA9IGxheW91dC53aWR0aCArIGV2ZW50LnggLSBiZWdpbi54IAoJCQkJbGF5b3V0LmhlaWdodCA9IGxheW91dC5oZWlnaHQgKyBldmVudC55IC0gYmVnaW4ueQoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuSEVJR0hULCBsYXlvdXQuaGVpZ2h0LCBodG1sLldJRFRILCBsYXlvdXQud2lkdGgpCgkJCX0gZWxzZSB7CgkJCQlsYXlvdXQudG9wID0gYmVnaW4udG9wICsgZXZlbnQueSAtIGJlZ2luLnkKCQkJCWxheW91dC5sZWZ0ID0gYmVnaW4ubGVmdCArIGV2ZW50LnggLSBiZWdpbi54IAoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTEVGVCwgbGF5b3V0LmxlZnQsIGh0bWwuVE9QLCBsYXlvdXQudG9wKQoJCQl9CgkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih0YXJnZXQsIGxheW91dCkKCQl9CgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih0YXJnZXQsIGxheW91dCkKCX0sCglzaG93OiBmdW5jdGlvbihjYW4sIHRpbWUsIGNiLCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCXRpbWUgPSBjYW4uYmFzZS5pc09iamVjdCh0aW1lKT8gdGltZToge2ludGVydmFsOiAxMCwgbGVuZ3RoOiB0aW1lfHwzMH0KCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5PUEFDSVRZLCAwLCBodG1sLkRJU1BMQVksIGh0bWwuQkxPQ0spCgkJY2FuLmNvcmUuVGltZXIodGltZSwgZnVuY3Rpb24oZXZlbnQsIHZhbHVlLCBpbmRleCkgewoJCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5PUEFDSVRZLCAoaW5kZXgrMSkvdGltZS5sZW5ndGgpCgkJfSwgY2IpCgl9LAoJaGlkZTogZnVuY3Rpb24oY2FuLCB0aW1lLCBjYiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQl0aW1lID0gY2FuLmJhc2UuaXNPYmplY3QodGltZSk/IHRpbWU6IHt2YWx1ZTogMTAsIGxlbmd0aDogdGltZXx8MjB9CgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuT1BBQ0lUWSwgMSkKCQljYW4uY29yZS5UaW1lcih0aW1lLCBmdW5jdGlvbihldmVudCwgdmFsdWUsIGluZGV4KSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLk9QQUNJVFksIDEtKGluZGV4KzEpL3RpbWUubGVuZ3RoKQoJCX0sIGZ1bmN0aW9uKCkgeyBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCksIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkRJU1BMQVksIGh0bWwuTk9ORSkgfSkKCX0sCgoJc2VsZWN0RmllbGQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQlpZiAoZXZlbnQua2V5ID09ICJFbnRlciIpIHsgcmV0dXJuIGNhbi5ydW4oZXZlbnQpIH0KCQlpZiAoIWV2ZW50LmN0cmxLZXkgfHwgZXZlbnQua2V5IDwgIjAiIHx8IGV2ZW50LmtleSA+ICI5IikgeyByZXR1cm4gfQoJCWlmIChldmVudC5zaGlmdEtleSkgewoJCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vcHRpb24sICJpbnB1dFt0eXBlPWJ1dHRvbl0iLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQkJaW5kZXggPT0gZXZlbnQua2V5ICYmIChpdGVtLmNsaWNrKCkpCgkJCX0pCgkJfQoJCWlmIChldmVudC5rZXkgPT0gIjAiKSB7IHJldHVybiBjYW4ub25pbXBvcnQuX2JhY2soY2FuKSB9CgoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0ciwgaW5kZXgpIHsgaWYgKGluZGV4ID09IGV2ZW50LmtleSkgewoJCQl2YXIgaGVhZCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRILCBmdW5jdGlvbih0aCwgb3JkZXIpIHsgcmV0dXJuIHRoLmlubmVyVGV4dCB9KQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQsIGluZGV4KSB7IGNhbi5PcHRpb24oaGVhZFtpbmRleF0sIHRkLmlubmVyVGV4dCkgfSkKCQkJY2FuLlVwZGF0ZShldmVudCkKCQl9IH0pCgl9LAoJc2VsZWN0VGFibGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY2IpIHsgaWYgKCFldmVudC5jdHJsS2V5KSB7IHJldHVybiB9CgkJZnVuY3Rpb24gc2VsZWN0KG9yZGVyKSB7IHZhciBpbmRleCA9IDAKCQkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0cikgewoJCQkJaWYgKGNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgaHRtbC5ISURERU4pKSB7IHJldHVybiB9CgkJCQlpZiAoIWNhbi5wYWdlLkNsYXNzTGlzdC5zZXQoY2FuLCB0ciwgaHRtbC5TRUxFQ1QsIG9yZGVyID09IGluZGV4KyspKSB7IHJldHVybiB0ciB9CgkJCQlyZXR1cm4gY2FuLlN0YXR1cyhtZGIuSU5ERVgsIGluZGV4LTEpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHRyKSwgdHIKCQkJfSkubGVuZ3RoCgkJfQoJCXZhciB0b3RhbCA9IHNlbGVjdCh0YXJnZXQuX2luZGV4KTsgc3dpdGNoIChldmVudC5rZXkpIHsKCQkJY2FzZSAibiI6IHNlbGVjdCh0YXJnZXQuX2luZGV4ID0gKCh0YXJnZXQuX2luZGV4KSsxKSAlIHRvdGFsKTsgYnJlYWsKCQkJY2FzZSAicCI6IHNlbGVjdCh0YXJnZXQuX2luZGV4ID0gKHRhcmdldC5faW5kZXgtMSkgPCAwPyB0b3RhbC0xOiAodGFyZ2V0Ll9pbmRleC0xKSk7IGJyZWFrCgkJCWRlZmF1bHQ6IHRhcmdldC5faW5kZXggPSAwOyByZXR1cm4KCQl9IGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJfSwKCXNlbGVjdFRhYmxlSW5wdXQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY2IpIHsKCQlpZiAodGFyZ2V0LnZhbHVlID09ICIiKSB7IHJldHVybiBjYigpIH0KCQlpZiAoZXZlbnQuY3RybEtleSkgewoJCQlmdW5jdGlvbiBzZWxlY3Qob3JkZXIpIHsgaWYgKG9yZGVyID09IDApIHsgdGFyZ2V0LnZhbHVlID0gdGFyZ2V0Ll92YWx1ZSB9CgkJCQl2YXIgaW5kZXggPSAwOyByZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyKSB7CgkJCQkJaWYgKGNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgaHRtbC5ISURERU4pKSB7IHJldHVybiB9CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIHRyLCBodG1sLlNFTEVDVCk7IGlmIChvcmRlciAhPSBpbmRleCsrKSB7IHJldHVybiB0ciB9CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRyLCBodG1sLlNFTEVDVCksIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCwgaW5kZXgpIHsKCQkJCQkJdGFyZ2V0Ll92YWx1ZSA9IHRhcmdldC5fdmFsdWV8fHRhcmdldC52YWx1ZSwgaW5kZXggPT0gMCAmJiAodGFyZ2V0LnZhbHVlID0gdGQuaW5uZXJUZXh0KQoJCQkJCX0pOyByZXR1cm4gdHIKCQkJCX0pLmxlbmd0aAoJCQl9CgkJCXZhciB0b3RhbCA9IHNlbGVjdCh0YXJnZXQuX2luZGV4KTsgc3dpdGNoIChldmVudC5rZXkpIHsKCQkJCWNhc2UgIm4iOiBzZWxlY3QodGFyZ2V0Ll9pbmRleCA9ICgodGFyZ2V0Ll9pbmRleCkrMSkgJSB0b3RhbCk7IGJyZWFrCgkJCQljYXNlICJwIjogc2VsZWN0KHRhcmdldC5faW5kZXggPSAodGFyZ2V0Ll9pbmRleC0xKSA8IDA/IHRvdGFsLTE6ICh0YXJnZXQuX2luZGV4LTEpKTsgYnJlYWsKCQkJCWRlZmF1bHQ6IHRhcmdldC5faW5kZXggPSAwLCB0YXJnZXQuX3ZhbHVlID0gIiI7IHJldHVybgoJCQl9IHJldHVybiBjYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQl9CgoJCXRhcmdldC5faW5kZXggPSAwLCB0YXJnZXQuX3ZhbHVlID0gIiIKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5UUiwgZnVuY3Rpb24odHIsIGluZGV4KSB7CgkJCXZhciBoYXMgPSBmYWxzZTsgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdHIsIGh0bWwuVEQsIGZ1bmN0aW9uKHRkKSB7CgkJCQloYXMgPSBoYXMgfHwgdGQuaW5uZXJUZXh0LmluZGV4T2YodGFyZ2V0LnZhbHVlKT4tMQoJCQl9KSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIHRyLCBodG1sLkhJRERFTiwgIWhhcyAmJiBpbmRleCAhPSAwKQoJCX0pCgoJCXZhciB0b3RhbCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0cikgewoJCQlpZiAoIWNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgaHRtbC5ISURERU4pKSB7IHJldHVybiB0cn0KCQl9KS5sZW5ndGgtMTsgdG90YWwgPT0gMCAmJiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQljYW4uU3RhdHVzKGtpdC5EaWN0KG1kYi5UT1RBTCwgdG90YWwsIG1kYi5JTkRFWCwgdGFyZ2V0Ll9pbmRleCkpCgl9LAp9KQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIumUruebmOS6pOS6kiIsIGxpc3Q6IFtdLCBfZm9jdXM6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQlkb2N1bWVudC5ib2R5Lm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewoJCQlpZiAod2luZG93LndlYnZpZXcpIHsKCQkJCWlmIChldmVudC50YXJnZXQudGFnTmFtZSA9PSAiQSIpIHsKCQkJCQl3aW5kb3cub3BlbihldmVudC50YXJnZXQuaHJlZikKCQkJCX0KCQkJfQoJCX0KCQljYW4ub25rZXltYXAuX2J1aWxkKGNhbiksIGRvY3VtZW50LmJvZHkub25rZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJaWYgKGV2ZW50Lm1ldGFLZXkpIHsgaWYgKHdpbmRvdy53ZWJ2aWV3KSB7CgkJCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQkJCWNhc2UgInEiOiB3aW5kb3cudGVybWluYXRlKCk7IGJyZWFrCgkJCQkJY2FzZSAidyI6IHdpbmRvdy5jbG9zZSgpOyBicmVhawoJCQkJCWNhc2UgInIiOiBsb2NhdGlvbi5yZWxvYWQoKTsgYnJlYWsKCQkJCQljYXNlICJmIjogY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbm9wZW5zZWFyY2giLCBjYW4ucmVxdWVzdCh7fSwge3R5cGU6ICIqIn0pKTsgYnJlYWsKCQkJCQljYXNlICJbIjogaGlzdG9yeS5iYWNrKCk7IGJyZWFrCgkJCQkJY2FzZSAiXSI6IGhpc3RvcnkuZm9yd2FyZCgpOyBicmVhawoJCQkJfQoJCQl9IHJldHVybiB9CgkJCWlmIChjYW4ucGFnZS50YWdpcyhbaHRtbC5TRUxFQ1QsIGh0bWwuSU5QVVQsIGh0bWwuVEVYVEFSRUFdLCBldmVudC50YXJnZXQpKSB7IHJldHVybiB9CgkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgeyJtb2RlbCI6ICJub3JtYWwifSk7IGlmIChtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFKSA9PSBpY2UuVFJVRSkgeyByZXR1cm4gfQoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTktFWURPV04sIG1zZyk7IGlmIChtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFKSA9PSBpY2UuVFJVRSkgeyByZXR1cm4gfQoJCQljYW4uX2tleWxpc3QgPSBjYW4ub25rZXltYXAuX3BhcnNlKGV2ZW50LCBjYW4sIG1zZy5PcHRpb24oIm1vZGVsIiksIGNhbi5fa2V5bGlzdCwgY2FuLl9vdXRwdXQpCgkJfQoJfSwKCV9idWlsZDogZnVuY3Rpb24oY2FuKSB7CgkJY2FuLmNvcmUuSXRlbShjYW4ub25rZXltYXAuX21vZGUsIGZ1bmN0aW9uKGl0ZW0sIHZhbHVlKSB7IHZhciBlbmdpbmUgPSB7bGlzdDoge319CgkJCWNhbi5jb3JlLkl0ZW0odmFsdWUsIGZ1bmN0aW9uKGtleSwgY2IpIHsgdmFyIG1hcCA9IGVuZ2luZQoJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBrZXkubGVuZ3RoOyBpKyspIHsKCQkJCQlpZiAoIW1hcC5saXN0W2tleVtpXV0pIHsgbWFwLmxpc3Rba2V5W2ldXSA9IHtsaXN0OiB7fX0gfQoJCQkJCW1hcCA9IG1hcC5saXN0W2tleVtpXV07IGlmIChpID09IGtleS5sZW5ndGgtMSkgeyBtYXAuY2IgPSBjYiB9CgkJCQl9CgkJCX0pLCBjYW4ub25rZXltYXAuX2VuZ2luZVtpdGVtXSA9IGVuZ2luZQoJCX0pCgl9LAoJX3BhcnNlOiBmdW5jdGlvbihldmVudCwgY2FuLCBtb2RlLCBsaXN0LCB0YXJnZXQpIHsgbGlzdCA9IGxpc3R8fFtdCgkJaWYgKFsiQ29udHJvbCIsICJTaGlmdCJdLmluZGV4T2YoZXZlbnQua2V5KSA+IC0xKSB7IHJldHVybiBsaXN0IH0KCQlsaXN0LnB1c2goZXZlbnQua2V5KTsgZm9yICh2YXIgcHJlID0gMDsgcHJlIDwgbGlzdC5sZW5ndGg7IHByZSsrKSB7CgkJCWlmICgiMCIgPD0gbGlzdFtwcmVdICYmIGxpc3RbcHJlXSA8PSAiOSIpIHsgY29udGludWUgfSBicmVhawoJCX07IHZhciBjb3VudCA9IHBhcnNlSW50KGxpc3Quc2xpY2UoMCwgcHJlKS5qb2luKCIiKSl8fDEKCgkJdmFyIG1hcCA9IGNhbi5vbmtleW1hcC5fbW9kZVttb2RlXQoJCWZ1bmN0aW9uIHJlcGVhdChjYiwgY291bnQpIHsgbGlzdCA9IFtdOyBmb3IgKHZhciBpID0gMTsgaSA8PSBjb3VudDsgaSsrKSB7IGlmIChjYihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSkgeyBicmVhayB9IH0gfQoJCXZhciBjYiA9IG1hcCAmJiBtYXBbZXZlbnQua2V5XTsgaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgZXZlbnQua2V5Lmxlbmd0aCA+IDEpIHsgcmVwZWF0KGNiLCBjb3VudCk7IHJldHVybiBsaXN0IH0KCQl2YXIgY2IgPSBtYXAgJiYgbWFwW2V2ZW50LmtleS50b0xvd2VyQ2FzZSgpXTsgaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgZXZlbnQua2V5Lmxlbmd0aCA+IDEpIHsgcmVwZWF0KGNiLCBjb3VudCk7IHJldHVybiBsaXN0IH0KCgkJdmFyIG1hcCA9IGNhbi5vbmtleW1hcC5fZW5naW5lW21vZGVdOyBpZiAoIW1hcCkgeyByZXR1cm4gW10gfQoJCWZvciAodmFyIGkgPSBwcmU7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrICkgewoJCQl2YXIgbWFwID0gbWFwLmxpc3RbbGlzdFtpXV07IGlmICghbWFwKSB7IHJldHVybiBbXSB9CgkJCWlmIChpID09IGxpc3QubGVuZ3RoLTEgJiYgY2FuLmJhc2UuaXNGdW5jKG1hcC5jYikpIHsgcmVwZWF0KG1hcC5jYiwgY291bnQpOyByZXR1cm4gW10gfQoJCX0KCQlyZXR1cm4gbGlzdAoJfSwKCV9tb2RlOiB7CgkJaW5zZXJ0OiB7CgkJCWprOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdGFyZ2V0LmJsdXIoKSwgY2FuLm9ua2V5bWFwLmRlbGV0ZVRleHQodGFyZ2V0LCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQtMSwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0KSB9LAoJCQlFc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyB0YXJnZXQuYmx1cigpIH0sCgkJCUVudGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdmFyIGhpcyA9IHRhcmdldC5faGlzdG9yeXx8W10KCQkJCWhpcy5wdXNoKHRhcmdldC52YWx1ZSksIHRhcmdldC5faGlzdG9yeSA9IGhpcywgdGFyZ2V0Ll9jdXJyZW50ID0gaGlzLmxlbmd0aAoJCQkJY2FuLnBhZ2UudGFnaXMoaHRtbC5JTlBVVCwgZXZlbnQudGFyZ2V0KSAmJiBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgkJCX0sCgkJfSwKCQlpbnNlcnRfY3RybDogewoJCQlwOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCXZhciBoaXMgPSB0YXJnZXQuX2hpc3Rvcnl8fFtdLCBwb3MgPSB0YXJnZXQuX2N1cnJlbnR8fDAKCQkJCXBvcyA9IC0tcG9zICUgKGhpcy5sZW5ndGgrMSk7IGlmIChwb3MgPCAwKSB7IHBvcyA9IGhpcy5sZW5ndGggfQoJCQkJdGFyZ2V0Ll9jdXJyZW50ID0gcG9zLCB0YXJnZXQudmFsdWUgPSBoaXNbcG9zXXx8IiIKCQkJfSwKCQkJbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQl2YXIgaGlzID0gdGFyZ2V0Ll9oaXN0b3J5fHxbXSwgcG9zID0gdGFyZ2V0Ll9jdXJyZW50fHwwCgkJCQlwb3MgPSArK3BvcyAlIChoaXMubGVuZ3RoKzEpCgkJCQl0YXJnZXQuX2N1cnJlbnQgPSBwb3MsIHRhcmdldC52YWx1ZSA9IGhpc1twb3NdfHwiIgoJCQl9LAoKCQkJdTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgMCwgdGFyZ2V0LnNlbGVjdGlvbkVuZCkgfSwKCQkJazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0KSB9LAoJCQloOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmRlbGV0ZVRleHQodGFyZ2V0LCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQtMSwgMSkgfSwKCQkJZDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgMCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0KSB9LAoJCQl3OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdmFyIHN0YXJ0ID0gdGFyZ2V0LnNlbGVjdGlvblN0YXJ0LTIsIGVuZCA9IHRhcmdldC5zZWxlY3Rpb25FbmQtMQoJCQkJZm9yICh2YXIgaSA9IHN0YXJ0OyBpID49IDA7IGktLSkgewoJCQkJCWlmICh0YXJnZXQudmFsdWVbZW5kXSA9PSBpY2UuU1AgJiYgdGFyZ2V0LnZhbHVlW2ldICE9IGljZS5TUCkgeyBicmVhayB9CgkJCQkJaWYgKHRhcmdldC52YWx1ZVtlbmRdICE9IGljZS5TUCAmJiB0YXJnZXQudmFsdWVbaV0gPT0gaWNlLlNQKSB7IGJyZWFrIH0KCQkJCX0gY2FuLm9ua2V5bWFwLmRlbGV0ZVRleHQodGFyZ2V0LCBpKzEsIGVuZC1pKQoJCQl9LAoJCX0sCgl9LCBfZW5naW5lOiB7fSwKCglpbnB1dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBpZiAoZXZlbnQubWV0YWtleSkgeyByZXR1cm4gfSB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJdGFyZ2V0Ll9rZXlzID0gY2FuLm9ua2V5bWFwLl9wYXJzZShldmVudCwgY2FuLCBldmVudC5jdHJsS2V5PyAiaW5zZXJ0X2N0cmwiOiBtZGIuSU5TRVJULCB0YXJnZXQuX2tleXMsIHRhcmdldCkKCX0sCglwcmV2ZW50OiBmdW5jdGlvbihldmVudCkgeyBldmVudC5zdG9wUHJvcGFnYXRpb24oKSwgZXZlbnQucHJldmVudERlZmF1bHQoKTsgcmV0dXJuIHRydWUgfSwKCWRlbGV0ZVRleHQ6IGZ1bmN0aW9uKHRhcmdldCwgc3RhcnQsIGNvdW50KSB7IHZhciBlbmQgPSBjb3VudD8gc3RhcnQrY291bnQ6IHRhcmdldC52YWx1ZS5sZW5ndGgKCQl2YXIgY3V0ID0gdGFyZ2V0LnZhbHVlLnNsaWNlKHN0YXJ0LCBlbmQpCgkJdGFyZ2V0LnZhbHVlID0gdGFyZ2V0LnZhbHVlLnN1YnN0cmluZygwLCBzdGFydCkrdGFyZ2V0LnZhbHVlLnN1YnN0cmluZyhlbmQsIHRhcmdldC52YWx1ZS5sZW5ndGgpCgkJcmV0dXJuIHRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShzdGFydCwgc3RhcnQpLCBjdXQKCX0sCglpbnNlcnRUZXh0OiBmdW5jdGlvbih0YXJnZXQsIHRleHQpIHsgdmFyIHN0YXJ0ID0gdGFyZ2V0LnNlbGVjdGlvblN0YXJ0CgkJdmFyIGJlZm9yZSA9IHRhcmdldC52YWx1ZS5zbGljZSgwLCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQpCgkJdmFyIGFmdGVyID0gdGFyZ2V0LnZhbHVlLnNsaWNlKHRhcmdldC5zZWxlY3Rpb25FbmQpCgkJdGFyZ2V0LnZhbHVlID0gYmVmb3JlK3RleHQrYWZ0ZXIKCQlyZXR1cm4gdGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKHN0YXJ0KzEsIHN0YXJ0KzEpCgl9LAoJY3Vyc29yTW92ZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGNvdW50LCBiZWdpbikgeyBiZWdpbiAhPSB1bmRlZmluZWQgJiYgdGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKGJlZ2luLCBiZWdpbikKCQl0YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UodGFyZ2V0LnNlbGVjdGlvblN0YXJ0K2NvdW50LCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQrY291bnQpCgl9LAp9KQpfY2FuX25hbWUgPSAiIgoK",
        "/page/can.css": "Ym9keSwgZmllbGRzZXQsIHRhYmxlLCB0ciwgdGgsIHRkIHsgcGFkZGluZzowOyBib3JkZXI6MDsgbWFyZ2luOjA7IH0KYm9keSB7IGJhY2tncm91bmQtY29sb3I6YmxhY2s7IGNvbG9yOmN5YW47IGZvbnQtc2l6ZToxNHB4OyBmb250LWZhbWlseTpzYW5zLXNlcmlmOyB9CgpsZWdlbmQgeyBiYWNrZ3JvdW5kLWNvbG9yOiMzMzk5OTk7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjBweCAyMHB4OyBtYXJnaW4tdG9wOjRweCA1cHg7IH0Kc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjpibGFjazsgY29sb3I6Y3lhbjsgcGFkZGluZzowIDEwcHg7IGhlaWdodDoxLjkycmVtOyB9CnRleHRhcmVhIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyBoZWlnaHQ6NjBweDsgd2lkdGg6NDAwcHg7IH0KaW5wdXRbdHlwZT1idXR0b25dIHsgYmFja2dyb3VuZC1jb2xvcjpibGFjazsgY29sb3I6Y3lhbjsgfQppbnB1dFtuYW1lPWNtZF0geyBiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyBjb2xvcjp3aGl0ZTsgd2lkdGg6MjQwcHg7IH0KaW5wdXRbdHlwZT10ZXh0XSB7IGJhY2tncm91bmQtY29sb3I6Y3lhbjsgY29sb3I6YmxhY2s7IHBhZGRpbmc6MCA0cHg7IGhlaWdodDoxLjY1cmVtOyB3aWR0aDo4MnB4OyB9CmlucHV0W3R5cGU9cGFzc3dvcmRdIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyBjb2xvcjpibGFjazsgcGFkZGluZzowIDRweDsgaGVpZ2h0OjEuNjVyZW07IHdpZHRoOjgycHg7IH0KaW5wdXRbbmFtZT13aGVyZV0geyB3aWR0aDozMjBweDsgfQppbnB1dFtuYW1lPWRhdGVdIHsgd2lkdGg6MTUwcHg7IH0KaW5wdXRbbmFtZT1wYXRoXSB7IHdpZHRoOjE2MHB4OyB9CmlucHV0W25hbWU9bGluZV0geyB3aWR0aDo0MHB4OyB9CmlucHV0W25hbWU9bGltaXRdIHsgd2lkdGg6NTBweDsgfQppbnB1dFtuYW1lPW9mZmVuZF0geyB3aWR0aDo1MHB4OyB9CmlucHV0W25hbWU9dGV4dF0geyB3aWR0aDoxNjBweDsgfQppbnB1dFtuYW1lPXVybF0geyB3aWR0aDozMjBweDsgfQoKZmllbGRzZXQucGx1Z2luLmNvbmZpZyBmb3JtLm9wdGlvbiBpbnB1dFtuYW1lPWtleV0geyB3aWR0aDoyNDBweDsgfQp0YWJsZS5sYXlvdXQgeyBib3JkZXItc3BhY2luZzowOyB9CnRhYmxlLmxheW91dCB0ZCB7IHZlcnRpY2FsLWFsaWduOnRvcDsgfQp0YWJsZS5sYXlvdXQgdGQuY29udGVudCB7IHBvc2l0aW9uOnJlbGF0aXZlOyB9CnRhYmxlLmxheW91dCBkaXYudG9nZ2xlIHsgZm9udC1zaXplOjI0cHg7IGJhY2tncm91bmQtY29sb3I6I2UxYWVhZTQ1OyBwb3NpdGlvbjphYnNvbHV0ZTsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZT5kaXYgeyBjb2xvcjp3aGl0ZTsgZGlzcGxheTp0YWJsZS1jZWxsOyB9CnRhYmxlLmxheW91dCBkaXYudG9nZ2xlLnByb2plY3QgeyBwYWRkaW5nLXRvcDogNTBweDsgaGVpZ2h0OjEwMHB4OyB3aWR0aDoxNXB4OyB0b3A6MjAlOyBsZWZ0OjBweDsgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6MTBweDsgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6MTBweDsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZS5wcm9maWxlIHsgcGFkZGluZy10b3A6IDUwcHg7IGhlaWdodDoxMDBweDsgd2lkdGg6MTVweDsgdG9wOjIwJTsgcmlnaHQ6MHB4OyBib3JkZXItdG9wLWxlZnQtcmFkaXVzOjEwcHg7IGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MTBweDsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZS5kaXNwbGF5IHsgb3ZlcmZsb3c6aGlkZGVuOyBtYXJnaW4tdG9wOi0xN3B4OyBoZWlnaHQ6MTVweDsgd2lkdGg6MTAwcHg7IHBvc2l0aW9uOnN0aWNreTsgbGVmdDo0MCU7IGJvcmRlci10b3AtbGVmdC1yYWRpdXM6MTBweDsgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6MTBweDsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZS5kaXNwbGF5PmRpdiB7IGNvbG9yOndoaXRlOyB0ZXh0LWFsaWduOmNlbnRlcjsgaGVpZ2h0OjE1cHg7IHdpZHRoOjEwMHB4OyB9CmZpZWxkc2V0LkFjdGlvbi5jbWQ+ZGl2LnRvZ2dsZS5wcm9qZWN0IHsgZGlzcGxheTpub25lOyB9Cgp0YWJsZS5jb250ZW50IHRyIHsgYmFja2dyb3VuZC1jb2xvcjojMDQyNzJmNDU7IH0KdGFibGUuY29udGVudCB0ci5zaG93IHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IH0KdGFibGUuY29udGVudCB0aCB7IGJhY2tncm91bmQtY29sb3I6IzBmYmQ0NTsgcGFkZGluZzoycHggNnB4OyB9CnRhYmxlLmNvbnRlbnQgdGQgeyBwYWRkaW5nOjJweCA2cHg7IH0KdGFibGUuY29udGVudC5hY3Rpb24gdGQ6bGFzdC1jaGlsZCwgdGFibGUuY29udGVudC5hY3Rpb24gdGg6bGFzdC1jaGlsZCB7IGJhY2tncm91bmQtY29sb3I6IzdkYzZkN2ViOyBwb3NpdGlvbjpzdGlja3k7IHJpZ2h0OjA7IH0KdGFibGUuY29udGVudCB0aGVhZCB7IHBvc2l0aW9uOnN0aWNreTsgdG9wOi0xcHg7IH0KCnRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPWNyZWF0ZV0geyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IH0KdGQ+aW5wdXRbdHlwZT1idXR0b25dW25hbWU9cmVtb3ZlXSB7IGJhY2tncm91bmQtY29sb3I6cmVkOyB9CnRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPXN0YXJ0XSB7IGJhY2tncm91bmQtY29sb3I6IzUyY2U3ODsgfQp0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1vcGVuXSB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgfQp0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1zdG9wXSB7IGJhY2tncm91bmQtY29sb3I6cmVkOyB9CnRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPWRlbGV0ZV0geyBiYWNrZ3JvdW5kLWNvbG9yOnJlZDsgfQp0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1pbnNlcnRdIHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyB9CgpkaXYudGFicyB7IGJhY2tncm91bmQtY29sb3I6IzAwMDAwMDM4OyBjb2xvcjp3aGl0ZTsgcGFkZGluZzo1cHg7IG1hcmdpbjowIDFweDsgfQpkaXYuY29kZSB7IGJhY2tncm91bmQtY29sb3I6IzM0M2EzNDQ1OyBjb2xvcjp3aGl0ZTsgcGFkZGluZzoxMHB4OyBib3JkZXI6c29saWQgM3B4IGdyZWVuOyB9CmRpdi5zdG9yeVtkYXRhLXR5cGU9c3BhcmtdIHsgYmFja2dyb3VuZC1jb2xvcjojMjE2OWE5YTY7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjRweCAxMHB4OyBib3JkZXItbGVmdDpzb2xpZCA0cHggYmx1ZTsgbWFyZ2luOjEwcHg7IH0KZmllbGRzZXQucGFuZWwuU2VhcmNoIGRpdi5zdG9yeVtkYXRhLXR5cGU9c3BhcmtdIHsgcGFkZGluZzowcHg7IG1hcmdpbjowcHg7IH0KCmJvZHkubW9iaWxlIGZvcm0ub3B0aW9uPmRpdi5pdGVtIHsgbWFyZ2luLXJpZ2h0OjBweDsgfQpmb3JtLm9wdGlvbj5kaXYuaXRlbSB7IG1hcmdpbi1yaWdodDowcHg7IG1hcmdpbi1yaWdodDo1cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0uc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjojMDAwMDsgfQpmb3JtLm9wdGlvbj5kaXYuaXRlbSBpbnB1dC5hcmdzLmNoYXIgeyB3aWR0aDoyMHB4OyB9CmZvcm0ub3B0aW9uPmRpdi5pdGVtIGlucHV0LmFyZ3MudGlueSB7IHdpZHRoOjQwcHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJncy5sb25nIHsgd2lkdGg6MjQwcHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJncy5mdWxsIHsgd2lkdGg6NDgwcHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPUlEXSB7IHdpZHRoOjQ4cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPWlkXSB7IHdpZHRoOjQ4cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPWxpbWl0XSB7IHdpZHRoOjQ4cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPW9mZnNldF0geyB3aWR0aDo0OHB4OyB9CmZvcm0ub3B0aW9uPmRpdi5pdGVtIGlucHV0LmFyZ3NbbmFtZT1vZmZlbmRdIHsgd2lkdGg6NDhweDsgfQpmb3JtLm9wdGlvbj5kaXYuaXRlbS50ZXh0YXJlYSB7IG1hcmdpbi10b3A6NHB4OyB9CgpkaXYuYWN0aW9uPmRpdi5pdGVtIHsgbWFyZ2luLXJpZ2h0OjNweDsgfQpkaXYuYWN0aW9uPmRpdi5pdGVtLnNlbGVjdCB7IGJhY2tncm91bmQ6bm9uZTsgfQpkaXYuYWN0aW9uPmRpdi5pdGVtLnNwYWNlIHsgd2lkdGg6MTBweDsgfQpkaXYub3V0cHV0IHsgcG9zaXRpb246cmVsYXRpdmU7IH0KZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IHsgYmFja2dyb3VuZC1jb2xvcjojNDM1ZjhjOGM7IH0KZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IGRpdi5wcm9qZWN0IHsgbWluLXdpZHRoOjg4cHg7IG1heC13aWR0aDozNjBweDsgfQpkaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2Lml0ZW0geyBwYWRkaW5nOjJweCAxMHB4OyB9CmRpdi5vdXRwdXQgdGQucHJvamVjdCBkaXYucHJvamVjdCBkaXYubGlzdCB7IG1hcmdpbi1sZWZ0OjEwcHg7IH0KZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IGRpdi5wcm9qZWN0IGRpdi5zd2l0Y2ggeyBjb2xvcjojMGQxYmMyOyB3aWR0aDoxMnB4OyBmbG9hdDpsZWZ0OyB0cmFuc2Zvcm06IHJvdGF0ZSg5MGRlZykgdHJhbnNsYXRlKDJweCwgMHB4KTsgfQpkaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2LnN3aXRjaC5vcGVuIHsgdHJhbnNmb3JtOiByb3RhdGUoMTgwZGVnKSB0cmFuc2xhdGUoLTRweCwgMXB4KTsgfQpkaXYub3V0cHV0IHRkLnByb2ZpbGUgeyBiYWNrZ3JvdW5kLWNvbG9yOiM3MTkwOWM5MTsgfQpkaXYuc3RhdHVzPmRpdi5pdGVtIHsgcGFkZGluZzo0cHg7IGhlaWdodDoxOHB4OyB9CgpmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4geyBiYWNrZ3JvdW5kLWNvbG9yOiMwNjFjM2M5ZTsgcGFkZGluZzoxMHB4OyBtYXJnaW46MTBweDsgfQpmaWVsZHNldC5wbHVnaW4gZGl2LnN0YXR1cyB7IGJvcmRlci10b3A6MXB4IHNvbGlkIGRhcmtjeWFuOyB9CmZpZWxkc2V0LnN0b3J5IGRpdi5zdGF0dXMgeyBib3JkZXItdG9wOjFweCBzb2xpZCBkYXJrY3lhbjsgfQovKiBmaWVsZHNldC5zdG9yeT5sZWdlbmQgeyBoZWlnaHQ6MzBweDsgbWFyZ2luLXJpZ2h0OjVweDsgZmxvYXQ6bGVmdDsgfSAqLwpmaWVsZHNldC5zdG9yeT5sZWdlbmQgeyBwYWRkaW5nOjAgMjBweDsgbWFyZ2luOjVweCAwOyB9CmZpZWxkc2V0LmZsb2F0IHsgYmFja2dyb3VuZC1jb2xvcjojMDIzNTMxY2Y7IH0KLyogZmllbGRzZXQuZmxvYXQ+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6YmxvY2s7IGhlaWdodDoyLjNyZW07IH0gKi8KZmllbGRzZXQuZmxvYXQgdGFibGUgeyBjb2xvcjp3aGl0ZTsgfQoKZmllbGRzZXQub3V0cHV0PmZvcm0ub3B0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0Lm91dHB1dD5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0Lm91dHB1dCBkaXYuc3RhdHVzIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0Lm91dHB1dCBkaXYudG9nZ2xlIHsgZGlzcGxheTpub25lOyB9CgpmaWVsZHNldC5pbnB1dCB7IGJhY2tncm91bmQtY29sb3I6IzBkNDE0MmE2OyB0b3A6MzJweDsgfQpmaWVsZHNldC5pbnB1dC5rZXkuZmxvYXQgZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbnB1dCBkaXYub3V0cHV0IHsgbWF4LWhlaWdodDo0MDBweDsgfQpmaWVsZHNldC5pbnB1dCB0YWJsZSB7IGNvbG9yOndoaXRlOyB9CmZpZWxkc2V0LmlucHV0IHRkIHsgd29yZC1icmVhazprZWVwLWFsbDsgfQoKYm9keT5kaXYudG9hc3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwZTMzNjliMzsgY29sb3I6eWVsbG93OyBwYWRkaW5nOjVweDsgfQpib2R5PmRpdi50b2FzdCBkaXYudGl0bGUgeyBjb2xvcjojY2FlODUwOyB3b3JkLWJyZWFrOmJyZWFrLWFsbDsgZmxvYXQ6bGVmdDsgfQpib2R5PmRpdi50b2FzdCBkaXYuZHVyYXRpb24geyBjb2xvcjpncmF5OyBmbG9hdDpyaWdodDsgfQpib2R5PmRpdi50b2FzdCBkaXYuY29udGVudCB7IHRleHQtYWxpZ246Y2VudGVyOyB9CmJvZHk+ZGl2LnRvYXN0IGRpdi5wcm9ncmVzcyB7IGJvcmRlcjpzb2xpZCAycHggZ3JlZW47IG1hcmdpbi1sZWZ0Oi0ycHg7IGhlaWdodDoxMHB4OyBjbGVhcjpib3RoOyB9CmJvZHk+ZGl2LnRvYXN0IGRpdi5wcm9ncmVzcyBkaXYuY3VycmVudCB7IGJhY2tncm91bmQtY29sb3I6cmVkOyBoZWlnaHQ6MTBweDsgfQoKYm9keT5kaXYuY2FydGUgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyOTViNjE7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjRweDsgbWluLXdpZHRoOjgwcHg7IH0KYm9keT5kaXYuY2FydGUgZGl2Lml0ZW0geyBwYWRkaW5nOjNweCAxMnB4OyB9CmJvZHk+ZGl2LmlucHV0IHsgYmFja2dyb3VuZC1jb2xvcjojMGQ0MTQyYTY7IHBhZGRpbmc6NXB4OyB9CmJvZHk+ZGl2LmlucHV0IGRpdi5pdGVtIHsgZmxvYXQ6bGVmdDsgfQpib2R5PmRpdi5pbnB1dCB0ciB0ZDpmaXJzdC1jaGlsZCB7IHRleHQtYWxpZ246Y2VudGVyOyB9CmJvZHk+ZGl2LmlucHV0IGRpdi5jb250ZW50IHsgb3ZlcmZsb3c6YXV0bzsgbWF4LWhlaWdodDoyMDBweDsgfQpib2R5PmRpdi5pbnB1dCBzZWxlY3QgeyB3aWR0aDoxODNweDsgbWFyZ2luOjVweDsgfQpib2R5PmRpdi5pbnB1dCBpbnB1dFt0eXBlPXRleHRdIHsgd2lkdGg6MTcxcHg7IG1hcmdpbjo1cHg7IH0KYm9keT5kaXYuaW5wdXQgaW5wdXRbbmFtZT11c2VybmFtZV0geyB3aWR0aDoxNzFweDsgbWFyZ2luOjVweDsgfQpib2R5PmRpdi5pbnB1dCBpbnB1dFtuYW1lPXBhc3N3b3JkXSB7IHdpZHRoOjE3MXB4OyBtYXJnaW46NXB4OyB9CmJvZHk+ZGl2LmlucHV0IHRleHRhcmVhIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyBwYWRkaW5nOjRweDsgbWFyZ2luOjVweDsgYm9yZGVyOjJweCBpbnNldCAjMTRhNThlOyBoZWlnaHQ6MTIwcHg7IHdpZHRoOjE3MXB4OyB9CmJvZHk+ZGl2LmlucHV0LmxvZ2luIHsgcGFkZGluZzoxMHB4OyB9Cgpib2R5PmRpdi51cGxvYWQgeyBiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyBjb2xvcjp5ZWxsb3c7IHBhZGRpbmc6NXB4OyB9CmJvZHk+ZGl2LnVwbG9hZCBkaXYuaXRlbSB7IGZsb2F0OmxlZnQ7IH0KYm9keT5kaXYudXBsb2FkIGRpdi5vdXRwdXQgeyBib3JkZXI6c29saWQgMXB4IHJlZDsgfQpib2R5PmRpdi51cGxvYWQgZGl2LnByb2dyZXNzIHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IGhlaWdodDoxMHB4OyB3aWR0aDowOyB9CmJvZHk+ZGl2LnVwbG9hZCBkaXYuc3RhdHVzIGRpdi5jb3N0IHsgZmxvYXQ6bGVmdDsgfQpib2R5PmRpdi51cGxvYWQgZGl2LnN0YXR1cyBkaXYuc2hvdyB7IGZsb2F0OnJpZ2h0OyB9CmJvZHk+ZGl2LnVwbG9hZCBkaXYuc3RhdHVzIGRpdi5zaXplIHsgdGV4dC1hbGlnbjpjZW50ZXI7IH0KYm9keT5kaXYudXBsb2FkIGlucHV0W3R5cGU9ZmlsZV0geyB3aWR0aDoyNDBweDsgfQoKYm9keS53aGl0ZSB7IGJhY2tncm91bmQtY29sb3I6cmdiYSg1LDM0LDU2LDAuNzUpOyBjb2xvcjp3aGl0ZTsgfQpib2R5LndoaXRlIGZpZWxkc2V0LkFjdGlvbiB7IGNvbG9yOmJsYWNrOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uPmRpdi5hY3Rpb24geyBjb2xvcjp3aGl0ZTsgfQpib2R5LndoaXRlIGZpZWxkc2V0LkFjdGlvbiBmaWVsZHNldC5wbHVnaW4geyBiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY3ODsgfQpib2R5LndoaXRlIGZpZWxkc2V0LkFjdGlvbiBmaWVsZHNldC5wbHVnaW4uZnVsbCB7IGJhY2tncm91bmQtY29sb3I6I2ZmZmZmZmZmOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uIGZpZWxkc2V0LnBsdWdpbi5GdWxsIHsgYmFja2dyb3VuZC1jb2xvcjojY2NlMGY0ZWI7IGNvbG9yOndoaXRlOyB6LWluZGV4OjEwOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uIGZpZWxkc2V0LnN0b3J5LkZ1bGwgeyBiYWNrZ3JvdW5kLWNvbG9yOiNjY2UwZjRlYjsgY29sb3I6d2hpdGU7IHotaW5kZXg6MTA7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5BY3Rpb24gZmllbGRzZXQucGx1Z2luLkZ1bGwgdGFibGUuY29udGVudCB7IGNvbG9yOndoaXRlOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uIGZpZWxkc2V0LnN0b3J5LkZ1bGwgdGFibGUuY29udGVudCB7IGNvbG9yOndoaXRlOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuU2VhcmNoIHRhYmxlIHsgY29sb3I6d2hpdGU7IH0KYm9keS53aGl0ZSBmaWVsZHNldC53b3JkLmZsb2F0IHsgYmFja2dyb3VuZC1jb2xvcjojM2Q1NTY5OyBjb2xvcjpibGFjazsgfQoKYm9keS53aGl0ZSBsZWdlbmQgeyBib3JkZXItcmFkaXVzOjEwcHggMTBweCAxMHB4IDEwcHg7IH0KYm9keS53aGl0ZSBzZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiM5OUNDNjY7IGNvbG9yOndoaXRlOyBib3JkZXI6MnB4IHNvbGlkICM5OUNDNjY7IGJvcmRlci1yYWRpdXM6MTBweCAxMHB4IDEwcHggMTBweDsgfQpib2R5LndoaXRlIGlucHV0W3R5cGU9YnV0dG9uXSB7IGJhY2tncm91bmQtY29sb3I6I0ZGOTkwMDsgY29sb3I6d2hpdGU7IGJvcmRlcjoycHggc29saWQgI0ZGOTkwMDsgYm9yZGVyLXJhZGl1czoxMHB4OyB9CmJvZHkud2hpdGUgaW5wdXRbdHlwZT10ZXh0XSB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOmJsYWNrOyBib3JkZXI6MnB4IHNvbGlkICMxNGE1OGU7IGJvcmRlci1yYWRpdXM6NnB4OyB9CmJvZHkud2hpdGUgaW5wdXRbdHlwZT1wYXNzd29yZF0geyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsgYm9yZGVyOjJweCBzb2xpZCAjMTRhNThlOyBib3JkZXItcmFkaXVzOjZweDsgfQpib2R5LndoaXRlIGlucHV0W25hbWU9Y21kXSB7IGJhY2tncm91bmQtY29sb3I6YmxhY2s7IGNvbG9yOndoaXRlOyB3aWR0aDoyNDBweDsgfQoKYm9keS53aGl0ZSB0YWJsZS5jb250ZW50IHsgY29sb3I6YmxhY2s7IH0KYm9keS53aGl0ZSB0YWJsZS5jb250ZW50IHRyIHsgYmFja2dyb3VuZC1jb2xvcjojZTFmMWZmMWY7IH0KYm9keS53aGl0ZSB0YWJsZS5jb250ZW50IHRoIHsgYmFja2dyb3VuZC1jb2xvcjojOTlDQ0ZGOyB9Cgpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPee7k+adn10geyBiYWNrZ3JvdW5kLWNvbG9yOnJlZDsgfQpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPXN0b3BdIHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IH0KYm9keS53aGl0ZSB0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1vcGVuXSB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgfQpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPXN0YXJ0XSB7IGJhY2tncm91bmQtY29sb3I6IzUyY2U3ODsgfQpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPWNyZWF0ZV0geyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IH0KYm9keS53aGl0ZSB0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1yZW1vdmVdIHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IH0KYm9keS53aGl0ZSB0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1pbnNlcnRdIHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyB9CmJvZHkud2hpdGUgdGQ+aW5wdXRbdHlwZT1idXR0b25dW25hbWU9ZGVsZXRlXSB7IGJhY2tncm91bmQtY29sb3I6cmVkOyB9Cgpib2R5LnByaW50IHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IH0KYm9keS5wcmludCBsZWdlbmQsIGJvZHkucHJpbnQgc2VsZWN0LCBib2R5LnByaW50IGlucHV0W3R5cGU9dGV4dF0geyBib3gtc2hhZG93OjBweCAwcHggMHB4IDBweCAjNjI2YmQwOyB9CmJvZHkucHJpbnQgZmllbGRzZXQuSGVhZGVyLCBib2R5LnByaW50IGZpZWxkc2V0LlJpdmVyLCBib2R5LnByaW50IGZpZWxkc2V0LkFjdGlvbiwgYm9keS5wcmludCBmaWVsZHNldC5Gb290ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsgfQpib2R5LnByaW50IGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lml0ZW0uc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgYm9yZGVyOnNvbGlkIDJweCByZWQ7IH0KYm9keS5wcmludCBmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IGRpdi5pdGVtIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgfQoKYm9keS5tb2JpbGU+ZGl2LmlucHV0IGlucHV0W25hbWU9dXNlcm5hbWVdIHsgd2lkdGg6MjY0cHg7IH0KYm9keS5tb2JpbGU+ZGl2LmlucHV0IGlucHV0W25hbWU9cGFzc3dvcmRdIHsgd2lkdGg6MjY0cHg7IH0KYm9keS5tb2JpbGUgbGVnZW5kIHsgZm9udC1zaXplOjEuNnJlbTsgfQpib2R5Lm1vYmlsZSBpbnB1dCB7IGZvbnQtc2l6ZToxLjRyZW07IH0KYm9keS5tb2JpbGUgdGV4dGFyZWEgeyBmb250LXNpemU6MS4ycmVtOyB9CmJvZHkubW9iaWxlIGlucHV0W3R5cGU9dGV4dF0geyBwYWRkaW5nLXRvcDozcHg7IGhlaWdodDoyLjQ3cmVtOyB9CmJvZHkubW9iaWxlLndoaXRlIGlucHV0W3R5cGU9dGV4dF0geyBwYWRkaW5nLXRvcDozcHg7IGhlaWdodDoyLjM1cmVtOyB9CmJvZHkubW9iaWxlIHNlbGVjdCB7IGZvbnQtc2l6ZToxLjRyZW07IG1hcmdpbi10b3A6M3B4OyBoZWlnaHQ6NDJweDsgfQpib2R5Lm1vYmlsZT5kaXYuY2FydGUgeyBmb250LXNpemU6MS42cmVtOyB9CmJvZHkubW9iaWxlPmRpdi5jYXJ0ZSBkaXYuaXRlbSB7IGZvbnQtc2l6ZToxLjZyZW07IH0KYm9keS5tb2JpbGU+ZGl2LmlucHV0LmxvZ2luIGlucHV0IHsgZm9udC1zaXplOjEuNHJlbTsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5IZWFkZXIuaGVhZCB7IHdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyLmhlYWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMDAwMDBiODsgZm9udC1zaXplOjEuNnJlbTsgaGVpZ2h0OjNyZW07IHBvc2l0aW9uOmZpeGVkOyB0b3A6MDsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5IZWFkZXIuaGVhZCBkaXYub3V0cHV0IHsgaGVpZ2h0OjNyZW07IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyLmhlYWQ+ZGl2Lm91dHB1dCBkaXYubWVudSB7IGhlaWdodDoyLjZyZW07IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyLmhlYWQgZGl2LnN0YXRlLnRpbWUgeyBkaXNwbGF5Om5vbmU7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaD5pbnB1dCB7IGhlaWdodDozOHB4OyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZSBmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dD5kaXYuc2VhcmNoPmlucHV0IHsgd2lkdGg6MjQwcHg7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuUml2ZXIubGVmdCB7IGJhY2tncm91bmQtY29sb3I6IzI0Mzk1MGJmOyBmb250LXNpemU6MnJlbTsgbWluLXdpZHRoOjI0MHB4OyBwb3NpdGlvbjpmaXhlZDsgdG9wOjNyZW07IHotaW5kZXg6MTA7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCB7IHdpZHRoOjMyMHB4OyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lml0ZW0geyBmb250LXNpemU6MS42cmVtOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LkFjdGlvbi5tYWluIHsgbWFyZ2luLXRvcDozcmVtOyBtYXJnaW4tYm90dG9tOjNyZW07IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuQWN0aW9uLm1haW4uY21kIHsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuRm9vdGVyLmZvb3QgeyB3aWR0aDotd2Via2l0LWZpbGwtYXZhaWxhYmxlOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LkZvb3Rlci5mb290IHsgYmFja2dyb3VuZC1jb2xvcjojMDAwMDAwYjg7IGZvbnQtc2l6ZToxLjZyZW07IGhlaWdodDozcmVtOyBwb3NpdGlvbjpmaXhlZDsgYm90dG9tOjA7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuRm9vdGVyLmZvb3QgZGl2Lm91dHB1dCB7IGhlaWdodDozcmVtOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LkZvb3Rlci5mb290PmRpdi5vdXRwdXQgZGl2IHsgaGVpZ2h0OjIuNnJlbTsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5Gb290ZXI+ZGl2Lm91dHB1dCBpbnB1dFtuYW1lPWNtZF0geyBoZWlnaHQ6MzhweDsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgaW5wdXRbbmFtZT1jbWRdIHsgd2lkdGg6MjQwcHg7IH0KYm9keS5tb2JpbGUubGFuZHNjYXBlIGZpZWxkc2V0LkhlYWRlci5oZWFkIHsgcG9zaXRpb246dW5zZXQ7IH0KYm9keS5tb2JpbGUubGFuZHNjYXBlIGZpZWxkc2V0LkhlYWRlci5oZWFkIGRpdi5zdGF0ZS50aW1lIHsgZGlzcGxheTpibG9jazsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuQWN0aW9uLm1haW4geyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuRm9vdGVyLmZvb3QgeyBwb3NpdGlvbjp1bnNldDsgfQoKYm9keS5tb2JpbGUgZmllbGRzZXQuZHJhdy5zcGlkZSBkaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LmRyYXcudHJlbmQgZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuZHJhdy5zcGlkZSBkaXYuYWN0aW9uIHsgZGlzcGxheTpibG9jazsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuZHJhdy50cmVuZCBkaXYuYWN0aW9uIHsgZGlzcGxheTpibG9jazsgfQoKLyogZm9udCAqLwoqIHsgdGFiLXNpemU6NDsgfQp0ZXh0YXJlYSB7IHRhYi1zaXplOjI7IH0KbGVnZW5kIHsgZm9udC1zaXplOjEuMnJlbTsgfQpzZWxlY3QsIGlucHV0IHsgZm9udC1zaXplOjEuMXJlbTsgfQp0YWJsZS5jb250ZW50IHRoLCB0YWJsZS5jb250ZW50IHRkLCBkaXYuaXRlbSwgZGl2LnRhYnMsIGRpdi5jb2RlLCBjb2RlLnN0b3J5LCBkaXYuc3RvcnlbZGF0YS10eXBlPXNwYXJrXSB7IGZvbnQtc2l6ZToxLjFyZW07IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgfQpkaXYuc3RhdHVzPmRpdi5pdGVtPmxhYmVsIHsgZm9udC1zaXplOjAuNnJlbTsgZm9udC1mYW1pbHk6bW9ub3NwYWNlOyB9CnN2ZyB7IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgfQoKLyogZGlzcGxheSAqLwpmb3JtLm9wdGlvbiwgZGl2LmFjdGlvbiB7IGRpc3BsYXk6Y29udGVudHM7IH0KLmhpZGUsIC5oaWRkZW4sIGZvcm0ub3B0aW9uPmRpdi5pdGVtPmxhYmVsLCBkaXYuYWN0aW9uPmRpdi5pdGVtPmxhYmVsLCBmaWVsZHNldC5wYW5lbD5sZWdlbmQsIGZpZWxkc2V0Lm91dHB1dD5sZWdlbmQsIGZpZWxkc2V0LmlucHV0PmxlZ2VuZCB7IGRpc3BsYXk6bm9uZTsgfQpkaXYub3V0cHV0LCBkaXYuc3RhdHVzLCBkaXYuY29udGVudCwgZGl2LnByb2plY3QgZGl2Lml0ZW0sIGRpdi5pdGVtLnRleHRhcmVhLCBkaXYuY29kZSwgZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya10sIHAuc3RvcnksIGgxLCBoMiwgaDMgeyBjbGVhcjpib3RoOyB9CmZvcm0ub3B0aW9uLCBmb3JtLm9wdGlvbj5kaXYuaXRlbSwgZGl2LmFjdGlvbiwgZGl2LmFjdGlvbj5kaXYuaXRlbSwgZGl2LmFjdGlvbj5kaXYudGFicywgZGl2LnByb2plY3QsIGRpdi5zdGF0dXM+ZGl2Lml0ZW0sIGZpZWxkc2V0LmZsb2F0PmxlZ2VuZCB7IGZsb2F0OmxlZnQ7IH0KZGl2LmNvZGUsIGRpdi5zdG9yeSwgZGl2LmFjdGlvbiwgZGl2Lm91dHB1dCwgZGl2LnN0YXR1cywgZGl2LnByb2plY3QsIGRpdi5jb250ZW50LCBkaXYucHJvZmlsZSwgZGl2LmRpc3BsYXksIHRhYmxlLmNvbnRlbnQsIHRhYmxlLmNvbnRlbnQgdGQsIGJvZHk+ZGl2LnRvYXN0IHsgb3ZlcmZsb3c6YXV0bzsgfQpkaXYuY29kZSwgZGl2LnN0b3J5LCBkaXYuaXRlbSwgZGl2LmNvbnRlbnQsIHRhYmxlLmNvbnRlbnQsIHRleHRhcmVhIHsgd2hpdGUtc3BhY2U6cHJlOyB9CmRpdi5jb2RlLCBkaXYuc3RvcnksIGRpdi5pdGVtIHsgdGV4dC1hbGlnbjpsZWZ0OyB9CgovKiBwb3NpdGlvbiBjdXJzb3IgKi8KZmllbGRzZXQuZmxvYXQsIGZpZWxkc2V0LmlucHV0LCBib2R5PmRpdi50b2FzdCwgYm9keT5kaXYuY2FydGUsIGJvZHk+ZGl2LmlucHV0LCBib2R5PmRpdi51cGxvYWQgeyBwb3NpdGlvbjpmaXhlZDsgei1pbmRleDoxMDsgfQpsZWdlbmQsIHNlbGVjdCwgaW5wdXRbdHlwZT1idXR0b25dLCBkaXYuaXRlbSwgZGl2LnRhYnMsIHRoLCB0ZCwgaDEsIGgyLCBoMyB7IGN1cnNvcjpwb2ludGVyOyB9CmRpdi50aXRsZSwgZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya10geyBjdXJzb3I6Y29weTsgfQoKLyogYm94LXNoYWRvdyAqLwpmaWVsZHNldC5wbHVnaW4geyBib3gtc2hhZG93OjJweCAycHggMTBweCA0cHggIzYyNmJkMDsgfQpmaWVsZHNldC5wbHVnaW46aG92ZXIgeyBib3gtc2hhZG93OjRweCA0cHggMTJweCA2cHggIzYyNmJkMDsgfQpmaWVsZHNldC5zdG9yeSB7IGNsZWFyOmJvdGg7IGZsb2F0OmxlZnQ7IGJveC1zaGFkb3c6NHB4IDRweCAxMHB4IDFweCAjNjI2YmQwOyB9CmZpZWxkc2V0LnN0b3J5OmhvdmVyIHsgYm94LXNoYWRvdzoxMnB4IDEycHggMTJweCA2cHggIzU3NjRlZmQxOyB9CmRpdi5zdG9yeVtkYXRhLXR5cGU9c3BhcmtdIHsgYm94LXNoYWRvdzo0cHggNHB4IDEwcHggMXB4ICM2MjZiZDA7IH0KZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya10gc3Bhbjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ZGVlcHNreWJsdWU7IGJveC1zaGFkb3c6NHB4IDRweCAyMHB4IDRweCAjMjkzMThlOyB9CmxlZ2VuZCwgc2VsZWN0LCB0ZXh0YXJlYSwgaW5wdXRbdHlwZT10ZXh0XSwgZGl2LmNvZGUgeyBib3gtc2hhZG93OjRweCA0cHggMjBweCA0cHggIzYyNmJkMDsgfQoKLyogaG92ZXIgKi8KLnNlbGVjdCwgZGl2Lml0ZW0uc2VsZWN0LCBkaXYuaXRlbTpob3ZlciwgdGFibGUuY29udGVudCB0aDpob3ZlciwgdGFibGUuY29udGVudCB0ZC5zZWxlY3QsIHRhYmxlLmNvbnRlbnQgdGQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOmNvcm5mbG93ZXJibHVlOyB9CmRpdi50YWJzLnNlbGVjdCwgZGl2LnRhYnM6aG92ZXIsIHRhYmxlLmNvbnRlbnQgdHIuc2VsZWN0LCB0YWJsZS5jb250ZW50IHRyOmhvdmVyLCBoMTpob3ZlciwgaDI6aG92ZXIsIGgzOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpzdGVlbGJsdWU7IH0KCmlucHV0W3R5cGU9dGV4dF06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyB9CmlucHV0W25hbWU9Y21kXTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOmJsYWNrOyB9CmlucHV0W3R5cGU9YnV0dG9uXTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6Z3JheTsgY29sb3I6Y3lhbjsgfQoKYm9keS53aGl0ZSBsZWdlbmQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOnNreWJsdWU7IH0KYm9keS53aGl0ZSBpbnB1dFt0eXBlPXRleHRdOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyB9CmJvZHkud2hpdGUgaW5wdXRbbmFtZT1jbWRdOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IH0KYm9keS53aGl0ZSBpbnB1dFt0eXBlPWJ1dHRvbl06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiNGRkNDMzM7IGJvcmRlcjoycHggc29saWQgI0ZGQ0MzMzsgfQpib2R5LndoaXRlIHRhYmxlLmNvbnRlbnQgdGg6aG92ZXIsIGJvZHkud2hpdGUgdGFibGUuY29udGVudCB0ZC5zZWxlY3QsIGJvZHkud2hpdGUgdGFibGUuY29udGVudCB0ZDpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzY0OTVlZDYzOyB9CmJvZHkud2hpdGUgdGFibGUuY29udGVudCB0cjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzQ2ODJiNDZiOyB9CmJvZHkud2hpdGUgZGl2Lml0ZW0uc2VsZWN0LCBib2R5LndoaXRlIGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpzdGVlbGJsdWU7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5mbG9hdCB0YWJsZSB7IGNvbG9yOndoaXRlOyB9Cgpib2R5Lm1vYmlsZSBkaXYub3V0cHV0IGRpdi5jb2RlIHsgZm9udC1zaXplOjEycHg7IH0KYm9keS5tb2JpbGUgZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtIHsgaGVpZ2h0OjE2MHB4OyBmbG9hdDpub25lOyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW0geyB3aWR0aDphdXRvOyBmbG9hdDpsZWZ0OyB9CmRpdi5vdXRwdXQuY2FyZCBkaXYuaXRlbSB7IHBhZGRpbmc6MTBweDsgYm9yZGVyOnNvbGlkIDFweCAjZTdlN2U3OyBtYXJnaW46MTBweDsgaGVpZ2h0OjEyMHB4OyB3aWR0aDoyNDBweDsgZmxvYXQ6bGVmdDsgcG9zaXRpb246cmVsYXRpdmU7IH0KZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtPmRpdi50aXRsZSB7IGZvbnQtc2l6ZToxLjJyZW07IGZvbnQtd2VpZ2h0OmJvbGQ7IHBhZGRpbmc6MTBweDsgYm9yZGVyLWJvdHRvbTogc29saWQgMXB4ICNlN2U3ZTc7IH0KZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtPmRpdi5jb250ZW50IHsgcGFkZGluZzoxMHB4OyBoZWlnaHQ6MjRweDsgfQoKYm9keS5zaW1wbGUgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkhlYWRlciB7IGJvcmRlci1ib3R0b206c29saWQgMXB4ICNlN2U3ZTc7IGhlaWdodDo2MHB4OyBkaXNwbGF5OmJsb2NrOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LlJpdmVyIHsgYm9yZGVyLXJpZ2h0OnNvbGlkIDFweCAjZTdlN2U3OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgeyBwYWRkaW5nOjEwcHggMTBweDsgd2lkdGg6MjAwcHg7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbSB7IGNvbG9yOmJsYWNrOyBwYWRkaW5nOjEwcHggNDBweDsgYm9yZGVyLWxlZnQ6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5pdGVtLnNlbGVjdCB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzAxNTJkOTsgY29sb3I6d2hpdGU7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYubGlzdCBkaXYuaXRlbSB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOmJsYWNrOyBib3JkZXItbGVmdDpub25lOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lmxpc3QgZGl2Lml0ZW0uc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjojMDE1MmQ5OyBjb2xvcjp3aGl0ZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjojMDE1MmQ5OyBjb2xvcjp3aGl0ZTsgfQoKYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuQWN0aW9uIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2LmFjdGlvbiB7IGJhY2tncm91bmQ6d2hpdGU7IHBhZGRpbmc6MTBweDsgYm9yZGVyLWJvdHRvbTogc29saWQgMXB4IHJlZDsgaGVpZ2h0OjM4cHg7IHdpZHRoOjYwMHB4OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkFjdGlvbj5kaXYuYWN0aW9uIGRpdi50YWJzIHsgcGFkZGluZzoxMHB4OyBtYXJnaW46MTBweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24udGFicz5kaXYub3V0cHV0IHsgbWFyZ2luLXRvcDo1OHB4OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkFjdGlvbj5kaXYub3V0cHV0PmZpZWxkc2V0LnBsdWdpbi5pbm5lciB7IGJveC1zaGFkb3c6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4uaW5uZXI+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkFjdGlvbj5kaXYub3V0cHV0PmZpZWxkc2V0LnBsdWdpbi5pbm5lcj5mb3JtLm9wdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4uaW5uZXI+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4uaW5uZXI+ZGl2LnN0YXR1cyB7IGRpc3BsYXk6bm9uZTsgfQoKYm9keS5zaW1wbGUgZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtIHsgbWluLXdpZHRoOjI0MHB4OyBib3JkZXItcmFkaXVzOjVweDsgYm94LXNoYWRvdzoycHggMnB4IDZweCAxcHggZ3JheTsgfQpib2R5LnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBib3gtc2hhZG93OjVweCA1cHggMTBweCA1cHggZ3JheTsgfQpib2R5LnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW0+ZGl2LnRpdGxlIHsgYm9yZGVyLWJvdHRvbTpzb2xpZCAxcHggI2U3ZTdlNzsgfQpib2R5LndoaXRlLnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgaW5wdXRbdHlwZT1idXR0b25dOmhvdmVyIHsgYm94LXNoYWRvdzoycHggMnB4IDhweCAycHggZ3JheTsgfQpib2R5LndoaXRlLnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgaW5wdXRbdHlwZT1idXR0b25dIHsgYm94LXNoYWRvdzoycHggMnB4IDZweCAxcHggZ3JheTsgY29sb3I6d2hpdGU7IH0KYm9keS53aGl0ZS5zaW1wbGUgZGl2Lm91dHB1dC5jYXJkIGlucHV0W3R5cGU9YnV0dG9uXSB7IGJhY2tncm91bmQtY29sb3I6IzAxNTJkOTsgZm9udC1zaXplOjAuOHJlbTsgcGFkZGluZzo1cHggMTBweDsgYm9yZGVyOm5vbmU7IGJvcmRlci1yYWRpdXM6NXB4OyB9CmJvZHkubW9iaWxlLnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW0geyB3aWR0aDotd2Via2l0LWZpbGwtYXZhaWxhYmxlOyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZS5zaW1wbGUgZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtIHsgd2lkdGg6YXV0bzsgZmxvYXQ6bGVmdDsgfQoKYm9keS53aGl0ZS5zaW1wbGU+ZGl2LmNhcnRlIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IGJvcmRlcjpzb2xpZCAxcHggI2U3ZTdlNzsgfQpib2R5LndoaXRlLnNpbXBsZT5kaXYuY2FydGUgZGl2Lml0ZW0geyBmb250LXNpemU6MXJlbTsgfQpib2R5LndoaXRlLnNpbXBsZT5kaXYuY2FydGUgZGl2Lml0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMTUyZDk7IGNvbG9yOndoaXRlOyB9CmJvZHkud2hpdGUuc2ltcGxlIGlucHV0W3R5cGU9YnV0dG9uXSB7IGJhY2tncm91bmQtY29sb3I6IzAxNTJkOTsgYm9yZGVyOm5vbmU7IGJvcmRlci1yYWRpdXM6NXB4OyBoZWlnaHQ6MzFweDsgYm94LXNoYWRvdzoycHggMnB4IDZweCAxcHggZ3JheTsgfQoKZmllbGRzZXQuSGVhZGVyIHsgZm9udC1zaXplOjEuMmVtOyBwYWRkaW5nOjAgNXB4OyBoZWlnaHQ6MzJweDsgb3ZlcmZsb3c6aGlkZGVuOyB6LWluZGV4OjEwOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0IHsgaGVpZ2h0OjMycHg7IG92ZXJmbG93OmhpZGRlbjsgfQpmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dD5kaXYgeyBwYWRkaW5nOjVweDsgaGVpZ2h0OjIycHg7IGN1cnNvcjpwb2ludGVyOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0PmRpdjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgYm9yZGVyLWJvdHRvbTpzb2xpZCAycHggcmVkOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0PmRpdi50aXRsZSB7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnN0YXRlIHsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnN0YXRlLmF2YXRhcj5pbWcgeyBoZWlnaHQ6MS40ZW07IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaCB7IG1hcmdpbi1sZWZ0OjIwcHg7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaD5pbnB1dCB7IG1hcmdpbi10b3A6LTVweDsgaGVpZ2h0OjI1cHg7IGJvcmRlci1yYWRpdXM6MDsgfQpmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dCBkaXYubWVudSB7IHBhZGRpbmc6NXB4OyBoZWlnaHQ6MjFweDsgY3Vyc29yOnBvaW50ZXI7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQgZGl2Lm1lbnU6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyZTUxNWY7IGJvcmRlci1ib3R0b206c29saWQgMnB4IHJlZDsgfQoKZGl2LmhlYWQgewoJYmFja2dyb3VuZC1jb2xvcjojNDA0MDQwOyBwYWRkaW5nOjVweDsgaGVpZ2h0OjQycHg7IGNsZWFyOmJvdGg7Cn0KZGl2LmxlZnQgZGl2LnVzZXJuYW1lIGRpdiB7Cgljb2xvcjp3aGl0ZTsgdGV4dC1hbGlnbjpjZW50ZXI7IHBhZGRpbmc6MTBweDsKfQpkaXYubGVmdCBkaXYudXNlcm5hbWUgaW1nIHsKCXBhZGRpbmc6MCAxMHB4OyB3aWR0aDoxMDBweDsKfQpkaXYuaGVhZCBkaXYudXNlcm5hbWUgaW1nIHsKCWhlaWdodDo0MHB4OyBmbG9hdDpsZWZ0Owp9CmRpdi5oZWFkIGRpdi51c2VybmFtZSBkaXYgewoJcGFkZGluZzoxMnB4OyBmbG9hdDpsZWZ0Owp9CmRpdi5oZWFkIGRpdi51c2VybmFtZSB7Cgljb2xvcjp3aGl0ZTsgZmxvYXQ6cmlnaHQ7CglwYWRkaW5nLXJpZ2h0OjEwcHg7Cn0KZGl2LmhlYWQgZGl2Lm1lbnUgewoJY29sb3I6d2hpdGU7IGN1cnNvcjpwb2ludGVyOyBwYWRkaW5nOjEwcHg7IGZsb2F0OmxlZnQ7Cn0KZGl2LmhlYWQgZGl2Lm1lbnU6aG92ZXIgewoJYmFja2dyb3VuZC1jb2xvcjojMzIzMjMyOwp9CmRpdi5sZWZ0IHsKCXdpZHRoOjEyMHB4OwoJYmFja2dyb3VuZC1jb2xvcjojMzIzMjMyOyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0Owp9CmRpdi5sZWZ0OmhvdmVyIHsKCWJhY2tncm91bmQtY29sb3I6IzMyMzIzMjsKfQpkaXYubGVmdCBkaXYuaXRlbSB7CgliYWNrZ3JvdW5kLWNvbG9yOiMzMjMyMzI7Cgljb2xvcjp3aGl0ZTsgcGFkZGluZzo1cHggMTBweDsKfQpkaXYubGVmdCBkaXYuaXRlbTpob3ZlciB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7Cn0KZGl2Lm1haW4gewoJYmFja2dyb3VuZC1jb2xvcjojY2NjY2NjOyBoZWlnaHQ6MTgwcHg7IHdpZHRoOjE4MHB4OyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0Owp9CmRpdi5tYWluIGlmcmFtZSB7Cglib3JkZXI6MDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gewoJYmFja2dyb3VuZC1jb2xvcjojZjhmOGY4OyBwYWRkaW5nOjEwcHg7IG1hcmdpbjoxMHB4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiBmb3JtLm9wdGlvbiBkaXYuaXRlbSB7CiAJbWFyZ2luOjEwcHg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIGRpdi5hY3Rpb24gZGl2Lml0ZW0gewogCW1hcmdpbjoxMHB4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiBsZWdlbmQgewoJYm94LXNoYWRvdzpub25lOwoJYmFja2dyb3VuZC1jb2xvcjojZTRlNGU0OwoJY29sb3I6YmxhY2s7CglkaXNwbGF5OmJsb2NrOwoJZmxvYXQ6bGVmdDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gZm9ybS5vcHRpb24gewoJZGlzcGxheTpibG9jazsKCWNsZWFyOmJvdGg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIHNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsKIAlib3JkZXI6c29saWQgMXB4IGdyYXk7IG91dGxpbmU6bm9uZTsKCWJveC1zaGFkb3c6bm9uZTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gaW5wdXRbdHlwZT10ZXh0XSB7CgliYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsgcGFkZGluZzoycHggMTBweDsKIAlib3JkZXI6c29saWQgMXB4IGdyYXk7IG91dGxpbmU6bm9uZTsKCWJvcmRlci1yYWRpdXM6M3B4IDNweDsKCWJveC1zaGFkb3c6bm9uZTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gaW5wdXRbdHlwZT1idXR0b25dIHsKCWJhY2tncm91bmQtY29sb3I6Ymx1ZTsgY29sb3I6d2hpdGU7IHBhZGRpbmc6NHB4IDEwcHg7Cglib3JkZXI6bm9uZTsgYm9yZGVyLXJhZGl1czozcHggM3B4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiB0YWJsZS5jb250ZW50IHsKIAlib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7CglkaXNwbGF5OmJsb2NrOwp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiB0YWJsZS5jb250ZW50IHRoZWFkIHsKCXotaW5kZXg6MTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gdGFibGUuY29udGVudCB0ciB7Cglib3JkZXI6c29saWQgMXB4IGxpZ2h0Z3JheTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gdGFibGUuY29udGVudCB0aCB7CgliYWNrZ3JvdW5kLWNvbG9yOiNmYmZiZmI7IGNvbG9yOnJnYmEoMCwwLDAsLjQ1KTsgZm9udC13ZWlnaHQ6MTAwOyBwYWRkaW5nOjEwcHg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIHRhYmxlLmNvbnRlbnQgdGQgewoJYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6ICM1YzVjNWM7IHBhZGRpbmc6MTBweDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gZGl2LnN0YXR1cyB7Cgljb2xvcjpibGFjazsKfQpkaXYuZm9vdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGhlaWdodDozMnB4OyBjbGVhcjpib3RoOwp9CgpkaXYudGFiczpob3ZlciB7CgliYWNrZ3JvdW5kLWNvbG9yOiMyNzI3Mjc7Cn0KZGl2LnRhYnMgZGl2Lm5hbWUgewoJaGVpZ2h0OjQ2cHg7IHdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7Cglwb3NpdGlvbjpzdGlja3k7IHRvcDo1cHg7Cgl6LWluZGV4OjE7Cn0KZGl2LnRhYnMgZGl2Lm5hbWUgZGl2Lml0ZW0gewoJY29sb3I6Z3JheTsgcGFkZGluZzoxMHB4OyBmbG9hdDpsZWZ0Owp9CmRpdi50YWJzIGRpdi5uYW1lIGRpdi5pdGVtLnNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGNvbG9yOndoaXRlOwogCWJvcmRlci1ib3R0b206c29saWQgcmVkIDJweDsKfQpkaXYudGFicyBkaXYucGFnZSB7CglvdmVyZmxvdzphdXRvOyBjbGVhcjpib3RoOwp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5pbnB1dCB7CglwYWRkaW5nOjVweDsgcG9zaXRpb246c3RpY2t5OyB0b3A6MHB4Owp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5pbnB1dCBpbnB1dCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMyMTIxMjE7IGNvbG9yOndoaXRlOyBib3JkZXI6MDsgb3V0bGluZTpub25lOyB3aWR0aDoyMzBweDsKfQpkaXYudGFicyBkaXYucGFnZT5kaXYuaXRlbSB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGNsZWFyOmJvdGg7IGRpc3BsYXk6bm9uZTsKfQpkaXYudGFicyBkaXYucGFnZT5kaXYubGlzdCB7CglwYWRkaW5nLWxlZnQ6MjBweDsgZGlzcGxheTpub25lOyBjbGVhcjpib3RoOwp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5saXN0LnNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMzMjMyMzI7IGRpc3BsYXk6YmxvY2s7Cn0KZGl2LmxlZnQgZGl2Lmxpc3QgewoJcGFkZGluZy1sZWZ0OjIwcHg7Cn0KCmRpdi50YWJzLmxlZnQgZGl2Lm5hbWUgewoJZmxvYXQ6bGVmdDsKfQpkaXYudGFicy5sZWZ0IGRpdi5uYW1lIGRpdi5pdGVtIHsKCWJvcmRlci1ib3R0b206bm9uZTsgZmxvYXQ6bm9uZTsKfQpkaXYudGFicy5sZWZ0IGRpdi5uYW1lIGRpdi5pdGVtLnNlbGVjdCB7Cglib3JkZXItcmlnaHQ6c29saWQgcmVkIDJweDsKfQpkaXYudGFicy5sZWZ0IGRpdi5wYWdlIHsKCXdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7CiAJY2xlYXI6bm9uZTsgZmxvYXQ6bGVmdDsKfQpkaXYudGFicy5sZWZ0IGRpdi5wYWdlPmRpdi5pdGVtIHsKCWRpc3BsYXk6YmxvY2s7Cn0KCmRpdi50YWJzLnZvaWQgZGl2Lm5hbWUgewoJZGlzcGxheTpub25lOwp9CmRpdi50YWJzLnZvaWQgZGl2LnBhZ2U+ZGl2Lml0ZW0gewoJZGlzcGxheTpibG9jazsKfQoKCmZpZWxkc2V0LkFjdGlvbiB7IGJhY2tncm91bmQtY29sb3I6cmdiYSgxMTQsIDE1MywgMTYyLCAwLjU0KTsgbWluLXdpZHRoOjE2MHB4OyB9CmZpZWxkc2V0LkFjdGlvbj5kaXYuYWN0aW9uIHsgYmFja2dyb3VuZC1jb2xvcjojMTU5Y2M3YjA7IHBhZGRpbmc6MDsgbWFyZ2luOjA7IGhlaWdodDoyOHB4OyBkaXNwbGF5Om5vbmU7IHBvc2l0aW9uOmFic29sdXRlOyB9CgpmaWVsZHNldC5BY3Rpb24udGFicz5kaXYuYWN0aW9uIHsgZGlzcGxheTpibG9jazsgfQpmaWVsZHNldC5BY3Rpb24udGFicz5kaXYub3V0cHV0IHsgbWFyZ2luLXRvcDoyOHB4OyB9CmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5vdXRwdXQ+ZmllbGRzZXQ+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luIHsgZGlzcGxheTpub25lOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luLnNlbGVjdCB7IGRpc3BsYXk6YmxvY2s7IH0KZmllbGRzZXQuQWN0aW9uLmdyaWQ+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4geyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkFjdGlvbi5ncmlkPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luPmRpdi5vdXRwdXQgeyBvdmVyZmxvdzphdXRvOyB9CmZpZWxkc2V0LkFjdGlvbi5mcmVlPmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luIHsgcG9zaXRpb246YWJzb2x1dGU7IH0KZmllbGRzZXQuQWN0aW9uLmZyZWU+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4uc2VsZWN0IHsgZGlzcGxheTpibG9jazsgfQpmaWVsZHNldC5BY3Rpb24uZmxvdz5kaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbiB7IGZsb2F0OmxlZnQ7IH0KCmZpZWxkc2V0LkFjdGlvbiBkaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbi5GdWxsIHsgYmFja2dyb3VuZC1jb2xvcjojMDczOTQ3ZjI7IHBhZGRpbmc6MDsgbWFyZ2luOjA7IHBvc2l0aW9uOmZpeGVkOyBsZWZ0OjA7IHRvcDowOyBvdmVyZmxvdzphdXRvOyB6LWluZGV4OjEwOyB9CmZpZWxkc2V0LkFjdGlvbiBkaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbi5GdWxsPmxlZ2VuZCB7IGZsb2F0OmxlZnQ7IGRpc3BsYXk6Y29udGVudHM7IH0KZmllbGRzZXQuQWN0aW9uIGRpdi5vdXRwdXQgZmllbGRzZXQuc3RvcnkuRnVsbCB7IGJhY2tncm91bmQtY29sb3I6IzA3Mzk0N2YyOyBwYWRkaW5nOjA7IG1hcmdpbjowOyBwb3NpdGlvbjpmaXhlZDsgbGVmdDowOyB0b3A6MDsgb3ZlcmZsb3c6YXV0bzsgei1pbmRleDoxMDsgfQpmaWVsZHNldC5BY3Rpb24gZGl2Lm91dHB1dCBmaWVsZHNldC5zdG9yeS5GdWxsPmxlZ2VuZCB7IGhlaWdodDozMHB4OyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkFjdGlvbj5kaXYucHJvamVjdC50b2dnbGUgewoJYmFja2dyb3VuZC1jb2xvcjpjb3Juc2lsazsgb3BhY2l0eTowLjQ7IGNvbG9yOnRlYWw7IGZvbnQtc2l6ZTogMjhweDsgcGFkZGluZy10b3A6IDUwcHg7IGhlaWdodDogMTAwcHg7IHdpZHRoOjIwcHg7IHBvc2l0aW9uOiBmaXhlZDsgdG9wOiAzMCU7Cglib3JkZXItdG9wLXJpZ2h0LXJhZGl1czoyMHB4OyBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czoyMHB4Owp9CgpmaWVsZHNldC5wYW5lbC5jbWQ+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4geyBwYWRkaW5nOjA7IG1hcmdpbjowOyB9CmZpZWxkc2V0LnBhbmVsLmNtZD5kaXYub3V0cHV0PmZpZWxkc2V0LnBsdWdpbj5sZWdlbmQgeyBiYWNrZ3JvdW5kLWNvbG9yOmRhcmtjeWFuOyBwYWRkaW5nOjAgMTBweDsgbWFyZ2luLXJpZ2h0OjNweDsgaGVpZ2h0OjMwcHg7IGZsb2F0OmxlZnQ7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQucGFuZWwuY21kPmRpdi5vdXRwdXQ+ZmllbGRzZXQucGx1Z2luPmxlZ2VuZCB7IGhlaWdodDo0MnB4OyB9CgpkaXYub3V0cHV0LmZvcm0gZGl2Lml0ZW0gewoJbWFyZ2luOjEwcHggNDBweDsKfQpkaXYub3V0cHV0LmZvcm0gZGl2Lml0ZW0gZGl2LmxhYmVsIHsKCW1hcmdpbjo1cHggMHB4Owp9CgoKZmllbGRzZXQuU2VhcmNoIHsgYmFja2dyb3VuZDojMDQxYTI1YmQ7IHBhZGRpbmc6MTBweDsgcG9zaXRpb246Zml4ZWQ7IGxlZnQ6MHB4OyB0b3A6MjZweDsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LlNlYXJjaCBpbnB1dC53b3JkIHsgd2lkdGg6LXdlYmtpdC1maWxsLWF2YWlsYWJsZTsgfQpmaWVsZHNldC5TZWFyY2ggZGl2Lm91dHB1dCBkaXYuY29udGVudCB0YWJsZSB7IG1pbi13aWR0aDo0MDBweDsgfQpmaWVsZHNldC5TZWFyY2ggZGl2Lm91dHB1dCBkaXYuZGlzcGxheSB7IG1heC1oZWlnaHQ6MjAwcHg7IH0KZmllbGRzZXQuU2VhcmNoIGRpdi5vdXRwdXQgYSB7IGNvbG9yOnllbGxvdzsgfQoKZmllbGRzZXQuUml2ZXIgeyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgeyB3aWR0aDoxODBweDsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5pdGVtIHsgcGFkZGluZzozcHggMTZweDsgYm9yZGVyLWxlZnQ6c29saWQgM3B4ICMwMGZmYWU7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbS5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyZTUxNWY7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IHsgcGFkZGluZy1sZWZ0OjVweDsgbWFyZ2luLWxlZnQ6OHB4OyB9CmZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lmxpc3QgZGl2Lml0ZW0geyBiYWNrZ3JvdW5kLWNvbG9yOiMwNzM1NDBiNTsgYm9yZGVyLWxlZnQ6c29saWQgM3B4ICNjY2RjNGM7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYubGlzdCBkaXYuaXRlbS5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOnN0ZWVsYmx1ZTsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpzdGVlbGJsdWU7IH0KCmZpZWxkc2V0LkZvb3RlciB7IHBhZGRpbmc6MCA1cHg7IGhlaWdodDozMnB4OyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IHsgaGVpZ2h0OjMycHg7IG92ZXJmbG93OmhpZGRlbjsgfQpmaWVsZHNldC5Gb290ZXI+ZGl2Lm91dHB1dD5kaXYgeyBwYWRkaW5nOjVweDsgaGVpZ2h0OjIycHg7IGN1cnNvcjpwb2ludGVyOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0PmRpdjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgYm9yZGVyLXRvcDpzb2xpZCAycHggcmVkOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IGRpdi50aXRsZSB7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgZGl2LnN0YXRlIHsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgZGl2LnRvYXN0IHsgYmFja2dyb3VuZC1jb2xvcjpkYXJrY3lhbjsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgZGl2LmNtZCB7IHBhZGRpbmc6MHB4OyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IGlucHV0W25hbWU9Y21kXSB7IGhlaWdodDoyNXB4OyB3aWR0aDoxMjBweDsgYm9yZGVyLXJhZGl1czowOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0IGlucHV0W25hbWU9Y21kXTpmb2N1cyB7IHdpZHRoOjMyMHB4OyB9CgpmaWVsZHNldC5zdG9yeS5pbm5lcj5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyPmZvcm0ub3B0aW9uIGlucHV0W25hbWU9cGF0aF0geyB3aWR0aDo4MHB4OyB9CmZpZWxkc2V0LmlubmVyPmZvcm0ub3B0aW9uIGlucHV0W25hbWU9ZmlsZV0geyB3aWR0aDoxNjBweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYuYWN0aW9uPmRpdi50YWJzIHsgYmFja2dyb3VuZC1jb2xvcjojNWM4MDljNWM7IGhlaWdodDoxOHB4OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5hY3Rpb24+ZGl2LnRhYnM6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMTNiNjc1YzsgfQpmaWVsZHNldC5pbm5lcj5kaXYuYWN0aW9uPmRpdi50YWJzLnNlbGVjdCB7IGJhY2tncm91bmQtY29sb3I6IzAxM2I2NzVjOyBib3JkZXItYm90dG9tOnNvbGlkIDJweCAjNzk5OWIyOyBmb250LXNpemU6MXJlbTsgaGVpZ2h0OjE5cHg7IH0KCmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgeyBjb2xvcjp3aGl0ZTsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgeyB3aWR0aDoxODBweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IGRpdi5raW5kIHsgYmFja2dyb3VuZC1jb2xvcjpjb3JuZmxvd2VyYmx1ZTsgY29sb3I6d2hpdGU7IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgZm9udC1zaXplOjEuMXJlbTsgdGV4dC1hbGlnbjpjZW50ZXI7IHBhZGRpbmc6NXB4OyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2plY3QgZGl2Lml0ZW0gZGl2Lm5hbWUgeyBwYWRkaW5nOjAgMTZweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHsgY29sb3I6d2hpdGU7IGZvbnQtc2l6ZToxLjFyZW07IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgcG9zaXRpb246cmVsYXRpdmU7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ci5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMDAwZmY2YjsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRyLnNlbGVjdCB0ZC5saW5lIHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyBib3JkZXI6c29saWQgMXB4IHJlZDsgYm9yZGVyLXJpZ2h0OnNvbGlkIDJweCByZWQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC5saW5lOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpncmVlbjsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLmxpbmUgeyBwb3NpdGlvbjpzdGlja3k7IGxlZnQ6MDsgdGV4dC1hbGlnbjpyaWdodDsgcGFkZGluZzowIDZweDsgYm9yZGVyLXJpZ2h0OnNvbGlkIDJweCByZWQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHsgdGV4dC1hbGlnbjpsZWZ0OyB3aGl0ZS1zcGFjZTpwcmU7IHBhZGRpbmctbGVmdDoxMHB4OyBjdXJzb3I6dGV4dDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5jb21tZW50IHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyBjb2xvcjpjeWFuOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmtleXdvcmQgeyBjb2xvcjp5ZWxsb3c7IGZvbnQtd2VpZ2h0OmJvbGQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uZGF0YXR5cGUgeyBjb2xvcjpsaWdodGdyZWVuOyBmb250LXdlaWdodDpib2xkOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmZ1bmN0aW9uIHsgY29sb3I6Y3lhbjsgZm9udC13ZWlnaHQ6Ym9sZDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5jb25zdGFudCB7IGNvbG9yOm1hZ2VudGE7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uc3RyaW5nIHsgY29sb3I6bWFnZW50YTsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IGxlZ2VuZCB7IG1hcmdpbi1yaWdodDo0cHg7IGhlaWdodDozMHB4OyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2ZpbGU+ZGl2Lm91dHB1dD5maWVsZHNldD5sZWdlbmQgeyBwYWRkaW5nOjAuMXJlbTsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5kaXNwbGF5IHsgYm9yZGVyOnNvbGlkIDFweCBncmVlbnllbGxvdzsgfQoKZmllbGRzZXQuaW5uZXIgZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0IHsgcG9zaXRpb246YWJzb2x1dGU7IGJvdHRvbTowcHg7IHJpZ2h0OjBweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGZpZWxkc2V0LnRvb2xraXQ+ZGl2Lm91dHB1dD5maWVsZHNldCB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGZpZWxkc2V0LnRvb2xraXQ+ZGl2Lm91dHB1dD5maWVsZHNldC5zZWxlY3QgeyBkaXNwbGF5OmJsb2NrOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZmllbGRzZXQudG9vbGtpdD5kaXYub3V0cHV0PmZpZWxkc2V0PmxlZ2VuZCB7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5zdGF0dXM+bGVnZW5kIHsgYmFja2dyb3VuZDojMGQ5NjlmOGE7IHBhZGRpbmc6NHB4IDRweDsgYm9yZGVyLWxlZnQ6c29saWQgMnB4IHJlZDsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5zdGF0dXM+bGVnZW5kLnNlbGVjdCB7IGJhY2tncm91bmQ6Z3JlZW47IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5zdGF0dXM+bGVnZW5kOmhvdmVyIHsgYmFja2dyb3VuZDpncmVlbjsgfQpmaWVsZHNldC5pbm5lcj5kaXYuc3RhdHVzIHsgaGVpZ2h0OjI2cHg7IH0KZmllbGRzZXQuaW5uZXI+ZGl2LnN0YXR1cyBsZWdlbmQgeyBiYWNrZ3JvdW5kOiMwZDk2OWY4YTsgZm9udC1zaXplOjEuMXJlbTsgcGFkZGluZzowcHggMTBweDsgYm9yZGVyLWxlZnQ6c29saWQgMnB4IHJlZDsgY3Vyc29yOnBvaW50ZXI7IGZsb2F0OnJpZ2h0OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5zdGF0dXMgbGVnZW5kLnNlbGVjdCB7IGJhY2tncm91bmQ6Z3JlZW47IH0KZmllbGRzZXQuaW5uZXI+ZGl2LnN0YXR1cyBsZWdlbmQ6aG92ZXIgeyBiYWNrZ3JvdW5kOmdyZWVuOyB9CgpmaWVsZHNldC5pbm5lci5mbG9hdCBsZWdlbmQgeyBoZWlnaHQ6MzBweDsgfQpmaWVsZHNldC5pbm5lci5mbG9hdCBkaXYub3V0cHV0IHsgYmFja2dyb3VuZC1jb2xvcjojMzMyZjFlY2Y7IH0KZmllbGRzZXQuaW5uZXIuZmxvYXQgZGl2LnN0YXR1cyB7IGNvbG9yOndoaXRlOyB9CgpmaWVsZHNldC5pbm5lci5mdWxsPmxlZ2VuZCB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lci5mdWxsPmZvcm0ub3B0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyLmZ1bGw+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lci5mdWxsPmRpdi5zdGF0dXMgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5kaXYub3V0cHV0IGRpdi5wcm9maWxlPmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5kaXYub3V0cHV0IGRpdi5kaXNwbGF5PmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5kaXYub3V0cHV0IGRpdi5kaXNwbGF5PmRpdi5zdGF0dXMgeyBkaXNwbGF5Om5vbmU7IH0KCmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYucHJvamVjdCB7IGNvbG9yOiNhMmRhZDI7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHsgYmFja2dyb3VuZC1jb2xvcjojMDEzYjY3NWM7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5zdHJpbmcgeyBjb2xvcjojYTcwM2E3OyB9Cgpib2R5Lm1vYmlsZSBmaWVsZHNldC5pbm5lci5mbG9hdCBsZWdlbmQgeyBoZWlnaHQ6NDJweDsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5pbm5lcj5mb3JtLm9wdGlvbiBpbnB1dFtuYW1lPWZpbGVdIHsgd2lkdGg6OTBweDsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5wbHVnaW4uaW5uZXIgZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQucGx1Z2luLmlubmVyIGRpdi5hY3Rpb24geyBkaXNwbGF5OmNvbnRlbnRzOyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZSBmaWVsZHNldC5wbHVnaW4uaW5uZXIgZm9ybS5vcHRpb24gaW5wdXRbdHlwZT1idXR0b25dIHsgZGlzcGxheTpub25lOyB9CgoudW5zZWxlY3RhYmxlIHsKCS13ZWJraXQtdG91Y2gtY2FsbG91dDpub25lOwoJLXdlYmtpdC11c2VyLXNlbGVjdDpub25lOwoJLWtodG1sLXVzZXItc2VsZWN0Om5vbmU7CgktbW96LXVzZXItc2VsZWN0Om5vbmU7CgktbXMtdXNlci1zZWxlY3Q6bm9uZTsKCS1vLXVzZXItc2VsZWN0Om5vbmU7Cgl1c2VyLXNlbGVjdDpub25lOwp9CgpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi5wYXRoIHsgZGlzcGxheTpub25lOyB9Cgpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgeyBiYWNrZ3JvdW5kOiM1NDZFN0E7IHBhZGRpbmc6MHB4OyBoZWlnaHQ6MzhweDsgb3ZlcmZsb3c6YXV0bzsgZGlzcGxheTpibG9jazsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgZGl2LnRhYnMgeyBiYWNrZ3JvdW5kOiM2OTgxOGQ7IGNvbG9yOndoaXRlOyBmb250LXNpemU6MXJlbTsgcGFkZGluZzoxMHB4OyBmbG9hdDpsZWZ0OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYudGFicyBkaXYudGFicy5zZWxlY3QgeyBiYWNrZ3JvdW5kOiM0NTVBNjQ7IGJveC1zaGFkb3c6MHB4IDBweCA1cHggMXB4IGdyZXk7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi5wYXRoIHsKCWJhY2tncm91bmQ6IzQ1NUE2NDsgY29sb3I6d2hpdGU7IHBhZGRpbmc6NHB4IDEwcHg7CgltYXJnaW4tYm90dG9tOjRweDsgYm94LXNoYWRvdzowcHggMHB4IDVweCAxcHggIzkwQTRBRTsKCWNsZWFyOmJvdGg7IGRpc3BsYXk6YmxvY2s7Cn0KCmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi50YWJzIHsgYmFja2dyb3VuZDojZjNmM2YzOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi50YWJzIGRpdi50YWJzIHsgYmFja2dyb3VuZDojZWNlY2VjOyBjb2xvcjpibGFjazsgZm9udC1zaXplOjFyZW07IHBhZGRpbmc6MTBweDsgZmxvYXQ6bGVmdDsgfQpib2R5LndoaXRlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYudGFicyBkaXYudGFicy5zZWxlY3QgeyBiYWNrZ3JvdW5kOiB3aGl0ZTsgYm94LXNoYWRvdzowcHggMHB4IDVweCAxcHggZ3JleTsgfQpib2R5LndoaXRlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYucGF0aCB7IGJhY2tncm91bmQ6d2hpdGU7IGNvbG9yOmJsYWNrOyBmb250LWZhbWlseTptb25vc3BhY2U7IGJveC1zaGFkb3c6MHB4IDBweCA1cHggMXB4IGdyZXk7IH0KCmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQucHJvamVjdCBkaXYucHJvamVjdCB7IHdpZHRoOjI0MHB4OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQucHJvamVjdCBkaXYucHJvamVjdCBkaXYua2luZCB7IHBhZGRpbmc6MTBweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2LmtpbmQgeyBjb2xvcjogd2hpdGU7IGZvbnQtc2l6ZTogMS4ycmVtOyBmb250LWZhbWlseTogbW9ub3NwYWNlOyBoZWlnaHQ6MThweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2LmtpbmQ6Zmlyc3QtY2hpbGQgeyBwb3NpdGlvbjpzdGlja3k7IHRvcDowIH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB7IGJhY2tncm91bmQtY29sb3I6IzI2MzIzOGMyOyBmb250LXNpemU6MTZweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi50b2dnbGUgeyBkaXNwbGF5Om5vbmU7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYudG9nZ2xlLnByb2ZpbGUgeyBiYWNrZ3JvdW5kLWNvbG9yOiM2NjRmNGY0NTsgZGlzcGxheTpibG9jazsgfQoKYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYucHJvamVjdCBkaXYuYWN0aW9uIGRpdi5pdGVtIHsgZmxvYXQ6bGVmdDsgd2lkdGg6YXV0bzsgcGFkZGluZzp1bnNldDsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IHsgYmFja2dyb3VuZDpsaWdodHllbGxvdzsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IGRpdi5pdGVtIHsgY29sb3I6YmxhY2s7IGZvbnQtc2l6ZToxNnB4OyB3aWR0aDotd2Via2l0LWZpbGwtYXZhaWxhYmxlOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2plY3QgZGl2Lml0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kOiNlM2U2ZjE7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGZvbnQtc2l6ZToxNnB4OyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdHIuc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRyLnNlbGVjdCB0ZC5saW5lIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IGJvcmRlcjpub25lOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdHIuc2VsZWN0IHRkLnRleHQgeyBib3JkZXI6c29saWQgMXB4ICNlN2U3ZTc7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC5saW5lIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6IzIzNzg5MzsgcGFkZGluZy10b3A6NHB4OyBib3JkZXItcmlnaHQ6bm9uZTsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgeyBjb2xvcjpibGFjazsgcGFkZGluZy10b3A6MnB4OyBib3JkZXI6c29saWQgMXB4IHdoaXRlOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLnN0cmluZyB7IGNvbG9yOiNhMzE1MTU7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uZnVuY3Rpb24geyBjb2xvcjojNzk1ZTI2OyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmtleXdvcmQgeyBjb2xvcjpibHVlOyB9CmJvZHkud2hpdGUuc2ltcGxlIHRkLmNvbnRlbnQ+ZGl2LmNvbnRlbnQgeyBiYWNrZ3JvdW5kOiB3aGl0ZTsgYm94LXNoYWRvdzowcHggMHB4IDVweCAxcHggZ3JleTsgfQpib2R5LndoaXRlLnNpbXBsZSBkaXYuc3RhdHVzIHsgY29sb3I6YmxhY2s7IH0KCmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3BhbiB7IGNvbG9yOmJsYWNrOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5rZXkgeyBjb2xvcjpibHVlOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5zdHJpbmcgeyBjb2xvcjptYWdlbnRhOyB9Cgpib2R5Lm1vYmlsZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYudG9nZ2xlIHsgZGlzcGxheTpibG9jazsgfQpib2R5Lm1vYmlsZS5zaW1wbGUgaW5wdXRbdHlwZT1idXR0b25dIHsgaGVpZ2h0OjQ1cHg7IH0KYm9keS5tb2JpbGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgbGVnZW5kIHsgaGVpZ2h0OjQ1cHg7IH0KYm9keS5tb2JpbGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnRvZ2dsZSB7IGJhY2tncm91bmQtY29sb3I6bGlnaHRibHVlOyB3aWR0aDozMHB4OyB9CmJvZHkubW9iaWxlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi50b2dnbGUuZGlzcGxheSB7IGJhY2tncm91bmQtY29sb3I6bGlnaHRibHVlOyBtYXJnaW4tdG9wOi0zM3B4OyBoZWlnaHQ6MzBweDsgd2lkdGg6MTAwcHg7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuQWN0aW9uIGRpdi5vdXRwdXQgZmllbGRzZXQuRnVsbD5sZWdlbmQgeyBmbG9hdDpub25lOyB9Cgpib2R5Lm1vYmlsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IGxlZ2VuZCB7IGhlaWdodDo0NXB4OyB9CgpmaWVsZHNldC53b3JkIGZvcm0ub3B0aW9uIGlucHV0W25hbWU9cGF0aF0geyB3aWR0aDoxMjdweDsgfQoKZmllbGRzZXQud29yZD5kaXYubmF2bWVudSB7IGJhY2tncm91bmQtY29sb3I6aW5oZXJpdDsgb3ZlcmZsb3c6YXV0bzsgbWFyZ2luLXJpZ2h0OjEwcHg7IG1pbi13aWR0aDoxMjBweDsgY2xlYXI6Ym90aDsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC53b3JkPmRpdi5uYXZtZW51IGRpdi5saXN0IHsgbWFyZ2luLWxlZnQ6MjBweDsgfQpmaWVsZHNldC53b3JkPmRpdi5uYXZtZW51IGRpdi5pdGVtIHsgZm9udC1zaXplOjEuNmVtOyBmb250LXdlaWdodDpib2xkOyBmb250LWZhbWlseTpjdXJzaXZlOyBwYWRkaW5nOjRweCAxMHB4OyB9CmZpZWxkc2V0LndvcmQ+ZGl2Lm5hdm1lbnU+ZGl2Lml0ZW0geyBmb250LXNpemU6MmVtOyB9CgpmaWVsZHNldC53b3JkIGEgeyB3b3JkLWJyZWFrOmJyZWFrLXdvcmQ7IH0KZmllbGRzZXQud29yZCBici5zdG9yeSB7IGNsZWFyOmJvdGg7IH0KZmllbGRzZXQud29yZCB1bC5zdG9yeSB7IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgfQpmaWVsZHNldC53b3JkIHVsLnN0b3J5IGxpLkgyIHsgZm9udC1zaXplOjEuNGVtOyBmb250LXdlaWdodDpib2xkOyB9CmZpZWxkc2V0LndvcmQgdWwuc3RvcnkgbGkuSDMgeyBmb250LXNpemU6MS4yZW07IH0KZmllbGRzZXQud29yZCB1bC5zdG9yeVtkYXRhLXR5cGU9cHJlbWVudV0geyBjdXJzb3I6cG9pbnRlcjsgfQpmaWVsZHNldC53b3JkIHVsLnN0b3J5W2RhdGEtdHlwZT1wcmVtZW51XSBsaTpob3ZlciB7IGJhY2tncm91bmQ6Y3lhbjsgY29sb3I6Ymx1ZTsgfQpmaWVsZHNldC53b3JkIHVsLnN0b3J5W2RhdGEtdHlwZT1lbmRtZW51XSB7IGNsZWFyOmJvdGg7IH0KZmllbGRzZXQud29yZCBwLnN0b3J5W2RhdGEtbmFtZT1pbm5lcl0geyBiYWNrZ3JvdW5kLWNvbG9yOiM0YjZjOGE3YTsgcGFkZGluZzo0cHggMTBweDsgYm9yZGVyLWxlZnQ6c29saWQgNHB4IGJsdWU7IG1hcmdpbjoxMHB4IDBweDsgfQpmaWVsZHNldC53b3JkIHAuc3RvcnlbZGF0YS1uYW1lPWlubmVyXTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6I2MxMGM4YTsgY3Vyc29yOmNvcHk7IH0KZmllbGRzZXQud29yZCBzdmcuc3RvcnkgeyBkaXNwbGF5OmJsb2NrOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LndvcmQgc3ZnLnN0b3J5IHsgZm9udC1mYW1pbHk6ZmFuZ3Nvbmc7IH0KZmllbGRzZXQud29yZCB2aWRlby5zdG9yeSB7IG1heC1oZWlnaHQ6MzIwcHg7IH0KZmllbGRzZXQud29yZCBmaWVsZHNldC5zdG9yeSB7IG1hcmdpbjoxMHB4OyB9CgpmaWVsZHNldC53b3JkLmZsb2F0IHsgcGFkZGluZzowOyBtYXJnaW46MDsgd2lkdGg6LXdlYmtpdC1maWxsLWF2YWlsYWJsZTsgcG9zaXRpb246Zml4ZWQ7IGxlZnQ6MDsgdG9wOjA7IHotaW5kZXg6MTA7IH0KZmllbGRzZXQud29yZC5mbG9hdD5kaXYuYWN0aW9uIHsgZGlzcGxheTpjb250ZW50czsgfQpmaWVsZHNldC53b3JkLmZsb2F0PmRpdi5zdGF0dXMgeyBjbGVhcjpub25lOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQ+ZGl2Lm91dHB1dCB7IGJhY2tncm91bmQtY29sb3I6I2YwZjhmZjgwOyBwYWRkaW5nOjIwcHg7IG92ZXJmbG93OmF1dG87IH0KZmllbGRzZXQud29yZC5mbG9hdD5kaXYub3V0cHV0PmRpdi5wcm9qZWN0IHsgYmFja2dyb3VuZDpjb3Juc2lsazsgcGFkZGluZzoxMHB4OyBwb3NpdGlvbjpmaXhlZDsgcmlnaHQ6MDsgdG9wOjI1cHg7IHotaW5kZXg6MTAwOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQgZGl2LmNvbnRlbnQgZGl2LnBhZ2UgeyBtYXJnaW4tdG9wOjMwcHg7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC53b3JkLmZsb2F0IGRpdi5jb250ZW50IGRpdi5wYWdlLnNob3cgeyBkaXNwbGF5OmJsb2NrOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQgZGl2LmNvbnRlbnQuZ3JpZCBkaXYucGFnZSB7IGJhY2tncm91bmQtY29sb3I6I2E0Y2JlY2I1OyBtYXJnaW46MTBweDsgaGVpZ2h0OjIwMHB4OyB3aWR0aDoyMDBweDsgb3ZlcmZsb3c6YXV0bzsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC53b3JkLmZsb2F0IGgxIHsgdGV4dC1hbGlnbjpjZW50ZXI7IH0KZmllbGRzZXQud29yZC5mbG9hdCBoMiB7IHRleHQtYWxpZ246Y2VudGVyOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQgaDMgeyB0ZXh0LWFsaWduOmNlbnRlcjsgfQoKZmllbGRzZXQucGFuZWwuY21kIGZpZWxkc2V0LndvcmQ+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZCBmaWVsZHNldC53b3JkPmZvcm0ub3B0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZCBmaWVsZHNldC53b3JkPmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQucGFuZWwuY21kIGZpZWxkc2V0LndvcmQ+ZGl2LnN0YXR1cyB7IGRpc3BsYXk6bm9uZTsgfQoKZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya11bZGF0YS1uYW1lPXNoZWxsXSBsYWJlbCB7CgktbW96LXVzZXItc2VsZWN0Om5vbmU7IC8q54Gr54uQKi8KCS13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsgLyp3ZWJraXTmtY/op4jlmagqLwoJLW1zLXVzZXItc2VsZWN0Om5vbmU7IC8qSUUxMCovCgkta2h0bWwtdXNlci1zZWxlY3Q6bm9uZTsgLyrml6nmnJ/mtY/op4jlmagqLwoJdXNlci1zZWxlY3Q6bm9uZTsKfQoKCmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgaW5wdXQuY3VycmVudCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMwMDAwMDAwMDsgY29sb3I6IzAwMDAwMDAwOyBmb250LXNpemU6MWVtOyBmb250LWZhbWlseTptb25vc3BhY2U7CglwYWRkaW5nOjA7IHBhZGRpbmctbGVmdDoxMXB4OyBib3JkZXI6bm9uZTsgb3V0bGluZTpub25lOyBtYXJnaW46MDsgbWFyZ2luLXRvcDotMXB4OwogCWhlaWdodDoyMnB4OyBwb3NpdGlvbjphYnNvbHV0ZTsKfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQubm9ybWFsIHsgY2FyZXQtY29sb3I6Z3JheTsgfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQuaW5zZXJ0IHsgY2FyZXQtY29sb3I6eWVsbG93OyB9CgpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB7CgloZWlnaHQ6MjBweDsgcG9zaXRpb246YWJzb2x1dGU7IGxlZnQ6MzJweDsgbWFyZ2luLXRvcDoyMHB4OwoJZGlzcGxheTpub25lOwp9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlLmluc2VydCB7CglkaXNwbGF5OmJsb2NrOwp9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlIGRpdi5wcmUgewoJZm9udC1zaXplOjEuMXJlbTsgY29sb3I6I2YwZjhmZjAwOyBtYXJnaW4tbGVmdDo1cHg7IGZsb2F0OmxlZnQ7Cn0KZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBkaXYuY29tcGxldGUgdGFibGUgewoJYmFja2dyb3VuZDpsaWdodGJsdWU7IG1heC1oZWlnaHQ6NDAwcHg7IG1heC13aWR0aDo4MDBweDsgb3ZlcmZsb3c6YXV0bzsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsKfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB0YWJsZS5jb250ZW50IHRoIHsKCWRpc3BsYXk6bm9uZTsKfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB0YWJsZS5jb250ZW50IHRkIHsKCWZvbnQtc2l6ZToxLjFyZW07Cn0KCmJvZHkuc2ltcGxlIGZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlIGRpdi5wcmUgewoJZm9udC1zaXplOjFyZW07Cn0KYm9keS5zaW1wbGUgZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBkaXYuY29tcGxldGUgdGFibGUuY29udGVudCB0ZCB7Cglmb250LXNpemU6MXJlbTsKfQoKYm9keS53aGl0ZSBmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQuaW5zZXJ0IHsgY2FyZXQtY29sb3I6YmxhY2s7IH0KYm9keS53aGl0ZSBmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGlucHV0LmN1cnJlbnQubm9ybWFsIHsgY2FyZXQtY29sb3I6bGlnaHRncmF5OyB9CgpmaWVsZHNldC5wbGFuPmRpdi5vdXRwdXQgdGQgeyB2ZXJ0aWNhbC1hbGlnbjp0b3A7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IHRkLm92ZXIgeyBib3JkZXI6c29saWQgMnB4IHJlZDsgfQpmaWVsZHNldC5wbGFuPmRpdi5vdXRwdXQgdGQgZGl2LmRhdGUgeyBjb2xvcjpncmF5OyB9CmZpZWxkc2V0LnBsYW4+ZGl2Lm91dHB1dCBkaXYucHJlcGFyZSB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgY29sb3I6d2hpdGU7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IGRpdi5wcm9jZXNzIHsgYmFja2dyb3VuZC1jb2xvcjpncmVlbjsgY29sb3I6d2hpdGU7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IGRpdi5jYW5jZWwgeyBiYWNrZ3JvdW5kLWNvbG9yOnllbGxvdzsgY29sb3I6d2hpdGU7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IGRpdi5maW5pc2ggeyBiYWNrZ3JvdW5kLWNvbG9yOnJlZDsgY29sb3I6d2hpdGU7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQucGxhbj5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CgpkaXYub3V0cHV0LmZvcm0gZGl2Lml0ZW0gewoJcGFkZGluZzo0MHB4Owp9CgpmaWVsZHNldC5kcmF3LnNwaWRlIGRpdi5vdXRwdXQgZGl2LnRvZ2dsZSB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5kcmF3LnNwaWRlIGRpdi5vdXRwdXQgZGl2LnRvZ2dsZS5wcm9qZWN0IHsgZGlzcGxheTpibG9jazsgfQoKZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzAwMDA7IH0KZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbSBkaXYuaXRlbSB7IHBhZGRpbmctbGVmdDoxNXB4OyBib3JkZXI6c29saWQgMXB4ICMwMDAwMDAwZDsgYm9yZGVyLWxlZnQ6ZGFzaGVkIDFweCBsaWdodGJsdWU7IG1hcmdpbi1sZWZ0OjVweDsgfQpmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIGRpdi5pdGVtOmhvdmVyIHsgYm9yZGVyOnNvbGlkIDFweCByZWQ7IH0KZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbSBzcGFuLm5vbmNlIHsgY29sb3I6IzljYmVjYTRmOyBjdXJzb3I6cG9pbnRlcjsgfQpmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIHNwYW4ua2V5IHsgY29sb3I6eWVsbG93OyB9CmZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5zdHJpbmcgeyBjb2xvcjptYWdlbnRhOyB9CmZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5jb25zdCB7IGNvbG9yOmN5YW47IH0KCgpmaWVsZHNldC5kaXYgZGl2Lm91dHB1dCB0ZCB7IHZlcnRpY2FsLWFsaWduOnRvcDsgfQpmaWVsZHNldC5kaXYgZGl2Lm91dHB1dCBmaWVsZHNldC5zcGFuPmZpZWxkc2V0IHsgb3ZlcmZsb3c6YXV0bzsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5wYW5lbC5jbWQubWFpbiBmaWVsZHNldC5kaXY+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZC5tYWluIGZpZWxkc2V0LmRpdj5mb3JtLm9wdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5wYW5lbC5jbWQubWFpbiBmaWVsZHNldC5kaXY+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5wYW5lbC5jbWQubWFpbiBmaWVsZHNldC5kaXYgZGl2LnByb2plY3QgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQucGFuZWwuY21kLm1haW4gZmllbGRzZXQuZGl2IGRpdi5wcm9maWxlIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LndvcmQ+ZGl2Lm91dHB1dCBmaWVsZHNldC5zcGFuPmZpZWxkc2V0IHsgb3ZlcmZsb3c6YXV0bzsgZmxvYXQ6bGVmdDsgfQoKZmllbGRzZXQuZHJhdyBkaXYub3V0cHV0IHsgYmFja2dyb3VuZC1jb2xvcjojMWI1YjczOGM7IGZvbnQtc2l6ZToyMHB4OyB9CmZpZWxkc2V0LmRyYXcgZGl2Lm91dHB1dCBkaXYuY29udGVudCBzdmcgeyBiYWNrZ3JvdW5kLWNvbG9yOiMxYjViNzM4YzsgfQpmaWVsZHNldC5kcmF3IGRpdi5vdXRwdXQgZGl2LmRpc3BsYXkgeyBtYXgtaGVpZ2h0OjQwMHB4OyB9CgpmaWVsZHNldC5mZWVsIGRpdi5vdXRwdXQgaW1nIHsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5mZWVsIGRpdi5vdXRwdXQgdmlkZW8geyBkaXNwbGF5OmJsb2NrOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LmZlZWwuZmxvYXQgeyBiYWNrZ3JvdW5kLWNvbG9yOiM0ZWFhZDBjMjsgcG9zaXRpb246YWJzb2x1dGU7IH0KZmllbGRzZXQuZmVlbC5mbG9hdD5sZWdlbmQgeyBkaXNwbGF5Om5vbmU7IH0KCmZpZWxkc2V0LmlucHV0LmRhdGUgZGl2LmFjdGlvbiB7IGhlaWdodDo0cmVtOyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgZGl2LmFjdGlvbiBkaXYuc3BhY2UgeyB3aWR0aDowOyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgZGl2Lm91dHB1dCB0ZC5wcmV2IHsgY29sb3I6Z3JheTsgfQpmaWVsZHNldC5pbnB1dC5kYXRlIGRpdi5vdXRwdXQgdGQubmV4dCB7IGNvbG9yOmdyYXk7IH0KZmllbGRzZXQuaW5wdXQuZGF0ZSBkaXYub3V0cHV0IHRkIHsgcGFkZGluZzoycHggMTFweDsgfQpmaWVsZHNldC5pbnB1dC5kYXRlIHRhYmxlIHsgdGV4dC1hbGlnbjpjZW50ZXI7IHdpZHRoOjI4MHB4OyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgdGFibGUgdGQuc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgdGFibGUgdGQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbnB1dC5kYXRlIHRhYmxlIHsgY29sb3I6d2hpdGU7IH0KCgpmaWVsZHNldC5kcmF3LnRyZW5kIGRpdi5vdXRwdXQgZGl2LnRvZ2dsZSB7IGRpc3BsYXk6bm9uZTsgfQoKCg==",
        "/page/can.js": "dmFyIGtpdCA9IHsKCURpY3Q6IGZ1bmN0aW9uKCkgeyB2YXIgcmVzID0ge30KCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgKz0gMikgewoJCQlyZXNbYXJndW1lbnRzW2ldXSA9IGFyZ3VtZW50c1tpKzFdCgkJfSByZXR1cm4gcmVzCgl9Cn0KdmFyIGljZSA9IHsKCVRCOiAiXHQiLCBTUDogIiAiLCBERjogIjoiLCBFUTogIj0iLCBBVDogIkAiLCBQUzogIi8iLCBQVDogIi4iLCBGUzogIiwiLCBOTDogIlxuIiwgTFQ6ICI8IiwgR1Q6ICI+IiwKCU9LOiAib2siLCBUUlVFOiAidHJ1ZSIsIEZBTFNFOiAiZmFsc2UiLCBTVUNDRVNTOiAic3VjY2VzcyIsIEZBSUxVUkU6ICJmYWlsdXJlIiwgUFJPQ0VTUzogInByb2Nlc3MiLAoKCUFVVE86ICJhdXRvIiwgTElTVDogImxpc3QiLCBCQUNLOiAiYmFjayIsIEVYRUM6ICJleGVjIiwKCVNIT1c6ICJzaG93IiwgSElERTogImhpZGUiLCBIRUxQOiAiaGVscCIsIEhUVFA6ICJodHRwIiwKCVZJRVc6ICJ2aWV3IiwgTU9ERTogIm1vZGUiLCBTSElQOiAic2hpcCIsIENPUFk6ICJjb3B5IiwKCglQT0Q6ICJwb2QiLCBDVFg6ICJjdHgiLCBDTUQ6ICJjbWQiLCBBUkc6ICJhcmciLCBSRVM6ICJyZXMiLAoJUlVOOiAicnVuIiwgRVJSOiAiZXJyIiwgT1BUOiAib3B0IiwKCVBXRDogIi4vIiwKCglNU0dfREVUQUlMOiAiZGV0YWlsIiwKCU1TR19PUFRJT046ICJvcHRpb24iLAoJTVNHX0FQUEVORDogImFwcGVuZCIsCglNU0dfUkVTVUxUOiAicmVzdWx0IiwKCU1TR19GSUVMRFM6ICJmaWVsZHMiLAoJTVNHX1NFU1NJRDogInNlc3NpZCIsCgoJTVNHX1NPVVJDRTogIl9zb3VyY2UiLAoJTVNHX1RBUkdFVDogIl90YXJnZXQiLAoJTVNHX0hBTkRMRTogIl9oYW5kbGUiLAoJTVNHX1VQTE9BRDogIl91cGxvYWQiLAoJTVNHX0RBRU1PTjogIl9kYWVtb24iLAoJTVNHX0FDVElPTjogIl9hY3Rpb24iLAoJTVNHX1NUQVRVUzogIl9zdGF0dXMiLAoJTVNHX1BSRUZJWDogIl9wcmVmaXgiLAoKCU1TR19ESVNQTEFZOiAiX2Rpc3BsYXkiLAoJTVNHX1BST0NFU1M6ICJfcHJvY2VzcyIsCgoJTVNHX1VTRVJOQU1FOiAidXNlci5uYW1lIiwKCU1TR19VU0VSTklDSzogInVzZXIubmljayIsCgoJTVNHX1RJVExFOiAic2Vzcy50aXRsZSIsCglNU0dfVE9QSUM6ICJzZXNzLnRvcGljIiwKCU1TR19SSVZFUjogInNlc3Mucml2ZXIiLAoJTVNHX1NUT1JNOiAic2Vzcy5zdG9ybSIsCglNU0dfVE9BU1Q6ICJzZXNzLnRvYXN0IiwKCglQUk9DRVNTX0FHQUlOOiAiX2FnYWluIiwKCglFcnJXYXJuOiAid2FybjogIiwKCUVyck5vdExvZ2luOiAibm90IGxvZ2luOiAiLAoJRXJyTm90UmlnaHQ6ICJub3QgcmlnaHQ6ICIsCglFcnJOb3RGb3VuZDogIm5vdCBmb3VuZDogIiwKfQoKdmFyIGN0eCA9IHsKCUNPTlRFWFQ6ICJjb250ZXh0IiwgQ09NTUFORDogImNvbW1hbmQiLCBDT05GSUc6ICJjb25maWciLAoJSU5ERVg6ICJpbmRleCIsIEFSR1M6ICJhcmdzIiwgU1RZTEU6ICJzdHlsZSIsIERJU1BMQVk6ICJkaXNwbGF5IiwgQUNUSU9OOiAiYWN0aW9uIiwKCUlOUFVUUzogImlucHV0cyIsIEZFQVRVUkU6ICJmZWF0dXJlIiwKfQp2YXIgY2xpID0gewoJREFFTU9OOiAiZGFlbW9uIiwKCVNUQVJUOiAic3RhcnQiLCBTVE9QOiAic3RvcCIsIE9QRU46ICJvcGVuIiwgQ0xPU0U6ICJjbG9zZSIsIEJFR0lOOiAiYmVnaW4iLCBFTkQ6ICJlbmQiLAoKCVJFRDogInJlZCIsIEdSRUVOOiAiZ3JlZW4iLCBCTFVFOiAiYmx1ZSIsCglZRUxMT1c6ICJ5ZWxsb3ciLCBDWUFOOiAiY3lhbiIsIFBVUlBMRTogInB1cnBsZSIsIE1BR0VOVEE6ICJtYWdlbnRhIiwKCVdISVRFOiAid2hpdGUiLCBCTEFDSzogImJsYWNrIiwKCglNQUtFOiAibWFrZSIsIE1BSU46ICJtYWluIiwgRVhFQzogImV4ZWMiLCBET05FOiAiZG9uZSIsCglDT0RFOiAiY29kZSIsIENPU1Q6ICJjb3N0IiwgQkFDSzogImJhY2siLCBGUk9NOiAiZnJvbSIsCglFUlJPUjogImVycm9yIiwgQ0xFQVI6ICJjbGVhciIsIFJFRlJFU0g6ICJyZWZyZXNoIiwKCVNIT1c6ICJzaG93IiwKfQp2YXIgbmZzID0gewoJWk1MOiAiem1sIiwgSU1MOiAiaW1sIiwKCUhUTUw6ICJodG1sIiwgQ1NTOiAiY3NzIiwgSlM6ICJqcyIsIEdPOiAiZ28iLCBTSDogInNoIiwgQ1NWOiAiY3N2IiwgSlNPTjogImpzb24iLAoJUEFUSDogInBhdGgiLCBGSUxFOiAiZmlsZSIsIExJTkU6ICJsaW5lIiwgU0laRTogInNpemUiLAoJU0FWRTogInNhdmUiLCBMT0FEOiAibG9hZCIsIFRBR1M6ICJ0YWdzIiwgRklORDogImZpbmQiLCBHUkVQOiAiZ3JlcCIsCglESVI6ICJkaXIiLCBDQVQ6ICJjYXQiLCBERUZTOiAiZGVmcyIsIFRSQVNIOiAidHJhc2giLAoJRElSX1JPT1Q6ICJkaXJfcm9vdCIsCglTQ1JJUFQ6ICJzY3JpcHQiLAp9CnZhciBtZGIgPSB7CglESUNUOiAiZGljdCIsIE1FVEE6ICJtZXRhIiwgSEFTSDogImhhc2giLCBMSVNUOiAibGlzdCIsCgoJSUQ6ICJpZCIsIEtFWTogImtleSIsIFRJTUU6ICJ0aW1lIiwgWk9ORTogInpvbmUiLCBUWVBFOiAidHlwZSIsIE5BTUU6ICJuYW1lIiwgVEVYVDogInRleHQiLAoJTElOSzogImxpbmsiLCBTQ0FOOiAic2NhbiIsIFNIT1c6ICJzaG93IiwgSEVMUDogImhlbHAiLAoJU0hPUlQ6ICJzaG9ydCIsIEZJRUxEOiAiZmllbGQiLCBUT1RBTDogInRvdGFsIiwgQ09VTlQ6ICJjb3VudCIsIExJTUlUOiAibGltaXQiLAoJSU5ERVg6ICJpbmRleCIsIFZBTFVFOiAidmFsdWUiLCBFWFRSQTogImV4dHJhIiwgQUxJQVM6ICJhbGlhcyIsIEVYUElSRTogImV4cGlyZSIsCgoJQ1JFQVRFOiAiY3JlYXRlIiwgUkVNT1ZFOiAicmVtb3ZlIiwgSU5TRVJUOiAiaW5zZXJ0IiwgREVMRVRFOiAiZGVsZXRlIiwKCU1PRElGWTogIm1vZGlmeSIsIFNFTEVDVDogInNlbGVjdCIsCglJTlBVVFM6ICJpbnB1dHMiLCBQUlVORVM6ICJwcnVuZXMiLCBFWFBPUlQ6ICJleHBvcnQiLCBJTVBPUlQ6ICJpbXBvcnQiLAoJVVBMT0FEOiAidXBsb2FkIiwKCglTRUFSQ0g6ICJzZWFyY2giLCBFTkdJTkU6ICJlbmdpbmUiLCBSRU5ERVI6ICJyZW5kZXIiLCBQTFVHSU46ICJwbHVnaW4iLAoJUEFHRTogInBhZ2UiLCBORVhUOiAibmV4dCIsIFBSRVY6ICJwcmV2IiwgTElNSVQ6ICJsaW1pdCIsIE9GRkVORDogIm9mZmVuZCIsCglNQUlOOiAibWFpbiIsCgoJRk9SRUFDSDogIioiLCBSQU5ET01TOiAiJSIsCn0KdmFyIGFhYSA9IHsKCVBBU1NXT1JEOiAicGFzc3dvcmQiLCBVU0VSTkFNRTogInVzZXJuYW1lIiwgVVNFUk5JQ0s6ICJ1c2VybmljayIsIEJBQ0tHUk9VTkQ6ICJiYWNrZ3JvdW5kIiwgQVZBVEFSOiAiYXZhdGFyIiwKCUxBTkdVQUdFOiAibGFuZ3VhZ2UiLCBFTkdMSVNIOiAiZW5nbGlzaCIsIENISU5FU0U6ICJjaGluZXNlIiwKCUxPR0lOOiAibG9naW4iLCBMT0dPVVQ6ICJsb2dvdXQiLCBJTlZJVEU6ICJpbnZpdGUiLAp9CnZhciB3ZWIgPSB7CglTUEFDRTogInNwYWNlIiwgRFJFQU06ICJkcmVhbSIsIFNIQVJFOiAic2hhcmUiLAp9CnZhciB0Y3AgPSB7CglIT1NUOiAiaG9zdCIsIFBPUlQ6ICJwb3J0IiwKfQp2YXIgZ2RiID0gewoJU0lHTkFMOiAic2lnbmFsIiwKfQp2YXIgbGV4ID0gewoJU1BMSVQ6ICJzcGxpdCIsCn0KCnZhciBjb2RlID0gewoJVklNRVI6ICJ2aW1lciIsIElOTkVSOiAiaW5uZXIiLCBGQVZPUjogImZhdm9yIiwKCUFVVE9HRU46ICJhdXRvZ2VuIiwgQ09NUElMRTogImNvbXBpbGUiLCBCSU5QQUNLOiAiYmlucGFjayIsIFdFQlBBQ0s6ICJ3ZWJwYWNrIiwgUFVCTElTSDogInB1Ymxpc2giLAoJS0VZV09SRDogImtleXdvcmQiLAp9CnZhciB3aWtpID0gewoJVElUTEU6ICJ0aXRsZSIsIEJSSUVGOiAiYnJpZWYiLCBSRUZFUjogInJlZmVyIiwgU1BBUks6ICJzcGFyayIsCglPUkRFUjogIm9yZGVyIiwgVEFCTEU6ICJ0YWJsZSIsIENIQVJUOiAiY2hhcnQiLCBJTUFHRTogImltYWdlIiwgVklERU86ICJ2aWRlbyIsCglGSUVMRDogImZpZWxkIiwgU0hFTEw6ICJzaGVsbCIsIExPQ0FMOiAibG9jYWwiLCBQQVJTRTogInBhcnNlIiwKCglOQVZNRU5VOiAibmF2bWVudSIsIFBSRU1FTlU6ICJwcmVtZW51IiwKCglJVEVNOiAiLnN0b3J5IiwKCUgyOiAiaDIuc3RvcnkiLAoJSDM6ICJoMy5zdG9yeSIsCglESVZfUEFHRTogImRpdi5wYWdlIiwKfQp2YXIgY2hhdCA9IHsKCUxJQjogImxpYiIsIFBBR0U6ICJwYWdlIiwgUEFORUw6ICJwYW5lbCIsIFBMVUdJTjogInBsdWdpbiIsIE9VVFBVVDogIm91dHB1dCIsIFNUT1JZOiAic3RvcnkiLCBGTE9BVDogImZsb2F0IiwKCVRPQVNUOiAidG9hc3QiLCBDQVJURTogImNhcnRlIiwgSU5QVVQ6ICJpbnB1dCIsIFVQTE9BRDogInVwbG9hZCIsIENPTlRFWFRTOiAiY29udGV4dHMiLAoJTEVHTkVEOiAibGVnZW5kIiwgT1BUSU9OOiAib3B0aW9uIiwgQUNUSU9OOiAiYWN0aW9uIiwgT1VUUFVUOiAib3V0cHV0IiwgU1RBVFVTOiAic3RhdHVzIiwKCUxBWU9VVDogImxheW91dCIsIFBST0pFQ1Q6ICJwcm9qZWN0IiwgQ09OVEVOVDogImNvbnRlbnQiLCBESVNQTEFZOiAiZGlzcGxheSIsIFBST0ZJTEU6ICJwcm9maWxlIiwKCU9OSU1QT1JUOiAib25pbXBvcnQiLCBPTkFDVElPTjogIm9uYWN0aW9uIiwgT05LRVlNQVA6ICJvbmtleW1hcCIsIE9ORVhQT1JUOiAib25leHBvcnQiLAoKCVRJVExFOiAidGl0bGUiLCBUT1BJQzogInRvcGljIiwgQkxBQ0s6ICJibGFjayIsIFdISVRFOiAid2hpdGUiLCBQUklOVDogInByaW50IiwKCVNIQVJFOiAic2hhcmUiLCBSSVZFUjogInJpdmVyIiwgU1RPUk06ICJzdG9ybSIsIEZJRUxEOiAiZmllbGQiLAoJUFVCTElDOiAicHVibGljIiwgUFJPVEVDVEVEOiAicHJvdGVjdGVkIiwgUFJJVkFURTogInByaXZhdGUiLAoJVVNFUjogInVzZXIiLCBUT09MOiAidG9vbCIsIE5PREU6ICJub2RlIiwKCglBR0VOVDogImFnZW50IiwgQ0hFQ0s6ICJjaGVjayIsIEdSQU5UOiAiZ3JhbnQiLAoJU1RBVEU6ICJzdGF0ZSIsIE1FTlVTOiAibWVudXMiLCBUUkFOUzogInRyYW5zIiwKCVNTTzogInNzbyIsCgoJT05NQUlOOiAib25tYWluIiwgT05MT0dJTjogIm9ubG9naW4iLCBPTlNFQVJDSDogIm9uc2VhcmNoIiwKCU9OU0laRTogIm9uc2l6ZSIsIE9OVE9BU1Q6ICJvbnRvYXN0IiwgT05SRU1PVEU6ICJvbnJlbW90ZSIsCglPTktFWURPV046ICJvbmtleWRvd24iLAoKCVdFQlNJVEU6ICJ3ZWJzaXRlIiwKCUhFQUQ6ICJoZWFkIiwgTEVGVDogImxlZnQiLCBNQUlOOiAibWFpbiIsIEFVVE86ICJhdXRvIiwgSElERTogImhpZGUiLCBGT09UOiAiZm9vdCIsCglIRUFERVI6ICJoZWFkZXIiLCBGT09URVI6ICJmb290ZXIiLAogICAgQUNUSU9OX0xBWU9VVF9GTVQ6IGAKZmllbGRzZXQuQWN0aW9uLmdyaWQ+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4gewogICAgd2lkdGg6X3dpZHRoOyBoZWlnaHQ6X2hlaWdodDsKfQpmaWVsZHNldC5BY3Rpb24uZ3JpZD5kaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbj5kaXYub3V0cHV0IHsKICAgIHdpZHRoOl93aWR0aDsgaGVpZ2h0Ol9oZWlnaHQ7Cn0KYCwKCglQTFVHSU5fU1RBVEVfSlM6ICIvcGx1Z2luL3N0YXRlLmpzIiwKCVBMVUdJTl9JTlBVVF9KUzogIi9wbHVnaW4vaW5wdXQuanMiLAoJUExVR0lOX1RBQkxFX0pTOiAiL3BsdWdpbi90YWJsZS5qcyIsCgoJbGliczogWyIvbGliL2Jhc2UuanMiLCAiL2xpYi9jb3JlLmpzIiwgIi9saWIvbWlzYy5qcyIsICIvbGliL3BhZ2UuanMiLCAiL2xpYi91c2VyLmpzIl0sCglwYW5lbF9saXN0OiBbCgkJe25hbWU6ICJIZWFkZXIiLCBoZWxwOiAi5qCH6aKY5qCPIiwgcG9zOiAiaGVhZCIsIHN0YXRlOiBbInRpbWUiLCAidXNlcm5pY2siLCAiYXZhdGFyIl19LAoJCXtuYW1lOiAiUml2ZXIiLCAgaGVscDogIue+pOiBiue7hCIsIHBvczogImxlZnQiLCBhY3Rpb246IFsiY3JlYXRlIiwgInJlZnJlc2giXX0sCgkJe25hbWU6ICJBY3Rpb24iLCBoZWxwOiAi5bel5L2c5Y+wIiwgcG9zOiAibWFpbiJ9LAoJCXtuYW1lOiAiU2VhcmNoIiwgaGVscDogIuaQnOe0ouahhiIsIHBvczogImF1dG8ifSwKCQl7bmFtZTogIkZvb3RlciIsIGhlbHA6ICLnirbmgIHmnaEiLCBwb3M6ICJmb290Iiwgc3RhdGU6IFsibmNtZCJdfSwKCV0sCglwbHVnaW5fbGlzdDogWwoJCSIvcGx1Z2luL3N0YXRlLmpzIiwKCQkiL3BsdWdpbi9pbnB1dC5qcyIsCgkJIi9wbHVnaW4vdGFibGUuanMiLAoJCSIvcGx1Z2luL2lucHV0L2tleS5qcyIsCgkJIi9wbHVnaW4vaW5wdXQvZGF0ZS5qcyIsCgkJIi9wbHVnaW4vc3Rvcnkvc3BpZGUuanMiLAoJCSIvcGx1Z2luL3N0b3J5L3RyZW5kLmpzIiwKCQkiL3BsdWdpbi9sb2NhbC9jb2RlL2lubmVyLmpzIiwKCQkiL3BsdWdpbi9sb2NhbC9jb2RlL3ZpbWVyLmpzIiwKCQkiL3BsdWdpbi9sb2NhbC93aWtpL2RyYXcvcGF0aC5qcyIsCgkJIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmpzIiwKCQkiL3BsdWdpbi9sb2NhbC93aWtpL3dvcmQuanMiLAoJCSIvcGx1Z2luL2xvY2FsL2NoYXQvZGl2LmpzIiwKCQkiL3BsdWdpbi9sb2NhbC90ZWFtL3BsYW4uanMiLAoJCSIvcGx1Z2luL2lucHV0L3Byb3ZpbmNlLmpzIiwKCV0sCn0KdmFyIHRlYW0gPSB7CglUQVNLOiAidGFzayIsIFBMQU46ICJwbGFuIiwKfQp2YXIgbWFsbCA9IHsKCUFTU0VUOiAiYXNzZXQiLCBTQUxBUlk6ICJzYWxhcnkiLAp9Cgp2YXIgc3ZnID0gewoJRzogImciLCBYOiAieCIsIFk6ICJ5IiwgUjogInIiLCBSWDogInJ4IiwgUlk6ICJyeSIsCglMSU5FOiAibGluZSIsIFJFQ1Q6ICJyZWN0IiwgVEVYVDogInRleHQiLAoJTTogIk0iLCBROiAiUSIsIFQ6ICJUIiwKCVBBVEgyVjogInBhdGgydiIsIFBBVEgySDogInBhdGgyaCIsCn0KdmFyIGh0bWwgPSB7CglGSUVMRFNFVDogImZpZWxkc2V0IiwgTEVHRU5EOiAibGVnZW5kIiwgT1BUSU9OOiAib3B0aW9uIiwgQUNUSU9OOiAiYWN0aW9uIiwgT1VUUFVUOiAib3V0cHV0IiwgU1RBVFVTOiAic3RhdHVzIiwKCUZPUk1fT1BUSU9OOiAiZm9ybS5vcHRpb24iLCBESVZfQUNUSU9OOiAiZGl2LmFjdGlvbiIsIERJVl9PVVRQVVQ6ICJkaXYub3V0cHV0IiwgRElWX1NUQVRVUzogImRpdi5zdGF0dXMiLAoJRklFTERTRVRfUEFORUw6ICJmaWVsZHNldC5wYW5lbCIsIEZJRUxEU0VUX1BMVUdJTjogImZpZWxkc2V0LnBsdWdpbiIsIEZJRUxEU0VUX1NUT1JZOiAiZmllbGRzZXQuc3RvcnkiLAoKCUZJRUxEU0VUX0hFQUQ6ICJmaWVsZHNldC5oZWFkIiwgRklFTERTRVRfRk9PVDogImZpZWxkc2V0LmZvb3QiLAoJRklFTERTRVRfTEVGVDogImZpZWxkc2V0LmxlZnQiLCBGSUVMRFNFVF9NQUlOOiAiZmllbGRzZXQubWFpbiIsCglGSUVMRFNFVF9BVVRPOiAiZmllbGRzZXQuYXV0byIsIEZJRUxEU0VUX0ZMT0FUOiAiZmllbGRzZXQuZmxvYXQiLAoKCU9QVElPTl9BUkdTOiAic2VsZWN0LmFyZ3MsaW5wdXQuYXJncyx0ZXh0YXJlYS5hcmdzIiwKCUlOUFVUX0FSR1M6ICJpbnB1dC5hcmdzLHRleHRhcmVhLmFyZ3MiLAoJSU5QVVRfQlVUVE9OOiAiaW5wdXRbdHlwZT1idXR0b25dIiwKCglVUExPQUQ6ICJ1cGxvYWQiLCBVU0VSTkFNRTogInVzZXJuYW1lIiwgUEFTU1dPUkQ6ICJwYXNzd29yZCIsCglJTlBVVDogImlucHV0IiwgVEVYVDogInRleHQiLCBURVhUQVJFQTogInRleHRhcmVhIiwgU0VMRUNUOiAic2VsZWN0IiwgQlVUVE9OOiAiYnV0dG9uIiwKCUZPUk06ICJmb3JtIiwgRklMRTogImZpbGUiLCBTUEFDRTogInNwYWNlIiwgQ0xJQ0s6ICJjbGljayIsIFNVQk1JVDogInN1Ym1pdCIsIENBTkNFTDogImNhbmNlbCIsCglESVY6ICJkaXYiLCBJTUc6ICJpbWciLCBDT0RFOiAiY29kZSIsIFNQQU46ICJzcGFuIiwgVklERU86ICJ2aWRlbyIsCglUQUJMRTogInRhYmxlIiwgVEJPRFk6ICJ0Ym9keSIsIFRSOiAidHIiLCBUSDogInRoIiwgVEQ6ICJ0ZCIsIEJSOiAiYnIiLCBVTDogInVsIiwgTEk6ICJsaSIsCglBOiAiYSIsIExBQkVMOiAibGFiZWwiLCBJTk5FUjogImlubmVyIiwgVElUTEU6ICJ0aXRsZSIsCglIMTogImgxIiwgSDI6ICJoMiIsIEgzOiAiaDMiLAoKCUNMQVNTOiAiY2xhc3MiLCBGTE9BVDogImZsb2F0IiwgQ0xFQVI6ICJjbGVhciIsIEJPVEg6ICJib3RoIiwKCUJBQ0tHUk9VTkQ6ICJiYWNrZ3JvdW5kIiwgU0VMRUNUOiAic2VsZWN0IiwgSElEREVOOiAiaGlkZGVuIiwKCURJU1BMQVk6ICJkaXNwbGF5IiwgQkxPQ0s6ICJibG9jayIsIE5PTkU6ICJub25lIiwgRklYRUQ6ICJmaXhlZCIsCglPUEFDSVRZOiAib3BhY2l0eSIsCglTVFJPS0VfV0lEVEg6ICJzdHJva2Utd2lkdGgiLCBTVFJPS0U6ICJzdHJva2UiLCBGSUxMOiAiZmlsbCIsIEZPTlRfU0laRTogImZvbnQtc2l6ZSIsIE1PTk9TUEFDRTogIm1vbm9zcGFjZSIsCglTQ1JPTEw6ICJzY3JvbGwiLCBIRUlHSFQ6ICJoZWlnaHQiLCBXSURUSDogIndpZHRoIiwgTEVGVDogImxlZnQiLCBUT1A6ICJ0b3AiLCBSSUdIVDogInJpZ2h0IiwgQk9UVE9NOiAiYm90dG9tIiwKCU1JTl9IRUlHSFQ6ICJtaW4taGVpZ2h0IiwgTUFYX0hFSUdIVDogIm1heC1oZWlnaHQiLCBNQVhfV0lEVEg6ICJtYXgtd2lkdGgiLCBNQVJHSU5fVE9QOiAibWFyZ2luLXRvcCIsIE1BUkdJTl9YOiAibWFyZ2luLXgiLCBNQVJHSU5fWTogIm1hcmdpbi15IiwKCVBMVUdJTl9NQVJHSU46IDEwLCBBQ1RJT05fSEVJR0hUOiAyOSwgQUNUSU9OX01BUkdJTjogMjAwLAoJVE9HR0xFOiAidG9nZ2xlIiwKCglXU1M6ICJ3c3MiLCBTVkc6ICJzdmciLCBDQU5WQVM6ICJjYW52YXMiLCBJRlJBTUU6ICJpZnJhbWUiLCBDSFJPTUU6ICJjaHJvbWUiLAoJTElTVDogImxpc3QiLCBJVEVNOiAiaXRlbSIsIE1FTlU6ICJtZW51IiwgTk9ERTogIm5vZGUiLAoJRElWX0lURU06ICJkaXYuaXRlbSIsIERJVl9GTE9BVDogImRpdi5mbG9hdCIsCglUQUJTOiAidGFicyIsIERJVl9UQUJTOiAiZGl2LnRhYnMiLAoJSElERTogImhpZGUiLCBTSE9XOiAic2hvdyIsCgoJSEVBRDogImhlYWQiLCBMRUZUOiAibGVmdCIsIE1BSU46ICJtYWluIiwgRk9PVDogImZvb3QiLAoJVEFCUzogInRhYnMiLCBNRU5VOiAibWVudSIsCglMSVNUOiAibGlzdCIsIElURU06ICJpdGVtIiwKCVBBR0U6ICJwYWdlIiwKCUhJREU6ICJoaWRlIiwKCUxBWU9VVDogImxheW91dCIsCglQTFVHSU46ICJwbHVnaW4iLAoJRElWX1BBR0U6ICJkaXYucGFnZSIsCglESVZfTElTVDogImRpdi5saXN0IiwKCURJVl9JVEVNOiAiZGl2Lml0ZW0iLAoJRElWX0xBWU9VVF9IRUFEOiAiZGl2LmxheW91dC5oZWFkIiwKCURJVl9MQVlPVVRfTEVGVDogImRpdi5sYXlvdXQubGVmdCIsCglESVZfTEFZT1VUX0ZPT1Q6ICJkaXYubGF5b3V0LmZvb3QiLAoKCUVTQ0FQRTogIkVzY2FwZSIsIEVOVEVSOiAiRW50ZXIiLCBUQUI6ICJUYWIiLAp9CnZhciBsYW5nID0gewoJVU5ERUZJTkVEOiAidW5kZWZpbmVkIiwKCVNUUklORzogInN0cmluZyIsIE5VTUJFUjogIm51bWJlciIsCglPQkpFQ1Q6ICJvYmplY3QiLCBGVU5DVElPTjogImZ1bmN0aW9uIiwKCUVTQ0FQRTogIkVzY2FwZSIsIEVOVEVSOiAiRW50ZXIiLCBUQUI6ICJUYWIiLAoJQ09OVFJPTDogIkNvbnRyb2wiLCBTSElGVDogIlNoaWZ0IiwKCVBTOiAiLyIsCn0KZnVuY3Rpb24gc2h5KGhlbHAsIG1ldGEsIGxpc3QsIGNiKSB7Cgl2YXIgaW5kZXggPSAwLCBhcmdzID0gYXJndW1lbnRzOyBmdW5jdGlvbiBuZXh0KHR5cGUpIHsKCQlpZiAoaW5kZXggPCBhcmdzLmxlbmd0aCAmJiAoIXR5cGUgfHwgdHlwZSA9PSB0eXBlb2YgYXJnc1tpbmRleF0pKSB7IHJldHVybiBhcmdzW2luZGV4KytdIH0KCX0KCgljYiA9IGFyZ3NbYXJncy5sZW5ndGgtMV18fGZ1bmN0aW9uKCkge30KCWNiLmhlbHAgPSBuZXh0KGxhbmcuU1RSSU5HKXx8IiIKCWNiLm1ldGEgPSBuZXh0KGxhbmcuT0JKRUNUKXx8e30KCWNiLmxpc3QgPSBuZXh0KGxhbmcuT0JKRUNUKXx8W10KCXJldHVybiBjYgp9OyB2YXIgX2Nhbl9uYW1lID0gIiIsIF9jYW5fcGF0aCA9ICIiCnZhciBWb2xjYW5vcyA9IHNoeSgi54Gr5bGx5p62Iiwge2ljZWJlcmc6ICIvY2hhdC8iLCB2b2xjYW5vOiAiL2ZyYW1lLmpzIiwgYXJnczoge30sIHBhY2s6IHt9LCBsaWJzOiBbXSwgY2FjaGU6IHt9fSwgZnVuY3Rpb24obmFtZSwgY2FuLCBsaWJzLCBjYikgewoJdmFyIG1ldGEgPSBhcmd1bWVudHMuY2FsbGVlLm1ldGEsIGxpc3QgPSBhcmd1bWVudHMuY2FsbGVlLmxpc3QKCWlmICh0eXBlb2YgbmFtZSA9PSBsYW5nLk9CSkVDVCkgeyB2YXIgQ29uZmlnID0gbmFtZTsgQ29uZmlnLnBsdWdpbiA9IENvbmZpZy5wbHVnaW58fGNoYXQucGx1Z2luX2xpc3QKCQlDb25maWcucGFuZWxzID0gQ29uZmlnLnBhbmVsc3x8Y2hhdC5wYW5lbF9saXN0LCBDb25maWcubWFpbiA9IENvbmZpZy5tYWlufHx7bmFtZTogIkhlYWRlciJ9CgkJbWV0YS5saWJzID0gQ29uZmlnLmxpYnN8fGNoYXQubGlicywgbWV0YS5pY2ViZXJnID0gQ29uZmlnLmljZWJlcmd8fG1ldGEuaWNlYmVyZwoKCQkvLyDpooTliqDovb0KCQlsaWJzID0gW107IGZvciAodmFyIGkgPSAwOyBpIDwgQ29uZmlnLnBhbmVscy5sZW5ndGg7IGkrKykgeyB2YXIgcGFuZWwgPSBDb25maWcucGFuZWxzW2ldCgkJCXBhbmVsICYmIChsaWJzID0gbGlicy5jb25jYXQocGFuZWwubGlzdCA9IHBhbmVsLmxpc3R8fFsiL3BhbmVsLyIrcGFuZWwubmFtZSsiLmNzcyIsICIvcGFuZWwvIitwYW5lbC5uYW1lKyIuanMiXSkpCgkJfTsgbGlicyA9IGxpYnMuY29uY2F0KENvbmZpZy5wbHVnaW4sIENvbmZpZy5tYWluLmxpc3R8fFtdKQoKCQkvLyDmoLnmqKHlnZcKCQlfY2FuX25hbWUgPSAiIiwgbmFtZSA9IENvbmZpZy5uYW1lfHwiY2hhdCIsIGNiID0gY2FufHxmdW5jdGlvbihjYW4pIHsKCQkJY2FuLm9uZW5naW5lLl9pbml0KGNhbiwgY2FuLkNvbmYoQ29uZmlnKSwgQ29uZmlnLnBhbmVscywgQ29uZmlnLl9pbml0LCBjYW4uX3RhcmdldCkKCQl9CgkJY2FuID0ge19mb2xsb3c6IG5hbWUsIF90YXJnZXQ6IENvbmZpZy50YXJnZXR8fG1ldGEudGFyZ2V0fSwgY2FuLl9yb290ID0gY2FuCgkJZm9yICh2YXIgayBpbiBDb25maWcpIHsgY2FuW2tdID0gQ29uZmlnW2tdIH0KCX0KCgl2YXIgcHJvdG8gPSB7X19wcm90b19fOiBtZXRhLCBfcGF0aDogX2Nhbl9wYXRoLCBfbmFtZTogbmFtZSwgX2xvYWQ6IGZ1bmN0aW9uKG5hbWUsIGVhY2gpIHsgLy8g5Yqg6L2957yT5a2YCgkJCXZhciBjYWNoZSA9IG1ldGEuY2FjaGVbbmFtZV18fFtdOyBmb3IgKGxpc3QucmV2ZXJzZSgpOyBsaXN0Lmxlbmd0aCA+IDA7IGxpc3QpIHsKCQkJCXZhciBzdWIgPSBsaXN0LnBvcCgpOyBzdWIgIT0gY2FuICYmIGNhY2hlLnB1c2goc3ViKQoJCQl9OyBtZXRhLmNhY2hlW25hbWVdID0gY2FjaGUKCgkJCS8vIOWKoOi9veaooeWdlwoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGNhY2hlLmxlbmd0aDsgaSsrKSB7IHZhciBzdWIgPSBjYWNoZVtpXSwgbmFtZSA9IHN1Yi5fbmFtZQoJCQkJaWYgKHR5cGVvZiBlYWNoID09IGxhbmcuRlVOQ1RJT04gJiYgZWFjaChjYW4sIG5hbWUsIHN1YikpIHsgY29udGludWUgfQoJCQkJIWNhbltuYW1lXSAmJiAoY2FuW25hbWVdID0ge30pOyBmb3IgKHZhciBrIGluIHN1YikgewoJCQkJCWNhbltuYW1lXS5oYXNPd25Qcm9wZXJ0eShrKSB8fCAoY2FuW25hbWVdW2tdID0gc3ViW2tdKQoJCQkJfQoJCQl9CgkJfSwKCQlyZXF1aXJlOiBmdW5jdGlvbihsaWJzLCBjYiwgZWFjaCkgeyBpZiAoIWxpYnMgfHwgbGlicy5sZW5ndGggPT0gMCkgewoJCQkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2IoY2FuKSB9LCAxMCkKCQkJCXJldHVybiAvLyDliqDovb3lrozmiJAKCQkJfQoKCQkJLy8g5peg5pWI5Zyw5Z2ACgkJCWlmICghbGlic1swXSkgeyByZXR1cm4gY2FuLnJlcXVpcmUobGlicy5zbGljZSgxKSwgY2IsIGVhY2gpIH0KCgkJCS8vIOihpeWFqOWcsOWdgAoJCQlpZiAobGlic1swXSA9PSAiIikgewoJCQkJbGlic1swXSA9IGNhbi5fbmFtZS5yZXBsYWNlKCIuanMiLCAiLmNzcyIpCgkJCX0gZWxzZSBpZiAobGlic1swXVswXSAhPSBpY2UuUFMgJiYgbGlic1swXS5pbmRleE9mKGljZS5IVFRQKSAhPSAwKSB7CgkJCQlsaWJzWzBdID0gY2FuLl9uYW1lLnNsaWNlKDAsIGNhbi5fbmFtZS5sYXN0SW5kZXhPZihpY2UuUFMpKzEpK2xpYnNbMF0KCQkJfQoKCQkJLy8g5Yqg6L295qih5Z2XCgkJCWxpYnNbMF0gPSBsaWJzWzBdLnRvTG93ZXJDYXNlKCkKCQkJdmFyIG5hbWUgPSBsaWJzWzBdLnNwbGl0KCI/IilbMF0KCQkJZnVuY3Rpb24gbmV4dCgpIHsgY2FuLl9sb2FkKG5hbWUsIGVhY2gpLCBjYW4ucmVxdWlyZShsaWJzLnNsaWNlKDEpLCBjYiwgZWFjaCkgfQoJCQltZXRhLmNhY2hlW25hbWVdPyBuZXh0KCk6IChfY2FuX3BhdGggPSBsaWJzWzBdLCBtZXRhLl9sb2FkKG5hbWUsIG5leHQpKQoJCX0sCgkJcmVxdWVzdDogZnVuY3Rpb24oZXZlbnQsIG9wdGlvbikgeyBldmVudCA9IGV2ZW50fHx7fQoJCQl2YXIgbXNnID0gZXZlbnQuX21zZ3x8Y2FuLm1pc2MuTWVzc2FnZShldmVudCwgY2FuKTsgZXZlbnQuX21zZyA9IG1zZwoJCQlmdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSkgeyBtc2cuT3B0aW9uKGtleSkgfHwgdmFsdWUgPT0gIiIgfHwgbXNnLk9wdGlvbihrZXksIHZhbHVlKSB9CgoJCQljYW4uY29yZS5MaXN0KGFyZ3VtZW50cywgZnVuY3Rpb24ob3B0aW9uLCBpbmRleCkgeyBpZiAoIW9wdGlvbiB8fCBpbmRleCA9PSAwKSB7IHJldHVybiB9IAoJCQkJY2FuLmJhc2UuaXNGdW5jKG9wdGlvbi5PcHRpb24pPyBjYW4uY29yZS5MaXN0KG9wdGlvbi5PcHRpb24oKSwgZnVuY3Rpb24oa2V5KSB7CgkJCQkJc2V0KGtleSwgb3B0aW9uLk9wdGlvbihrZXkpKQoJCQkJfSk6IGNhbi5jb3JlLkl0ZW0oY2FuLmJhc2UuaXNGdW5jKG9wdGlvbik/IG9wdGlvbigpOiBvcHRpb24sIHNldCkKCQkJfSk7IHJldHVybiBtc2cKCQl9LAoJCWFjdGlvbnM6IGZ1bmN0aW9uKGV2ZW50LCBidXR0b24pIHsgY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGJ1dHRvbl0sIG51bGwsIHRydWUpIH0sCgoJCXNlYXJjaDogZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCWlmIChjbWRzICYmIHR5cGVvZiBjbWRzID09IGxhbmcuT0JKRUNUICYmIGNtZHMubGVuZ3RoID4gMCAmJiB0eXBlb2YgY21kc1swXSA9PSBsYW5nLk9CSkVDVCAmJiBjbWRzWzBdLmxlbmd0aCA+IDAgKSB7CgkJCQljbWRzWzBdID0gY21kc1swXS5qb2luKGljZS5QVCkKCQkJfQoJCQlyZXR1cm4gY2FuLnJ1biAmJiBjYW4ucnVuKGV2ZW50LCBbIl9zZWFyY2giXS5jb25jYXQoY21kcyksIGNiLCB0cnVlKQoJCX0sCgkJZ2V0OiBmdW5jdGlvbihuYW1lLCBrZXksIGNiKSB7IHJldHVybiBjYW4uc2VhcmNoKHt9LCBbY2FuLmNvcmUuS2V5cyhuYW1lLCBjaGF0Lk9ORVhQT1JULCBrZXkpXSwgY2IpIH0sCgkJc2V0OiBmdW5jdGlvbihuYW1lLCBrZXksIHZhbHVlKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdCh7fSk7IG1zZy5PcHRpb24oa2V5LCB2YWx1ZSkKCQkJcmV0dXJuIGNhbi5zZWFyY2gobXNnLl9ldmVudCwgW1tuYW1lLCBjaGF0Lk9OSU1QT1JULCBrZXldXSkKCQl9LAoJCXNldEhlYWRlck1lbnU6IGZ1bmN0aW9uKGxpc3QsIGNiKSB7IGNhbi5fbWVudSAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uX21lbnUpCgkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdCh7fSwge3RyYW5zOiBjYW4ub25hY3Rpb24uX3RyYW5zfSkKCQkJcmV0dXJuIGNhbi5fbWVudSA9IGNhbi5zZWFyY2gobXNnLl9ldmVudCwgW1siSGVhZGVyIiwgY2hhdC5PTklNUE9SVCwgIm1lbnUiXSwgY2FuLl9uYW1lXS5jb25jYXQobGlzdCksIGNiKQoJCX0sCgkJc2V0Uml2ZXI6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGNhbi5zZXQoIlJpdmVyIiwga2V5LCB2YWx1ZSkgfSwKCQlzZXRIZWFkZXI6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGNhbi5zZXQoIkhlYWRlciIsIGtleSwgdmFsdWUpIH0sCgkJZ2V0SGVhZGVyOiBmdW5jdGlvbihrZXksIGNiKSB7IHJldHVybiBjYW4uZ2V0KCJIZWFkZXIiLCBrZXksIGNiKSB9LAoJCWdldEFjdGlvbjogZnVuY3Rpb24oa2V5LCBjYikgeyByZXR1cm4gY2FuLmdldCgiQWN0aW9uIiwga2V5LCBjYikgfSwKCQlnZXRBY3Rpb25TaXplOiBmdW5jdGlvbihjYikgeyByZXR1cm4gY2FuLmdldCgiQWN0aW9uIiwgInNpemUiLCBjYikgfSwKCgkJcnVuQWN0aW9uOiBmdW5jdGlvbihldmVudCwgYWN0aW9uLCBhcmdzLCBjYikgewoJCQljYW4ucmVxdWVzdChldmVudCwge19oYW5kbGU6IGljZS5UUlVFfSwgY2FuLk9wdGlvbigpKQoJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgYWN0aW9uXSwgYXJncyksIGNifHxmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4sIGFjdGlvbikKCQkJfSwgdHJ1ZSkKCQl9LAoKCQlDb25mSGVpZ2h0OiBmdW5jdGlvbih2YWx1ZSkgeyByZXR1cm4gY2FuLkNvbmYoaHRtbC5IRUlHSFQsIHZhbHVlKSB9LAoJCUNvbmZXaWR0aDogZnVuY3Rpb24odmFsdWUpIHsgcmV0dXJuIGNhbi5Db25mKGh0bWwuV0lEVEgsIHZhbHVlKSB9LAoJCUNvbmY6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgdmFyIHJlcyA9IGNhbi5fY29uZgoJCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgKz0gMikgewoJCQkJaWYgKHR5cGVvZiBrZXkgPT0gbGFuZy5PQkpFQ1QpIHsKCQkJCQlyZXMgPSBjYW4uY29yZS5WYWx1ZShjYW4uX2NvbmYsIGFyZ3VtZW50c1tpXSksIGktLQoJCQkJCWNvbnRpbnVlCgkJCQl9CgkJCQlyZXMgPSBjYW4uY29yZS5WYWx1ZShjYW4uX2NvbmYsIGFyZ3VtZW50c1tpXSwgYXJndW1lbnRzW2krMV0pCgkJCX0KCQkJaWYgKHJlcyA9PSB1bmRlZmluZWQgJiYga2V5LmluZGV4T2YoImZlYXR1cmUuIikgPT0gLTEpIHsKCQkJCXJldHVybiBjYW4uQ29uZihjYW4uY29yZS5LZXlzKCJmZWF0dXJlIiwga2V5KSkKCQkJfQoJCQlyZXR1cm4gcmVzCgkJfSwgX2NvbmY6IHt9LAoJfQoKCWNhbiA9IGNhbnx8e30sIGNhbi5fX3Byb3RvX18gPSBwcm90bwoKCWlmIChfY2FuX25hbWUpIHsgLy8g5Yqg5YWl57yT5a2YCgkJbWV0YS5jYWNoZVtfY2FuX25hbWVdID0gbWV0YS5jYWNoZVtfY2FuX25hbWVdfHxbXSwgbWV0YS5jYWNoZVtfY2FuX25hbWVdLnB1c2goY2FuKQoJfSBlbHNlIHsgLy8g5Yqg5YWl6Zif5YiXCgkJbGlzdC5wdXNoKGNhbikKCX0KCglpZiAoY2FuLl9mb2xsb3cpIHsgbGlicyA9IGxpYnMuY29uY2F0KG1ldGEubGlicywgbWV0YS52b2xjYW5vKSB9CglpZiAobGlicyAmJiBsaWJzLmxlbmd0aCA+IDApIHsKCQlmb3IgKHZhciBpID0gMDsgaSA8IGxpYnMubGVuZ3RoOyBpKyspIHsKCQkJaWYgKGxpYnNbaV0gPT0gdW5kZWZpbmVkKSB7CgoJCQl9IGVsc2UgaWYgKGxpYnNbaV0gPT0gIiIpIHsKCQkJCWxpYnNbaV0gPSBfY2FuX3BhdGgucmVwbGFjZSgiLmpzIiwgIi5jc3MiKQoJCQl9IGVsc2UgaWYgKGxpYnNbaV1bMF0gIT0gaWNlLlBTICYmIGxpYnNbaV0uaW5kZXhPZihpY2UuSFRUUCkgIT0gMCkgewoJCQkJbGlic1tpXSA9IF9jYW5fcGF0aC5zbGljZSgwLCBfY2FuX3BhdGgubGFzdEluZGV4T2YoaWNlLlBTKSsxKStsaWJzW2ldCgkJCX0KCQl9Cgl9CglyZXR1cm4gY2FuLnJlcXVpcmUobGlicywgY2IpLCBjYW4KfSkKVm9sY2Fub3MubWV0YS5fbG9hZCA9IGZ1bmN0aW9uKHVybCwgY2IpIHsKCXN3aXRjaCAodXJsLnNwbGl0KCI/IilbMF0uc3BsaXQoaWNlLlBUKS5wb3AoKS50b0xvd2VyQ2FzZSgpKSB7CgkJY2FzZSBuZnMuQ1NTOgoJCQl2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQobWRiLkxJTkspCgkJCWl0ZW0ucmVsID0gInN0eWxlc2hlZXQiLCBpdGVtLnR5cGUgPSAidGV4dC9jc3MiCgkJCWl0ZW0uaHJlZiA9IHVybCwgaXRlbS5vbmxvYWQgPSBjYgoJCQlyZXR1cm4gKGRvY3VtZW50LmhlYWR8fGRvY3VtZW50LmJvZHkpLmFwcGVuZENoaWxkKGl0ZW0pLCBpdGVtCgkJY2FzZSBuZnMuSlM6CgkJCXZhciBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuZnMuU0NSSVBUKQoJCQlpdGVtLnNyYyA9IHVybCwgaXRlbS5vbmxvYWQgPSBjYiwgaXRlbS5vbmVycm9yID0gY2IKCQkJcmV0dXJuIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaXRlbSksIGl0ZW0KCX0KfQpmdW5jdGlvbiBjYW4odG9vbCkgewoJVm9sY2Fub3Moe25hbWU6ICJjaGF0IiwgcGFuZWxzOiBbCgkJe25hbWU6ICJIZWFkZXIiLCBoZWxwOiAi5qCH6aKY5qCPIiwgcG9zOiBjaGF0LkhJREUsIHN0YXRlOiBbInRpbWUiLCAidXNlcm5pY2siLCAiYXZhdGFyIl19LAoJCXtuYW1lOiAiQWN0aW9uIiwgaGVscDogIuW3peS9nOWPsCIsIHBvczogY2hhdC5NQUlOLCB0b29sOiB0b29sfSwKCQl7bmFtZTogIlNlYXJjaCIsIGhlbHA6ICLmkJzntKLmoYYiLCBwb3M6IGNoYXQuQVVUT30sCgldfSkKfQpmdW5jdGlvbiBfY2FuKHRvb2wpIHsKCVZvbGNhbm9zKHtuYW1lOiAiY2hhdCIsIHBhbmVsczogW3tuYW1lOiAiQWN0aW9uIiwgaGVscDogIuW3peS9nOWPsCIsIHBvczogY2hhdC5NQUlOLCB0b29sOiB0b29sfV19KQp9Cgp0cnkgeyBpZiAodHlwZW9mKGdsb2JhbCkgPT0gbGFuZy5PQkpFQ1QpIHsKCWdsb2JhbC5raXQgPSBraXQsIGdsb2JhbC5pY2UgPSBpY2UKCWdsb2JhbC5jdHggPSBjdHgsIGdsb2JhbC5jbGkgPSBjbGksIGdsb2JhbC53ZWIgPSB3ZWIsIGdsb2JhbC5hYWEgPSBhYWEKCWdsb2JhbC5tZGIgPSBtZGIsIGdsb2JhbC5zc2ggPSBzc2gsIGdsb2JhbC5uZnMgPSBuZnMsIGdsb2JhbC50Y3AgPSB0Y3AKCWdsb2JhbC5jb2RlID0gY29kZSwgZ2xvYmFsLndpa2kgPSB3aWtpLCBnbG9iYWwuY2hhdCA9IGNoYXQsIGdsb2JhbC50ZWFtID0gdGVhbSwgZ2xvYmFsLm1hbGwgPSBtYWxsCglnbG9iYWwuc3ZnID0gc3ZnLCBnbG9iYWwuaHRtbCA9IGh0bWwsIGdsb2JhbC5sYW5nID0gbGFuZwoJZ2xvYmFsLnNoeSA9IHNoeSwgZ2xvYmFsLlZvbGNhbm9zID0gVm9sY2Fub3MKCglWb2xjYW5vcy5tZXRhLl9sb2FkID0gZnVuY3Rpb24odXJsLCBjYikgewoJCXNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IGlmIChWb2xjYW5vcy5tZXRhLmNhY2hlW3VybF0pIHsgcmV0dXJuIGNiKFZvbGNhbm9zLm1ldGEuY2FjaGVbdXJsXSkgfQoJCQlzd2l0Y2ggKHVybC5zcGxpdCgiPyIpWzBdLnNwbGl0KGljZS5QVCkucG9wKCkudG9Mb3dlckNhc2UoKSkgewoJCQkJY2FzZSBuZnMuSlM6IHJlcXVpcmUoX2Nhbl9uYW1lID0gdXJsKSwgY2IoVm9sY2Fub3MubWV0YS5jYWNoZVt1cmxdKTsgYnJlYWsKCQkJfQoJCX0sIDEwMCkKCX0KCglWb2xjYW5vcy5tZXRhLl9sb2FkKGdsb2JhbC5wbHVnaW4sIGZ1bmN0aW9uKGNhY2hlKSB7CgkJVm9sY2Fub3MubWV0YS52b2xjYW5vID0gIi4vZnJhbWUuanMiLCBWb2xjYW5vcyh7bGliczogWwoJCQkiLi9saWIvYmFzZS5qcyIsICIuL2xpYi9jb3JlLmpzIiwgIi4vbGliL21pc2MuanMiLCAiLi9saWIvcGFnZS5qcyIsIC8vICIuL2xpYi91c2VyLmpzIiwKCQldLCBwYW5lbHM6IFtdLCBwbHVnaW46IFtdfSwgZnVuY3Rpb24oY2FuKSB7IGNhbi5jb3JlLkxpc3QoY2FjaGUsIGZ1bmN0aW9uKGl0ZW0pIHsgY2FuW2l0ZW0uX25hbWVdID0gaXRlbSB9KQoJCQlWb2xjYW5vcy5tZXRhLl9sb2FkKCIuL3B1Ymxpc2gvY2xpZW50L25vZGVqcy9wcm90by5qcyIsIGZ1bmN0aW9uKGNhY2hlKSB7CgkJCQljYW4uY29yZS5MaXN0KGNhY2hlLCBmdW5jdGlvbihpdGVtKSB7IGNhbi5iYXNlLkNvcHkoY2FuW2l0ZW0uX25hbWVdfHx7fSwgaXRlbSkgfSkKCQkJCWNhbi5vbmltcG9ydC5faW5pdChjYW4sIGNhbi5yZXF1ZXN0KCksIGZ1bmN0aW9uKG1zZykgeyBjb25zb2xlLmxvZyhpY2UuTkwpIH0sIG51bGwpCgkJCX0pCgkJfSkKCX0pCn0gZWxzZSB7CglWb2xjYW5vcy5tZXRhLnRhcmdldCA9IGRvY3VtZW50LmJvZHkKfSB9IGNhdGNoIChlKSB7IGNvbnNvbGUubG9nKGUpIH0KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BhbmVsL2hlYWRlci5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wYW5lbC9hY3Rpb24uY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGFuZWwvc2VhcmNoLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BhbmVsL3JpdmVyLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BhbmVsL2Zvb3Rlci5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wbHVnaW4vbG9jYWwvd2lraS93b3JkLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC9jb2RlL3ZpbWVyLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC90ZWFtL3BsYW4uY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL3N0b3J5L2Zvcm0uY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL3N0b3J5L3NwaWRlLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9zdG9yeS9qc29uLmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC9jaGF0L2Rpdi5jc3MiXSA9IFtdClZvbGNhbm9zLm1ldGEuY2FjaGVbIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmNzcyJdID0gW10KVm9sY2Fub3MubWV0YS5jYWNoZVsiL3BsdWdpbi9sb2NhbC93aWtpL2ZlZWwuY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL2lucHV0L2RhdGUuY3NzIl0gPSBbXQpWb2xjYW5vcy5tZXRhLmNhY2hlWyIvcGx1Z2luL3N0b3J5L3RyZW5kLmNzcyJdID0gW10KCl9jYW5fbmFtZSA9ICIvbGliL3VzZXIuanMiClZvbGNhbm9zKCJ1c2VyIiwge2hlbHA6ICLnlKjmiLfmk43kvZwiLCBpbmZvOiB7fSwgYWdlbnQ6IHsKCQlzY2FuUVJDb2RlOiBmdW5jdGlvbihjYiwgY2FuKSB7CgkJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7dHlwZTogaHRtbC5URVhUQVJFQSwgbmFtZTogInRleHQiLCB0ZXh0OiAiIn1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQljYihsaXN0WzBdLCBjYW4uYmFzZS5QYXJzZUpTT04obGlzdFswXSkpCgkJCX0pCgkJfSwKCQlnZXRMb2NhdGlvbjogZnVuY3Rpb24oY2IpIHsKCQkJbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihmdW5jdGlvbihyZXMpIHsKCQkJCWNiKHtsYXRpdHVkZTogcGFyc2VJbnQocmVzLmNvb3Jkcy5sYXRpdHVkZSoxMDAwMDApLCBsb25naXR1ZGU6IHBhcnNlSW50KHJlcy5jb29yZHMubG9uZ2l0dWRlKjEwMDAwMCl9KQoJCQl9LCBmdW5jdGlvbihzb21lKSB7CgkJCQl0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTiAmJiBjYih7bmFtZTogInNvbWUifSkKCQkJfSApOwoJCX0sCgkJb3BlbkxvY2F0aW9uOiBmdW5jdGlvbihtc2cpIHsKCQkJd2luZG93Lm9wZW4oImh0dHBzOi8vbWFwLmJhaWR1LmNvbS9zZWFyY2gvIitlbmNvZGVVUklDb21wb25lbnQobXNnLk9wdGlvbihtZGIuVEVYVCkpCgkJCQkrIi9AMTI5NTg3NTAuMDg1LDQ4MjU3ODUuNTUsMTZ6P3F1ZXJ5dHlwZT1zJmRhX3NyYz1zaGFyZXVybCZ3ZD0iK2VuY29kZVVSSUNvbXBvbmVudChtc2cuT3B0aW9uKG1kYi5URVhUKSkpCgkJfSwKCQljaG9vc2VJbWFnZTogZnVuY3Rpb24oY2IpIHsKCQkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IoW10pCgkJfSwKCX0sCglpc1dlaVhpbjogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNaWNyb01lc3NlbmdlciIpID4gLTEsCglpc0lQaG9uZTogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJpUGhvbmUiKSA+IC0xLAoJaXNNb2JpbGU6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTW9iaWxlIikgPiAtMSwKCWlzTWFjT1NYOiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk1hYyBPUyBYIikgPiAtMSwKCWlzV2luZG93czogbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJXaW5kb3dzIikgPiAtMSwKCWlzSUU6IG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTVNJRSIpID4gLTEsCglpc0V4dGVuc2lvbjogbG9jYXRpb24gJiYgbG9jYXRpb24ucHJvdG9jb2wgJiYgbG9jYXRpb24ucHJvdG9jb2wgPT0gImNocm9tZS1leHRlbnNpb246IiwKCWlzTG9jYWxGaWxlOiBsb2NhdGlvbiAmJiBsb2NhdGlvbi5wcm90b2NvbCAmJiBsb2NhdGlvbi5wcm90b2NvbCA9PSAiZmlsZToiLAoJaXNMYW5kc2NhcGU6IGZ1bmN0aW9uKCkgeyByZXR1cm4gd2luZG93LmlubmVyV2lkdGggPiB3aW5kb3cuaW5uZXJIZWlnaHQgfSwKCWlzUG9ydHJhaXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gd2luZG93LmlubmVyV2lkdGggPCB3aW5kb3cuaW5uZXJIZWlnaHQgfSwKCW1vZDogewoJCWlzUG9kOiBsb2NhdGlvbiAmJiBsb2NhdGlvbi5wYXRobmFtZSAmJiAobG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZigiL2NoYXQvcG9kLyIpID09IDAgfHwgbG9jYXRpb24ucGF0aG5hbWUuaW5kZXhPZigiL3gvIikgPT0gMCksCgkJaXNEaXY6IGxvY2F0aW9uICYmIGxvY2F0aW9uLnBhdGhuYW1lICYmIChsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC9kaXYvIikgPT0gMCksCgkJaXNDbWQ6IGxvY2F0aW9uICYmIGxvY2F0aW9uLnBhdGhuYW1lICYmIChsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC9wb2QvIikgPT0gMCAmJiBsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY21kLyIpID4gMCB8fAoJCQlsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC9jbWQvIikgPT0gMCB8fCBsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvaGVscC8iKSA9PSAwKSwKCQlpc1dlYjogbG9jYXRpb24gJiYgbG9jYXRpb24ucGF0aG5hbWUgJiYgKGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi9jaGF0L3BvZC8iKSA9PSAwICYmIGxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoIi93ZWJzaXRlLyIpID4gMCB8fAoJCQlsb2NhdGlvbi5wYXRobmFtZS5pbmRleE9mKCIvY2hhdC93ZWJzaXRlLyIpID09IDApLAoJfSwKCglhbGVydDogZnVuY3Rpb24odGV4dCkgeyBhbGVydChKU09OLnN0cmluZ2lmeSh0ZXh0KSkgfSwKCWNvbmZpcm06IGZ1bmN0aW9uKHRleHQpIHsgcmV0dXJuIGNvbmZpcm0oSlNPTi5zdHJpbmdpZnkodGV4dCkpIH0sCglwcm9tcHQ6IGZ1bmN0aW9uKHRpcCwgZGVmLCBjYiwgc2lsZW50KSB7ICh0ZXh0ID0gc2lsZW50PyBkZWY6IHByb21wdCh0aXAsIGRlZnx8IiIpKSAhPSB1bmRlZmluZWQgJiYgdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IodGV4dCk7IHJldHVybiB0ZXh0IH0sCglyZWxvYWQ6IGZ1bmN0aW9uKGZvcmNlKSB7IChmb3JjZSB8fCBjb25maXJtKCLph43mlrDliqDovb3pobXpnaLvvJ8iKSkgJiYgbG9jYXRpb24ucmVsb2FkKCkgfSwKCWp1bXBzOiBmdW5jdGlvbih1cmwpIHsgbG9jYXRpb24uaHJlZiA9IHVybCB9LAoJb3BlbjogZnVuY3Rpb24odXJsKSB7IHdpbmRvdy5vcGVuKHVybCkgfSwKCXRpbWU6IGZ1bmN0aW9uKGNhbiwgdGltZSwgZm10KSB7IHZhciBub3cgPSBjYW4uYmFzZS5EYXRlKHRpbWUpCgkJdmFyIGxpc3QgPSBjYW4udXNlci5sYW5ndWFnZShjYW4pID09ICJlbiI/IFsiU3VuIiwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0Il06IFsi5ZGo5pelIiwgIuWRqOS4gCIsICLlkajkuowiLCAi5ZGo5LiJIiwgIuWRqOWbmyIsICLlkajkupQiLCAi5ZGo5YWtIl0KCQlyZXR1cm4gY2FuLmJhc2UuVGltZSh0aW1lLCAoZm10fHwiJXktJW0tJWQgJUg6JU06JVMiKS5yZXBsYWNlKCIldyIsIGxpc3Rbbm93LmdldERheSgpXSkpCgl9LAoKCXRpdGxlOiBmdW5jdGlvbih0ZXh0KSB7CgkJaWYgKHdpbmRvdy53ZWJ2aWV3KSB7IHJldHVybiB0aXRsZSh0ZXh0KSB9CgkJcmV0dXJuIHRleHQgJiYgKGRvY3VtZW50LnRpdGxlID0gVm9sY2Fub3MubWV0YS5hcmdzLm5hbWV8fHRleHQpLCBkb2N1bWVudC50aXRsZQoJfSwKCXRvcGljOiBmdW5jdGlvbihjYW4sIG5hbWUpIHsKCQljYW4udXNlci5tb2QuaXNDbWQgJiYgKG5hbWUgKz0gIiBzaW1wbGUiKQoJCWNhbi5Db25mKCJkaXNwbGF5IikgJiYgKG5hbWUgKz0gIiAiK2Nhbi5Db25mKCJkaXNwbGF5IikpCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgKG5hbWUgKz0gIiBtb2JpbGUiKSAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIChuYW1lICs9ICIgbGFuZHNjYXBlIikKCQljYW4udXNlci5sYW5ndWFnZShjYW4pICYmIChuYW1lICs9ICIgIitjYW4udXNlci5sYW5ndWFnZShjYW4pKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGRvY3VtZW50LmJvZHksIHtjbGFzc05hbWU6IG5hbWV9KQoJfSwKCWxhbmd1YWdlOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5taXNjLlNlYXJjaChjYW4sICJsYW5ndWFnZSIpIH0sCgl0cmFuczogZnVuY3Rpb24oY2FuLCB0ZXh0LCBsaXN0KSB7IGlmIChjYW4uYmFzZS5pc09iamVjdCh0ZXh0KSkgewoJCQlyZXR1cm4gY2FuLmNvcmUuSXRlbSh0ZXh0LCBmdW5jdGlvbihrLCB2KSB7IGNhbi5jb3JlLlZhbHVlKGNhbi5fdHJhbnMsIGssIHYpIH0pCgkJfQoKCQlpZiAoY2FuLnVzZXIubGFuZ3VhZ2UoY2FuKSA9PSAiZW4iKSB7IHJldHVybiB0ZXh0IH0KCQlpZiAoY2FuLmJhc2UuaXNGdW5jdGlvbih0ZXh0KSkgeyB0ZXh0ID0gdGV4dC5uYW1lfHwiIiB9CgkJcmV0dXJuIGxpc3QmJmxpc3RbdGV4dF0gfHwgY2FuLkNvbmYoInRyYW5zLiIrdGV4dCkgfHwgY2FuLkNvbmYoImZlYXR1cmUuX3RyYW5zLiIrdGV4dCkgfHwgY2FuLl90cmFucyYmY2FuLl90cmFuc1t0ZXh0XSB8fCB7CgkJCSJjcmVhdGUiOiAi5Yib5bu6IiwgInJlbW92ZSI6ICLliKDpmaQiLCAiaW5zZXJ0IjogIua3u+WKoCIsICJkZWxldGUiOiAi5Yig6ZmkIiwgIm1vZGlmeSI6ICLnvJbovpEiLAoJCQkiaW5wdXRzIjogIuihpeWFqCIsICJwcnVuZXMiOiAi5riF55CGIiwgImV4cG9ydCI6ICLlr7zlh7oiLCAiaW1wb3J0IjogIuWvvOWFpSIsCgkJCSJsaXN0IjogIuafpeeciyIsICJiYWNrIjogIui/lOWbniIsICJydW4iOiAi5omn6KGMIiwgImRvbmUiOiAi5a6M5oiQIiwgInNoYXJlIjogIuWFseS6qyIsCgkJCSJlZGl0IjogIue8lui+kSIsICJzYXZlIjogIuS/neWtmCIsICJjb3B5IjogIuWkjeWItiIsICJzaG93IjogIuaYvuekuiIsICJoaWRlIjogIumakOiXjyIsCgkJCSJwcm9qZWN0IjogIumhueebriIsICJwcm9maWxlIjogIuivpuaDhSIsICJhY3Rpb25zIjogIuWPguaVsCIsCgkJCSJwbHVnaW4iOiAi5o+S5Lu2IiwKCQkJInByZXYiOiAi5LiK5LiA6aG1IiwgIm5leHQiOiAi5LiL5LiA6aG1IiwKCgkJCSJvcGVuIjogIuaJk+W8gCIsICJjbG9zZSI6ICLlhbPpl60iLAoJCQkic3RhcnQiOiAi5ZCv5YqoIiwgInN0b3AiOiAi5YGc5q2iIiwKCQkJImJlZ2luIjogIuW8gOWniyIsICJlbmQiOiAi57uT5p2fIiwKCQkJImNsZWFyIjogIua4heepuiIsICJyZWZyZXNoIjogIuWIt+aWsCIsCgkJCSJzdWJtaXQiOiAi5o+Q5LqkIiwgImNhbmNlbCI6ICLlj5bmtogiLAoJCQkibGFiZWwiOiAi5qCH562+IiwgImV4ZWMiOiAi5omn6KGMIiwKCQl9W3RleHRdfHx0ZXh0Cgl9LAoJdG9hc3RDb25maXJtOiBmdW5jdGlvbihjYW4sIHRpdGxlLCBjb250ZW50LCBhY3Rpb24pIHsKCQlyZXR1cm4gY2FuLnVzZXIudG9hc3QoY2FuLCB7dGl0bGU6IHRpdGxlLCBjb250ZW50OiBjb250ZW50LCBhY3Rpb246IGFjdGlvbnx8W2NsaS5DTE9TRV0sIGR1cmF0aW9uOiAtMSwgd2lkdGg6IC0zMDB9KQoJfSwKCXRvYXN0UHJvY2VzczogZnVuY3Rpb24oY2FuLCB0aXRsZSkgeyByZXR1cm4gY2FuLnVzZXIudG9hc3QoY2FuLCBpY2UuUFJPQ0VTUywgdGl0bGUsIC0xKSB9LAoJdG9hc3RTdWNjZXNzOiBmdW5jdGlvbihjYW4sIHRpdGxlKSB7IHJldHVybiBjYW4udXNlci50b2FzdChjYW4sIGljZS5TVUNDRVNTLCB0aXRsZSkgfSwKCXRvYXN0OiBmdW5jdGlvbihjYW4sIGNvbnRlbnQsIHRpdGxlLCBkdXJhdGlvbiwgcHJvZ3Jlc3MpIHsKCQl2YXIgbWV0YSA9IGNhbi5iYXNlLmlzT2JqZWN0KGNvbnRlbnQpPyBjb250ZW50OiB7Y29udGVudDogY29udGVudCwgdGl0bGU6IHRpdGxlfHxjYW4uX2hlbHAsIGR1cmF0aW9uOiBkdXJhdGlvbiwgcHJvZ3Jlc3M6IHByb2dyZXNzfQoJCXZhciB3aWR0aCA9IG1ldGEud2lkdGh8fDQwMCwgaGVpZ2h0ID0gbWV0YS5oZWlnaHR8fDEwMDsgaWYgKHdpZHRoIDwgMCkgeyB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoICsgd2lkdGggfQoKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBkb2N1bWVudC5ib2R5LCAgW3t2aWV3OiBjaGF0LlRPQVNULCBzdHlsZTogewoJCQlsZWZ0OiAod2luZG93LmlubmVyV2lkdGgtd2lkdGgpLzIsIHdpZHRoOiB3aWR0aCwgYm90dG9tOiAxMDAsCgkJfSwgbGlzdDogWwoJCQl7dGV4dDogW21ldGEudGl0bGV8fCIiLCBodG1sLkRJViwgaHRtbC5USVRMRV0sIHRpdGxlOiAi54K55Ye75aSN5Yi2Iiwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgbWV0YS50aXRsZSkKCQkJfX0sCgkJCXt2aWV3OiAiZHVyYXRpb24iLCB0aXRsZTogIueCueWHu+WFs+mXrSIsIG9uY2xpY2s6IGZ1bmN0aW9uKCkgeyBhY3Rpb24uY2xvc2UoKSB9fSwKCQkJY2FuLmJhc2UuaXNPYmplY3QobWV0YS5jb250ZW50KT8gbWV0YS5jb250ZW50OiB7dGV4dDogW21ldGEuY29udGVudHx8IuaJp+ihjOaIkOWKnyIsIGh0bWwuRElWLCAiY29udGVudCJdfSwKCgkJCXt2aWV3OiBjaGF0LkFDVElPTn0sIG1ldGEucHJvZ3Jlc3MgIT0gdW5kZWZpbmVkICYmIHt2aWV3OiAicHJvZ3Jlc3MiLCBzdHlsZToge3dpZHRoOiB3aWR0aH0sIGxpc3Q6IFsKCQkJCXt2aWV3OiAiY3VycmVudCIsIHN0eWxlOiB7d2lkdGg6IChtZXRhLnByb2dyZXNzfHwwKS8xMDAqd2lkdGh9fSwKCQkJXX0sCgkJXSB9XSkKCgkJdmFyIGFjdGlvbiA9IGNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgbWV0YS5hY3Rpb258fFsiIl0sIHVpLmFjdGlvbiwgewoJCQljbG9zZTogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgYWN0aW9uLl90YXJnZXQpLCBhY3Rpb24udGltZXIuc3RvcCA9IHRydWUgfSwKCQkJdGltZXI6IGNhbi5jb3JlLlRpbWVyKHtpbnRlcnZhbDogMTAwLCBsZW5ndGg6IChwYXJzZUludChtZXRhLmR1cmF0aW9ufHwxMDAwKSkvMTAwfSwgZnVuY3Rpb24oZXZlbnQsIGludGVydmFsLCBpbmRleCkgewoJCQkJaWYgKGluZGV4ID4gMzApIHsgdWkuZHVyYXRpb24uaW5uZXJIVE1MID0gcGFyc2VJbnQoaW5kZXgvMTApK2ljZS5QVCsoaW5kZXglMTApKyJzLi4uIiB9CgkJCX0sIGZ1bmN0aW9uKCkgeyBhY3Rpb24uY2xvc2UoKSB9KSwgX3RhcmdldDogdWkuX3RhcmdldCwgdWk6IHVpLAoJCX0pOyBjYW4ub25tb3Rpb24uc3RvcnkuYXV0byhjYW4sIHVpLl90YXJnZXQpCgoJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBjaGF0Lk9OVE9BU1QsIGNhbi5yZXF1ZXN0KHt9LCB7dGltZTogY2FuLmJhc2UuVGltZSgpLCB0aXRsZTogbWV0YS50aXRsZSwgY29udGVudDogbWV0YS5jb250ZW50LCBmaWxlbGluZTogY2FuLm1pc2MuRmlsZUxpbmUoMiwgMil9KSkKCQlyZXR1cm4gIW1ldGEuYWN0aW9uICYmIGNhbi5vbm1vdGlvbi5mbG9hdC5hZGQoY2FuLCBjaGF0LlRPQVNULCBhY3Rpb24pLCBhY3Rpb24KCX0sCglzaGFyZTogZnVuY3Rpb24oY2FuLCBtc2csIGNtZCkgewoJCWNhbi5ydW4obXNnLl9ldmVudCwgY21kfHxbY3R4LkFDVElPTiwgY2hhdC5TSEFSRV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4udXNlci50b2FzdChjYW4sIHtoZWlnaHQ6IDMwMCwgd2lkdGg6IDUwMCwKCQkJCXRpdGxlOiBtc2cuQXBwZW5kKG1kYi5OQU1FKSwgZHVyYXRpb246IC0xLAoJCQkJY29udGVudDogbXNnLkFwcGVuZChtZGIuVEVYVCksIGFjdGlvbjogW2NsaS5DTE9TRV0sCgkJCX0pLCBjYW4udXNlci5jb3B5KG1zZy5fZXZlbnQsIGNhbiwgbXNnLkFwcGVuZChtZGIuTkFNRSkpCgkJfSkKCX0sCglsb2dpbjogZnVuY3Rpb24oY2FuLCBjYiwgbWV0aG9kLCBhdXRvKSB7IG1ldGhvZCA9IGNhbi5iYXNlLk9iaihtZXRob2QsIFsi55m75b2VIiwgIuaJq+eggSJdKQoJCXZhciBsaXN0ID0gewoJCQki55m75b2VIjogZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQkJY2FuLnJ1bih7fSwgW2FhYS5MT0dJTiwgZGF0YVtodG1sLlVTRVJOQU1FXSwgZGF0YVtodG1sLlBBU1NXT1JEXV0sIGZ1bmN0aW9uKG1zZykgewoJCQkJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfVVNFUk5BTUUpKSB7CgkJCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLl90YXJnZXQpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQkJCQl9IGVsc2UgewoJCQkJCQljYW4udXNlci50b2FzdChjYW4sICLnlKjmiLflkI3miJblr4bnoIHplJnor68iKQoJCQkJCX0KCQkJCX0pCgkJCQlyZXR1cm4gdHJ1ZQoJCQl9LCAKCQkJIuaJq+eggSI6IGZ1bmN0aW9uKCkgewoJCQkJY2FuLm1pc2MuV1NTKGNhbiwge3R5cGU6IGh0bWwuQ0hST01FLCBjbWQ6ICJwd2QifSwgZnVuY3Rpb24oZXZlbnQsIG1zZywgY21kLCBhcmcpIHsgaWYgKCFtc2cpIHsgcmV0dXJuIH0KCQkJCQlpZiAoY21kID09ICJwd2QiKSB7CgkJCQkJCXJldHVybiBjYW4udXNlci50b2FzdChjYW4sIGFyZ1syXSwgYXJnWzFdLCAtMSksIG1zZy5SZXBseSgpCgkJCQkJfQoJCQkJCWlmIChjbWQgPT0gaWNlLk1TR19TRVNTSUQpIHsKCQkJCQkJcmV0dXJuIGNhbi5taXNjLkNvb2tpZVNlc3NpZChjYW4sIGFyZ1swXSksIG1zZy5SZXBseSgpLCBjYW4udXNlci5yZWxvYWQodHJ1ZSkKCQkJCQl9CgkJCQkJY2FuLnNlYXJjaChldmVudCwgbXNnW2ljZS5NU0dfREVUQUlMXXx8W10sIGZ1bmN0aW9uKG1zZykgeyBtc2cuUmVwbHkoKSB9KQoJCQkJfSkKCQkJfSwKCQkJIuaOiOadgyI6IGZ1bmN0aW9uKCkgewoJCQkJY2FuLm1pc2MuV1NTKGNhbiwge3R5cGU6IGh0bWwuQ0hST01FLCBjbWQ6ICJzc28iLCAidXNlci53ZWIiOiBsb2NhdGlvbi5ocmVmfSwgZnVuY3Rpb24oZXZlbnQsIG1zZywgY21kLCBhcmcpIHsgaWYgKCFtc2cpIHsgcmV0dXJuIH0KCQkJCQlpZiAoY21kID09ICJwd2QiKSB7CgkJCQkJCXJldHVybiBsb2NhdGlvbi5ocmVmID0gYXJnWzFdCgkJCQkJfQoJCQkJCWlmIChjbWQgPT0gaWNlLk1TR19TRVNTSUQpIHsKCQkJCQkJcmV0dXJuIGNhbi5taXNjLkNvb2tpZVNlc3NpZChjYW4sIGFyZ1swXSksIG1zZy5SZXBseSgpLCBjYW4udXNlci5yZWxvYWQodHJ1ZSkKCQkJCQl9CgkJCQkJY2FuLnNlYXJjaChldmVudCwgbXNnW2ljZS5NU0dfREVUQUlMXXx8W10sIGZ1bmN0aW9uKG1zZykgeyBtc2cuUmVwbHkoKSB9KQoJCQkJfSkKCQkJfSwKCQkJIumjnuS5piI6IGZ1bmN0aW9uKCkgeyBsb2NhdGlvbi5ocmVmID0gIi9jaGF0L2xhcmsvc3NvIiB9LAoJCX07IGlmIChhdXRvKSB7IHJldHVybiBsaXN0WyLmjojmnYMiXSgpIH0gZWxzZSBpZiAobWV0aG9kLmxlbmd0aCA9PSAxKSB7IGxpc3RbbWV0aG9kWzBdXSgpOyByZXR1cm4gfQoKCQl2YXIgdWkgPSBjYW4udXNlci5pbnB1dCh7fSwgY2FuLCBbe3R5cGU6IGh0bWwuVVNFUk5BTUV9LCB7dHlwZTogaHRtbC5QQVNTV09SRH1dLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7IHJldHVybiBsaXN0W2J1dHRvbl0oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgfSwgbWV0aG9kKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLl90YXJnZXQsIHtjbGFzc05hbWU6ICJpbnB1dCBsb2dpbiIsIHN0eWxlOiB7bGVmdDogKHdpbmRvdy5pbm5lcldpZHRoLXVpLl90YXJnZXQub2Zmc2V0V2lkdGgpLzIsIHRvcDogd2luZG93LmlubmVySGVpZ2h0LzZ9fSkKCX0sCglsb2dvdXQ6IGZ1bmN0aW9uKGNhbiwgZm9yY2UpIHsgaWYgKGZvcmNlfHxjYW4udXNlci5jb25maXJtKCJsb2dvdXQ/IikpIHsKCQljYW4ucnVuKHt9LCBbY3R4LkFDVElPTiwgYWFhLkxPR09VVF0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LlNIQVJFKT8gY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5TSEFSRSwgIiIpOiBjYW4udXNlci5yZWxvYWQodHJ1ZSkKCQl9KQoJfSB9LAoKCXRvUE5HOiBmdW5jdGlvbihjYW4sIG5hbWUsIHRleHQsIGhlaWdodCwgd2lkdGgpIHsKCQlpZiAodGV4dC5pbmRleE9mKCI8c3ZnIikgIT0gMCkgewoJCQl0ZXh0ID0gJzxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4nK3RleHQrIjwvc3ZnPiIKCQl9CgkJdmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaHRtbC5JTUcpCgkJaW1nLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewoJCQl2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiY2FudmFzIikKCQkJY2FudmFzLmhlaWdodCA9IGhlaWdodCwgY2FudmFzLndpZHRoID0gd2lkdGgKCQkJY2FudmFzLmdldENvbnRleHQoIjJkIikuZHJhd0ltYWdlKGltZywgMCwgMCkKCgkJCXZhciBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpCgkJCWEuaHJlZiA9IGNhbnZhcy50b0RhdGFVUkwoImltYWdlL3BuZyIpCgkJCWEuZG93bmxvYWQgPSBuYW1lLCBhLmNsaWNrKCkKCQl9LCBpbWcuc3JjID0gImRhdGE6aW1hZ2Uvc3ZnK3htbCwiK2VuY29kZVVSSUNvbXBvbmVudCh0ZXh0KQoJfSwKCWNvcHk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRleHQpIHsKCQlpZiAobmF2aWdhdG9yLmNsaXBib2FyZCkgeyB2YXIgb2sgPSBmYWxzZQoJCQluYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCh0ZXh0KS50aGVuKGZ1bmN0aW9uKCkgeyBvayA9IHRydWUgfSkKCQkJaWYgKG9rKSB7IHJldHVybiBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9CgkJfQoKCQl2YXIgaW5wdXQgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBldmVudC50YXJnZXQucGFyZW50Tm9kZSwgW3t0eXBlOiBodG1sLlRFWFRBUkVBLCB2YWx1ZTogdGV4dH1dKS5maXJzdAoJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIGlucHV0KSwgZG9jdW1lbnQuZXhlY0NvbW1hbmQoIkNvcHkiKQoJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGlucHV0KSwgY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbikKCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQljYW4ubWlzYy5Mb2coImNvcHkiLCB0ZXh0KQoJCXJldHVybiB0ZXh0Cgl9LAoJY2FydGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGxpc3QsIGNiLCBwYXJlbnQpIHsgLy8gZXZlbnQgaXRlbSBtZXRhCgkJbWV0YSA9IG1ldGF8fGNhbi5vbmRldGFpbHx8Y2FuLm9uYWN0aW9ufHx7fSwgbGlzdCA9IGxpc3QmJmxpc3QubGVuZ3RoID4gMD8gbGlzdDogbWV0YS5saXN0fHxbXTsgaWYgKGxpc3QubGVuZ3RoID09IDApIHsgcmV0dXJuIH0KCQljYiA9IGNifHxmdW5jdGlvbihldmVudCwgaXRlbSwgbWV0YSkgeyB2YXIgY2IgPSBtZXRhW2l0ZW1dfHxtZXRhWyJfZW5naW5lIl07IGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGNhbiwgaXRlbSkgfQoKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBkb2N1bWVudC5ib2R5LCBbe3ZpZXc6IGNoYXQuQ0FSVEUsIHN0eWxlOiB7bGVmdDogMCwgdG9wOiAwfSwgb25tb3VzZWxlYXZlOiBmdW5jdGlvbihldmVudCkgewoJCQkvLyBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KQoJCX0sIGxpc3Q6IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJcmV0dXJuIGNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pPyB7dmlldzogaHRtbC5JVEVNLCBsaXN0OiBbe3RleHQ6IGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbSksIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pc01vYmlsZSAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbSwgbWV0YSwgaW5kZXgpCgkJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhcnRlLl9mbG9hdCAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYXJ0ZS5fZmxvYXQuX3RhcmdldCkKCQkJfSB9XSB9OiBjYW4uYmFzZS5pc0FycmF5KGl0ZW0pPyB7dmlldzogaHRtbC5JVEVNLCBsaXN0OiBbe3RleHQ6IGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbVswXSkrIiAtPiAifV0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciBzdWIgPSBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBtZXRhLCBpdGVtLnNsaWNlKDEpLCBjYiwgY2FydGUpCgkJCQljYXJ0ZS5fZmxvYXQgJiYgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FydGUuX2Zsb2F0Ll90YXJnZXQpLCBjYXJ0ZS5fZmxvYXQgPSBzdWIKCQkJCWNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgc3ViLl90YXJnZXQsIHRydWUpCgkJCX0gfToge3ZpZXc6IGh0bWwuSVRFTSwgbGlzdDogW3t0ZXh0OiBjYW4udXNlci50cmFucyhjYW4sIGl0ZW0ubmFtZSksIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pc01vYmlsZSAmJiBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbS5uYW1lLCBtZXRhLCBpbmRleCkKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FydGUuX2Zsb2F0ICYmIGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhcnRlLl9mbG9hdC5fdGFyZ2V0KQoJCQl9IH1dIH0KCQl9KSB9XSApCgoJCXVpLl90YXJnZXQub25tb3VzZW92ZXIgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ub25rZXltYXAucHJldmVudChldmVudCkgfQoJCXZhciBjYXJ0ZSA9IHtfdGFyZ2V0OiB1aS5fdGFyZ2V0LCBfcGFyZW50OiBwYXJlbnQsIGxheW91dDogY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuLCB1aS5fdGFyZ2V0KX0KCQlyZXR1cm4gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpLCBjYXJ0ZQoJfSwKCWNhcnRlUmlnaHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGxpc3QsIGNiLCBwYXJlbnQpIHsKCQl2YXIgY2FydGUgPSBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBtZXRhLCBsaXN0LCBjYiwgcGFyZW50KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhcnRlLl90YXJnZXQsIHtzdHlsZTogewoJCQlsZWZ0OiBldmVudC5jbGllbnRYLWV2ZW50Lm9mZnNldFgrZXZlbnQudGFyZ2V0Lm9mZnNldFdpZHRoLTMsCgkJCXRvcDogY2FydGUuX3RhcmdldC5vZmZzZXRUb3AtKGNhcnRlLmxheW91dC5ib3R0b20/IC1ldmVudC50YXJnZXQub2Zmc2V0SGVpZ2h0OiBldmVudC50YXJnZXQub2Zmc2V0SGVpZ2h0KSs1LAoJCQlib3R0b206ICIiLAoJCX19KQoJCXJldHVybiBjYXJ0ZQoJfSwKCWNhcnRlQ2xpZW50OiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBsaXN0LCBjYiwgcGFyZW50KSB7CgkJdmFyIHVpID0gY2FuLnVzZXIuY2FydGUoZXZlbnQsIGNhbiwgbWV0YSwgbGlzdCwgY2IsIHBhcmVudCkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB1aS5fdGFyZ2V0LCB7c3R5bGU6IHtsZWZ0OiBldmVudC5jbGllbnRYLCB0b3A6IGV2ZW50LmNsaWVudFl9fSkKCX0sCgoJaW5wdXQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGZvcm0sIGNiLCBidXR0b24pIHsgaWYgKCFmb3JtIHx8IGZvcm0ubGVuZ3RoID09IDApIHsgcmV0dXJuIGNiKCkgfQoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBkb2N1bWVudC5ib2R5LCBbe3ZpZXc6IFtodG1sLklOUFVUXSwgc3R5bGU6IHtsZWZ0OiAwLCB0b3A6IDB9LCBsaXN0OiBbCgkJCXt2aWV3OiAiY29udGVudCIsIGxpc3Q6IFt7dmlldzogW2NoYXQuT1BUSU9OLCBodG1sLlRBQkxFXSwgbGlzdDogY2FuLmNvcmUuTGlzdChmb3JtLCBmdW5jdGlvbihpdGVtKSB7CgkJCQlpdGVtID0gY2FuLmJhc2UuaXNTdHJpbmcoaXRlbSk/IHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IGl0ZW19OiBpdGVtLmxlbmd0aCA+IDA/IHt0eXBlOiBodG1sLlNFTEVDVCwgbmFtZTogaXRlbVswXSwgdmFsdWVzOiBpdGVtLnNsaWNlKDEpfTogaXRlbQoJCQkJaXRlbS50eXBlID0gaXRlbS50eXBlfHwoaXRlbS52YWx1ZXM/IGh0bWwuU0VMRUNUOiBpdGVtLm5hbWUgPT0gaHRtbC5URVhUPyBodG1sLlRFWFRBUkVBOiBodG1sLlRFWFQpCgoJCQkJaXRlbS5faW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgewoJCQkJCWl0ZW0ucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCQkJCXZhciBfbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtfaGFuZGxlOiBpY2UuVFJVRSwgYWN0aW9uOiBtc2cuT3B0aW9uKGNoYXQuQUNUSU9OKX0sIG1zZywgY2FuLk9wdGlvbigpKQoJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS50YWJsZSwgaHRtbC5PUFRJT05fQVJHUywgZnVuY3Rpb24oaXRlbSkgewoJCQkJCQkJaXRlbS5uYW1lICYmIGl0ZW0udmFsdWUgJiYgX21zZy5PcHRpb24oaXRlbS5uYW1lLCBpdGVtLnZhbHVlKQoJCQkJCQl9KQoJCQkJCQljYW4ucnVuKGV2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkKCQkJCQl9CgoJCQkJCWlmIChpdGVtLm5hbWUgIT0gImFjdGlvbiIgJiYgaXRlbS5uYW1lKSB7CgkJCQkJCXRhcmdldC52YWx1ZSA9IG1zZy5PcHRpb24oaXRlbS5uYW1lKXx8Y2FuLk9wdGlvbihpdGVtLm5hbWUpfHx0YXJnZXQudmFsdWV8fCIiCgkJCQkJfQoJCQkJCWNhbi5vbmFwcGVuZC5maWd1cmUoY2FuLCBpdGVtLCB0YXJnZXQpCgkJCQl9CgoJCQkJLy8gcmV0dXJuIHt0eXBlOiBodG1sLlRSLCBsaXN0OiBbe3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFt7dGV4dDogaXRlbS5fdHJhbnN8fGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbS5uYW1lKXx8IiJ9XX0sIHt0eXBlOiBodG1sLlRELCBsaXN0OiBbY2FuLnBhZ2UuaW5wdXQoY2FuLCBpdGVtKV19IF19CgkJCQlyZXR1cm4ge3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dHlwZTogaHRtbC5URCwgbGlzdDogW3t0ZXh0OiBpdGVtLm5hbWV8fCIifV19LCB7dHlwZTogaHRtbC5URCwgbGlzdDogW2Nhbi5wYWdlLmlucHV0KGNhbiwgaXRlbSldfSBdfQoJCQl9KX1dfSwge3ZpZXc6IGNoYXQuQUNUSU9OfSwKCQldfV0pCgoJCXZhciBsYXlvdXQgPSBjYW4ub25sYXlvdXQuZmlndXJlKGV2ZW50LCBjYW4sIHVpLl90YXJnZXQpCgkJaWYgKGxheW91dC5sZWZ0ID09IHVuZGVmaW5lZCkgeyBpZiAoIWxheW91dC50b3ApIHsgbGF5b3V0LnRvcCA9IDMyIH0KCQkJbGF5b3V0LmxlZnQgPSB3aW5kb3cuaW5uZXJXaWR0aC8yLXVpLl90YXJnZXQub2Zmc2V0V2lkdGgvMiwgbGF5b3V0LnJpZ2h0ID0gIiIKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB1aS5fdGFyZ2V0LCBsYXlvdXQpCgkJfQoJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB1aS5fdGFyZ2V0LCBjaGF0LkZMT0FUKQoJCWlmIChsYXlvdXQudG9wKSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdWkuY29udGVudCwgaHRtbC5NQVhfSEVJR0hULCB3aW5kb3cuaW5uZXJIZWlnaHQgLSBsYXlvdXQudG9wIC0gaHRtbC5BQ1RJT05fSEVJR0hUIC0gMTApCgkJfQoKCQl2YXIgYWN0aW9uID0gY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBidXR0b258fFtodG1sLlNVQk1JVCwgaHRtbC5DQU5DRUxdLCB1aS5hY3Rpb24sIHsKCQkJZm9jdXM6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLmZpcnN0LCBodG1sLklOUFVUX0FSR1MpWzBdLmZvY3VzKCkgfSwKCQkJY2FuY2VsOiBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5fdGFyZ2V0KSB9LAoJCQlfZW5naW5lOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgYWN0aW9uLnN1Ym1pdChldmVudCwgY2FuLCBidXR0b24pIH0sCgkJCXN1Ym1pdDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IHZhciBkYXRhID0ge30sIGFyZ3MgPSBbXSwgbGlzdCA9IFtdCgkJCQlsaXN0ID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdWkudGFibGUsIGh0bWwuT1BUSU9OX0FSR1MsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQlyZXR1cm4gaXRlbS5uYW1lICYmIGl0ZW0udmFsdWUgJiYgYXJncy5wdXNoKGl0ZW0ubmFtZSwgaXRlbS52YWx1ZSksIGRhdGFbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWUKCQkJCX0pCgkJCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtfaGFuZGxlOiBpY2UuVFJVRX0pCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmICFjYihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSAmJiBhY3Rpb24uY2FuY2VsKCkKCQkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9LCBfdGFyZ2V0OiB1aS5fdGFyZ2V0LAoJCX0pCgkJaWYgKGJ1dHRvbiA9PT0gIHRydWUpIHsgcmV0dXJuIGFjdGlvbi5zdWJtaXQoZXZlbnQsIGNhbiwgInN1Ym1pdCIpLCBhY3Rpb24gfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS5fdGFyZ2V0LCBodG1sLklOUFVUX0FSR1MsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCWluZGV4ID09IDAgJiYgY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsgY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgaXRlbSkgfSkKCQl9KQoJCXJldHVybiBhY3Rpb24KCX0sCglzZWxlY3Q6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHR5cGUsIGZpZWxkcywgY2IsIGNicykgewoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge2ZpZWxkczogZmllbGRzfHwidHlwZSxuYW1lLHRleHQifSkKCQljYW4uc2VhcmNoKG1zZy5fZXZlbnQsIFsiU2VhcmNoLm9uaW1wb3J0LnNlbGVjdCIsIHR5cGUsICIiLCAiIl0sIGZ1bmN0aW9uKGxpc3QpIHsKCQkJY2FuLmNvcmUuTmV4dChsaXN0LCBjYiwgY2JzfHxmdW5jdGlvbigpIHsKCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJCX0pCgkJfSkKCX0sCgl1cGxvYWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIGJlZ2luID0gbmV3IERhdGUoKQoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGRvY3VtZW50LmJvZHksIFt7dmlldzogaHRtbC5VUExPQUQsIHN0eWxlOiB7bGVmdDogMCwgdG9wOiAwfSwgbGlzdDogWwoJCQl7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVQsIGxpc3Q6IFt7dmlldzogInByb2dyZXNzIn1dfSwKCQkJe3ZpZXc6IGh0bWwuU1RBVFVTLCBsaXN0OiBbe3ZpZXc6IGh0bWwuU0hPV30sIHt2aWV3OiAiY29zdCJ9LCB7dmlldzogInNpemUifV19LAoJCV19XSk7IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgdWkuX3RhcmdldCkKCgkJdmFyIGFjdGlvbiA9IGNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgWwoJCQl7dHlwZTogaHRtbC5VUExPQUQsIG9uY2hhbmdlOiBmdW5jdGlvbihldmVudCkgewoJCQkJYWN0aW9uLnNob3coZXZlbnQsIDAsIGV2ZW50LnRhcmdldC5maWxlc1swXS5zaXplLCAwKQoJCQl9fSwgY2xpLkNMT1NFLAoJCV0sIHVpLmFjdGlvbiwgewoJCQljbG9zZTogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdWkuX3RhcmdldCkgfSwKCQkJYmVnaW46IGZ1bmN0aW9uKGV2ZW50KSB7IGJlZ2luID0gbmV3IERhdGUoKQoJCQkJdmFyIHVwbG9hZCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLmFjdGlvbiwgImlucHV0W3R5cGU9ZmlsZV0iKQoJCQkJaWYgKHVwbG9hZFswXS5maWxlcy5sZW5ndGggPT0gMCkgeyByZXR1cm4gdXBsb2FkWzBdLmZvY3VzKCkgfQoKCQkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpLCB7X2hhbmRsZTogInRydWUifSkKCQkJCW1zZy5fdXBsb2FkID0gdXBsb2FkWzBdLmZpbGVzWzBdLCBtc2cuX3Byb2dyZXNzID0gYWN0aW9uLnNob3cKCgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaHRtbC5VUExPQURdLCBmdW5jdGlvbihtc2cpIHsKCQkJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSwgY2FuLlVwZGF0ZSgpLCBhY3Rpb24uY2xvc2UoKQoJCQkJfSwgdHJ1ZSkKCQkJfSwKCQkJc2hvdzogZnVuY3Rpb24gKGV2ZW50LCB2YWx1ZSwgdG90YWwsIGxvYWRlZCkgeyBub3cgPSBuZXcgRGF0ZSgpCgkJCQl2YWx1ZSA9PSAwICYmIGFjdGlvbi5iZWdpbihldmVudCkKCgkJCQl1aS5zaG93LmlubmVySFRNTCA9IHZhbHVlKyIlIgoJCQkJdWkuY29zdC5pbm5lckhUTUwgPSBjYW4uYmFzZS5EdXJhdGlvbihub3cgLSBiZWdpbikKCQkJCXVpLnNpemUuaW5uZXJIVE1MID0gY2FuLmJhc2UuU2l6ZShsb2FkZWQpK2ljZS5QUytjYW4uYmFzZS5TaXplKHRvdGFsKQoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdWkucHJvZ3Jlc3MsIHtzdHlsZToge3dpZHRoOiB2YWx1ZSoodWkub3V0cHV0Lm9mZnNldFdpZHRoLTIpLzEwMH19KQoJCQl9LAoJCX0pOyBjYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS5hY3Rpb24sICJpbnB1dFt0eXBlPWZpbGVdIilbMF0uY2xpY2soKQoKCQlyZXR1cm4gYWN0aW9uCgl9LAoJZG93bmxvYWQ6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgbmFtZSkgewoJCXZhciBhID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgZG9jdW1lbnQuYm9keSwgW3t0eXBlOiBodG1sLkEsIGhyZWY6IHBhdGgsIGRvd25sb2FkOiBuYW1lfHxwYXRoLnNwbGl0KGljZS5QUykucG9wKCl9XSkuZmlyc3QKCQlhLmNsaWNrKCksIGNhbi5wYWdlLlJlbW92ZShjYW4sIGEpCgl9LAoJZG93bmxvYWRzOiBmdW5jdGlvbihjYW4sIHRleHQsIG5hbWUpIHsgY2FuLnVzZXIuZG93bmxvYWQoY2FuLCBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFt0ZXh0XSkpLCBuYW1lKSB9LAoJY2FtZXJhOiBmdW5jdGlvbihjYW4sIG1zZywgY2IpIHsKCQluYXZpZ2F0b3IuZ2V0VXNlck1lZGlhKHt2aWRlbzogdHJ1ZX0sIGNiLCBmdW5jdGlvbihlcnJvcikgewoJCQljYW4ubWlzYy5Mb2coZXJyb3IpCgkJfSkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9saWIvY29yZS5qcyIKVm9sY2Fub3MoImNvcmUiLCB7aGVscDogIuaVsOaNrue7k+aehCIsCglLZXlzOiBzaHkoIui/nuaOpeWZqCIsIGZ1bmN0aW9uKCkgeyB2YXIgbGlzdCA9IFtdCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHYgPSBhcmd1bWVudHNbaV0KCQkJc3dpdGNoICh0eXBlb2YgdikgewoJCQkJY2FzZSBsYW5nLk9CSkVDVDogZm9yICh2YXIgaiA9IDA7IGogPCB2Lmxlbmd0aDsgaisrKSB7IGxpc3QucHVzaCh2W2pdKSB9IGJyZWFrCgkJCQljYXNlIGxhbmcuRlVOQ1RJT046IHYgPSB2KCkKCQkJCWRlZmF1bHQ6IHYgJiYgbGlzdC5wdXNoKHYrIiIpCgkJCX0KCQl9CgkJcmV0dXJuIGxpc3Quam9pbihpY2UuUFQpCgl9KSwKCVZhbHVlOiBzaHkoIuWtmOWCqOWZqCIsIGZ1bmN0aW9uKGRhdGEsIGtleSwgdmFsdWUpIHsKCQlpZiAoZGF0YSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIH0KCQlpZiAoa2V5ID09IHVuZGVmaW5lZCkgeyByZXR1cm4gZGF0YSB9CgoJCWlmICh0eXBlb2Yga2V5ID09IGxhbmcuT0JKRUNUICYmIGtleS5sZW5ndGggPiAwKSB7IGtleSA9IGtleS5qb2luKGljZS5QVCkgfQoJCWlmICh0eXBlb2Yga2V5ID09IGxhbmcuT0JKRUNUKSB7IGZvciAodmFyIGsgaW4ga2V5KSB7IGFyZ3VtZW50cy5jYWxsZWUuY2FsbCh0aGlzLCBkYXRhLCBrLCBrZXlba10pIH0gcmV0dXJuIGRhdGEgfQoKCQlpZiAodmFsdWUgIT0gdW5kZWZpbmVkKSB7CgkJCXZhciBfZGF0YSA9IGRhdGEKCgkJCXZhciBscyA9IGtleS5zcGxpdChpY2UuUFQpCgkJCWZvciAodmFyIGkgPSAwOyBpIDwgbHMubGVuZ3RoOyBpKyspIHsKCQkJCXZhciBfc3ViID0gX2RhdGFbbHNbaV1dfHx7fQoJCQkJX2RhdGFbbHNbaV1dID0gX3N1YgoJCQkJaWYgKGkgPT0gbHMubGVuZ3RoIC0gMSkgewoJCQkJCV9kYXRhW2xzW2ldXSA9IHZhbHVlCgkJCQl9IGVsc2UgewoJCQkJCV9kYXRhID0gX3N1YgoJCQkJfQoJCQl9CgkJCS8vIGRhdGFba2V5XSA9IHZhbHVlCgkJfQoJCWlmIChkYXRhW2tleV0gIT0gdW5kZWZpbmVkKSB7IHJldHVybiBkYXRhW2tleV0gfQoKCQl2YXIgcCA9IGRhdGEsIGxzID0ga2V5LnNwbGl0KGljZS5QVCk7IHdoaWxlIChwICYmIGxzLmxlbmd0aCA+IDApIHsKCQkJaWYgKGxzWzBdID09ICItMSIpIHsgbHNbMF0gPSBwLmxlbmd0aC0xIH0KCQkJcCA9IHBbbHNbMF1dLCBscyA9IGxzLnNsaWNlKDEpCgkJfSByZXR1cm4gcAoJfSksCglTcGxpdDogc2h5KCLliIbor43lmagiLCBmdW5jdGlvbihzdHIpIHsgaWYgKCFzdHIgfHwgIXN0ci5sZW5ndGgpIHsgcmV0dXJuIFtdIH0KCQl2YXIgb3B0ID0ge2RldGFpbDogZmFsc2V9LCBhcmcgPSBbXTsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKCQkJdHlwZW9mIGFyZ3VtZW50c1tpXSA9PSBsYW5nLk9CSkVDVD8gb3B0ID0gYXJndW1lbnRzW2ldOiBhcmcucHVzaChhcmd1bWVudHNbaV0pCgkJfQoKCQkvLyDlrZfnrKblrprkuYkKCQlmdW5jdGlvbiBfbGlzdChzdHIpIHsgdmFyIHJlcyA9IHt9OyBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgeyByZXNbc3RyW2ldXSA9IHRydWUgfTsgcmV0dXJuIHJlcyB9CgkJdmFyIHNwYWNlID0gX2xpc3QoYXJnWzBdfHwiXHQgLDtcbiIpICAvLyDnqbrnmb3nrKYKCQl2YXIgYmxvY2sgPSBfbGlzdChhcmdbMV18fCJ7WygpXX0iKSAgIC8vIOWIhumalOespgoJCXZhciBxdW90ZSA9IF9saXN0KGFyZ1syXXx8IidcImAiKSAgICAgLy8g5byV55So56ymCgkJdmFyIHRyYW5zID0gX2xpc3QoYXJnWzNdfHwiXFwiKSAgICAgICAvLyDovazkuYnnrKYKCgkJdmFyIHJlcyA9IFtdLCBiZWdpbiA9IDA7IGZ1bmN0aW9uIHB1c2gob2JqKSB7CgkJCW9iaiAmJiByZXMucHVzaCh0eXBlb2Ygb2JqID09IGxhbmcuU1RSSU5HIHx8IG9wdC5kZXRhaWw/IG9iajogb2JqLnRleHQpLCBiZWdpbiA9IC0xCgkJfQoKCQkvLyDlvIDlp4vliIbor40KCQlmb3IgKHZhciBzID0gIiIsIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7CgkJCWlmIChzcGFjZVtzdHJbaV1dKSB7IC8vIOepuueZveespgoJCQkJaWYgKHMpIHsgY29udGludWUgfQoJCQkJYmVnaW4gPiAtMSAmJiBwdXNoKHN0ci5zbGljZShiZWdpbiwgaSkpCgkJCQlvcHQuZGV0YWlsICYmIHB1c2goe3R5cGU6IGh0bWwuU1BBQ0UsIHRleHQ6IHN0ci5zbGljZShpLCBpKzEpfSkKCgkJCX0gZWxzZSBpZiAoYmxvY2tbc3RyW2ldXSkgeyAvLyDliIbpmpTnrKYKCQkJCWlmIChzKSB7IGNvbnRpbnVlIH0KCQkJCWJlZ2luID4gLTEgJiYgcHVzaChzdHIuc2xpY2UoYmVnaW4sIGkpKQoJCQkJcHVzaChzdHIuc2xpY2UoaSwgaSsxKSkKCgkJCX0gZWxzZSBpZiAocXVvdGVbc3RyW2ldXSkgeyAvLyDlvJXnlKjnrKYKCQkJCWlmIChzID09ICIiKSB7CgkJCQkJYmVnaW4gPiAtMSAmJiBwdXNoKHN0ci5zbGljZShiZWdpbiwgaSkpCgkJCQkJcyA9IHN0cltpXSwgYmVnaW4gPSBpKzEKCQkJCX0gZWxzZSBpZiAocyA9PSBzdHJbaV0pIHsKCQkJCQlwdXNoKHt0eXBlOiBsYW5nLlNUUklORywgdGV4dDogc3RyLnNsaWNlKGJlZ2luLCBpKSwgbGVmdDogcywgcmlnaHQ6IHN0cltpXX0pCgkJCQkJcyA9ICIiLCBiZWdpbiA9IC0xCgkJCQl9CgoJCQl9IGVsc2UgaWYgKHRyYW5zW3N0cltpXV0pIHsgLy8g6L2s5LmJ56ymCgkJCQliZWdpbiA9PSAtMSAmJiAoYmVnaW4gPSBpKyspCgoJCQl9IGVsc2UgeyAvLyDmma7pgJrnrKYKCQkJCWJlZ2luID09IC0xICYmIChiZWdpbiA9IGkpCgkJCX0KCQl9CgoJCS8vIOWJqeS9meWtl+espgoJCWJlZ2luID49IDAgJiYgKHM/IHB1c2goe3R5cGU6IGxhbmcuU1RSSU5HLCB0ZXh0OiBzdHIuc2xpY2UoYmVnaW4pLCBsZWZ0OiBzLCByaWdodDogIiJ9KTogcHVzaChzdHIuc2xpY2UoYmVnaW4pKSkKCQlyZXR1cm4gcmVzCgl9KSwKCUNhbGxGdW5jOiBzaHkoIuiwg+eUqOWZqCIsIGZ1bmN0aW9uKGZ1bmMsIGFyZ3MsIG1vZCkgeyBhcmdzID0gYXJnc3x8e30KCQl2YXIgZXZlbnQgPSBhcmdzWyJldmVudCJdfHx7fSwgY2FuID0gYXJnc1siY2FuIl18fGFyZ3NbMF0sIG1zZyA9IGFyZ3NbIm1zZyJdfHxhcmdzWzFdLCBjbWRzID0gYXJnc1siY21kcyJdfHxbXQoKCQkvLyDmn6Xmib7osIPnlKgKCQlmdW5jID0gdHlwZW9mIGZ1bmMgPT0gbGFuZy5GVU5DVElPTj8gZnVuYzogdHlwZW9mIGZ1bmMgPT0gbGFuZy5TVFJJTkc/IHRoaXMuVmFsdWUobW9kfHxjYW4sIGZ1bmMpOgoJCQl0eXBlb2YgZnVuYyA9PSBsYW5nLk9CSkVDVCAmJiBmdW5jLmxlbmd0aCA+IDA/IHRoaXMuVmFsdWUoZnVuY1swXSwgdGhpcy5LZXlzKGZ1bmMuc2xpY2UoMSkpKTogbnVsbAoJCWlmICh0eXBlb2YgZnVuYyAhPSBsYW5nLkZVTkNUSU9OKSB7IHJldHVybiB9CgoJCS8vIOino+aekOWPguaVsAoJCXZhciBsaXN0ID0gW10sIGVjaG8gPSBmYWxzZSwgY2IgPSBhcmdzWyJjYiJdCgkJdGhpcy5MaXN0KGZ1bmMudG9TdHJpbmcoKS5zcGxpdCgiKSIpWzBdLnNwbGl0KCIoIilbMV0uc3BsaXQoaWNlLkZTKSwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsgaXRlbSA9IGl0ZW0udHJpbSgpOyBpZiAoaXRlbSA9PSAiIikgeyByZXR1cm4gfQoJCQl2YXIgYXJnID0gYXJnc1tpdGVtXSB8fCBtc2cmJm1zZy5PcHRpb24mJm1zZy5PcHRpb24oaXRlbSkgfHwgY2FuJiZjYW4uQ29uZiYmY2FuLkNvbmYoaXRlbSkgfHwKCQkJCWV2ZW50JiYhKGV2ZW50IGluc3RhbmNlb2YgRXZlbnQpJiZldmVudFtpdGVtXSB8fCBhcmdzW2luZGV4XSB8fCBjbWRzW2luZGV4XSB8fCBudWxsCgkJCWlmIChpdGVtID09ICJjYiIpIHsgZWNobyA9IHRydWUgfQoJCQlsaXN0LnB1c2goYXJnKQoJCX0pCgoJCS8vIOaJp+ihjOiwg+eUqAoJCXZhciByZXMgPSBmdW5jLmFwcGx5KG1vZHx8Y2FuLCBsaXN0KQoJCWlmICghZWNobyAmJiB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTikgeyByZXMgJiYgbXNnICYmIG1zZy5FY2hvKHJlcyksIGFyZ3VtZW50cy5jYWxsZWUuYXBwbHkodGhpcywgW2NiLCB7bXNnOiBtc2csIHJlczogcmVzfV0pIH0KCQlyZXR1cm4gcmVzCgl9KSwKCglMaXN0OiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKGxpc3QsIGNiLCBpbnRlcnZhbCwgY2JzKSB7CgkJaWYgKHR5cGVvZiBsaXN0ID09IGxhbmcuU1RSSU5HKSB7IC8vIOm7mOiupOW6j+WIlwoJCQlsaXN0ID0gW2xpc3RdCgkJfSBlbHNlIGlmICh0eXBlb2YgbGlzdCA9PSBsYW5nLk5VTUJFUikgeyAvLyDnrYnlt67luo/liJcgW2VuZCBjYiBpbnRlcnZhbF18W2JlZ2luIGVuZCBpbnRlcnZhbF0KCQkJdmFyIGJlZ2luID0gMCwgZW5kID0gbGlzdCwgc3RlcCA9IHR5cGVvZiBpbnRlcnZhbCA9PSBsYW5nLk5VTUJFUj8gaW50ZXJ2YWw6IDEKCQkJaWYgKHR5cGVvZiBjYiA9PSBsYW5nLk5VTUJFUikgeyBiZWdpbiA9IGxpc3QsIGVuZCA9IGNiLCBjYiA9IG51bGwgfQoJCQlsaXN0ID0gW107IGZvciAodmFyIGkgPSBiZWdpbjsgaSA8IGVuZDsgaSArPSBzdGVwKSB7IGxpc3QucHVzaChpKSB9CgkJfQoKCQlsaXN0ID0gbGlzdHx8W10KCQlpZiAoaW50ZXJ2YWwgPiAwKSB7IC8vIOaXtumXtOW6j+WIlwoJCQlmdW5jdGlvbiBsb29wKGkpIHsgaWYgKGkgPj0gbGlzdC5sZW5ndGgpIHsgcmV0dXJuIHR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnMobGlzdCkgfQoJCQkJY2IobGlzdFtpXSwgaSwgbGlzdCksIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IGxvb3AoaSsxKSB9LCBpbnRlcnZhbCkKCQkJfQoJCQl0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTiAmJiBsaXN0Lmxlbmd0aCA+IDAgJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcCgwKSB9LCBpbnRlcnZhbC80KQoJCX0gZWxzZSB7IC8vIOmAieaLqeW6j+WIlwoJCQl2YXIgc2xpY2UgPSBbXSwgcmVzCgkJCWZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykgewoJCQkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04/IChyZXMgPSBjYihsaXN0W2ldLCBpLCBsaXN0KSkgIT0gdW5kZWZpbmVkICYmIHNsaWNlLnB1c2gocmVzKTogc2xpY2UucHVzaChsaXN0W2ldKQoJCQl9OyBsaXN0ID0gc2xpY2UKCQl9CgkJcmV0dXJuIGxpc3QKCX0pLAoJTmV4dDogc2h5KCLov63ku6PlmagiLCBmdW5jdGlvbihsaXN0LCBjYiwgY2JzKSB7CgkJc3dpdGNoICh0eXBlb2YgbGlzdCkgewoJCQljYXNlIGxhbmcuT0JKRUNUOiBpZiAobGlzdCA9PSBudWxsKSB7IGxpc3QgPSBbXTsgYnJlYWsgfQoJCQkJaWYgKGxpc3QubGVuZ3RoID09IHVuZGVmaW5lZCkgeyB2YXIgbHMgPSBbXTsgZm9yICh2YXIgayBpbiBsaXN0KSB7IGxzLnB1c2goaykgfSBsaXN0ID0gbHMgfSBicmVhawoJCQlkZWZhdWx0OiBpZiAobGlzdCA9PSB1bmRlZmluZWQpIHsgbGlzdCA9IFtdOyBicmVhayB9CgkJCQlsaXN0ID0gW2xpc3RdCgkJfQoKCQlmdW5jdGlvbiBuZXh0KGkpIHsgaSA8IGxpc3QubGVuZ3RoPyAgdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IobGlzdFtpXSwgZnVuY3Rpb24oKSB7IG5leHQoaSsxKSB9LCBpLCBsaXN0KToKCQkJCXR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnMobGlzdCkgfQoJCXJldHVybiBuZXh0KDApLCBsaXN0Cgl9KSwKCUl0ZW1zOiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKG9iaiwgY2IpIHsgdmFyIGxpc3QgPSBbXQoJCWZvciAodmFyIGsgaW4gb2JqKSB7CgkJCWxpc3QgPSBsaXN0LmNvbmNhdCh0aGlzLkxpc3Qob2JqW2tdLCBmdW5jdGlvbih2LCBpKSB7CgkJCQlyZXR1cm4gdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgY2IodiwgaSwgaywgb2JqKQoJCQl9KSkKCQl9CgkJcmV0dXJuIGxpc3QKCX0pLAoJSXRlbVNvcnQ6IHNoeSgi6L+t5Luj5ZmoIiwgZnVuY3Rpb24ob2JqLCBrZXksIGNiKSB7IHZhciBsaXN0ID0gW10KCQl2YXIgb3JkZXIgPSBbXSwga2V5cyA9IHt9LCB2YWxzID0ge30sIGkgPSAwCgkJZm9yICh2YXIgayBpbiBvYmopIHsgbyA9IG9ialtrXVtrZXldfHxpKysKCQkJb3JkZXIucHVzaChvKSwga2V5c1tvXSA9IGssIHZhbHNbb10gPSBvYmpba10KCQl9OyBvcmRlci5zb3J0KCkKCgkJZm9yICh2YXIgaSBpbiBvcmRlcikgeyB2YXIgayA9IG9yZGVyW2ldCgkJCXZhciByZXMgPSB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTj8gY2Ioa2V5c1trXSwgdmFsc1trXSk6IGsKCQkJcmVzICE9IHVuZGVmaW5lZCAmJiBsaXN0LnB1c2gocmVzKQoJCX0KCQlyZXR1cm4gbGlzdAoJfSksCglJdGVtOiBzaHkoIui/reS7o+WZqCIsIGZ1bmN0aW9uKG9iaiwgY2IpIHsgdmFyIGxpc3QgPSBbXQoJCWZvciAodmFyIGsgaW4gb2JqKSB7CgkJCXZhciByZXMgPSB0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTj8gY2Ioaywgb2JqW2tdKTogawoJCQlyZXMgIT0gdW5kZWZpbmVkICYmIGxpc3QucHVzaChyZXMpCgkJfQoJCXJldHVybiBsaXN0Cgl9KSwKCUl0ZW1DQjogc2h5KCLov63ku6PlmagiLCBmdW5jdGlvbihtZXRhLCBjYiwgY2FuLCBpdGVtKSB7IHZhciBsaXN0ID0gW10KCQlmb3IgKHZhciBrIGluIG1ldGEpIHsgKGZ1bmN0aW9uKGspIHsKCQkJaWYgKGsuaW5kZXhPZigib24iKSA9PSAwICYmIHR5cGVvZiBtZXRhW2tdID09IGxhbmcuRlVOQ1RJT04pIHsKCQkJCWlmICh0eXBlb2YgY2IgPT0gbGFuZy5GVU5DVElPTikgewoJCQkJCWNiKGssIG1ldGFba10pCgkJCQl9IGVsc2UgewoJCQkJCWNiW2tdID0gZnVuY3Rpb24oZXZlbnQpIHsgbWV0YVtrXShldmVudCwgY2FuLCBpdGVtKSB9CgkJCQl9CgkJCQlsaXN0LnB1c2goaykKCQkJfQoJCX0pKGspIH0KCQlyZXR1cm4gbGlzdAoJfSksCgoJU3BsaXRJbnB1dDogZnVuY3Rpb24oaXRlbSwgdHlwZSkgeyBpZiAodHlwZW9mIGl0ZW0gPT0gbGFuZy5PQkpFQ1QpIHsgcmV0dXJuIGl0ZW0gfQoJCXR5cGUgPSB0eXBlfHxodG1sLlRFWFQ7IHN3aXRjaCAoaXRlbSkgewoJCQljYXNlIG1kYi5MSVNUOiByZXR1cm4ge3R5cGU6IHR5cGUgPSBodG1sLkJVVFRPTiwgbmFtZTogaXRlbSwgYWN0aW9uOiBpY2UuQVVUT30KCQkJY2FzZSBjbGkuQkFDSzogcmV0dXJuIHt0eXBlOiB0eXBlID0gaHRtbC5CVVRUT04sIG5hbWU6IGl0ZW19CgkJCWNhc2UgbWRiLk5BTUU6IHJldHVybiB7dHlwZTogdHlwZSA9IGh0bWwuVEVYVCwgbmFtZTogaXRlbX0KCQkJY2FzZSBtZGIuVEVYVDogcmV0dXJuIHt0eXBlOiB0eXBlID0gaHRtbC5URVhUQVJFQSwgbmFtZTogaXRlbX0KCQkJZGVmYXVsdDogdmFyIGxzID0gdGhpcy5TcGxpdChpdGVtLCAiICIsICI6PUAiKSwgcmVzID0ge3R5cGU6IHR5cGUsIG5hbWU6IGxzWzBdfTsgZm9yICh2YXIgaSA9IDE7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgewoJCQkJCXN3aXRjaCAobHNbaV0pIHsKCQkJCQkJY2FzZSAiOiI6IHJlc1ttZGIuVFlQRV0gPSBsc1tpKzFdOyBicmVhawoJCQkJCQljYXNlICI9IjoKCQkJCQkJCWlmIChyZXNbbWRiLlRZUEVdID09IGh0bWwuU0VMRUNUKSB7CgkJCQkJCQkJcmVzLnZhbHVlcyA9IHRoaXMuU3BsaXQobHNbaSsxXSkKCQkJCQkJCQlmb3IgKHZhciBqID0gMTsgaiA8IHJlcy52YWx1ZXMubGVuZ3RoOyBqKyspIHsKCQkJCQkJCQkJaWYgKHJlcy52YWx1ZXNbMF0gPT0gIiIgfHwgcmVzLnZhbHVlc1swXSA9PSByZXMudmFsdWVzW2pdKSB7CgkJCQkJCQkJCQlyZXMudmFsdWUgPSByZXMudmFsdWVzWzBdLCByZXMudmFsdWVzID0gcmVzLnZhbHVlcy5zbGljZSgxKQoJCQkJCQkJCQkJYnJlYWsKCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJcmVzLnZhbHVlID0gbHNbaSsxXQoJCQkJCQkJfQoJCQkJCQkJYnJlYWsKCQkJCQkJY2FzZSAiQCI6IHJlc1tjdHguQUNUSU9OXSA9IGxzW2krMV07IGJyZWFrCgkJCQkJfQoJCQkJfSByZXR1cm4gcmVzCgkJfQoJfSwKCVRpbWVyMzAwbXM6IGZ1bmN0aW9uKGNiKSB7IHRoaXMuVGltZXIoMzAwLCBjYikgfSwKCVRpbWVyMzAwOiBmdW5jdGlvbihjYikgeyB0aGlzLlRpbWVyKDMwMCwgY2IpIH0sCglUaW1lcjNzOiBmdW5jdGlvbihjYikgeyB0aGlzLlRpbWVyKDMwMDAsIGNiKSB9LAoJVGltZXI6IHNoeSgi5a6a5pe25ZmoLCB2YWx1ZSwgWzEsMiwzLDRdLCB7aW50ZXJ2YWwsIGxlbmd0aH0iLCBmdW5jdGlvbihpbnRlcnZhbCwgY2IsIGNicykgewoJCXZhciB0aW1lciA9IHtzdG9wOiBmYWxzZX07IGZ1bmN0aW9uIGxvb3AoaSkgewoJCQl0aW1lci5zdG9wIHx8IGkgPj0gaW50ZXJ2YWwubGVuZ3RoICYmIGludGVydmFsLmxlbmd0aCA+PSAwIHx8IGNiKHRpbWVyLCBpbnRlcnZhbC5pbnRlcnZhbHx8aW50ZXJ2YWxbaV0sIGksIGludGVydmFsKT8KCQkJCXR5cGVvZiBjYnMgPT0gbGFuZy5GVU5DVElPTiAmJiBjYnModGltZXIsIGludGVydmFsKTogc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcChpKzEpIH0sIGludGVydmFsLmludGVydmFsfHxpbnRlcnZhbFtpKzFdKQoJCX0KCgkJaW50ZXJ2YWwgPSB0eXBlb2YgaW50ZXJ2YWwgPT0gbGFuZy5PQkpFQ1Q/IGludGVydmFsOiBbaW50ZXJ2YWxdCgkJaWYgKGludGVydmFsLmludGVydmFsID09IDApIHsgY2IoKTsgcmV0dXJuIHRpbWVyIH0KCgkJdHlwZW9mIGNiID09IGxhbmcuRlVOQ1RJT04gJiYgc2V0VGltZW91dChmdW5jdGlvbigpIHsgbG9vcCgwKSB9LCBpbnRlcnZhbC5pbnRlcnZhbHx8aW50ZXJ2YWxbMF0pCgkJcmV0dXJuIHRpbWVyCgl9KSwKfSkKCgpfY2FuX25hbWUgPSAiL2xpYi9wYWdlLmpzIgpWb2xjYW5vcygicGFnZSIsIHtoZWxwOiAi55So5oi355WM6Z2iIiwgQ2xhc3NMaXN0OiB7CgkJaGFzOiBmdW5jdGlvbihjYW4sIG9iaiwga2V5KSB7IHZhciBsaXN0ID0gb2JqLmNsYXNzTmFtZT8gb2JqLmNsYXNzTmFtZS5zcGxpdChpY2UuU1ApOiBbXQoJCQlyZXR1cm4gbGlzdC5pbmRleE9mKGtleSkgPiAtMQoJCX0sCgkJYWRkOiBmdW5jdGlvbihjYW4sIG9iaiwga2V5KSB7IHZhciBsaXN0ID0gb2JqLmNsYXNzTmFtZT8gb2JqLmNsYXNzTmFtZS5zcGxpdChpY2UuU1ApOiBbXQoJCQl2YXIgdmFsdWUgPSBjYW4uYmFzZS5BZGRVbmlxKGxpc3QsIGtleSkuam9pbihpY2UuU1ApLnRyaW0oKQoJCQlyZXR1cm4gdmFsdWUgIT0gb2JqLmNsYXNzTmFtZSAmJiAob2JqLmNsYXNzTmFtZSA9IHZhbHVlKSwgdmFsdWUKCQl9LAoJCWRlbDogZnVuY3Rpb24oY2FuLCBvYmosIGtleSkgeyB2YXIgbGlzdCA9IG9iai5jbGFzc05hbWU/IG9iai5jbGFzc05hbWUuc3BsaXQoaWNlLlNQKTogW10KCQkJcmV0dXJuIG9iai5jbGFzc05hbWUgPSBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiB2YWx1ZSA9PSBrZXk/IHVuZGVmaW5lZDogdmFsdWUgfSkuam9pbihpY2UuU1ApLnRyaW0oKQoJCX0sCgkJc2V0OiBmdW5jdGlvbihjYW4sIG9iaiwga2V5LCBjb25kaXRpb24pIHsKCQkJcmV0dXJuIChjb25kaXRpb24/IHRoaXMuYWRkKGNhbiwgb2JqLCBrZXkpOiB0aGlzLmRlbChjYW4sIG9iaiwga2V5KSkuaW5kZXhPZihrZXkpID4gLTEKCQl9LAoJCW5lZzogZnVuY3Rpb24oY2FuLCBvYmosIGtleSkgewoJCQlyZXR1cm4gKHRoaXMuaGFzKGNhbiwgb2JqLCBrZXkpPyB0aGlzLmRlbChjYW4sIG9iaiwga2V5KTogdGhpcy5hZGQoY2FuLCBvYmosIGtleSkpLmluZGV4T2Yoa2V5KSA+IC0xCgkJfSwKCX0sCglTZWxlY3RBcmdzOiBmdW5jdGlvbihjYW4sIG9wdGlvbiwga2V5LCBjYikgewoJCWlmIChjYW4uYmFzZS5pc1VuZGVmaW5lZChrZXkpKSB7IHZhciB2YWx1ZSA9IHt9CgkJCWNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBvcHRpb24sICIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCQlpdGVtLm5hbWUgJiYgaXRlbS52YWx1ZSAmJiAodmFsdWVbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWUpCgkJCX0pOyByZXR1cm4gW3ZhbHVlXQoJCX0KCQlpZiAoY2FuLmJhc2UuaXNPYmplY3Qoa2V5KSkgewoJCQlyZXR1cm4gY2FuLmNvcmUuSXRlbShrZXksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIG9wdGlvbiwga2V5LCB2YWx1ZSkgfSksIFtrZXldCgkJfQoJCWlmICghY2FuLmJhc2UuaXNGdW5jKGNiKSkgeyB2YXIgdmFsdWUgPSBjYjsgY2IgPSBmdW5jdGlvbihpdGVtKSB7IGlmIChpdGVtLnR5cGUgPT0gaHRtbC5CVVRUT04pIHsgcmV0dXJuIH0KCQkJcmV0dXJuIGl0ZW0ubmFtZSAmJiAoY2FuLmJhc2UuaXNVbmRlZmluZWQodmFsdWUpPyBpdGVtLnZhbHVlOiAoaXRlbS52YWx1ZSA9IHZhbHVlKSl8fCIiCgkJfSB9CgkJaWYgKGtleS5pbmRleE9mKGljZS5QVCkgPiAtMSkgeyByZXR1cm4gWyIiXX0KCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgb3B0aW9uLCBrZXk/ICJ0ZXh0YXJlYVtuYW1lPSIra2V5KyJdLCIrImlucHV0W25hbWU9IitrZXkrIl0sIisic2VsZWN0W25hbWU9IitrZXkrIl0iOiAiLmFyZ3MiLCBjYikKCX0sCglTZWxlY3RBbGw6IHNoeSgi6YCJ5oup6IqC54K5IiwgZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGtleSwgY2IsIGludGVydmFsLCBjYnMpIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuSUZSQU1FLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLlNlbGVjdEFsbChjYW4sIGl0ZW0uY29udGVudFdpbmRvdy5kb2N1bWVudC5ib2R5LCBrZXksIGNiLCBpbnRlcnZhbCwgY2JzKQoJCX0pCgkJcmV0dXJuIGNhbi5jb3JlLkxpc3QodGFyZ2V0ICYmIHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKGtleSksIGNiLCBpbnRlcnZhbCwgY2JzKQoJfSksCglTZWxlY3Q6IHNoeSgi6YCJ5oup6IqC54K5IiwgZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGtleSwgY2IsIGludGVydmFsLCBjYnMpIHsgaWYgKGtleSA9PSBpY2UuUFQpIHsgY2IodGFyZ2V0KTsgcmV0dXJuIFtdIH0KCQlyZXR1cm4gY2FuLmNvcmUuTGlzdCh0YXJnZXQgJiYgdGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoY2FuLnBhZ2UuS2V5cyhrZXkpKSwgY2IsIGludGVydmFsLCBjYnMpCgl9KSwKCU1vZGlmeTogc2h5KCLkv67mlLnoioLngrkiLCBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsgdGFyZ2V0ID0gdGFyZ2V0fHx7fQoJCXRhcmdldCA9IGNhbi5iYXNlLmlzT2JqZWN0KHRhcmdldCk/IHRhcmdldDogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpOyBpZiAoIXRhcmdldCkgeyByZXR1cm4gfQoJCWNhbi5iYXNlLmlzU3RyaW5nKHZhbHVlKT8gKHRhcmdldC5pbm5lckhUTUwgPSB2YWx1ZSk6IGNhbi5jb3JlLkl0ZW0odmFsdWUsIGZ1bmN0aW9uKGtleSwgdmFsKSB7CgkJCWtleSA9PSAiY2xhc3NOYW1lIiAmJiBjYW4uYmFzZS5pc0FycmF5KHZhbCkgJiYgKHZhbCA9IHZhbC5qb2luKGljZS5TUCkpCgkJCSFjYW4uYmFzZS5pc09iamVjdCh2YWwpPyAodGFyZ2V0W2tleV0gPSB2YWwpOiBjYW4uY29yZS5JdGVtKHZhbCwgZnVuY3Rpb24oaywgdikgewoJCQkJdmFyIHNpemUgPSB7CgkJCQkJImhlaWdodCI6IHRydWUsICJtYXgtaGVpZ2h0IjogdHJ1ZSwgIm1pbi1oZWlnaHQiOiB0cnVlLAoJCQkJCSJ3aWR0aCI6IHRydWUsICJtYXgtd2lkdGgiOiB0cnVlLCAibWluLXdpZHRoIjogdHJ1ZSwKCQkJCX0KCQkJCWlmIChzaXplW2tdICYmIHBhcnNlSW50KHYpIDwgMCkgeyByZXR1cm4gdGFyZ2V0W2tleV0gJiYgKHRhcmdldFtrZXldW2tdID0gIiIpIH0KCgkJCQl2YXIgc2l6ZSA9IHsKCQkJCQkibWFyZ2luLXRvcCI6IHRydWUsICJtYXJnaW4tbGVmdCI6IHRydWUsICJmb250LXNpemUiOiB0cnVlLAoJCQkJCSJsZWZ0IjogdHJ1ZSwgInJpZ2h0IjogdHJ1ZSwgInRvcCI6IHRydWUsICJib3R0b20iOiB0cnVlLAoJCQkJCSJoZWlnaHQiOiB0cnVlLCAibWF4LWhlaWdodCI6IHRydWUsICJtaW4taGVpZ2h0IjogdHJ1ZSwKCQkJCQkid2lkdGgiOiB0cnVlLCAibWF4LXdpZHRoIjogdHJ1ZSwgIm1pbi13aWR0aCI6IHRydWUsCgkJCQl9CgoJCQkJaWYgKHNpemVba10gJiYgdiAmJiAoY2FuLmJhc2UuaXNOdW1iZXIodikgfHwgdi5pbmRleE9mICYmIHYuaW5kZXhPZigicHgiKSA9PSAtMSkpIHsgdiArPSAicHgiIH0KCQkJCXRhcmdldFtrZXldICYmICh0YXJnZXRba2V5XVtrXSA9IHYpCgkJCX0pCgkJfSkKCQlyZXR1cm4gdGFyZ2V0Cgl9KSwKCVJlbW92ZTogc2h5KCLliKDpmaToioLngrkiLCBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCXJldHVybiB0YXJnZXQgJiYgdGFyZ2V0LnBhcmVudE5vZGUgJiYgdGFyZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGFyZ2V0KSwgdGFyZ2V0Cgl9KSwKCUNyZWF0ZTogc2h5KCLliJvlu7roioLngrkiLCBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudChrZXkpLCB2YWx1ZSkKCX0pLAoJQXBwZW5kOiBzaHkoIua3u+WKoOiKgueCuSIsIGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBrZXksIHZhbHVlKSB7IHZhbHVlID0gdmFsdWV8fHt9CgkJaWYgKGNhbi5iYXNlLmlzU3RyaW5nKGtleSkpIHsgdmFyIHJlcyA9IGNhbi5wYWdlLkNyZWF0ZShjYW4sIGtleSwgdmFsdWUpOyByZXR1cm4gdGFyZ2V0LmFwcGVuZENoaWxkKHJlcyksIHJlcyB9CgoJCWNhbi5jb3JlLkxpc3Qoa2V5LCBmdW5jdGlvbihpdGVtLCBpbmRleCkgeyBpZiAoIWl0ZW0pIHsgcmV0dXJuIH0KCQkJaWYgKGNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pKSB7IHRhcmdldC5pbm5lckhUTUwgPSBpdGVtOyByZXR1cm4gfQoJCQlpZiAoaXRlbS5ub2RlTmFtZSkgeyB0YXJnZXQuYXBwZW5kQ2hpbGQoaXRlbSk7IHJldHVybiB9CgoJCQkvLyDln7rmnKznu5PmnoQ6IHR5cGUgbmFtZSBkYXRhIGxpc3QKCQkJdmFyIHR5cGUgPSBpdGVtLnR5cGV8fGh0bWwuRElWLCBkYXRhID0gaXRlbS5kYXRhfHx7fQoJCQl2YXIgbmFtZSA9IGl0ZW0ubmFtZXx8ZGF0YS5uYW1lfHwiIgoKCQkJLy8g5pWw5o2u6LCD5pW0CgkJCWNhbi5jb3JlLkl0ZW0oaXRlbSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewoJCQkJc3dpdGNoIChrZXkpIHsKCQkJCQljYXNlIG1kYi5UWVBFOiBicmVhawoJCQkJCWNhc2UgbWRiLk5BTUU6IGJyZWFrCgkJCQkJY2FzZSBtZGIuREFUQTogYnJlYWsKCQkJCQljYXNlIG1kYi5MSVNUOiBicmVhawoJCQkJCWNhc2UgaHRtbC5JTk5FUjogZGF0YS5pbm5lckhUTUwgPSBpdGVtLmlubmVyOyBicmVhawoJCQkJCWNhc2UgaHRtbC5DTElDSzogZGF0YS5vbmNsaWNrID0gaXRlbS5jbGljazsgYnJlYWsKCQkJCQlkZWZhdWx0OiBkYXRhW2tleV0gPSBpdGVtW2tleV0KCQkJCX0KCQkJfSkKCgkJCS8vIOWfuuacrOexu+WeizogdmlldyB0ZXh0IGJ1dHRvbiBzZWxlY3QgaW5wdXQgdXNlcm5hbWUgcGFzc3dvcmQKCQkJLy8g5Z+65pys57G75Z6LOiBpbWcgcm93IHRoIHRkCgkJCWlmIChpdGVtLnZpZXcpIHsgdmFyIGxpc3QgPSBjYW4uY29yZS5MaXN0KGl0ZW0udmlldykKCQkJCWlmIChjYW4uYmFzZS5pc0FycmF5KGxpc3RbMF0pKSB7IGxpc3RbMF0gPSBsaXN0WzBdLmpvaW4oaWNlLlNQKSB9CgkJCQlsaXN0WzBdICYmIGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBkYXRhLCBsaXN0WzBdKQoJCQkJdHlwZSA9IGxpc3RbMV18fGh0bWwuRElWCgkJCQlkYXRhLmlubmVySFRNTCA9IGxpc3RbMl18fGRhdGEuaW5uZXJIVE1MfHwiIgoJCQkJbmFtZSA9IG5hbWV8fGxpc3RbM118fCIiCgoJCQl9IGVsc2UgaWYgKGl0ZW0udGV4dCkgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS50ZXh0KQoJCQkJZGF0YS5pbm5lckhUTUwgPSBsaXN0WzBdfHxkYXRhLmlubmVySFRNTHx8IiIKCQkJCXR5cGUgPSBsaXN0WzFdfHxodG1sLlNQQU4KCQkJCWxpc3RbMl0gJiYgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGRhdGEsIGxpc3RbMl0pCgoJCQl9IGVsc2UgaWYgKGl0ZW0uYnV0dG9uKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLmJ1dHRvbikKCQkJCXR5cGUgPSBodG1sLkJVVFRPTiwgbmFtZSA9IG5hbWV8fGxpc3RbMF0KCQkJCWRhdGEuaW5uZXJUZXh0ID0gY2FuLnVzZXIudHJhbnMoY2FuLCBsaXN0WzBdKSwgZGF0YS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmN0aW9uKGxpc3RbMV0pICYmIGxpc3RbMV0oZXZlbnQsIG5hbWUpCgkJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCQkJcmV0dXJuIHRydWUKCQkJCX0KCgkJCX0gZWxzZSBpZiAoaXRlbS5zZWxlY3QpIHsgdmFyIGxpc3QgPSBpdGVtLnNlbGVjdAoJCQkJdHlwZSA9IGh0bWwuU0VMRUNULCBkYXRhLm5hbWUgPSBuYW1lID0gbmFtZXx8bGlzdFswXVswXQoJCQkJZGF0YS50aXRsZSA9IGNhbi51c2VyLnRyYW5zKGNhbiwgZGF0YS50aXRsZXx8bmFtZSkKCQkJCWRhdGEuY2xhc3NOYW1lID0gZGF0YS5jbGFzc05hbWV8fGxpc3RbMF1bMF18fCIiCgoJCQkJaXRlbS5saXN0ID0gbGlzdFswXS5zbGljZSgxKS5tYXAoZnVuY3Rpb24odmFsdWUpIHsKCQkJCQlyZXR1cm4ge3R5cGU6IGh0bWwuT1BUSU9OLCB2YWx1ZTogdmFsdWUsIGlubmVyOiBjYW4udXNlci50cmFucyhjYW4sIHZhbHVlKX0KCQkJCX0pCgkJCQlkYXRhLm9uY2hhbmdlID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmN0aW9uKGxpc3RbMV0pICYmIGxpc3RbMV0oZXZlbnQsIGV2ZW50LnRhcmdldC52YWx1ZSwgbmFtZSkKCQkJCX0KCgkJCX0gZWxzZSBpZiAoaXRlbS5pbnB1dCkgeyB2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbS5pbnB1dCkKCQkJCXR5cGUgPSBodG1sLklOUFVULCBuYW1lID0gbmFtZXx8bGlzdFswXXx8IiIsIGRhdGEubmFtZSA9IGRhdGEubmFtZXx8bmFtZQoJCQkJZGF0YS5jbGFzc05hbWUgPSBkYXRhLmNsYXNzTmFtZXx8ZGF0YS5uYW1lCgkJCQlkYXRhLmF1dG9jb21wbGV0ZSA9ICJvZmYiCgoJCQkJZGF0YS5vbmZvY3VzID0gZGF0YS5vbmZvY3VzfHxmdW5jdGlvbihldmVudCkgewoJCQkJCWV2ZW50LnRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZSgwLCAtMSkKCQkJCX0KCQkJCWRhdGEub25rZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmN0aW9uKGxpc3RbMV0pICYmIGxpc3RbMV0oZXZlbnQpCgkJCQl9CgkJCQlkYXRhLm9ua2V5dXAgPSBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5iYXNlLmlzRnVuY3Rpb24obGlzdFsyXSkgJiYgbGlzdFsyXShldmVudCkKCQkJCX0KCQkJfSBlbHNlIGlmIChpdGVtLnVzZXJuYW1lKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLnVzZXJuYW1lKQoJCQkJdHlwZSA9IGh0bWwuSU5QVVQsIG5hbWUgPSBuYW1lfHxsaXN0WzBdfHxodG1sLlVTRVJOQU1FLCBkYXRhLm5hbWUgPSBkYXRhLm5hbWV8fG5hbWUKCQkJCWRhdGEuY2xhc3NOYW1lID0gbGlzdFsxXXx8ZGF0YS5jbGFzc05hbWV8fGRhdGEubmFtZQoJCQkJZGF0YS5hdXRvY29tcGxldGUgPSBkYXRhLmF1dG9jb21wbGV0ZXx8aHRtbC5VU0VSTkFNRQoKCQkJfSBlbHNlIGlmIChpdGVtLnBhc3N3b3JkKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLnBhc3N3b3JkKQoJCQkJdHlwZSA9IGh0bWwuSU5QVVQsIG5hbWUgPSBuYW1lfHxsaXN0WzBdfHxodG1sLlBBU1NXT1JELCBkYXRhLm5hbWUgPSBkYXRhLm5hbWV8fG5hbWUKCQkJCWRhdGEuY2xhc3NOYW1lID0gbGlzdFsxXXx8ZGF0YS5jbGFzc05hbWV8fGRhdGEubmFtZQoJCQkJZGF0YS5hdXRvY29tcGxldGUgPSBkYXRhLmF1dG9jb21wbGV0ZXx8ImN1cnJlbnQtcGFzc3dvcmQiCgkJCQlkYXRhLnR5cGUgPSBodG1sLlBBU1NXT1JECgoJCQl9IGVsc2UgaWYgKGl0ZW0uaW1nKSB7IHZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLmltZykKCQkJCXR5cGUgPSBodG1sLklNRywgZGF0YS5zcmMgPSBsaXN0WzBdCgoJCQl9IGVsc2UgaWYgKGl0ZW0ucm93KSB7IHR5cGUgPSBodG1sLlRSCgkJCQlpdGVtLmxpc3QgPSBpdGVtLnJvdy5tYXAoZnVuY3Rpb24odGV4dCkgeyByZXR1cm4ge3RleHQ6IFt0ZXh0LCBpdGVtLnN1Ynx8aHRtbC5URF19IH0pCgkJCX0gZWxzZSBpZiAoaXRlbS50aCkgeyB0eXBlID0gaHRtbC5UUgoJCQkJaXRlbS5saXN0ID0gaXRlbS50aC5tYXAoZnVuY3Rpb24odGV4dCkgeyByZXR1cm4ge3RleHQ6IFt0ZXh0LCBodG1sLlRIXX0gfSkKCQkJfSBlbHNlIGlmIChpdGVtLnRkKSB7IHR5cGUgPSBodG1sLlRSCgkJCQlpdGVtLmxpc3QgPSBpdGVtLnRkLm1hcChmdW5jdGlvbih0ZXh0KSB7IHJldHVybiB7dGV4dDogW3RleHQsIGh0bWwuVERdfSB9KQoJCQl9CgoJCQkvLyDor63oqIDovazmjaIKCQkJaWYgKHR5cGUgPT0gaHRtbC5JTlBVVCkgIHsgZGF0YS50eXBlID09IGh0bWwuQlVUVE9OICYmIChkYXRhLnZhbHVlID0gY2FuLnVzZXIudHJhbnMoY2FuLCBkYXRhLnZhbHVlKSkKCQkJCWlmIChkYXRhLnR5cGUgPT0gaHRtbC5URVhUfHxkYXRhLnR5cGUgPT0gaHRtbC5QQVNTV09SRHx8IWRhdGEudHlwZSkgeyBkYXRhLmF1dG9jb21wbGV0ZSA9IGRhdGEuYXV0b2NvbXBsZXRlfHwib2ZmIgoJCQkJCS8vIGRhdGEucGxhY2Vob2xkZXIgPSBjYW4udXNlci50cmFucyhjYW4sIChkYXRhLnBsYWNlaG9sZGVyfHxkYXRhLm5hbWV8fCIiKS5zcGxpdChpY2UuUFQpLnBvcCgpKQoJCQkJCWRhdGEucGxhY2Vob2xkZXIgPSAoZGF0YS5wbGFjZWhvbGRlcnx8ZGF0YS5uYW1lfHwiIikuc3BsaXQoaWNlLlBUKS5wb3AoKQoJCQkJCWRhdGEudGl0bGUgPSBjYW4udXNlci50cmFucyhjYW4sIGRhdGEudGl0bGV8fGRhdGEucGxhY2Vob2xkZXIpCgkJCQl9CgkJCX0KCQkJaWYgKHR5cGUgPT0gaHRtbC5URVhUQVJFQSkgIHsKCQkJCWRhdGEucGxhY2Vob2xkZXIgPSBjYW4udXNlci50cmFucyhjYW4sIChkYXRhLnBsYWNlaG9sZGVyfHxkYXRhLm5hbWV8fCIiKS5zcGxpdChpY2UuUFQpLnBvcCgpKQoJCQl9CgoJCQkvLyDliJvlu7roioLngrkKCQkJIWRhdGEubmFtZSAmJiBpdGVtLm5hbWUgJiYgKGRhdGEubmFtZSA9IGl0ZW0ubmFtZSkKCQkJdmFyIG5vZGUgPSBjYW4ucGFnZS5DcmVhdGUoY2FuLCB0eXBlLCBkYXRhKQoKCQkJLy8g5Yib5bu657Si5byVCgkJCW5hbWUgPSBuYW1lfHxkYXRhLmNsYXNzTmFtZXx8dHlwZXx8IiIKCQkJdmFsdWVbbmFtZXx8IiJdID0gdmFsdWVbZGF0YS5jbGFzc05hbWV8fCIiXSA9IHZhbHVlW3R5cGVdID0gbm9kZQoJCQl2YWx1ZS5maXJzdCA9IHZhbHVlLmZpcnN0fHxub2RlLCB2YWx1ZS5sYXN0ID0gbm9kZQoJCQl2YWx1ZS5fdGFyZ2V0ID0gdmFsdWUuX3RhcmdldHx8bm9kZQoKCQkJLy8g6YCS5b2S6IqC54K5CgkJCWl0ZW0ubGlzdCAmJiBjYW4ucGFnZS5BcHBlbmQoY2FuLCBub2RlLCBpdGVtLmxpc3QsIHZhbHVlKQoJCQl0YXJnZXQgJiYgdGFyZ2V0LmFwcGVuZENoaWxkICYmIHRhcmdldC5hcHBlbmRDaGlsZChub2RlKQoJCQljYW4uYmFzZS5pc0Z1bmMoaXRlbS5faW5pdCkgJiYgaXRlbS5faW5pdChub2RlLCB2YWx1ZSkKCQl9KQoJCXJldHVybiB2YWx1ZQoJfSksCglBcHBlbmRzOiBzaHkoIua3u+WKoOiKgueCuSIsIGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBrZXksIHZhbHVlKSB7CgkJcmV0dXJuIHRhcmdldC5pbm5lckhUTUwgPSAiIiwgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBrZXksIHZhbHVlKQoJfSksCgoJQXBwZW5kVGFibGU6IHNoeSgi5re75Yqg6KGo5qC8IiwgZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCwgbGlzdCwgY2IpIHsKCQlpZiAoIW1zZy5hcHBlbmR8fG1zZy5hcHBlbmQubGVuZ3RoID09IDApIHtyZXR1cm59CgoJCXZhciB0YWJsZSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgaHRtbC5UQUJMRSkKCQl2YXIgdGhlYWQgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YWJsZSwgInRoZWFkIikKCQl2YXIgdGJvZHkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YWJsZSwgInRib2R5IikKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0aGVhZCwgW3t0eXBlOiBodG1sLlRSLCBkYXRhOiB7ZGF0YXNldDoge2luZGV4OiAtMX19LCBsaXN0OiAKCQkJY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihrZXkpIHsKCQkJCXJldHVybiBrZXlbMF0gPT0gIl8iPyB1bmRlZmluZWQ6IHt0ZXh0OiBba2V5LnRyaW0oKSwgaHRtbC5USF19CgkJCX0pCgkJfV0pCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGJvZHksIGNhbi5jb3JlLkxpc3QobXNnLlRhYmxlKCksIGZ1bmN0aW9uKGxpbmUsIGluZGV4LCBhcnJheSkgewoJCQl2YXIgX2xpc3QgPSBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGtleSkgeyBpZiAoa2V5LmluZGV4T2YoIl8iKSA9PSAwKSB7IHJldHVybiB9CgkJCQlyZXR1cm4gY2IoY2FuLnBhZ2UuQ29sb3IobGluZVtrZXldKS50cmltKCksIGtleSwgaW5kZXgsIGxpbmUsIGFycmF5KQoJCQl9KQoJCQlyZXR1cm4gX2xpc3QubGVuZ3RoID4gMD8ge3R5cGU6IGh0bWwuVFIsIGRhdGFzZXQ6IHtpbmRleDogaW5kZXh9LCBsaXN0OiBfbGlzdH06IHVuZGVmaW5lZAoJCX0pKQoJCXJldHVybiBjYW4ucGFnZS5PcmRlclRhYmxlKGNhbiwgdGFibGUpCgl9KSwKCU9yZGVyVGFibGU6IGZ1bmN0aW9uKGNhbiwgdGFibGUpIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YWJsZSwgaHRtbC5USCwgZnVuY3Rpb24odGgsIGluZGV4KSB7CgkJCXRoLm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgeyB2YXIgZGF0YXNldCA9IGV2ZW50LnRhcmdldC5kYXRhc2V0CgkJCQlkYXRhc2V0WyJzb3J0X2FzYyJdID0gKGRhdGFzZXRbInNvcnRfYXNjIl0gPT0gIjEiKSA/IDA6IDEKCQkJCWNhbi5wYWdlLlJhbmdlVGFibGUoY2FuLCB0YWJsZSwgaW5kZXgsIGRhdGFzZXRbInNvcnRfYXNjIl0gPT0gIjEiKQoJCQl9CgkJfSkKCQlyZXR1cm4gdGFibGUKCX0sCglSYW5nZVRhYmxlOiBmdW5jdGlvbihjYW4sIHRhYmxlLCBpbmRleCwgc29ydF9hc2MpIHsKCQl2YXIgbGlzdCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhYmxlLCBodG1sLlRSLCBmdW5jdGlvbih0cikgewoJCQlyZXR1cm4gdHIuc3R5bGUuZGlzcGxheSA9PSBodG1sLk5PTkV8fGNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgImhpZGUiKT8gbnVsbDogdHIKCQl9KS5zbGljZSgxKQoKCQlpbmRleCA9IGNhbi5iYXNlLmlzT2JqZWN0KGluZGV4KT8gaW5kZXg6IFtpbmRleF0KCQlpbmRleCA9IGNhbi5jb3JlLkxpc3QoaW5kZXgsIGZ1bmN0aW9uKGl0ZW0pIHsgaWYgKGl0ZW0gPiAtMSkgeyByZXR1cm4gaXRlbX0gfSkKCQlpZiAoaW5kZXgubGVuZ3RoID09IDApIHsgcmV0dXJuIH0KCgkJdmFyIGlzX3RpbWUgPSB0cnVlLCBpc19udW1iZXIgPSB0cnVlCgkJY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbih0cikgewoJCQl2YXIgdGV4dCA9IHRyLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dAoJCQlpc190aW1lID0gaXNfdGltZSAmJiBEYXRlLnBhcnNlKHRleHQpID4gMAoJCQlpc19udW1iZXIgPSBpc19udW1iZXIgJiYgIWlzTmFOKHBhcnNlSW50KHRleHQpKQoJCX0pCgoJCXZhciBudW1fbGlzdCA9IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24odHIpIHsKCQkJdmFyIHRleHQgPSB0ci5jaGlsZE5vZGVzW2luZGV4WzBdXS5pbm5lclRleHQKCQkJcmV0dXJuIGlzX3RpbWU/IERhdGUucGFyc2UodGV4dCk6CgkJCQlpc19udW1iZXI/IGNhbi5iYXNlLlBhcnNlU2l6ZSh0ZXh0KTogdGV4dAoJCX0pCgkJZnVuY3Rpb24gaXNsZXNzKGEsIGIsIGluZGV4KSB7CgkJCWlmIChhLmNoaWxkTm9kZXNbaW5kZXhbMF1dICYmIGIuY2hpbGROb2Rlc1tpbmRleFswXV0pIHsKCQkJCWlmIChhLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dCA8IGIuY2hpbGROb2Rlc1tpbmRleFswXV0uaW5uZXJUZXh0KSB7IHJldHVybiB0cnVlIH0KCQkJCWlmIChhLmNoaWxkTm9kZXNbaW5kZXhbMF1dLmlubmVyVGV4dCA+IGIuY2hpbGROb2Rlc1tpbmRleFswXV0uaW5uZXJUZXh0KSB7IHJldHVybiBmYWxzZSB9CgkJCX0KCQkJcmV0dXJuIGluZGV4Lmxlbmd0aCA+IDEgJiYgaXNsZXNzKGEsIGIsIGluZGV4LnNsaWNlKDEpKQoJCX0KCgkJLy8g6YCJ5oup5o6S5bqPCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBudW1fbGlzdC5sZW5ndGg7IGkrKykgeyB2YXIgbWluID0gaQoJCQlmb3IgKHZhciBqID0gaSsxOyBqIDwgbnVtX2xpc3QubGVuZ3RoOyBqKyspIHsKCQkJCWlmIChudW1fbGlzdFttaW5dID09IG51bV9saXN0W2pdICYmIGluZGV4Lmxlbmd0aCA+IDEgJiYgbGlzdFtpbmRleFsxXV0pIHsKCQkJCQlpZiAoc29ydF9hc2M/IGlzbGVzcyhsaXN0W21pbl0sIGxpc3Rbal0sIGluZGV4LnNsaWNlKDEpKTogaXNsZXNzKGxpc3Rbal0sIGxpc3RbbWluXSwgaW5kZXguc2xpY2UoMSkpKSB7CgkJCQkJCW1pbiA9IGoKCQkJCQl9CgkJCQl9IGVsc2UgaWYgKHNvcnRfYXNjPyBudW1fbGlzdFttaW5dIDwgbnVtX2xpc3Rbal06IG51bV9saXN0W2pdIDwgbnVtX2xpc3RbbWluXSkgewoJCQkJCW1pbiA9IGoKCQkJCX0KCQkJfQoKCQkJaWYgKG1pbiAhPSBpKSB7CgkJCQl2YXIgdGVtcCA9IG51bV9saXN0W2ldOyBudW1fbGlzdFtpXSA9IG51bV9saXN0W21pbl07IG51bV9saXN0W21pbl0gPSB0ZW1wCgkJCQl2YXIgdGVtcCA9IGxpc3RbaV07IGxpc3RbaV0gPSBsaXN0W21pbl07IGxpc3RbbWluXSA9IHRlbXAKCQkJfQoKCQkJdmFyIHRib2R5ID0gbGlzdFtpXS5wYXJlbnRFbGVtZW50CgkJCWxpc3RbaV0ucGFyZW50RWxlbWVudCAmJiB0Ym9keS5yZW1vdmVDaGlsZChsaXN0W2ldKQoJCQl0Ym9keS5hcHBlbmRDaGlsZChsaXN0W2ldKQoJCX0KCX0sCgoJQ2FjaGU6IGZ1bmN0aW9uKG5hbWUsIG91dHB1dCwgZGF0YSkgeyBpZiAoIW5hbWUpIHsgcmV0dXJuIH0KCQl2YXIgY2FjaGUgPSBvdXRwdXQuX2NhY2hlfHx7fTsgb3V0cHV0Ll9jYWNoZSA9IGNhY2hlCgkJaWYgKGRhdGEpIHsgaWYgKG91dHB1dC5jaGlsZHJlbi5sZW5ndGggPT0gMCkgeyByZXR1cm4gfQoJCQl2YXIgdGVtcCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKQoJCQl3aGlsZSAob3V0cHV0LmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyAvLyDlhpnnvJPlrZgKCQkJCXZhciBpdGVtID0gb3V0cHV0LmNoaWxkTm9kZXNbMF0KCQkJCWl0ZW0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpdGVtKSwKCQkJCQl0ZW1wLmFwcGVuZENoaWxkKGl0ZW0pCgkJCX0KCQkJcmV0dXJuIGNhY2hlW25hbWVdID0ge25vZGU6IHRlbXAsIGRhdGE6IGRhdGF9LCBuYW1lCgkJfQoJCW91dHB1dC5pbm5lckhUTUwgPSAiIgoKCQl2YXIgbGlzdCA9IGNhY2hlW25hbWVdOyBpZiAoIWxpc3QpIHsgcmV0dXJuIH0KCQl3aGlsZSAobGlzdC5ub2RlLmNoaWxkTm9kZXMubGVuZ3RoID4gMCkgeyAvLyDor7vnvJPlrZgKCQkJdmFyIGl0ZW0gPSBsaXN0Lm5vZGUuY2hpbGROb2Rlc1swXQoJCQlpdGVtLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaXRlbSkKCQkJb3V0cHV0LmFwcGVuZENoaWxkKGl0ZW0pCgkJfQoJCXJldHVybiBkZWxldGUoY2FjaGVbbmFtZV0pLCBsaXN0LmRhdGEKCX0sCglGb3JtYXQ6IGZ1bmN0aW9uKHR5cGUpIHsKCQlzd2l0Y2ggKHR5cGUpIHsKCQkJY2FzZSBodG1sLkE6IHJldHVybiAiPGEgaHJlZj0nIithcmd1bWVudHNbMV0rIicgdGFyZ2V0PSdfYmxhbmsnPiIrKGFyZ3VtZW50c1syXXx8YXJndW1lbnRzWzFdKSsiPC9hPiIKCQkJY2FzZSBodG1sLklNRzogcmV0dXJuIGFyZ3VtZW50c1syXT8gIjxpbWcgc3JjPSciK2FyZ3VtZW50c1sxXSsiJyBoZWlnaHQ9Iithcmd1bWVudHNbMl0rIj4iOiAiPGltZyBzcmM9JyIrYXJndW1lbnRzWzFdKyInPiIKCQl9Cgl9LAoJcmVwbGFjZTogZnVuY3Rpb24oY2FuLCB0ZXh0LCBrZXksIHZhbHVlKSB7CgkJcmV0dXJuIGNhbi5iYXNlLnJlcGxhY2VBbGwodGV4dCwgIjwiLCAiJmx0OyIsICI+IiwgIiZndDsiLCBrZXksIHZhbHVlKQoJfSwKCUNvbG9yOiBmdW5jdGlvbih0ZXh0KSB7IGlmICh0eXBlb2YgdGV4dCAhPSBsYW5nLlNUUklORykgeyByZXR1cm4gIiIgfQoJCWlmICh0ZXh0LmluZGV4T2YoImh0dHA6Ly8iKSA9PSAwIHx8IHRleHQuaW5kZXhPZigiaHR0cHM6Ly8iKSA9PSAwIHx8IHRleHQuaW5kZXhPZigiZnRwOi8vIikgPT0gMCkgewoJCQl2YXIgbHMgPSB0ZXh0LnNwbGl0KGljZS5TUCk7CgkJCXRleHQgPSAiPGEgaHJlZj0nIitsc1swXSsiJyB0YXJnZXQ9J19ibGFuayc+Iitsc1swXSsiPC9hPiIrbHMuc2xpY2UoMSkuam9pbihpY2UuU1ApCgkJfTsgdGV4dCA9IHRleHQucmVwbGFjZSgvXFxuL2csICI8YnI+IikKCgkJaWYgKHRleHQuaW5kZXhPZigiXDAzM1xbIikgPT0gLTEpIHsgcmV0dXJuIHRleHQgfQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzMxbS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiNmMDAnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzJtL2csICI8c3BhbiBzdHlsZT0nY29sb3I6IzBmMCc+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFszM20vZywgIjxzcGFuIHN0eWxlPSdjb2xvcjojZmYwJz4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzM0bS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiMwMGYnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzZtL2csICI8c3BhbiBzdHlsZT0nY29sb3I6IzBmZic+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFszNDsxbS9nLCAiPHNwYW4gc3R5bGU9J2NvbG9yOiMwMGYnPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbMzc7MW0vZywgIjxzcGFuIHN0eWxlPSdjb2xvcjojZmZmJz4iKQoJCXRleHQgPSB0ZXh0LnJlcGxhY2UoL1wwMzNcWzFtL2csICI8c3BhbiBzdHlsZT0nZm9udC13ZWlnaHQ6Ym9sZCc+IikKCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cMDMzXFswbS9nLCAiPC9zcGFuPiIpCgkJdGV4dCA9IHRleHQucmVwbGFjZSgvXDAzM1xbbS9nLCAiPC9zcGFuPiIpCgkJcmV0dXJuIHRleHQKCX0sCglpbnB1dDogZnVuY3Rpb24oY2FuLCBpdGVtLCB2YWx1ZSkgewoJCXZhciBpbnB1dCA9IHt0eXBlOiBodG1sLklOUFVULCBuYW1lOiBpdGVtLm5hbWUsIGRhdGE6IGl0ZW0sIGRhdGFzZXQ6IHt9LCBfaW5pdDogaXRlbS5faW5pdCwgc3R5bGU6IGl0ZW0uc3R5bGV8fHt9fQoJCWl0ZW0udmFsdWUgPT0gaWNlLkFVVE8gJiYgKGl0ZW0udmFsdWUgPSAiIiwgaXRlbS5hY3Rpb24gPSBpY2UuQVVUTyksIGl0ZW0uYWN0aW9uID09IGljZS5BVVRPICYmIChpbnB1dC5kYXRhc2V0LmFjdGlvbiA9IGljZS5BVVRPKQoKCQlzd2l0Y2ggKGl0ZW0udHlwZSA9IGl0ZW0udHlwZXx8aHRtbC5URVhUKSB7CgkJCWNhc2UgaHRtbC5URVhUQVJFQTogaW5wdXQudHlwZSA9IGh0bWwuVEVYVEFSRUEKCQkJCWlucHV0LnN0eWxlLmhlaWdodCA9IGlucHV0LnN0eWxlLmhlaWdodHx8Y2FuLkNvbmYoW2N0eC5GRUFUVVJFLCBodG1sLlRFWFRBUkVBLCBpdGVtLm5hbWUsIGh0bWwuSEVJR0hUXS5qb2luKGljZS5QVCkpfHxjYW4uQ29uZihbImZlYXR1cmUiLCBodG1sLlRFWFRBUkVBLCBodG1sLkhFSUdIVF0uam9pbihpY2UuUFQpKQoJCQkJaW5wdXQuc3R5bGUud2lkdGggPSBpbnB1dC5zdHlsZS53aWR0aHx8Y2FuLkNvbmYoW2N0eC5GRUFUVVJFLCBodG1sLlRFWFRBUkVBLCBpdGVtLm5hbWUsIGh0bWwuV0lEVEhdLmpvaW4oaWNlLlBUKSl8fGNhbi5Db25mKFsiZmVhdHVyZSIsIGh0bWwuVEVYVEFSRUEsIGh0bWwuV0lEVEhdLmpvaW4oaWNlLlBUKSkKCQkJCS8vIG5vIGJyZWFrCgkJCWNhc2UgaHRtbC5VU0VSTkFNRToKCQkJY2FzZSBodG1sLlBBU1NXT1JEOgoJCQkJLy8gbm8gYnJlYWsKCQkJY2FzZSBodG1sLlRFWFQ6CgkJCQlpdGVtLmF1dG9jb21wbGV0ZSA9ICJvZmYiCgkJCQlpdGVtLm5hbWUgPSBpdGVtLm5hbWV8fGl0ZW0udHlwZQoJCQkJaXRlbS52YWx1ZSA9IHZhbHVlfHxpdGVtLnZhbHVlfHwiIgoJCQkJaXRlbS5wbGFjZWhvbGRlciA9IGl0ZW0ucGxhY2Vob2xkZXJ8fGl0ZW0ubmFtZXx8aXRlbS50eXBlCgkJCQlpdGVtLnRpdGxlID0gaXRlbS50aXRsZXx8aXRlbS5wbGFjZWhvbGRlcnx8aXRlbS5uYW1lfHxpdGVtLnR5cGUKCQkJCWl0ZW0uY2xhc3NOYW1lIHx8IGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCBjdHguQVJHUykKCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5TRUxFQ1Q6IGlucHV0LnR5cGUgPSBodG1sLlNFTEVDVAoJCQkJaXRlbS52YWx1ZXMgPSBjYW4uYmFzZS5pc1N0cmluZyhpdGVtLnZhbHVlcyk/IGNhbi5jb3JlLlNwbGl0KGl0ZW0udmFsdWVzKTogaXRlbS52YWx1ZXMKCQkJCWlmICghaXRlbS52YWx1ZXMgJiYgaXRlbS52YWx1ZSkgeyBpdGVtLnZhbHVlcyA9IGNhbi5jb3JlLlNwbGl0KGl0ZW0udmFsdWUpLCBpdGVtLnZhbHVlID0gaXRlbS52YWx1ZXNbMF0gfQoKCQkJCWl0ZW0udmFsdWUgPSB2YWx1ZXx8aXRlbS52YWx1ZSwgaW5wdXQubGlzdCA9IGl0ZW0udmFsdWVzLm1hcChmdW5jdGlvbih2YWx1ZSkgewoJCQkJCXJldHVybiB7dHlwZTogaHRtbC5PUFRJT04sIHZhbHVlOiB2YWx1ZSwgaW5uZXI6IHZhbHVlfQoJCQkJfSksIGl0ZW0uY2xhc3NOYW1lIHx8IGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCBjdHguQVJHUykKCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5CVVRUT046IGl0ZW0udmFsdWUgPSBpdGVtLnZhbHVlfHxpdGVtLm5hbWV8fG1kYi5MSVNUOyBicmVhawoJCQljYXNlICJ1cGZpbGUiOiBpdGVtLnR5cGUgPSBodG1sLkZJTEU7IGJyZWFrCgkJCWNhc2UgaHRtbC5VUExPQUQ6IGl0ZW0udHlwZSA9IGh0bWwuRklMRSwgaW5wdXQubmFtZSA9IGh0bWwuVVBMT0FEOyBicmVhawoJCQlkZWZhdWx0OgoJCX0KCQlyZXR1cm4gaW5wdXQKCX0sCgoJc3R5bGVEaXNwbGF5OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuRElTUExBWSwgdmFsdWUpLCB0YXJnZXQuc3R5bGUuZGlzcGxheQoJfSwKCXN0eWxlSGVpZ2h0OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuSEVJR0hULCB2YWx1ZSksIHRhcmdldC5vZmZzZXRIZWlnaHQKCX0sCglzdHlsZVdpZHRoOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdmFsdWUpIHsKCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuV0lEVEgsIHZhbHVlKSwgdGFyZ2V0Lm9mZnNldFdpZHRoCgl9LAoJc3R5bGU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBzdHlsZSkgeyB2YXIgdmFsdWUgPSB7fQoJCWZvciAodmFyIGkgPSAyOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSArPSAyKSB7CgkJCWlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09IGxhbmcuT0JKRUNUKSB7CgkJCQljYW4uYmFzZS5Db3B5KHZhbHVlLCBhcmd1bWVudHNbaS0tXSkKCQkJfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09IGxhbmcuVU5ERUZJTkVEKSB7CgkJCQljb250aW51ZQoJCQl9IGVsc2UgewoJCQkJdmFsdWVbYXJndW1lbnRzW2ldXSA9IGFyZ3VtZW50c1tpKzFdCgkJCX0KCQl9CgkJcmV0dXJuIGNhbi5wYWdlLk1vZGlmeShjYW4sIHRhcmdldCwge3N0eWxlOiB2YWx1ZX0pLCB2YWx1ZQoJfSwKCUtleXM6IGZ1bmN0aW9uKCkgeyB2YXIgbGlzdCA9IFtdIC8vIEZTIFNQIEdUIFBUCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHYgPSBhcmd1bWVudHNbaV0KCQkJaWYgKHR5cGVvZiB2ID09IGxhbmcuT0JKRUNUKSB7CgkJCQlmb3IgKHZhciBqID0gMDsgaiA8IHYubGVuZ3RoOyBqKyspIHsKCQkJCQlpZiAodHlwZW9mIHZbal0gPT0gbGFuZy5PQkpFQ1QpIHsKCQkJCQkJZm9yICh2YXIgayA9IDA7IGsgPCB2W2pdLmxlbmd0aDsgaysrKSB7CgkJCQkJCQlpZiAodHlwZW9mIHZbal1ba10gPT0gbGFuZy5PQkpFQ1QpIHsgdltqXVtrXSA9IHZbal1ba10uam9pbihpY2UuUFQpIH0KCQkJCQkJfQoJCQkJCQl2W2pdID0gdltqXS5qb2luKGljZS5HVCkKCQkJCQl9CgkJCQl9CgkJCQlsaXN0LnB1c2godi5qb2luKGljZS5TUCkpCgkJCX0gZWxzZSB7CgkJCQlsaXN0LnB1c2godisiIikKCQkJfQoJCX0KCQlyZXR1cm4gbGlzdC5qb2luKGljZS5GUykKCX0sCgljc3M6IGZ1bmN0aW9uKHRleHQpIHsKCQl2YXIgc3R5bGVTaGVldCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIikKCQlzdHlsZVNoZWV0LnR5cGUgPSAidGV4dC9jc3MiLCBzdHlsZVNoZWV0LmlubmVyVGV4dCA9IHRleHQKCQlkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlU2hlZXQpCgl9LAoJdGFnaXM6IGZ1bmN0aW9uKHR5cGUsIHRhcmdldCkgeyB0eXBlID0gdHlwZW9mIHR5cGUgPT0gbGFuZy5PQkpFQ1Q/IHR5cGU6IFt0eXBlXQoJCWlmICh0eXBlLmluZGV4T2YodGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKSkgPiAtMSkgeyByZXR1cm4gdHJ1ZSB9Cgl9LAoJb2Zmc2V0VG9wOiBmdW5jdGlvbihpdGVtKSB7IHZhciByZXMgPSAwCgkJd2hpbGUgKGl0ZW0pIHsgcmVzICs9IGl0ZW0ub2Zmc2V0VG9wfHwwLCBpdGVtID0gaXRlbS5wYXJlbnROb2RlIH0KCQlyZXR1cm4gcmVzCgl9LAoJb2Zmc2V0TGVmdDogZnVuY3Rpb24oaXRlbSkgeyB2YXIgcmVzID0gMAoJCS8vIGlmIChpdGVtLm9mZnNldExlZnQpIHsgcmV0dXJuIGl0ZW0ub2Zmc2V0TGVmdCB9CgkJd2hpbGUgKGl0ZW0pIHsgcmVzICs9IGl0ZW0ub2Zmc2V0TGVmdHx8MCwgaXRlbSA9IGl0ZW0ucGFyZW50Tm9kZSB9CgkJcmV0dXJuIHJlcwoJfSwKCglBcHBlbmRWdWU6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgbGlzdCwgdGFyZ2V0KSB7CgkJY2FuLnJlcXVpcmUoWyJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL3Z1ZUAyL2Rpc3QvdnVlLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucmVxdWlyZShbImh0dHBzOi8vdW5wa2cuY29tL2VsZW1lbnQtdWkvbGliL2luZGV4LmpzIiwgImh0dHBzOi8vdW5wa2cuY29tL2VsZW1lbnQtdWkvbGliL3RoZW1lLWNoYWxrL2luZGV4LmNzcyJdLCBmdW5jdGlvbigpIHsKCQkJCW5ldyBWdWUoY2FuLmJhc2UuQ29weSh7ZWw6IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldHx8Y2FuLl9vdXRwdXQsIFt7dHlwZTogImRpdiIsIGlubmVyOiBsaXN0fV0pLmZpcnN0fSwgbWV0YSkpCgkJCX0pCgkJfSkKCX0sCgoJaW5zZXJ0QmVmb3JlOiBmdW5jdGlvbihjYW4sIGxpc3QsIGJlZm9yZSkgewoJCXZhciBpdGVtID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgYmVmb3JlLnBhcmVudE5vZGUsIGxpc3QpLmZpcnN0CgkJYmVmb3JlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGl0ZW0sIGJlZm9yZSkKCQlyZXR1cm4gaXRlbQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL2xpYi9iYXNlLmpzIgpWb2xjYW5vcygiYmFzZSIsIHtoZWxwOiAi5pWw5o2u57G75Z6LIiwgSW50OiBmdW5jdGlvbih2YWwsIGRlZikgeyByZXR1cm4gcGFyc2VJbnQodmFsKXx8ZGVmfHwwIH0sCglNaW46IGZ1bmN0aW9uKHZhbCwgbWluKSB7IHJldHVybiB2YWwgPiBtaW4/IHZhbDogbWluIH0sCglPYmo6IGZ1bmN0aW9uKHZhbCwgZGVmKSB7CgkJdHJ5IHsKCQkJaWYgKHR5cGVvZiB2YWwgPT0gbGFuZy5TVFJJTkcpIHsgaWYgKHZhbCA9PSAiIikgeyByZXR1cm4gZGVmIH0gdmFsID0gSlNPTi5wYXJzZSh2YWwpIH0KCQkJaWYgKHZhbC5sZW5ndGggPiAwKSB7IHJldHVybiB2YWwgfSBmb3IgKHZhciBrIGluIHZhbCkgeyByZXR1cm4gdmFsIH0gcmV0dXJuIGRlZgoJCX0gY2F0Y2ggKGUpIHsgcmV0dXJuIHZhbCAmJiB2YWwuc3BsaXQgJiYgdmFsLnNwbGl0KGljZS5GUykgfHwgZGVmIH0KCX0sCglDb3B5OiBmdW5jdGlvbih0bywgZnJvbSkgewoJCWlmIChhcmd1bWVudHMubGVuZ3RoID09IDIpIHsKCQkJZm9yICh2YXIgayBpbiBmcm9tKSB7IHRvW2tdID0gZnJvbVtrXSB9CgkJCXJldHVybiB0bwoJCX0KCQlmb3IgKHZhciBpID0gMjsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJCQl2YXIgayA9IGFyZ3VtZW50c1tpXTsgdG9ba10gPSBmcm9tW2tdCgkJfQoJCXJldHVybiB0bwoJfSwKCUVxOiBmdW5jdGlvbih0bywgZnJvbSkgeyB2YXIgY2FsbCA9IGFyZ3VtZW50cy5jYWxsZWUKCQlpZiAodHlwZW9mIHRvICE9IHR5cGVvZiBmcm9tKSB7IHJldHVybiBmYWxzZSB9CgkJaWYgKHR5cGVvZiB0byA9PSBsYW5nLk9CSkVDVCkgewoJCQlpZiAodG8ubGVuZ3RoICE9IGZyb20ubGVuZ3RoKSB7IHJldHVybiBmYWxzZSB9CgkJCWZvciAodmFyIGkgPSAwOyBpIDwgdG8ubGVuZ3RoOyBpKyspIHsKCQkJCWlmICghY2FsbCh0b1tpXSwgZnJvbVtpXSkpIHsgcmV0dXJuIGZhbHNlIH0KCQkJfQoJCQlmb3IgKHZhciBrIGluIHRvKSB7CgkJCQlpZiAoIWNhbGwodG9ba10sIGZyb21ba10pKSB7IHJldHVybiBmYWxzZSB9CgkJCX0KCQkJcmV0dXJuIHRydWUKCQl9CgkJcmV0dXJuIHRvID09PSBmcm9tCgl9LAoKCUV4dDogZnVuY3Rpb24ocGF0aCkgeyByZXR1cm4gKHBhdGguc3BsaXQoaWNlLlBTKS5wb3AoKS5zcGxpdChpY2UuUFQpLnBvcCgpKS50b0xvd2VyQ2FzZSgpIH0sCglQYXRoOiBmdW5jdGlvbihwYXRoKSB7IHZhciByZXMgPSAiIgoJCWZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IGlmICghYXJndW1lbnRzW2ldKSB7IGNvbnRpbnVlIH0KCQkJcmVzICs9IChhcmd1bWVudHNbaV1bMF09PWljZS5QUyB8fCByZXM9PSIiIHx8IHJlc1tyZXMubGVuZ3RoLTFdPT1pY2UuUFM/ICIiOiBpY2UuUFMpICsgYXJndW1lbnRzW2ldLnRyaW0oKQoJCX0KCQlyZXR1cm4gcmVzCgl9LAoJQXJnczogZnVuY3Rpb24oKSB7IHZhciByZXMgPSBbXQoJCWZvciAodmFyIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSArPSAyKSB7CgkJCWlmICh0eXBlb2YgYXJndW1lbnRzW2ldID09IGxhbmcuT0JKRUNUKSB7CgkJCQlmb3IgKHZhciBrIGluIGFyZ3VtZW50c1tpXSkgeyByZXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoaykrIj0iK2VuY29kZVVSSUNvbXBvbmVudChhcmd1bWVudHNbaV1ba10pKSB9CgkJCQlpLS07IGNvbnRpbnVlCgkJCX0gZWxzZSBpZiAoYXJndW1lbnRzW2ldKSB7IAoJCQkJcmVzLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGFyZ3VtZW50c1tpXSkrIj0iK2VuY29kZVVSSUNvbXBvbmVudChhcmd1bWVudHNbaSsxXSkpCgkJCX0KCQl9CgkJcmV0dXJuIHJlcy5qb2luKCImIikKCX0sCglNZXJnZVVSTDogZnVuY3Rpb24odXJsKSB7CgkJdmFyIGFyZ3MgPSB7fTsgKHVybC5zcGxpdCgiPyIpWzFdfHwiIikuc3BsaXQoIiYiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsgaWYgKCFpdGVtKSB7IHJldHVybiB9CgkJCXZhciBscyA9IGl0ZW0uc3BsaXQoIj0iKTsgYXJnc1tkZWNvZGVVUklDb21wb25lbnQobHNbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChsc1sxXSkKCQl9KQoJCWZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CgkJCXN3aXRjaCAodHlwZW9mIGFyZ3VtZW50c1tpXSkgewoJCQkJY2FzZSBsYW5nLlNUUklORzogYXJnc1thcmd1bWVudHNbaV1dID0gYXJndW1lbnRzW2krMV0sIGkrKzsgYnJlYWsKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6CgkJCQkJaWYgKGFyZ3VtZW50c1tpXS5sZW5ndGggPiAwKSB7CgkJCQkJCWZvciAodmFyIGogPSAwOyBqIDwgYXJndW1lbnRzW2ldLmxlbmd0aDsgaiArPSAyKSB7IGFyZ3NbYXJndW1lbnRzW2ldW2pdXSA9IGFyZ3VtZW50c1tpXVtqXSB9CgkJCQkJfSBlbHNlIHsKCQkJCQkJZm9yICh2YXIgayBpbiBhcmd1bWVudHNbaV0pIHsgYXJnc1trXSA9IGFyZ3VtZW50c1tpXVtrXSB9CgkJCQkJfQoJCQkJCWJyZWFrCgkJCX0KCQl9CgkJdmFyIGxpc3QgPSBbXTsgZm9yICh2YXIgayBpbiBhcmdzKSB7IGxpc3QucHVzaChlbmNvZGVVUklDb21wb25lbnQoaykrIj0iK2VuY29kZVVSSUNvbXBvbmVudChhcmdzW2tdKSkgfQoJCXJldHVybiB1cmwuc3BsaXQoIj8iKVswXSsobGlzdC5sZW5ndGg+MD8gIj8iK2xpc3Quam9pbigiJiIpOiAiIikKCX0sCglQYXJzZVVSTDogZnVuY3Rpb24odXJsKSB7IHZhciByZXMgPSB7bGluazogdXJsfQoJCXZhciBsaXN0ID0gdXJsLnNwbGl0KCI/Iik7IHJlc1sib3JpZ2luIl0gPSBsaXN0WzBdCgkJbGlzdFsxXSAmJiBsaXN0WzFdLnNwbGl0KCImIikuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CgkJCXZhciBscyA9IGl0ZW0uc3BsaXQoIj0iKTsgcmVzW2RlY29kZVVSSUNvbXBvbmVudChsc1swXSldID0gZGVjb2RlVVJJQ29tcG9uZW50KGxzWzFdKQoJCX0pCgkJcmV0dXJuIHJlcwoJfSwKCVBhcnNlSlNPTjogZnVuY3Rpb24oc3RyKSB7IHZhciByZXMKCQlpZiAodHlwZW9mIHN0ciA9PSBsYW5nLk9CSkVDVCkgeyByZXR1cm4gc3RyIH0KCQlpZiAoc3RyLmluZGV4T2YoImh0dHAiKSA9PSAwKSB7IHZhciBscyA9IHN0ci5zcGxpdCgiPyIpCgkJCXJlcyA9IHt0eXBlOiBtZGIuTElOSywgbmFtZTogIiIsIHRleHQ6IHN0cn0KCQkJcmVzLm5hbWUgPSBsc1swXS5zcGxpdCgiOi8vIikucG9wKCkuc3BsaXQoaWNlLlBTKVswXQoJCQlsc1sxXSAmJiBsc1sxXS5zcGxpdCgiJiIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgeyB2YXIgbHMgPSBpdGVtLnNwbGl0KCI9IikKCQkJCXJlc1tkZWNvZGVVUklDb21wb25lbnQobHNbMF0pXSA9IGRlY29kZVVSSUNvbXBvbmVudChsc1sxXSkKCQkJfSkKCQkJcmV0dXJuIHJlcwoJCX0KCQl0cnkgeyByZXMgPSBKU09OLnBhcnNlKHN0ciksIHJlcy50ZXh0ID0gcmVzLnRleHR8fHN0ciwgcmVzLnR5cGUgPSByZXMudHlwZXx8bmZzLkpTT04KCQl9IGNhdGNoIChlKSB7IHJlcyA9IHt0eXBlOiBtZGIuVEVYVCwgdGV4dDogc3RyfSB9CgkJcmV0dXJuIHJlcwoJfSwKCVBhcnNlU2l6ZTogZnVuY3Rpb24oc2l6ZSkgeyBzaXplID0gc2l6ZS50b0xvd2VyQ2FzZSgpCgkJaWYgKHNpemUuZW5kc1dpdGgoInRiIikgfHwgc2l6ZS5lbmRzV2l0aCgidCIpKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplKSAqIDEwMjQgKiAxMDI0ICogMTAyNCAqIDEwMjQKCQl9CgkJaWYgKHNpemUuZW5kc1dpdGgoImdiIikgfHwgc2l6ZS5lbmRzV2l0aCgiZyIpKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplKSAqIDEwMjQgKiAxMDI0ICogMTAyNAoJCX0KCQlpZiAoc2l6ZS5lbmRzV2l0aCgibWIiKSB8fCBzaXplLmVuZHNXaXRoKCJtIikpIHsKCQkJcmV0dXJuIHBhcnNlSW50KHNpemUpICogMTAyNCAqIDEwMjQKCQl9CgkJaWYgKHNpemUuZW5kc1dpdGgoImtiIikgfHwgc2l6ZS5lbmRzV2l0aCgiayIpKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplKSAqIDEwMjQKCQl9CgkJcmV0dXJuIHBhcnNlSW50KHNpemUpCgl9LAoKCVNpemU6IGZ1bmN0aW9uKHNpemUpIHsgc2l6ZSA9IHBhcnNlSW50KHNpemUpCgkJaWYgKHNpemUgPiAxMDAwMDAwMDAwKSB7CgkJCXJldHVybiBwYXJzZUludChzaXplLzEwMDAwMDAwMDApICsgaWNlLlBUICsgcGFyc2VJbnQoc2l6ZS8xMDAwMDAwMCUxMDApICsgIkciCgkJfQoJCWlmIChzaXplID4gMTAwMDAwMCkgewoJCQlyZXR1cm4gcGFyc2VJbnQoc2l6ZS8xMDAwMDAwKSArIGljZS5QVCArIHBhcnNlSW50KHNpemUvMTAwMDAlMTAwKSArICJNIgoJCX0KCQlpZiAoc2l6ZSA+IDEwMDApIHsKCQkJcmV0dXJuIHBhcnNlSW50KHNpemUvMTAwMCkgKyBpY2UuUFQgKyBwYXJzZUludChzaXplLzEwJTEwMCkgKyAiSyIKCQl9CgkJcmV0dXJuIHNpemUgKyAiQiIKCX0sCglOdW1iZXI6IGZ1bmN0aW9uKGQsIG4pIHsgdmFyIHJlc3VsdCA9IFtdCgkJd2hpbGUgKGQgPiAwKSB7IHJlc3VsdC5wdXNoKGQlMTApOyBkID0gcGFyc2VJbnQoZC8xMCk7IG4tLSB9CgkJd2hpbGUgKG4gPiAwKSB7IHJlc3VsdC5wdXNoKCIwIik7IG4tLSB9CgkJcmV0dXJuIHJlc3VsdC5yZXZlcnNlKCksIHJlc3VsdC5qb2luKCIiKQoJfSwKCUZvcm1hdDogZnVuY3Rpb24ob2JqKSB7IHJldHVybiBKU09OLnN0cmluZ2lmeShvYmopIH0sCglTaW1wbGU6IGZ1bmN0aW9uKCkgeyB2YXIgcmVzID0gW10KCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJCQl2YXIgYXJnID0gYXJndW1lbnRzW2ldOyBzd2l0Y2ggKHR5cGVvZiBhcmd1bWVudHNbaV0pIHsKCQkJCWNhc2UgbGFuZy5OVU1CRVI6IHJlcy5wdXNoKGFyZyk7IGJyZWFrCgkJCQljYXNlIGxhbmcuU1RSSU5HOiByZXMucHVzaChhcmcpOyBicmVhawoJCQkJY2FzZSBsYW5nLk9CSkVDVDoKCQkJCQlpZiAoYXJnLmxlbmd0aCA+IDApIHsgcmVzID0gcmVzLmNvbmNhdChhcmcpOyBicmVhayB9CgkJCQkJZm9yICh2YXIgayBpbiBhcmcpIHsgayAmJiBhcmdba10gJiYgcmVzLnB1c2goaywgYXJnW2tdKSB9CgkJCQkJYnJlYWsKCQkJCWRlZmF1bHQ6IHJlcy5wdXNoKGFyZyk7IAoJCQl9CgkJfQoJCXJldHVybiByZXMKCX0sCglBZGRVbmlxOiBmdW5jdGlvbihsaXN0LCB2YWx1ZSkgeyBsaXN0ID0gbGlzdHx8W107IHJldHVybiBsaXN0LmluZGV4T2YodmFsdWUpID09IC0xICYmIGxpc3QucHVzaCh2YWx1ZSksIGxpc3QgfSwKCglEYXRlOiBmdW5jdGlvbih0aW1lKSB7IHZhciBub3cgPSBuZXcgRGF0ZSgpCgkJaWYgKHR5cGVvZiB0aW1lID09IGxhbmcuU1RSSU5HICYmIHRpbWUgIT0gIiIpIHsgdmFyIGxzID0gdGltZS5zcGxpdChpY2UuU1ApCgkJCXZhciB2cyA9IGxzWzBdLnNwbGl0KCItIikKCQkJbm93LnNldEZ1bGxZZWFyKHBhcnNlSW50KHZzWzBdKSkKCQkJbm93LnNldE1vbnRoKHBhcnNlSW50KHZzWzFdKS0xKQoJCQlub3cuc2V0RGF0ZShwYXJzZUludCh2c1syXSkpCgoJCQl2YXIgdnMgPSBsc1sxXS5zcGxpdCgiOiIpCgkJCW5vdy5zZXRIb3VycyhwYXJzZUludCh2c1swXSkpCgkJCW5vdy5zZXRNaW51dGVzKHBhcnNlSW50KHZzWzFdKSkKCQkJbm93LnNldFNlY29uZHMocGFyc2VJbnQodnNbMl0pKQoJCX0gZWxzZSBpZiAodGltZSkgewoJCQlub3cgPSB0aW1lCgkJfQoJCXJldHVybiBub3cKCX0sCglUaW1lOiBmdW5jdGlvbih0aW1lLCBmbXQpIHsgdmFyIG5vdyA9IHRoaXMuRGF0ZSh0aW1lKQoJCXZhciBsaXN0ID0gWyJTdW4iLCAiTW9uIiwgIlR1ZSIsICJXZWQiLCAiVGh1IiwgIkZyaSIsICJTYXQiXQoJCWZtdCA9IGZtdHx8IiVIOiVNOiVTIgoJCWZtdCA9IGZtdC5yZXBsYWNlKCIleSIsIG5vdy5nZXRGdWxsWWVhcigpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIlbSIsIHRoaXMuTnVtYmVyKG5vdy5nZXRNb250aCgpKzEsIDIpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIlZCIsIHRoaXMuTnVtYmVyKG5vdy5nZXREYXRlKCksIDIpKQoJCWZtdCA9IGZtdC5yZXBsYWNlKCIldyIsIGxpc3Rbbm93LmdldERheSgpXSkKCQlmbXQgPSBmbXQucmVwbGFjZSgiJUgiLCB0aGlzLk51bWJlcihub3cuZ2V0SG91cnMoKSwgMikpCgkJZm10ID0gZm10LnJlcGxhY2UoIiVNIiwgdGhpcy5OdW1iZXIobm93LmdldE1pbnV0ZXMoKSwgMikpCgkJZm10ID0gZm10LnJlcGxhY2UoIiVTIiwgdGhpcy5OdW1iZXIobm93LmdldFNlY29uZHMoKSwgMikpCgkJcmV0dXJuIGZtdAoJfSwKCVRpbWVBZGQ6IGZ1bmN0aW9uKHQsIGQpIHsgcmV0dXJuIG5ldyBEYXRlKHQgLSB0JSgyNCozNjAwKjEwMDApIC0gOCozNjAwKjEwMDAgKyBkKjI0KjM2MDAqMTAwMCkgfSwKCUR1cmF0aW9uOiBmdW5jdGlvbihuKSB7IHZhciByZXMgPSAiIiwgaCA9IDAKCQloID0gcGFyc2VJbnQobi8zNjAwMDAwLzI0KSwgaCA+IDAgJiYgKHJlcyArPSBoKyJkIiksIG4gPSBuICUgKDM2MDAwMDAqMjQpCgkJaCA9IHBhcnNlSW50KG4vMzYwMDAwMCksIGggPiAwICYmIChyZXMgKz0gaCsiaCIpLCBuID0gbiAlIDM2MDAwMDAKCQloID0gcGFyc2VJbnQobi82MDAwMCksIGggPiAwICYmIChyZXMgKz0gaCsibSIpLCBuID0gbiAlIDYwMDAwCgkJaCA9IHBhcnNlSW50KG4vMTAwMCksIGggPiAwICYmIChyZXMgKz0gaCksIG4gPSBuICUgMTAwMAoJCXJldHVybiByZXMgKyAobiA+IDA/IGljZS5QVCtwYXJzZUludChuLzEwKTogIiIpICsgInMiCgl9LAoKCW1vZDogZnVuY3Rpb24oaW5kZXgsIHRvdGFsKSB7CgkJcmV0dXJuIChpbmRleCt0b3RhbCkgJSB0b3RhbAoJfSwKCWdldFZhbGlkOiBmdW5jdGlvbigpIHsKCQlmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgdiA9IGFyZ3VtZW50c1tpXQoJCQlpZiAodHlwZW9mIHYgPT0gbGFuZy5PQkpFQ1QpIHsKCQkJCWlmICh2ID09IG51bGwpIHsgY29udGludWUgfQoJCQkJZm9yICh2YXIgayBpbiB2KSB7IHJldHVybiB2IH0KCQkJCWlmICh2Lmxlbmd0aCA+IDApIHsgcmV0dXJuIHYgfQoJCQl9IGVsc2UgaWYgKHR5cGVvZiB2ID09IGxhbmcuU1RSSU5HICYmIHYpIHsKCQkJCXJldHVybiB2CgkJCX0gZWxzZSBpZiAodiA9PSB1bmRlZmluZWQpIHsKCQkJCWNvbnRpbnVlCgkJCX0gZWxzZSB7CgkJCQlyZXR1cm4gdgoJCQl9CgkJfQoJfSwKCWlzTnVtYmVyOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5OVU1CRVIgfSwKCWlzU3RyaW5nOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5TVFJJTkcgfSwKCWlzT2JqZWN0OiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5PQkpFQ1QgfSwKCWlzQXJyYXk6IGZ1bmN0aW9uKHZhbCkgeyByZXR1cm4gdHlwZW9mIHZhbCA9PSBsYW5nLk9CSkVDVCAmJiB2YWwubGVuZ3RoICE9IHVuZGVmaW5lZCB9LAoJaXNGdW5jOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHR5cGVvZiB2YWwgPT0gbGFuZy5GVU5DVElPTiB9LAoJaXNGdW5jdGlvbjogZnVuY3Rpb24odmFsKSB7IHJldHVybiB0eXBlb2YgdmFsID09IGxhbmcuRlVOQ1RJT04gfSwKCWlzQ2FsbGJhY2s6IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGtleS5pbmRleE9mKCJvbiIpID09IDAgJiYgdHlwZW9mIHZhbHVlID09IGxhbmcuRlVOQ1RJT04gfSwKCWlzVW5kZWZpbmVkOiBmdW5jdGlvbih2YWwpIHsgcmV0dXJuIHZhbCA9PSB1bmRlZmluZWQgfSwKCWlzTnVsbDogZnVuY3Rpb24odmFsKSB7IHJldHVybiB2YWwgPT0gbnVsbCB9LAoJcmVwbGFjZUFsbDogZnVuY3Rpb24oc3RyKSB7CgkJZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpICs9IDIpIHsgaWYgKCFhcmd1bWVudHNbaV0pIHsgY29udGludWUgfQoJCQlpZiAoc3RyLnJlcGxhY2VBbGwpIHsgc3RyID0gc3RyLnJlcGxhY2VBbGwoYXJndW1lbnRzW2ldLCBhcmd1bWVudHNbaSsxXSk7IGNvbnRpbnVlIH0KCQkJaWYgKHN0ci5yZXBsYWNlKSB7IHN0ciA9IHN0ci5yZXBsYWNlKGFyZ3VtZW50c1tpXSwgYXJndW1lbnRzW2krMV0pOyBjb250aW51ZSB9CgkJfQoJCXJldHVybiBzdHIKCX0sCgoJY291bnQ6IGZ1bmN0aW9uKHN0ciwgcykgeyB2YXIgbiA9IDAKCQlmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykgewoJCQlpZiAoc3RyW2ldID09IHMpIHsgbisrIH0KCQl9CgkJcmV0dXJuIG4KCX0sCglyYW5kb206IGZ1bmN0aW9uKG1heCwgbWluKSB7IG1pbiA9IG1pbnx8MCwgcGFyc2VJbnQoTWF0aC5yYW5kb20oKSoobWF4LW1pbikpK21pbiB9LAoJaXNOaWdodDogZnVuY3Rpb24oKSB7IHZhciBub3cgPSBuZXcgRGF0ZSgpOyByZXR1cm4gbm93LmdldEhvdXJzKCkgPCA3IHx8IG5vdy5nZXRIb3VycygpID4gMTcgfSwKCWJlZ2luV2l0aDogZnVuY3Rpb24oc3RyLCBiZWdpbikgeyByZXR1cm4gc3RyLnRyaW0oKS5pbmRleE9mKGJlZ2luKSA9PSAwIH0sCgllbmRXaXRoOiBmdW5jdGlvbihzdHIsIGVuZCkgeyByZXR1cm4gc3RyLmxhc3RJbmRleE9mKGVuZCkgKyBlbmQubGVuZ3RoID09IHN0ci5sZW5ndGggfSwKCXRyaW06IGZ1bmN0aW9uKGFyZ3MpIHsgaWYgKHRoaXMuaXNTdHJpbmcoYXJncykpIHsgcmV0dXJuIGFyZ3MudHJpbSgpIH0KCQlpZiAodGhpcy5pc0FycmF5KGFyZ3MpKSB7IGZvciAodmFyIGkgPSBhcmdzLmxlbmd0aC0xOyBpID49IDA7IGktLSkgeyBpZiAoIWFyZ3NbaV0pIHsgYXJncy5wb3AoKSB9IGVsc2UgeyBicmVhayB9IH0gfQoJCXJldHVybiBhcmdzCgl9LAoJdHJpbVByZWZpeDogZnVuY3Rpb24oc3RyLCBwcmUpIHsgaWYgKHN0ci5pbmRleE9mKHByZSkgPT0gLTEpIHsgcmV0dXJuIHN0ciB9IHJldHVybiBzdHIuc2xpY2UocHJlLmxlbmd0aCkgfSwKCXRyaW1TdWZmaXg6IGZ1bmN0aW9uKHN0ciwgZW5kKSB7CgkJdmFyIGluZGV4ID0gc3RyLmxhc3RJbmRleE9mKGVuZCkKCQlpZiAoaW5kZXggPT0gLTEgfHwgaW5kZXgrZW5kLmxlbmd0aCAhPSBzdHIubGVuZ3RoKSB7IHJldHVybiBzdHIgfSByZXR1cm4gc3RyLnNsaWNlKDAsIGluZGV4KQoJfSwKCWpvaW46IGZ1bmN0aW9uKGxpc3QsIHNwKSB7IHJldHVybiAobGlzdHx8W10pLmpvaW4oc3B8fGljZS5TUCkgfSwKCWpvaW5zOiBmdW5jdGlvbihsaXN0LCBpbm5lciwgb3V0ZXIpIHsgCgkJZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7CgkJCWxpc3RbaV0gPSB0eXBlb2YgbGlzdFtpXSA9PSBsYW5nLlNUUklORz8gbGlzdFtpXTogbGlzdFtpXS5qb2luKGlubmVyfHxpY2UuRlMpCgkJfQoJCXJldHVybiBsaXN0LmpvaW4ob3V0ZXJ8fGljZS5TUCkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9saWIvbWlzYy5qcyIKVm9sY2Fub3MoIm1pc2MiLCB7aGVscDogIumAmuS/oeWNj+iuriIsIE1lc3NhZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IHt9IAoJdmFyIHByb3RvID0ge19ldmVudDogZXZlbnQsIF9jYW46IGNhbiwKCQlSdW5BY3Rpb246IGZ1bmN0aW9uKGV2ZW50LCBzdWIsIGNtZHMsIG1ldGEpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KTsgbWV0YSA9IG1ldGEgfHwgc3ViJiZzdWIub25hY3Rpb24gfHwge30KCQkJaWYgKG1zZy5PcHRpb24oaWNlLk1TR19IQU5ETEUpID09IGljZS5UUlVFKSB7IHJldHVybiB9CgkJCWlmIChjbWRzICYmIGNtZHNbMF0gPT0gY3R4LkFDVElPTiAmJiBjYW4uYmFzZS5pc0Z1bmMobWV0YVtjbWRzWzFdXSkpIHsKCQkJCXJldHVybiBtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFLCBpY2UuVFJVRSksIGNhbi5jb3JlLkNhbGxGdW5jKG1ldGFbY21kc1sxXV0sIHtldmVudDogZXZlbnQsIGNhbjogc3ViLCBtc2c6IG1zZywgYnV0dG9uOiBjbWRzWzFdLCBjbWQ6IGNtZHNbMV19KSwgdHJ1ZQoJCQl9CgkJCXJldHVybiBmYWxzZQoJCX0sCgkJRGlzcGxheTogZnVuY3Rpb24oZmlsZSkgeyBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSwgZmlsZSkgfSwKCQlEaXNwbGF5U3Rvcnk6IGZ1bmN0aW9uKGZpbGUpIHsgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVksICIvcGx1Z2luL3N0b3J5LyIrZmlsZSkgfSwKCQlPcHRpb25TdGF0dXM6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbXNnLk9wdGlvbihpY2UuTVNHX1NUQVRVUykgfSwKCQlPcHRpb25Qcm9jZXNzOiBmdW5jdGlvbigpIHsgcmV0dXJuIG1zZy5PcHRpb24oaWNlLk1TR19QUk9DRVNTKSB9LAoJCU9wdGlvbk9yU2VhcmNoOiBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIGNhbi5taXNjLlNlYXJjaChjYW4sIGtleSl8fG1zZy5PcHRpb24oa2V5KSB9LAoJCU9wdGlvbjogZnVuY3Rpb24oa2V5LCB2YWwpIHsKCQkJaWYgKGtleSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIG1zZyAmJiBtc2cub3B0aW9uIHx8IFtdIH0KCQkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsgY2FuLmNvcmUuSXRlbShrZXksIG1zZy5PcHRpb24pIH0KCQkJaWYgKHZhbCA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIG1zZyAmJiBtc2dba2V5XSAmJiBtc2dba2V5XVswXSB8fCAiIiB9CgkJCXJldHVybiBtc2cub3B0aW9uID0gY2FuLmJhc2UuQWRkVW5pcShtc2cub3B0aW9uLCBrZXkpLCBtc2dba2V5XSA9IGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKS5zbGljZSgxKSwgdmFsCgkJfSwKCQlBcHBlbmQ6IGZ1bmN0aW9uKGtleSwgdmFsKSB7CgkJCWlmIChrZXkgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBtc2cgJiYgbXNnLmFwcGVuZCB8fCBbXSB9CgkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7IGNhbi5jb3JlLkl0ZW0oa2V5LCBtc2cuQXBwZW5kKSB9CgkJCWlmICh2YWwgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBtc2cgJiYgbXNnW2tleV0gJiYgbXNnW2tleV1bMF0gfHwgIiIgfQoJCQlyZXR1cm4gbXNnLmFwcGVuZCA9IGNhbi5iYXNlLkFkZFVuaXEobXNnLmFwcGVuZCwga2V5KSwgbXNnW2tleV0gPSBjYW4uY29yZS5MaXN0KGFyZ3VtZW50cykuc2xpY2UoMSksIHZhbAoJCX0sCgkJUmVzdWx0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1zZy5yZXN1bHQgJiYgbXNnLnJlc3VsdC5qb2luKCIiKSB8fCAiIiB9LAoKCQlMZW5ndGg6IGZ1bmN0aW9uKCkgewoJCQl2YXIgbWF4ID0gIiIsIGxlbiA9IDA7IGNhbi5jb3JlLkxpc3QobXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCBpbmRleCkgewoJCQkJaWYgKG1zZ1trZXldICYmIG1zZ1trZXldLmxlbmd0aCA+IGxlbikgeyBtYXggPSBrZXksIGxlbiA9IG1zZ1trZXldLmxlbmd0aCB9CgkJCX0pCgkJCXJldHVybiBsZW4KCQl9LAoJCVRhYmxlOiBmdW5jdGlvbihjYikgeyBpZiAoIW1zZy5hcHBlbmQgfHwgbXNnLmFwcGVuZC5sZW5ndGggPT0gMCkgeyByZXR1cm4gfQoJCQl2YXIgbWF4ID0gIiIsIGxlbiA9IDA7IGNhbi5jb3JlLkxpc3QobXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCBpbmRleCkgewoJCQkJaWYgKG1zZ1trZXldICYmIG1zZ1trZXldLmxlbmd0aCA+IGxlbikgeyBtYXggPSBrZXksIGxlbiA9IG1zZ1trZXldLmxlbmd0aCB9CgkJCX0pCgoJCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChtc2dbbWF4XSwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBhcnJheSkgeyB2YXIgb25lID0ge30sIHJlcwoJCQkJY2FuLmNvcmUuTGlzdChtc2cuYXBwZW5kLCBmdW5jdGlvbihrZXkpIHsgb25lW2tleV0gPSAobXNnW2tleV0mJm1zZ1trZXldW2luZGV4XXx8IiIpIH0pCgkJCQlyZXR1cm4gY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiAocmVzID0gY2Iob25lLCBpbmRleCwgYXJyYXkpKSAmJiByZXMgIT0gdW5kZWZpbmVkICYmIHJlcyB8fCBvbmUKCQkJfSkKCQl9LAoJCUNsZWFyOiBmdW5jdGlvbihrZXkpIHsgc3dpdGNoIChrZXl8fGljZS5NU0dfQVBQRU5EKSB7CgkJCWNhc2UgaWNlLk1TR19BUFBFTkQ6CgkJCWNhc2UgaWNlLk1TR19PUFRJT046CgkJCQljYW4uY29yZS5MaXN0KG1zZ1trZXldLCBmdW5jdGlvbihpdGVtKSB7IGRlbGV0ZShtc2dbaXRlbV0pIH0pCgkJCWRlZmF1bHQ6IG1zZ1trZXldID0gW10KCQl9IH0sCgkJQ29weTogZnVuY3Rpb24ocmVzKSB7IGlmICghcmVzKSB7IHJldHVybiBtc2cgfQoJCQlyZXMucmVzdWx0ICYmIChtc2cucmVzdWx0ID0gKG1zZy5yZXN1bHR8fFtdKS5jb25jYXQocmVzLnJlc3VsdCkpCgkJCXJlcy5hcHBlbmQgJiYgKG1zZy5hcHBlbmQgPSByZXMuYXBwZW5kKSAmJiByZXMuYXBwZW5kLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgewoJCQkJdmFyIGkgPSBtc2cub3B0aW9uICYmIG1zZy5vcHRpb24uaW5kZXhPZihpdGVtKTsgaWYgKGkgPiAtMSkgewoJCQkJCW1zZy5vcHRpb25baV0gPSAiIiwgZGVsZXRlKG1zZ1tpdGVtXSkKCQkJCX0KCQkJCXJlc1tpdGVtXSAmJiAobXNnW2l0ZW1dID0gKG1zZ1tpdGVtXXx8W10pLmNvbmNhdChyZXNbaXRlbV0pKQoJCQl9KQoJCQlyZXMub3B0aW9uICYmIChtc2cub3B0aW9uID0gcmVzLm9wdGlvbikgJiYgcmVzLm9wdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCXJlc1tpdGVtXSAmJiAobXNnW2l0ZW1dID0gcmVzW2l0ZW1dKQoJCQl9KQoJCQlyZXMuX29wdGlvbiAmJiAobXNnLl9vcHRpb24gPSByZXMuX29wdGlvbikgJiYgcmVzLl9vcHRpb24uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7CgkJCQlyZXNbaXRlbV0gJiYgKG1zZ1tpdGVtXSA9IHJlc1tpdGVtXSkKCQkJfSkKCQkJcmV0dXJuIG1zZwoJCX0sCgkJUHVzaDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgZGV0YWlsKSB7CgkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7CgkJCQl2YWx1ZSA9IHZhbHVlfHxjYW4uY29yZS5JdGVtKGtleSksIGNhbi5jb3JlLkxpc3QodmFsdWUsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQlkZXRhaWw/IG1zZy5QdXNoKG1kYi5LRVksIGl0ZW0pLlB1c2gobWRiLlZBTFVFLCBrZXlbaXRlbV18fCIiKTogbXNnLlB1c2goaXRlbSwga2V5W2l0ZW1dfHwiIikKCQkJCX0pCgkJCQlyZXR1cm4gbXNnCgkJCX0KCgkJCW1zZy5hcHBlbmQgPSBjYW4uYmFzZS5BZGRVbmlxKG1zZy5hcHBlbmQsIGtleSksIG1zZ1trZXldID0gbXNnW2tleV0gfHwgW10KCQkJbXNnW2tleV0ucHVzaChjYW4uYmFzZS5pc1N0cmluZyh2YWx1ZSl8fGNhbi5iYXNlLmlzRnVuY3Rpb24odmFsdWUpPyB2YWx1ZTogSlNPTi5zdHJpbmdpZnkodmFsdWUpKQoJCQlyZXR1cm4gbXNnCgkJfSwKCQlTdGF0dXM6IGZ1bmN0aW9uKG9iaikgeyBtc2cuT3B0aW9uKGljZS5NU0dfU1RBVFVTLCBKU09OLnN0cmluZ2lmeShjYW4uY29yZS5JdGVtKG9iaiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4ge25hbWU6IGtleSwgdmFsdWU6IHZhbHVlfSB9KSkpIH0sCgkJU3RhdHVzVGltZUNvdW50OiBmdW5jdGlvbihvYmopIHsgbXNnLmFwcGVuZCAmJiBtc2cuU3RhdHVzKGNhbi5iYXNlLkNvcHkoeyJ0aW1lIjogY2FuLmJhc2UuVGltZSgpLCAiY291bnQiOiBtc2cuTGVuZ3RoKCkrIngiK21zZy5hcHBlbmQubGVuZ3RofSwgb2JqKSkgfSwKCQlFY2hvOiBmdW5jdGlvbihyZXMpIHsgbXNnLnJlc3VsdCA9IG1zZy5yZXN1bHQgfHwgW10KCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgbXNnLnJlc3VsdC5wdXNoKGFyZ3VtZW50c1tpXSkgfQoJCQlyZXR1cm4gbXNnLl9oYW5kID0gdHJ1ZSwgbXNnCgkJfSwKCQlEdW1wOiBmdW5jdGlvbihjYW4pIHsKCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJfSwKCX0KCXJldHVybiBjYW4ubWlzYy5wcm90byhtc2csIHByb3RvKQp9LAoJUE9TVDogZnVuY3Rpb24oY2FuLCBtc2csIHVybCwgZm9ybSwgY2IpIHsgLy8gX21ldGhvZCBfYWNjZXB0IF91cGxvYWQgX3Byb2dyZXNzCgkJdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOyBtc2cuX3hociA9IHhocgoJCXhoci5vcGVuKG1zZy5fbWV0aG9kfHwiUE9TVCIsIHVybCksIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHsKCQkJaWYgKHhoci5yZWFkeVN0YXRlICE9IDQpIHsgcmV0dXJuIH0KCgkJCXRyeSB7IC8vIOino+aekOWTjeW6lAoJCQkJdmFyIHJlcyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCkKCQkJfSBjYXRjaCAoZSkgewoJCQkJdmFyIHJlcyA9IHtyZXN1bHQ6IFt4aHIucmVzcG9uc2VUZXh0XX0KCQkJfQoJCQlpZiAoeGhyLnN0YXR1cyA9PSAyMDApIHsKCQkJCXJldHVybiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZy5Db3B5KHJlcykpCgkJCX0KCQkJY2FuLnVzZXIudG9hc3QoY2FuLCByZXMsIHhoci5zdGF0dXMpCgkJfQoKCQlpZiAobXNnLl91cGxvYWQpIHsgLy8g5LiK5Lyg5paH5Lu2CgkJCXZhciBkYXRhID0gbmV3IEZvcm1EYXRhKCk7IGNhbi5jb3JlLkl0ZW1zKGZvcm0sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwga2V5KSB7CgkJCQlkYXRhLmFwcGVuZChrZXksIHZhbHVlKQoJCQl9KSwgZGF0YS5hcHBlbmQoaHRtbC5VUExPQUQsIG1zZy5fdXBsb2FkKSwgZGF0YS5hcHBlbmQoaWNlLk1TR19VUExPQUQsIG1kYi5VUExPQUQpCgoJCQl4aHIudXBsb2FkLm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLmJhc2UuaXNGdW5jKG1zZy5fcHJvZ3Jlc3MpICYmIG1zZy5fcHJvZ3Jlc3MoZXZlbnQsIHBhcnNlSW50KGV2ZW50LmxvYWRlZCoxMDAvZXZlbnQudG90YWwpLCBldmVudC50b3RhbCwgZXZlbnQubG9hZGVkKQoJCQl9CgkJfSBlbHNlIHsgLy8g6K+35rGC5pWw5o2uCgkJCXZhciBkYXRhID0gY2FuLmNvcmUuSXRlbXMoZm9ybSwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBrZXkpIHsgcmV0dXJuIGtleSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSB9KS5qb2luKCImIikKCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIkNvbnRlbnQtVHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKQoJCX0KCgkJLy8g5Y+R6YCB6K+35rGCCgkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIkFjY2VwdCIsIG1zZy5fYWNjZXB0fHwiYXBwbGljYXRpb24vanNvbiIpCgkJdHJ5IHsgeGhyLnNlbmQoZGF0YSkgfSBjYXRjaChlKSB7IGNhbi5taXNjLkxvZyhlKSB9Cgl9LAoJUnVuOiBmdW5jdGlvbihldmVudCwgY2FuLCBkYXRhc2V0LCBjbWRzLCBjYikgewoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudHx8e30pLCBza2lwID0ge19oYW5kbGU6IHRydWV9CgkJdmFyIGZvcm0gPSB7Y21kczogY21kc3x8bXNnLmNtZH07IG1zZy5vcHRpb24gJiYgbXNnLm9wdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsKCQkJIXNraXBbaXRlbV0gJiYgbXNnW2l0ZW1dICYmIChmb3JtW2l0ZW1dID0gbXNnW2l0ZW1dKQoJCX0pCgoJCWNhbi5taXNjLlBPU1QoY2FuLCBtc2csIGNhbi5iYXNlLk1lcmdlVVJMKGRhdGFzZXQubmFtZXMudG9Mb3dlckNhc2UoKSwKCQkJIl8iLCAobXNnLl9jYW4uc3VwfHxtc2cuX2NhbikuX25hbWUsIGljZS5NU0dfREFFTU9OLCBtc2cuX19kYWVtb258fGRhdGFzZXQuZGFlbW9ufHwiIgoJCSksIGZvcm0sIGNiKQoJfSwKCVdTUzogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYiwgb25vcGVuLCBvbmNsb3NlLCBvbmVycm9yKSB7IGlmIChjYW4udXNlci5pc0lFKSB7IHJldHVybiB9CgkJdmFyIHVybCA9IGxvY2F0aW9uLnByb3RvY29sLnJlcGxhY2UoImh0dHAiLCAid3MiKSsiLy8iK2xvY2F0aW9uLmhvc3QrIi9zcGFjZS8iCgkJaWYgKHVybC5pbmRleE9mKCJjaHJvbWUiKSA9PSAwKSB7IHVybCA9ICJ3czovL2xvY2FsaG9zdDo5MDIwL3NwYWNlLyIgfQoKCQl2YXIgc29ja2V0ID0gbmV3IFdlYlNvY2tldChjYW4uYmFzZS5NZXJnZVVSTCh1cmwsIGFyZ3MpKQoJCXNvY2tldC5vbmNsb3NlID0gZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZyhodG1sLldTUywgY2xpLkNMT1NFLCBhcmdzKQoJCQljYW4uYmFzZS5pc0Z1bmMob25jbG9zZSk/IG9uY2xvc2Uoc29ja2V0KTogY2FuLmNvcmUuVGltZXIoY2FuLmJhc2UucmFuZG9tKDMwMDAsIDEwMDApLCBmdW5jdGlvbigpIHsKCQkJCWNhbi5taXNjLldTUyhjYW4sIGFyZ3MsIGNiLCBvbm9wZW4sIG9uZXJyb3IsIG9uY2xvc2UpCgkJCX0pCgkJfSwgc29ja2V0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHsgY2FuLm1pc2MuTG9nKGh0bWwuV1NTLCBjbGkuRVJST1IsIGFyZ3MpCgkJCWNhbi5iYXNlLmlzRnVuYyhvbmVycm9yKT8gb25lcnJvcihzb2NrZXQpOiBzb2NrZXQuY2xvc2UoKQoKCQl9LCBzb2NrZXQub25vcGVuID0gZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZyhodG1sLldTUywgY2xpLk9QRU4sIGFyZ3MpCgkJCWNhbi5iYXNlLmlzRnVuYyhvbm9wZW4pICYmIG9ub3Blbihzb2NrZXQpCgkJfQoKCQlzb2NrZXQub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHsgLy8g6Kej5p6Q5ZG95LukCgkJCXRyeSB7IHZhciBkYXRhID0gSlNPTi5wYXJzZShldmVudC5kYXRhKSB9IGNhdGNoIChlKSB7IHZhciBkYXRhID0ge2RldGFpbDogW2V2ZW50LmRhdGFdfSB9CgoJCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBtc2cuUmVwbHkgPSBmdW5jdGlvbigpIHsgLy8g5Zue5aSN5ZG95LukCgkJCQltc2cuT3B0aW9uKHtfaGFuZGxlOiB0cnVlLCBfc291cmNlOiAobXNnW2ljZS5NU0dfVEFSR0VUXXx8W10pLnJldmVyc2UoKS5zbGljZSgxKS5qb2luKGljZS5QVCl8fCIiLCBfdGFyZ2V0OiAobXNnW2ljZS5NU0dfU09VUkNFXXx8W10pLnJldmVyc2UoKS5qb2luKGljZS5QVCl9KQoJCQkJbXNnLnJlc3VsdCA9IChtc2cucmVzdWx0fHxbXSkuY29uY2F0KGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKSksIGNhbi5taXNjLkxvZyhodG1sLldTUywgaWNlLk1TR19SRVNVTFQsIG1zZy5yZXN1bHQsIG1zZykKCQkJCWRlbGV0ZShtc2cuX2V2ZW50KSwgZGVsZXRlKG1zZy5fY2FuKSwgc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSkKCQkJfSwgbXNnLmRldGFpbCA9IGRhdGEuZGV0YWlsLCBtc2cuQ29weShkYXRhKQoKCQkJdHJ5IHsgLy8g5omn6KGM5ZG95LukCgkJCQljYW4ubWlzYy5Mb2coaHRtbC5XU1MsIGljZS5NU0dfREVUQUlMLCBtc2cuZGV0YWlsLCBtc2cpCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50LCBtc2csIG1zZy5kZXRhaWxbMF0sIG1zZy5kZXRhaWwuc2xpY2UoMSkpCgkJCX0gY2F0Y2ggKGUpIHsgY2FuLm1pc2MuTG9nKGUpLCBtc2cuUmVwbHkoKSB9CgkJfQoJfSwKCglDb29raWVTZXNzaWQ6IHNoeSgi5Lya6K+d5Y+Y6YePIiwgZnVuY3Rpb24oY2FuLCB2YWx1ZSwgcGF0aCkgewoJCXJldHVybiBjYW4ubWlzYy5Db29raWUoY2FuLCBpY2UuTVNHX1NFU1NJRCsiXyIrbG9jYXRpb24uaG9zdC5yZXBsYWNlQWxsKGljZS5QVCwgIl8iKS5yZXBsYWNlQWxsKGljZS5ERiwgIl8iKSwgdmFsdWUsIHBhdGgpCgl9KSwKCUNvb2tpZTogc2h5KCLkvJror53lj5jph48iLCBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUsIHBhdGgpIHsKCQlmdW5jdGlvbiBzZXQoaywgdikgeyBkb2N1bWVudC5jb29raWUgPSBrKyI9Iit2KyI7cGF0aD0iKyhwYXRofHxpY2UuUFMpIH0KCQlpZiAoY2FuLmJhc2UuaXNPYmplY3Qoa2V5KSkgeyBmb3IgKHZhciBrIGluIGtleSkgeyBzZXQoaywga2V5W2tdKSB9IGtleSA9IHVuZGVmaW5lZCB9CgoJCWlmIChrZXkgPT0gdW5kZWZpbmVkKSB7IHZhciBjcyA9IHt9CgkJCWRvY3VtZW50LmNvb2tpZS5zcGxpdCgiOyAiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGxzID0gaXRlbS5zcGxpdCgiPSIpOyBjc1tsc1swXV0gPSBsc1sxXSB9KQoJCQlyZXR1cm4gY3MKCQl9CgoJCXZhbHVlICE9IHVuZGVmaW5lZCAmJiBzZXQoa2V5LCB2YWx1ZSkKCQl2YXIgdmFsID0gKG5ldyBSZWdFeHAoa2V5KyI9KFteO10qKTs/IikpLmV4ZWMoZG9jdW1lbnQuY29va2llKQoJCXJldHVybiB2YWwgJiYgdmFsLmxlbmd0aCA+IDA/IHZhbFsxXTogIiIKCX0pLAoJU2VhcmNoT3JDb25mOiBmdW5jdGlvbihjYW4sIGtleSwgZGVmKSB7IHJldHVybiBjYW4uYmFzZS5nZXRWYWxpZChjYW4ubWlzYy5TZWFyY2goY2FuLCBrZXkpLCBjYW4uQ29uZihrZXkpLCBkZWYpIH0sCglTZWFyY2g6IHNoeSgi6K+35rGC5Y+C5pWwIiwgZnVuY3Rpb24oY2FuLCBrZXksIHZhbHVlKSB7IHZhciBhcmdzID0ge30KCQlpZiAodmFsdWUgPT0gdW5kZWZpbmVkICYmIGNhbi5iYXNlLmlzU3RyaW5nKGtleSkpIHsKCQkJdmFyIGxzID0gbG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoaWNlLlBTKTsgaWYgKGxzWzFdID09IGNoYXQuU0hBUkUpIHsgYXJnc1tjaGF0LlNIQVJFXSA9IGxzWzJdIH0KCQkJZm9yICh2YXIgaSA9IDI7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgeyBpZiAoeyJwb2QiOiB0cnVlLCAiY21kIjogdHJ1ZX1bbHNbaV1dKSB7IGFyZ3NbbHNbaV1dID0gbHNbaSsxXSB9IH0KCQl9CgkJbG9jYXRpb24uc2VhcmNoICYmIGxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKS5zcGxpdCgiJiIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkgeyB2YXIgeCA9IGl0ZW0uc3BsaXQoIj0iKQoJCQl4WzFdICE9ICIiICYmIChhcmdzW3hbMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KHhbMV0pKQoJCX0pCgoJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7CgkJCWNhbi5jb3JlLkl0ZW0oa2V5LCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCQlpZiAodmFsdWUgIT0gdW5kZWZpbmVkKSB7IGFyZ3Nba2V5XSA9IHZhbHVlIH0gYXJnc1trZXldID09ICIiICYmIGRlbGV0ZShhcmdzW2tleV0pCgkJCX0pCgkJfSBlbHNlIHsKCQkJaWYgKGtleSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIGFyZ3MgfQoJCQlpZiAodmFsdWUgPT0gdW5kZWZpbmVkKSB7IHJldHVybiBhcmdzW2tleV0gfQoJCQlhcmdzW2tleV0gPSB2YWx1ZSwgYXJnc1trZXldID09ICIiICYmIGRlbGV0ZShhcmdzW2tleV0pCgkJfQoKCQl2YXIgc2VhcmNoID0gY2FuLmNvcmUuSXRlbShhcmdzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiBrZXkrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkgfSkuam9pbigiJiIpCgkJcmV0dXJuIHNlYXJjaD8gbG9jYXRpb24uc2VhcmNoID0gc2VhcmNoOiBsb2NhdGlvbi5ocmVmID0gbG9jYXRpb24ucGF0aG5hbWUKCX0pLAoJTWVyZ2VVUkw6IHNoeSgi5Zyw5Z2A6ZO+5o6lIiwgZnVuY3Rpb24oY2FuLCBvYmpzLCBjbGVhcikgewoJCXZhciBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7IG9ianMuX3BhdGggJiYgKHBhdGggPSBvYmpzLl9wYXRoLCBkZWxldGUob2Jqcy5fcGF0aCkpCgkJb2JqcyAmJiBvYmpzLnBvZCAmJiAocGF0aCA9ICIvY2hhdC9wb2QvIitvYmpzLnBvZCwgZGVsZXRlKG9ianMucG9kKSkKCQlyZXR1cm4gY2FuLmJhc2UuTWVyZ2VVUkwobG9jYXRpb24ub3JpZ2luK3BhdGgrKGNsZWFyPyIiOmxvY2F0aW9uLnNlYXJjaCksIG9ianMpCgl9KSwKCglydW5BY3Rpb246IGZ1bmN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwgbGlzdCkgewoJCWlmIChjbWRzWzBdID09IGN0eC5BQ1RJT04gJiYgbGlzdFtjbWRzWzFdXSkgeyByZXR1cm4gbGlzdFtjbWRzWzFdXShjbWRzLnNsaWNlKDIpKSwgdHJ1ZSB9CgkJaWYgKGxpc3RbY21kc1swXV0pIHsgcmV0dXJuIGxpc3RbY21kc1swXV0oY21kcy5zbGljZSgxKSksIHRydWUgfQoJfSwKCWNvbmNhdDogZnVuY3Rpb24oY2FuLCB0bywgZnJvbSkgeyB0byA9IHRvfHxbXSwgZnJvbSA9IGZyb218fFtdCgkJaWYgKGZyb21bMF0gPT0gY3R4LkFDVElPTiAmJiBmcm9tWzFdID09IGljZS5SVU4gJiYgY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2Zyb21bMl1dKSB7IHJldHVybiBmcm9tIH0KCQlpZiAoY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2Zyb21bMF1dKSB7IHJldHVybiBmcm9tIH0KCQlpZiAoZnJvbVswXSA9PSAiX3NlYXJjaCIpIHsgcmV0dXJuIGZyb20gfQoJCXJldHVybiB0by5jb25jYXQoZnJvbSkKCX0sCglwcm90bzogZnVuY3Rpb24oc3ViLCBzdXApIHsgcmV0dXJuIHN1Yi5fX3Byb3RvX18gPSBzdXAsIHN1YiB9LAoKCUxvZzogZnVuY3Rpb24oKSB7CgkJdmFyIGFyZ3MgPSBbdGhpcy5fdGltZSgpLCB0aGlzLkZpbGVMaW5lKDIsIDMpXQoJCWZvciAodmFyIGkgaW4gYXJndW1lbnRzKSB7IGFyZ3MucHVzaChhcmd1bWVudHNbaV0pIH0KCQljb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKQoJfSwKCUluZm86IGZ1bmN0aW9uKCkgewoJCXZhciBhcmdzID0gW3RoaXMuX3RpbWUoKSwgdGhpcy5GaWxlTGluZSgyLCAzKV0KCQlmb3IgKHZhciBpIGluIGFyZ3VtZW50cykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKSB9CgkJY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJncykKCX0sCglXYXJuOiBmdW5jdGlvbigpIHsKCQl2YXIgYXJncyA9IFt0aGlzLl90aW1lKCksIHRoaXMuRmlsZUxpbmUoMiwgMyksICJ3YXJuIl0KCQlmb3IgKHZhciBpIGluIGFyZ3VtZW50cykgeyBhcmdzLnB1c2goYXJndW1lbnRzW2ldKSB9CgkJYXJncy5wdXNoKGljZS5OTCwgdGhpcy5fZmlsZUxpbmUoKS5zcGxpdChpY2UuTkwpLnNsaWNlKDIpLmpvaW4oaWNlLk5MKSkKCQljb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmdzKQoJfSwKCURlYnVnOiBmdW5jdGlvbigpIHsKCQl2YXIgYXJncyA9IFt0aGlzLl90aW1lKCksIHRoaXMuRmlsZUxpbmUoMiwgMyksICJkZWJ1ZyJdCgkJZm9yICh2YXIgaSBpbiBhcmd1bWVudHMpIHsgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSkgfQoJCWFyZ3MucHVzaCh0aGlzLmZpbGVMaW5lKDIsIDMpKQoJCWNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3MpCgkJbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNb2JpbGUiKSA+IC0xICYmIGFsZXJ0KEpTT04uc3RyaW5naWZ5KGFyZ3Muam9pbihpY2UuU1ApKSkKCX0sCglGaWxlTGluZTogZnVuY3Rpb24oZGVwdGgsIGxlbmd0aCkgewoJCXJldHVybiB0aGlzLmZpbGVMaW5lKGRlcHRoKzEpLnNwbGl0KGljZS5QUykuc2xpY2UoMykuc2xpY2UoLWxlbmd0aCkuam9pbihpY2UuUFMpLnNwbGl0KCIpIilbMF0KCX0sCglmaWxlTGluZTogZnVuY3Rpb24oZGVwdGgpIHsKCQlyZXR1cm4gKHRoaXMuX2ZpbGVMaW5lKCkuc3BsaXQoaWNlLk5MKVsxK2RlcHRoXXx8IiIpLnRyaW0oKQoJfSwKCV9maWxlTGluZTogZnVuY3Rpb24oKSB7IHZhciBvYmogPSB7fQoJCUVycm9yLmNhcHR1cmVTdGFja1RyYWNlICYmIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKG9iaiwgYXJndW1lbnRzLmNhbGxlZSkKCQlyZXR1cm4gb2JqLnN0YWNrIHx8ICIiCgl9LAoJX3RpbWU6IGZ1bmN0aW9uKCkgeyB2YXIgbm93ID0gbmV3IERhdGUoKQoJCXZhciBob3VyID0gbm93LmdldEhvdXJzKCkKCQlpZiAoaG91ciA8IDEwKSB7IGhvdXIgPSAiMCIraG91ciB9CgkJdmFyIG1pbnV0ZSA9IG5vdy5nZXRNaW51dGVzKCkKCQlpZiAobWludXRlIDwgMTApIHsgbWludXRlID0gIjAiK21pbnV0ZSB9CgkJdmFyIHNlY29uZCA9IG5vdy5nZXRTZWNvbmRzKCkKCQlpZiAoc2Vjb25kIDwgMTApIHsgc2Vjb25kID0gIjAiK3NlY29uZCB9CgkJcmV0dXJuIGhvdXIrIjoiK21pbnV0ZSsiOiIrc2Vjb25kCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvaGVhZGVyLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCQljYW4uQ29uZihhYWEuVVNFUk5JQ0ssIG1zZy5PcHRpb24oYWFhLlVTRVJOSUNLKXx8bXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOSUNLKXx8bXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOQU1FKXx8Y2FuLkNvbmYoYWFhLlVTRVJOSUNLKSkKCQljYW4udXNlci5pbmZvLnVzZXJuaWNrID0gY2FuLkNvbmYoYWFhLlVTRVJOSUNLKQoJCWNhbi51c2VyLmluZm8uYXZhdGFyID0gbXNnLk9wdGlvbihhYWEuQVZBVEFSKQoJCWNhbi5vbmRhZW1vbi5faW5pdChjYW4pCgoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAidG9waWMiLCBzaHkoIuS4u+mimCIsIHsKCQkJImRlbW8iOiBmdW5jdGlvbihjYW4sIG1zZywgY21kcykgeyBjYW4ub25sYXlvdXQudG9waWMoY2FuLCBjbWRzWzBdKSB9LAoJCX0sIFsidG9waWM6c2VsZWN0PXdoaXRlLGJsYWNrIiwgInJ1bjpidXR0b24iLCAiZGVtbzpidXR0b24iXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCWNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNtZHNbMF0pCgkJfSkpCgoJCWNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNhbi5Db25mKCJ0b3BpYyIpKQoJCWlmIChjYW4udXNlci5tb2QuaXNDbWQpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fZmllbGRzKQoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgZG9jdW1lbnQuYm9keSwgInNpbXBsZSIpCgkJfQoKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKQoJCWNhbi5vbmltcG9ydC5fYWdlbnQoY2FuLCBtc2csIHRhcmdldCkKCQljYW4ub25pbXBvcnQuX2dyYW50KGNhbiwgbXNnLCB0YXJnZXQpCgkJaWYgKGNhbi5Db25mKCJkaXNwbGF5IikgIT0gInNpbXBsZSIpIHsKCQkJY2FuLm9uaW1wb3J0Ll90aXRsZShjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX3N0YXRlKGNhbiwgbXNnLCB0YXJnZXQpCgkJCWNhbi5vbmltcG9ydC5fc2VhcmNoKGNhbiwgbXNnLCB0YXJnZXQpCgkJCWNhbi5vbmltcG9ydC5fYmFja2dyb3VuZChjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX2F2YXRhcihjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX21lbnVzKGNhbiwgbXNnLCB0YXJnZXQpCgoJCX0KCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCX0sCglfYWdlbnQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4ucnVuKHt9LCBbY2hhdC5BR0VOVF0sIGZ1bmN0aW9uKG1zZykgeyBpZiAoIW1zZy5PcHRpb24obmZzLlNDUklQVCkpIHsgcmV0dXJuIH0KCQkJY2FuLnJlcXVpcmUoY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24obmZzLlNDUklQVCkpLCBmdW5jdGlvbihjYW4pIHsgY2FuLm9uYWN0aW9uLnNvdXJjZShjYW4sIG1zZykgfSkKCQl9KQoJfSwKCV9ncmFudDogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCWlmIChjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LkdSQU5UKSkgewoJCQlpZiAoY2FuLnVzZXIuY29uZmlybShjaGF0LkdSQU5UK2ljZS5TUCtjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LkdSQU5UKSkpIHsKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjaGF0LkdSQU5ULCB3ZWIuU1BBQ0UsIGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuR1JBTlQpXSkKCQkJfQoJCQljYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LkdSQU5ULCAiIikKCQl9Cgl9LAoJX3RpdGxlOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLnVzZXIudGl0bGUoY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5USVRMRSl8fGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpKQoJCSFjYW4udXNlci5pc01vYmlsZSAmJiBjYW4uY29yZS5MaXN0KGNhbi5iYXNlLmdldFZhbGlkKG1zZy5yZXN1bHQsIGNhbi5Db25mKGNoYXQuVElUTEUpfHxbInNoeWxpbnV4LmNvbS94L2NvbnRleHRzIl0pLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2hhdC5USVRMRSwgaHRtbC5ESVYsIGl0ZW1dLCB0aXRsZTogIui/lOWbnuS4u+mhtSIsIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25hY3Rpb24udGl0bGUoZXZlbnQsIGNhbikKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgeyB2YXIgbGlzdCA9IG1zZy5UYWJsZSgpCgkJCQljYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCB7fSwgY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtKSB7IHJldHVybiBpdGVtLm5hbWUgfSksIGZ1bmN0aW9uKGV2ZW50LCBpdGVtLCBtZXRhLCBpbmRleCkgewoJCQkJCWV2ZW50LnNoaWZ0S2V5PyBjYW4udXNlci5vcGVuKGxpc3RbaW5kZXhdLnBhdGgpOiBjYW4udXNlci5qdW1wcyhsaXN0W2luZGV4XS5wYXRoKQoJCQkJfSkKCQkJfX1dKQoJCX0pCgl9LAoJX3N0YXRlOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLmNvcmUuTGlzdChjYW4uYmFzZS5PYmoobXNnLk9wdGlvbihjaGF0LlNUQVRFKXx8Y2FuLkNvbmYoY2hhdC5TVEFURSksIFttZGIuVElNRSwgYWFhLlVTRVJOSUNLXSksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaWYgKGl0ZW0gPT0gYWFhLkFWQVRBUiApIHsgaWYgKGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogY2FuLmJhc2Uuam9pbihbY2hhdC5TVEFURSwgaXRlbV0pLCBsaXN0OiBbe2ltZzogaWNlLlNQfV0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlpZiAobXNnLk9wdGlvbihhYWEuQVZBVEFSKS5pbmRleE9mKCJodHRwIikgPT0gMCkgewoJCQkJCQljYW4ub25hY3Rpb24uY2FydGUoZXZlbnQsIGNhbiwgW2Nhbi5wYWdlLkZvcm1hdChodG1sLklNRywgbXNnLk9wdGlvbihhYWEuQVZBVEFSKSwgMTYwKV0pCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLm9uYWN0aW9uLmNhcnRlKGV2ZW50LCBjYW4sIFtjYW4ucGFnZS5Gb3JtYXQoaHRtbC5JTUcsICIvc2hhcmUvbG9jYWwvYXZhdGFyIiwgMTYwKV0pCgkJCQkJfQoJCQkJfX1dKTsgcmV0dXJuCgkJCX0KCgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2FuLmJhc2Uuam9pbihbY2hhdC5TVEFURSwgaXRlbV0pLCBodG1sLkRJViwgKGNhbi5Db25mKGl0ZW0pfHwiIikuc2xpY2UoMCwgMTApXSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmFjdGlvbiwgaXRlbV0sIFtldmVudCwgY2FuLCBpdGVtXSkKCQkJfSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgeyBpdGVtID09IG1kYi5USU1FICYmIGNhbi5vbmltcG9ydC5fdGltZShjYW4sIHRhcmdldCkgfX1dKQoJCX0pCgl9LAoJX3NlYXJjaDogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCXZhciB1aSA9IGNhbi5vbmFwcGVuZC5pbnB1dChjYW4sIHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IG1kYi5TRUFSQ0gsIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pOyBzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQkJY2FzZSBsYW5nLkVOVEVSOiBjYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9ub3BlbnNlYXJjaCIsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7dHlwZTogIioiLCB3b3JkOiBldmVudC50YXJnZXQudmFsdWV9KSkKCQkJfQoJCX19LCAiIiwgdGFyZ2V0LCAidGl0bGUgc2VhcmNoIikucGFyZW50Tm9kZQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0eXBlOiAic2VhcmNoIiwgbGlzdDogW3t2aWV3OiBbIm1lbnUiLCAiZGl2IiwgY2FuLnVzZXIudHJhbnMoY2FuLCAic2VhcmNoIildLCBvbmNsaWNrOiBmdW5jdGlvbigpIHsKCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbm9wZW5zZWFyY2giLCBjYW4ucmVxdWVzdChldmVudCwge3R5cGU6ICIqIiwgd29yZDogIiJ9KSkKCQl9fV0gfV0pCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdWksIHtzdHlsZToge2Zsb2F0OiBodG1sLlJJR0hUfX0pCgl9LAoJX2JhY2tncm91bmQ6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJaWYgKGNhbi5Db25mKCJiYWNrZ3JvdW5kIikgPT0gIl8iKSB7IHJldHVybiB9CgkJaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uIHx8IGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJbXNnLk9wdGlvbihhYWEuQkFDS0dST1VORCkgJiYgY2FuLm9ubGF5b3V0LmJhY2tncm91bmQoY2FuLCAiL3NoYXJlL2xvY2FsL2JhY2tncm91bmQiLCBkb2N1bWVudC5ib2R5KQoJfSwKCV9hdmF0YXI6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGlmIChjYW4udXNlci5pc0V4dGVuc2lvbiB8fCBjYW4udXNlci5pc0xvY2FsRmlsZSkgeyByZXR1cm4gfSBpZiAoIW1zZy5PcHRpb24oYWFhLkFWQVRBUikpIHsgcmV0dXJuIH0KCQlpZiAobXNnLk9wdGlvbihhYWEuQVZBVEFSKS5pbmRleE9mKCJodHRwIikgPT0gMCkgewoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCAiZGl2LnN0YXRlLmF2YXRhcj5pbWciLCB7c3JjOiBtc2cuT3B0aW9uKGFhYS5BVkFUQVIpfSkKCQl9IGVsc2UgewoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCAiZGl2LnN0YXRlLmF2YXRhcj5pbWciLCB7c3JjOiAiL3NoYXJlL2xvY2FsL2F2YXRhciJ9KQoJCX0KCX0sCglfbWVudXM6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4uc2V0SGVhZGVyTWVudShjYW4udXNlci5tb2QuaXNQb2R8fGNhbi51c2VyLmlzRXh0ZW5zaW9ufHxjYW4udXNlci5pc01vYmlsZT8gW2N0eC5DT05GSUddOgoJCQljYW4uYmFzZS5PYmoobXNnLk9wdGlvbihjaGF0Lk1FTlVTKXx8Y2FuLkNvbmYoY2hhdC5NRU5VUyksIGNhbi5vbmFjdGlvbi5fbWVudXMpLCBmdW5jdGlvbihldmVudCwgYnV0dG9uKSB7CgkJCQljYW4uY29yZS5DYWxsRnVuYyhjYW4ub25hY3Rpb25bYnV0dG9uXXx8ZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJCWNhbi5ydW4oZXZlbnQsIFtidXR0b25dLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCAi5omn6KGM5oiQ5YqfIiwgY2FuLnVzZXIudHJhbnMoY2FuLCBidXR0b24pKSB9KQoJCQkJfSwge2V2ZW50OiBldmVudCwgY2FuOiBjYW4sIGJ1dHRvbjogYnV0dG9ufSkKCQkJfSkKCX0sCgoJX3RpbWU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJY2FuLmNvcmUuVGltZXIoe2ludGVydmFsOiA1MDB9LCBmdW5jdGlvbigpIHsgY2FuLm9uaW1wb3J0LnRpbWUoY2FuLCB0YXJnZXQpIH0pCgkJY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIHthY3Rpb246ICJkYXRlIiwgc3R5bGU6IHsibWluLXdpZHRoIjogMzA2fX0sIHRhcmdldCwgZnVuY3Rpb24oc3ViKSB7CgkJCWNhbi5nZXQoIkFjdGlvbiIsICJzaXplIiwgZnVuY3Rpb24obXNnLCB0b3ApIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IHRvcCwgcmlnaHQ6IDAsIGxlZnQ6IG51bGx9fSkKCQkJfSkKCQl9KSwgdGFyZ2V0Lm9ubW91c2VlbnRlciA9IHRhcmdldC5jbGljawoJfSwKCXRpbWU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4pCgkJdGFyZ2V0LmlubmVySFRNTCA9IGNhbi51c2VyLnRpbWUoY2FuLCBudWxsLCAiJXcgJUg6JU06JVMiKQoJfSwKCXRvcGljOiBmdW5jdGlvbihjYW4sIHRvcGljKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNhbi5fdG9waWMgPSB0b3BpYykgfSwKCWJhY2tncm91bmQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHVybCkgeyBpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24gfHwgY2FuLnVzZXIuaXNMb2NhbEZpbGUpIHsgcmV0dXJuIH0KCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgYWFhLkJBQ0tHUk9VTkQsIHVybF0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ub25pbXBvcnQuX2JhY2tncm91bmQoY2FuLCBtc2cpIH0pCgl9LAoJYXZhdGFyOiBmdW5jdGlvbihldmVudCwgY2FuLCB1cmwpIHsgaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uIHx8IGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGFhYS5BVkFUQVIsIHVybF0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ub25pbXBvcnQuX2F2YXRhcihjYW4sIG1zZykgfSkKCX0sCgltZW51OiBmdW5jdGlvbihjYW4sIGNtZHMsIGNiLCB0cmFucykgewoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgW3t0eXBlOiBjbWRzWzBdLCBsaXN0OiBjYW4uY29yZS5MaXN0KGNtZHMuc2xpY2UoMSksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaWYgKGNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pKSB7CgkJCQlyZXR1cm4ge3ZpZXc6IFtodG1sLk1FTlUsIGh0bWwuRElWLCBjYW4udXNlci50cmFucyhjYW4sIGl0ZW0sIHRyYW5zKV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbSwgY21kcykKCQkJCX19CgoJCQl9IGVsc2UgaWYgKGNhbi5iYXNlLmlzQXJyYXkoaXRlbSkpIHsKCQkJCXZhciBsaXN0ID0gY2FuLmNvcmUuTGlzdChpdGVtLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsgcmV0dXJuIGNhbi51c2VyLnRyYW5zKGNhbiwgdmFsdWUsIHRyYW5zKSB9KQoJCQkJcmV0dXJuIHt2aWV3OiBbaHRtbC5NRU5VLCBodG1sLkRJViwgY2FuLnVzZXIudHJhbnMoY2FuLCBsaXN0WzBdLCB0cmFucyldLCBvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLm9uYWN0aW9uLmNhcnRlKGV2ZW50LCBjYW4sIGxpc3Quc2xpY2UoMSksIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIG1ldGEsIGluZGV4KSB7CgkJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGl0ZW1baW5kZXgrMV0sIGl0ZW0pCgkJCQkJfSwgdHJhbnMpCgkJCQl9fQoKCQkJfSBlbHNlIGlmIChjYW4uYmFzZS5pc09iamVjdChpdGVtKSkgewoJCQkJcmV0dXJuIGl0ZW0KCQkJfQoJCX0pIH1dKS5maXJzdAoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJfSwKCV9tZW51czogW1sic2V0dGluZyIsIGNoYXQuQkxBQ0ssIGNoYXQuV0hJVEUsIGNoYXQuUFJJTlQsICJ3ZWJwYWNrIiwgInRvaW1hZ2UiLCBjdHguQ09ORklHXV0sCglfdHJhbnM6IHsKCQkic2VhcmNoIjogIuaQnOe0oiIsCgkJImNyZWF0ZSI6ICLliJvlu7oiLAoJCSJzaGFyZSI6ICLlhbHkuqsiLAoKCQkic2V0dGluZyI6ICLorr7nva4iLAoJCSJibGFjayI6ICLpu5HoibLkuLvpopgiLAoJCSJ3aGl0ZSI6ICLnmb3oibLkuLvpopgiLAoJCSJwcmludCI6ICLmiZPljbDkuLvpopgiLAoJCSJ0b2ltYWdlIjogIueUn+aIkOWbvueJhyIsCgkJImNvbmZpZyI6ICLmi4nlj5bphY3nva4iLAoKCQkic2hhcmV1c2VyIjogIuWFseS6q+eUqOaItyIsCgkJInNldG5pY2siOiAi6K6+572u5pi156ewIiwKCQkicGFzc3dvcmQiOiAi5L+u5pS55a+G56CBIiwKCQkibGFuZ3VhZ2UiOiAi6K+t6KiA5Zyw5Yy6IiwKCQkiY2hpbmVzZSI6ICLkuK3mlociLAoJCSJjbGVhciI6ICLmuIXpmaTog4zmma8iLAoJfSwKCW9ubWFpbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQlmdW5jdGlvbiBpbml0KCkgeyBjYW4ucnVuKHt9LCBbXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5iYXNlLkNvcHkoY2FuLm9uYWN0aW9uLl90cmFucywgY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5UUkFOUyksIHt9KSkKCQkJY2FuLm9uaW1wb3J0Ll9pbml0KGNhbiwgbXNnLCBmdW5jdGlvbihtc2cpIHsgY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNoYXQuT05MT0dJTiwgbXNnKSB9LCBjYW4uX291dHB1dCkKCQl9KSB9CgoJCS8vIOeZu+W9leajgOafpQoJCWNhbi51c2VyLmlzTG9jYWxGaWxlPyBpbml0KCk6IGNhbi5ydW4oe30sIFtjaGF0LkNIRUNLXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5Db25mKGFhYS5VU0VSTklDSywgbXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOSUNLKXx8bXNnLk9wdGlvbihpY2UuTVNHX1VTRVJOQU1FKSk/IGluaXQoKToKCQkJCW1zZy5PcHRpb24oY2hhdC5TU08pPyBjYW4udXNlci5qdW1wcyhtc2cuT3B0aW9uKGNoYXQuU1NPKSk6CgkJCQljYW4udXNlci5sb2dpbihjYW4sIGluaXQsIG1zZy5PcHRpb24oYWFhLkxPR0lOKSwgbXNnLk9wdGlvbigibG9naW4uZGV2IikpCgkJfSkKCX0sCglvbnN0b3JtX3NlbGVjdDogZnVuY3Rpb24oY2FuLCBtc2csIHJpdmVyLCBzdG9ybSkgeyBjYW4uQ29uZihjaGF0LlJJVkVSLCByaXZlciksIGNhbi5Db25mKGNoYXQuU1RPUk0sIHN0b3JtKSB9LAoJb25zZWFyY2hmb2N1czogZnVuY3Rpb24oY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYuc2VhcmNoIGlucHV0IiwgZnVuY3Rpb24odGFyZ2V0KSB7IHRhcmdldC5mb2N1cygpIH0pCgl9LAoJb253ZWJwYWNrOiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4ub25hY3Rpb25bIndlYnBhY2siXShtc2cuX2V2ZW50LCBjYW4pIH0sCgoJdGl0bGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgYXJncyA9IHt9OyBjYW4uY29yZS5MaXN0KFtjaGF0LlRJVExFLCBjaGF0LlRPUElDLCBjaGF0LkxBWU9VVF0sIGZ1bmN0aW9uKGtleSkgewoJCQl2YXIgdmFsdWUgPSBjYW4ubWlzYy5TZWFyY2goY2FuLCBrZXkpOyB2YWx1ZSAmJiAoYXJnc1trZXldID0gdmFsdWUpCgkJfSkKCQljYW4udXNlci5qdW1wcyhjYW4ubWlzYy5NZXJnZVVSTChjYW4sIGFyZ3MsIHRydWUpKQoJfSwKCglibGFjazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGJ1dHRvbiksIGNhbi5vbmxheW91dC5faW5pdChjYW4pIH0sCgl3aGl0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGJ1dHRvbiksIGNhbi5vbmxheW91dC5faW5pdChjYW4pIH0sCglwcmludDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmxheW91dC50b3BpYyhjYW4sIGNhbi5iYXNlLmpvaW4oW2NoYXQuV0hJVEUsIGJ1dHRvbl0pKQoJCWNhbi5zZXQoIlJpdmVyIiwgaHRtbC5IRUlHSFQsIC0xKSwgY2FuLnNldCgiQWN0aW9uIiwgaHRtbC5IRUlHSFQsIC0xKQoJfSwKCWNvbmZpZzogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7bmFtZTogInNjb3BlIiwgdmFsdWU6ICJldGMvbG9jYWwuc2h5In1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBtZXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09ORklHXS5jb25jYXQoYXJncyksIGZ1bmN0aW9uKG1zZykgeyBjYW4udXNlci5qdW1wcyhtc2cuUmVzdWx0KCkpIH0pCgkJfSkKCX0sCgl3ZWJwYWNrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiBtZGIuTkFNRSwgdmFsdWU6IGNhbi51c2VyLnRpdGxlKCl9XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgbWV0YSwgbGlzdCkgewoJCQljYW4uY29yZS5JdGVtKFZvbGNhbm9zLm1ldGEucGFjaywgZnVuY3Rpb24oa2V5LCBtc2cpIHsgCgkJCQljYW4uY29yZS5MaXN0KFsiX2V2ZW50IiwgIl9jYW4iLCAiX3hociIsIGljZS5NU0dfU0VTU0lELCAiIl0sIGZ1bmN0aW9uKGtleSkgeyBkZWxldGUobXNnW2tleV0pIH0pCgkJCX0pCgkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgewoJCQkJdG9waWM6IGNhbi5fdG9waWMsIGxheW91dDogIGNhbi5nZXRBY3Rpb24oY2hhdC5MQVlPVVQpLAoJCQkJcml2ZXI6IGNhbi5Db25mKGNoYXQuUklWRVIpLCBzdG9ybTogY2FuLkNvbmYoY2hhdC5TVE9STSksCgkJCQluYW1lOiBtZXRhLm5hbWUsIGNvbnRlbnQ6IEpTT04uc3RyaW5naWZ5KFZvbGNhbm9zLm1ldGEucGFjayksCgkJCQlhcmdzOiAibmFtZSx0b3BpYyxsYXlvdXQscml2ZXIsc3Rvcm0iLAoJCQl9KQoKCQkJdmFyIHRvYXN0ID0gY2FuLnVzZXIudG9hc3QoY2FuLCAi5omT5YyF5LitLi4uIiwgY29kZS5XRUJQQUNLLCAxMDAwMDAwKQoJCQljYW4ucnVuKGV2ZW50LCBbY29kZS5XRUJQQUNLXSwgZnVuY3Rpb24obXNnKSB7CgkJCQl0b2FzdC5jbG9zZSgpLCBjYW4udXNlci50b2FzdChjYW4sICLmiZPljIXmiJDlip8iLCBjb2RlLldFQlBBQ0spCgkJCQljYW4udXNlci5kb3dubG9hZChjYW4sICIvc2hhcmUvbG9jYWwvIittc2cuUmVzdWx0KCksIG5hbWUrIi5odG1sIikKCQkJfSkKCQl9KQoJfSwKCXRvaW1hZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBjYW4ub25tb3Rpb24udG9pbWFnZShldmVudCwgY2FuLCBkb2N1bWVudC50aXRsZSwgZG9jdW1lbnQuYm9keSkgfSwKCgljYXJ0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbGlzdCwgY2IsIHRyYW5zKSB7IGNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIGNhbi5vbmFjdGlvbiwgbGlzdCwgY2IpIH0sCglzaGFyZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYXJncykgewoJCWNhbi51c2VyLnNoYXJlKGNhbiwgY2FuLnJlcXVlc3QoZXZlbnQpLCBbY3R4LkFDVElPTiwgY2hhdC5TSEFSRV0uY29uY2F0KGFyZ3N8fFtdLAoJCQlbY2hhdC5SSVZFUiwgY2FuLkNvbmYoY2hhdC5SSVZFUiksIGNoYXQuU1RPUk0sIGNhbi5Db25mKGNoYXQuU1RPUk0pXSkpCgl9LAoKCXVzZXJuaWNrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIubW9kLmlzUG9kIHx8IGNhbi51c2VyLmlzRXh0ZW5zaW9uIHx8IGNhbi51c2VyLmlzTG9jYWxGaWxlIHx8IGNhbi5vbmFjdGlvbi5jYXJ0ZShldmVudCwgY2FuLCBbInNoYXJldXNlciIsICJzZXRuaWNrIiwgInBhc3N3b3JkIiwgW2FhYS5MQU5HVUFHRSwgYWFhLkNISU5FU0UsIGFhYS5FTkdMSVNIXSwgY2xpLkNMRUFSLCBhYWEuTE9HT1VUXSkKCX0sCglzaGFyZXVzZXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnVzZXIuc2hhcmUoY2FuLCBjYW4ucmVxdWVzdChldmVudCksIFtjdHguQUNUSU9OLCBjaGF0LlNIQVJFLCBtZGIuVFlQRSwgYWFhLkxPR0lOXSkgfSwKCXNldG5pY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgdWkgPSBjYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGFhYS5VU0VSTklDSywgdmFsdWU6IGNhbi5Db25mKGFhYS5VU0VSTklDSyl9XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgYXJncykgewoJCQljYW4ucnVuKGV2ZW50LCBbYWFhLlVTRVJOSUNLLCBsaXN0WzBdXSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgY2FuLmNvcmUuS2V5cyhodG1sLkRJViwgYWFhLlVTRVJOSUNLKSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIGNhbi5Db25mKGFhYS5VU0VSTklDSywgbGlzdFswXSkpCgkJCQl9KSwgY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbikKCQkJfSwgdHJ1ZSkKCQl9KQoJCWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLl90YXJnZXQsIHtzdHlsZToge3RvcDogNDAsIHJpZ2h0OiAwLCBsZWZ0OiAiIn19KQoJfSwKCXBhc3N3b3JkOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIHVpID0gY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiBodG1sLlBBU1NXT1JELCB0eXBlOiBodG1sLlBBU1NXT1JELCBhY3Rpb246IGljZS5BVVRPfSwge25hbWU6IGh0bWwuUEFTU1dPUkQsIHR5cGU6IGh0bWwuUEFTU1dPUkQsIGFjdGlvbjogaWNlLkFVVE99XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgYXJncykgewoJCQlpZiAobGlzdFswXSAhPSBsaXN0WzFdKSB7CgkJCQljYW4udXNlci50b2FzdChjYW4sICLlr4bnoIHkuI3kuIDoh7QiKQoJCQkJdWkuZm9jdXMoKQoJCQkJcmV0dXJuIHRydWUKCQkJfQoKCQkJY2FuLnJ1bihldmVudCwgW2FhYS5QQVNTV09SRCwgbGlzdFswXV0sIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbikKCQkJfSwgdHJ1ZSkKCQl9KQoJCWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLl90YXJnZXQsIHtzdHlsZToge3RvcDogNDAsIHJpZ2h0OiAwLCBsZWZ0OiAiIn19KQoJfSwKCWNoaW5lc2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm1pc2MuU2VhcmNoKGNhbiwgYWFhLkxBTkdVQUdFLCAiemgiKSB9LAoJZW5nbGlzaDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ubWlzYy5TZWFyY2goY2FuLCBhYWEuTEFOR1VBR0UsICJlbiIpIH0sCgljbGVhcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQuYmFja2dyb3VuZChldmVudCwgY2FuLCAiIiksIGNhbi5vbmltcG9ydC5hdmF0YXIoZXZlbnQsIGNhbiwgIiIpLCBjYW4udXNlci5yZWxvYWQodHJ1ZSkgfSwKCWxvZ291dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4udXNlci5sb2dvdXQoY2FuKSB9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJaGVpZ2h0OiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5fdGFyZ2V0Lm9mZnNldEhlaWdodCB9LAoJdG9waWM6IGZ1bmN0aW9uKGNhbikgeyByZXR1cm4gY2FuLl90b3BpYyB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvYWN0aW9uLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgcml2ZXIgPSBjYW4uQ29uZihjaGF0LlJJVkVSKSwgc3Rvcm0gPSBjYW4uQ29uZihjaGF0LlNUT1JNKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4uY29yZS5OZXh0KG1zZy5UYWJsZSgpLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCWl0ZW0uaGVpZ2h0ID0gY2FuLkNvbmYoaHRtbC5IRUlHSFQpLWNhbi5Db25mKGh0bWwuTUFSR0lOX1kpCgkJCWl0ZW0ud2lkdGggPSBjYW4uQ29uZihodG1sLldJRFRIKS1jYW4uQ29uZihodG1sLk1BUkdJTl9YKQoJCQlpdGVtLmZlYXR1cmUgPSBjYW4uYmFzZS5PYmooaXRlbS5mZWF0dXJlfHxpdGVtLm1ldGEpCgkJCWl0ZW0uaW5wdXRzID0gY2FuLmJhc2UuT2JqKGl0ZW0uaW5wdXRzfHxpdGVtLmxpc3QpCgoJCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwgaXRlbSwgZnVuY3Rpb24oc3ViLCBtZXRhLCBza2lwKSB7CgkJCQljYW4ub25pbXBvcnQuX3BsdWdpbihjYW4sIHJpdmVyLCBzdG9ybSwgc3ViLCBtZXRhKSwgc2tpcCB8fCBuZXh0KCkKCQkJfSkKCQl9LCBmdW5jdGlvbigpIHsKCQkJY2FuLm9uYWN0aW9uLmxheW91dChjYW4sIGNhbi5taXNjLlNlYXJjaE9yQ29uZihjYW4sIGNoYXQuTEFZT1VUKXx8Vm9sY2Fub3MubWV0YS5hcmdzLmxheW91dHx8ImF1dG8iLCB0cnVlKQoJCQljYW4ub25pbXBvcnQuX21lbnUoY2FuLCBtc2cpLCBjYW4ub25rZXltYXAuX2luaXQoY2FuKQoJCX0pCgl9LAoJX3BsdWdpbjogZnVuY3Rpb24oY2FuLCByaXZlciwgc3Rvcm0sIHN1YiwgbWV0YSkgeyBzdWIuX3RhcmdldC5fbWV0YSA9IG1ldGEKCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCkKCQkJcmV0dXJuIGNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtyaXZlciwgc3Rvcm0sIG1ldGEuaWR8fG1ldGEuaW5kZXhdLCBjbWRzKSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQkJfSkKCQl9LCBjYW4uX3BsdWdpbnMgPSBjYW4ubWlzYy5jb25jYXQoY2FuLCBjYW4uX3BsdWdpbnMsIFtzdWJdKQoKCQltZXRhLmlkICYmIChzdWIuX29wdGlvbi5kYXRhc2V0ID0gc3ViLl9vcHRpb24uZGF0YXNldHx8e30sIHN1Yi5fb3B0aW9uLmRhdGFzZXQuaWQgPSBtZXRhLmlkKQoKCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIm9yaWVudGF0aW9uY2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgsIG1ldGEud2lkdGgtKGNhbi51c2VyLmlzV2luZG93cz8gMjA6IDApKQoJCX0pCgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgsIG1ldGEud2lkdGgtKGNhbi51c2VyLmlzV2luZG93cz8gMjA6IDApKQoKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX2FjdGlvbiwgW3t2aWV3OiBbaHRtbC5UQUJTLCBodG1sLkRJViwgbWV0YS5uYW1lXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLkZJRUxEU0VUX1BMVUdJTiwgc3ViLl90YXJnZXQpCgkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4uX2FjdGlvbiwgaHRtbC5ESVZfVEFCUywgZXZlbnQudGFyZ2V0KQoJCX0sIG9ubW91c2VlbnRlcjogc3ViLl9sZWdlbmQub25tb3VzZWVudGVyLCBvbmRibGNsaWNrOiBzdWIuX2xlZ2VuZC5vbmNsaWNrfV0pCgl9LAoJX21lbnU6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGlmIChjYW4udXNlci5tb2QuaXNQb2R8fGNhbi51c2VyLmlzTW9iaWxlKSB7IHJldHVybiB9CgkJY2FuLnNldEhlYWRlck1lbnUoY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5NRU5VUyksIGNhbi5Db25mKGNoYXQuTUVOVVMpfHxjYW4ub25hY3Rpb24uX21lbnVzKSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbGlzdCkgewoJCQljYW4uY29yZS5DYWxsRnVuYyhbY2FuLm9uYWN0aW9uLCBsaXN0WzBdXSwgW2NhbiwgYnV0dG9uXSkKCQl9KQoJfSwKCglfc2hhcmU6IGZ1bmN0aW9uKGNhbiwgc2hhcmUpIHsgc2hhcmUgJiYgY2FuLnJ1bih7fSwgWyJfc2hhcmUiLCBzaGFyZV0sIGZ1bmN0aW9uKG1zZykgewoJCWNhbi51c2VyLnRpdGxlKG1zZy5PcHRpb25PclNlYXJjaChjaGF0LlRJVExFKSkKCQljYW4uc2V0SGVhZGVyKGNoYXQuVE9QSUMsIG1zZy5PcHRpb25PclNlYXJjaChjaGF0LlRPUElDKSkKCgkJaWYgKG1zZy5MZW5ndGgoKSA9PSAxKSB7CgkJCWNhbi5zZWFyY2goZXZlbnQsIFsiSGVhZGVyLm9ubW90aW9uLmhpZGRlbiJdKQoJCQljYW4uc2VhcmNoKGV2ZW50LCBbIkZvb3Rlci5vbm1vdGlvbi5oaWRkZW4iXSkKCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fdGFyZ2V0LCAiY21kIikKCQkJY2FuLkNvbmYoaHRtbC5IRUlHSFQsIHdpbmRvdy5pbm5lckhlaWdodCkKCQkJY2FuLkNvbmYoaHRtbC5XSURUSCwgd2luZG93LmlubmVyV2lkdGgpCgkJfQoKCQljYW4uQ29uZihodG1sLk1BUkdJTl9YLCAwLCBodG1sLk1BUkdJTl9ZLCAyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQljYW4ub25sYXlvdXQuX2luaXQoY2FuLCBkb2N1bWVudC5ib2R5KQoKCQljYW4uQ29uZihjaGF0LlJJVkVSLCAiX3NoYXJlIiwgY2hhdC5TVE9STSwgc2hhcmUpCgkJbXNnLkxlbmd0aCgpID4gMCAmJiBjYW4ub25pbXBvcnQuX2luaXQoY2FuLCBtc2cpCgl9KSB9LAoJX2NtZDogZnVuY3Rpb24oY2FuLCBpdGVtLCBuZXh0KSB7CgkJY2FuLmJhc2UuQ29weShpdGVtLCB7CgkJCWhlaWdodDogd2luZG93LmlubmVySGVpZ2h0LWNhbi5Db25mKGh0bWwuTUFSR0lOX1kpKyhjYW4udXNlci5pc1dpbmRvd3M/IDE3OiAwKSwKCQkJd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLAoJCQlvcHRzOiBjYW4ubWlzYy5TZWFyY2goY2FuKSwKCQl9KQoJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBpdGVtLCBmdW5jdGlvbihzdWIsIG1ldGEsIHNraXApIHsKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgsIHdpbmRvdy5pbm5lcldpZHRoKQoJCQljYW4udXNlci50aXRsZShtZXRhLm5hbWUpLCBza2lwIHx8IG5leHQoKQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25lbmdpbmUiLCB7aGVscDogIuino+aekOW8leaTjiIsIGxpc3Q6IFtdLCBfZW5naW5lOiBmdW5jdGlvbihldmVudCwgcGFnZSwgbXNnLCBjYW4sIGNtZHMsIGNiKSB7Cgl2YXIgc3Rvcm0gPSBjYW4uY29yZS5WYWx1ZShjYW4uX3Jvb3QsIGNhbi5jb3JlLktleXMoY2hhdC5SSVZFUiwgY21kc1swXSwgY2hhdC5TVE9STSwgY21kc1sxXSkpCglpZiAoIXN0b3JtIHx8IGNtZHMubGVuZ3RoICE9IDIpIHsgcmV0dXJuIGZhbHNlIH0KCglpZiAoc3Rvcm0uaW5kZXgpIHsgLy8g5ZG95Luk57Si5byVCgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGN0eC5DT01NQU5EXS5jb25jYXQoc3Rvcm0uaW5kZXgpLCBjYikKCX0gZWxzZSB7IC8vIOWRveS7pOWIl+ihqAoJCWNhbi5jb3JlLkxpc3Qoc3Rvcm0ubGlzdCwgZnVuY3Rpb24odmFsdWUpIHsKCQkJbXNnLlB1c2gobWRiLk5BTUUsIHZhbHVlLm5hbWV8fCIiKQoJCQltc2cuUHVzaChtZGIuSEVMUCwgdmFsdWUuaGVscHx8IiIpCgkJCW1zZy5QdXNoKGN0eC5JTlBVVFMsIEpTT04uc3RyaW5naWZ5KHZhbHVlLmlucHV0cykpCgkJCW1zZy5QdXNoKGN0eC5GRUFUVVJFLCBKU09OLnN0cmluZ2lmeSh2YWx1ZS5mZWF0dXJlKSkKCQkJbXNnLlB1c2goY3R4LklOREVYLCB2YWx1ZS5pbmRleHx8IiIpCgkJCW1zZy5QdXNoKGN0eC5BUkdTLCB2YWx1ZS5hcmdzfHwiW10iKQoJCQltc2cuUHVzaChpY2UuTVNHX0FDVElPTiwgdmFsdWUuX2FjdGlvbnx8IiIpCgkJCW1zZy5QdXNoKCJkaXNwbGF5IiwgdmFsdWUuZGlzcGxheXx8IiIpCgkJfSksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJfQoJcmV0dXJuIHRydWUKfX0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5Lqk5LqS5pON5L2cIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIGNiLCB0YXJnZXQpIHsKCQljYW4uQ29uZihodG1sLk1BUkdJTl9ZLCA0Kmh0bWwuUExVR0lOX01BUkdJTisyKmh0bWwuQUNUSU9OX0hFSUdIVCtodG1sLkFDVElPTl9NQVJHSU4pCgkJY2FuLkNvbmYoaHRtbC5NQVJHSU5fWCwgNCpodG1sLlBMVUdJTl9NQVJHSU4pCgoJCWlmIChjYW4udXNlci5tb2QuaXNQb2QgfHwgY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJdmFyIGd0ID0gIiYjMTAwOTU7IiwgbHQgPSAiJiMxMDA5NDsiOyBmdW5jdGlvbiB0b2dnbGUodmlldykgeyByZXR1cm4gIWNhbi5zZXRSaXZlcigiZGlzcGxheSIpIH0KCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtbaHRtbC5UT0dHTEUsIGNoYXQuUFJPSkVDVF1dLCBsaXN0OiBbe3RleHQ6IFtndCwgaHRtbC5ESVZdfV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlldmVudC50YXJnZXQuaW5uZXJIVE1MID0gdG9nZ2xlKCk/IGd0OiBsdAoJCQl9fV0pCgkJfQoKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgInBhcnNlIiwgc2h5KCLop6PmnpAiLCB7CgkJCSJzaG93IjogZnVuY3Rpb24oY2FuLCBtc2csIGNtZHMpIHsKCQkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX2xlZ2VuZCkKCQkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX29wdGlvbikKCQkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX3N0YXR1cykKCgkJCQljYW4uQ29uZkhlaWdodChjYW4uQ29uZkhlaWdodCgpK2Nhbi5Db25mKGh0bWwuTUFSR0lOX1kpLShjYW4udXNlci5pc1dpbmRvd3M/IDE3OiAwKSkKCgkJCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIm1lbnUiLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCBtc2cuT3B0aW9uKGh0bWwuSVRFTSkpIH0pCgkJCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIumrmOe6p+mFjee9riIsIGZ1bmN0aW9uKG1zZykgeyBjYW4udXNlci50b2FzdChjYW4sIG1zZy5PcHRpb24oaHRtbC5JVEVNKSkgfSkKCQkJCWNhbi5vbmVuZ2luZS5saXN0ZW4oY2FuLCAiaDEiLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCAiaDEiKSB9KQoKCQkJCWNhbi5vbmFwcGVuZC5wYXJzZShjYW4sIGNhbi5vbmFwcGVuZC5fcGFyc2UoY2FuLCBjbWRzWzBdKSkKCQkJfSwKCQl9LCBbInRleHQiLCAic2hvdzpidXR0b25AYXV0byJdLCBmdW5jdGlvbihtc2csIGNtZHMsIGNiKSB7IGNhbi5ydW4oe30sIGNtZHMsIGNiLCB0cnVlKSB9KSkKCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJjb29raWUiLCBzaHkoIuaPkOekuiIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQljYW4uY29yZS5JdGVtKGNhbi5taXNjLkNvb2tpZShjYW4pLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCQltc2cuUHVzaCgia2V5Iiwga2V5KQoJCQkJbXNnLlB1c2goInZhbHVlIiwgdmFsdWUpCgkJCX0pCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJhbGVydCIsIHNoeSgi5o+Q56S6Iiwge30sIFsidGV4dCIsICJsaXN0IiwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCWNhbi51c2VyLmFsZXJ0KGNtZHNbMF0pCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJwbHVnaW4iLCBzaHkoIuaPkuS7tiIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQltc2cuRWNobygiaGVsbG8gd29ybGQiKQoJCX0pKQoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAiaW5mbyIsIHNoeSgi5L+h5oGvIiwge30sIFsidGV4dCIsICJsaXN0IiwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCW1zZy5FY2hvKCJoZWxsbyB3b3JsZCIpCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJsb2ciLCBzaHkoIuaXpeW/lyIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQljb25zb2xlLmxvZyhjbWRzWzBdKQoJCX0pKQoKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgIm5mcy5zYXZlIiwgc2h5KCLkv53lrZjmlofku7YiLCB7fSwgWyJmaWxlPWhpLnR4dCIsICJ0ZXh0OnRleHRhcmVhPSdoZWxsbyB3b3JsZCciLCAic2F2ZTpidXR0b24iXSwgZnVuY3Rpb24obXNnLCBjbWRzLCBjYikgewoJCQljYW4ubWlzYy5ydW5BY3Rpb24oY2FuLCBtc2csIGNtZHMsIGNiLCBraXQuRGljdCgKCQkJCSJzYXZlIiwgZnVuY3Rpb24oY21kcykgeyBjYW4udXNlci5kb3dubG9hZHMoY2FuLCBjbWRzWzFdLCBjbWRzWzBdKSB9CgkJCSkpCgkJfSkpCgoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAicGllIiwgc2h5KCLmr5Tkvovlm74iLCB7fSwgWyJsaXN0IiwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCW1zZy5EaXNwbGF5U3RvcnkoInBpZS5qcyIpCgkJCW1zZy5QdXNoKCJ2YWx1ZSIsIDIwMCkKCQkJbXNnLlB1c2goInZhbHVlIiwgMzAwKQoJCQltc2cuUHVzaCgidmFsdWUiLCA0MDApCgkJfSkpCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJjYW4uY29kZS5pbm5lci5wbHVnaW4iLCBzaHkoIuaPkuS7tiIsIHt9LCBbe3R5cGU6ICJidXR0b24iLCBuYW1lOiAibGlzdCIsIGFjdGlvbjogImF1dG8ifSwgImJhY2siXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7fSkpCgoJCXRhcmdldC5vbnRvdWNoc3RhcnQgPSBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uYWN0aW9uX3RvdWNoIiwgY2FuLnJlcXVlc3QoZXZlbnQpKQoJCX0sIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJfSwKCV9tZW51czogWwoJCVtjaGF0LkxBWU9VVCwgImF1dG8iLCAidGFicyIsICJncmlkIiwgImZyZWUiLCAiZmxvdyIsICJwYWdlIiwgInRvaW1hZ2UiXSwKCQlbaWNlLkhFTFAsICJ0dXRvciIsICJtYW51YWwiLCAic2VydmljZSIsICJkZXZvcHMiLCAicmVmZXIiXSwKCV0sCglfdHJhbnM6IHsKCQkibGF5b3V0IjogIuW4g+WxgCIsCgkJImF1dG8iOiAi6buY6K6k5biD5bGAIiwKCQkiZmxvdyI6ICLmtYHliqjluIPlsYAiLAoJCSJncmlkIjogIue9keagvOW4g+WxgCIsCgkJInRhYnMiOiAi5qCH562+5biD5bGAIiwKCQkiZnJlZSI6ICLoh6rnlLHluIPlsYAiLAoJCSJwYWdlIjogIue9kemhteW4g+WxgCIsCgkJInRvaW1hZ2UiOiAi55Sf5oiQ5Zu+54mHIiwKCgkJImhlbHAiOiAi5biu5YqpIiwKCQkidHV0b3IiOiAi5YWl6Zeo566A5LuLIiwKCQkibWFudWFsIjogIuS9v+eUqOaJi+WGjCIsCgkJInNlcnZpY2UiOiAi5pyN5Yqh5omL5YaMIiwKCQkiZGV2b3BzIjogIue8lueoi+aJi+WGjCIsCgkJInJlZmVyIjogIuWPguiAg+aJi+WGjCIsCgl9LAoJb25tYWluOiBmdW5jdGlvbihjYW4pIHsKCQljYW4ub25pbXBvcnQuX3NoYXJlKGNhbiwgY2FuLm1pc2MuU2VhcmNoKGNhbiwgd2ViLlNIQVJFKSkKCX0sCglvbmxvZ2luOiBmdW5jdGlvbihjYW4pIHsgaWYgKCFjYW4uQ29uZihjaGF0LlRPT0wpICYmICFjYW4udXNlci5tb2QuaXNDbWQpIHsgcmV0dXJuIH0KCQljYW4uQ29uZihodG1sLk1BUkdJTl9YLCAwLCBodG1sLk1BUkdJTl9ZLCAyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl90YXJnZXQsIGljZS5DTUQpCgkJY2FuLm9ubGF5b3V0Ll9pbml0KGNhbikKCgkJY2FuLl9uYW1lcyA9IGxvY2F0aW9uLnBhdGhuYW1lCgkJY2FuLkNvbmYoY2hhdC5UT09MKT8gY2FuLmNvcmUuTmV4dChjYW4uQ29uZihjaGF0LlRPT0wpLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCWNhbi5vbmltcG9ydC5fY21kKGNhbiwgaXRlbSwgbmV4dCkKCgkJfSk6IGNhbi5ydW4oY2FuLnJlcXVlc3QoKS5fZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09NTUFORF0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4uY29yZS5OZXh0KG1zZy5UYWJsZSgpLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCQljYW4ub25pbXBvcnQuX2NtZChjYW4sIGl0ZW0sIG5leHQpCgkJCX0pCgkJfSkKCX0sCglvbnN0b3JtX3NlbGVjdDogZnVuY3Rpb24oY2FuLCBtc2csIHJpdmVyLCBzdG9ybSkgeyBjYW4ub25sYXlvdXQuX2luaXQoY2FuKQoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsKCQkJdmFyIGtleSA9IGNhbi5jb3JlLktleXMoY2FuLkNvbmYoY2hhdC5SSVZFUiwgcml2ZXIpLCBjYW4uQ29uZihjaGF0LlNUT1JNLCBzdG9ybSkpCgkJCXJldHVybiBrZXkKCQl9LCBjYW4uX2FjdGlvbiwgY2FuLl9vdXRwdXQpKSB7CgkJCXZhciBjb25mID0gY2FuLmNvcmUuVmFsdWUoY2FuLl9yb290LCBjYW4uY29yZS5LZXlzKGNoYXQuUklWRVIsIHJpdmVyLCBjaGF0LlNUT1JNLCBzdG9ybSkpfHx7fQoJCQljYW4ub25hY3Rpb24ubGF5b3V0KGNhbiwgY29uZi5sYXlvdXR8fGNhbi5taXNjLlNlYXJjaE9yQ29uZihjYW4sIGNoYXQuTEFZT1VUKXx8Vm9sY2Fub3MubWV0YS5hcmdzLmxheW91dHx8ImF1dG8iLCB0cnVlKQoJCQlyZXR1cm4KCQl9CgoJCWNhbi5ydW4oe30sIFtyaXZlciwgc3Rvcm1dLCBmdW5jdGlvbihtc2cpIHsgaWYgKG1zZy5MZW5ndGgoKSA+IDApIHsgcmV0dXJuIGNhbi5vbmltcG9ydC5faW5pdChjYW4sIG1zZykgfQoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uYWN0aW9uX25vdG9vbCIsIGNhbi5yZXF1ZXN0KHt9LCB7cml2ZXI6IHJpdmVyLCBzdG9ybTogc3Rvcm19KSkKCQl9KQoJfSwKCW9uc2VhcmNoOiBmdW5jdGlvbihjYW4sIG1zZywgd29yZCkgewoJCWlmICh3b3JkWzBdID09IG1kYi5QTFVHSU4gfHwgd29yZFsxXSAhPSAiIikgeyBjYW4ub25leHBvcnQucGx1Z2luKGNhbiwgbXNnLCB3b3JkKSB9Cgl9LAoJb25zaXplOiBmdW5jdGlvbihjYW4sIG1zZywgaGVpZ2h0LCB3aWR0aCkgeyBjYW4uQ29uZih7aGVpZ2h0OiBoZWlnaHQsIHdpZHRoOiB3aWR0aH0pIH0sCgoJaGVscDogZnVuY3Rpb24oY2FuLCBidXR0b24pIHsgY2FuLnVzZXIub3BlbigiL2hlbHAvIitidXR0b24rIi5zaHkiKSB9LAoJbGF5b3V0OiBmdW5jdGlvbihjYW4sIGJ1dHRvbiwgc2lsZW50KSB7CgkJaWYgKGJ1dHRvbiA9PSAidG9pbWFnZSIpIHsKCQkJY2FuLm9ubW90aW9uLnRvaW1hZ2UoZXZlbnQsIGNhbiwgZG9jdW1lbnQudGl0bGUsIGNhbi5fb3V0cHV0KQoJCQlyZXR1cm4KCQl9CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIGNhbi5fdGFyZ2V0LCBjYW4uQ29uZihjaGF0LkxBWU9VVCkpCgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fdGFyZ2V0LCBjYW4uQ29uZihjaGF0LkxBWU9VVCwgYnV0dG9uKSkKCgkJaWYgKGJ1dHRvbiA9PSAiYXV0byIpIHsKCQkJY2FuLkNvbmYoY2hhdC5MQVlPVVQsICIiKQoKCQl9IGVsc2UgaWYgKGJ1dHRvbiA9PSAidGFicyIpIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLkZJRUxEU0VUX1BMVUdJTiwgMCkKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fYWN0aW9uLCBodG1sLkRJVl9UQUJTLCAwKQoJCX0gZWxzZSBpZiAoYnV0dG9uID09ICJmcmVlIikgewoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX3RhcmdldCwgW1todG1sLkRJVl9PVVRQVVQsIGh0bWwuRklFTERTRVRfUExVR0lOXV0sIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBpdGVtLCB7c3R5bGU6IHtsZWZ0OiA0MCppbmRleCwgdG9wOiA0MCppbmRleH19KQoJCQkJY2FuLm9ubW90aW9uLm1vdmUoY2FuLCBpdGVtLCB7bGVmdDogNDAqaW5kZXgsIHRvcDogNDAqaW5kZXh9KQoJCQl9KQoJCX0gZWxzZSBpZiAoYnV0dG9uID09ICJncmlkIikgewoJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6ICJtIiwgdmFsdWU6IDJ9LCB7bmFtZTogIm4iLCB2YWx1ZTogMn1dLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQljYW4uZ2V0QWN0aW9uU2l6ZShmdW5jdGlvbihoZWlnaHQsIHdpZHRoKSB7IHZhciBtID0gcGFyc2VJbnQoZGF0YS5tKXx8MiwgbiA9IHBhcnNlSW50KGRhdGEubil8fDIKCQkJCQljYW4ucGFnZS5jc3MoY2FuLmJhc2UucmVwbGFjZUFsbChjaGF0LkFDVElPTl9MQVlPVVRfRk1ULCAiX3dpZHRoIiwgKHdpZHRoLSg0Km0rMSkqaHRtbC5QTFVHSU5fTUFSR0lOKS9tKyJweCIsICJfaGVpZ2h0IiwgKGhlaWdodC0oNCpuKzEpKmh0bWwuUExVR0lOX01BUkdJTikvbisicHgiKSkKCQkJCX0pCgkJCX0sIHNpbGVudCkKCQl9CgkJY2FuLm9ubGF5b3V0Ll9pbml0KGNhbikKCX0sCn0pClZvbGNhbm9zKCJvbmtleW1hcCIsIHtoZWxwOiAi6ZSu55uY5Lqk5LqSIiwgbGlzdDogW10sIF9mb2N1czogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCWNhbi5vbmtleW1hcC5fYnVpbGQoY2FuKSwgY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sICJvbmtleWRvd24iLCBmdW5jdGlvbihtc2csIG1vZGVsKSB7CgkJCWNhbi5fa2V5bGlzdCA9IGNhbi5vbmtleW1hcC5fcGFyc2UobXNnLl9ldmVudCwgY2FuLCBtb2RlbCwgY2FuLl9rZXlsaXN0fHxbXSwgY2FuLl9vdXRwdXQpCgkJfSkKCX0sCglfbW9kZTogewoJCW5vcm1hbDogewoJCQlqOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdGFyZ2V0LnNjcm9sbEJ5KDAsIGV2ZW50LmN0cmxLZXk/IDMwMDogMzApIH0sCgkJCWs6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyB0YXJnZXQuc2Nyb2xsQnkoMCwgZXZlbnQuY3RybEtleT8gLTMwMDogLTMwKSB9LAoKCQkJYjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5zZWFyY2goZXZlbnQsIFsiSGVhZGVyLm9uYWN0aW9uLmJsYWNrIl0pIH0sCgkJCXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIkhlYWRlci5vbmFjdGlvbi53aGl0ZSJdKSB9LAoKCQkJZzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5zZWFyY2goZXZlbnQsIFsiUml2ZXIub25kZXRhaWwu5Yib5bu6576k57uEIl0pIH0sCgkJCXM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIlJpdmVyLm9uZGV0YWlsLua3u+WKoOW6lOeUqCJdKSB9LAoJCQl0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLnNlYXJjaChldmVudCwgWyJSaXZlci5vbmRldGFpbC7mt7vliqDlt6XlhbciXSkgfSwKCgkJCSIgIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uc2VhcmNoZm9jdXMiKQoJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCX0sCgkJCSI6IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uY29tbWFuZGZvY3VzIikKCQkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9LAoJCQllbnRlcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5taXNjLkxvZygiZW50ZXIiKSB9LAoJCQllc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgewoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZG9jdW1lbnQuYm9keSwgaHRtbC5GSUVMRFNFVF9BVVRPLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJLy8gY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGl0ZW0pCgkJCQl9KQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZG9jdW1lbnQuYm9keSwgY2FuLnBhZ2UuS2V5cyhodG1sLkZJRUxEU0VUX0ZMT0FULCBodG1sLkRJVl9GTE9BVCksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBpdGVtKQoJCQkJfSkKCQkJfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW10sCglhcmdzOiBmdW5jdGlvbihjYW4sIGNiLCB0YXJnZXQpIHsKCQljYW4uY29yZS5OZXh0KGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgW1todG1sLkZJRUxEU0VUX1BMVUdJTiwgaHRtbC5GT1JNX09QVElPTl1dKSwgZnVuY3Rpb24oaXRlbSwgbmV4dCwgaW5kZXgsIGFycmF5KSB7CgkJCWl0ZW0uZGF0YXNldC5hcmdzID0gSlNPTi5zdHJpbmdpZnkoY2FuLnBhZ2UuU2VsZWN0KGNhbiwgaXRlbSwgaHRtbC5PUFRJT05fQVJHUywgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS52YWx1ZXx8IiIgfSkpCgkJCWNiKGl0ZW0sIG5leHQsIGluZGV4LCBhcnJheSkKCQl9KQoJfSwKCXNpemU6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJbXNnLk9wdGlvbihodG1sLlRPUCwgY2FuLl90YXJnZXQub2Zmc2V0VG9wKQoJCW1zZy5PcHRpb24oaHRtbC5MRUZULCBjYW4uX3RhcmdldC5vZmZzZXRMZWZ0KQoJCW1zZy5PcHRpb24oaHRtbC5XSURUSCwgY2FuLl90YXJnZXQub2Zmc2V0V2lkdGgpCgkJaWYgKG1zZy5PcHRpb24oaHRtbC5IRUlHSFQsIGNhbi5fdGFyZ2V0Lm9mZnNldEhlaWdodC1jYW4uX2FjdGlvbi5vZmZzZXRIZWlnaHQpID4gd2luZG93LmlubmVySGVpZ2h0KSB7CgkJCW1zZy5PcHRpb24oaHRtbC5IRUlHSFQsIHdpbmRvdy5pbm5lckhlaWdodC0yKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQl9CgkJbXNnLk9wdGlvbihodG1sLlNDUk9MTCwgY2FuLnVzZXIuaXNNb2JpbGU/IGNhbi5fdGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5zY3JvbGxUb3A6IGNhbi5fb3V0cHV0LnNjcm9sbFRvcCkKCQltc2cuT3B0aW9uKGh0bWwuTUFSR0lOX1gsIGNhbi5Db25mKGh0bWwuTUFSR0lOX1gpKQoJCW1zZy5PcHRpb24oaHRtbC5NQVJHSU5fWSwgY2FuLkNvbmYoaHRtbC5NQVJHSU5fWSkpCgl9LAoJbGF5b3V0OiBmdW5jdGlvbihjYW4sIG1zZykgeyByZXR1cm4gY2FuLkNvbmYoY2hhdC5MQVlPVVQpIH0sCglwbHVnaW46IGZ1bmN0aW9uKGNhbiwgbXNnLCB3b3JkKSB7IHZhciBmaWVsZHMgPSBjYW4uY29yZS5TcGxpdChtc2cuT3B0aW9uKGljZS5NU0dfRklFTERTKSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgW1todG1sLkZJRUxEU0VUX1BMVUdJTiwgaHRtbC5MRUdFTkRdXSwgZnVuY3Rpb24oaXRlbSkgewoJCQlpZiAoaXRlbS5pbm5lckhUTUwuaW5kZXhPZih3b3JkWzFdKSA9PSAtMSkgeyByZXR1cm4gfQoKCQkJdmFyIG1ldGEgPSBpdGVtLnBhcmVudE5vZGUuX21ldGEKCQkJdmFyIGxpc3QgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBpdGVtLm5leHRTaWJsaW5nLCBodG1sLk9QVElPTl9BUkdTLCBmdW5jdGlvbihpdGVtKSB7IHJldHVybiBpdGVtLnZhbHVlfHwiIiB9KQoKCQkJdmFyIGRhdGEgPSB7Y3R4OiAid2ViLmNoYXQiLCBjbWQ6IGN0eC5BQ1RJT04sCgkJCQl0eXBlOiBtZGIuUExVR0lOLCBuYW1lOiBpdGVtLmlubmVySFRNTCwgdGV4dDogc2h5KCLot7PovawiLCBmdW5jdGlvbihldmVudCkgewoJCQkJCXZhciBpbnB1dCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGl0ZW0ucGFyZW50Tm9kZSwgaHRtbC5JTlBVVF9BUkdTKVswXQoJCQkJCWlucHV0ICYmIGlucHV0LmZvY3VzKCkKCQkJCX0pLCBhcmd1bWVudDogSlNPTi5zdHJpbmdpZnkobGlzdCksCgkJCX0KCQkJaWYgKG1ldGEuaW5kZXgpIHsKCQkJCWRhdGEuY29udGV4dCA9ICIiLCBkYXRhLmNvbW1hbmQgPSBtZXRhLmluZGV4CgkJCX0gZWxzZSBpZiAobWV0YS5jbWQpIHsKCQkJCWRhdGEuY29udGV4dCA9IG1ldGEuY3R4LCBkYXRhLmNvbW1hbmQgPSBtZXRhLmNtZAoJCQl9IGVsc2UgewoJCQkJcmV0dXJuCgkJCX0KCQkJbXNnLlB1c2goZGF0YSwgZmllbGRzKQoJCX0pCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvc2VhcmNoLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ubGlzdCA9IG1zZy5UYWJsZSgpLCBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkuY29udGVudCkKCQl2YXIgdGFibGUgPSBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkgeyBjYW4uU3RhdHVzKG1kYi5UT1RBTCwgaW5kZXgrMSkKCQkJcmV0dXJuIHt0ZXh0OiBba2V5ID09IG1kYi5URVhUICYmIGNhbi5iYXNlLmlzRnVuYyhsaW5lLnRleHQpICYmIGxpbmUudGV4dC5oZWxwIHx8IHZhbHVlLCBodG1sLlREXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbltjYW4udHlwZSA9PSAiKiJ8fGV2ZW50LmN0cmxLZXk/IGNoYXQuUExVR0lOOiBtZGIuU0VMRUNUXShldmVudCwgY2FuLCBpbmRleCkgCgkJCX19CgkJfSwgY2FuLnVpLmNvbnRlbnQsIGNhbi5jb3JlLkxpc3QoKG1zZy5PcHRpb24oInNvcnQiKXx8ImN0eCxjbWQsdHlwZSxuYW1lLHRleHQiKS5zcGxpdChpY2UuRlMpLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiBsaXN0LmluZGV4T2YoaXRlbSkKCQl9KSk7IHRhYmxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5kaXNwbGF5LCB7c3R5bGU6IHt3aWR0aDogdGFibGUub2Zmc2V0V2lkdGh9fSkKCQljYW4ub25tb3Rpb24uc3RvcnkuYXV0byhjYW4pCgoJCWNhbi5vbmFwcGVuZC5fc3RhdHVzKGNhbiwgY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oIl9zdGF0dXMiKSwgW10pLmNvbmNhdCh7bmFtZTogInNlbGVjdGVkIiwgdmFsdWU6ICIwIn0pKQoJCWNhbi5nZXRBY3Rpb25TaXplKGZ1bmN0aW9uKG1zZywgaGVpZ2h0KSB7CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9maWxlLCBraXQuRGljdChodG1sLk1BWF9IRUlHSFQsIGNhbi5iYXNlLk1pbihoZWlnaHQtKHRhYmxlJiZ0YWJsZS5vZmZzZXRIZWlnaHR8fDApLCBoZWlnaHQvMikpKQoJCX0pCgkJbXNnLkxlbmd0aCgpID09IDEgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFibGUsIGh0bWwuVEQpWzBdLmNsaWNrKCkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgIkEiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi51c2VyLm9wZW4oaXRlbS5ocmVmKSwgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpIH0KCQl9KQoJfSwKCV93b3JkOiBmdW5jdGlvbihjYW4sIG1zZywgY21kcywgZmllbGRzKSB7IGNhbi50eXBlID0gY21kc1swXQoJCXZhciBjYiA9IGNhbi5vbmFjdGlvbltjbWRzWzFdXTsgaWYgKGNiKSB7IGNiKHt9LCBjYW4pOyByZXR1cm4gfQoKCQl2YXIgcmVzID0gY2FuLnJlcXVlc3Qoe30sIHsKCQkJd29yZDogY21kcywgZmllbGRzOiBmaWVsZHMuam9pbihpY2UuRlMpLCBzb3J0OiBtc2cuT3B0aW9uKCJzb3J0IiksCgkJCXJpdmVyOiBtc2cuT3B0aW9uKGNoYXQuUklWRVIpLCBpbmRleDogbXNnLk9wdGlvbigiaW5kZXgiKSwKCQl9KQoKCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTlNFQVJDSCwgcmVzKQoJCWNhbi5ydW4ocmVzLl9ldmVudCwgY21kcywgZnVuY3Rpb24ocmVzKSB7IGNhbi5vbmltcG9ydC5faW5pdChjYW4sIHJlcywgZmllbGRzKSB9KQoJCWNhbi5vbm1vdGlvbi5zaG93KGNhbiksIGNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIGNhbi51aS53b3JkKQoJfSwKCglzZWxlY3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYikgeyBjYW4udWkud29yZC52YWx1ZSA9IGNtZHNbMV0KCQl2YXIgZmllbGRzID0gKGNtZHNbMl18fG1zZy5PcHRpb24oaWNlLk1TR19GSUVMRFMpfHwiY3R4LGNtZCx0eXBlLG5hbWUsdGV4dCIpLnNwbGl0KGljZS5GUykKCQljYW4ucGFnZS5BcHBlbmRzKGNhbiwgY2FuLnVpLmRpc3BsYXksIFt7dGg6IGZpZWxkc31dKSwgY2FuLmNiID0gZnVuY3Rpb24oKSB7CgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoY2FuLm9uZXhwb3J0LnNlbGVjdChjYW4pKSwgY2FuLm9ubW90aW9uLmhpZGUoY2FuKQoJCX0KCgkJY2FuLmlucHV0ID0gZnVuY3Rpb24oZXZlbnQsIHdvcmQpIHsgY21kc1sxXSA9IHdvcmR8fGNtZHNbMV0KCQkJY2FuLm9uaW1wb3J0Ll93b3JkKGNhbiwgbXNnLCBjbWRzLCBmaWVsZHMpCgkJfSwgY2FuLm9uaW1wb3J0Ll93b3JkKGNhbiwgbXNnLCBjbWRzLCBmaWVsZHMpCgoJCWNhbi5nZXRBY3Rpb25TaXplKGZ1bmN0aW9uKG1zZywgdG9wLCBsZWZ0LCB3aWR0aCwgaGVpZ2h0KSB7CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IHRvcCwgbGVmdDogbGVmdH19KQoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4uX291dHB1dCwge3N0eWxlOiBraXQuRGljdChodG1sLk1BWF9IRUlHSFQsIGhlaWdodC03MSwgaHRtbC5NQVhfV0lEVEgsIHdpZHRoLTIqaHRtbC5QTFVHSU5fTUFSR0lOKX0pCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5jb250ZW50LCB7c3R5bGU6IGtpdC5EaWN0KGh0bWwuTUFYX1dJRFRILCB3aWR0aC0yKmh0bWwuUExVR0lOX01BUkdJTil9KQoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkuZGlzcGxheSwge3N0eWxlOiBraXQuRGljdChodG1sLk1BWF9XSURUSCwgd2lkdGgtMipodG1sLlBMVUdJTl9NQVJHSU4pfSkKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmk43kvZwiLCBsaXN0OiBbY2xpLkNMRUFSLCBjbGkuQ0xPU0UsIGNsaS5ET05FXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX3RhcmdldCkKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCX0sCglvbmxvZ2luOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgY2FuLkNvbmYoaHRtbC5BQ1RJT04pfHxjYW4ub25hY3Rpb24ubGlzdCkKCQljYW4udWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgWwoJCQl7aW5wdXQ6IFsid29yZCIsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmtleW1hcC5pbnB1dChldmVudCwgY2FuKQoJCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVTQ0FQRSkgeyBjYW4ub25tb3Rpb24uaGlkZShjYW4pIH0KCgkJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRU5URVIpIHsgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCQkJaWYgKGV2ZW50LnNoaWZ0S2V5KSB7IHZhciBmaXJzdCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBodG1sLlRSKVsxXQoJCQkJCQlyZXR1cm4gY2FuLm9uYWN0aW9uW2Nhbi50eXBlID09ICIqIj8gY2hhdC5QTFVHSU46IGh0bWwuU0VMRUNUXShldmVudCwgY2FuLCBmaXJzdC5kYXRhc2V0LmluZGV4KQoJCQkJCX0KCQkJCQlpZiAoZXZlbnQuY3RybEtleSkgeyByZXR1cm4gY2FuLm9uYWN0aW9uW2NsaS5ET05FXShldmVudCwgY2FuKSB9CgkJCQkJY2FuLmlucHV0KGV2ZW50LCBldmVudC50YXJnZXQudmFsdWUpCgkJCQl9CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24odHIsIGluZGV4KSB7CgkJCQkJaWYgKGluZGV4ID09IDApIHsgcmV0dXJuIH0KCQkJCQl2YXIgaGFzID0gZmFsc2U7IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgewoJCQkJCQloYXMgPSBoYXMgfHwgdGQuaW5uZXJUZXh0LmluZGV4T2YoZXZlbnQudGFyZ2V0LnZhbHVlKSA+IC0xCgkJCQkJfSkKCQkJCQljYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgdHIsIGh0bWwuSElEREVOLCAhaGFzKQoJCQkJfSkKCQkJfV19LAoJCQl7dmlldzogY2hhdC5DT05URU5UfSwge3ZpZXc6IGh0bWwuU1RBVFVTfSwge3ZpZXc6IFtjaGF0LkRJU1BMQVksIGh0bWwuVEFCTEVdfSx7dmlldzogY2hhdC5QUk9GSUxFfSwKCQldKSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi51aS5kaXNwbGF5LCBjaGF0LkNPTlRFTlQpCgl9LAoJb25vcGVuc2VhcmNoOiBmdW5jdGlvbihjYW4sIG1zZywgdHlwZSwgd29yZCkgeyBjYW4ub25pbXBvcnQuc2VsZWN0KGNhbiwgbXNnLCBbdHlwZXx8IioiLCB3b3JkfHwiIl0pIH0sCgoJY2xlYXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLnByb2ZpbGUpIH0sCglkb25lOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5iYXNlLmlzRnVuYyhjYW4uY2IpICYmIGNhbi5jYigpIH0sCgljbG9zZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24uaGlkZShjYW4pIH0sCgoJc2VsZWN0OiBmdW5jdGlvbihldmVudCwgY2FuLCBpbmRleCkgeyB2YXIgbGluZSA9IGNhbi5saXN0W2luZGV4XQoJCWlmIChjYW4uYmFzZS5pc0Z1bmMobGluZS50ZXh0KSkgeyByZXR1cm4gY2FuLm9ubW90aW9uLmhpZGUoY2FuKSwgbGluZS50ZXh0KGV2ZW50KSB9CgoJCWlmIChsaW5lLmN0eCA9PSAid2ViLmNoYXQiICYmIGxpbmUuY21kID09ICIvc2VhcmNoIikgewoJCQlyZXR1cm4gY2FuLm9uaW1wb3J0LnNlbGVjdChjYW4sIG1zZywgW2xpbmUudHlwZSwgbGluZS5uYW1lLCBsaW5lLnRleHRdLCBjYW4uY2IpCgkJfQoKCQl2YXIgZmllbGRzID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmRpc3BsYXksIGh0bWwuVEgsIGZ1bmN0aW9uKGl0ZW0pIHsgcmV0dXJuIGl0ZW0uaW5uZXJUZXh0IH0pCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmRpc3BsYXksIFt7dGQ6IGNhbi5jb3JlLkxpc3QoZmllbGRzLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiBsaW5lW2l0ZW1dCgkJfSksIGRhdGE6IHtpbmRleDogaW5kZXh9LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBldmVudC50YXJnZXQucGFyZW50Tm9kZSkKCQkJY2FuLlN0YXR1cygic2VsZWN0ZWQiLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuZGlzcGxheSwgaHRtbC5UUikubGVuZ3RoLTEpCgkJfX1dKSwgY2FuLlN0YXR1cygic2VsZWN0ZWQiLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuZGlzcGxheSwgaHRtbC5UUikubGVuZ3RoLTEpCgl9LAoKCXBsdWdpbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgaW5kZXgpIHsgdmFyIGxpbmUgPSBjYW4ubGlzdFtpbmRleF0KCQlpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT0gIkEiKSB7IHJldHVybiB9CgkJaWYgKGxpbmUuY3R4ID09ICJ3ZWIud2lraSIgJiYgbGluZS5jbWQgPT0gIndvcmQiKSB7IHJldHVybiB9CgkJaWYgKGNhbi5iYXNlLmlzRnVuYyhsaW5lLnRleHQpKSB7IHJldHVybiBjYW4ub25tb3Rpb24uaGlkZShjYW4pLCBsaW5lLnRleHQoZXZlbnQpIH0KCgkJdmFyIGNtZCA9IGxpbmUuY21kID09IGN0eC5DT01NQU5EPyBjYW4uY29yZS5LZXlzKGxpbmUudHlwZSwgbGluZS5uYW1lLnNwbGl0KGljZS5TUClbMF0pOiBjYW4uY29yZS5LZXlzKGxpbmUuY3R4LCBsaW5lLmNtZCkKCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwge3R5cGU6IGNoYXQuUExVR0lOLCBpbmRleDogY21kfHxtc2cuT3B0aW9uKG1kYi5JTkRFWCl9LCBmdW5jdGlvbihzdWIsIG1ldGEpIHsKCQkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obXNnLCBoZWlnaHQsIHdpZHRoKSB7IGhlaWdodCA9IGNhbi5iYXNlLk1pbihoZWlnaHQgLSBjYW4udWkuY29udGVudC5vZmZzZXRIZWlnaHQrMjA0LCBoZWlnaHQvMikKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fb3V0cHV0LCB7c3R5bGU6IGtpdC5EaWN0KGh0bWwuTUFYX0hFSUdIVCwgaGVpZ2h0LTI2LCBodG1sLk1BWF9XSURUSCwgd2lkdGgtNDApfSkKCQkJCXN1Yi5Db25mKGh0bWwuSEVJR0hULCBoZWlnaHQrMjgpLCBzdWIuQ29uZihodG1sLldJRFRILCB3aWR0aC02MCkKCQkJfSkKCgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIG1ldGEuaW5kZXhdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQkJc3ViLkZvY3VzKCkKCQl9LCBjYW4udWkucHJvZmlsZSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW10sCglzZWxlY3Q6IGZ1bmN0aW9uKGNhbikgewoJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuZGlzcGxheSwgaHRtbC5UUiwgZnVuY3Rpb24odHIpIHsKCQkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgeyByZXR1cm4gdGQuaW5uZXJIVE1MIH0pCgkJfSkuc2xpY2UoMSkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wYW5lbC9mb290ZXIuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pCgkJY2FuLm9uaW1wb3J0Ll90aXRsZShjYW4sIG1zZywgdGFyZ2V0KQoJCWNhbi5vbmltcG9ydC5fc3RhdGUoY2FuLCBtc2csIHRhcmdldCkKCQljYW4ub25pbXBvcnQuX3RvYXN0KGNhbiwgbXNnLCB0YXJnZXQpCgkJY2FuLm9uaW1wb3J0Ll9jbGkoY2FuLCBtc2csIHRhcmdldCkKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCgkJY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsKCQkJd2luZG93LndlYnZpZXcgJiYgY2FuLnNldEhlYWRlck1lbnUoWyLlkI7pgIAiLCAi5YiX6KGoIl0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGxpc3QpIHsKCQkJCXN3aXRjaCAoYnV0dG9uKSB7CgkJCQkJY2FzZSAi5ZCO6YCAIjogaGlzdG9yeS5iYWNrKCk7IGJyZWFrCgkJCQkJY2FzZSAi5YiX6KGoIjogd2luZG93Lm1lbnUoKTsgYnJlYWsKCQkJCX0KCQkJCWNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25hY3Rpb24sIGxpc3RbMF1dLCBbY2FuLCBidXR0b25dKQoJCQl9KQoJCX0pCgl9LAoJX3RpdGxlOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJIWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5jb3JlLkxpc3QobXNnLnJlc3VsdCwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2NoYXQuVElUTEUsIGh0bWwuRElWLCBpdGVtXSwgdGl0bGU6ICLogZTns7vnq5nplb8ifV0pCgkJfSkKCX0sCglfc3RhdGU6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4uY29yZS5MaXN0KGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKGNoYXQuU1RBVEUpfHxjYW4uQ29uZihjaGF0LlNUQVRFKSwgWyJuY21kIl0pLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2FuLmJhc2Uuam9pbihbY2hhdC5TVEFURSwgaXRlbV0pLCBodG1sLkRJViwgY2FuLkNvbmYoaXRlbSldLCBsaXN0OiBbCgkJCQl7dGV4dDogW2l0ZW0sIGh0bWwuTEFCRUxdfSwge3RleHQ6IFsiOiAiLCBodG1sLkxBQkVMXX0sIHt0ZXh0OiBbY2FuLkNvbmYoaXRlbSl8fCIiLCBodG1sLlNQQU4sIGl0ZW1dfSwKCQkJXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5zaG93ID0gY2FuLnNob3c/IChjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uc2hvdyksIG51bGwpOiBjYW4ub25hY3Rpb24uX2NtZChjYW4pCgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4uc2hvdywge3N0eWxlOiB7bGVmdDogIiIsIHRvcDogIiIsIHJpZ2h0OiAwLCBib3R0b206IGNhbi5vbmV4cG9ydC5oZWlnaHQoY2FuKX19KQoJCQl9fV0pCgkJfSkKCX0sCglfdG9hc3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4udG9hc3QgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogY2hhdC5UT0FTVCwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnNob3cgPSBjYW4uc2hvdz8gKGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5zaG93KSwgbnVsbCk6IGNhbi5vbmFwcGVuZC5mbG9hdChjYW4sIGNhbi5fdG9hc3QpLmZpcnN0CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5zaG93LCB7c3R5bGU6IHtsZWZ0OiAiIiwgdG9wOiAiIiwgcmlnaHQ6IDAsIGJvdHRvbTogY2FuLm9uZXhwb3J0LmhlaWdodChjYW4pfX0pCgkJfX1dKS5maXJzdAoJfSwKCV9jbGk6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4ub25hcHBlbmQuaW5wdXQoY2FuLCB7dHlwZTogaHRtbC5URVhULCBuYW1lOiAiY21kIiwgb25rZXlkb3duOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbik7IGlmIChldmVudC5rZXkgIT0gbGFuZy5FTlRFUikgeyByZXR1cm4gfQoJCQlzd2l0Y2ggKGV2ZW50LnRhcmdldC52YWx1ZSkgewoJCQkJY2FzZSBjbGkuQ0xFQVI6IGNhbi5jbGkgJiYgY2FuLmNsaS5jbG9zZSgpOyBicmVhawoJCQkJY2FzZSBjbGkuQ0xPU0U6IGNhbi5jbGkgJiYgY2FuLmNsaS5jbG9zZSgpOyBicmVhawoJCQkJZGVmYXVsdDoKCQkJCQljYW4ucnVuKGV2ZW50LCBbaWNlLlJVTl0uY29uY2F0KGNhbi5jb3JlLlNwbGl0KGV2ZW50LnRhcmdldC52YWx1ZSwgaWNlLlNQKSksIGZ1bmN0aW9uKG1zZykgewoJCQkJCQljYW4uY2xpICYmIGNhbi5jbGkuY2xvc2UoKQoJCQkJCQljYW4uY2xpID0gY2FuLm9uYXBwZW5kLmZsb2F0KGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgbGlzdCkgewoKCQkJCQkJfSksIGNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5jbGkuZmlyc3QsIHtzdHlsZToge2JvdHRvbTogY2FuLm9uZXhwb3J0LmhlaWdodChjYW4pLCB0b3A6ICIifX0pCgkJCQkJfSkKCQkJfQoJCX19LCAiIiwgdGFyZ2V0LCAidGl0bGUgY21kIikKCX0sCgoJdG9hc3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0aXRsZSwgY29udGVudCwgZmlsZWxpbmUsIHRpbWUpIHsgY2FuLl90b2FzdCA9IGNhbi5fdG9hc3R8fGNhbi5yZXF1ZXN0KCkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udG9hc3QsIFt0aW1lLnNwbGl0KGljZS5TUCkucG9wKCksIHRpdGxlLCBjb250ZW50XS5qb2luKGljZS5TUCkpCgkJY2FuLl90b2FzdC5QdXNoKHt0aW1lOiB0aW1lLCBmaWxlbGluZTogZmlsZWxpbmUsIHRpdGxlOiB0aXRsZSwgY29udGVudDogY29udGVudH0pCgl9LAoJbmNtZDogZnVuY3Rpb24oY2FuLCBtc2csIF9mb2xsb3csIF9jbWRzKSB7IHZhciBOQ01EID0gIm5jbWQiOyBjYW4uX2NtZHMgPSBjYW4uX2NtZHN8fGNhbi5yZXF1ZXN0KCkKCQljYW4uX2NtZHMuUHVzaCh7dGltZTogY2FuLmJhc2UuVGltZSgpLCBmb2xsb3c6IF9mb2xsb3csIGNtZHM6IF9jbWRzfSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgY2FuLmNvcmUuS2V5cyhodG1sLlNQQU4sIE5DTUQpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uaW5uZXJIVE1MID0gY2FuLkNvbmYoTkNNRCwgcGFyc2VJbnQoY2FuLkNvbmYoTkNNRCl8fCIwIikrMSsiIikrIiIKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJLy8gY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0KCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCX0sCglvbmxvZ2luOiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4ucnVuKHt9LCBbXSwgZnVuY3Rpb24obXNnKSB7IGNhbi5vbmltcG9ydC5faW5pdChjYW4sIG1zZywgW10sIG51bGwsIGNhbi5fb3V0cHV0KSB9KSB9LAoJb250b2FzdDogZnVuY3Rpb24oY2FuLCBtc2cpIHsgY2FuLmNvcmUuQ2FsbEZ1bmMoY2FuLm9uaW1wb3J0LnRvYXN0LCB7Y2FuOiBjYW4sIG1zZzogbXNnfSkgfSwKCW9ucmVtb3RlOiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4uY29yZS5DYWxsRnVuYyhjYW4ub25pbXBvcnQubmNtZCwge2NhbjogY2FuLCBtc2c6IG1zZ30pIH0sCglvbmNvbW1hbmRmb2N1czogZnVuY3Rpb24oY2FuKSB7IAoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAiZGl2LmNtZCBpbnB1dCIsIGZ1bmN0aW9uKHRhcmdldCkgeyB0YXJnZXQuZm9jdXMoKSB9KQoJfSwKCglfY21kOiBmdW5jdGlvbihjYW4pIHsKCQlyZXR1cm4gY2FuLm9uYXBwZW5kLmZsb2F0KGNhbiwgY2FuLl9jbWRzLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgbGlzdCkgewoJCQl2YXIgY21kcyA9IGNhbi5iYXNlLk9iaihsaW5lLmNtZHMpOyBzd2l0Y2ggKGxpbmUuZm9sbG93KSB7CgkJCQljYXNlICJjaGF0LkFjdGlvbiI6IGNtZHMgPSBjbWRzLnNsaWNlKDIpOyBicmVhawoJCQkJY2FzZSAiY2hhdC5Gb290ZXIiOiBjbWRzID0gY21kcy5zbGljZSgyKTsgYnJlYWsKCQkJfQoJCQlzd2l0Y2ggKGNtZHNbMF0pIHsKCQkJCWNhc2UgIndlYi53aWtpLndvcmQiOiBjbWRzID0gY21kcy5zbGljZSg1KTsgYnJlYWsKCQkJfQoKCQkJY2FuLmdldCgiQWN0aW9uIiwgInNpemUiLCBmdW5jdGlvbihtc2csIHRvcCwgbGVmdCwgd2lkdGgsIGhlaWdodCkgewoJCQkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHtpbmRleDogY21kc1swXSwgYXJnczogY21kcy5zbGljZSgxKSwgaGVpZ2h0OiBoZWlnaHQtMTAwLCB3aWR0aDogd2lkdGh9LCBmdW5jdGlvbihzdWIpIHsKCQkJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZCwgY2IpIHsKCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIGNtZHNbMF1dLCBjbWQpLCBjYikKCQkJCQl9CgoJCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IHRvcCsxMDAsIGxlZnQ6IGxlZnR9fSkKCQkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBzdWIuX2xlZ2VuZCwge3N0eWxlOiB7ZGlzcGxheTogaHRtbC5CTE9DS319KQoJCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fb3V0cHV0LCB7c3R5bGU6IHsibWF4LXdpZHRoIjogd2lkdGh9fSkKCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgc3ViLl90YXJnZXQsIGNoYXQuRkxPQVQpCgkJCQl9LCBkb2N1bWVudC5ib2R5KQoJCQl9KQoJCX0pLmZpcnN0Cgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJaGVpZ2h0OiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5fdGFyZ2V0Lm9mZnNldEhlaWdodCB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGFuZWwvcml2ZXIuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfUklWRVIpID09ICJfc2hhcmUiKSB7IHJldHVybiBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbikgfQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4ucml2ZXJfbGlzdCA9IHt9LCBjYW4uc3Rvcm1fbGlzdCA9IHt9CgoJCWNhbi5vbmltcG9ydC5fbWFpbihjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5fbWVudShjYW4sIG1zZykKCQl2YXIgc2VsZWN0OyBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCXJldHVybiBjYW4ub25pbXBvcnQuX3JpdmVyKGNhbiwgaXRlbSwgZnVuY3Rpb24odGFyZ2V0KSB7CgkJCQkoaW5kZXggPT0gMCB8fCBpdGVtLmhhc2ggPT0gY2FuLl9tYWluX3JpdmVyKSAmJiAoc2VsZWN0ID0gdGFyZ2V0KQoJCQl9KQoJCX0pKSwgc2VsZWN0ICYmIHNlbGVjdC5jbGljaygpCgl9LAoJX21haW46IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGNhbi5fbWFpbl9yaXZlciA9ICJwcm9qZWN0IiwgY2FuLl9tYWluX3N0b3JtID0gInN0dWRpbyIKCQlpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsgdmFyIGFyZ3MgPSBWb2xjYW5vcy5tZXRhLmFyZ3MKCQkJY2FuLl9tYWluX3JpdmVyID0gYXJncy5yaXZlcnx8InByb2R1Y3QiLCBjYW4uX21haW5fc3Rvcm0gPSBhcmdzLnN0b3JtfHwiY2hyb21lIgoJCX0KCQlpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsgY2FuLl9tYWluX3JpdmVyID0gInByb2R1Y3QiLCBjYW4uX21haW5fc3Rvcm0gPSAib2ZmaWNlIiB9CgkJaWYgKGNhbi51c2VyLmlzV2VpWGluKSB7IGNhbi5fbWFpbl9yaXZlciA9ICJzZXJ2aWNlIiwgY2FuLl9tYWluX3N0b3JtID0gInd4IiB9CgoJCWNhbi5fbWFpbl90aXRsZSA9IGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuVElUTEUpfHxtc2cuT3B0aW9uKGljZS5NU0dfVElUTEUpfHxWb2xjYW5vcy5tZXRhLmFyZ3MudGl0bGV8fGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpfHxjYW4uX21haW5fdGl0bGUKCQljYW4uX21haW5fcml2ZXIgPSBjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LlJJVkVSKXx8bXNnLk9wdGlvbihpY2UuTVNHX1JJVkVSKXx8Vm9sY2Fub3MubWV0YS5hcmdzLnJpdmVyfHxjYW4uX21haW5fcml2ZXIKCQljYW4uX21haW5fc3Rvcm0gPSBjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LlNUT1JNKXx8bXNnLk9wdGlvbihpY2UuTVNHX1NUT1JNKXx8Vm9sY2Fub3MubWV0YS5hcmdzLnN0b3JtfHxjYW4uX21haW5fc3Rvcm0KCX0sCglfbWVudTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQlpZiAoY2FuLnVzZXIubW9kLmlzUG9kKSB7IHJldHVybiB9CgkJdmFyIGxpc3QgPSBbXQoJCWNhbi5zZXRIZWFkZXJNZW51KGxpc3QuY29uY2F0KGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKGNoYXQuTUVOVVMpLCBjYW4uQ29uZihjaGF0Lk1FTlVTKXx8Y2FuLm9uZGV0YWlsLl9tZW51cykpLCBmdW5jdGlvbihldmVudCwgYnV0dG9uKSB7CgkJCWNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25kZXRhaWwsIGJ1dHRvbl0sIFtldmVudCwgY2FuLCBidXR0b24sIGNhbi5Db25mKGNoYXQuUklWRVIpLCBjYW4uQ29uZihjaGF0LlNUT1JNKV0pCgkJfSkKCX0sCglfY2FydGU6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgcml2ZXIsIHN0b3JtKSB7IGlmIChjYW4udXNlci5pc01vYmlsZSkgeyByZXR1cm4gfQoJCWlmIChjYW4uY29yZS5WYWx1ZShjYW4uX3Jvb3QsIGNhbi5jb3JlLktleXMoY2hhdC5SSVZFUiwgcml2ZXIpKSkgeyByZXR1cm4gfQoKCQljYW4ub25hY3Rpb24uY2FydGUoZXZlbnQsIGNhbiwgbGlzdCwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbW9kdWxlKSB7CgkJCW1vZHVsZVtidXR0b25dKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKQoJCX0pCgl9LAoJX3JpdmVyOiBmdW5jdGlvbihjYW4sIG1ldGEsIGNiKSB7CgkJcmV0dXJuIHt0ZXh0OiBbbWV0YS5uYW1lLCBodG1sLkRJViwgaHRtbC5JVEVNXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uYWN0aW9uLnN0b3JtKGV2ZW50LCBjYW4sIG1ldGEuaGFzaCkKCgkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25pbXBvcnQuX2NhcnRlKGNhbiwgY2FuLm9uZGV0YWlsLmxpc3QsIG1ldGEuaGFzaCkKCgkJfSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgeyBjYih0YXJnZXQpCgkJCWNhbi5yaXZlcl9saXN0W21ldGEuaGFzaF0gPSB0YXJnZXQKCQl9fQoJfSwKCV9zdG9ybTogZnVuY3Rpb24oY2FuLCBtZXRhLCByaXZlcikgewoJCXJldHVybiB7dGV4dDogW21ldGEubmFtZSwgaHRtbC5ESVYsIGh0bWwuSVRFTV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmFjdGlvbi5hY3Rpb24oZXZlbnQsIGNhbiwgcml2ZXIsIG1ldGEuaGFzaCkKCQkJY2FuLnVzZXIudGl0bGUoY2FuLl9tYWluX3RpdGxlfHxtZXRhLm5hbWUpCgoJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uaW1wb3J0Ll9jYXJ0ZShjYW4sIGNhbi5vbmRldGFpbC5zdWJsaXN0LCByaXZlciwgbWV0YS5oYXNoKQoKCQl9LCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCWNhbi5zdG9ybV9saXN0W2Nhbi5jb3JlLktleXMocml2ZXIsIG1ldGEuaGFzaCldID0gdGFyZ2V0CgkJfX0KCX0sCgkiZGlzcGxheSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgc2hvdyA9IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX3RhcmdldCk7IGNhbi5vbmxheW91dC5faW5pdChjYW4pCgkJcmV0dXJuIHNob3cKCX0sCn0pClZvbGNhbm9zKCJvbmVuZ2luZSIsIHtoZWxwOiAi6Kej5p6Q5byV5pOOIiwgbGlzdDogW10sIF9lbmdpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1zZywgcGFuZWwsIGNtZHMsIGNiKSB7Cgl2YXIgbGlzdCA9IGNhbi5fcm9vdC5yaXZlcgoJY21kcy5sZW5ndGggPT0gMCAmJiBjYW4uY29yZS5JdGVtU29ydChsaXN0LCAib3JkZXIiLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJaWYgKGNhbi5jb3JlLkl0ZW0odmFsdWUuc3Rvcm0pLmxlbmd0aCA9PSAwKSB7IHJldHVybiB9CgkJbXNnLlB1c2goe2hhc2g6IGtleSwgbmFtZTogY2FuLnVzZXIubGFuZ3VhZ2UoY2FuKSA9PSAiZW4iPyBrZXk6IHZhbHVlLm5hbWV9KSAvLyDnvqTnu4TliJfooagKCX0pOyBpZiAoY21kcy5sZW5ndGggIT0gMSAmJiBjbWRzWzFdICE9IGNoYXQuU1RPUk0pIHsgcmV0dXJuIGZhbHNlIH0KCgl2YXIgcml2ZXIgPSBsaXN0W2NtZHNbMF1dOyBpZiAoIXJpdmVyKSB7IHJldHVybiBmYWxzZSB9CgljYW4uY29yZS5JdGVtU29ydChyaXZlci5zdG9ybSwgIm9yZGVyIiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewoJCW1zZy5QdXNoKHtoYXNoOiBrZXksIG5hbWU6IGNhbi51c2VyLmxhbmd1YWdlKGNhbikgPT0gImVuIj8ga2V5OiB2YWx1ZS5uYW1lfSkgLy8g5bqU55So5YiX6KGoCgl9KSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpOyByZXR1cm4gdHJ1ZQp9fSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY2IsIHRhcmdldCkgewoJCWlmIChjYW4udXNlci5tb2QuaXNXZWIpIHsKCgkJfSBlbHNlIGlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0gZWxzZSBpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0KQoJCX0KCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgl9LAoJb25sb2dpbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQljYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIGNhbi5Db25mKGN0eC5BQ1RJT04pfHxjYW4ub25hY3Rpb24ubGlzdCkKCQljYW4ucnVuKHt9LCBbXSwgZnVuY3Rpb24obXNnKSB7IGNhbi5vbmltcG9ydC5faW5pdChjYW4sIG1zZywgW10sIG51bGwsIGNhbi5fb3V0cHV0KSB9KQoJfSwKCW9uc2VhcmNoOiBmdW5jdGlvbihjYW4sIG1zZywgd29yZCkgewoJCWlmICh3b3JkWzBdID09IGNoYXQuU1RPUk0gfHwgd29yZFsxXSAhPSAiIikgeyBjYW4ub25leHBvcnQuc3Rvcm0oY2FuLCBtc2csIHdvcmQpIH0KCX0sCglvbnN0b3JtX3NlbGVjdDogZnVuY3Rpb24oY2FuLCBtc2csIHJpdmVyLCBzdG9ybSkgeyB2YXIgYXJncyA9IHtyaXZlcjogcml2ZXIsIHN0b3JtOiBzdG9ybX0KCQlpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24pIHsgbG9jYWxTdG9yYWdlLnNldEl0ZW0oY3R4LkFSR1MsIEpTT04uc3RyaW5naWZ5KGFyZ3MpKSB9Cgl9LAoJb25hY3Rpb25fdG91Y2g6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJY2FuLm9ubW90aW9uLmZsb2F0LmRlbChjYW4sIGNoYXQuQ0FSVEUpCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4pCgl9LAoJb25hY3Rpb25fbm90b29sOiBmdW5jdGlvbihjYW4sIG1zZywgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLm9uZGV0YWlsWyLmt7vliqDlt6XlhbciXShtc2cuX2V2ZW50LCBjYW4sICLmt7vliqDlt6XlhbciLCByaXZlciwgc3Rvcm0pCgl9LAoKCWNhcnRlOiBmdW5jdGlvbihldmVudCwgY2FuLCBsaXN0LCBjYikgewoJCWNhbi51c2VyLmNhcnRlUmlnaHQoZXZlbnQsIGNhbiwgY2FuLm9uZGV0YWlsLCBsaXN0LCBjYikKCX0sCglzdG9ybTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcml2ZXIpIHsgY2FuLnN1Ymxpc3QgPSBjYW4uc3VibGlzdHx8e30KCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYuaXRlbSIsIGNhbi5yaXZlcl9saXN0W3JpdmVyXSkKCQl2YXIgbGlzdCA9IGNhbi5zdWJsaXN0W3JpdmVyXTsgaWYgKGxpc3QpIHsgcmV0dXJuIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBsaXN0KSB9CgoJCWNhbi5ydW4oe30sIFtyaXZlciwgY2hhdC5TVE9STV0sIGZ1bmN0aW9uKG1zZykgewoJCQl2YXIgc2VsZWN0ID0gMDsgbGlzdCA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBbe3ZpZXc6IGh0bWwuTElTVCwgbGlzdDogbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCQlyaXZlciA9PSBjYW4uX21haW5fcml2ZXIgJiYgaXRlbS5oYXNoID09IGNhbi5fbWFpbl9zdG9ybSAmJiAoc2VsZWN0ID0gaW5kZXgpCgkJCQlyZXR1cm4gY2FuLm9uaW1wb3J0Ll9zdG9ybShjYW4sIGl0ZW0sIHJpdmVyKQoJCQl9KSB9XSkuZmlyc3QsIGxpc3QuY2hpbGRyZW4ubGVuZ3RoID4gMCAmJiBsaXN0LmNoaWxkcmVuW3NlbGVjdF0uY2xpY2soKQoKCQkJZXZlbnQudGFyZ2V0Lm5leHRTaWJsaW5nICYmIGNhbi5fb3V0cHV0Lmluc2VydEJlZm9yZShsaXN0LCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcpCgkJCWNhbi5zdWJsaXN0W3JpdmVyXSA9IGxpc3QKCQl9KQoJfSwKCWFjdGlvbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnN1Ymxpc3Rbcml2ZXJdLCB7c3R5bGU6IHtkaXNwbGF5OiBodG1sLkJMT0NLfX0pCgkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAiZGl2Lml0ZW0iLCBjYW4ucml2ZXJfbGlzdFtyaXZlcl0pCgkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAiZGl2Lmxpc3QgZGl2Lml0ZW0iLCBjYW4uc3Rvcm1fbGlzdFtjYW4uY29yZS5LZXlzKHJpdmVyLCBzdG9ybSldKQoKCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9uc3Rvcm1fc2VsZWN0IiwgY2FuLnJlcXVlc3QoZXZlbnQsIHsKCQkJcml2ZXI6IGNhbi5Db25mKGNoYXQuUklWRVIsIHJpdmVyKSwgc3Rvcm06IGNhbi5Db25mKGNoYXQuU1RPUk0sIHN0b3JtKSwKCQl9KSkKCX0sCgoJY3JlYXRlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIudHJhbnMoY2FuLCB7InB1YmxpYyI6ICLlhazlvIDnvqQiLCAicHJvdGVjdGVkIjogIuWGhemDqOe+pCIsICJwcml2YXRlIjogIuengeaciee+pCJ9KQoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFsKCQkJe25hbWU6IG1kYi5UWVBFLCB2YWx1ZXM6IFtjaGF0LlBVQkxJQywgY2hhdC5QUk9URUNURUQsIGNoYXQuUFJJVkFURV0sIF90cmFuczogIuexu+WeiyJ9LAoJCQl7bmFtZTogbWRiLk5BTUUsIHZhbHVlOiAiaGkiLCBfdHJhbnM6ICLnvqTlkI0ifSwge25hbWU6IG1kYi5URVhULCB2YWx1ZTogImhlbGxvIiwgX3RyYW5zOiAi566A5LuLIn0sCgkJXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbWV0YSwgbGlzdCwgYXJncykgewoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLkNSRUFURV0uY29uY2F0KGFyZ3MpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogbXNnLlJlc3VsdCgpfSkKCQkJfSkKCQl9KQoJfSwKCXJlZnJlc2g6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgYXJncyA9IHtyaXZlcjogY2FuLkNvbmYoY2hhdC5SSVZFUiksIHN0b3JtOiBjYW4uQ29uZihjaGF0LlNUT1JNKSwKCQkJdG9waWM6IGNhbi5nZXRIZWFkZXIoY2hhdC5UT1BJQyksIGxheW91dDogY2FuLmdldEFjdGlvbihjaGF0LkxBWU9VVCksCgkJfQoJCWlmIChjYW4udXNlci5pc0V4dGVuc2lvbikgeyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjdHguQVJHUywgSlNPTi5zdHJpbmdpZnkoYXJncykpIH0KCQljYW4ubWlzYy5TZWFyY2goY2FuLCBhcmdzKQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLoj5zljZXkuqTkupIiLAoJbGlzdDogWyLlhbHkuqvnvqTnu4QiLCAi5re75Yqg5bqU55SoIiwgIua3u+WKoOiuvuWkhyIsICLmt7vliqDnlKjmiLciLCAi6YeN5ZG95ZCN576k57uEIiwgIuWIoOmZpOe+pOe7hCJdLAoJc3VibGlzdDogWyLlhbHkuqvlupTnlKgiLCAi5re75Yqg5bel5YW3IiwgIuS/neWtmOWPguaVsCIsICLph43lkb3lkI3lupTnlKgiLCAi5Yig6Zmk5bqU55SoIl0sCglfbWVudXM6IFsKCQlbImNyZWF0ZSIsICLliJvlu7rnvqTnu4QiLCAi5re75Yqg5bqU55SoIiwgIua3u+WKoOW3peWFtyIsICLmt7vliqDorr7lpIciLCAi5Yib5bu656m66Ze0Il0sCgkJWyJzaGFyZSIsICLlhbHkuqvnvqTnu4QiLCAi5YWx5Lqr5bqU55SoIiwgIuWFseS6q+W3peWFtyIsICLkuIvovb3lupTnlKgiLCAi6K6/6Zeu56m66Ze0Il0sCgldLAoKCSLliJvlu7rnvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5jcmVhdGUoZXZlbnQsIGNhbikgfSwKCSLlhbHkuqvnvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLm9ubW90aW9uLnNoYXJlKGV2ZW50LCBjYW4sIFt7bmFtZTogY2hhdC5USVRMRSwgdmFsdWU6IHJpdmVyfV0sIFttZGIuVFlQRSwgY2hhdC5SSVZFUl0pCgl9LAoJIua3u+WKoOW6lOeUqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsgY2FuLm9uZGV0YWlsLmNyZWF0ZShldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB9LAoJIuWFseS6q+W6lOeUqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLm9ubW90aW9uLnNoYXJlKGV2ZW50LCBjYW4sIFt7bmFtZTogY2hhdC5USVRMRSwgdmFsdWU6IHN0b3JtfV0sIFttZGIuVFlQRSwgY2hhdC5TVE9STV0pCgl9LAoJIua3u+WKoOW3peWFtyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnVzZXIuc2VsZWN0KGV2ZW50LCBjYW4sIGN0eC5DT01NQU5ELCAiY29udGV4dCxjb21tYW5kIiwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQljYW4ucnVuKHt9LCBbcml2ZXIsIGNoYXQuU1RPUk0sIGN0eC5BQ1RJT04sIG1kYi5JTlNFUlQsIG1kYi5IQVNILCBzdG9ybV0uY29uY2F0KFtpY2UuUE9ELCAiIiwgaWNlLkNUWCwgaXRlbVswXSwgaWNlLkNNRCwgaXRlbVsxXV0pLCBmdW5jdGlvbihtc2cpIHsKCQkJCW5leHQoKQoJCQl9KQoJCX0sIGZ1bmN0aW9uKCkgewoJCQljYW4ubWlzYy5TZWFyY2goY2FuLCB7cml2ZXI6IHJpdmVyLCBzdG9ybTogc3Rvcm19KQoJCX0pCgl9LAoJIuWFseS6q+W3peWFtyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnVzZXIuc2VsZWN0KGV2ZW50LCBjYW4sIG1kYi5QTFVHSU4sICJuYW1lLGNvbnRleHQsY29tbWFuZCxhcmd1bWVudCIsIGZ1bmN0aW9uKGl0ZW0sIG5leHQpIHsKCQkJY2FuLnVzZXIuc2hhcmUoY2FuLCBjYW4ucmVxdWVzdChldmVudCksIFtyaXZlciwgY3R4LkFDVElPTiwgY2hhdC5TSEFSRSwgbWRiLlRZUEUsIGNoYXQuRklFTEQsCgkJCQltZGIuTkFNRSwgaXRlbVsyXSwgbWRiLlRFWFQsIGl0ZW1bM10sIGNoYXQuVElUTEUsIGl0ZW1bMF0sIGNoYXQuUklWRVIsIHJpdmVyLCBjaGF0LlNUT1JNLCBzdG9ybSwKCQkJXSkKCQl9KQoJfSwKCgki5re75Yqg6K6+5aSHIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlcikgewoJCWNhbi51c2VyLnNlbGVjdChldmVudCwgY2FuLCB3ZWIuU1BBQ0UsICJ0eXBlLG5hbWUsdGV4dCIsIGZ1bmN0aW9uKGl0ZW0sIG5leHQpIHsKCQkJY2FuLnJ1bih7fSwgW3JpdmVyLCBjaGF0Lk5PREUsIGN0eC5BQ1RJT04sIG1kYi5JTlNFUlQsIG1kYi5UWVBFLCBpdGVtWzBdLCBtZGIuTkFNRSwgaXRlbVsxXV0sIGZ1bmN0aW9uKG1zZykgewoJCQkJbmV4dCgpCgkJCX0pCgkJfSkKCX0sCgki5LiL6L295bqU55SoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgYWFhLklOVklURV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4udXNlci50b2FzdChjYW4sIHsKCQkJCXRpdGxlOiAi5LiL6L295bqU55SoIiwgZHVyYXRpb246IC0xLCB3aWR0aDogLTMwMCwKCQkJCWNvbnRlbnQ6IG1zZy5SZXN1bHQoKSwgYWN0aW9uOiBbY2xpLkNMT1NFXSwKCQkJfSkKCQl9KQoJfSwKCSLliJvlu7rnqbrpl7QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgeyBjYW4ucmVxdWVzdChldmVudCwge2FjdGlvbjogYnV0dG9ufSkKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6ICJuYW1lIiwgdmFsdWU6ICJoaSJ9LCB7bmFtZTogInJlcG9zIn0sIHtuYW1lOiAidGVtcGxhdGUifV0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLnJlcXVlc3QoZXZlbnQsIHtfdG9hc3Q6ICLliJvlu7rkuK0uLi4ifSkKCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGNsaS5TVEFSVF0uY29uY2F0KGFyZ3MsIGNoYXQuUklWRVIsIHJpdmVyKSwgZnVuY3Rpb24obXNnKSB7CgkJCQl2YXIgbGluayA9IGNhbi5taXNjLk1lcmdlVVJMKGNhbiwge19wYXRoOiAiL2NoYXQvcG9kLyIrY2FuLmNvcmUuS2V5cyhjYW4ubWlzYy5TZWFyY2goY2FuLCBpY2UuUE9EKSwgbXNnLk9wdGlvbihtZGIuTkFNRSkpfSkKCQkJCWNhbi51c2VyLnRvYXN0KGNhbiwgbGluayksIGNhbi51c2VyLm9wZW4obGluaykKCQkJfSkKCQl9KQoJfSwKCSLorr/pl67nqbrpl7QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgewoJCWNhbi51c2VyLnNlbGVjdCh7cml2ZXI6IHJpdmVyfSwgY2FuLCB3ZWIuU1BBQ0UsICJ0aW1lLHR5cGUsbmFtZSx0ZXh0IikKCX0sCgoKCSLmt7vliqDnlKjmiLciOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLnVzZXIuc2VsZWN0KGV2ZW50LCBjYW4sIGNoYXQuVVNFUiwgInVzZXJuaWNrLHVzZXJuYW1lIiwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQljYW4ucnVuKHt9LCBbcml2ZXIsIGNoYXQuVVNFUiwgY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgYWFhLlVTRVJOQU1FLCBpdGVtWzBdXSwgZnVuY3Rpb24obXNnKSB7CgkJCQluZXh0KCkKCQkJfSkKCQl9KQoJfSwKCSLph43lkb3lkI3nvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW21kYi5OQU1FXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbWV0YSwgbGlzdCkgewoJCQljYW4ucnVuKGNhbi5yZXF1ZXN0KGV2ZW50LCB7aGFzaDogcml2ZXJ9KS5fZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuTU9ESUZZLCBtZGIuTkFNRSwgbWV0YS5uYW1lXSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4ubWlzYy5TZWFyY2goY2FuLCB7cml2ZXI6IHJpdmVyfSkKCQkJfSkKCQl9KQoJfSwKCSLliKDpmaTnvqTnu4QiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLnJ1bihjYW4ucmVxdWVzdChldmVudCwge2hhc2g6IHJpdmVyfSkuX2V2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlJFTU9WRV0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ubWlzYy5TZWFyY2goY2FuLCB7fSkgfSkKCX0sCgoJIuS/neWtmOWPguaVsCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLmdldEFjdGlvbihjdHguQVJHUywgZnVuY3Rpb24oaXRlbSwgbmV4dCwgaW5kZXgsIGFycmF5KSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdCh7fSwge2hhc2g6IHN0b3JtLCBpZDogaXRlbS5kYXRhc2V0LmlkfSkKCQkJdmFyIHRvYXN0ID0gY2FuLnVzZXIudG9hc3QoY2FuLCAoaW5kZXgrMSkraWNlLlBTK2FycmF5Lmxlbmd0aCwgYnV0dG9uLCAxMDAwMCwgKGluZGV4KzEpKjEwMC9hcnJheS5sZW5ndGgpCgkJCWNhbi5ydW4obXNnLl9ldmVudCwgW3JpdmVyLCBjaGF0LlNUT1JNLCBjdHguQUNUSU9OLCBtZGIuTU9ESUZZLCBpY2UuQVJHLCBpdGVtLmRhdGFzZXQuYXJnc10sIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLmNvcmUuVGltZXIoMjAwLCBmdW5jdGlvbigpIHsKCQkJCQl0b2FzdC5jbG9zZSgpLCBuZXh0KCksIGluZGV4ID09IGFycmF5Lmxlbmd0aC0xICYmIGNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4sIGJ1dHRvbikKCQkJCX0pCgkJCX0pCgkJfSkKCX0sCgki6YeN5ZG95ZCN5bqU55SoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbWRiLk5BTUVdLCBmdW5jdGlvbihldiwgYnV0dG9uLCBtZXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5ydW4oY2FuLnJlcXVlc3QoZXZlbnQsIHtoYXNoOiBzdG9ybX0pLl9ldmVudCwgW3JpdmVyLCBjaGF0LlNUT1JNLCBjdHguQUNUSU9OLCBtZGIuTU9ESUZZXS5jb25jYXQoYXJncyksIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLm1pc2MuU2VhcmNoKGNhbiwge3JpdmVyOiByaXZlciwgc3Rvcm06IHN0b3JtfSkKCQkJfSkKCQl9KQoJfSwKCSLliKDpmaTlupTnlKgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgewoJCWNhbi5ydW4oY2FuLnJlcXVlc3QoZXZlbnQsIHtoYXNoOiBzdG9ybX0pLl9ldmVudCwgW3JpdmVyLCBjaGF0LlNUT1JNLCBjdHguQUNUSU9OLCBtZGIuUkVNT1ZFXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogcml2ZXJ9KQoJCX0pCgl9LAoKCgljcmVhdGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsKCQljYW4udXNlci50cmFucyhjYW4sIHsicHVibGljIjogIuWFrOW8gOW6lOeUqCIsICJwcm90ZWN0ZWQiOiAi576k57uE5bqU55SoIiwgInByaXZhdGUiOiAi5Liq5Lq65bqU55SoIn0pCgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgWwoJCQl7bmFtZTogbWRiLlRZUEUsIHZhbHVlczogW2NoYXQuUFVCTElDLCBjaGF0LlBST1RFQ1RFRCwgY2hhdC5QUklWQVRFXSwgX3RyYW5zOiAi57G75Z6LIn0sCgkJCXtuYW1lOiBtZGIuTkFNRSwgdmFsdWU6ICJoaSIsIF90cmFuczogIuWQjeensCJ9LCB7bmFtZTogbWRiLlRFWFQsIHZhbHVlOiAiaGVsbG8iLCBfdHJhbnM6ICLnroDku4sifSwKCQldLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBtZXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5ydW4oe30sIFtyaXZlciwgY2hhdC5TVE9STSwgY3R4LkFDVElPTiwgbWRiLkNSRUFURV0uY29uY2F0KGFyZ3MpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogcml2ZXIsIHN0b3JtOiBtc2cuUmVzdWx0KCl9KQoJCQl9KQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJd2lkdGg6IGZ1bmN0aW9uKGNhbikgeyByZXR1cm4gY2FuLl90YXJnZXQub2Zmc2V0V2lkdGggfSwKCXN0b3JtOiBmdW5jdGlvbihjYW4sIG1zZywgd29yZCkgewoJCXZhciBmaWVsZHMgPSAobXNnLk9wdGlvbihpY2UuTVNHX0ZJRUxEUyl8fCJjdHgsY21kLHR5cGUsbmFtZSx0ZXh0Iikuc3BsaXQoIiwiKQoJCWNhbi5jb3JlLkl0ZW0oY2FuLl9yb290LnJpdmVyLCBmdW5jdGlvbihyaXZlciwgdmFsdWUpIHsKCQkJY2FuLmNvcmUuSXRlbSh2YWx1ZS5zdG9ybSwgZnVuY3Rpb24oc3Rvcm0sIGl0ZW0pIHsKCQkJCWlmICh3b3JkWzFdICE9ICIiICYmIHdvcmRbMV0gIT0gc3Rvcm0gJiYgd29yZFsxXSAhPSBpdGVtLm5hbWUpIHsgcmV0dXJuIH0KCgkJCQl2YXIgZGF0YSA9IHtjdHg6ICJ3ZWIuY2hhdCIsIGNtZDogY2hhdC5TVE9STSwKCQkJCQl0eXBlOiByaXZlciwgbmFtZTogc3Rvcm0sIHRleHQ6IHNoeSgi6Lez6L2sIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJY2FuLm9uYWN0aW9uLmFjdGlvbihldmVudCwgY2FuLCByaXZlciwgc3Rvcm0pCgkJCQkJfSksCgkJCQl9OyBjYW4uY29yZS5MaXN0KGZpZWxkcywgZnVuY3Rpb24oa2V5KSB7IG1zZy5QdXNoKGtleSwgZGF0YVtrZXldfHwiIikgfSkKCQkJfSkKCQl9KQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jb2RlL3ZpbWVyLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCQljYW4ucmVxdWlyZShbImlubmVyLmpzIl0sIGZ1bmN0aW9uKGNhbikgeyBjYW4ub25pbXBvcnQuaW5uZXJfaW5pdChjYW4sIG1zZywgZnVuY3Rpb24oKSB7IGNhbi51bmRvID0gW10sIGNhbi5yZWRvID0gW10KCQkJY2FuLm9ua2V5bWFwLl9idWlsZChjYW4pLCBjYW4ub25pbXBvcnQuX2lucHV0KGNhbiksIGNhbi5vbmtleW1hcC5fcGx1Z2luKHt9LCBjYW4pLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCgkJfSwgdGFyZ2V0KSB9LCBmdW5jdGlvbihjYW4sIG5hbWUsIHN1YikgeyBuYW1lID09IGNoYXQuT05JTVBPUlQgJiYgKGNhbi5vbmltcG9ydC5pbm5lcl9pbml0ID0gc3ViLl9pbml0KQoJCQlpZiAobmFtZSA9PSBjaGF0Lk9OQUNUSU9OKSB7IGNhbi5fdHJhbnMgPSBjYW4uYmFzZS5Db3B5KGNhbi5fdHJhbnN8fHt9LCBzdWIuX3RyYW5zKSB9CgkJCWlmIChuYW1lID09IGNoYXQuT05LRVlNQVApIHsgY2FuLmJhc2UuQ29weShjYW4ub25rZXltYXAuX21vZGUsIHN1Yi5fbW9kZSkKCQkJCWNhbi5jb3JlLkl0ZW0oY2FuLm9ua2V5bWFwLl9tb2RlLm5vcm1hbCwgZnVuY3Rpb24oaywgdikgeyBzdWIuX21vZGUucGx1Z2luW2tdIHx8IChzdWIuX21vZGUucGx1Z2luW2tdID0gdikgfSkKCQkJCWNhbi5jb3JlLkl0ZW0oc3ViLl9tb2RlLnBsdWdpbiwgZnVuY3Rpb24oaywgdikgeyBjYW4ub25rZXltYXAuX21vZGUubm9ybWFsW2tdIHx8IChjYW4ub25rZXltYXAuX21vZGUubm9ybWFsW2tdID0gdikgfSkKCQkJfQoJCX0pCgl9LAoJX2lucHV0OiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkuY29udGVudC5wYXJlbnROb2RlLCBbCgkJCXt2aWV3OiBbImN1cnJlbnQiLCBodG1sLklOUFVUXSwgc3BlbGxjaGVjazogZmFsc2UsIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsgaWYgKGV2ZW50Lm1ldGFLZXkpIHsgcmV0dXJuIH0KCQkJCWlmIChldmVudC5jdHJsS2V5ICYmIGNhbi5vbmFjdGlvbi5fY29tcGxldGUoZXZlbnQsIGNhbikpIHsgcmV0dXJuIH0KCQkJCWNhbi5fa2V5bGlzdCA9IGNhbi5vbmtleW1hcC5fcGFyc2UoZXZlbnQsIGNhbiwgY2FuLm1vZGUrKGV2ZW50LmN0cmxLZXk/ICJfY3RybCI6ICIiKSwgY2FuLl9rZXlsaXN0LCBjYW4udWkuY3VycmVudCkKCQkJCWNhbi5tb2RlID09ICJpbnNlcnQiICYmIGNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSkgfSkKCQkJCWNhbi5tb2RlID09ICJub3JtYWwiICYmIGNhbi5TdGF0dXMoIuaMiemUriIsIGNhbi5fa2V5bGlzdC5qb2luKCIiKSkKCQkJCWNhbi5tb2RlID09ICJub3JtYWwiICYmIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9LCBvbmtleXVwOiBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb24uX2NvbXBsZXRlKGV2ZW50LCBjYW4pCgoJCQl9LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKQoKCQkJfX0sIHt2aWV3OiBbImNvbXBsZXRlIl19LAoJCV0pOyBjYW4udWkuY3VycmVudCA9IHVpLmN1cnJlbnQsIGNhbi51aS5jb21wbGV0ZSA9IHVpLmNvbXBsZXRlCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIumUruebmOS6pOS6kiIsIGxpc3Q6IFtdLAoJX21vZGVsOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7IGNhbi5TdGF0dXMoIuaooeW8jyIsIGNhbi5tb2RlID0gdmFsdWUpCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmN1cnJlbnQsIHtjbGFzc05hbWU6IFsiY3VycmVudCIsIGNhbi5tb2RlXX0pLCB2YWx1ZQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5jb21wbGV0ZSwge2NsYXNzTmFtZTogWyJjb21wbGV0ZSIsIGNhbi5tb2RlXX0pLCB2YWx1ZQoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ua2V5bWFwLl9tb2RlbChjYW4sICJwbHVnaW4iKQoJCWNhbi51aS5jdXJyZW50LmJsdXIoKQoJfSwKCV9ub3JtYWw6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ua2V5bWFwLl9tb2RlbChjYW4sICJub3JtYWwiKQoJCWNhbi51aS5jdXJyZW50LmZvY3VzKCkKCX0sCglfaW5zZXJ0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fbW9kZWwoY2FuLCAiaW5zZXJ0IikKCQljYW4udWkuY3VycmVudC5mb2N1cygpLCBjYW4udWkuY29udGVudC5zY3JvbGxMZWZ0IC09IDEwMDAwCgkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJLy8gY2FuLl9rZXlsaXN0ID0gW10KCX0sCgoJX21vZGU6IHsKCQlub3JtYWxfY3RybDogewoJCQlmOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSB7CgkJCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4pK2Nhbi5jdXJyZW50LndpbmRvdygpLTMtY2FuLmN1cnJlbnQuc2Nyb2xsKCkKCQkJCXJldHVybiBjYW4uY3VycmVudC5zY3JvbGwobGluZSksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUpLCB0cnVlCgkJCX0sCgkJCWI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsKCQkJCXZhciBsaW5lID0gY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiktY2FuLmN1cnJlbnQud2luZG93KCkrMwoJCQkJcmV0dXJuIGNhbi5jdXJyZW50LnNjcm9sbChsaW5lKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgbGluZSksIHRydWUKCQkJfSwKCQl9LAoJCW5vcm1hbDogewoJCQllc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ua2V5bWFwLl9wbHVnaW4oZXZlbnQsIGNhbikgfSwKCQkJQXJyb3dMZWZ0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIC0xKSB9LAoJCQlBcnJvd1JpZ2h0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIDEpIH0sCgkJCUFycm93RG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4uY3VycmVudC5uZXh0KCkpIH0sCgkJCUFycm93VXA6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQucHJldigpKSB9LAoKCQkJIi4iOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdmFyIGNiID0gY2FuLnJlZG8ucG9wKCk7IGNiICYmIGNiKCkgfSwKCQkJdTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHZhciBjYiA9IGNhbi51bmRvLnBvcCgpOyBjYiAmJiBjYigpIH0sCgkJCUo6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgewoJCQkJdmFyIG5leHQgPSBjYW4uY3VycmVudC5uZXh0KCk7IGlmICghbmV4dCkgeyByZXR1cm4gfQoJCQkJdmFyIGxpbmUgPSBjYW4uY3VycmVudC5saW5lLCB0ZXh0ID0gY2FuLmN1cnJlbnQudGV4dCgpCgkJCQl2YXIgcmVzdCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIG5leHQsICJ0ZC50ZXh0IilbMF0uaW5uZXJUZXh0CgkJCQljYW4uY3VycmVudC50ZXh0KHRleHQudHJpbVJpZ2h0KCkraWNlLlNQK3Jlc3QudHJpbUxlZnQoKSksIGNhbi5vbmFjdGlvbi5kZWxldGVMaW5lKGNhbiwgbmV4dCkKCQkJCWNhbi51bmRvLnB1c2goZnVuY3Rpb24oKSB7IGNhbi5vbmFjdGlvbi5tb2RpZnlMaW5lKGNhbiwgbGluZSwgdGV4dCksIGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgcmVzdCwgbGluZS5uZXh0U2libGluZykgfSkKCQkJfSwKCQkJSDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAwLCAwKSB9LAoJCQloOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIC0xKSB9LAoJCQlsOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIDEpIH0sCgkJCUw6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIHRhcmdldCwgMCwgLTEpIH0sCgkJCWo6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQubmV4dCgpKSB9LAoJCQlrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5jdXJyZW50LnByZXYoKSkgfSwKCgkJCWdnOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSB7IHJldHVybiBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjb3VudCksIHRydWUgfSwKCQkJRzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyByZXR1cm4gY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY291bnQgPSBjb3VudD4xPyBjb3VudDogY2FuLm1heCksIHRydWUgfSwKCQkJenQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgcmV0dXJuIGNhbi5jdXJyZW50LnNjcm9sbChjYW4uY3VycmVudC5zY3JvbGwoKS0oY291bnQ+MT8gY291bnQ6IDMpKSwgdHJ1ZSB9LAoJCQl6ejogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyByZXR1cm4gY2FuLmN1cnJlbnQuc2Nyb2xsKGNhbi5jdXJyZW50LnNjcm9sbCgpLShjb3VudCA9IGNvdW50PjE/IGNvdW50OiBjYW4uY3VycmVudC53aW5kb3coKS8yKSksIHRydWUgfSwKCQkJemI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgcmV0dXJuIGNhbi5jdXJyZW50LnNjcm9sbChjYW4uY3VycmVudC5zY3JvbGwoKS1jYW4uY3VycmVudC53aW5kb3coKSsoY291bnQ+MT8gY291bnQ6IDUpKSwgdHJ1ZSB9LAoKCQkJaTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSB9LAoJCQlJOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAwLCAwKSB9LAoJCQlhOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAxKSB9LAoJCQlBOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAwLCAtMSkgfSwKCQkJbzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKQoJCQkJdGV4dCA9IHRleHQuc3Vic3RyKDAsIHRleHQuaW5kZXhPZih0ZXh0LnRyaW1MZWZ0KCkpKSsodGV4dC5lbmRzV2l0aCgieyIpPyJcdCI6IiIpCgkJCQljYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCB0ZXh0LCBjYW4uY3VycmVudC5uZXh0KCkpKQoJCQkJY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCBjYW4udWkuY3VycmVudCwgMTAwMCkKCQkJfSwKCQkJTzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKQoJCQkJdGV4dCA9IHRleHQuc3Vic3RyKDAsIHRleHQuaW5kZXhPZih0ZXh0LnRyaW1MZWZ0KCkpKSsodGV4dC5lbmRzV2l0aCgifSIpPyJcdCI6IiIpCgkJCQljYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCB0ZXh0LCBjYW4uY3VycmVudC5saW5lKSkKCQkJCWNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgY2FuLnVpLmN1cnJlbnQsIDEwMDApCgkJCX0sCgoJCQl5eTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyBjYW4uX2xhc3RfdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKSB9LAoJCQlkZDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyB2YXIgdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKSwgbGluZSA9IGNhbi5vbmFjdGlvbi5fZ2V0TGluZW5vKGNhbiwgY2FuLmN1cnJlbnQubGluZSkKCQkJCWNhbi5fbGFzdF90ZXh0ID0gY2FuLmN1cnJlbnQudGV4dCgpLCBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4ub25hY3Rpb24uZGVsZXRlTGluZShjYW4sIGNhbi5jdXJyZW50LmxpbmUpKQoJCQkJY2FuLnVuZG8ucHVzaChmdW5jdGlvbigpIHsgY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCB0ZXh0LCBsaW5lKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgbGluZSkgfSkKCQkJCXZhciBjYWxsZWUgPSBhcmd1bWVudHMuY2FsbGVlCgkJCQljYW4ucmVkby5wdXNoKGZ1bmN0aW9uKCkgeyBjYWxsZWUoZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgfSkKCQkJfSwKCQkJcDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJdmFyIGxpbmUgPSBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGNhbi5fbGFzdF90ZXh0LCBjYW4uY3VycmVudC5uZXh0KCkpCgkJCQljYW4udW5kby5wdXNoKGZ1bmN0aW9uKCkgeyBjYW4ub25hY3Rpb24uZGVsZXRlTGluZShjYW4sIGxpbmUpLCBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBsaW5lLTEpIH0pCgkJCX0sCgkJCVA6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCXZhciBsaW5lID0gY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCBjYW4uX2xhc3RfdGV4dCwgY2FuLmN1cnJlbnQubGluZSkKCQkJCWNhbi51bmRvLnB1c2goZnVuY3Rpb24oKSB7IGNhbi5vbmFjdGlvbi5kZWxldGVMaW5lKGNhbiwgbGluZSksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUrMSkgfSkKCQkJfSwKCgkJCXM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLnNhdmUoZXZlbnQsIGNhbikgfSwKCQkJbTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uYXV0b2dlbihldmVudCwgY2FuLCAiYXV0b2dlbiIpIH0sCgkJCWM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLmNvbXBpbGUoZXZlbnQsIGNhbiwgImNvbXBpbGUiKSB9LAoJCX0sCgkJaW5zZXJ0OiB7CgkJCWprOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLl9ub3JtYWwoZXZlbnQsIGNhbikKCQkJCWNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0LTEsIDEpCgkJCQljYW4uY3VycmVudC50ZXh0KGNhbi51aS5jdXJyZW50LnZhbHVlKQoJCQl9LAoJCQlFc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkVzY2FwZSIpIHsgcmV0dXJuIH0KCQkJCWNhbi5vbmtleW1hcC5fbm9ybWFsKGV2ZW50LCBjYW4pCgkJCX0sCgkJCVRhYjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJaWYgKGV2ZW50LmtleSAhPSAiVGFiIikgeyByZXR1cm4gfQoJCQkJY2FuLm9ua2V5bWFwLmluc2VydFRleHQoY2FuLnVpLmN1cnJlbnQsICJcdCIpCgkJCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQkJfSwKCgkJCUVudGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkVudGVyIikgeyByZXR1cm4gfQoJCQkJdmFyIHJlc3QgPSBjYW4ub25rZXltYXAuZGVsZXRlVGV4dCh0YXJnZXQsIHRhcmdldC5zZWxlY3Rpb25FbmQpLCB0ZXh0ID0gY2FuLnVpLmN1cnJlbnQudmFsdWUKCQkJCXZhciBsZWZ0ID0gdGV4dC5zdWJzdHIoMCwgdGV4dC5pbmRleE9mKHRleHQudHJpbUxlZnQoKSkpfHwodGV4dC50cmltUmlnaHQoKSA9PSAiIj8gdGV4dDogIiIpCgkJCQlpZiAodGV4dC5lbmRzV2l0aCgieyIpKSB7IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCsifSIsIGNhbi5jdXJyZW50Lm5leHQoKSksIGxlZnQgKz0gIlx0IiB9CgkJCQlpZiAodGV4dC5lbmRzV2l0aCgiWyIpKSB7IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCsiXSIsIGNhbi5jdXJyZW50Lm5leHQoKSksIGxlZnQgKz0gIlx0IiB9CgkJCQlpZiAodGV4dC5lbmRzV2l0aCgiKCIpKSB7IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCsiKSIsIGNhbi5jdXJyZW50Lm5leHQoKSksIGxlZnQgKz0gIlx0IiB9CgkJCQlpZiAodGV4dC5lbmRzV2l0aCgiYCIpICYmIGNhbi5iYXNlLmNvdW50KHRleHQsICJgIiklMj09MSkgeyBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGxlZnQrImAiLCBjYW4uY3VycmVudC5uZXh0KCkpIH0KCgkJCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgbGVmdCtyZXN0LnRyaW1MZWZ0KCksIGNhbi5jdXJyZW50Lm5leHQoKSkKCQkJCWNhbi5jdXJyZW50LnRleHQodGV4dC50cmltUmlnaHQoKXx8dGV4dCksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUpCgkJCQljYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIGNhbi51aS5jdXJyZW50LCBsZWZ0Lmxlbmd0aCwgMCkKCQkJfSwKCQkJQmFja3NwYWNlOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkJhY2tzcGFjZSIpIHsgcmV0dXJuIH0KCQkJCWlmICh0YXJnZXQuc2VsZWN0aW9uU3RhcnQgPiAwKSB7IHJldHVybiB9CgkJCQlpZiAoIWNhbi5jdXJyZW50LnByZXYoKSkgeyByZXR1cm4gfQoJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgoJCQkJdmFyIHJlc3QgPSBjYW4uY3VycmVudC50ZXh0KCkKCQkJCWNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5jdXJyZW50LnByZXYoKSkKCQkJCWNhbi5vbmFjdGlvbi5kZWxldGVMaW5lKGNhbiwgY2FuLmN1cnJlbnQubmV4dCgpKQoJCQkJdmFyIHBvcyA9IGNhbi5jdXJyZW50LnRleHQoKS5sZW5ndGgKCgkJCQljYW4udWkuY3VycmVudC52YWx1ZSA9IGNhbi5jdXJyZW50LnRleHQoKStyZXN0CgkJCQljYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIGNhbi51aS5jdXJyZW50LCAwLCBwb3MpCgkJCX0sCgkJCUFycm93VXA6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkFycm93VXAiKSB7IHJldHVybiB9CgkJCQljYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4uY3VycmVudC5wcmV2KCkpCgkJCX0sCgkJCUFycm93RG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQkJaWYgKGV2ZW50LmtleSAhPSAiQXJyb3dEb3duIikgeyByZXR1cm4gfQoJCQkJY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQubmV4dCgpKQoJCQl9LAoJCX0sCgl9LCBfZW5naW5lOiB7fSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbbmZzLlNBVkUsIGNvZGUuQVVUT0dFTiwgY29kZS5DT01QSUxFLCBuZnMuU0NSSVBULCBjaGF0LldFQlNJVEUsIHdlYi5EUkVBTSwgY29kZS5QVUJMSVNIXSwKCV9ydW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgYXJncywgY2IpIHsKCQljYW4ucnVuQWN0aW9uKGV2ZW50LCBidXR0b24sIGFyZ3MsIGNifHxmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgbXNnLk9wdGlvbihuZnMuRklMRSkpCgkJCWNhbi5vbmltcG9ydC5wcm9qZWN0KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCkpLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuLCBidXR0b24pCgkJfSkKCX0sCglfcnVuczogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKTsgY2FuLnJlcXVlc3QoZXZlbnQsIHthY3Rpb246IGJ1dHRvbn0pCgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgbWV0YS5mZWF0dXJlW2J1dHRvbl0sIGZ1bmN0aW9uKGV2LCBidG4sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLm9uYWN0aW9uLl9ydW4oZXZlbnQsIGNhbiwgYnV0dG9uLCBhcmdzKQoJCX0pCgl9LAoJc2F2ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5yZXF1ZXN0KGV2ZW50LCB7ZmlsZTogY2FuLk9wdGlvbihuZnMuRklMRSksIGNvbnRlbnQ6IGNhbi5vbmV4cG9ydC5jb250ZW50KGNhbil9KQoJCWNhbi5ydW5BY3Rpb24oZXZlbnQsIG5mcy5TQVZFLCBbY2FuLnBhcnNlLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuUEFUSCldLCBmdW5jdGlvbigpIHsKCQkJY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbiwgYnV0dG9uKQoJCX0pCgl9LAoJYXV0b2dlbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5vbmFjdGlvbi5fcnVucyhldmVudCwgY2FuLCBidXR0b24pIH0sCgljb21waWxlOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgdmFyIHRvYXN0MCA9IGNhbi51c2VyLnRvYXN0UHJvY2VzcyhjYW4sICLnvJbor5HkuK0uLi4iKQoJCWNhbi5ydW5BY3Rpb24oZXZlbnQsIGJ1dHRvbiwgW10sIGZ1bmN0aW9uKG1zZykgeyB0b2FzdDAuY2xvc2UoKQoJCQlpZiAobXNnLkxlbmd0aCgpID09IDApIHsgdmFyIHRvYXN0MSA9IGNhbi51c2VyLnRvYXN0UHJvY2VzcyhjYW4sICLph43lkK/kuK0uLi4iKQoJCQkJY2FuLmNvcmUuVGltZXIoMzAwMCwgZnVuY3Rpb24oKSB7IHRvYXN0MS5jbG9zZSgpLCBjYW4ub25hY3Rpb25bIuWxleekuiJdKHt9LCBjYW4pIH0pCgkJCX0gZWxzZSB7IGNhbi51aS5zZWFyY2guX3Nob3cobXNnKSB9CgkJfSkKCX0sCglzY3JpcHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoJCWNhbi5yZXF1ZXN0KGV2ZW50LCB7ZmlsZTogImhpL2hpLmpzIn0pCgkJY2FuLm9uYWN0aW9uLl9ydW5zKGV2ZW50LCBjYW4sIGJ1dHRvbikKCX0sCgl3ZWJzaXRlOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQljYW4ucmVxdWVzdChldmVudCwge2ZpbGU6ICJoaS56bWwifSkKCQljYW4ub25hY3Rpb24uX3J1bnMoZXZlbnQsIGNhbiwgYnV0dG9uKQoJfSwKCXB1Ymxpc2g6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoJCWNhbi5ydW5BY3Rpb24oZXZlbnQsIGJ1dHRvbiwgW10sIGZ1bmN0aW9uKG1zZykgeyBjYW4udXNlci50b2FzdENvbmZpcm0oY2FuLCBidXR0b24sIG1zZy5SZXN1bHQoKSkgfSkKCX0sCgoJbGlzdFRhZ3M6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyB2YXIgbGlzdCA9IFtdCgkJY2FuLmNvcmUuSXRlbShjYW4ucmVxdWVzdChldmVudCksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgaWYgKGtleS5pbmRleE9mKCJfIikgPT0gMCkgeyByZXR1cm4gfQoJCQlsaXN0LnB1c2goe3pvbmU6ICJtc2ciLCB0eXBlOiB0eXBlb2YgdmFsdWUsIG5hbWU6IGtleSwgdGV4dDogY2FuLmJhc2UuaXNPYmplY3QodmFsdWUpPyAiIjogKHZhbHVlKyIiKS5zcGxpdChpY2UuTkwpWzBdLAoJCQkJcGF0aDogInVzci92b2xjYW5vcy8iLCBmaWxlOiAibGliL21pc2MuanMiLCBsaW5lOiAxLAoJCQl9KQoJCX0pCgkJY2FuLmNvcmUuTGlzdChbY2FuLmJhc2UsIGNhbi5jb3JlLCBjYW4ubWlzYywgY2FuLnBhZ2UsIGNhbi51c2VyLCBjYW4ub25lbmdpbmUsIGNhbi5vbmRhZW1vbiwgY2FuLm9uYXBwZW5kLCBjYW4ub25sYXlvdXQsIGNhbi5vbm1vdGlvbiwgY2FuLm9ua2V5bWFwXSwgZnVuY3Rpb24obGliKSB7CgkJCWNhbi5jb3JlLkl0ZW0obGliLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGlmIChrZXkuaW5kZXhPZigiXyIpID09IDAgfHwgIWxpYi5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7IHJldHVybiB9CgkJCQlsaXN0LnB1c2goe3pvbmU6IGxpYi5fbmFtZSwgdHlwZTogdHlwZW9mIHZhbHVlLCBuYW1lOiBrZXksIHRleHQ6IGNhbi5iYXNlLmlzT2JqZWN0KHZhbHVlKT8gIiI6ICh2YWx1ZSsiIikuc3BsaXQoaWNlLk5MKVswXSwKCQkJCQlwYXRoOiAidXNyL3ZvbGNhbm9zLyIsIGZpbGU6IGxpYi5fcGF0aCwgbGluZTogMSwKCQkJCX0pCgkJCX0pCgkJfSkKCQljYW4ucmVxdWVzdChldmVudCwge3RleHQ6IGNhbi5iYXNlLkZvcm1hdChsaXN0KX0pCgkJY2FuLnJ1bkFjdGlvbihldmVudCwgYnV0dG9uKQoJfSwKCV9jb21wbGV0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLnVpLmNvbXBsZXRlCgkJaWYgKGV2ZW50ID09IHVuZGVmaW5lZCkgeyByZXR1cm4gfQoJCXZhciBwcmUgPSBjYW4udWkuY3VycmVudC52YWx1ZS5zbGljZSgwLCBjYW4udWkuY3VycmVudC5zZWxlY3Rpb25TdGFydCkKCQl2YXIgZW5kID0gY2FuLnVpLmN1cnJlbnQudmFsdWUuc2xpY2UoY2FuLnVpLmN1cnJlbnQuc2VsZWN0aW9uU3RhcnQpCgkJdmFyIHR5cGUgPSBjYW4uY29yZS5TcGxpdChwcmUpLnBvcCgpfHwiIgoJCXZhciBuYW1lID0gY2FuLmNvcmUuU3BsaXQodHlwZSwgIiIsIGljZS5QVCkucG9wKCl8fCIiCgkJdHlwZSA9IGNhbi5iYXNlLnRyaW1TdWZmaXgodHlwZSwgbmFtZSkKCQl0eXBlID0gY2FuLmJhc2UudHJpbVN1ZmZpeCh0eXBlLCBpY2UuUFQpCgkJY29uc3QgUFJFID0gInByZSIKCgkJZnVuY3Rpb24gdXBkYXRlKHRhcmdldCkgeyBjYW4ucmVxdWVzdChldmVudCwge3R5cGU6IHR5cGUsIG5hbWU6IG5hbWUsIHRleHQ6IHByZSwgZmlsZTogY2FuLk9wdGlvbihuZnMuRklMRSl9KQoJCQljYW4ucnVuQWN0aW9uKGV2ZW50LCAiY29tcGxldGUiLCBbXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51aS5jb21wbGV0ZS5fbXNnID0gbXNnCgkJCQlpZiAobXNnLkxlbmd0aCgpID09IDAgJiYgY2FuLmJhc2UuRXh0KGNhbi5PcHRpb24obmZzLkZJTEUpKSA9PSBuZnMuSlMpIHsKCQkJCQltc2cubmFtZSA9IFtdLCBtc2cudHlwZSA9IFtdLCBtc2cudGV4dCA9IFtdCgkJCQkJY2FuLmNvcmUuSXRlbShjYW4uY29yZS5WYWx1ZSh3aW5kb3csIHR5cGUpLCBmdW5jdGlvbihrLCB2KSB7CgkJCQkJCW1zZy5QdXNoKG1kYi5OQU1FLCBrKSwgbXNnLlB1c2gobWRiLlRZUEUsIHR5cGVvZiB2KQoJCQkJCQl0cnkgeyBtc2cuUHVzaChtZGIuVEVYVCwgdikgfSBjYXRjaCAoZSkgeyBtc2cuUHVzaChtZGIuVEVYVCwgIiIpIH0KCQkJCQl9KQoJCQkJCW1zZy5hcHBlbmQgPSBbbWRiLk5BTUUsIG1kYi5UWVBFLCBtZGIuVEVYVF0KCQkJCX0KCQkJCW1zZy5MZW5ndGgoKSA9PSAwICYmIHByZS50cmltKCkgPT0gIiIgJiYgY2FuLmNvcmUuSXRlbShjYW4uY29yZS5WYWx1ZShjYW4ub25zeW50YXhbY2FuLnBhcnNlXSwgY29kZS5LRVlXT1JEKSwgZnVuY3Rpb24oaykgewoJCQkJCW1zZy5QdXNoKG1kYi5OQU1FLCBrKQoJCQkJfSkKCQkJCQoJCQkJY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIHRhcmdldCwgW3t2aWV3OiBbUFJFLCBodG1sLkRJViwgcHJlXX1dKQoJCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCkgeyByZXR1cm4ge3RleHQ6IFt2YWx1ZSwgaHRtbC5URF0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJdmFyIGxlZnQgPSBjYW4udWkuY3VycmVudC52YWx1ZS5zbGljZSgwLCBjYW4udWkuY3VycmVudC5zZWxlY3Rpb25TdGFydCkrdmFsdWUKCQkJCQljYW4uY3VycmVudC50ZXh0KGNhbi51aS5jdXJyZW50LnZhbHVlID0gbGVmdCtjYW4udWkuY3VycmVudC52YWx1ZS5zbGljZShjYW4udWkuY3VycmVudC5zZWxlY3Rpb25FbmQpKQoJCQkJCWNhbi51aS5jdXJyZW50LmZvY3VzKCksIGNhbi51aS5jb250ZW50LnNjcm9sbExlZnQgLT0gMTAwMDAsIGNhbi51aS5jdXJyZW50LnNldFNlbGVjdGlvblJhbmdlKGxlZnQubGVuZ3RoLCBsZWZ0Lmxlbmd0aCkKCQkJCX19IH0sIHRhcmdldCkKCQkJfSkKCQl9CgoJCWZ1bmN0aW9uIGZpbHRlcigpIHsKCQkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgW2h0bWwuVEJPRFksICBodG1sLlRSXSwgZnVuY3Rpb24odHIpIHsKCQkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIHRyLCBodG1sLkhJREUsIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgewoJCQkJCWlmICh0ZC5pbm5lclRleHQudG9Mb3dlckNhc2UoKS5pbmRleE9mKGNhbi5iYXNlLnRyaW1TdWZmaXgoKG5hbWUgPT0gaWNlLlBUPyB0eXBlOiBuYW1lKS50b0xvd2VyQ2FzZSgpLCAiKCIpKSA9PSAwKSB7IHJldHVybiB0ZCB9CgkJCQl9KS5sZW5ndGggPT0gMCkpIHsgcmV0dXJuIHRyIH0KCQkJfSkubGVuZ3RoID4gKG5hbWUgPT0gaWNlLlBUPyAxOiAwKQoJCX0KCgkJZnVuY3Rpb24gc2VsZWN0KGluZGV4LCB0b3RhbCkgeyBpbmRleCA9IChpbmRleCsodG90YWwrMSkpJSh0b3RhbCsxKQoJCQlpZiAoaW5kZXggPT0gdG90YWwpIHsgY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSA9IGNhbi51aS5jb21wbGV0ZS5fbXNnLk9wdGlvbihQUkUpKSB9CgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgW2h0bWwuVEJPRFksICJ0cjpub3QoLmhpZGUpIl0sIGZ1bmN0aW9uKHRyLCBpKSB7IGlmIChjYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgdHIsIGh0bWwuU0VMRUNULCBpID09IGluZGV4KSkgewoJCQkJY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSA9IGNhbi51aS5jb21wbGV0ZS5fbXNnLk9wdGlvbihQUkUpK2Nhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlREKVswXS5pbm5lclRleHQpCgkJCX0gfSkKCQkJcmV0dXJuIGluZGV4CgkJfQoKCQlpZiAoZXZlbnQuY3RybEtleSkgewoJCQlpZiAoZXZlbnQudHlwZSA9PSAia2V5dXAiKSB7CgkJCQl2YXIgdG90YWwgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtodG1sLlRCT0RZLCAidHI6bm90KC5oaWRlKSJdKS5sZW5ndGgKCQkJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCQkJY2FzZSAibiI6IGNhbi51aS5jb21wbGV0ZS5faW5kZXggPSBzZWxlY3QoY2FuLnVpLmNvbXBsZXRlLl9pbmRleCsxLCB0b3RhbCk7IGJyZWFrCgkJCQkJY2FzZSAicCI6IGNhbi51aS5jb21wbGV0ZS5faW5kZXggPSBzZWxlY3QoY2FuLnVpLmNvbXBsZXRlLl9pbmRleC0xLCB0b3RhbCk7IGJyZWFrCgkJCQkJZGVmYXVsdDogcmV0dXJuIGZhbHNlCgkJCQl9CgkJCQlyZXR1cm4gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCX0KCQkJcmV0dXJuCgkJfQoKCQljYW4uY3VycmVudC5saW5lLmFwcGVuZENoaWxkKGNhbi51aS5jb21wbGV0ZSksIGNhbi5wYWdlLnN0eWxlKGNhbiwgY2FuLnVpLmNvbXBsZXRlLCBodG1sLkxFRlQsIGNhbi51aS5jdXJyZW50Lm9mZnNldExlZnQtMSwgaHRtbC5NQVJHSU5fVE9QLCBjYW4udWkuY3VycmVudC5vZmZzZXRIZWlnaHQrNCkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsICJkaXYucHJlIiwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLmlubmVyVGV4dCA9IGNhbi51aS5jb21wbGV0ZS5fbXNnLk9wdGlvbihQUkUpfHxwcmUgfSkKCQlpZiAocHJlID09ICIiKSB7IHJldHVybiB1cGRhdGUodGFyZ2V0KSB9CgoJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCWNhc2UgaHRtbC5FTlRFUjogdXBkYXRlKHRhcmdldCk7IGJyZWFrCgkJCWNhc2UgaHRtbC5UQUI6IHVwZGF0ZSh0YXJnZXQpOyBicmVhawoJCQljYXNlIGljZS5TUDogdXBkYXRlKHRhcmdldCk7IGJyZWFrCgkJCWNhc2UgaWNlLlBUOiB1cGRhdGUodGFyZ2V0KTsgYnJlYWsKCQkJZGVmYXVsdDogZmlsdGVyKCkgfHwgdXBkYXRlKHRhcmdldCk7IGJyZWFrCgkJfSBjYW4udWkuY29tcGxldGUuX2luZGV4ID0gLTEKCX0sCgoJX3NlbGVjdExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uY3VycmVudC5saW5lLCAidGQudGV4dCIsIGZ1bmN0aW9uKHRkKSB7IGNhbi51aS5jdXJyZW50LnZhbHVlID0gdGQuaW5uZXJUZXh0CgkJCWNhbi5jdXJyZW50LmxpbmUuYXBwZW5kQ2hpbGQoY2FuLnVpLmN1cnJlbnQpLCBjYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5jdXJyZW50LCBodG1sLkxFRlQsIHRkLm9mZnNldExlZnQtMSwgaHRtbC5XSURUSCwgY2FuLnVpLmNvbnRlbnQuc3R5bGUud2lkdGgpCgkJCWlmIChldmVudCkgewoJCQkJaWYgKGV2ZW50LnR5cGUgPT0gImNsaWNrIiAmJiBjYW4ubW9kZSAhPSAiaW5zZXJ0IikgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgY2FuLm9uYWN0aW9uLl9jb21wbGV0ZShldmVudCwgY2FuKSB9KQoJCQkJfQoJCQkJY2FuLnVpLmN1cnJlbnQuZm9jdXMoKSwgY2FuLnVpLmNvbnRlbnQuc2Nyb2xsTGVmdCAtPSAxMDAwMAoJCQkJY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCBjYW4udWkuY3VycmVudCwgMCwgKGV2ZW50Lm9mZnNldFgpLzEyLTEpCgkJCX0KCQl9KQoJfSwKCXJlcmFua0xpbmU6IGZ1bmN0aW9uKGNhbiwgdmFsdWUpIHsgY2FuLm1heCA9IDAKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJY2FuLm1heCsrLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBpdGVtLCAidGQubGluZSIsIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS5pbm5lclRleHQgPSBpbmRleCsxIH0pCgkJfSkKCX0sCglpbnNlcnRMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlLCBiZWZvcmUpIHsKCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5hcHBlbmRMaW5lKGNhbiwgdmFsdWUpCgkJYmVmb3JlICYmIGNhbi51aS5jb250ZW50Lmluc2VydEJlZm9yZShsaW5lLCBjYW4ub25hY3Rpb24uX2dldExpbmUoY2FuLCBiZWZvcmUpKQoJCXJldHVybiBjYW4ub25hY3Rpb24ucmVyYW5rTGluZShjYW4pLCBjYW4ub25hY3Rpb24uX2dldExpbmVubyhjYW4sIGxpbmUpCgl9LAoJZGVsZXRlTGluZTogZnVuY3Rpb24oY2FuLCBsaW5lKSB7IGxpbmUgPSBjYW4ub25hY3Rpb24uX2dldExpbmUoY2FuLCBsaW5lKQoJCXZhciBuZXh0ID0gbGluZS5uZXh0U2libGluZ3x8bGluZS5wcmV2aW91c1NpYmxpbmcKCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBsaW5lKSwgY2FuLm9uYWN0aW9uLnJlcmFua0xpbmUoY2FuKQoJCXJldHVybiBuZXh0Cgl9LAoJbW9kaWZ5TGluZTogZnVuY3Rpb24oY2FuLCBsaW5lLCB2YWx1ZSkgewoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBodG1sLlRSLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQlpZiAoaXRlbSAhPSBsaW5lICYmIGluZGV4KzEgIT0gbGluZSkgeyByZXR1cm4gfQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBpdGVtLCAidGQudGV4dCIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLkFwcGVuZHMoY2FuLCBpdGVtLCBbY2FuLm9uc3ludGF4Ll9wYXJzZShjYW4sIHZhbHVlKV0pCgkJCX0pCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyLmlofku7bmlbAiLCAi5qih5byPIiwgIuaMiemUriIsICLop6PmnpDlmagiLCAi5paH5Lu25ZCNIiwgIuW9k+WJjeihjCIsICLot7PovazmlbAiXX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgImNhbi5jb2RlLmlubmVyLnBsdWdpbiIsIHNoeSgi5o+S5Lu2Iiwge30sIFtpY2UuTElTVCwgaWNlLkJBQ0tdLCBmdW5jdGlvbihtc2csIGNtZHMpIHsKCQkJY29uc29sZS5sb2coIndoYXQiKQoJCX0pKQoJCWNhbi5Db25mKGNhbi5fYXJncykKCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJjYW4uY29kZS5pbm5lci5rZXltYXAiLCBzaHkoIuaMiemUriIsIHt9LCBbIm1vZGUiLCAia2V5IiwgaWNlLkxJU1QsIGljZS5CQUNLXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCWNhbi5jb3JlLkl0ZW0oY2FuLm9ua2V5bWFwLl9tb2RlLCBmdW5jdGlvbihtb2RlLCB2YWx1ZSkgewoJCQkJKCFjbWRzWzBdIHx8IGNtZHNbMF0gPT0gbW9kZSkgJiYgY2FuLmNvcmUuSXRlbSh2YWx1ZSwgZnVuY3Rpb24oa2V5LCBmdW5jKSB7CgkJCQkJaWYgKGNtZHNbMF0gPT0gbW9kZSAmJiBjbWRzWzFdID09IGtleSkgewoJCQkJCQltc2cuUHVzaCgia2V5IiwgIm1vZGUiKQoJCQkJCQltc2cuUHVzaCgidmFsdWUiLCBtb2RlKQoJCQkJCQltc2cuUHVzaCgia2V5IiwgImtleSIpCgkJCQkJCW1zZy5QdXNoKCJ2YWx1ZSIsIGtleSkKCQkJCQkJbXNnLlB1c2goImtleSIsICJoZWxwIikKCQkJCQkJbXNnLlB1c2goInZhbHVlIiwgZnVuYy5oZWxwKQoJCQkJCQltc2cuUHVzaCgia2V5IiwgImZ1bmMiKQoJCQkJCQltc2cuUHVzaCgidmFsdWUiLCBmdW5jLnRvU3RyaW5nKCkpCgkJCQkJfSBlbHNlIGlmICghY21kc1swXSB8fCAhY21kc1sxXSkgewoJCQkJCQlmdW5jLmhlbHAgJiYgbXNnLlB1c2goa2l0LkRpY3QoIm1vZGUiLCBtb2RlLCAia2V5Iiwga2V5LCAiaGVscCIsIGZ1bmMuaGVscCkpCgkJCQkJfQoJCQkJfSkKCQkJfSksIG1zZy5TdGF0dXNUaW1lQ291bnQoKQoJCX0pKQoKCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIm9yaWVudGF0aW9uY2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJaWYgKGNhbi51c2VyLm1vZC5pc0NtZCkgeyBjYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQpLCBjYW4uQ29uZldpZHRoKHdpbmRvdy5pbm5lcldpZHRoKSB9CgkJCWNhbi51c2VyLnRvYXN0KGNhbiwgY2FuLkNvbmZIZWlnaHQoKSsiIikKCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJfSkKCgkJdmFyIHBhdGhzID0gY2FuLmNvcmUuU3BsaXQoY2FuLk9wdGlvbihuZnMuUEFUSCksIGljZS5GUyk7IGNhbi5PcHRpb24obmZzLlBBVEgsIHBhdGhzWzBdKQoJCXZhciBmaWxlcyA9IGNhbi5jb3JlLlNwbGl0KGNhbi5PcHRpb24obmZzLkZJTEUpLCBpY2UuRlMpOyBjYW4uT3B0aW9uKG5mcy5GSUxFLCBmaWxlc1swXSkKCQkvLyBjYW4udGFidmlldyA9IGNhbi50YWJ2aWV3fHx7fSwgY2FuLnRhYnZpZXdbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBtc2cKCQljYW4udGFidmlldyA9IGNhbi50YWJ2aWV3fHx7fQoJCWNhbi5oaXN0b3J5ID0gY2FuLmhpc3Rvcnl8fFtdLCBjYW4udG9vbGtpdCA9IHt9LCBjYW4uZXh0ZW50aW9ucyA9IHt9LCBjYW4ucHJvZmlsZV9zaXplID0ge30KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5vbmxheW91dC5wcm9maWxlKGNhbikKCQljYW4ub25pbXBvcnQuX3Byb2plY3QoY2FuLCBjYW4udWkucHJvamVjdCkKCQljYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBjYW4udWkucHJvZmlsZSkKCQljYW4ub25pbXBvcnQuX2Rpc3BsYXkoY2FuLCBjYW4udWkuZGlzcGxheSkKCgkJY2FuLnVpLl90YWJzID0gY2FuLnBhZ2UuaW5zZXJ0QmVmb3JlKGNhbiwgW3t2aWV3OiAidGFicyJ9XSwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLnVpLl9wYXRoID0gY2FuLnBhZ2UuaW5zZXJ0QmVmb3JlKGNhbiwgW3t2aWV3OiAicGF0aCJ9XSwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgoJCWNhbi5Db25mKCJtb2RlIikgPT0gInNpbXBsZSI/IGNhbi5vbmltcG9ydC5fc2ltcGxlKGNhbik6IGNhbi5vbmltcG9ydC5wcm9qZWN0KGNhbiwgcGF0aHMsIGZ1bmN0aW9uKCkgewoJCQljYW4ub25pbXBvcnQuX3Rvb2xraXQoY2FuLCBjYW4udWkudG9vbGtpdCksIGNhbi5vbmltcG9ydC5fc2Vzc2lvbihjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5fa2V5ZG93bihjYW4pCgkJCWNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgewoJCQkJY2FuLmNvcmUuTmV4dChmaWxlcy5zbGljZSgxKSwgZnVuY3Rpb24oZmlsZSwgbmV4dCkgewoJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGZpbGUsIGNhbi5PcHRpb24obmZzLkxJTkUpLCBuZXh0KQoJCQkJfSkKCQkJfSkKCQl9KQoJCWlmIChsb2NhdGlvbi5oYXNoKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGRlY29kZVVSSUNvbXBvbmVudChsb2NhdGlvbi5oYXNoKS5zbGljZSgxKSwgMSkKCQl9IGVsc2UgewoJCQljYW4ub25pbXBvcnQudGFidmlldyhjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuTElORSkpCgkJfQoKCQljYW4udXNlci5pc01vYmlsZSAmJiAhY2FuLnVzZXIuaXNMYW5kc2NhcGUoKSAmJiBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgl9LAoJX3NpbXBsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQljYW4udGFidmlld1tjYW4ub25leHBvcnQua2V5cyhjYW4pXSA9IGNhbi5fbXNnCgkJY2FuLkNvbmYoaHRtbC5IRUlHSFQsICIiKSwgY2FuLnVpLnByb2plY3QuX3RvZ2dsZSgpCgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fZmllbGRzLCBjaGF0Lk9VVFBVVCkKCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJzaW1wbGUiKQoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkuX3RhYnMpCgl9LAoJX3Byb2plY3Q6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgdGFyZ2V0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIH0KCX0sCglfcHJvZmlsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVR9XSk7IGNhbi51aS5wcm9maWxlX291dHB1dCA9IHVpLm91dHB1dAoJCXZhciBhY3Rpb24gPSBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIGtpdC5EaWN0KAoJCQljbGkuQ0xPU0UsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCB0YXJnZXQpLCBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikgfSwKCQkJY2xpLkNMRUFSLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB1aS5vdXRwdXQpIH0sCgkJCWNsaS5TSE9XLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuWxleekuiJdKGV2ZW50LCBjYW4pIH0sCgkJCSLliqDovb0iLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuWKoOi9vSJdKGV2ZW50LCBjYW4pLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9LAoKCQkJIumTvuaOpSIsIGZ1bmN0aW9uKGV2ZW50KSB7IHZhciBwb2QgPSBjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikKCQkJCWlmIChwb2QpIHsKCQkJCQljYW4udXNlci5vcGVuKGNhbi5iYXNlLlBhdGgoIi9jaGF0LyIsICJwb2QiLCBwb2QsICJjbWQiLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpKQoJCQkJfSBlbHNlIHsKCQkJCQljYW4udXNlci5vcGVuKGNhbi5iYXNlLlBhdGgoIi9jaGF0LyIsICJjbWQiLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpKQoJCQkJfQoJCQl9LAoJCQltZGIuUExVR0lOLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW2N0eC5JTkRFWCwgY3R4LkFSR1NdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIGRhdGEsIHVpLm91dHB1dCkKCQkJCX0pCgkJCX0sCgkJCWh0bWwuV0lEVEgsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGh0bWwuV0lEVEgsIHZhbHVlOiA1MH1dLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCQkJY2FuLnByb2ZpbGVfc2l6ZVtjYW4ub25leHBvcnQua2V5cyhjYW4pXSA9IGNhbi5Db25mV2lkdGgoKSpwYXJzZUludChkYXRhLndpZHRoKS8xMDAKCQkJCQljYW4ub25hY3Rpb25bIuWxleekuiJdKGV2ZW50LCBjYW4pCgkJCQl9KQoJCQl9LAoJCSkpCgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCwgc2hvdykgeyBhY3Rpb25bc2hvdz8gY2xpLlNIT1c6IGNsaS5DTE9TRV0oZXZlbnQpIH0KCX0sCglfZGlzcGxheTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVR9LCB7dmlldzogaHRtbC5TVEFUVVN9XSkKCQljYW4udWkuZGlzcGxheV9vdXRwdXQgPSB1aS5vdXRwdXQsIGNhbi51aS5kaXNwbGF5X3N0YXR1cyA9IHVpLnN0YXR1cwoJCXZhciBhY3Rpb24gPSBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIGtpdC5EaWN0KAoJCQljbGkuQ0xPU0UsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCB0YXJnZXQpLCBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikgfSwKCQkJY2xpLkNMRUFSLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB1aS5vdXRwdXQpIH0sCgkJCWNsaS5FWEVDLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuaJp+ihjCJdKGV2ZW50LCBjYW4pIH0sCgkJCW1kYi5QTFVHSU4sIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbY3R4LklOREVYLCBjdHguQVJHU10sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEpIHsKCQkJCQljYW4ub25pbXBvcnQucGx1Z2luKGNhbiwgZGF0YSwgdWkub3V0cHV0KQoJCQkJfSkKCQkJfSwKCQkJaHRtbC5IRUlHSFQsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGh0bWwuSEVJR0hULCB2YWx1ZTogNTB9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQkJCWNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBjYW4uQ29uZkhlaWdodCgpKnBhcnNlSW50KGRhdGEuaGVpZ2h0KS8xMDAKCQkJCQljYW4ub25hY3Rpb25bIuaJp+ihjCJdKGV2ZW50LCBjYW4pCgkJCQl9KQoJCQl9LAoJCSkpCgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCwgc2hvdykgeyBhY3Rpb25bc2hvdz8gY2xpLkVYRUM6IGNsaS5DTE9TRV0oZXZlbnQpIH0KCX0sCglfdG9vbGtpdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQljYW4udWkudG9vbGtpdCA9IGNhbi5vbmFwcGVuZC5maWVsZChjYW4sICJ0b29sa2l0Iiwge30sIGNhbi5fb3V0cHV0KQoJfSwKCV9zZXNzaW9uOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5vbmltcG9ydC5zZXNzKGNhbiwgIiIsIGZ1bmN0aW9uKCkgeyBjYW4ub25pbXBvcnQuc2VzcyhjYW4sIHsKCQkJcGx1ZzogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJwbHVnIikpLnJldmVyc2UoKSwKCQkJZXh0czogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJleHRzIikpLnJldmVyc2UoKSwKCQkJdGFiczogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJ0YWJzIikpLAoJCX0pIH0pCgl9LAoJX2tleWRvd246IGZ1bmN0aW9uKGNhbikgeyBjYW4ub25rZXltYXAuX2J1aWxkKGNhbikKCQljYW4udXNlci5tb2QuaXNDbWQgJiYgY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sIGNoYXQuT05LRVlET1dOLCBmdW5jdGlvbihldmVudCkgewoJCQljYW4uX2tleV9saXN0ID0gY2FuLm9ua2V5bWFwLl9wYXJzZShldmVudCwgY2FuLCAicGx1Z2luIiwgY2FuLl9rZXlfbGlzdCwgY2FuLnVpLmNvbnRlbnQpCgkJfSkKCX0sCgoJcHJvamVjdDogZnVuY3Rpb24oY2FuLCBwYXRoLCBjYikgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkucHJvamVjdCkKCQkvLyBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFsi5omn6KGMIiwgIumihOiniCIsICLkv53lrZgiXSwgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLnByb2plY3QsIFt7dmlldzogImFjdGlvbiJ9XSkuZmlyc3QsIHsKCQkvLyAJIuaJp+ihjCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5omn6KGMIl0oZXZlbnQsIGNhbikgfSwKCQkvLyAJIumihOiniCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5bGV56S6Il0oZXZlbnQsIGNhbikgfSwKCQkvLyAJIuS/neWtmCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5L+d5a2YIl0oZXZlbnQsIGNhbikgfSwKCQkvLyB9KQoJCS8vIGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5wcm9qZWN0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogW3t0eXBlOiAiaW5wdXQiLCBkYXRhOiB7dHlwZTogInRleHQifSwgb25rZXl1cDogZnVuY3Rpb24oZXZlbnQpIHsKCQkvLyAJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLnByb2plY3QsICJkaXYuaXRlbSIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkvLyAJCWlmIChpdGVtLmlubmVyVGV4dC5pbmRleE9mKGV2ZW50LnRhcmdldC52YWx1ZSkgPT0gLTEpIHsKCQkvLyAJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgaXRlbSwgImhpZGUiKQoJCS8vIAkJfSBlbHNlIHsKCQkvLyAJCQljYW4ucGFnZS5DbGFzc0xpc3QuZGVsKGNhbiwgaXRlbSwgImhpZGUiKQoJCS8vIAkJfQoJCS8vIAl9KQoJCS8vIH19IF19LCBdKQoJCXZhciBwcm9qZWN0ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLnByb2plY3QsIFsKCQkJe3ZpZXc6ICJraW5kIiwgaW5uZXI6ICJzb3VyY2UiLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGV2ZW50LnRhcmdldC5uZXh0U2libGluZykKCQkJfX0sIHt2aWV3OiAic291cmNlIn0sCgkJCXt2aWV3OiAia2luZCIsIGlubmVyOiAibW9kdWxlIiwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcpCgkJCX19LCB7dmlldzogIm1vZHVsZSJ9LAoJCQl7dmlldzogImtpbmQiLCBpbm5lcjogInBsdWdpbiIsIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgZXZlbnQudGFyZ2V0Lm5leHRTaWJsaW5nKQoJCQl9fSwge3ZpZXc6ICJwbHVnaW4ifSwKCQldKQoKCQljYW4uY29yZS5OZXh0KHBhdGgsIGZ1bmN0aW9uKHBhdGgsIG5leHQsIGluZGV4LCBhcnJheSkgewoJCQl2YXIgbGlzdCA9IHByb2plY3Quc291cmNlOyBpZiAoYXJyYXkubGVuZ3RoID4gMSkgewoJCQkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgcHJvamVjdC5zb3VyY2UsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIHBhdGhdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCB1aS5saXN0KQoJCQkJfX0sIHt2aWV3OiBodG1sLkxJU1R9XSk7IGxpc3QgPSB1aS5saXN0CgkJCQlpZiAoaW5kZXggPiAwKSB7IHVpLml0ZW0uY2xpY2soKSB9CgkJCX0KCQkJY2FuLnJ1bihjYW4ucmVxdWVzdCh7fSwge2Rpcl9yb290OiBwYXRoLCBkaXJfZGVlcDogdHJ1ZX0pLl9ldmVudCwgW2ljZS5QV0RdLCBmdW5jdGlvbihtc2cpIHsgY2FuLl9maWxlID0gbXNnLlRhYmxlKCkKCQkJCWNhbi5jb3JlLkxpc3QoY2FuLl9maWxlLCBmdW5jdGlvbihpdGVtKSB7IGlmIChjYW4uT3B0aW9uKG5mcy5GSUxFKS5pbmRleE9mKGl0ZW0ucGF0aCkgPT0gMCkgeyBpdGVtLmV4cGFuZCA9IHRydWUgfSB9KQoJCQkJY2FuLm9uYXBwZW5kLnRyZWUoY2FuLCBjYW4uX2ZpbGUsIG5mcy5QQVRILCBpY2UuUFMsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBwYXRoLCBpdGVtLnBhdGgpCgkJCQl9LCBsaXN0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pLCBjYW4uU3RhdHVzKCLmlofku7bmlbAiLCBtc2cuTGVuZ3RoKCkpLCBuZXh0KCkKCQkJfSwgdHJ1ZSkKCQl9LCBmdW5jdGlvbigpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpIH0pCgoJCWNhbi5ydW4oY2FuLnJlcXVlc3Qoe30sIHtmaWVsZHM6ICJpbmRleCJ9KS5fZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09NTUFORCwgInNlYXJjaCIsICJjb21tYW5kIl0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQudHJlZShjYW4sIG1zZy5UYWJsZSgpLCBjdHguSU5ERVgsIGljZS5QVCwgZnVuY3Rpb24oZXZlbnQsIGl0ZW0pIHsKCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGl0ZW0uaW5kZXgsIGN0eC5JTkRFWCkKCQkJfSwgcHJvamVjdC5tb2R1bGUpCgkJfSkKCgkJY2FuLm9uYXBwZW5kLnRyZWUoY2FuLCBjYW4uY29yZS5JdGVtKGNhbi5vbmVuZ2luZS5wbHVnaW4ubWV0YSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB7aW5kZXg6IGNhbi5iYXNlLnRyaW1QcmVmaXgoa2V5LCAiY2FuLiIpfSB9KSwgY3R4LklOREVYLCBpY2UuUFQsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksICJjYW4uIitpdGVtLmluZGV4LCBjdHguSU5ERVgpCgkJfSwgcHJvamVjdC5wbHVnaW4pCgl9LAoJdGFidmlldzogZnVuY3Rpb24oY2FuLCBwYXRoLCBmaWxlLCBsaW5lLCBjYiwgc2tpcCwgc2tpcDIpIHsgdmFyIGtleSA9IGNhbi5vbmV4cG9ydC5rZXlzKGNhbiwgZmlsZSwgcGF0aCkKCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kKSB7IGxvY2F0aW9uLmhhc2ggPSBmaWxlIH0KCQlpZiAoIXNraXAgJiYgY2FuLnRhYnZpZXdba2V5XSkgeyBjYW4udXNlci5tb2QuaXNDbWQgJiYgY2FuLnVzZXIudGl0bGUocGF0aCtmaWxlKQoJCQljYW4uX21zZyAmJiBjYW4uX21zZy5PcHRpb24obmZzLkxJTkUsIGNhbi5PcHRpb24obmZzLkxJTkUpKSwgY2FuLl9tc2cgPSBjYW4udGFidmlld1trZXldCgkJCWNhbi5PcHRpb24oe3BhdGg6IHBhdGgsIGZpbGU6IGZpbGUsIGxpbmU6IGxpbmV8fGNhbi5fbXNnLk9wdGlvbihuZnMuTElORSl8fDF9KQoJCQlyZXR1cm4gY2FuLl9tc2cuT3B0aW9uKGNhbi5PcHRpb24oKSksIGNhbi5vbnN5bnRheC5faW5pdChjYW4sIGNhbi5fbXNnLCBjYiwgc2tpcDIpCgkJfQoKCQlmdW5jdGlvbiBzaG93KG1zZykgeyBjYW4udGFidmlld1trZXldID0gbXNnCgkJCXZhciBza2lwMiA9IHNraXAKCQkJbXNnLl90YWIgPSBjYW4ub25hcHBlbmQudGFicyhjYW4sIFt7bmFtZTogZmlsZS5zcGxpdChtc2cuT3B0aW9uKG5mcy5MSU5FKSA9PSBjdHguSU5ERVg/IGljZS5QVDogaWNlLlBTKS5wb3AoKSwgdGV4dDogZmlsZX1dLCBmdW5jdGlvbihldmVudCwgbWV0YSkgewoJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBwYXRoLCBmaWxlLCAiIiwgY2IsIGZhbHNlLCBza2lwMiksIGNiID0gbnVsbCwgc2tpcDIgPSBmYWxzZQoJCQl9LCBmdW5jdGlvbihpdGVtKSB7IGRlbGV0ZShjYW4udGFidmlld1trZXldKSB9LCBjYW4udWkuX3RhYnMsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIHtvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl9fSkKCQkJfSkKCQl9CgoJCWNhbi5PcHRpb24oe3BhdGg6IHBhdGgsIGZpbGU6IGZpbGUsIGxpbmU6IGxpbmV8fDF9KQoJCWxpbmUgPT0gY3R4LklOREVYPyBzaG93KGNhbi5yZXF1ZXN0KHt9LCB7aW5kZXg6IGZpbGUsIGxpbmU6IGxpbmV9KSk6IGNhbi5ydW4oe30sIFtwYXRoLCBmaWxlXSwgc2hvdywgdHJ1ZSkKCX0sCglwcm9maWxlOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciB3aWR0aCA9IGNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV18fChjYW4uQ29uZldpZHRoKCktY2FuLnVpLnByb2plY3Qub2Zmc2V0V2lkdGgpLzIKCQltc2cgJiYgY2FuLm9uaW1wb3J0LnByb2Nlc3MoY2FuLCBtc2csIGNhbi51aS5wcm9maWxlX291dHB1dCwgd2lkdGgtMzIpCgkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9maWxlLCB0cnVlKSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgl9LAoJZGlzcGxheTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVpZ2h0ID0gY2FuLnByb2ZpbGVfc2l6ZVtjYW4ub25leHBvcnQua2V5cyhjYW4pXXx8e3NoOiBjYW4uQ29uZkhlaWdodCgpLzJ9W2Nhbi5wYXJzZV18fGNhbi5Db25mSGVpZ2h0KCkvNAoJCW1zZyAmJiBjYW4ub25pbXBvcnQucHJvY2VzcyhjYW4sIG1zZywgY2FuLnVpLmRpc3BsYXlfb3V0cHV0LCBjYW4uQ29uZldpZHRoKCkpCgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4udWkuZGlzcGxheV9vdXRwdXQsIGh0bWwuTUFYX0hFSUdIVCwgaGVpZ2h0KQoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkuZGlzcGxheSwgdHJ1ZSksIGNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJfSwKCXRvb2xraXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgY2IpIHsKCQltZXRhLm9wdHMgPSBtZXRhLm9wdHN8fHtyZXBvczogY2FuLmJhc2UudHJpbVN1ZmZpeChjYW4uYmFzZS50cmltUHJlZml4KGNhbi5PcHRpb24obmZzLlBBVEgpLCAidXNyLyIpLCBpY2UuUFMpIH0KCQljYW4ub25pbXBvcnQucGx1Z2luKGNhbiwgbWV0YSwgY2FuLnVpLnRvb2xraXQub3V0cHV0LCBmdW5jdGlvbihzdWIpIHsKCQkJc3ViLkNvbmZIZWlnaHQoY2FuLkNvbmZIZWlnaHQoKS00Kmh0bWwuQUNUSU9OX0hFSUdIVCksIHN1Yi5Db25mV2lkdGgoY2FuLkNvbmZXaWR0aCgpKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIHN1Yi5Db25mSGVpZ2h0KCkpCgkJCXN1Yi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCkpCgkJCXN1Yi5zZWxlY3QgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHN1Yi5fbGVnZW5kLmNsaWNrKCksIHN1YiB9CgoJCQljYW4uX3N0YXR1cy5hcHBlbmRDaGlsZChzdWIuX2xlZ2VuZCksIHN1Yi5fbGVnZW5kLm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewoJCQkJaWYgKGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fc3RhdHVzLCBpY2UuUFQraHRtbC5TRUxFQ1QpWzBdID09IGV2ZW50LnRhcmdldCkgewoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBldmVudC50YXJnZXQsIGh0bWwuU0VMRUNUKQoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBzdWIuX3RhcmdldCwgaHRtbC5TRUxFQ1QpCgkJCQkJcmV0dXJuCgkJCQl9CgkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9zdGF0dXMsIGh0bWwuTEVHRU5ELCBldmVudC50YXJnZXQpCgkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLnVpLnRvb2xraXQub3V0cHV0LCBodG1sLkZJRUxEU0VULCBzdWIuX3RhcmdldCkKCQkJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIGNhbi5wYWdlLlNlbGVjdChjYW4sIHN1Yi5fb3B0aW9uLCBodG1sLk9QVElPTl9BUkdTKVswXSkKCQkJfSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpCgkJCWNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7IGNhbi5vbmFwcGVuZC5fb3B0aW9uKHN1Yiwge2lucHV0czogW3t0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogY2xpLkNMT1NFLCBfY2I6IGZ1bmN0aW9uKCkgewoJCQkJc3ViLl9sZWdlbmQuY2xpY2soKQoJCQl9fV19KSB9KQoJCX0pCgl9LAoJcHJvY2VzczogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCwgd2lkdGgpIHsKCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHRhcmdldCkKCQlpZiAobXNnLk9wdGlvbihpY2UuTVNHX1BST0NFU1MpID09ICJfZmllbGQiKSB7CgkJCW1zZy5UYWJsZShmdW5jdGlvbihtZXRhKSB7IG1ldGEuZGlzcGxheSA9IG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKQoJCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIG1ldGEsIHRhcmdldCwgZnVuY3Rpb24oc3ViKSB7IHdpZHRoICYmIHN1Yi5Db25mV2lkdGgod2lkdGgpCgkJCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgc3ViLl9vcHRpb24sIGh0bWwuT1BUSU9OX0FSR1MpWzBdKQoJCQkJfSkKCQkJfSkKCQl9IGVsc2UgaWYgKG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKSAhPSAiIikgewoJCQljYW4ub25hcHBlbmQuX291dHB1dChjYW4sIG1zZywgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVkpLCB0YXJnZXQsIGZhbHNlLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJCQl9KQoJCX0gZWxzZSB7CgkJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgbnVsbCwgdGFyZ2V0KQoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2csIHRhcmdldCkKCQl9Cgl9LAoJcGx1Z2luOiBmdW5jdGlvbihjYW4sIG1ldGEsIHRhcmdldCwgY2IpIHsKCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwgbWV0YSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5PcHRpb24oKSkKCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBtZXRhLmluZGV4XSwgY21kcyksIGNiLCB0cnVlKQoJCQl9LCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YikKCQl9LCB0YXJnZXQpCgl9LAoJbGF5b3V0OiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgd2lkdGggPSBjYW4uQ29uZldpZHRoKCkrKGNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi51c2VyLm1vZC5pc0NtZCAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAxNjogMCktKGNhbi51c2VyLmlzV2luZG93cyAmJiAhY2FuLnVzZXIubW9kLmlzQ21kPyAyMDogMCkKCQljYW4ucGFnZS5zdHlsZVdpZHRoKGNhbiwgY2FuLnVpLnByb2ZpbGVfb3V0cHV0LCBjYW4ucHJvZmlsZV9zaXplW2Nhbi5vbmV4cG9ydC5rZXlzKGNhbildfHwod2lkdGgtY2FuLnVpLnByb2plY3Qub2Zmc2V0V2lkdGgpLzIpCgkJY2FuLnBhZ2Uuc3R5bGVXaWR0aChjYW4sIGNhbi51aS5jb250ZW50LCB3aWR0aC1jYW4udWkucHJvamVjdC5vZmZzZXRXaWR0aC1jYW4udWkucHJvZmlsZS5vZmZzZXRXaWR0aCkKCQljYW4ucGFnZS5zdHlsZVdpZHRoKGNhbiwgY2FuLnVpLmRpc3BsYXksIHdpZHRoLWNhbi51aS5wcm9qZWN0Lm9mZnNldFdpZHRoKQoKCQlpZiAoIWhlaWdodCAmJiBjYW4uQ29uZigibW9kZSIpID09ICJzaW1wbGUiKSB7IHJldHVybiB9CgkJdmFyIGhlaWdodCA9IGNhbi5Db25mSGVpZ2h0KCktKGNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi51c2VyLm1vZC5pc0NtZD8gKGNhbi51c2VyLmlzTGFuZHNjYXBlKCk/IDE0OiA1NCk6IDApLShjYW4udXNlci5pc1dpbmRvd3M/IDIwOiAwKQoJCWlmICghaGVpZ2h0IHx8IGhlaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCkgeyBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSAyMDAgfQoJCWlmIChjYW4udXNlci5pc01vYmlsZSAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIGhlaWdodCA8IDIwMCkgeyBoZWlnaHQgPSA0MDAgfQoKCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kKSB7IGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLnByb2plY3QsIGhlaWdodCsyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQkJaWYgKGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodCkgewoJCQkJdmFyIHJlc3QgPSBjYW4udWkuZGlzcGxheS5vZmZzZXRIZWlnaHQrY2FuLnVpLl9wYXRoLm9mZnNldEhlaWdodCtjYW4udWkuX3RhYnMub2Zmc2V0SGVpZ2h0KzUKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodC1yZXN0KQoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodC1yZXN0K2h0bWwuQUNUSU9OX0hFSUdIVCs2KQoJCQl9IGVsc2UgewoJCQkJdmFyIHJlc3QgPSBjYW4udWkuZGlzcGxheS5vZmZzZXRIZWlnaHQrNQoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkuY29udGVudCwgaGVpZ2h0LTgpCgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi51aS5wcm9maWxlX291dHB1dCwgaGVpZ2h0K2h0bWwuQUNUSU9OX0hFSUdIVCs2LTgpCgkJCX0KCQl9IGVsc2UgewoJCQl2YXIgcmVzdCA9IGNhbi51aS5kaXNwbGF5Lm9mZnNldEhlaWdodCtjYW4udWkuX3BhdGgub2Zmc2V0SGVpZ2h0K2Nhbi51aS5fdGFicy5vZmZzZXRIZWlnaHQrNQoJCQljYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5jb250ZW50LCBjYW4udXNlci5tb2QuaXNDbWQgfHwgY2FuLnVzZXIuaXNNb2JpbGU/IGh0bWwuSEVJR0hUOiBodG1sLk1BWF9IRUlHSFQsIGhlaWdodCkKCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkucHJvamVjdCwgY2FuLnVpLmNvbnRlbnQub2Zmc2V0SGVpZ2h0K3Jlc3QpCgkJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QuaGFzKGNhbiwgY2FuLl9maWVsZHMsICJmdWxsIikpIHsKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLnByb2ZpbGVfb3V0cHV0LCBjYW4udWkuY29udGVudC5vZmZzZXRIZWlnaHQpCgkJCX0gZWxzZSB7CgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi51aS5wcm9maWxlX291dHB1dCwgY2FuLnVpLmNvbnRlbnQub2Zmc2V0SGVpZ2h0LWh0bWwuQUNUSU9OX0hFSUdIVC0yKQoJCQl9CgkJfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGh0bWwuSUZSQU1FLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwKCQkJCWh0bWwuSEVJR0hULCBjYW4udWkucHJvZmlsZV9vdXRwdXQub2Zmc2V0SGVpZ2h0LTQsCgkJCQlodG1sLldJRFRILCBjYW4udWkucHJvZmlsZV9vdXRwdXQub2Zmc2V0V2lkdGgtNSwKCQkJCSJtYXJnaW4tbGVmdCIsICItMTBweCIsICJtYXJnaW4tdG9wIiwgIi0xMHB4IiwKCQkJCSJwb3NpdGlvbiIsICJhYnNvbHV0ZSIsICJib3JkZXIiLCAiMCIKCQkJKQoJCX0pCgl9LAoJZXh0czogZnVuY3Rpb24oY2FuLCB1cmwsIGNiKSB7CgkJY2FuLnJlcXVpcmUoW3VybF0sIGZ1bmN0aW9uKCkge30sIGZ1bmN0aW9uKGNhbiwgbmFtZSwgc3ViKSB7IHN1Yi5faW5pdChjYW4sIGNhbi5iYXNlLlBhcnNlVVJMKHN1Yi5fcGF0aCksIGZ1bmN0aW9uKHN1YikgewoJCQljYW4uZXh0ZW50aW9uc1t1cmwuc3BsaXQoIj8iKVswXV0gPSBzdWIsIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJCX0pIH0pCgl9LAoJc2VzczogZnVuY3Rpb24oY2FuLCBzZXNzLCBjYikgeyBzZXNzID0gc2Vzc3x8Y2FuLmJhc2UuT2JqKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ3ZWIuY29kZS5pbm5lci5zZXNzIiksIHt9KQoJCWNhbi5jb3JlLk5leHQoc2Vzcy5wbHVnLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGNhbi5vbmltcG9ydC50b29sa2l0KGNhbiwge2luZGV4OiBpdGVtfSwgZnVuY3Rpb24oc3ViKSB7IGNhbi50b29sa2l0W2l0ZW1dID0gc3ViLCBuZXh0KCkgfSkgfSwgZnVuY3Rpb24oKSB7CgkJCWNhbi5jb3JlLk5leHQoc2Vzcy5leHRzLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGNhbi5vbmltcG9ydC5leHRzKGNhbiwgaXRlbSwgbmV4dCkgfSwgZnVuY3Rpb24oKSB7CgkJCQljYW4uY29yZS5OZXh0KHNlc3MudGFicywgZnVuY3Rpb24oaXRlbSwgbmV4dCkgeyB2YXIgbHMgPSBpdGVtLnNwbGl0KGljZS5ERik7IGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbHNbMF0sIGxzWzFdLCBsc1syXSwgbmV4dCkgfSwgY2IpCgkJCX0pCgkJfSkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbnN5bnRheCIsIHtoZWxwOiAi6K+t5rOV6auY5LquIiwgbGlzdDogWyJrZXl3b3JkIiwgInByZWZpeCIsICJsaW5lIl0sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHNraXApIHsKCQlpZiAobXNnLk9wdGlvbihjdHguSU5ERVgpKSB7CgkJCWNhbi51aS5fcGF0aC5pbm5lclRleHQgPSBtc2cuT3B0aW9uKG5mcy5GSUxFKQoJCX0gZWxzZSB7CgkJCWNhbi51aS5fcGF0aC5pbm5lclRleHQgPSBjYW4uYmFzZS5QYXRoKG1zZy5PcHRpb24obmZzLlBBVEgpLCBtc2cuT3B0aW9uKG5mcy5GSUxFKSkKCQl9CgoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbihjYWNoZV9kYXRhKSB7CgkJCWNhbi5maWxlICYmIChjYWNoZV9kYXRhW2Nhbi5maWxlXSA9IHtjdXJyZW50OiBjYW4uY3VycmVudCwgbWF4OiBjYW4ubWF4LAoJCQkJcHJvZmlsZV9kaXNwbGF5OiBjYW4udWkucHJvZmlsZS5zdHlsZS5kaXNwbGF5LCBkaXNwbGF5X2Rpc3BsYXk6IGNhbi51aS5kaXNwbGF5LnN0eWxlLmRpc3BsYXksCgkJCX0pCgkJCWNhbi5maWxlID0gY2FuLmJhc2UuUGF0aChtc2cuT3B0aW9uKG5mcy5QQVRIKSwgbXNnLk9wdGlvbihuZnMuRklMRSkpCgkJCWNhbi5wYXJzZSA9IGNhbi5iYXNlLkV4dChjYW4uZmlsZSksIGNhbi5TdGF0dXMoIuaooeW8jyIsICJwbHVnaW4iKQoKCQkJdmFyIHAgPSBjYWNoZV9kYXRhW2Nhbi5maWxlXTsgcCAmJiAoY2FuLmN1cnJlbnQgPSBwLmN1cnJlbnQsIGNhbi5tYXggPSBwLm1heCkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLnByb2ZpbGUsIHtzdHlsZToge2Rpc3BsYXk6IHA/IHAucHJvZmlsZV9kaXNwbGF5OiBodG1sLk5PTkV9fSkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmRpc3BsYXksIHtzdHlsZToge2Rpc3BsYXk6IHA/IHAuZGlzcGxheV9kaXNwbGF5OiBodG1sLk5PTkV9fSkKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fYWN0aW9uLCBodG1sLkRJVl9UQUJTLCBtc2cuX3RhYikKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi51aS5fdGFicywgaHRtbC5ESVZfVEFCUywgbXNnLl90YWIpCgkJCWNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgeyBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikKCQkJCW1zZy5PcHRpb24oY3R4LklOREVYKSAmJiBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5PUFRJT05fQVJHUylbMF0pCgkJCX0pCgkJCXJldHVybiBjYW4uZmlsZQoJCX0sIGNhbi51aS5jb250ZW50LCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGNhbi51aS5kaXNwbGF5X291dHB1dCkgJiYgIXNraXApIHsKCQkJcmV0dXJuIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKG51bGwsIGNhbiwgbXNnLk9wdGlvbihuZnMuTElORSkpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQl9CgoJCWlmIChtc2cuT3B0aW9uKGN0eC5JTkRFWCkpIHsKCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIHtpbmRleDogbXNnLk9wdGlvbihjdHguSU5ERVgpfSwgY2FuLnVpLmNvbnRlbnQsIGZ1bmN0aW9uKHN1YikgewoJCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9XSURUSCwgc3ViLkNvbmZXaWR0aChjYW4udWkuY29udGVudC5vZmZzZXRXaWR0aCkpCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIHN1Yi5Db25mSGVpZ2h0KGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodC0yKmh0bWwuQUNUSU9OX0hFSUdIVCkpCgkJCQljYW4ub25tb3Rpb24uZGVsYXkoY2FuLCBmdW5jdGlvbigpIHsKCQkJCQljYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5PUFRJT05fQVJHUylbMF0pCgkJCQl9KSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgkJCX0pCgkJCXJldHVybgoJCX0KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmNvbnRlbnQpCgkJZnVuY3Rpb24gaW5pdChwKSB7IGNhbi5tYXggPSAwLCBjYW4uY29yZS5MaXN0KGNhbi5scyA9IG1zZy5SZXN1bHQoKS5zcGxpdChpY2UuTkwpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5vbmFjdGlvbi5hcHBlbmRMaW5lKGNhbiwgaXRlbSkKCQl9KSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUobnVsbCwgY2FuLCBtc2cuT3B0aW9uKG5mcy5MSU5FKSksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJCQltc2cuT3B0aW9uKG5mcy5GSUxFKS5pbmRleE9mKCJ3ZWJzaXRlLyIpID09IDAgJiYgY2FuLm9uYWN0aW9uWyLlsZXnpLoiXSh7fSwgY2FuKQoJCQlpZiAoY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGNhbi5fZmllbGRzLCBjaGF0LlBMVUdJTikpIHsKCQkJCXAgJiYgcC5yZW5kZXIgJiYgY2FuLm9uYWN0aW9uWyLlsZXnpLoiXSh7fSwgY2FuKQoJCQkJcCAmJiBwLmVuZ2luZSAmJiBjYW4ub25hY3Rpb25bIuaJp+ihjCJdKHt9LCBjYW4pCgkJCX0KCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGNhbi5fZmllbGRzLCBjaGF0LlNUT1JZKSAmJiAhY2FuLnVzZXIubW9kLmlzQ21kKSB7CgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5wcm9qZWN0LCBodG1sLk1JTl9IRUlHSFQsIGNhbi5Db25mSGVpZ2h0KCktMjAwKQoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5NSU5fSEVJR0hULCBjYW4uQ29uZkhlaWdodCgpLTIwMCkKCQkJfQoJCX0KCQljYW4uQ29uZigicGx1ZyIpICYmIChjYW4ub25zeW50YXhbY2FuLnBhcnNlXSA9IGNhbi5Db25mKCJwbHVnIikpCgkJdmFyIHAgPSBjYW4ub25zeW50YXhbY2FuLnBhcnNlXTsgIXA/IGNhbi5ydW4oe30sIFtjdHguQUNUSU9OLCBtZGIuUExVR0lOLCBjYW4ucGFyc2UsIG1zZy5PcHRpb24obmZzLkZJTEUpLCBtc2cuT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgewoJCQlpbml0KHAgPSBjYW4ub25zeW50YXhbY2FuLnBhcnNlXSA9IGNhbi5iYXNlLk9iaihtc2cuUmVzdWx0KCkpKQoJCX0sIHRydWUpOiBpbml0KHApCgl9LAoJX3BhcnNlOiBmdW5jdGlvbihjYW4sIGxpbmUpIHsgaWYgKGxpbmUuaW5kZXhPZigiPGh0bWwiKSA9PSAwKSB7IHJldHVybiBsaW5lIH0KCQlsaW5lID0gY2FuLnBhZ2UucmVwbGFjZShjYW4sIGxpbmV8fCIiKQoKCQlmdW5jdGlvbiB3cmFwKHR5cGUsIHN0cikgeyByZXR1cm4gdHlwZT8gJzxzcGFuIGNsYXNzPSInK3R5cGUrJyI+JytzdHIrJzwvc3Bhbj4nOiBzdHIgfQoJCXZhciBwID0gY2FuLm9uc3ludGF4W2Nhbi5wYXJzZV07IGlmICghcCkgeyByZXR1cm4gbGluZSB9IHAgPSBjYW4ub25zeW50YXhbcC5saW5rXXx8cCwgcC5zcGxpdCA9IHAuc3BsaXR8fHt9CgkJcC5rZXl3b3JkICYmIChsaW5lID0gY2FuLmNvcmUuTGlzdChjYW4uY29yZS5TcGxpdChsaW5lLCBwLnNwbGl0LnNwYWNlfHwiXHQgIiwgcC5zcGxpdC5vcGVyYXRvcnx8IntbKC4sOjshfDw+KV19Iiwge2RldGFpbDogdHJ1ZX0pLCBmdW5jdGlvbihpdGVtLCBpbmRleCwgYXJyYXkpIHsKCQkJaXRlbSA9IGNhbi5iYXNlLmlzT2JqZWN0KGl0ZW0pPyBpdGVtOiB7dGV4dDogaXRlbX0KCQkJdmFyIHRleHQgPSBpdGVtLnRleHQ7IHZhciB0eXBlID0gaXRlbS5rZXl3b3JkfHxwLmtleXdvcmRbdGV4dF0KCgkJCXN3aXRjaCAoaXRlbS50eXBlKSB7IGNhc2UgaHRtbC5TUEFDRTogcmV0dXJuIHRleHQKCQkJCWNhc2UgbGFuZy5TVFJJTkc6IHJldHVybiB3cmFwKGxhbmcuU1RSSU5HLCBpdGVtLmxlZnQrdGV4dCtpdGVtLnJpZ2h0KQoJCQkJZGVmYXVsdDogcmV0dXJuIHdyYXAodHlwZSwgdGV4dCkKCQkJfQoJCX0pLmpvaW4oIiIpKQoKCQlwLnByZWZpeCAmJiBjYW4uY29yZS5JdGVtKHAucHJlZml4LCBmdW5jdGlvbihwcmUsIHR5cGUpIHsKCQkJaWYgKGNhbi5iYXNlLmJlZ2luV2l0aChsaW5lLCBwcmUpKSB7CgkJCQlsaW5lID0gd3JhcCh0eXBlLCBsaW5lKQoJCQl9IGVsc2UgewoJCQkJdmFyIGxzID0gbGluZS5zcGxpdChwcmUpOyBpZiAobHMubGVuZ3RoID4gMSkgewoJCQkJCWxpbmUgPSBsc1swXSArIHdyYXAodHlwZSwgcHJlICsgbHNbMV0pCgkJCQl9CgkJCX0KCQl9KQoJCXAuc3VmZml4ICYmIGNhbi5jb3JlLkl0ZW0ocC5zdWZmaXgsIGZ1bmN0aW9uKGVuZCwgdHlwZSkgewoJCQlpZiAoY2FuLmJhc2UuZW5kV2l0aChsaW5lLCBlbmQpKSB7IGxpbmUgPSB3cmFwKHR5cGUsIGxpbmUpIH0KCQl9KQoJCXJldHVybiBsaW5lCgl9LAp9KQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHt9LAoJX25vcm1hbDogZnVuY3Rpb24oZXZlbnQsIGNhbikge30sCglfaW5zZXJ0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7fSwKCV9tb2RlOiB7CgkJcGx1Z2luOiB7CgkJCUVzY2FwZTogc2h5KCLmuIXlsY8iLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5riF5bGPIikgfSksCgkJCWc6IHNoeSgi5pCc57SiIiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuaQnOe0oiIpIH0pLAoJCQlmOiBzaHkoIuaJk+W8gOaWh+S7tiIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmiZPlvIAiKSB9KSwKCQkJdDogc2h5KCLmt7vliqDlkb3ku6QiLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5re75YqgIikgfSksCgkJCXA6IHNoeSgi5re75Yqg5o+S5Lu2IiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuaPkuS7tiIpIH0pLAoJCQllOiBzaHkoIua3u+WKoOaJqeWxlSIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmianlsZUiKSB9KSwKCgkJCW06IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICJhdXRvZ2VuIikgfSwKCQkJYzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgImNvbXBpbGUiKSB9LAoJCQl3OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAid2Vic2l0ZSIpIH0sCgoJCQlyOiBzaHkoIuaJp+ihjOWRveS7pCIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmiafooYwiKSB9KSwKCQkJdjogc2h5KCLlsZXnpLoiLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5bGV56S6IikgfSksCgkJCWE6IHNoeSgi5YWo5bGPIiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuWFqOWxjyIpIH0pLAoKCQkJajogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uY3VycmVudC5zY3JvbGwoMSkgfSwKCQkJazogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uY3VycmVudC5zY3JvbGwoLTEpIH0sCgkJCUo6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKGNhbi5jdXJyZW50LndpbmRvdygpLTMpIH0sCgkJCUs6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKC1jYW4uY3VycmVudC53aW5kb3coKSszKSB9LAoKCQkJaTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSB9LAoJCQluOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fbm9ybWFsKGV2ZW50LCBjYW4pIH0sCgkJCSI6IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIHtpbmRleDogImNsaS5zeXN0ZW0ifSwgZnVuY3Rpb24oc3ViKSB7IGNhbi50b29sa2l0WyJjbGkuc3lzdGVtIl0gPSBzdWIuc2VsZWN0KCkgfSkgfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5o6n5Lu25Lqk5LqSIiwgbGlzdDogWyLmkJzntKIiLCAi5omT5byAIiwgIua3u+WKoCIsICLmj5Lku7YiLCAi5omp5bGVIl0sCglfdHJhbnM6IHt3aWR0aDogIuWuveW6piIsIGhlaWdodDogIumrmOW6piIsIHdlYnNpdGU6ICLnvZHpobUifSwKCSLliqDovb0iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIGZpbGUgPSBjYW4uYmFzZS5QYXRoKCIvcmVxdWlyZS8iLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpCgkJZGVsZXRlKFZvbGNhbm9zLm1ldGEuY2FjaGVbZmlsZV0pLCBldmFsKGBcbl9jYW5fbmFtZSA9ICJgK2ZpbGUrYCJcbmArY2FuLm9uZXhwb3J0LmNvbnRlbnQoY2FuKStgXG5fY2FuX25hbWUgPSAiIlxuY29uc29sZS5sb2coIm9uY2UiKWApCgl9LAoJIuWIt+aWsCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCAic3JjLyIsICJtYWluLmdvIiwgIiIsIGZ1bmN0aW9uKCkge30sIHNraXApIH0sCgki5pCc57SiIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFttZGIuTkFNRSwgW2N0eC5BQ1RJT04sIG5mcy5UQUdTLCBuZnMuR1JFUCwgY2xpLk1BS0VdXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQljYW4udWkuc2VhcmNoLlVwZGF0ZSh7fSwgW2N0eC5BQ1RJT04sIGRhdGEuYWN0aW9uLCBkYXRhLm5hbWVdKQoJCX0pCgl9LAoJIuaJk+W8gCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbmZzLkZJTEVdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGRhdGEuZmlsZSkKCQkJY2FuLm9uaW1wb3J0LnByb2plY3QoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkKCQl9KQoJfSwKCSLmt7vliqAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW2N0eC5JTkRFWF0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEpIHsKCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgZGF0YS5pbmRleCwgY3R4LklOREVYKQoJCX0pCgl9LAoJIuaPkuS7tiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbY3R4LklOREVYXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQl2YXIgc3ViID0gY2FuLnRvb2xraXRbZGF0YS5pbmRleF07IGlmIChzdWIpIHsgc3ViLnNlbGVjdCgpOyByZXR1cm4gfQoJCQljYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIGRhdGEsIGZ1bmN0aW9uKHN1YikgeyBjYW4udG9vbGtpdFtkYXRhLmluZGV4XSA9IHN1Yi5zZWxlY3QoKSB9KQoJCX0pCgl9LAoJIuaJqeWxlSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbInVybCJdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCXZhciBzdWIgPSBjYW4uZXh0ZW50aW9uc1tkYXRhLnVybF07IGlmIChzdWIpIHsgc3ViLnNlbGVjdCgpOyByZXR1cm4gfQoJCQljYW4ub25pbXBvcnQuZXh0cyhjYW4sIGRhdGEudXJsLCBmdW5jdGlvbihzdWIpIHsgY2FuLmV4dGVudGlvbnNbZGF0YS51cmxdID0gc3ViLnNlbGVjdCgpIH0pCgkJfSkKCX0sCgki5L+d5a2YIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25leHBvcnQuc2VzcyhjYW4pLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9LAoJIumhueebriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi51aS5wcm9qZWN0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIH0sCgki5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLnVpLnRvb2xraXQuZmllbGRzZXQpIH0sCgki5omn6KGMIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQuZGlzcGxheShjYW4pLCBjYW4ucmVxdWVzdChldmVudCwge190b2FzdDogIuaJp+ihjOS4rS4uLiJ9KQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuRU5HSU5FLCBjYW4ucGFyc2UsIGNhbi5PcHRpb24obmZzLkZJTEUpLCBjYW4uT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQuX3N0YXR1cyhjYW4sIG1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMpLCBjYW4udWkuZGlzcGxheV9zdGF0dXMpCgkJCWNhbi5vbmltcG9ydC5kaXNwbGF5KGNhbiwgbXNnKSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIAoJCX0sIHRydWUpCgl9LAoJIuWxleekuiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0LnByb2ZpbGUoY2FuKSwgY2FuLnJlcXVlc3QoZXZlbnQsIHtfdG9hc3Q6ICLmuLLmn5PkuK0uLi4ifSkKCQlpZiAoY2FuLk9wdGlvbihuZnMuRklMRSkuaW5kZXhPZigid2Vic2l0ZS8iKSA9PSAwKSB7CgkJCWNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBjYW4ucHJvZmlsZV9zaXplW2Nhbi5vbmV4cG9ydC5rZXlzKGNhbildIHx8IGNhbi5Db25mV2lkdGgoKSpwYXJzZUludCg3MCkvMTAwCgkJfQoJCWNhbi5wYXJzZSA9PSAianMiICYmIGNhbi5vbmFjdGlvblsi5Yqg6L29Il0oZXZlbnQsIGNhbikKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlJFTkRFUiwgY2FuLnBhcnNlLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuUEFUSCldLCBmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm9uaW1wb3J0LnByb2ZpbGUoY2FuLCBtc2cpCgkJfSwgdHJ1ZSkKCX0sCgki5riF5bGPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBkb2N1bWVudC5ib2R5LCAiLmlucHV0LmZsb2F0IiwgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaXRlbSkKCQl9KS5sZW5ndGggPiAwKSB7IHJldHVybiB9CgoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkudG9vbGtpdC5zdGF0dXMsICJsZWdlbmQuc2VsZWN0IiwgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gaXRlbS5jbGljaygpLCBpdGVtCgkJfSkubGVuZ3RoID4gMCkgeyByZXR1cm4gfQoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX3N0YXR1cywgImxlZ2VuZC5zZWxlY3QiLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiBpdGVtLmNsaWNrKCksIGl0ZW0KCQl9KS5sZW5ndGggPiAwKSB7IHJldHVybiB9CgoJCWlmIChjYW4udWkucHJvZmlsZS5zdHlsZS5kaXNwbGF5ID09ICIiKSB7CgkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkucHJvZmlsZSkKCQl9IGVsc2UgaWYgKGNhbi51aS5kaXNwbGF5LnN0eWxlLmRpc3BsYXkgPT0gIiIpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCX0gZWxzZSBpZiAoY2FuLnVpLnByb2plY3Quc3R5bGUuZGlzcGxheSA9PSAiIikgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgkJfSBlbHNlIHsKCQkJY2FuLm9uYWN0aW9uWyLlhajlsY8iXShldmVudCwgY2FuKQoJCX0KCQljYW4ub25pbXBvcnQubGF5b3V0KGNhbikKCX0sCgki5YWo5bGPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgY2FuLl9maWVsZHMsICJmdWxsIikpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQpCgkJfSBlbHNlIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0LCB0cnVlKQoJCQljYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQtMipodG1sLkFDVElPTl9IRUlHSFQpCgkJfQoJCWNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJfSwKCWJhY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmhpc3RvcnkucG9wKCk7IHZhciBsYXN0ID0gY2FuLmhpc3RvcnkucG9wKCkKCQlsYXN0ICYmIGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbGFzdC5wYXRoLCBsYXN0LmZpbGUsIGxhc3QubGluZSkKCQljYW4uU3RhdHVzKCLot7PovazmlbAiLCBjYW4uaGlzdG9yeS5sZW5ndGgpCgl9LAoKCXNjcm9sbExpbmU6IGZ1bmN0aW9uKGNhbiwgY291bnQpIHsgdmFyIHNpemUgPSAyMDsgY2FuLmN1cnJlbnQuc2Nyb2xsKGNvdW50KnNpemUpIH0sCglhcHBlbmRMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7CgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmNvbnRlbnQsIFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQl7dmlldzogWyJsaW5lIHVuc2VsZWN0YWJsZSIsIGh0bWwuVEQsICsrY2FuLm1heF0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCB1aS50cikKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbi5mYXZvckxpbmUoY2FuLCB1aS50ZXh0LmlubmVyVGV4dCkKCQkJfX0sCgoJCQl7dmlldzogW2h0bWwuVEVYVCwgaHRtbC5URF0sIGxpc3Q6IFtjYW4ub25zeW50YXguX3BhcnNlKGNhbiwgdmFsdWUpXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIHVpLnRyKQoKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciBzID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKSwgc3RyID0gdWkudGV4dC5pbm5lclRleHQKCQkJCXZhciBiZWdpbiA9IHN0ci5pbmRleE9mKHMpLCBlbmQgPSBiZWdpbitzLmxlbmd0aAoKCQkJCWZvciAodmFyIGkgPSBiZWdpbjsgaSA+PSAwOyBpLS0pIHsKCQkJCQlpZiAoc3RyW2ldLm1hdGNoKC9bYS16QS1aMC05Xy5dLykpIHsgcyA9IHN0ci5zbGljZShpLCBlbmQpIH0gZWxzZSB7IGJyZWFrIH0KCQkJCX0KCgkJCQlpZiAocy5pbmRleE9mKCJraXQuIikgPT0gMCkgeyBzID0gcy5yZXBsYWNlKCJraXQuIiwgInRvb2xraXRzLiIpIH0KCQkJCWlmIChzLmluZGV4T2YoIi4iKSA9PSAwKSB7IHMgPSBzLnNsaWNlKDEpIH0KCQkJCWNhbi5vbmFjdGlvbi5zZWFyY2hMaW5lKGV2ZW50LCBjYW4sIHMpCgkJCX19CgkJXX1dKTsgcmV0dXJuIHVpLnRyCgl9LAoJX2dldExpbmU6IGZ1bmN0aW9uKGNhbiwgbGluZSkgewoJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycmF5KSB7IGlmIChpdGVtID09IGxpbmUgfHwgaW5kZXgrMSA9PSBsaW5lKSB7IHJldHVybiBpdGVtIH0gfSlbMF0KCX0sCglfZ2V0TGluZW5vOiBmdW5jdGlvbihjYW4sIGxpbmUpIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVFIsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnJheSkgeyBpZiAoaXRlbSA9PSBsaW5lIHx8IGluZGV4KzEgPT0gbGluZSkgeyByZXR1cm4gaW5kZXgrMSB9IH0pWzBdCgl9LAoJc2VsZWN0TGluZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbGluZSkgeyBpZiAoIWxpbmUpIHsgcmV0dXJuIHBhcnNlSW50KGNhbi5jb3JlLlZhbHVlKGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBbW1todG1sLlRSLCBodG1sLlNFTEVDVF0sIFtodG1sLlRELCAibGluZSJdXV0pWzBdLCAiaW5uZXJUZXh0IikpIH0KCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycmF5KSB7IGlmIChsaW5lIDwgMCB8fCBsaW5lID4gYXJyYXkubGVuZ3RoKSB7IHJldHVybiB9CgkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIGl0ZW0sIGh0bWwuU0VMRUNULCBpdGVtID09IGxpbmUgfHwgaW5kZXgrMSA9PSBsaW5lKSkgeyByZXR1cm4gfQoJCQl2YXIgbHMgPSBjYW4uZmlsZS5zcGxpdChpY2UuUFMpCgkJCWlmIChscy5sZW5ndGggPiA0KSB7IGxzID0gW2xzLnNsaWNlKDAsIDIpLmpvaW4oaWNlLlBTKSsiLy4uLi8iK2xzLnNsaWNlKC0yKS5qb2luKGljZS5QUyldIH0KCQkJbGluZSA9IGl0ZW0sIGNhbi5TdGF0dXMoa2l0LkRpY3QoIuaWh+S7tuWQjSIsIGxzLmpvaW4oaWNlLlBTKSwgIuino+aekOWZqCIsIGNhbi5wYXJzZSwgIuW9k+WJjeihjCIsIGNhbi5vbmV4cG9ydC5wb3NpdGlvbihjYW4sIGNhbi5PcHRpb24obmZzLkxJTkUsIGluZGV4KzEpKSkpCgkJfSkKCgkJY2FuLmJhc2UuaXNPYmplY3QobGluZSkgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgbGluZSwgInRkLnRleHQiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5jdXJyZW50ID0gewoJCQkJd2luZG93OiBmdW5jdGlvbigpIHsgcmV0dXJuIHBhcnNlSW50KGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodC9jYW4uY3VycmVudC5saW5lLm9mZnNldEhlaWdodCkgfSwKCQkJCXNjcm9sbDogZnVuY3Rpb24oY291bnQpIHsgaWYgKGNvdW50KSB7IGNhbi51aS5jb250ZW50LnNjcm9sbFRvcCArPSBjb3VudCpjYW4uY3VycmVudC5saW5lLm9mZnNldEhlaWdodCB9CgkJCQkJcmV0dXJuIHBhcnNlSW50KChjYW4uY3VycmVudC5saW5lLm9mZnNldFRvcC1jYW4udWkuY29udGVudC5zY3JvbGxUb3ApL2Nhbi5jdXJyZW50LmxpbmUub2Zmc2V0SGVpZ2h0KQoJCQkJfSwKCgkJCQlwcmV2OiBmdW5jdGlvbigpIHsgcmV0dXJuIGxpbmUucHJldmlvdXNTaWJsaW5nIH0sCgkJCQluZXh0OiBmdW5jdGlvbigpIHsgcmV0dXJuIGxpbmUubmV4dFNpYmxpbmcgfSwKCQkJCWxpbmU6IGxpbmUsIHRleHQ6IGZ1bmN0aW9uKHRleHQpIHsKCQkJCQlyZXR1cm4gdGV4dCAhPSB1bmRlZmluZWQgJiYgY2FuLm9uYWN0aW9uLm1vZGlmeUxpbmUoY2FuLCBsaW5lLCB0ZXh0KSwgaXRlbS5pbm5lclRleHQKCQkJCX0sCgkJCX0KCgkJCWlmICghZXZlbnQpIHsKCQkJCXZhciBzY3JvbGwgPSBjYW4uY3VycmVudC5zY3JvbGwoKTsgaWYgKHNjcm9sbCA8IDUpIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKHNjcm9sbC01KSB9IGVsc2UgewoJCQkJCXZhciB3aW5kb3cgPSBjYW4uY3VycmVudC53aW5kb3coKTsgaWYgKHNjcm9sbCA+IHdpbmRvdy8yKSB7IGNhbi5jdXJyZW50LnNjcm9sbChzY3JvbGwtd2luZG93LzIpIH0KCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXZhciBzY3JvbGwgPSBjYW4uY3VycmVudC5zY3JvbGwoKTsgaWYgKHNjcm9sbCA8IDMpIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKHNjcm9sbC0zKSB9IGVsc2UgewoJCQkJCXZhciB3aW5kb3cgPSBjYW4uY3VycmVudC53aW5kb3coKTsgaWYgKHNjcm9sbCA+IHdpbmRvdy00KSB7IGNhbi5jdXJyZW50LnNjcm9sbChzY3JvbGwtd2luZG93KzQpIH0KCQkJCX0KCQkJfQoKCQkJdmFyIHB1c2ggPSB7cGF0aDogY2FuLk9wdGlvbihuZnMuUEFUSCksIGZpbGU6IGNhbi5PcHRpb24obmZzLkZJTEUpLCBsaW5lOiBjYW4uT3B0aW9uKG5mcy5MSU5FKSwgdGV4dDogY2FuLmN1cnJlbnQudGV4dCgpfQoJCQljYW4uYmFzZS5FcSh7cGF0aDogcHVzaC5wYXRoLCBmaWxlOiBwdXNoLmZpbGUsIGxpbmU6IHB1c2gubGluZX0sIGNhbi5oaXN0b3J5W2Nhbi5oaXN0b3J5Lmxlbmd0aC0xXSkgfHwgY2FuLmhpc3RvcnkucHVzaChwdXNoKQoJCQljYW4uU3RhdHVzKCLot7PovazmlbAiLCBjYW4uaGlzdG9yeS5sZW5ndGgpCgkJCWNhbi5vbmFjdGlvbi5fc2VsZWN0TGluZShldmVudCwgY2FuKQoJCX0pCgl9LAoJX3NlbGVjdExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgfSwKCXNlYXJjaExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHZhbHVlKSB7IGlmICghY2FuLnVpLnNlYXJjaCkgeyByZXR1cm4gfQoJCWNhbi51aS5zZWFyY2guVXBkYXRlKGV2ZW50LCBbY3R4LkFDVElPTiwgbmZzLlRBR1MsIHZhbHVlLnRyaW0oKV0pCgl9LAoJZmF2b3JMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiAiem9uZSIsIHZhbHVlOiAiaGkifSwge25hbWU6ICJuYW1lIiwgdmFsdWU6ICJoZWxsbyJ9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY29kZS5GQVZPUiwgY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgbWRiLlpPTkUsIGRhdGEuem9uZXx8IiIsCgkJCQltZGIuVFlQRSwgY2FuLnBhcnNlLCBtZGIuTkFNRSwgZGF0YS5uYW1lfHwiIiwgbWRiLlRFWFQsICh2YWx1ZXx8IiIpLnRyaW1SaWdodCgpLAoJCQkJbmZzLlBBVEgsIGNhbi5PcHRpb24obmZzLlBBVEgpLCBuZnMuRklMRSwgY2FuLk9wdGlvbihuZnMuRklMRSksIG5mcy5MSU5FLCBjYW4uT3B0aW9uKG5mcy5MSU5FKSwKCQkJXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pIH0sIHRydWUpCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyLmlofku7bmlbAiLCAi6Kej5p6Q5ZmoIiwgIuaWh+S7tuWQjSIsICLlvZPliY3ooYwiLCAi6Lez6L2s5pWwIiwgIuagh+etvuaVsCJdLAoJc2VzczogZnVuY3Rpb24oY2FuKSB7CgkJbG9jYWxTdG9yYWdlLnNldEl0ZW0oIndlYi5jb2RlLmlubmVyLnNlc3MiLCBKU09OLnN0cmluZ2lmeSh7CgkJCSJ0YWJzIjogY2FuLm9uZXhwb3J0LnRhYnMoY2FuKSwgInBsdWciOiBjYW4ub25leHBvcnQucGx1ZyhjYW4pLCAiZXh0cyI6IGNhbi5vbmV4cG9ydC5leHRzKGNhbiksCgkJfSkpCgl9LAoJa2V5czogZnVuY3Rpb24oY2FuLCBmaWxlLCBwYXRoKSB7IHJldHVybiAocGF0aHx8Y2FuLk9wdGlvbihuZnMuUEFUSCkpKyI6IisoZmlsZXx8Y2FuLk9wdGlvbihuZnMuRklMRSkpIH0sCgl0YWJzOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnRhYnZpZXcsIGZ1bmN0aW9uKGtleSwgbXNnKSB7IHJldHVybiBrZXkraWNlLkRGK21zZy5PcHRpb24obmZzLkxJTkUpIH0pIH0sCglwbHVnOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnRvb2xraXQpIH0sCglleHRzOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnBsdWdpbnMpIH0sCglwb3NpdGlvbjogZnVuY3Rpb24oY2FuLCBpbmRleCwgdG90YWwpIHsgdG90YWwgPSB0b3RhbHx8Y2FuLm1heAoJCXJldHVybiAocGFyc2VJbnQoaW5kZXgpKStpY2UuUFMrcGFyc2VJbnQodG90YWwpKyIgPSAiK3BhcnNlSW50KChpbmRleCkqMTAwL3RvdGFsKSsiJSIKCX0sCgljb250ZW50OiBmdW5jdGlvbihjYW4pIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ZC50ZXh0IiwgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS5pbm5lclRleHQgfSkuam9pbihpY2UuTkwpCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL3N0YXRlLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBjb25mLCBsaXN0LCBjYiwgdGFyZ2V0KSB7fSwKCV9wcm9jZXNzOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCW1zZy5PcHRpb25TdGF0dXMoKSAmJiBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uX3N0YXR1cykgJiYgY2FuLm9uYXBwZW5kLl9zdGF0dXMoY2FuLCBjYW4uYmFzZS5PYmoobXNnLk9wdGlvblN0YXR1cygpKSkKCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmltcG9ydCwgbXNnLk9wdGlvblByb2Nlc3MoKV0sIFtjYW4sIG1zZ10pCgl9LAoKCV9jb25maXJtOiBmdW5jdGlvbihjYW4sIG1zZywgX2FyZykgeyB2YXIgc3ViID0gY2FuLnJlcXVlc3Qoe30sIGNhbi5PcHRpb24oKSkKCQlpZiAoY2FuLnVzZXIuY29uZmlybShfYXJnKSkgeyBjYW4ucnVuKHN1Yi5fZXZlbnQsIFtjdHguQUNUSU9OLCAiY29uZmlybSJdLCBmdW5jdGlvbigpIHt9LCB0cnVlKSB9Cgl9LAoJX2xvY2F0aW9uOiBmdW5jdGlvbihjYW4sIG1zZykgeyBsb2NhdGlvbi5ocmVmID0gbXNnLl9hcmdbMF0gfSwKCV9yZXBsYWNlOiBmdW5jdGlvbihjYW4sIG1zZykgeyBsb2NhdGlvbi5yZXBsYWNlKG1zZy5fYXJnWzBdKSB9LAoJX2hpc3Rvcnk6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGhpc3RvcnkuYmFjaygpIH0sCglfcmV3cml0ZTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQlmb3IgKHZhciBpID0gMDsgaSA8IG1zZy5fYXJnLmxlbmd0aDsgaSArPSAyKSB7CgkJCWNhbi5PcHRpb24obXNnLl9hcmdbaV0sIG1zZy5fYXJnW2krMV0pCgkJCWNhbi5BY3Rpb24obXNnLl9hcmdbaV0sIG1zZy5fYXJnW2krMV0pCgkJfQoJCWNhbi5VcGRhdGUoKQoJCXJldHVybiB0cnVlCgl9LAoJX3JlZnJlc2g6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQobXNnLk9wdGlvbigiX2RlbGF5Iil8fCI1MDAiKSwgZnVuY3Rpb24oKSB7CgkJCXZhciBzdWIgPSBjYW4ucmVxdWVzdCh7fSwge19jb3VudDogcGFyc2VJbnQobXNnLk9wdGlvbigiX2NvdW50IikpLTF9KQoJCQljYW4uVXBkYXRlKCkKCQl9KQoJCXJldHVybiB0cnVlCgl9LAoJX2Rpc3BsYXk6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJVm9sY2Fub3MoInNvbWUiLCB7fSwgW21zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKV0uY29uY2F0KFZvbGNhbm9zLm1ldGEubGlicywgVm9sY2Fub3MubWV0YS52b2xjYW5vKSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5Db25mKGNhbi5Db25mKCkpLCBzdWIucnVuID0gY2FuLnJ1bgoJCQlzdWIuX29wdGlvbiA9IGNhbi5fb3B0aW9uLCBzdWIuX2FjdGlvbiA9IGNhbi5fYWN0aW9uCgkJCXN1Yi5vbmltcG9ydC5faW5pdChzdWIsIG1zZywgW10sIGZ1bmN0aW9uKCkge30sIGNhbi5fb3V0cHV0KQoJCX0pCgkJcmV0dXJuIHRydWUKCX0sCglfZmllbGQ6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS50eXBlID0gY2hhdC5TVE9SWSwgY2FuLm9uYXBwZW5kLl9wbHVnaW4oY2FuLCBpdGVtLCB7dHlwZTogY2hhdC5TVE9SWSwgYXJnOiBjYW4uYmFzZS5PYmooaXRlbVtpY2UuQVJHXSwgW10pfSwgZnVuY3Rpb24oc3ViLCBtZXRhKSB7CgkJCXN1Yi5Db25mKGNhbi5iYXNlLk9iaihpdGVtLmNvbmYpKQoJCQlpZiAoc3ViLkNvbmYoIm1vZGUiKSA9PSAic2ltcGxlIikgewoJCQkJdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KCkKCQkJCW1zZy5FY2hvKHN1Yi5Db25mKCJyZXN1bHQiKSkKCQkJCXN1Yi5Db25mKGh0bWwuSEVJR0hULCBjYW4uQ29uZihodG1sLkhFSUdIVCkvMikKCQkJCWNhbi5vbmFwcGVuZC5fb3V0cHV0KHN1YiwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSl8fHN1Yi5Db25mKCJmZWF0dXJlLmRpc3BsYXkiKXx8Ii9wbHVnaW4vdGFibGUuanMiKQoJCQkJcmV0dXJuCgkJCX0KCQkJdmFyIG9wdCA9IGNhbi5iYXNlLk9iaihpdGVtW2ljZS5PUFRdLCBbXSkKCQkJc3ViLkNvbmYoaHRtbC5IRUlHSFQsIGNhbi5Db25mKGh0bWwuSEVJR0hUKSkKCQkJc3ViLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCktNCpodG1sLlBMVUdJTl9NQVJHSU4pCgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgewoJCQkJdmFyIHJlcyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCBjYW4uT3B0aW9uKCkpCgkJCQlmb3IgKHZhciBpID0gMDsgaSA8IG9wdC5sZW5ndGg7IGkgKz0gMikgeyByZXMuT3B0aW9uKG9wdFtpXSwgb3B0W2krMV0pIH0KCQkJCWNhbi5ydW4oZXZlbnQsIChtc2dbaWNlLk1TR19QUkVGSVhdfHxbXSkuY29uY2F0KGNtZHMpLCBjYiwgdHJ1ZSkKCQkJfQoJCX0pIH0pCgkJcmV0dXJuIHRydWUKCX0sCglfaW5uZXI6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZykKCQljYW4ub25tb3Rpb24uc3RvcnkuYXV0byhjYW4pCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLl9vdXRwdXQsIHtzdHlsZToge2Rpc3BsYXk6IGh0bWwuQkxPQ0t9fSkKCQlyZXR1cm4gdHJ1ZQoJfSwKCglfb3BlbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQljYW4udXNlci5vcGVuKG1zZy5PcHRpb24oIl9hcmciKSksIGNhbi5VcGRhdGUoKQoJCXJldHVybiB0cnVlCgl9LAoJX2hvbGQ6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IHJldHVybiB0cnVlIH0sCglfYmFjazogZnVuY3Rpb24oY2FuKSB7CgkJY2FuLl9oaXN0b3J5LnBvcCgpOyBmb3IgKHZhciBoaXMgPSBjYW4uX2hpc3RvcnkucG9wKCk7IGhpczsgaGlzID0gY2FuLl9oaXN0b3J5LnBvcCgpKSB7IGlmIChoaXNbMF0gPT0gY3R4LkFDVElPTikgeyBjb250aW51ZSB9CgkJCXZhciBpbmRleCA9IDAKCQkJY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGNhbi5fb3B0aW9uLCAiIiwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLnZhbHVlID0gaGlzW2luZGV4KytdfHwiIiB9KQoJCQljYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgY2FuLl9hY3Rpb24sICIiLCBmdW5jdGlvbihpdGVtKSB7IGl0ZW0udmFsdWUgPSBoaXNbaW5kZXgrK118fCIiIH0pCgkJCWNhbi5VcGRhdGUoKQoJCQlicmVhawoJCX0KCQkhaGlzICYmIGNhbi5VcGRhdGUoKQoJCXJldHVybiB0cnVlCgl9LAoKCV9ncm93OiBmdW5jdGlvbihjYW4sIHN0cikgewoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgImRpdi5jb2RlIiwgZnVuY3Rpb24oZGl2KSB7CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGRpdiwge3N0eWxlOiB7Im1heC1oZWlnaHQiOiA0MDB9fSkKCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgZGl2LCBbe3RleHQ6IFtzdHJdfV0pCgkJCWRpdi5zY3JvbGxCeSgwLCAxMDAwMCkKCQkJcmV0dXJuIHRydWUKCQl9KS5sZW5ndGggPT0gMCkgewoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBzdHIpCgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLkuqTkupLmk43kvZwiLCBsaXN0OiBbCgkJIuWFseS6q+W3peWFtyIsICLliLfmlrDmlbDmja4iLCAi5YiH5o2i5YWo5bGPIiwgIuaJk+W8gOmTvuaOpSIsICLnlJ/miJDpk77mjqUiLCAi55Sf5oiQ5Zu+54mHIiwgIueUn+aIkOiEmuacrCIsIFsKCQkJIuWFtuWugyIsICLmianlsZXlj4LmlbAiLCAi5riF56m65Y+C5pWwIiwgIuWkjeWItuaVsOaNriIsICLkuIvovb3mlbDmja4iLCAi5riF56m65pWw5o2uIiwgIuWIoOmZpOW3peWFtyIsCgkJXSwKCV0sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkge30sCglfZW5naW5lOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgY2FuLlVwZGF0ZShldmVudCwgW2N0eC5BQ1RJT04sIGJ1dHRvbl0uY29uY2F0KGNhbi5JbnB1dChbXSwgdHJ1ZSkpKSB9LAoKCSLmianlsZXlj4LmlbAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi5fYWN0aW9uKQoJfSwKCSLlhbHkuqvlt6XlhbciOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKQoJCWNhbi5vbm1vdGlvbi5zaGFyZShldmVudCwgY2FuLCBbe25hbWU6IGNoYXQuVElUTEUsIHZhbHVlOiBtZXRhLm5hbWV9LCB7bmFtZTogY2hhdC5UT1BJQywgdmFsdWVzOiBbY2xpLldISVRFLCBjbGkuQkxBQ0tdfV0sIFsKCQkJbWRiLk5BTUUsIG1ldGEuaW5kZXgsIG1kYi5URVhULCBKU09OLnN0cmluZ2lmeShjYW4uSW5wdXQoW10sIHRydWUpKSwKCQldKQoJfSwKCSLliIfmjaLlhajlsY8iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBzdWIgPSBjYW4uX291dHB1dHNbY2FuLl9vdXRwdXRzLmxlbmd0aC0xXQoJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgY2FuLl90YXJnZXQsICJGdWxsIikpIHsKCQkJc3ViLl9oZWlnaHRfYmFrID0gc3ViLkNvbmZIZWlnaHQoKSwgc3ViLl93aWR0aF9iYWsgPSBzdWIuQ29uZldpZHRoKCkKCQkJdmFyIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodC0oY2FuLl9zdGF0dXMuaW5uZXJUZXh0PyAyOiAxKSpodG1sLkFDVElPTl9IRUlHSFQKCQkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgKGhlaWdodCAtPSAyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4uX291dHB1dCwgImhlaWdodCIsIHN1Yi5Db25mSGVpZ2h0KGhlaWdodCksICJtaW4td2lkdGgiLCBzdWIuQ29uZldpZHRoKHdpbmRvdy5pbm5lcldpZHRoKSkKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW3N1YiwgIm9uaW1wb3J0LmxheW91dCJdLCB7Y2FuOiBzdWJ9KQoJCX0gZWxzZSB7CgkJCXN1Yi5Db25mSGVpZ2h0KHN1Yi5faGVpZ2h0X2JhayksIHN1Yi5Db25mV2lkdGgoc3ViLl93aWR0aF9iYWspCgkJCWNhbi5jb3JlLkNhbGxGdW5jKFtzdWIsICJvbmltcG9ydC5sYXlvdXQiXSwge2Nhbjogc3VifSkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4uX291dHB1dCwgImhlaWdodCIsICIiLCAibWluLXdpZHRoIiwgIiIpCgkJfQoJfSwKCSLmiZPlvIDpk77mjqUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKQoJCXZhciBwcmUgPSAiL2NoYXQvY21kLyI7IGlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsgcHJlID0gIi9jaGF0L3BvZC8iK2Nhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpKyIvY21kLyIgfQoJCXZhciBhcmdzID0gY2FuLk9wdGlvbigpOyBhcmdzLl9wYXRoID0gcHJlKyhtZXRhLmluZGV4fHxjYW4uY29yZS5LZXlzKG1ldGEuY3R4LCBtZXRhLmNtZCkpCgkJYXJncy5fcGF0aC5pbmRleE9mKCIvY21kL3dlYi53aWtpLndvcmQiKSA+IC0xICYmIChhcmdzID0ge19wYXRoOiBwcmUrYXJncy5wYXRofSkKCgkJY2FuLnVzZXIuaXNXZWlYaW4/IGNhbi51c2VyLmp1bXBzKGNhbi5taXNjLk1lcmdlVVJMKGNhbiwgYXJncykpOiBjYW4udXNlci5vcGVuKGNhbi5taXNjLk1lcmdlVVJMKGNhbiwgYXJncykpCgl9LAoJIueUn+aIkOmTvuaOpSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1ldGEgPSBjYW4uQ29uZigpCgkJdmFyIHByZSA9ICIvY2hhdC9jbWQvIjsgaWYgKGNhbi51c2VyLm1vZC5pc1BvZCkgeyBwcmUgPSAiL2NoYXQvcG9kLyIrY2FuLm1pc2MuU2VhcmNoKGNhbiwgaWNlLlBPRCkrIi9jbWQvIiB9CgkJdmFyIGFyZ3MgPSBjYW4uT3B0aW9uKCk7IGFyZ3MuX3BhdGggPSBwcmUrKG1ldGEuaW5kZXh8fGNhbi5jb3JlLktleXMobWV0YS5jdHgsIG1ldGEuY21kKSkKCQlhcmdzLl9wYXRoLmluZGV4T2YoIi9jbWQvd2ViLndpa2kud29yZCIpID4gLTEgJiYgKGFyZ3MgPSB7X3BhdGg6IHByZSthcmdzLnBhdGh9KQoJCXZhciB1cmwgPSBjYW4ubWlzYy5NZXJnZVVSTChjYW4sIGFyZ3MpCgkJY2FuLnVzZXIuY29weShldmVudCwgY2FuLCB1cmwpCgkJY2FuLm9ubW90aW9uLnNoYXJlKGV2ZW50LCBjYW4sIFtdLCBbbWRiLkxJTkssIHVybF0pCgl9LAoJIueUn+aIkOWbvueJhyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvaW1hZ2UoZXZlbnQsIGNhbiwgY2FuLl9uYW1lKSB9LAoJLy8gIueUn+aIkOWbvueJhyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCS8vICAgICBjYW4udXNlci50b1BORyhjYW4sICJoaS5wbmciLCBjYW4uX3RhcmdldC5vdXRlckhUTUwsIGNhbi5Db25mKGh0bWwuSEVJR0hUKSwgY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkvLyB9LAoKCSLnlJ/miJDohJrmnKwiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgdmFyIGNvbmYgPSBjYW4uQ29uZigpCgkJdmFyIGFyZ3MgPSBjYW4uSW5wdXQoIiIsIHRydWUpLmpvaW4oaWNlLlNQKTsgdmFyIGxpc3QgPSBbCgkJCSJleHBvcnQgY3R4X2Rldj0iK2xvY2F0aW9uLm9yaWdpbisiOyBjdHhfdGVtcD0kKG1rdGVtcCk7IGN1cmwgLWZzU0wgJGN0eF9kZXYgLW8gJGN0eF90ZW1wOyIrIiBzb3VyY2UgJGN0eF90ZW1wICIrKGNvbmYuaW5kZXh8fCIiKStpY2UuU1ArYXJncywKCQkJImlzaF9zeXNfZGV2X3J1bl9jb21tYW5kICIrYXJncywgImlzaF9zeXNfZGV2X3J1bl9hY3Rpb24iLCAiaXNoX3N5c19kZXZfcnVuX3NvdXJjZSIsCgkJXQoJCXZhciB1aSA9IGNhbi51c2VyLnRvYXN0KGNhbiwge3RpdGxlOiBidXR0b24sIGR1cmF0aW9uOiAtMSwgd2lkdGg6IC0zMDAsCgkJCWNvbnRlbnQ6ICc8ZGl2IGNsYXNzPSJzdG9yeSIgZGF0YS10eXBlPSJzcGFyayIsIGRhdGEtbmFtZT0ic2hlbGwiPicrCgkJCSc8bGFiZWw+JCA8L2xhYmVsPicrJzxzcGFuPicrbGlzdC5qb2luKCI8L3NwYW4+PGJyLz48bGFiZWw+JCA8L2xhYmVsPjxzcGFuPiIpKyc8L3NwYW4+JysnPC9kaXY+JywKCQkJYWN0aW9uOiBbY2xpLkNMT1NFXSwKCQl9KQoJCWNhbi5vbm1vdGlvbi5zdG9yeS5hdXRvKGNhbiwgdWkuX3RhcmdldCkKCQljYW4udXNlci5jb3B5KGV2ZW50LCBjYW4sIGxpc3RbMF0pCgl9LAoJIuWIt+aWsOaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLlVwZGF0ZSh7fSwgY2FuLklucHV0KFtdLCB0cnVlKSkgfSwKCSLmiZPljIXpobXpnaIiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCAib253ZWJwYWNrIiwgY2FuLnJlcXVlc3QoZXZlbnQpKSB9LAoJIuWIt+aWsOmhtemdoiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgc3ViID0gY2FuLmNvcmUuVmFsdWUoY2FuLl9vdXRwdXRzLCAiLTEiKSwgbXNnID0gc3ViLl9tc2cKCQljYW4uY29yZS5DYWxsRnVuYyhbc3ViLCBjaGF0Lk9OSU1QT1JULCAiX2luaXQiXSwge2Nhbjogc3ViLCBtc2c6IG1zZywgbGlzdDogbXNnLnJlc3VsdHx8bXNnLmFwcGVuZHx8W10sIGNiOiBmdW5jdGlvbihtc2cpIHsKCQl9LCB0YXJnZXQ6IGNhbi5fb3V0cHV0fSkKCX0sCgki5L+d5a2Y5Y+C5pWwIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIlJpdmVyLm9uZGV0YWlsLuS/neWtmOWPguaVsCJdKSB9LAoKCSLmuIXnqbrlj4LmlbAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGNhbi5fb3B0aW9uLCAiIiwgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS52YWx1ZSA9ICIiIH0pCgl9LAoJIuWkjeWItuaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1ldGEgPSBjYW4uQ29uZigpLCBtc2cgPSBjYW4uX21zZwoJCXZhciByZXMgPSBbbXNnLmFwcGVuZCAmJiBtc2cuYXBwZW5kLmpvaW4oIiwiKV07IG1zZy5UYWJsZShmdW5jdGlvbihsaW5lLCBpbmRleCwgYXJyYXkpIHsKCQkJcmVzLnB1c2goY2FuLmNvcmUuSXRlbShsaW5lLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiB2YWx1ZSB9KS5qb2luKCIsIikpCgkJfSkKCgkJcmVzLmxlbmd0aCA+IDEgJiYgY2FuLnVzZXIuY29weShldmVudCwgY2FuLCByZXMuam9pbihpY2UuU1ApKQoJCW1zZy5yZXN1bHQgJiYgY2FuLnVzZXIuY29weShldmVudCwgY2FuLCBtc2cuUmVzdWx0KCkpCgl9LAoJIuS4i+i9veaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1ldGEgPSBjYW4uQ29uZigpLCBtc2cgPSBjYW4uX21zZwoJCXZhciByZXMgPSBbbXNnLmFwcGVuZCAmJiBtc2cuYXBwZW5kLmpvaW4oIiwiKV07IG1zZy5UYWJsZShmdW5jdGlvbihsaW5lLCBpbmRleCwgYXJyYXkpIHsKCQkJcmVzLnB1c2goY2FuLmNvcmUuSXRlbShsaW5lLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiB2YWx1ZSB9KS5qb2luKCIsIikpCgkJfSkKCgkJcmVzLmxlbmd0aCA+IDEgJiYgY2FuLnVzZXIuZG93bmxvYWRzKGNhbiwgcmVzLmpvaW4oIlxuIiksIG1ldGEubmFtZSsiLmNzdiIpCgkJbXNnLnJlc3VsdCAmJiBjYW4udXNlci5kb3dubG9hZHMoY2FuLCBtc2cuUmVzdWx0KCksIG1ldGEubmFtZSsiLnR4dCIpCgl9LAoJIua4heepuuaVsOaNriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLl9vdXRwdXQpIH0sCgki5Yig6Zmk5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uX3RhcmdldCkgfSwKCSLmkYTlg4/lpLQiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIGNvbnN0cmFpbnRzID0ge2F1ZGlvOiBmYWxzZSwgdmlkZW86IHt3aWR0aDogMjAwLCBoZWlnaHQ6IDIwMH19CgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLl9vdXRwdXQsIFt7dmlldzogY3R4LkFDVElPTn0sIHt2aWV3OiAiY2FwdHVyZSIsIGxpc3Q6IFt7dHlwZTogInZpZGVvIiwgX2luaXQ6IGZ1bmN0aW9uKGl0ZW0pIHsKCQkJbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CgkJCQlpdGVtLnNyY09iamVjdCA9IHN0cmVhbSwgaXRlbS5vbmxvYWRlZG1ldGFkYXRhID0gZnVuY3Rpb24oZSkgewoJCQkJCWl0ZW0ucGxheSgpCgkJCQl9LCB1aS5zdHJlYW0gPSBzdHJlYW0KCQkJfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7IGNvbnNvbGUubG9nKGVyci5uYW1lICsgIjogIiArIGVyci5tZXNzYWdlKTsgfSkKCQl9fV19XSkKCgkJY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBbIuWFs+mXrSIsICLmipPmi40iXSwgdWkuYWN0aW9uLCB7CgkJCSLmipPmi40iOiBmdW5jdGlvbihldmVudCkgewoJCQkJdmFyIGNhbnZhcyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLmNhcHR1cmUsIFt7dHlwZTogImNhbnZhcyIsIHdpZHRoOiB1aS52aWRlby5vZmZzZXRXaWR0aCwgaGVpZ2h0OiB1aS52aWRlby5vZmZzZXRIZWlnaHR9XSkuZmlyc3QKCQkJCWNhbnZhcy5nZXRDb250ZXh0KCIyZCIpLmRyYXdJbWFnZSh1aS52aWRlbywgMCwgMCkKCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLmNhcHR1cmUsIFt7aW1nOiBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKSwgc3R5bGU6IHt3aWR0aDogdWkudmlkZW8ub2Zmc2V0V2lkdGgsIGhlaWdodDogdWkudmlkZW8ub2Zmc2V0SGVpZ2h0fX1dKQoJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FudmFzKQoJCQl9LAoJCQki5YWz6ZetIjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5jb3JlLkxpc3QodWkuc3RyZWFtLmdldFRyYWNrcygpLCBmdW5jdGlvbih0cmFjaykgeyB0cmFjay5zdG9wKCkgfSkKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLmFjdGlvbikKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLnZpZGVvKQoJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdWkuY2FwdHVyZSkKCQkJfSwKCQl9KQoJfSwKCglhY3Rpb25zOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX2FjdGlvbikgfSwKCWNsZWFyOiBmdW5jdGlvbihldmVudCwgY2FuLCBuYW1lKSB7IGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fb3V0cHV0KSB9LAoJY2xvc2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLl90YXJnZXQpIH0sCgl1cGxvYWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnVzZXIudXBsb2FkKGV2ZW50LCBjYW4pIH0sCgljaGFuZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG5hbWUsIHZhbHVlLCBjYikgewoJCXJldHVybiBjYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgY2FuLl9vcHRpb24sICIiLCBmdW5jdGlvbihpbnB1dCkgewoJCQlpZiAoaW5wdXQubmFtZSA9PSBuYW1lICYmIHZhbHVlICE9IGlucHV0LnZhbHVlKSB7IGlucHV0LnZhbHVlID0gdmFsdWUKCQkJCXZhciBkYXRhID0gaW5wdXQuZGF0YXNldHx8e307IGNhbi5VcGRhdGUoZXZlbnQsIGNhbi5JbnB1dCgpLCBjYikKCQkJCXJldHVybiBpbnB1dAoJCQl9CgkJfSkKCX0sCgoJbmV4dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5VcGRhdGUoZXZlbnQsIFtjdHguQUNUSU9OLCAibmV4dCIsIGNhbi5TdGF0dXMoInRvdGFsIil8fDAsIGNhbi5PcHRpb24oImxpbWl0Iil8fGNhbi5BY3Rpb24oImxpbWl0Iil8fCIiLCBjYW4uT3B0aW9uKCJvZmZlbmQiKXx8Y2FuLkFjdGlvbigib2ZmZW5kIil8fCIiXSkKCX0sCglwcmV2OiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLlVwZGF0ZShldmVudCwgW2N0eC5BQ1RJT04sICJwcmV2IiwgY2FuLlN0YXR1cygidG90YWwiKXx8MCwgY2FuLk9wdGlvbigibGltaXQiKXx8Y2FuLkFjdGlvbigibGltaXQiKXx8IiIsIGNhbi5PcHRpb24oIm9mZmVuZCIpfHxjYW4uQWN0aW9uKCJvZmZlbmQiKXx8IiJdKQoJfSwKCglnZXRDbGlwYm9hcmREYXRhOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQlmdW5jdGlvbiBhZGQodGV4dCkgewoJCQljYW4ucnVuKGV2ZW50LCBjYW4uYmFzZS5TaW1wbGUoY3R4LkFDVElPTiwgYnV0dG9uLCBjYW4uYmFzZS5QYXJzZUpTT04odGV4dCkpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pLCBjYW4uVXBkYXRlKCkKCQkJfSwgdHJ1ZSkKCQl9CgkJaWYgKG5hdmlnYXRvci5jbGlwYm9hcmQpIHsKCQkJbmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpLnRoZW4oYWRkKS5jYXRjaChmdW5jdGlvbihlcnIpIHsgY2FuLm1pc2MuTG9nKGVycikgfSkKCQl9IGVsc2UgewoJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe3R5cGU6IGh0bWwuVEVYVEFSRUEsIG5hbWU6IG1kYi5URVhUfV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsgYWRkKGxpc3RbMF0pIH0pCgkJfQoJfSwKCWdldExvY2F0aW9uOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQljYW4udXNlci5hZ2VudC5nZXRMb2NhdGlvbihmdW5jdGlvbihkYXRhKSB7IGNhbi5yZXF1ZXN0KGV2ZW50LCBkYXRhKQoJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbWRiLlRZUEUsIG1kYi5OQU1FLCBtZGIuVEVYVCwgImxhdGl0dWRlIiwgImxvbmdpdHVkZSJdLCBmdW5jdGlvbihldiwgYnUsIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBidXR0b25dLmNvbmNhdChjYW4uYmFzZS5TaW1wbGUoYXJncywgZGF0YSkpLCBmdW5jdGlvbihtc2cpIHsKCQkJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSwgY2FuLlVwZGF0ZSgpCgkJCQl9LCB0cnVlKQoJCQl9KQoJCX0pCgl9LAoJb3BlbkxvY2F0aW9uOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi51c2VyLmFnZW50Lm9wZW5Mb2NhdGlvbihjYW4ucmVxdWVzdChldmVudCkpIH0sCgp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9zdG9yeS90cmVuZC5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMCkgeyByZXR1cm4gfQoJCWlmIChtc2cuT3B0aW9uKCJicmFuY2giKSkgeyByZXR1cm4gY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKSB9CgoJCWNhbi5vbmFwcGVuZC5fc3RhdHVzKGNhbiwgWyJmcm9tIiwgImNvbW1pdCIsICJ0b3RhbCIsICJtYXgiLCAiZGF0ZSIsICJ0ZXh0IiwgImFkZCIsICJkZWwiXSkKCQljYW4uZGF0YSA9IG1zZy5UYWJsZSgpLCBjYW4ub25pbXBvcnQuX3N1bShjYW4pCgkJY2FuLkFjdGlvbihodG1sLkhFSUdIVCwgbXNnLk9wdGlvbihodG1sLkhFSUdIVCl8fGljZS5BVVRPKQoJCWNhbi5BY3Rpb24oInNwZWVkIiwgcGFyc2VJbnQobXNnLk9wdGlvbigic3BlZWQiKXx8IjEwMCIpKQoKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgkJY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy5qcyIsICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9wYXRoLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJkcmF3IikKCQkJY2FuLm9uaW1wb3J0Ll9zaG93KGNhbiwgbXNnKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4ub25hY3Rpb25bY2FuLkFjdGlvbihpY2UuVklFVyldKGV2ZW50LCBjYW4pCgkJfSkKCX0sCglfc3VtOiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgYmVnaW4gPSAiIiwgY291bnQgPSAwLCByZXN0ID0gMCwgYWRkID0gMCwgZGVsID0gMCwgbWF4ID0gMAoJCWNhbi5tYXggPSAwLCBjYW4ubWluID0gMCwgY2FuLmxpc3QgPSBjYW4uY29yZS5MaXN0KGNhbi5kYXRhLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsKCQkJdmFyIGxpbmUgPSB7CgkJCQlkYXRlOiB2YWx1ZVtjYW4uX21zZy5hcHBlbmRbMF1dLAoJCQkJdGV4dDogdmFsdWVbY2FuLl9tc2cuYXBwZW5kWzRdXSwKCQkJCWFkZDogcGFyc2VJbnQodmFsdWVbY2FuLl9tc2cuYXBwZW5kWzFdXSksCgkJCQlkZWw6IHBhcnNlSW50KHZhbHVlW2Nhbi5fbXNnLmFwcGVuZFsyXV0pLAoJCQl9CgoJCQlsaW5lLmJlZ2luID0gcmVzdAoJCQlsaW5lLm1heCA9IHJlc3QgKyBsaW5lLmFkZAoJCQlsaW5lLm1pbiA9IHJlc3QgLSBsaW5lLmRlbAoJCQlsaW5lLmNsb3NlID0gcmVzdCArIGxpbmUuYWRkIC0gbGluZS5kZWwKCgkJCWJlZ2luID0gYmVnaW4gfHwgdmFsdWUuZGF0ZSwgY291bnQrKwoJCQlyZXN0ID0gbGluZS5jbG9zZSwgYWRkICs9IGxpbmUuYWRkLCBkZWwgKz0gbGluZS5kZWwKCgkJCWlmIChsaW5lLm1heCAtIGxpbmUubWluID4gbWF4KSB7IG1heCA9IGxpbmUubWF4IC0gbGluZS5taW4gfQoJCQlpZiAobGluZS5tYXggPiBjYW4ubWF4KSB7IGNhbi5tYXggPSBsaW5lLm1heCB9CgkJCWlmIChsaW5lLm1pbiA8IGNhbi5taW4pIHsgY2FuLm1pbiA9IGxpbmUubWluIH0KCQkJcmV0dXJuIGxpbmUKCQl9KQoJCWNhbi5TdGF0dXMoeyJmcm9tIjogYmVnaW4sICJjb21taXQiOiBjb3VudCwgInRvdGFsIjogYWRkK2RlbCwgIm1heCI6IG1heH0pCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFsiZWRpdCIsIFtpY2UuVklFVywgIui2i+WKv+WbviIsICLmn7Hnirblm74iLCAi5pWw5o2u5rqQIl0sIFsiaGVpZ2h0IiwgIjEwMCIsICIyMDAiLCAiNDAwIiwgIjYwMCIsICI4MDAiLCAiYXV0byJdLCBbInNwZWVkIiwgIjEwIiwgIjIwIiwgIjUwIiwgIjEwMCJdXSwKCSJlZGl0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLl9hY3Rpb24pLCBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLl9zdGF0dXMpIH0sCgoJIui2i+WKv+WbviI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIGhlaWdodCA9IGNhbi5BY3Rpb24oaHRtbC5IRUlHSFQpCgkJaWYgKGhlaWdodCA9PSBpY2UuQVVUTykgeyBoZWlnaHQgPSBjYW4uQ29uZihodG1sLkhFSUdIVCkgfQoJCWhlaWdodCA9IHBhcnNlSW50KGhlaWdodCkKCgkJdmFyIHNwYWNlID0gMTAsIHdpZHRoID0gcGFyc2VJbnQoY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkJdmFyIHN0ZXAgPSBwYXJzZUludCgod2lkdGgtMipzcGFjZSkgLyBjYW4ubGlzdC5sZW5ndGgpCgoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGhlaWdodCkKCQljYW4uc3ZnLlZhbChodG1sLldJRFRILCB3aWR0aCkKCgkJZnVuY3Rpb24gc2NhbGUoeSkgeyByZXR1cm4gKHkgLSBjYW4ubWluKS8oY2FuLm1heCAtIGNhbi5taW4pKihoZWlnaHQtMipzcGFjZSkgfQoJCWZ1bmN0aW9uIG9yZGVyKGluZGV4LCB4LCB5KSB7IHJldHVybiB7eDogc3BhY2Urc3RlcCppbmRleCt4LCB5OiBoZWlnaHQtc3BhY2Utc2NhbGUoeSl9IH0KCgkJY2FuLmNvcmUuTmV4dChjYW4ubGlzdCwgZnVuY3Rpb24obGluZSwgbmV4dCwgaW5kZXgpIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwgewoJCQkJc2hhcGU6IHN2Zy5MSU5FLCBwb2ludDogWwoJCQkJCW9yZGVyKGluZGV4LCBzdGVwLzIsIGxpbmUubWluKSwgb3JkZXIoaW5kZXgsIHN0ZXAvMiwgbGluZS5tYXgpLAoJCQkJXSwgc3R5bGU6IGtpdC5EaWN0KGh0bWwuU1RST0tFX1dJRFRILCAxLCBodG1sLlNUUk9LRSwgbGluZS5iZWdpbiA8IGxpbmUuY2xvc2U/IGNoYXQuV0hJVEU6IGNoYXQuQkxBQ0spLAoJCQl9KQoKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwgewoJCQkJc2hhcGU6IHN2Zy5SRUNULCBwb2ludDogWwoJCQkJCW9yZGVyKGluZGV4LCBzdGVwLzQsIGxpbmUuY2xvc2UpLCBvcmRlcihpbmRleCwgc3RlcC80KjMsIGxpbmUuYmVnaW4pLAoJCQkJXSwgc3R5bGU6IGNhbi5iYXNlLkNvcHkoa2l0LkRpY3QoaHRtbC5TVFJPS0VfV0lEVEgsIDEsIHN2Zy5SWCwgMCwgc3ZnLlJZLCAwKSwgbGluZS5iZWdpbiA8IGxpbmUuY2xvc2U/CgkJCQkJa2l0LkRpY3QoaHRtbC5TVFJPS0UsIGNoYXQuV0hJVEUsIGh0bWwuRklMTCwgY2hhdC5XSElURSk6IGtpdC5EaWN0KGh0bWwuU1RST0tFLCBjaGF0LkJMQUNLLCBodG1sLkZJTEwsIGNoYXQuQkxBQ0spCgkJCQkpLAoJCQkJX2luaXQ6IGZ1bmN0aW9uKHZpZXcpIHsKCQkJCQljYW4uY29yZS5JdGVtQ0IoY2FuLm9uZGV0YWlsLCBmdW5jdGlvbihrZXksIGNiKSB7IHZpZXdba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCBjYW4sIGxpbmUpIH0gfSkKCQkJCX0sCgkJCX0pCgoJCQljYW4uU3RhdHVzKGxpbmUsIFsiZGF0ZSIsICJ0ZXh0IiwgImFkZCIsICJkZWwiXSkKCQkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQoY2FuLkFjdGlvbigic3BlZWQiKSksIG5leHQpCgkJfSkKCX0sCgki5p+x54q25Zu+IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBtYXggPSB7fSwgbWluID0ge30KCQljYW4uY29yZS5MaXN0KGNhbi5fbXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCB3aGljaCkgewoJCQljYW4uY29yZS5MaXN0KGNhbi5kYXRhLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsKCQkJCXZhciB2ID0gcGFyc2VJbnQodmFsdWVba2V5XSl8fDA7IGlmIChpbmRleCA9PSAwKSB7CgkJCQkJbWF4W2tleV0gPSB2LCBtaW5ba2V5XSA9IHYKCQkJCQlyZXR1cm4KCQkJCX0KCQkJCWlmICh2ID4gbWF4W2tleV0pIHsgbWF4W2tleV0gPSB2IH0KCQkJCWlmICh2IDwgbWluW2tleV0pIHsgbWluW2tleV0gPSB2IH0KCQkJfSkKCQl9KQoKCQl2YXIgaGVpZ2h0ID0gcGFyc2VJbnQoY2FuLkFjdGlvbihodG1sLkhFSUdIVCkpCgkJdmFyIHNwYWNlID0gMTAsIHdpZHRoID0gcGFyc2VJbnQoY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkJdmFyIHN0ZXAgPSBwYXJzZUludCgod2lkdGgtMipzcGFjZSkgLyBjYW4ubGlzdC5sZW5ndGgpCgoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGhlaWdodCkKCQljYW4uc3ZnLlZhbChodG1sLldJRFRILCB3aWR0aCkKCgkJZnVuY3Rpb24gc2NhbGUoa2V5LCB5KSB7IHJldHVybiAoeSAtIG1pbltrZXldKS8obWF4W2tleV0gLSBtaW5ba2V5XSkqKGhlaWdodC0yKnNwYWNlKSB9CgkJZnVuY3Rpb24gb3JkZXIoaW5kZXgsIGtleSwgeCwgeSkgeyByZXR1cm4ge3g6IHNwYWNlK3N0ZXAqaW5kZXgreCwgeTogc3BhY2Urc2NhbGUoa2V5LCB5KX0gfQoKCQl2YXIgd2lkdGggPSAoc3RlcC00KS9jYW4uX21zZy5hcHBlbmQubGVuZ3RoCgkJY2FuLmNvcmUuTGlzdChjYW4uX21zZy5hcHBlbmQsIGZ1bmN0aW9uKGtleSwgd2hpY2gpIHsKCQkJbWF4W2tleV0gIT0gbWluW2tleV0gJiYgY2FuLmNvcmUuTmV4dChjYW4uZGF0YSwgZnVuY3Rpb24obGluZSwgbmV4dCwgaW5kZXgpIHsKCQkJCXZhciB5ID0gc2NhbGUoa2V5LCBwYXJzZUZsb2F0KGxpbmVba2V5XSkpCgkJCQl5ICYmIGNhbi5vbmltcG9ydC5kcmF3KHt9LCBjYW4sIHsKCQkJCQlzaGFwZTogc3ZnLlJFQ1QsIHBvaW50OiBbCgkJCQkJCW9yZGVyKGluZGV4LCBrZXksIHdpZHRoKndoaWNoKzIsIDApLCBvcmRlcihpbmRleCwga2V5LCB3aWR0aCp3aGljaCsyK3dpZHRoLCB5KSwKCQkJCQldLCBzdHlsZToga2l0LkRpY3QoaHRtbC5TVFJPS0VfV0lEVEgsIDEsIGh0bWwuU1RST0tFLCBjbGkuV0hJVEUsIGh0bWwuRklMTCwgY2xpLldISVRFLCBzdmcuUlgsIDAsIHN2Zy5SWSwgMCksCgkJCQkJX2luaXQ6IGZ1bmN0aW9uKHZpZXcpIHsKCQkJCQkJY2FuLmNvcmUuSXRlbUNCKGNhbi5vbmRldGFpbCwgZnVuY3Rpb24oa2V5LCBjYikgeyB2aWV3W2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgY2FuLCBsaW5lKSB9IH0pCgkJCQkJfSwKCQkJCX0pCgoJCQkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQoY2FuLkFjdGlvbigic3BlZWQiKSksIG5leHQpCgkJCX0pCgkJfSkKCX0sCgki5pWw5o2u5rqQIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIGNhbi5fbXNnLCBudWxsLCBjYW4udWkuZGlzcGxheSkKCQljYW4ub25tb3Rpb24uc2hvdyhjYW4sIGNhbi51aS5kaXNwbGF5KQoJfSwKCgloZWlnaHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uW2Nhbi5BY3Rpb24oaWNlLlZJRVcpXShldmVudCwgY2FuKSB9LAoJc3BlZWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uW2Nhbi5BY3Rpb24oaWNlLlZJRVcpXShldmVudCwgY2FuKSB9LAp9KQpWb2xjYW5vcygib25kZXRhaWwiLCB7aGVscDogIueUqOaIt+S6pOS6kiIsIGxpc3Q6IFtdLAoJb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCBsaW5lKSB7IGNhbi5TdGF0dXMobGluZSwgWyJkYXRlIiwgInRleHQiLCAiYWRkIiwgImRlbCJdKSB9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9zdG9yeS9zcGlkZS5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMCkgeyByZXR1cm4gfQoKCQljYW4uX2FyZ3MgPSBjYW4uYmFzZS5Db3B5KHtyb290OiAiaWNlIiwgZmllbGQ6IG1zZy5hcHBlbmRbMF0sIHNwbGl0OiBpY2UuUFN9LCBjYW4uYmFzZS5QYXJzZVVSTChjYW4uX2Rpc3BsYXkpKQoJCWNhbi5kaXJfcm9vdCA9IG1zZy5PcHRpb24obmZzLkRJUl9ST09UKXx8Y2FuLl9hcmdzLnJvb3R8fCIiCgkJY2FuLl90cmVlID0gY2FuLm9uaW1wb3J0Ll90cmVlKGNhbiwgbXNnLlRhYmxlKCksIGNhbi5fYXJncy5maWVsZCwgY2FuLl9hcmdzLnNwbGl0KQoJCWlmICghY2FuLl90cmVlWyIiXSkgeyByZXR1cm4gfSBjYW4uX3RyZWVbIiJdLm5hbWUgPSBjYW4uX2FyZ3Mucm9vdAoKCQljYW4uc2l6ZSA9IDMwLCBjYW4ubWFyZ2luID0gMzAKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgkJY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy5qcyIsICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9wYXRoLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJkcmF3IikKCQkJY2FuLm9uaW1wb3J0Ll9zaG93KGNhbiwgbXNnKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQl2YXIgcCA9IGNhbi5BY3Rpb24oaWNlLlZJRVcsIGNhbi5zdXAudmlld3x8Y2FuLkFjdGlvbihpY2UuVklFVykpCgkJCWNhbi5vbmFjdGlvbltwXShldmVudCwgY2FuLCBwKQoJCX0pCgl9LAoKCV90cmVlOiBmdW5jdGlvbihjYW4sIGxpc3QsIGZpZWxkLCBzcGxpdCkgewoJCXZhciBub2RlID0ge307IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpZiAoIWl0ZW1bZmllbGRdKSB7IHJldHVybiB9CgkJCWNhbi5jb3JlLkxpc3QoY2FuLmJhc2UudHJpbVByZWZpeChpdGVtW2ZpZWxkXSwgY2FuLmRpcl9yb290K2Nhbi5fYXJncy5zcGxpdCkuc3BsaXQoc3BsaXQpLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGFycmF5KSB7CgkJCQl2YXIgbGFzdCA9IGFycmF5LnNsaWNlKDAsIGluZGV4KS5qb2luKHNwbGl0KXx8IiIsIG5hbWUgPSBhcnJheS5zbGljZSgwLCBpbmRleCsxKS5qb2luKHNwbGl0KQoJCQkJaWYgKCF2YWx1ZSB8fCBub2RlW25hbWVdKSB7IHJldHVybiB9CgoJCQkJbm9kZVtsYXN0XSA9IG5vZGVbbGFzdF18fHtuYW1lOiBsYXN0LCBtZXRhOiB7fSwgbGlzdDogW119CgkJCQlub2RlW2xhc3RdLmxpc3QucHVzaChub2RlW25hbWVdID0gewoJCQkJCW5hbWU6IHZhbHVlKyhpbmRleD09YXJyYXkubGVuZ3RoLTE/ICIiOiBzcGxpdCksCgkJCQkJbWV0YTogaXRlbSwgbGlzdDogW10sIGxhc3Q6IG5vZGVbbGFzdF0sCgkJCQkJZmlsZTogaXRlbVtmaWVsZF18fGl0ZW0uZmlsZSwgaGlkZTogdHJ1ZSwKCQkJCX0pCgkJCX0pCgkJfSkKCQlyZXR1cm4gbm9kZQoJfSwKCV9oZWlnaHQ6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgZGVlcCkgeyBpZiAoIXRyZWUpIHsgcmV0dXJuIDAgfQoJCXRyZWUuZGVlcCA9IGRlZXB8fDAKCQlpZiAodHJlZS5saXN0Lmxlbmd0aCA9PSAwIHx8IHRyZWUuaGlkZSkgeyByZXR1cm4gdHJlZS5oZWlnaHQgPSAxIH0KCgkJdmFyIGhlaWdodCA9IDA7IGNhbi5jb3JlLkxpc3QodHJlZS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCWhlaWdodCArPSBjYW4ub25pbXBvcnQuX2hlaWdodChjYW4sIGl0ZW0sIChkZWVwfHwwKSsxKQoJCX0pCgkJcmV0dXJuIHRyZWUuaGVpZ2h0ID0gaGVpZ2h0Cgl9LAoJX3dpZHRoOiBmdW5jdGlvbihjYW4sIHRyZWUsIGRlZXApIHsgaWYgKCF0cmVlKSB7IHJldHVybiAwIH0KCQl0cmVlLmRlZXAgPSBkZWVwfHwwCgkJaWYgKHRyZWUubGlzdC5sZW5ndGggPT0gMCB8fCB0cmVlLmhpZGUpIHsKCQkJdHJlZS52aWV3ID0gY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBodG1sLlRFWFQsIHBvaW50OiBbe3g6IDAsIHk6IDB9XSwgc3R5bGU6IHtpbm5lcjogdHJlZS5uYW1lfX0pCgkJCXJldHVybiB0cmVlLndpZHRoID0gdHJlZS52aWV3LlZhbCgidGV4dExlbmd0aCIpK2Nhbi5tYXJnaW4KCQl9CgoJCXZhciB3aWR0aCA9IDA7IGNhbi5jb3JlLkxpc3QodHJlZS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCXdpZHRoICs9IGNhbi5vbmltcG9ydC5fd2lkdGgoY2FuLCBpdGVtLCAoZGVlcHx8MCkrMSkKCQl9KQoJCXJldHVybiB0cmVlLndpZHRoID0gd2lkdGgKCX0sCglfY29sb3I6IGZ1bmN0aW9uKGNhbiwgdHJlZSkgewoJCXJldHVybiB0cmVlLm1ldGEmJnRyZWUubWV0YS5jb2xvciB8fCAodHJlZS5saXN0ID09IDA/IGNsaS5QVVJQTEU6IGNsaS5ZRUxMT1cpCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIueUqOaIt+aTjeS9nCIsIGxpc3Q6IFsiZWRpdCIsIFtpY2UuVklFVywgIuaoquWQkSIsICLnurXlkJEiXSwgIueUn+aIkOWbvueJhyJdLAoJImVkaXQiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX2FjdGlvbiksIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX3N0YXR1cykgfSwKCgki5qiq5ZCRIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbmltcG9ydC5faGVpZ2h0KGNhbiwgY2FuLl90cmVlWyIiXSkKCQljYW4uc3VwLnZpZXcgPSAi5qiq5ZCRIiwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZykKCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGNhbi5fdHJlZVsiIl0uaGVpZ2h0KmNhbi5zaXplKzIqY2FuLm1hcmdpbikKCQljYW4ud2lkdGggPSAwLCBjYW4ub25hY3Rpb24uX2RyYXdfaG9yaXpvbnRhbChjYW4sIGNhbi5fdHJlZVsiIl0sIGNhbi5tYXJnaW4sIGNhbi5tYXJnaW4pCgkJY2FuLnN2Zy5WYWwoaHRtbC5XSURUSCwgY2FuLndpZHRoK2Nhbi5tYXJnaW4pCgl9LAoJIue6teWQkSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25pbXBvcnQuX3dpZHRoKGNhbiwgY2FuLl90cmVlWyIiXSkKCQljYW4uc3VwLnZpZXcgPSAi57q15ZCRIiwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZykKCgkJY2FuLnN2Zy5WYWwoaHRtbC5XSURUSCwgY2FuLl90cmVlWyIiXS53aWR0aCsyKmNhbi5tYXJnaW4pCgkJY2FuLmhlaWdodCA9IDAsIGNhbi5vbmFjdGlvbi5fZHJhd192ZXJ0aWNhbChjYW4sIGNhbi5fdHJlZVsiIl0sIGNhbi5tYXJnaW4sIGNhbi5tYXJnaW4rY2FuLnNpemUpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGNhbi5oZWlnaHQrY2FuLm1hcmdpbikKCX0sCgki55Sf5oiQ5Zu+54mHIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi50b2ltYWdlKGV2ZW50LCBjYW4sIGNhbi5fbGVnZW5kLmlubmVyVGV4dCwgY2FuLl9vdXRwdXQpCgl9LAoJX2RyYXc6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgeCwgeSwgc3R5bGUpIHsKCQl2YXIgY29sb3IgPSBjYW4ub25pbXBvcnQuX2NvbG9yKGNhbiwgdHJlZSkKCQl0cmVlLnZpZXcgPSBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7CgkJCXNoYXBlOiBodG1sLlRFWFQsIHBvaW50OiBbe3g6IHgsIHk6IHl9XSwgc3R5bGU6IGNhbi5iYXNlLkNvcHkoewoJCQkJc3Ryb2tlOiBjb2xvciwgZmlsbDogY29sb3IsICJ0ZXh0LWFuY2hvciI6ICJzdGFydCIsIGlubmVyOiB0cmVlLm5hbWV8fHRyZWUuZmlsZSwKCQkJfSwgc3R5bGUpLAoJCX0pLCBjYW4uY29yZS5JdGVtQ0IoY2FuLm9uZGV0YWlsLCB0cmVlLnZpZXcsIGNhbiwgdHJlZSkKCX0sCglfZHJhd192ZXJ0aWNhbDogZnVuY3Rpb24oY2FuLCB0cmVlLCB4LCB5KSB7IHRyZWUueCA9IHgsIHRyZWUueSA9IHkKCQljYW4ub25hY3Rpb24uX2RyYXcoY2FuLCB0cmVlLCB4K3RyZWUud2lkdGgvMiwgeSwgeyJ0ZXh0LWFuY2hvciI6ICJtaWRkbGUifSkKCgkJdHJlZS5oZWlnaHQgPSBjYW4uc2l6ZQoJCWlmICh5K3RyZWUuaGVpZ2h0ID4gY2FuLmhlaWdodCkgeyBjYW4uaGVpZ2h0ID0geSt0cmVlLmhlaWdodCB9CgkJaWYgKHRyZWUuaGlkZSkgeyByZXR1cm4gfQoKCQl2YXIgb2Zmc2V0ID0gMDsgY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBzdmcuUEFUSDJWLCBwb2ludDogWwoJCQkJe3g6IHgrdHJlZS53aWR0aC8yLCB5OiB5K3RyZWUuaGVpZ2h0LWNhbi5tYXJnaW4vMn0sCgkJCQl7eDogeCtvZmZzZXQraXRlbS53aWR0aC8yLCB5OiB5K3RyZWUuaGVpZ2h0K2Nhbi5tYXJnaW4vMn0sCgkJCV0sIHN0eWxlOiB7c3Ryb2tlOiBjbGkuQ1lBTn19KQoKCQkJY2FuLm9uYWN0aW9uLl9kcmF3X3ZlcnRpY2FsKGNhbiwgaXRlbSwgeCtvZmZzZXQsIHkrdHJlZS5oZWlnaHQrY2FuLm1hcmdpbikKCQkJb2Zmc2V0ICs9IGl0ZW0ud2lkdGgKCQl9KQoJfSwKCV9kcmF3X2hvcml6b250YWw6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgeCwgeSkgeyB0cmVlLnggPSB4LCB0cmVlLnkgPSB5CgkJY2FuLm9uYWN0aW9uLl9kcmF3KGNhbiwgdHJlZSwgeCwgeSt0cmVlLmhlaWdodCpjYW4uc2l6ZS8yLCB7InRleHQtYW5jaG9yIjogInN0YXJ0In0pCgoJCXRyZWUud2lkdGggPSB0cmVlLnZpZXcuVmFsKCJ0ZXh0TGVuZ3RoIil8fCh0cmVlLm5hbWV8fCIiKS5sZW5ndGgqMTAKCQlpZiAoeCt0cmVlLndpZHRoID4gY2FuLndpZHRoKSB7IGNhbi53aWR0aCA9IHgrdHJlZS53aWR0aCB9CgkJaWYgKHRyZWUuaGlkZSkgeyByZXR1cm4gfQoKCQl2YXIgb2Zmc2V0ID0gMDsgY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBzdmcuUEFUSDJILCBwb2ludDogWwoJCQkJe3g6IHgrdHJlZS53aWR0aCtjYW4ubWFyZ2luLzgsIHk6IHkrdHJlZS5oZWlnaHQqY2FuLnNpemUvMn0sCgkJCQl7eDogeCt0cmVlLndpZHRoK2Nhbi5tYXJnaW4qMi0yKmNhbi5tYXJnaW4vOCwgeTogeStvZmZzZXQraXRlbS5oZWlnaHQqY2FuLnNpemUvMn0KCQkJXSwgc3R5bGU6IHtzdHJva2U6IGNsaS5DWUFOfX0pCgoJCQljYW4ub25hY3Rpb24uX2RyYXdfaG9yaXpvbnRhbChjYW4sIGl0ZW0sIHgrdHJlZS53aWR0aCsyKmNhbi5tYXJnaW4sIHkrb2Zmc2V0KQoJCQlvZmZzZXQgKz0gaXRlbS5oZWlnaHQqY2FuLnNpemUKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLnlKjmiLfkuqTkupIiLCBsaXN0OiBbXSwKCW9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdHJlZSkgeyB2YXIgeSA9IHRyZWUueSt0cmVlLmhlaWdodCpjYW4uc2l6ZS8yCgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLnBvcyksIGNhbi5wb3MgPSBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7CgkJCXNoYXBlOiBzdmcuUkVDVCwgcG9pbnQ6IFsKCQkJCXt4OiB0cmVlLngtY2FuLm1hcmdpbi80LCB5OiB5LWNhbi5zaXplLzJ9LAoJCQkJe3g6IHRyZWUueCt0cmVlLndpZHRoK2Nhbi5tYXJnaW4vOCwgeTogeStjYW4uc2l6ZS8yfSwKCQkJXSwgc3R5bGU6IHtzdHJva2U6IGNsaS5SRUQsIGZpbGw6IGh0bWwuTk9ORX0sCgkJfSksIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJfSwKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRyZWUpIHsKCQlpZiAodHJlZS5saXN0Lmxlbmd0aCA+IDAgfHwgdHJlZS50YWdzIHx8IHRyZWUubmFtZS5lbmRzV2l0aChjYW4uX2FyZ3Muc3BsaXQpKSB7CgkJCXJldHVybiB0cmVlLmhpZGUgPSAhdHJlZS5oaWRlLCBjYW4ub25hY3Rpb25bY2FuLkFjdGlvbihpY2UuVklFVyldKGV2ZW50LCBjYW4pCgkJfQoKCQlmb3IgKHZhciBub2RlID0gdHJlZTsgbm9kZTsgbm9kZSA9IG5vZGUubGFzdCkgewoJCQljYW4ucmVxdWVzdChldmVudCwgbm9kZS5tZXRhKQoJCX0KCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5PcHRpb24oKSkKCQljYW4ucnVuKGV2ZW50LCBjYW4uYmFzZS5PYmooY2FuLl9hcmdzLnByZWZpeCwgW10pLmNvbmNhdChbY2FuLk9wdGlvbigicmVwb3MiKXx8IiIsIHRyZWUuZmlsZXx8IiIsIHRyZWUubmFtZV0pLCBmdW5jdGlvbihtc2cpIHsKCQkJaWYgKG1zZy5MZW5ndGgoKSA9PSAwKSB7CgkJCQlyZXR1cm4gY2FuLm9uZGV0YWlsLnBsdWdpbihjYW4sIHRyZWUsIHt9LCAid2ViLmNvZGUuaW5uZXIiLCBbY2FuLmRpcl9yb290LCB0cmVlLmZpbGUsIHRyZWUubGluZV0sIFtjdHguQUNUSU9OLCAiaW5uZXIiXSkKCQkJfQoJCQlpZiAobXNnLkFwcGVuZChtZGIuSU5ERVgpKSB7IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSkgewoJCQkJY2FuLm9uZGV0YWlsLnBsdWdpbihjYW4sIHRyZWUsIHZhbHVlLCB2YWx1ZS5pbmRleCwgW10sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCB2YWx1ZS5pbmRleF0pCgkJCX0pOyByZXR1cm4gfQoKCQkJdHJlZS50YWdzID0gdHJ1ZQoJCQlpZiAobXNnLk9wdGlvbihsZXguU1BMSVQpKSB7CgkJCQl0cmVlLmxpc3QgPSBjYW4ub25pbXBvcnQuX3RyZWUoY2FuLCBtc2cuVGFibGUoKSwgbXNnLk9wdGlvbihtZGIuRklFTEQpfHxtc2cuYXBwZW5kWzBdLCBtc2cuT3B0aW9uKGxleC5TUExJVCkpWyIiXS5saXN0fHxbXQoJCQkJY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS5sYXN0ID0gdHJlZSB9KQoJCQl9IGVsc2UgewoJCQkJbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0pIHsgdHJlZS5saXN0LnB1c2goewoJCQkJCXR5cGU6ICJ0YWdzIiwgbmFtZTogaXRlbS5uYW1lfHxpdGVtLmZpbGV8fGl0ZW1bbXNnLmFwcGVuZFswXV0sCgkJCQkJbWV0YTogaXRlbSwgbGlzdDogW10sIGxhc3Q6IHRyZWUsCgkJCQkJZmlsZTogaXRlbS5maWxlLCBsaW5lOiBpdGVtLmxpbmUsIGhpZGU6IHRydWUsCgkJCQl9KSB9KQoJCQl9CgkJCXRyZWUuaGlkZSA9ICF0cmVlLmhpZGUsIGNhbi5vbmFjdGlvbltjYW4uQWN0aW9uKGljZS5WSUVXKV0oZXZlbnQsIGNhbikKCQl9LCB0cnVlKQoJfSwKCglwbHVnaW46IGZ1bmN0aW9uKGNhbiwgdHJlZSwgdmFsdWUsIGluZGV4LCBhcmdzLCBwcmVmaXgpIHsKCQlmb3IgKHZhciBub2RlID0gdHJlZTsgbm9kZTsgbm9kZSA9IG5vZGUubGFzdCkgewoJCQljYW4uYmFzZS5Db3B5KHZhbHVlLCBub2RlLm1ldGEpCgkJfQoJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBjYW4uYmFzZS5Db3B5KHt0eXBlOiBjaGF0LkZMT0FULCBpbmRleDogaW5kZXgsIGFyZ3M6IGFyZ3N9KSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgcHJlZml4LCBjbWRzKSwgY2IsIHRydWUpCgkJCX0sIGNhbi5vbmRldGFpbC5maWd1cmUoY2FuLCBzdWIpCgkJfSkKCX0sCglmaWd1cmU6IGZ1bmN0aW9uKGNhbiwgc3ViLCBtc2csIGNiKSB7CgkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KSB7IGxlZnQgPSBsZWZ0fHwwCgkJCXZhciB0b3AgPSAxMjA7IGlmIChjYW4udXNlci5pc01vYmlsZSkgeyB0b3AgPSBjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAwOiA0OCB9CgkJCXN1Yi5Db25mSGVpZ2h0KGhlaWdodC10b3AtaHRtbC5BQ1RJT05fSEVJR0hULShjYW4udXNlci5pc01vYmlsZSYmIWNhbi51c2VyLmlzTGFuZHNjYXBlKCk/IDIqaHRtbC5BQ1RJT05fSEVJR0hUOiAwKSksIHN1Yi5Db25mV2lkdGgod2lkdGgpCgoJCQljYW4ub25tb3Rpb24ubW92ZShjYW4sIHN1Yi5fdGFyZ2V0LCB7cG9zaXRpb246IGh0bWwuRklYRUQsIGxlZnQ6IGxlZnQsIHRvcDogdG9wfSkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgpCgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCX0pCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvd29yZC5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPiAwKSB7IHJldHVybiBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpIH0KCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCBtc2cuUmVzdWx0KCkpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCB3aWtpLklURU0sIGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGRhdGEgPSBpdGVtLmRhdGFzZXR8fHt9CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIHtzdHlsZTogY2FuLmJhc2UuT2JqKGRhdGEuc3R5bGUpfSkKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmltcG9ydCwgZGF0YS50eXBlXSwgW2NhbiwgZGF0YSwgaXRlbV0pCgkJCS8vIGNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwgaHRtbC5NQVhfV0lEVEgsIGNhbi5Db25mV2lkdGgoKS0oY2FuLnVzZXIuaXNXaW5kb3dzPyA0MDogMzApKQoJCX0pCgl9LAoJaW1hZ2U6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKS8yLCBodG1sLk1BWF9XSURUSCwgY2FuLkNvbmZXaWR0aCgpKQoKCQkvLyBpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJaWYgKGNhbi51c2VyLmlzTGFuZHNjYXBlKCkpIHsKCQkJfSBlbHNlewoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKSwgaHRtbC5NQVhfV0lEVEgsIGNhbi5Db25mV2lkdGgoKSkKCQkJfQoJCS8vIAlyZXR1cm4KCQkvLyB9CgkJLy8gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKS80KQoJfSwKCW5hdm1lbnU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IHZhciBuYXYgPSBjYW4uc3VwLl9uYXZtZW51CgkJbmF2ID0gbmF2fHxjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX2ZpZWxkcywgW3t2aWV3OiB3aWtpLk5BVk1FTlV9XSkuZmlyc3QKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBuYXYpLCBjYW4uX2ZpZWxkcy5pbnNlcnRCZWZvcmUobmF2LCBjYW4uX291dHB1dCkKCgkJY2FuLm9uYXBwZW5kLmxpc3QoY2FuLCBjYW4uYmFzZS5PYmooZGF0YS5kYXRhKSwgZnVuY3Rpb24oZXZlbnQsIGl0ZW0pIHsKCQkJdmFyIGxpbmsgPSBpdGVtLm1ldGEubGluaywgbGlzdCA9IGNhbi5jb3JlLlNwbGl0KGl0ZW0ubWV0YS5saW5rKQoJCQlpZiAoY2FuLmNvcmUuVmFsdWUoY2FuLCBsaXN0WzBdKSkgeyByZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoW2NhbiwgbGlzdFswXV0sIGxpc3Quc2xpY2UoMSkpIH0KCQkJaWYgKCFsaW5rIHx8IGxpbmsgPT0gY2FuLk9wdGlvbihuZnMuUEFUSCkpIHsgcmV0dXJuIGZhbHNlIH0KCgkJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsgY2FuLnVzZXIubW9kLmlzQ21kICYmIGNhbi51c2VyLnRpdGxlKGl0ZW0ubWV0YS5uYW1lKTsgcmV0dXJuIGNhbi5PcHRpb24obmZzLlBBVEgsIGxpbmspIH0pKSB7IHJldHVybiB9CgkJCXJldHVybiBjYW4uc3VwLlVwZGF0ZShldmVudCwgW2xpbmtdKQoJCX0sIG5hdiksIGNhbi5zdXAuX25hdm1lbnUgPSBuYXYKCgkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obXNnKSB7IAoJCQljYW4ucGFnZS5zdHlsZShjYW4sIG5hdiwgaHRtbC5IRUlHSFQsIGNhbi5Db25mKGh0bWwuSEVJR0hUKSsoY2FuLnVzZXIubW9kLmlzQ21kPyBtc2cuT3B0aW9uKGh0bWwuTUFSR0lOX1kpOiAwKSkKCQkJY2FuLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCktbmF2Lm9mZnNldFdpZHRoLShjYW4udXNlci5tb2QuaXNDbWQ/IDEwOiAyMCktMTApCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5fb3V0cHV0LCB7c3R5bGU6IGtpdC5EaWN0KAoJCQkJaHRtbC5IRUlHSFQsIGNhbi5zdXAuX25hdm1lbnUub2Zmc2V0SGVpZ2h0LCBodG1sLk1BWF9XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCksCgkJCQlodG1sLkZMT0FULCBodG1sLkxFRlQsIGh0bWwuQ0xFQVIsIGh0bWwuTk9ORQoJCQkpfSkKCQl9KQoJfSwKCXByZW1lbnU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIGNhbi5wYWdlLktleXMod2lraS5IMiwgd2lraS5IMyksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IFtpdGVtLmlubmVySFRNTCwgaHRtbC5MSSwgaXRlbS50YWdOYW1lXSwgb25jbGljazogZnVuY3Rpb24oKSB7CgkJCQlpdGVtLnNjcm9sbEludG9WaWV3KCkKCQkJfX1dKSwgaXRlbS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsgdGFyZ2V0LnNjcm9sbEludG9WaWV3KCkgfQoJCX0pCgl9LAoJdGl0bGU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnVzZXIubW9kLmlzQ21kICYmIHRhcmdldC50YWdOYW1lID09ICJIMSIgJiYgY2FuLnVzZXIudGl0bGUoZGF0YS50ZXh0KQoJfSwKCXJlZmVyOiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5BLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLkNSRUFURSwgbWRiLlRZUEUsICJyZWZlciIsIG1kYi5OQU1FLCBpdGVtLmRhdGFzZXQubmFtZSwgbWRiLlRFWFQsIGl0ZW0uaHJlZl0sIG51bGwsIHRydWUpCgkJCX0KCQl9KQoJfSwKCXNwYXJrOiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCWlmIChkYXRhW21kYi5OQU1FXSA9PSBjaGF0LkZJRUxEKSB7CgkJCWZ1bmN0aW9uIGRlZXAodGV4dCkgeyB2YXIgZCA9IDAKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykgewoJCQkJCXN3aXRjaCAodGV4dFtpXSkgewoJCQkJCQljYXNlICJcdCI6IGQgKz0gNDsgYnJlYWsKCQkJCQkJY2FzZSAiICI6IGQrKzsgYnJlYWsKCQkJCQkJZGVmYXVsdDogcmV0dXJuIGQKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gZAoJCQl9CgkJCXZhciBsaXN0ID0gW107IGNhbi5jb3JlLkxpc3QodGFyZ2V0LmlubmVyVGV4dC5zcGxpdChpY2UuTkwpLCBmdW5jdGlvbihsaW5lKSB7IHZhciBfZGVlcCA9IGRlZXAobGluZSkKCQkJCXdoaWxlIChsaXN0Lmxlbmd0aCA+IDApIHsgaWYgKF9kZWVwIDw9IGxpc3RbbGlzdC5sZW5ndGgtMV0uX2RlZXApIHsgbGlzdC5wb3AoKSB9IGVsc2UgeyBicmVhayB9IH0KCQkJCXZhciBscyA9IGNhbi5jb3JlLlNwbGl0KGxpbmUpLCBpdGVtID0ge19kZWVwOiBfZGVlcCwgbWV0YToge2luZGV4OiBsc1swXSwgbmFtZTogbHNbMV0sIGFyZ3M6IGxzLnNsaWNlKDIpfSwgbGlzdDogW119CgkJCQlpZiAobGlzdC5sZW5ndGggPiAwKSB7IGxpc3RbbGlzdC5sZW5ndGgtMV0ubGlzdC5wdXNoKGl0ZW0pIH0gbGlzdC5wdXNoKGl0ZW0pCgkJCX0pCgoJCQl2YXIgZmlyc3Q7IGZ1bmN0aW9uIHNob3coaXRlbSwgaW5kZXgsIHRhcmdldCwgb3V0cHV0KSB7CgkJCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIGl0ZW0ubWV0YS5uYW1lfHxpdGVtLm1ldGEuaW5kZXhdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWlmICh1aS5saXN0LmlubmVyVGV4dCkgeyByZXR1cm4gY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIHVpLmxpc3QpIH0KCQkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgdmlldy5tZW51LCBodG1sLkRJVl9JVEVNLCBldmVudC50YXJnZXQpCgkJCQkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gaW5kZXggfSwgb3V0cHV0KSkgeyByZXR1cm4gfQoJCQkJCWNhbi5jb3JlLkxpc3QoaXRlbS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBpdGVtLm1ldGEsIGZ1bmN0aW9uKHN1YikgewoJCQkJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYiwgc2lsZW50KSB7CgkJCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIGl0ZW0ubWV0YS5pbmRleF0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJCQkJCX0KCQkJCQkJCXN1Yi5Db25mV2lkdGgoaXRlbS5tZXRhLndpZHRoID0gY2FuLkNvbmZXaWR0aCgpLTE2NSkKCQkJCQkJCXN1Yi5Db25mSGVpZ2h0KGl0ZW0ubWV0YS5oZWlnaHQgPSBjYW4uQ29uZkhlaWdodCgpLTMwMCkKCQkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCktMipodG1sLlBMVUdJTl9NQVJHSU4pCgkJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fc3RhdHVzLCBodG1sLk1BWF9XSURUSCwgc3ViLkNvbmZXaWR0aCgpLTIqaHRtbC5QTFVHSU5fTUFSR0lOKQoJCQkJCQl9LCBvdXRwdXQpCgkJCQkJfSkKCQkJCX19LCB7dmlldzogaHRtbC5MSVNUfV0pCgkJCQljYW4uY29yZS5MaXN0KGl0ZW0ubGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLmxpc3QubGVuZ3RoID4gMCAmJiBzaG93KGl0ZW0sIGNhbi5jb3JlLktleXMoaW5kZXgsIGl0ZW0ubWV0YS5pbmRleCksIHVpLmxpc3QsIG91dHB1dCkgfSkKCQkJCXVpLmxpc3QuaW5uZXJUZXh0ID09ICIiICYmIChmaXJzdCA9IGZpcnN0fHx1aS5pdGVtKQoJCQl9CgoJCQl2YXIgdmlldyA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5NRU5VfSwge3ZpZXc6IGh0bWwuTElTVH1dKQoJCQlyZXR1cm4gc2hvdyhsaXN0WzBdLCBsaXN0WzBdLl9pbmRleCwgdmlldy5tZW51LCB2aWV3Lmxpc3QpLCBmaXJzdC5jbGljaygpCgkJfQoJCWlmIChkYXRhW21kYi5OQU1FXSA9PSBodG1sLklOTkVSKSB7IHJldHVybiBjYW4ub25tb3Rpb24uY29weShjYW4sIHRhcmdldCkgfQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5BLCBmdW5jdGlvbihpdGVtKSB7IGNhbi5vbm1vdGlvbi5saW5rKGNhbiwgaXRlbSkgfSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuU1BBTiwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ub25tb3Rpb24uY29weShjYW4sIGl0ZW0sICIiLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5DUkVBVEUsIG1kYi5UWVBFLCAic3BhcmsiLCBtZGIuTkFNRSwgInNoZWxsIiwgbWRiLlRFWFQsIGl0ZW0uaW5uZXJUZXh0XSwgbnVsbCwgdHJ1ZSkKCQkJfSkKCQl9KQoJfSwKCWNoYXJ0OiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCXRhcmdldC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnVzZXIuY2FydGVDbGllbnQoZXZlbnQsIGNhbiwga2l0LkRpY3QobWRiLkVYUE9SVCwgZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJCQljYW4ub25tb3Rpb24udG9pbWFnZShldmVudCwgY2FuLCAiaGkucG5nIiwgdGFyZ2V0KQoJCQl9KSwgW21kYi5FWFBPUlRdKQoJCX0KCX0sCgl0YWJsZTogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKCQljYW4ucGFnZS5PcmRlclRhYmxlKGNhbiwgdGFyZ2V0KSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgY2hhdC5DT05URU5UKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5URCwgZnVuY3Rpb24oaXRlbSkgeyBjYW4ub25tb3Rpb24uY29weShjYW4sIGl0ZW0pIH0pCgl9LAoJZmllbGQ6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0LCB3aWR0aCkgeyB2YXIgaXRlbSA9IGNhbi5iYXNlLk9iaihkYXRhLm1ldGEpCgkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgaXRlbSwgW2NoYXQuUExVR0lOX1NUQVRFX0pTXSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgewoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGNoYXQuU1RPUlksIGRhdGEudHlwZSwgZGF0YS5uYW1lLCBkYXRhLnRleHRdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQkJc3ViLkNvbmZIZWlnaHQoY2FuLkNvbmZIZWlnaHQoKSkKCQkJc3ViLkNvbmZXaWR0aChpdGVtLndpZHRoID0gKHdpZHRofHxjYW4uQ29uZldpZHRoKCkpLShjYW4udXNlci5pc1dpbmRvd3M/IDQwOiAyMCkpCgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCkpCgoJCQljYW4uY29yZS5WYWx1ZShpdGVtLCAiYXV0by5jbWQiKSAmJiBjYW4uY29yZS5UaW1lcjMwMG1zKGZ1bmN0aW9uKCkgewoJCQkJdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KHt9LCBjYW4uY29yZS5WYWx1ZShpdGVtLCAib3B0cyIpKTsgbXNnLk9wdGlvbihpY2UuTVNHX0hBTkRMRSwgaWNlLlRSVUUpCgkJCQlzdWIuVXBkYXRlKG1zZy5fZXZlbnQsIFtjdHguQUNUSU9OLCBjYW4uY29yZS5WYWx1ZShpdGVtLCAiYXV0by5jbWQiKV0pCgkJCX0pCgkJfSwgY2FuLl9vdXRwdXQsIHRhcmdldCkKCX0sCglpZnJhbWU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IHZhciBtZXRhID0gY2FuLmJhc2UuT2JqKGRhdGEubWV0YSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB0YXJnZXQsIHt3aWR0aDogY2FuLkNvbmYoaHRtbC5XSURUSCktMjAwfSkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbmtleW1hcCIsIHtoZWxwOiAi6ZSu55uY5Lqk5LqSIiwgbGlzdDogW10sCglfbW9kZTogewoJCW5vcm1hbDogewoJCQkibiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsLm5leHQoY2FuLnN1YikgfSwKCQkJImoiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbC5uZXh0KGNhbi5zdWIpIH0sCgkJCSJBcnJvd1JpZ2h0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25kZXRhaWwubmV4dChjYW4uc3ViKSB9LAoJCQkiQXJyb3dMZWZ0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25kZXRhaWwucHJldihjYW4uc3ViKSB9LAoJCQkiayI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsLnByZXYoY2FuLnN1YikgfSwKCQkJInAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbC5wcmV2KGNhbi5zdWIpIH0sCgoJCQkicSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsWyLnu5PmnZ8iXShldmVudCwgY2FuLnN1YikgfSwKCQkJImgiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbFsi6ZqQ6JePIl0oZXZlbnQsIGNhbi5zdWIpIH0sCgkJfSwKCX0sIF9lbmdpbmU6IHt9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaOp+S7tuS6pOS6kiIsIGxpc3Q6IFtdLAoJX3RyYW5zOiB7dmlldzogIuinhuWbviJ9LAoJcGxheTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbGlzdCA9IFtdLCBjdXJyZW50ID0gW10KCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgd2lraS5JVEVNLCBmdW5jdGlvbihpdGVtKSB7CgkJCXN3aXRjaCAoaXRlbS50YWdOYW1lKSB7CgkJCQljYXNlICJIMSI6CgkJCQljYXNlICJIMiI6CgkJCQljYXNlICJIMyI6CgkJCQkJbGlzdC5wdXNoKGN1cnJlbnQgPSBbXSkKCQkJCQlicmVhawoJCQl9CgkJCWN1cnJlbnQucHVzaChpdGVtKQoJCX0pCgoJCWNhbi5vbmFwcGVuZC5faW5pdChjYW4sIHt0eXBlOiAic3Rvcnkgd29yZCBmbG9hdCJ9LCBbXSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBjYW4ucnVuLCBzdWIuc3VwID0gY2FuLCBjYW4uc3ViID0gc3ViLCBjYW4ub25hcHBlbmQuX2FjdGlvbihzdWIsIFsKCQkJCVsi5biD5bGAIiwgIuW8gOiusiIsICLlv6vpl6oiLCAi572R5qC8Il0sICLlpKfnurIiLCAi6aaW6aG1IiwgIuS4iuS4gOmhtSIsCgkJCQlbIuiPnOWNlSJdLmNvbmNhdChjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIHBhZ2VbMF0uaW5uZXJIVE1MIH0pKSwKCQkJCSLkuIvkuIDpobUiLCAi6ZqQ6JePIiwgIue7k+adnyIsCgkJCV0sIHN1Yi5fYWN0aW9uLCBjYW4ub25kZXRhaWwpCgoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgImtleW1hcC5mb2N1cyIsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7Y2I6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ua2V5bGlzdCA9IGNhbi5vbmtleW1hcC5fcGFyc2UoZXZlbnQsIGNhbiwgIm5vcm1hbCIsIGNhbi5rZXlsaXN0KQoJCQl9fSkpLCBjYW4ub25rZXltYXAuX2J1aWxkKGNhbikKCgkJCXN1Yi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl90YXJnZXQsIGh0bWwuQkFDS0dST1VORCwgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLkhFSUdIVCwgd2luZG93LmlubmVySGVpZ2h0LTQqaHRtbC5QTFVHSU5fTUFSR0lOLTIqaHRtbC5BQ1RJT05fSEVJR0hUKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLldJRFRILCB3aW5kb3cuaW5uZXJXaWR0aC00Kmh0bWwuUExVR0lOX01BUkdJTikKCgkJCXN1Yi51aSA9IHN1Yi5wYWdlLkFwcGVuZChzdWIsIHN1Yi5fb3V0cHV0LCBbe3ZpZXc6IGNoYXQuUFJPSkVDVH0sIHt2aWV3OiBjaGF0LkNPTlRFTlR9XSkKCQkJY2FuLmNvcmUuTGlzdChzdWIubGlzdCA9IGxpc3QsIGZ1bmN0aW9uKHBhZ2UsIGluZGV4KSB7CgkJCQljYW4ub25hcHBlbmQuaXRlbShjYW4sIGh0bWwuSVRFTSwge25hbWU6IHBhZ2VbMF0uaW5uZXJIVE1MfSwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4ub25kZXRhaWwuc2hvdyhzdWIsIGluZGV4KSAKCQkJCX0sIGZ1bmN0aW9uKGV2ZW50KSB7fSwgc3ViLnVpLnByb2plY3QpCgoJCQkJc3ViLnBhZ2UuQXBwZW5kKHN1Yiwgc3ViLnVpLmNvbnRlbnQsIFt7dmlldzogInBhZ2UiKyhpbmRleD09MD8gIiBmaXJzdCI6ICIiKSwgbGlzdDogY2FuLmNvcmUuTGlzdChwYWdlLCBmdW5jdGlvbihpdGVtKSB7IHZhciBkYXRhID0gaXRlbS5kYXRhc2V0fHx7fQoJCQkJCXN3aXRjaCAoZGF0YS50eXBlKSB7CgkJCQkJCWNhc2Ugd2lraS5QUkVNRU5VOiBpdGVtID0gaXRlbS5jbG9uZU5vZGUoZmFsc2UpOyBicmVhawoJCQkJCQljYXNlIGNoYXQuRklFTEQ6IGl0ZW0gPSBjYW4ub25hcHBlbmQuZmllbGQoY2FuLCBjaGF0LlNUT1JZLCBjYW4uYmFzZS5PYmooZGF0YS5tZXRhKSwgc3ViLnVpLmNvbnRlbnQpLmZpcnN0OyBicmVhawoJCQkJCQlkZWZhdWx0OiBpdGVtID0gaXRlbS5jbG9uZU5vZGUodHJ1ZSkKCQkJCQl9CgkJCQkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25pbXBvcnQsIGRhdGEudHlwZV0sIFtzdWIsIGRhdGEsIGl0ZW0sIHdpbmRvdy5pbm5lcldpZHRoLTQqaHRtbC5QTFVHSU5fTUFSR0lOXSksIGl0ZW0KCQkJCX0pLCB9XSkKCQkJfSksIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBzdWIudWkucHJvamVjdCksIGNhbi5vbmRldGFpbC5zaG93KHN1YiwgMCkgCgoJCQlzdWIub25hcHBlbmQuX3N0YXR1cyhzdWIsIFttZGIuUEFHRSwgY2xpLkZST00sIGNsaS5DT1NUXSksIHN1Yi5TdGF0dXMoY2xpLkZST00sIGNhbi5iYXNlLlRpbWUoKSkKCQkJdmFyIGZyb20gPSBuZXcgRGF0ZSgpOyBjYW4uY29yZS5UaW1lcih7aW50ZXJ2YWw6IDEwMH0sIGZ1bmN0aW9uKCkgeyB2YXIgbm93ID0gbmV3IERhdGUoKQoJCQkJc3ViLlN0YXR1cyhjbGkuQ09TVCwgY2FuLmJhc2UuRHVyYXRpb24obm93LWZyb20pKQoJCQl9KQoJCX0sIGRvY3VtZW50LmJvZHkpCgl9LAoJdmlldzogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4uX2hlaWdodCkgewoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0LCBjYW4uX2hlaWdodCksIGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnN1cC5fbmF2bWVudSwgY2FuLl9oZWlnaHQpLCBkZWxldGUoY2FuLl9oZWlnaHQpCgkJfSBlbHNlIHsgY2FuLl9oZWlnaHQgPSBjYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0KQoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0LCAiIiksIGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnN1cC5fbmF2bWVudSwgIiIpCgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLkuqTkupLmk43kvZwiLCBsaXN0OiBbIuWIoOmZpCJdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCX0sCglzaG93OiBmdW5jdGlvbihzdWIsIHdoaWNoKSB7IHN1Yi5wYWdlLk1vZGlmeShzdWIsIHN1Yi51aS5jb250ZW50LCB7Y2xhc3NOYW1lOiBjaGF0LkNPTlRFTlR9KQoJCXN1Yi5wYWdlLlNlbGVjdChzdWIsIHN1Yi51aS5jb250ZW50LCB3aWtpLkRJVl9QQUdFLCBmdW5jdGlvbihwYWdlLCBpbmRleCkgewoJCQlpZiAoaW5kZXggPT0gd2hpY2ggfHwgcGFnZSA9PSB3aGljaCkgewoJCQkJc3ViLnBhZ2UuU2VsZWN0KHN1YiwgcGFnZSwgc3ViLnBhZ2UuS2V5cyhodG1sLkgxLCBodG1sLkgyLCBodG1sLkgzKSwgZnVuY3Rpb24oaXRlbSkgeyBzdWIuQWN0aW9uKCLoj5zljZUiLCBpdGVtLmlubmVySFRNTCkgfSkKCQkJCXN1Yi5vbm1vdGlvbi5zZWxlY3Qoc3ViLCBzdWIudWkucHJvamVjdCwgaHRtbC5ESVZfSVRFTSwgaW5kZXgpCgkJCQlzdWIuU3RhdHVzKG1kYi5QQUdFLCBpbmRleCsxK2ljZS5QUytzdWIubGlzdC5sZW5ndGgpCgkJCQlzdWIucGFnZS5DbGFzc0xpc3QuYWRkKHN1YiwgcGFnZSwgaHRtbC5TSE9XKQoJCQl9IGVsc2UgewoJCQkJc3ViLnBhZ2UuQ2xhc3NMaXN0LmRlbChzdWIsIHBhZ2UsIGh0bWwuU0hPVykKCQkJfQoJCX0pCgl9LAoJbmV4dDogZnVuY3Rpb24oc3ViKSB7CgkJc3ViLnBhZ2UuU2VsZWN0KHN1Yiwgc3ViLnVpLmNvbnRlbnQsIHN1Yi5jb3JlLktleXMod2lraS5ESVZfUEFHRSwgaWNlLlNIT1cpLCBmdW5jdGlvbihwYWdlKSB7CgkJCXBhZ2UubmV4dFNpYmxpbmc/IHN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UubmV4dFNpYmxpbmcpOiBzdWIudXNlci50b2FzdChzdWIsIGNsaS5FTkQpCgkJfSkKCX0sCglwcmV2OiBmdW5jdGlvbihzdWIpIHsKCQlzdWIucGFnZS5TZWxlY3Qoc3ViLCBzdWIudWkuY29udGVudCwgc3ViLmNvcmUuS2V5cyh3aWtpLkRJVl9QQUdFLCBpY2UuU0hPVyksIGZ1bmN0aW9uKHBhZ2UpIHsKCQkJcGFnZS5wcmV2aW91c1NpYmxpbmc/IHN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UucHJldmlvdXNTaWJsaW5nKTogc3ViLnVzZXIudG9hc3Qoc3ViLCBjbGkuRU5EKQoJCX0pCgl9LAoJZmxhc2g6IGZ1bmN0aW9uKHN1YikgewoJCXN1Yi5jb3JlLk5leHQoc3ViLnBhZ2UuU2VsZWN0KHN1Yiwgc3ViLnVpLmNvbnRlbnQsIHdpa2kuRElWX1BBR0UpLCBmdW5jdGlvbihwYWdlLCBuZXh0KSB7CgkJCXN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UpLCBzdWIuY29yZS5UaW1lcig1MDAsIGZ1bmN0aW9uKCkgeyBuZXh0KCkgfSkKCQl9KQoJfSwKCWdyaWQ6IGZ1bmN0aW9uKHN1YikgeyBzdWIucGFnZS5Nb2RpZnkoc3ViLCBzdWIudWkuY29udGVudCwge2NsYXNzTmFtZTogImNvbnRlbnQgZ3JpZCJ9KSB9LAoKCSLlvIDorrIiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwuc2hvdyhjYW4sIDApIH0sCgki5b+r6ZeqIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc3VwLm9uZGV0YWlsLmZsYXNoKGNhbikgfSwKCSLnvZHmoLwiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwuZ3JpZChjYW4pIH0sCgoJIuWkp+e6siI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi51aS5wcm9qZWN0KSB9LAoJIummlumhtSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmRldGFpbC5zaG93KGNhbiwgMCkgfSwKCSLkuIrkuIDpobUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwucHJldihjYW4sIGNhbi51aS5jb250ZW50KSB9LAoJIuiPnOWNlSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmRldGFpbC5zaG93KGNhbiwgZXZlbnQudGFyZ2V0LnNlbGVjdGVkSW5kZXgpIH0sCgki5LiL5LiA6aG1IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc3VwLm9uZGV0YWlsLm5leHQoY2FuLCBjYW4udWkuY29udGVudCkgfSwKCSLpmpDol48iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX291dHB1dCkgfSwKCSLnu5PmnZ8iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5fdGFyZ2V0KSB9LAoJIuWIoOmZpCI6IGZ1bmN0aW9uKGV2ZW50LCBzdWIpIHsgc3ViLnBhZ2UuUmVtb3ZlKHN1Yiwgc3ViLl90YXJnZXQpIH0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vdGFibGUuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJCWNhbi51c2VyLmlzTW9iaWxlICYmICFjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX2FjdGlvbikKCQl2YXIgY2JzID0gY2FuLm9uaW1wb3J0W2Nhbi5fYXJnc1sic3R5bGUiXV07IGlmIChjYW4uYmFzZS5pc0Z1bmMoY2JzKSkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdGFyZ2V0LCBjYW4uX2FyZ3NbInN0eWxlIl0pCgkJCXJldHVybiBjYnMoY2FuLCBtc2csIHRhcmdldCkKCQl9CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgdGFyZ2V0KQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgbnVsbCwgdGFyZ2V0KQoJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZywgdGFyZ2V0KQoJCWNhbi5vbm1vdGlvbi5zdG9yeS5hdXRvKGNhbiwgdGFyZ2V0KQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJfSwKCglfcHJvY2VzczogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQltc2cuT3B0aW9uKGljZS5NU0dfVE9BU1QpICYmIGNhbi51c2VyLnRvYXN0KGNhbiwgbXNnLk9wdGlvbihpY2UuTVNHX1RPQVNUKSkKCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmltcG9ydCwgbXNnLk9wdGlvbihpY2UuTVNHX1BST0NFU1MpXSwgW2NhbiwgbXNnXSkKCX0sCgljYXJkOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIHRhcmdldCwgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7CgkJCXJldHVybiB7dmlldzogIml0ZW0iLCBsaXN0OiBbCgkJCQl7dmlldzogWyJ0aXRsZSIsICJkaXYiLCB2YWx1ZS5uYW1lXX0sCgkJCQl7dmlldzogWyJjb250ZW50IiwgImRpdiIsIHZhbHVlLnRleHRdfSwKCQkJCXt2aWV3OiAib3BlcmF0ZSIsIGlubmVyOiB2YWx1ZS5hY3Rpb24sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLnJlcXVlc3QoZXZlbnQsIHZhbHVlKQoJCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBldmVudC50YXJnZXQubmFtZV0pCgkJCQl9fSwKCQkJXX0KCQl9KSkKCX0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5o6n5Lu25Lqk5LqSIiwgbGlzdDogW119KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9pbnB1dC5qcyIKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgY2IsIHRhcmdldCkgewoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKTsgc3dpdGNoIChtZXRhLnR5cGUpIHsKCQkJY2FzZSBodG1sLlNFTEVDVDogbWV0YS52YWx1ZSAmJiAodGFyZ2V0LnZhbHVlID0gbWV0YS52YWx1ZSk7IGJyZWFrCgkJCWNhc2UgaHRtbC5CVVRUT046IG1ldGEuYWN0aW9uID09IGljZS5BVVRPICYmIHRhcmdldC5jbGljaygpOyBicmVhawoJCX0KCX0sCglydW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnJ1bihldmVudCkgfSwKCWxpc3Q6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5Db25mKCJtb2RlIikgIT0gInNpbXBsZSIgJiYgY2FuLnJ1bihldmVudCkgfSwKCWJhY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmltcG9ydC5fYmFjayhjYW4uc3VwKSB9LAoJcmVmcmVzaDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ucnVuKGV2ZW50KSB9LAoKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5yZXF1ZXN0KGV2ZW50LCB7X3RvYXN0OiAi5omn6KGM5LitLi4uIn0pCgkJY2FuLkNvbmYobWRiLlRZUEUpID09IGh0bWwuQlVUVE9OICYmIGNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjYW4uQ29uZihtZGIuTkFNRSldLmNvbmNhdChjYW4uc3VwLklucHV0KCkpKQoJfSwKCW9uY2hhbmdlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAucmVxdWVzdChldmVudCwge190b2FzdDogIuaJp+ihjOS4rS4uLiJ9KQoJCWlmIChjYW4uQ29uZihtZGIuVFlQRSkgPT0gaHRtbC5TRUxFQ1QpIHsgY2FuLnJ1bihldmVudCkgfQoJfSwKCW9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KQoJCWlmIChjYW4uQ29uZihtZGIuVFlQRSkgPT0gaHRtbC5URVhUQVJFQSkgeyBpZiAoIWV2ZW50LmN0cmxLZXkpIHsgcmV0dXJuIH0gfQoJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FTlRFUikgewoJCQljYW4ucnVuKGV2ZW50KSwgY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgZXZlbnQudGFyZ2V0KQoJCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQl9IGlmICghZXZlbnQuY3RybEtleSkgeyByZXR1cm4gfQoKCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQljYXNlICJiIjogY2FuLkNsb25lSW5wdXQoKTsgYnJlYWsKCQkJY2FzZSAibSI6IGNhbi5DbG9uZUZpZWxkKCk7IGJyZWFrCgkJCWRlZmF1bHQ6IHJldHVybgoJCX0gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgl9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL3N0b3J5L2Zvcm0uanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YXJnZXQsICJmb3JtIikKCQltc2cuUHVzaCgidHlwZSIsICJ0ZXh0IikKCQltc2cuUHVzaCgibmFtZSIsICJuYW1lIikKCQltc2cuUHVzaCgidmFsdWUiLCAiaGFydmV5c2hhbyIpCgkJbXNnLlB1c2goImFjdGlvbiIsICJrZXkiKQoKCQltc2cuUHVzaCgidHlwZSIsICJ0ZXh0IikKCQltc2cuUHVzaCgibmFtZSIsICJhZ2UiKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICIxOCIpCgkJbXNnLlB1c2goImFjdGlvbiIsICIiKQoKCQltc2cuUHVzaCgidHlwZSIsICJzZWxlY3QiKQoJCW1zZy5QdXNoKCJuYW1lIiwgIm1hbGUiKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICJtYWxlLGZlbWFsZSIpCgkJbXNnLlB1c2goImFjdGlvbiIsICIiKQoKCQltc2cuUHVzaCgidHlwZSIsICJ0ZXh0YXJlYSIpCgkJbXNnLlB1c2goIm5hbWUiLCAiaW50cm8iKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICJwcm9ncmFtIikKCQltc2cuUHVzaCgiYWN0aW9uIiwgIiIpCgoJCW1zZy5QdXNoKCJ0eXBlIiwgImJ1dHRvbiIpCgkJbXNnLlB1c2goIm5hbWUiLCAic3VibWl0IikKCQltc2cuUHVzaCgidmFsdWUiLCAi5o+Q5LqkIikKCQltc2cuUHVzaCgiYWN0aW9uIiwgIiIpCgoJCXZhciBhY3Rpb24gPSAiIjsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpIHsKCQkJc3dpdGNoICh2YWx1ZS50eXBlKSB7CgkJCQljYXNlIGh0bWwuQlVUVE9OOiBhY3Rpb24gPSBhY3Rpb258fHZhbHVlLm5hbWUKCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogIml0ZW0iLCBsaXN0OiBbCgkJCQkJCXt2aWV3OiBbImlucHV0Il0sIGxpc3Q6IFt7dHlwZTogaHRtbC5JTlBVVCwgc3R5bGU6IHt3aWR0aDogKGNhbi5Db25mV2lkdGgoKS05MCkvMn0sIGRhdGE6IHt0eXBlOiB2YWx1ZS50eXBlLCB2YWx1ZTogdmFsdWUudmFsdWV9LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQkJdmFyIGFyZ3MgPSBbY3R4LkFDVElPTiwgYWN0aW9uXQoJCQkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCAiLmFyZ3MiLCBmdW5jdGlvbihpdGVtKSB7IGFyZ3MucHVzaChpdGVtLm5hbWUsIGl0ZW0udmFsdWUpfSkKCQkJCQkJCWNhbi5ydW4oZXZlbnQsIGFyZ3MpCgkJCQkJCX19XX0sCgkJCQkJXX1dKQoJCQkJCWJyZWFrCgkJCQljYXNlIGh0bWwuU0VMRUNUOgoJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiAiaXRlbSIsIGxpc3Q6IFsKCQkJCQkJe3ZpZXc6IFsibGFiZWwiXSwgbGlzdDogW3t0ZXh0OiB2YWx1ZS5uYW1lfV19LAoJCQkJCQl7dmlldzogWyJpbnB1dCJdLCBsaXN0OiBbe3R5cGU6IGh0bWwuU0VMRUNULCBjbGFzc05hbWU6ICJhcmdzIiwgc3R5bGU6IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpLTEwMH0sCgkJCQkJCQlkYXRhOiB2YWx1ZSwgbGlzdDogY2FuLmNvcmUuTGlzdChjYW4uY29yZS5TcGxpdCh2YWx1ZS52YWx1ZSksIGZ1bmN0aW9uKHYpIHsgcmV0dXJuIHt0eXBlOiBodG1sLk9QVElPTiwgbmFtZTogdiwgdmFsdWU6IHYsIGlubmVyOiB2fSB9KSB9XX0sCgkJCQkJXX1dKQoJCQkJCWJyZWFrCgkJCQljYXNlIGh0bWwuVEVYVEFSRUE6CgkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogWwoJCQkJCQl7dmlldzogWyJsYWJlbCJdLCBsaXN0OiBbe3RleHQ6IHZhbHVlLm5hbWV9XX0sCgkJCQkJCXt2aWV3OiBbImlucHV0Il0sIGxpc3Q6IFt7dHlwZTogaHRtbC5URVhUQVJFQSwgY2xhc3NOYW1lOiAiYXJncyIsIHN0eWxlOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKS0xMDB9LCBkYXRhOiB2YWx1ZX1dfSwKCQkJCQldfV0pCgkJCQkJYnJlYWsKCQkJCWRlZmF1bHQ6CgkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogWwoJCQkJCQl7dmlldzogWyJsYWJlbCJdLCBsaXN0OiBbe3RleHQ6IHZhbHVlLm5hbWV9XX0sCgkJCQkJCXt2aWV3OiBbImlucHV0Il0sIGxpc3Q6IFt7dHlwZTogImlucHV0IiwgY2xhc3NOYW1lOiAiYXJncyIsIHN0eWxlOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKS0xMDB9LCBkYXRhOiB2YWx1ZX1dfSwKCQkJCQldfV0pCgkJCX0KCQl9KQoJfSwKfSwgWyIiXSkKCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvdGVhbS9wbGFuLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB0YXJnZXQpCgkJY2FuLnVpID0gY2FuLm9ubGF5b3V0LnByb2ZpbGUoY2FuKQoJCWNhbi5vbmltcG9ydFtjYW4uT3B0aW9uKCJzY2FsZSIpfHwid2VlayJdKGNhbiwgbXNnKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9qZWN0LCB7c3R5bGU6IHsibWF4LWhlaWdodCI6IGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodH19KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9maWxlLCB7c3R5bGU6IHsibWF4LWhlaWdodCI6IGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodH19KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5wcm9maWxlLCB7c3R5bGU6IHtkaXNwbGF5OiAiYmxvY2sifX0pCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgIWNhbi51c2VyLmlzTGFuZHNjYXBlKCkgJiYgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJfSwKCV9jb250ZW50OiBmdW5jdGlvbihjYW4sIG1zZywgaGVhZCwgbGlzdCwga2V5LCBnZXQsIHNldCkgewoJCXZhciBoYXNoID0ge307IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsgdmFyIGsgPSBrZXkoY2FuLmJhc2UuRGF0ZSh2YWx1ZS5iZWdpbl90aW1lKSk7IGhhc2hba10gPSAoaGFzaFtrXXx8W10pLmNvbmNhdChbdmFsdWVdKSB9KQoKCQljYW4uc3VwLnRhc2sgJiYgKGNhbi5zdXAudGFzay5fdGFyZ2V0ID0gbnVsbCkKCQl2YXIgYmVnaW5fdGltZSA9IGNhbi5iYXNlLkRhdGUoY2FuLk9wdGlvbigiYmVnaW5fdGltZSIpKQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5jb250ZW50LCBbe3ZpZXc6IFtjaGF0LkNPTlRFTlQsIGh0bWwuVEFCTEVdLCBsaXN0OiBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGhvdXIsIHJvdykgewoJCQlyZXR1cm4ge3R5cGU6IGh0bWwuVFIsIGxpc3Q6IGNhbi5jb3JlLkxpc3QoaGVhZCwgZnVuY3Rpb24od2VlaywgY29sKSB7CgkJCQlpZiAocm93ID09IDApIHsgcmV0dXJuIHt0ZXh0OiBbd2VlaywgaHRtbC5USF19IH0KCQkJCWlmIChjb2wgPT0gMCkgeyByZXR1cm4ge3RleHQ6IFtob3VyLCBodG1sLlREXX0gfQoJCQkJcmV0dXJuIGNhbi5vbmltcG9ydC5fdGFzayhjYW4sIG1zZywgZ2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93LCBoYXNoKSwgc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSkKCQkJfSl9CgkJfSkgfV0pCgkJaWYgKG1zZy5MZW5ndGgoKSA9PSAwKSB7IHJldHVybiB9CgkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBpZiAoIWNhbi5zdXAudGFzaykgeyByZXR1cm4gfQoJCQl2YXIgdGFyZ2V0ID0gY2FuLnN1cC50YXNrLl90YXJnZXR8fGNhbi50YXNrLl90YXJnZXQKCQkJY2FuLnN1cC50YXNrID0gbnVsbCwgdGFyZ2V0LmNsaWNrKCkKCQkJY2FuLlN0YXR1cygiY291bnQiLCBtc2cuTGVuZ3RoKCkpCgkJfSkKCX0sCglfdGFzazogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIHRpbWUpIHsgcmV0dXJuIHt0ZXh0OiBbIiIsIGh0bWwuVERdLAoJCW9uZGJsY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmFjdGlvbi5pbnNlcnRUYXNrKGV2ZW50LCBjYW4sIHRpbWUrY2FuLmJhc2UuVGltZShudWxsLCAiJXktJW0tJWQgJUg6JU06JVMiKS5zbGljZSh0aW1lLmxlbmd0aCkpCgkJfSwKCQlvbmRyb3A6IGZ1bmN0aW9uKGV2ZW50KSB7IGV2ZW50LnByZXZlbnREZWZhdWx0KCkKCQkJY2FuLmRyb3AoZXZlbnQsIGV2ZW50LnRhcmdldCwgdGltZSkKCQl9LAoJCW9uZHJhZ292ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7IGV2ZW50LnByZXZlbnREZWZhdWx0KCkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVEQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdFtldmVudC50YXJnZXQgPT0gaXRlbT8gImFkZCI6ICJkZWwiXShjYW4sIGl0ZW0sICJvdmVyIikKCQkJfSkKCQl9LAoJCWxpc3Q6IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24odGFzaykgeyByZXR1cm4gY2FuLmJhc2UuaXNTdHJpbmcodGFzayk/IHt0ZXh0OiBbdGFzaywgaHRtbC5ESVYsICJkYXRlIl19OgoJCQkJe3RleHQ6IFtjYW4ub25leHBvcnRbY2FuLkFjdGlvbigidmlldyIpfHwidGV4dCJdKGNhbiwgdGFzayksIGh0bWwuRElWLCBjYW4ub25leHBvcnQuc3R5bGUoY2FuLCB0YXNrKV0sCgkJCQkJb25kcmFnc3RhcnQ6IGZ1bmN0aW9uKGV2ZW50KSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7IGNhbi5kcm9wID0gZnVuY3Rpb24oZXZlbnQsIHRkLCB0aW1lKSB7IHRkLmFwcGVuZCh0YXJnZXQpCgkJCQkJCWNhbi5vbmFjdGlvbi5tb2RpZnlUYXNrKGV2ZW50LCBjYW4sIHRhc2ssICJiZWdpbl90aW1lIiwgdGltZSt0YXNrLmJlZ2luX3RpbWUuc2xpY2UodGltZS5sZW5ndGgpLCB0YXNrLmJlZ2luX3RpbWUpCgkJCQkJfSB9LCBkcmFnZ2FibGU6IHRpbWUgIT0gdW5kZWZpbmVkLAoKCQkJCQl0aXRsZTogY2FuLm9uZXhwb3J0LnRpdGxlKGNhbiwgdGFzayksIF9pbml0OiBmdW5jdGlvbih0YXJnZXQpIHsKCQkJCQkJdmFyIGl0ZW0gPSBjYW4ub25hcHBlbmQuaXRlbShjYW4sIGh0bWwuSVRFTSwge25pY2s6IHRhc2submFtZSsiOiIrdGFzay50ZXh0fSwgZnVuY3Rpb24oKSB7CgkJCQkJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IGNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5URCwgdGFyZ2V0LnBhcmVudE5vZGUpIH0pCgkJCQkJCQljYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCB0YXNrKQoJCQkJCQl9LCBmdW5jdGlvbigpIHsKCgkJCQkJCX0sIGNhbi51aS5wcm9qZWN0KTsgdGFzay5fdGFyZ2V0ID0gdGFyZ2V0LCBjYW4udGFzayA9IGNhbi50YXNrfHx0YXNrLCBjYW4uc3VwLnRhc2sgPSBjYW4uc3VwLnRhc2t8fHRhc2sKCQkJCQkJY2FuLnN1cC50YXNrLnpvbmUgPT0gdGFzay56b25lICYmIGNhbi5zdXAudGFzay5pZCA9PSB0YXNrLmlkICYmIChjYW4uc3VwLnRhc2suX3RhcmdldCA9IHRhcmdldCkKCQkJCQkJdGFyZ2V0Lm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgeyBpdGVtLmNsaWNrKCkgfQoJCQkJCX0sCgkJCQl9CgkJfSksCgl9IH0sCglfcHJvZmlsZTogZnVuY3Rpb24oY2FuLCB0YXNrKSB7CgkJaWYgKGNhbi5zdXAudGFzayAmJiBjYW4uc3VwLnRhc2sucG9kID09IHRhc2sucG9kICYmIGNhbi5zdXAudGFzay5pZCA9PSB0YXNrLmlkKSB7IHJldHVybiB9CgkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gY2FuLnN1cC50YXNrID0gdGFzaywgY2FuLlN0YXR1cyh0YXNrKSwgW3Rhc2sucG9kLCB0YXNrLnpvbmUsIHRhc2suaWRdLmpvaW4oaWNlLlBUKSB9LCBjYW4udWkucHJvZmlsZSwgY2FuLnVpLmRpc3BsYXkpKSB7IHJldHVybiB9CgoJCXRhc2suZXh0cmEgJiYgY2FuLmNvcmUuSXRlbShjYW4uYmFzZS5PYmoodGFzay5leHRyYSksIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgdGFza1siZXh0cmEuIitrZXldID0gdmFsdWUgfSksIGRlbGV0ZSh0YXNrLmV4dHJhKQoJCXZhciB0YWJsZSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCBjYW4udWkucHJvZmlsZSwgW3t2aWV3OiBbY2hhdC5DT05URU5ULCBodG1sLlRBQkxFXSwgbGlzdDogW3t0aDogWyJrZXkiLCAidmFsdWUiXX1dfV0pLmZpcnN0CgkJY2FuLmNvcmUuSXRlbSh0YXNrLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGtleSAhPSAiX3RhcmdldCIgJiYgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFibGUsIFt7CgkJCXRkOiBba2V5LCBrZXkgPT0gInBvZCIgJiYgdmFsdWUgIT0gIiI/IGNhbi5wYWdlLkZvcm1hdCgiYSIsIGNhbi5taXNjLk1lcmdlVVJMKGNhbiwge3BvZDogdmFsdWV9KSwgdmFsdWUpOiB2YWx1ZV0sCgkJCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7IGlmIChldmVudC50YXJnZXQudHlwZSA9PSAiYnV0dG9uIikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5zdXAudGFzaykKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBldmVudC50YXJnZXQubmFtZV0sIGZ1bmN0aW9uKG1zZykgeyBjYW4uVXBkYXRlKCkgfSwgdHJ1ZSkKCQkJfSB9LAoJCQlvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24ubW9kaWZ5KGNhbiwgZXZlbnQudGFyZ2V0LCBmdW5jdGlvbihldiwgdmFsdWUsIG9sZCkgewoJCQkJY2FuLm9uYWN0aW9uLm1vZGlmeVRhc2soZXZlbnQsIGNhbiwgdGFzaywga2V5LCB2YWx1ZSkKCQkJfSwge25hbWU6IGtleSwgYWN0aW9uOiBrZXkuaW5kZXhPZigidGltZSIpID4gMD8gImRhdGUiOiAia2V5In0pIH0sCgkJfV0pIH0pLCBjYW4ub25pbXBvcnQuX2Rpc3BsYXkoY2FuLCB0YXNrKQoJfSwKCV9kaXNwbGF5OiBmdW5jdGlvbihjYW4sIHRhc2spIHsgaWYgKCF0YXNrWyJleHRyYS5jbWQiXSkgeyByZXR1cm4gfQoJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCB7dHlwZTogY2hhdC5TVE9SWSwgY3R4OiB0YXNrWyJleHRyYS5jdHgiXSwgY21kOiB0YXNrWyJleHRyYS5jbWQiXSwgYXJnOiB0YXNrWyJleHRyYS5hcmciXX0sIGZ1bmN0aW9uKHN1YiwgbWV0YSkgewoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwga2l0LkRpY3QoInRhc2sucG9kIiwgdGFza1sicG9kIl0sICJ0YXNrLnpvbmUiLCB0YXNrLnpvbmUsICJ0YXNrLmlkIiwgdGFzay5pZCkpCgkJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgdGFza1ttZGIuWk9ORV0sIHRhc2tbbWRiLklEXV0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJfQoJCX0sIGNhbi51aS5kaXNwbGF5KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5kaXNwbGF5LCB7c3R5bGU6IHtkaXNwbGF5OiBodG1sLkJMT0NLfX0pCgl9LAoKCWRheTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVhZCA9IFsiaG91ciIsICJ0YXNrIl0KCQl2YXIgbGlzdCA9IFswXTsgZm9yICh2YXIgaSA9IDc7IGkgPCAyNDsgaSsrKSB7IGxpc3QucHVzaChjYW4uYmFzZS5OdW1iZXIoaSwgMikpIH0KCgkJZnVuY3Rpb24ga2V5KHRpbWUpIHsgcmV0dXJuIGNhbi5iYXNlLk51bWJlcih0aW1lLmdldEhvdXJzKCksIDIpIH0KCQlmdW5jdGlvbiBnZXQoYmVnaW5fdGltZSwgY29sLCByb3csIGhhc2gpIHsgcmV0dXJuIGhhc2hbbGlzdFtyb3ddXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBjYW4uYmFzZS5UaW1lKGJlZ2luX3RpbWUsICIleS0lbS0lZCAiKStsaXN0W3Jvd10gfQoKCQljYW4ub25pbXBvcnQuX2NvbnRlbnQoY2FuLCBtc2csIGhlYWQsIGxpc3QsIGtleSwgZ2V0LCBzZXQpCgl9LAoJd2VlazogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVhZCA9IFsiaG91ciJdLmNvbmNhdChbIuWRqOaXpSIsICLlkajkuIAiLCAi5ZGo5LqMIiwgIuWRqOS4iSIsICLlkajlm5siLCAi5ZGo5LqUIiwgIuWRqOWFrSJdKQoJCXZhciBsaXN0ID0gWzBdOyBmb3IgKHZhciBpID0gNzsgaSA8IDI0OyBpKyspIHsgbGlzdC5wdXNoKGNhbi5iYXNlLk51bWJlcihpLCAyKSkgfQoKCQlmdW5jdGlvbiBrZXkodGltZSkgeyByZXR1cm4gdGltZS5nZXREYXkoKSsiICIrY2FuLmJhc2UuTnVtYmVyKHRpbWUuZ2V0SG91cnMoKSwgMikgfQoJCWZ1bmN0aW9uIGdldChiZWdpbl90aW1lLCBjb2wsIHJvdywgaGFzaCkgeyByZXR1cm4gaGFzaFtjb2wtMSsiICIrbGlzdFtyb3ddXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBjYW4uYmFzZS5UaW1lKGNhbi5iYXNlLlRpbWVBZGQoYmVnaW5fdGltZSwgLWJlZ2luX3RpbWUuZ2V0RGF5KCkrY29sLTEpLCAiJXktJW0tJWQgIikrbGlzdFtyb3ddIH0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKCW1vbnRoOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciBoZWFkID0gWyJvcmRlciJdLmNvbmNhdChbIuWRqOaXpSIsICLlkajkuIAiLCAi5ZGo5LqMIiwgIuWRqOS4iSIsICLlkajlm5siLCAi5ZGo5LqUIiwgIuWRqOWFrSJdKQoJCXZhciBsaXN0ID0gWzBdOyBmb3IgKHZhciBpID0gMTsgaSA8IDY7IGkrKykgeyBsaXN0LnB1c2goaSkgfQoKCQlmdW5jdGlvbiBrZXkodGltZSkgeyByZXR1cm4gY2FuLmJhc2UuVGltZSh0aW1lLCAiJXktJW0tJWQiKSB9CgkJZnVuY3Rpb24gZ2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93LCBoYXNoKSB7CgkJCXZhciBiZWdpbiA9IGNhbi5iYXNlLlRpbWVBZGQoYmVnaW5fdGltZSwgLShiZWdpbl90aW1lLmdldERhdGUoKS0xKSkKCQkJdmFyIGxhc3QgPSBjYW4uYmFzZS5UaW1lQWRkKGJlZ2luX3RpbWUsIC0oYmVnaW5fdGltZS5nZXREYXRlKCktMSktYmVnaW4uZ2V0RGF5KCkpCgkJCXZhciBkYXkgPSBjYW4uYmFzZS5UaW1lQWRkKGxhc3QsIChyb3ctMSkqNytjb2wpCgkJCXJldHVybiBbZGF5LmdldERhdGUoKSsiIl0uY29uY2F0KGhhc2hba2V5KGRheSldfHxbXSkKCQl9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7CgkJCXZhciBiZWdpbiA9IGNhbi5iYXNlLlRpbWVBZGQoYmVnaW5fdGltZSwgLShiZWdpbl90aW1lLmdldERhdGUoKS0xKSkKCQkJdmFyIGxhc3QgPSBjYW4uYmFzZS5UaW1lQWRkKGJlZ2luX3RpbWUsIC0oYmVnaW5fdGltZS5nZXREYXRlKCktMSktYmVnaW4uZ2V0RGF5KCkpCgkJCXZhciBkYXkgPSBjYW4uYmFzZS5UaW1lQWRkKGxhc3QsIChyb3ctMSkqNytjb2wpCgkJCXJldHVybiBrZXkoZGF5KQoJCX0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKCXllYXI6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJdmFyIGhlYWQgPSBbIm1vbnRoIl0uY29uY2F0KFsi5ZGo5pelIiwgIuWRqOS4gCIsICLlkajkuowiLCAi5ZGo5LiJIiwgIuWRqOWbmyIsICLlkajkupQiLCAi5ZGo5YWtIl0pOwoJCXZhciBsaXN0ID0gWzBdOyBmb3IgKHZhciBpID0gMTsgaSA8IDEzOyBpKyspIHsgbGlzdC5wdXNoKGkpIH0KCgkJZnVuY3Rpb24ga2V5KHRpbWUpIHsgcmV0dXJuIGNhbi5iYXNlLlRpbWUodGltZSwgIiV5LSVtICIpK3RpbWUuZ2V0RGF5KCkgfQoJCWZ1bmN0aW9uIGdldChiZWdpbl90aW1lLCBjb2wsIHJvdywgaGFzaCkgeyByZXR1cm4gaGFzaFtiZWdpbl90aW1lLmdldEZ1bGxZZWFyKCkrIi0iK2Nhbi5iYXNlLk51bWJlcihyb3csIDIpKyIgIisoY29sLTEpXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBiZWdpbl90aW1lLmdldEZ1bGxZZWFyKCkrIi0iK2Nhbi5iYXNlLk51bWJlcihsaXN0W3Jvd10sIDIpIH0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKCWxvbmc6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJdmFyIGJlZ2luX3RpbWUgPSBjYW4uYmFzZS5EYXRlKGNhbi5iYXNlLlRpbWUoY2FuLk9wdGlvbigiYmVnaW5fdGltZSIpLCAiJXktJW0tJWQgJUg6JU06JVMiKSkKCQl2YXIgYmVnaW4gPSBiZWdpbl90aW1lLmdldEZ1bGxZZWFyKCkgLSA1CgoJCXZhciBoZWFkID0gWyJtb250aCJdOyBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHsgaGVhZC5wdXNoKGJlZ2luK2kpIH0KCQl2YXIgbGlzdCA9IFswXTsgZm9yICh2YXIgaSA9IDE7IGkgPCAxMzsgaSsrKSB7IGxpc3QucHVzaChpKSB9CgoJCWZ1bmN0aW9uIGtleSh0aW1lKSB7IHJldHVybiBjYW4uYmFzZS5UaW1lKHRpbWUsICIleS0lbSIpIH0KCQlmdW5jdGlvbiBnZXQoYmVnaW5fdGltZSwgY29sLCByb3csIGhhc2gpIHsgcmV0dXJuIGhhc2hbYmVnaW4rY29sLTErIi0iK2Nhbi5iYXNlLk51bWJlcihyb3csIDIpXSB9CgkJZnVuY3Rpb24gc2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93KSB7IHJldHVybiBiZWdpbitjb2wtMSsiLSIrY2FuLmJhc2UuTnVtYmVyKHJvdywgMikgfQoKCQljYW4ub25pbXBvcnQuX2NvbnRlbnQoY2FuLCBtc2csIGhlYWQsIGxpc3QsIGtleSwgZ2V0LCBzZXQpCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIue7hOS7tuS6pOS6kiIsIGxpc3Q6IFsKCQkiaW5zZXJ0IiwgImV4cG9ydCIsICJpbXBvcnQiLAoJCVsibGV2ZWwiLCAiYWxsIiwgImwxIiwgImwyIiwgImwzIiwgImw0IiwgImw1Il0sCgkJWyJzdGF0dXMiLCAiYWxsIiwgInByZXBhcmUiLCAicHJvY2VzcyIsICJjYW5jZWwiLCAiZmluaXNoIl0sCgkJWyJzY29yZSIsICJhbGwiLCAiczEiLCAiczIiLCAiczMiLCAiczQiLCAiczUiXSwKCQlbInZpZXciLCAiIiwgIm5hbWUiLCAidGV4dCIsICJsZXZlbCIsICJzY29yZSJdLAoJXSwKCWluc2VydFRhc2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRpbWUpIHsgdmFyIG1zZyA9IGNhbi5zdXAucmVxdWVzdChldmVudCwge2JlZ2luX3RpbWU6IHRpbWV9KQoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIGNhbi5Db25mKCJmZWF0dXJlLmluc2VydCIpLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0KSB7CgkJCWNhbi5ydW4oZXZlbnQsIGNhbi5iYXNlLlNpbXBsZShjdHguQUNUSU9OLCBtZGIuSU5TRVJULCBkYXRhLCAiYmVnaW5fdGltZSIsIHRpbWUpLCB0cnVlKQoJCX0pCgl9LAoJbW9kaWZ5VGFzazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFzaywga2V5LCB2YWx1ZSkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHRhc2spCgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5NT0RJRlksIGtleSwgdmFsdWUsIHRhc2tba2V5XV0pCgl9LAoKCV9maWx0ZXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgdmFyIGNvdW50ID0gMAoJCWlmICh2YWx1ZSA9PSAiYWxsIikgewoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgImRpdi5pdGVtIiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIGl0ZW0sICJoaWRlIiksIGNvdW50KysKCQkJfSkKCQl9IGVsc2UgewoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgImRpdi5pdGVtIiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGl0ZW0sICJoaWRlIikKCQkJfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJkaXYuIit2YWx1ZSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIGl0ZW0sICJoaWRlIiksIGNvdW50KysKCQkJfSkKCQl9CgkJY2FuLkFjdGlvbihrZXksIHZhbHVlKSwgY2FuLlN0YXR1cygiY291bnQiLCBjb3VudCkKCX0sCglsZXZlbDogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2ZpbHRlcihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB9LAoJc3RhdHVzOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fZmlsdGVyKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIH0sCglzY29yZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2ZpbHRlcihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB9LAoJdmlldzogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgewoJCWNhbi5BY3Rpb24oa2V5LCB2YWx1ZSkKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkucHJvamVjdCkKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkuY29udGVudCkKCQljYW4ub25pbXBvcnRbY2FuLk9wdGlvbigic2NhbGUiKV0oY2FuLCBjYW4uX21zZykKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyJjb3VudCIsICJiZWdpbl90aW1lIiwgInpvbmUiLCAiaWQiLCAidHlwZSIsICJuYW1lIiwgInRleHQiXSwKCW5hbWU6IGZ1bmN0aW9uKGNhbiwgdGFzaykgeyByZXR1cm4gdGFzay5uYW1lIH0sCgl0ZXh0OiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuIHRhc2submFtZSsiOiAiKyh0YXNrLnRleHR8fCIiKSB9LAoJbGV2ZWw6IGZ1bmN0aW9uKGNhbiwgdGFzaykgeyByZXR1cm4gImwtIisodGFzay5sZXZlbHx8MykrIjogIisodGFzay5uYW1lfHwiIikgfSwKCXNjb3JlOiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuICJzLSIrKHRhc2subGV2ZWx8fDMpKyI6ICIrKHRhc2submFtZXx8IiIpIH0sCgl0aXRsZTogZnVuY3Rpb24oY2FuLCB0YXNrKSB7IHJldHVybiB0YXNrLnpvbmUrIjogIisodGFzay50eXBlfHwiIikgfSwKCXN0eWxlOiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuIFsiaXRlbSIsIHRhc2suc3RhdHVzLCAiaWQiK3Rhc2suaWQsICJsIisodGFzay5sZXZlbHx8IiIpLCAicyIrKHRhc2suc2NvcmV8fCIiKV0uam9pbigiICIpIH0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vc3RvcnkvanNvbi5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgImpzb24iKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHRhcmdldCksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5zaG93KGNhbiwgY2FuLmJhc2UuT2JqKG1zZy5SZXN1bHQoKSwge30pLCB0YXJnZXQpCgl9LAoJc2hvdzogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKCQlmdW5jdGlvbiBzaG93KGRhdGEsIHRhcmdldCwgaW5kZXgsIHRvdGFsKSB7IHZhciBsaXN0CgkJCXN3aXRjaCAodHlwZW9mIGRhdGEpIHsKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6CgkJCQkJaWYgKGRhdGEgPT0gbnVsbCkgewoJCQkJCQlsaXN0ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6ICJudWxsIn1dKS5pdGVtCgkJCQkJCWJyZWFrCgkJCQkJfQoJCQkJCWZ1bmN0aW9uIHdyYXAoYmVnaW4sIGVuZCwgYWRkLCBjYikgewoJCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dGV4dDogYmVnaW59XSkKCQkJCQkJYWRkICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBbIi4uLiIsIGh0bWwuU1BBTiwgIm5vbmNlIl19XSksIGNiKCkKCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IGVuZH1dKQoJCQkJCX0KCQkJCQlmdW5jdGlvbiB0b2dnbGUobGlzdCkgeyBsaXN0ICYmIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBsaXN0KSB9CgkJCQkJZnVuY3Rpb24gX2l0ZW0oKSB7CgkJCQkJCWxpc3QgPSBsaXN0IHx8IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBodG1sLkxJU1R9XSkubGlzdAoJCQkJCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgbGlzdCwgW3t2aWV3OiBodG1sLklURU19XSkuaXRlbQoJCQkJCX0KCgkJCQkJaWYgKGNhbi5iYXNlLmlzQXJyYXkoZGF0YSkpIHsgLy8g5pWw57uECgkJCQkJCXdyYXAoIlsiLCAiXSIsIGRhdGEubGVuZ3RoID4gMCwgZnVuY3Rpb24oKSB7IGNhbi5jb3JlLkxpc3QoZGF0YSwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7IHZhciBpdGVtID0gX2l0ZW0oKQoJCQkJCQkJc2hvdyh2YWx1ZSwgaXRlbSwgaW5kZXgsIGRhdGEubGVuZ3RoKQoJCQkJCQl9KSB9KQoJCQkJCX0gZWxzZSB7IC8vIOWvueixoQoJCQkJCQl2YXIgbGVuZ3RoID0gY2FuLmNvcmUuSXRlbShkYXRhKS5sZW5ndGgsIGNvdW50ID0gMAoJCQkJCQl3cmFwKCJ7IiwgIn0iLCBsZW5ndGggPiAwLCBmdW5jdGlvbigpIHsgY2FuLmNvcmUuSXRlbShkYXRhLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHZhciBpdGVtID0gX2l0ZW0oKQoJCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgaXRlbSwgW3t0ZXh0OiBbJyInK2tleSsnIicsIGh0bWwuU1BBTiwgImtleSJdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyB0b2dnbGUoc3ViKSB9fSwge3RleHQ6ICc6ICd9XSkKCQkJCQkJCXZhciBzdWIgPSBzaG93KHZhbHVlLCBpdGVtLCBjb3VudCsrLCBsZW5ndGgpCgkJCQkJCX0pIH0pCgkJCQkJfQoJCQkJCWJyZWFrCgkJCQljYXNlIGxhbmcuU1RSSU5HOiAvKiDlrZfkuLIgKi8gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IFsnIicrZGF0YSsnIicsIGh0bWwuU1BBTiwgbGFuZy5TVFJJTkddfV0pOyBicmVhawoJCQkJZGVmYXVsdDogLyog5YW25a6DICovIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBbJycrZGF0YSsnJywgaHRtbC5TUEFOLCAiY29uc3QiXX1dKQoJCQl9CgkJCShpbmRleCA8IHRvdGFsLTEpICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBpY2UuRlN9XSkKCQkJcmV0dXJuIGxpc3QKCQl9OyBzaG93KGRhdGEsIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBodG1sLklURU19XSkuaXRlbSwgMCwgMCkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogWyLlsZXlvIAiLCAi5oqY5Y+gIiwgIuWkjeWItiJdLAoJIuWxleW8gCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgImRpdi5saXN0IGRpdi5saXN0IiwgZnVuY3Rpb24obGlzdCkgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgbGlzdCwgdHJ1ZSkKCQl9KQoJfSwKCSLmipjlj6AiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYubGlzdCBkaXYubGlzdCIsIGZ1bmN0aW9uKGxpc3QpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGxpc3QpCgkJfSkKCX0sCgki5aSN5Yi2IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgY2FuLl9tc2cuUmVzdWx0KCkpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9pbnB1dC9rZXkuanMiClZvbGNhbm9zKCJvbmZpZ3VyZSIsIHtoZWxwOiAi5o6n5Lu26K+m5oOFIiwgbGlzdDogW10sIGtleTogewoJX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsgdmFyIGNhbGwgPSBhcmd1bWVudHMuY2FsbGVlOyB0YXJnZXQuX21zZyA9IG1zZwoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKSB7CgkJCXJldHVybiB7dGV4dDogW3ZhbHVlLCBodG1sLlREXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsgdGFyZ2V0LnZhbHVlID0gbGluZVtrZXldCgkJCQlpZiAobXNnLk9wdGlvbihpY2UuTVNHX1BST0NFU1MpICE9IGljZS5QUk9DRVNTX0FHQUlOKSB7IHJldHVybiBjYW4uY2xvc2UoKSB9CgkJCQl0YXJnZXQuX2hvbGQgPSB0cnVlCgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLklOUFVUUywgY2FuLkNvbmYobWRiLk5BTUUpLCB0YXJnZXQudmFsdWVdLCBmdW5jdGlvbihtc2cpIHsgY2FsbChjYW4sIG1zZywgdGFyZ2V0KSB9KQoJCQl9fQoJCX0pLCBjYW4uU3RhdHVzKG1kYi5UT1RBTCwgbXNnLkxlbmd0aCgpKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fdGFyZ2V0LCBtc2cuTGVuZ3RoKCkgPiAwKQoJfSwKCV9zaG93OiBmdW5jdGlvbihldmVudCwgY2FuLCBuYW1lLCBjYnMsIHRhcmdldCwgdmFsdWUpIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLklOUFVUUywgbmFtZSwgdmFsdWV8fHRhcmdldC52YWx1ZV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25maWd1cmUua2V5Ll9pbml0KGNhbiwgbXNnLCB0YXJnZXQpLCBjYW4uYmFzZS5pc0Z1bmMoY2JzKSAmJiBjYnMoY2FuLCBtc2cuTGVuZ3RoKCkgPT0gMCkKCQl9KQoJfSwKCS8vIG9uZm9jdXM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgaWYgKHRhcmdldC5fZmlndXJlKSB7IHJldHVybiB9IHRhcmdldC5fZmlndXJlID0ge307IGNiKGZ1bmN0aW9uKGNhbiwgY2JzKSB7CgkvLyAJdGFyZ2V0Ll9maWd1cmUgPSBjYW4ub25sYXlvdXQuZmlndXJlKGV2ZW50LCBjYW4sIGNhbi5fdGFyZ2V0LCBmYWxzZSwge3RvcDogY2FuLnBhZ2Uub2Zmc2V0VG9wKHRhcmdldCkrdGFyZ2V0Lm9mZnNldEhlaWdodCwgbGVmdDogY2FuLnBhZ2Uub2Zmc2V0TGVmdCh0YXJnZXQpfSkKCS8vIAljYW4ub25maWd1cmUua2V5Ll9zaG93KGV2ZW50LCBjYW4sIG1ldGEubmFtZSwgY2JzLCB0YXJnZXQpLCBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgkvLyB9KSB9LAoJb25ibHVyOiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBjYiwgdGFyZ2V0KSB7CgkJdGFyZ2V0Ll9ob2xkIHx8IGNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgeyBkZWxldGUodGFyZ2V0Ll9maWd1cmUpLCB0YXJnZXQuX2NhbiAmJiB0YXJnZXQuX2Nhbi5jbG9zZSgpIH0pCgkJdGFyZ2V0Ll9ob2xkID0gZmFsc2UKCX0sCglvbmNsaWNrOiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBjYiwgdGFyZ2V0KSB7IGlmICh0YXJnZXQuX2ZpZ3VyZSkgeyB0YXJnZXQuX2ZpZ3VyZSA9IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgY2FuLmNvcmUuVmFsdWUodGFyZ2V0LCAiX2Nhbi5fdGFyZ2V0Iil8fHt9KTsgcmV0dXJuIH0gdGFyZ2V0Ll9maWd1cmUgPSB7fTsgY2IoZnVuY3Rpb24oY2FuLCBjYnMpIHsKCQl0YXJnZXQuX2ZpZ3VyZSA9IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbikKCQljYW4ub25maWd1cmUua2V5Ll9zaG93KGV2ZW50LCBjYW4sIG1ldGEubmFtZSwgY2JzLCB0YXJnZXQpLCBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgl9KSB9LAoJb25rZXlkb3duOiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBjYiwgdGFyZ2V0LCBsYXN0KSB7IHZhciBzdWIgPSB0YXJnZXQuX2NhbgoJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCWNhc2UgbGFuZy5TSElGVDogYnJlYWsKCQkJY2FzZSBsYW5nLkNPTlRST0w6IGJyZWFrCgkJCWNhc2UgbGFuZy5FTlRFUjoKCQkJCWlmIChldmVudC5jdHJsS2V5ICYmIGNhbi5wYWdlLnRhZ2lzKGh0bWwuVEVYVEFSRUEsIHRhcmdldCkpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmMobGFzdCkgJiYgbGFzdChldmVudCwgY2FuKQoJCQkJfQoJCQkJc3ViICYmIHN1Yi5jbG9zZSgpOyBicmVhawoJCQljYXNlIGxhbmcuRVNDQVBFOiBldmVudC50YXJnZXQuYmx1cigpOyBicmVhawoJCQljYXNlIGxhbmcuUFM6IGNhbi5vbmZpZ3VyZS5rZXkuX3Nob3coZXZlbnQsIHN1YiwgbWV0YS5uYW1lLCBudWxsLCB0YXJnZXQsIHRhcmdldC52YWx1ZStpY2UuUFMpOyBicmVhawoJCQljYXNlIGxhbmcuVEFCOiAKCQkJCWlmIChjYW4ucGFnZS50YWdpcyhodG1sLlRFWFRBUkVBLCB0YXJnZXQpKSB7CgkJCQkJY2FuLm9ua2V5bWFwLmluc2VydFRleHQoZXZlbnQudGFyZ2V0LCAiXHQiKSwgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCQkJYnJlYWsKCQkJCX0KCQkJZGVmYXVsdDoKCQkJCXN1YiAmJiBjYW4ub25tb3Rpb24uc2VsZWN0VGFibGVJbnB1dChldmVudCwgc3ViLCB0YXJnZXQsIGZ1bmN0aW9uKCkgewoJCQkJCWNhbi5vbmZpZ3VyZS5rZXkuX3Nob3coZXZlbnQsIHN1YiwgbWV0YS5uYW1lLCBudWxsLCB0YXJnZXQpCgkJCQl9KSwgY2FuLmJhc2UuaXNGdW5jKGxhc3QpICYmIGxhc3QoZXZlbnQsIGNhbikKCQl9Cgl9LAp9fSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC93aWtpL2ZlZWwuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWNhbi5wYXRoID0gY2FuLnJlcXVlc3QoKSwgY2FuLmxpc3QgPSBbXSwgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7CgkJCXZhbHVlLnBhdGgubGFzdEluZGV4T2YoaWNlLlBTKT09dmFsdWUucGF0aC5sZW5ndGgtMT8gY2FuLnBhdGguUHVzaCh2YWx1ZSk6IGNhbi5saXN0LnB1c2godmFsdWUpCgkJfSkKCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJY2FuLnVpID0gY2FuLm9ubGF5b3V0LmRpc3BsYXkoY2FuLCB0YXJnZXQpCgkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgY2FuLnBhdGgsIG51bGwsIGNhbi51aS5jb250ZW50KQoJCWNhbi5kaXJfcm9vdCA9IG1zZy5PcHRpb24oImRpcl9yb290IikKCgkJY2FuLkFjdGlvbigiaGVpZ2h0IiwgbXNnLk9wdGlvbigiaGVpZ2h0Iil8fCIxMDAiKQoJCWNhbi5BY3Rpb24oImxpbWl0IiwgbXNnLk9wdGlvbigibGltaXQiKXx8IjYiKQoJCWNhbi5BY3Rpb24oInJhdGUiLCBtc2cuT3B0aW9uKCJyYXRlIil8fCIxIikKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgoJCWNhbi5iZWdpbiA9IG1zZy5PcHRpb24oImJlZ2luIil8fCIwIgoJCWNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpCgl9LAoJX2ZpbGU6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgaW5kZXgpIHsgdmFyIHAgPSBsb2NhdGlvbi5ocmVmLmluZGV4T2YoImh0dHAiKSA9PSAwPyAiIjogImh0dHA6Ly9sb2NhbGhvc3Q6OTAyMCIKCQlyZXR1cm4gcGF0aC5pbmRleE9mKCJodHRwIikgPT0gMD8gcGF0aDogcCtjYW4uYmFzZS5QYXRoKCIvc2hhcmUvbG9jYWwiLCBjYW4uZGlyX3Jvb3R8fCIiLCBwYXRoKQoJfSwKCWZpbGU6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgaW5kZXgpIHsgcGF0aCA9IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIHBhdGgsIGluZGV4KQoJCXZhciBjYiA9IGNhbi5vbmZpZ3VyZVtjYW4uYmFzZS5FeHQocGF0aCldOyBjYW4uU3RhdHVzKCJmaWxlIiwgcGF0aCkKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5kaXNwbGF5LCBbY2IoY2FuLCBwYXRoLCBpbmRleCldKQoJfSwKCXBhZ2U6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgYmVnaW4sIGxpbWl0KSB7IGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCWJlZ2luID0gcGFyc2VJbnQoYmVnaW58fGNhbi5iZWdpbiksIGxpbWl0ID0gcGFyc2VJbnQobGltaXR8fGNhbi5BY3Rpb24oImxpbWl0IikpCgkJZm9yICh2YXIgaSA9IGJlZ2luOyBpIDwgYmVnaW4rbGltaXQ7IGkrKykgeyBsaXN0ICYmIGxpc3RbaV0gJiYgY2FuLm9uaW1wb3J0LmZpbGUoY2FuLCBsaXN0W2ldLnBhdGgsIGkpIH0KCQljYW4uU3RhdHVzKHtiZWdpbjogYmVnaW4sIGxpbWl0OiBsaW1pdCwgdG90YWw6IGNhbi5saXN0Lmxlbmd0aH0pCgl9LAp9LCBbIi9wbHVnaW4vbG9jYWwvd2lraS9mZWVsLmNzcyJdKQpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFtdLAoJcG5nOiBmdW5jdGlvbihjYW4sIHBhdGgsIGluZGV4KSB7IHJldHVybiBjYW4ub25maWd1cmUuaW1hZ2UoY2FuLCBwYXRoLCBpbmRleCkgfSwKCWpwZzogZnVuY3Rpb24oY2FuLCBwYXRoLCBpbmRleCkgeyByZXR1cm4gY2FuLm9uZmlndXJlLmltYWdlKGNhbiwgcGF0aCwgaW5kZXgpIH0sCglqcGVnOiBmdW5jdGlvbihjYW4sIHBhdGgsIGluZGV4KSB7IHJldHVybiBjYW4ub25maWd1cmUuaW1hZ2UoY2FuLCBwYXRoLCBpbmRleCkgfSwKCWltYWdlOiBmdW5jdGlvbihjYW4sIHBhdGgsIGluZGV4KSB7IHJldHVybiB7aW1nOiBwYXRoLCBoZWlnaHQ6IGNhbi5BY3Rpb24oImhlaWdodCIpLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCWNhbi5vbmRldGFpbC5faW5pdChjYW4sIGluZGV4KQoJfSwgX2luaXQ6IGZ1bmN0aW9uKHRhcmdldCkgeyBjYW4uU3RhdHVzKCJmaWxlIiwgcGF0aCkgfSwKCQlvbm1vdXNlb3ZlcjogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLlN0YXR1cygiZmlsZSIsIHBhdGgpIH0sCgl9IH0sCgoJdmlkZW86IGZ1bmN0aW9uKGNhbiwgcGF0aCkgeyB2YXIgYXV0byA9IGNhbi51c2VyLmlzTW9iaWxlJiZjYW4uQWN0aW9uKCJsaW1pdCIpIT0iMSI/IGZhbHNlOiB0cnVlLCBsb29wID0gdHJ1ZSwgdG90YWwgPSAwOyBmdW5jdGlvbiBjYihldmVudCkgeyB9CgkJcmV0dXJuIHt0eXBlOiAidmlkZW8iLCBzdHlsZToge2hlaWdodDogcGFyc2VJbnQoY2FuLkFjdGlvbigiaGVpZ2h0IikpfSwgY2xhc3NOYW1lOiAicHJldmlldyIsCgkJCWRhdGE6IHtzcmM6IHBhdGgsIGNvbnRyb2xzOiAiY29udHJvbHMiLCBhdXRvcGxheTogYXV0bywgbG9vcDogbG9vcCwgcGxheWJhY2tSYXRlOiBwYXJzZUZsb2F0KGNhbi5BY3Rpb24oInJhdGUiKSl9LAoJCQlvbmNvbnRleHRtZW51OiBjYiwgb25wbGF5OiBjYiwgb25wYXVzZTogY2IsIG9uZW5kZWQ6IGNiLAoJCQlvbm1vdXNlb3ZlcjogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLlN0YXR1cygiZmlsZSIsIHBhdGgpIH0sCgkJCW9ubG9hZGVkbWV0YWRhdGE6IGZ1bmN0aW9uKGV2ZW50KSB7IHRvdGFsID0gZXZlbnQudGltZVN0YW1wCgkJCQlldmVudC50YXJnZXQuY3VycmVudFRpbWUgPSBjYW4uX21zZy5jdXJyZW50VGltZSB8fCAwCgkJCX0sIG9ubG9hZGVkZGF0YTogY2IsIG9udGltZXVwZGF0ZTogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5TdGF0dXMoImZpbGUiKSA9PSBwYXRoICYmIGNhbi5TdGF0dXMoInBvc2l0aW9uIiwgY2FuLm9uZXhwb3J0LnBvc2l0aW9uKGNhbiwgKGNhbi5fbXNnLmN1cnJlbnRUaW1lPWV2ZW50LnRhcmdldC5jdXJyZW50VGltZSktMSwgZXZlbnQudGFyZ2V0LmR1cmF0aW9uKSkKCQkJfSwKCQl9Cgl9LAoJbXA0OiBmdW5jdGlvbihjYW4sIHBhdGgpIHsgcmV0dXJuIGNhbi5vbmZpZ3VyZS52aWRlbyhjYW4sIHBhdGgpIH0sCgltNHY6IGZ1bmN0aW9uKGNhbiwgcGF0aCkgeyByZXR1cm4gY2FuLm9uZmlndXJlLnZpZGVvKGNhbiwgcGF0aCkgfSwKCW1vdjogZnVuY3Rpb24oY2FuLCBwYXRoKSB7IHJldHVybiBjYW4ub25maWd1cmUudmlkZW8oY2FuLCBwYXRoKSB9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFsKCQlbImhlaWdodCIsIDEwMCwgMjAwLCA0MDAsIDYwMCwgODAwXSwKCQlbImxpbWl0IiwgMSwgMywgNiwgOSwgMTIsIDE1LCAyMCwgMzBdLAoJCVsicmF0ZSIsIDAuMSwgMC4yLCAwLjUsIDEsIDIsIDMsIDUsIDEwXSwKCV0sCgki5LiK5LiA6aG1IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgewoJCWNhbi5iZWdpbiA+IDAgJiYgKGNhbi5iZWdpbiAtPSBwYXJzZUludChjYW4uQWN0aW9uKCJsaW1pdCIpKSwgY2FuLm9uaW1wb3J0LnBhZ2UoY2FuLCBjYW4ubGlzdCkpCgl9LAoJIuS4i+S4gOmhtSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsKCQljYW4uYmVnaW4gKyBwYXJzZUludChjYW4uQWN0aW9uKCJsaW1pdCIpKSA8IGNhbi5saXN0Lmxlbmd0aCAmJiAoY2FuLmJlZ2luICs9IHBhcnNlSW50KGNhbi5BY3Rpb24oImxpbWl0IikpLCBjYW4ub25pbXBvcnQucGFnZShjYW4sIGNhbi5saXN0KSkKCX0sCgoJImhlaWdodCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgCgkJY2FuLkFjdGlvbigiaGVpZ2h0IiwgdmFsdWUpLCBjYW4ub25pbXBvcnQucGFnZShjYW4sIGNhbi5saXN0KQoJfSwKCSJsaW1pdCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgCgkJY2FuLkFjdGlvbigibGltaXQiLCB2YWx1ZSksIGNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpCgl9LAoJInJhdGUiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IAoJCWNhbi5BY3Rpb24oInJhdGUiLCB2YWx1ZSksIGNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpCgl9LAoKCWNob29zZUltYWdlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQljYW4udXNlci5hZ2VudC5jaG9vc2VJbWFnZShmdW5jdGlvbihsaXN0KSB7IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgW3tpbWc6IGl0ZW0sIGhlaWdodDogMjAwfV0pCgkJfSkgfSkKCX0sCn0pClZvbGNhbm9zKCJvbmRldGFpbCIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogWyLlhbPpl60iLCAi5LiL6L29IiwgIuWIoOmZpCIsICLkuIrkuIDkuKoiLCAi5LiL5LiA5LiqIiwgIuiuvue9ruWktOWDjyIsICLorr7nva7og4zmma8iLCAi5aSN5Yi26ZO+5o6lIl0sIF9pbml0OiBmdW5jdGlvbihjYW4sIGluZGV4KSB7CgkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwge3R5cGU6ICJzdG9yeSBmZWVsIGZsb2F0In0sIFtdLCBmdW5jdGlvbihzdWIpIHsgY2FuLnN1YiA9IHN1YgoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHJldHVybiBjYW4ucnVuKGV2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkgfQoKCQkJc3ViLmdldEFjdGlvblNpemUoZnVuY3Rpb24obXNnLCBsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpIHsKCQkJCXN1Yi5wYWdlLk1vZGlmeShzdWIsIHN1Yi5fdGFyZ2V0LCB7c3R5bGU6IHtsZWZ0OiBsZWZ0LCB0b3A6IHRvcH19KQoJCQkJc3ViLnBhZ2UuTW9kaWZ5KHN1Yiwgc3ViLl9vdXRwdXQsIHtzdHlsZTogeyJtYXgtd2lkdGgiOiB3aWR0aCwgIm1heC1oZWlnaHQiOiBoZWlnaHR9fSkKCQkJCXN1Yi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgY2FuLm9uZGV0YWlsLmxpc3QsIHN1Yi5fYWN0aW9uLCBjYW4ub25kZXRhaWwpCgoJCQkJY2FuLm9yZGVyID0gaW5kZXgsIGNhbi5zaG93ID0gZnVuY3Rpb24ob3JkZXIpIHsKCQkJCQlwYXRoID0gY2FuLm9uaW1wb3J0Ll9maWxlKGNhbiwgY2FuLmxpc3Rbb3JkZXJdLnBhdGgpCgkJCQkJc3ViLnBhZ2UuQXBwZW5kcyhzdWIsIHN1Yi5fb3V0cHV0LCBbe2ltZzogcGF0aCwgc3R5bGU6IHsibWF4LXdpZHRoIjogd2lkdGgsICJtYXgtaGVpZ2h0IjogaGVpZ2h0LTIqaHRtbC5BQ1RJT05fSEVJR0hUfX1dKQoJCQkJCXN1Yi5TdGF0dXMoImJlZ2luIiwgb3JkZXIrMStpY2UuUFMrY2FuLmxpc3QubGVuZ3RoKSwgc3ViLlN0YXR1cygiZmlsZSIsIHBhdGgpCgkJCQl9LCBjYW4uc2hvdyhjYW4ub3JkZXIpCgkJCX0pCgkJfSwgZG9jdW1lbnQuYm9keSkKCX0sCgki5YWz6ZetIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uc3ViLl90YXJnZXQpIH0sCgki5LiL6L29IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4udXNlci5kb3dubG9hZChjYW4sIHBhdGggPSBjYW4ub25pbXBvcnQuX2ZpbGUoY2FuLCBjYW4ubGlzdFtjYW4ub3JkZXJdLnBhdGgpKSB9LAoJIuWIoOmZpCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlJFTU9WRSwgY2FuLmxpc3RbY2FuLm9yZGVyXS5wYXRoXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0KGNhbiwgIuWIoOmZpOaIkOWKnyIpIH0sIHRydWUpCgl9LAoJIuS4iuS4gOS4qiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9yZGVyID4gMD8gY2FuLnNob3coLS1jYW4ub3JkZXIpOiBjYW4udXNlci50b2FzdChjYW4sICLlt7Lnu4/mmK/nrKzkuIDlvKDllaYhIikgfSwKCSLkuIvkuIDkuKoiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vcmRlciA8IGNhbi5saXN0Lmxlbmd0aC0xPyBjYW4uc2hvdygrK2Nhbi5vcmRlcik6IGNhbi51c2VyLnRvYXN0KGNhbiwgIuW3sue7j+aYr+acgOWQjuS4gOW8oOWVpiEiKSB9LAoJIuiuvue9ruWktOWDjyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB7dXJsOiBjYW4ub25pbXBvcnQuX2ZpbGUoY2FuLCBjYW4ubGlzdFtjYW4ub3JkZXJdLnBhdGgpfSkKCQljYW4uc2VhcmNoKGV2ZW50LCBbIkhlYWRlci5vbmltcG9ydC5hdmF0YXIiXSwgbnVsbCwgdHJ1ZSkKCX0sCgki6K6+572u6IOM5pmvIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHt1cmw6IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIGNhbi5saXN0W2Nhbi5vcmRlcl0ucGF0aCl9KQoJCWNhbi5zZWFyY2goZXZlbnQsIFsiSGVhZGVyLm9uaW1wb3J0LmJhY2tncm91bmQiXSwgbnVsbCwgdHJ1ZSkKCX0sCgki5aSN5Yi26ZO+5o6lIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgY2FuLm1pc2MuTWVyZ2VVUkwoY2FuLCB7X3BhdGg6IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIGNhbi5saXN0W2Nhbi5vcmRlcl0ucGF0aCl9LCB0cnVlKSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyJiZWdpbiIsICJsaW1pdCIsICJ0b3RhbCIsICJwb3NpdGlvbiIsICJmaWxlIl0sCglwb3NpdGlvbjogZnVuY3Rpb24oY2FuLCBpbmRleCwgdG90YWwpIHsgdG90YWwgPSB0b3RhbCB8fCBjYW4ubWF4CgkJcmV0dXJuIHBhcnNlSW50KChpbmRleCsxKSoxMDAvdG90YWwpKyIlIisiID0gIisocGFyc2VJbnQoaW5kZXgpKzEpK2ljZS5QUytwYXJzZUludCh0b3RhbCkKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vc3RvcnkvbWVkaWEuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCn19KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaTjeS9nOaVsOaNriIsIGxpc3Q6IFsi5omT5byA5bGP5bmVIiwgIuaJk+W8gOaRhOWDjyIsICLmiZPlvIDlvZXpn7MiXSwKCV9hY3Rpb246IGZ1bmN0aW9uKGNhbiwgY2IpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgW3t2aWV3OiBodG1sLkFDVElPTn0sIHt2aWV3OiBodG1sLk9VVFBVVCwgbGlzdDogW3t0eXBlOiBodG1sLlZJREVPLCBzdHlsZToge3dpZHRoOiBjYW4uQ29uZldpZHRoKCl9LCBfaW5pdDogZnVuY3Rpb24oaXRlbSkgewoJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IGNiKGl0ZW0sIHVpKSB9KQoJCX19XX1dKQoKCQljYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIHsKCQkJIuWFs+mXrSI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4uY29yZS5MaXN0KHVpLnN0cmVhbS5nZXRUcmFja3MoKSwgZnVuY3Rpb24odHJhY2spIHsgdHJhY2suc3RvcCgpIH0pCgkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5hY3Rpb24pLCBjYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5vdXRwdXQpCgkJCX0sCgkJCSLmipPmi40iOiBmdW5jdGlvbihldmVudCkgewoJCQkJdmFyIGNhbnZhcyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLm91dHB1dCwgW3t0eXBlOiBodG1sLkNBTlZBU31dKS5maXJzdDsgY2FudmFzLmdldENvbnRleHQoIjJkIikuZHJhd0ltYWdlKHVpLnZpZGVvLCAwLCAwKQoJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdWkub3V0cHV0LCBbe2ltZzogY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyksIHN0eWxlOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKX19XSkKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbnZhcykKCQkJfSwKCQkJIuW9leWItiI6IGZ1bmN0aW9uKGV2ZW50KSB7IHVpLmJsb2JzID0gW10KCQkJCXVpLm1lZGlhUmVjb3JkZXIgPSBuZXcgTWVkaWFSZWNvcmRlcih1aS5zdHJlYW0sIHttaW1lVHlwZTogJ3ZpZGVvL3dlYm0nfSkKCQkJCXVpLm1lZGlhUmVjb3JkZXIub25kYXRhYXZhaWxhYmxlID0gKGUpID0+IHsgdWkuYmxvYnMucHVzaChlLmRhdGEpLCBjYW4ubWlzYy5Mb2codWkuYmxvYnMubGVuZ3RoKSB9CgkJCQl1aS5tZWRpYVJlY29yZGVyLnN0YXJ0KDEwMCkKCQkJfSwKCQkJIuWbnuaUviI6IGZ1bmN0aW9uKGV2ZW50KSB7IHZhciBibG9icyA9IHVpLmJsb2JzOyB1aS5ibG9icyA9IFtdCgkJCQl2YXIgdmlkZW8gPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB1aS5vdXRwdXQsIFt7dHlwZTogaHRtbC5WSURFTywgc3R5bGU6IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpfX1dKS52aWRlbwoJCQkJdmlkZW8uc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihibG9icywge3R5cGUgOiAndmlkZW8vd2VibSd9KSksIHZpZGVvLnBsYXkoKQoJCQl9LAoJCQki5LiL6L29IjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi51c2VyLmRvd25sb2FkKGNhbiwgVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYih1aS5ibG9icywge3R5cGU6ICd2aWRlby93ZWJtJ30pKSwgJ3JlY29yZC53ZWJtJykKCQkJfSwKCQl9KQoJfSwKCSLmiZPlvIDlsY/luZUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLm9uYWN0aW9uLl9hY3Rpb24oY2FuLCBmdW5jdGlvbihpdGVtLCB1aSkgewoJCQluYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmdldERpc3BsYXlNZWRpYSh7dmlkZW86IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpfX0pLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7IHVpLnN0cmVhbSA9IHN0cmVhbQoJCQkJaXRlbS5zcmNPYmplY3QgPSBzdHJlYW0sIGl0ZW0ub25sb2FkZWRtZXRhZGF0YSA9IGZ1bmN0aW9uKGUpIHsgaXRlbS5wbGF5KCkgfQoJCQl9KS5jYXRjaChmdW5jdGlvbihlcnIpIHsgY2FuLm1pc2MuTG9nKGVyci5uYW1lICsgIjogIiArIGVyci5tZXNzYWdlKSB9KQoJCX0pCgl9LAoJIuaJk+W8gOaRhOWDjyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25hY3Rpb24uX2FjdGlvbihjYW4sIGZ1bmN0aW9uKGl0ZW0sIHVpKSB7CgkJCW5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKHt2aWRlbzoge3dpZHRoOiBjYW4uQ29uZldpZHRoKCl9fSkudGhlbihmdW5jdGlvbihzdHJlYW0pIHsgdWkuc3RyZWFtID0gc3RyZWFtCgkJCQlpdGVtLnNyY09iamVjdCA9IHN0cmVhbSwgaXRlbS5vbmxvYWRlZG1ldGFkYXRhID0gZnVuY3Rpb24oZSkgeyBpdGVtLnBsYXkoKSB9CgkJCX0pLmNhdGNoKGZ1bmN0aW9uKGVycikgeyBjYW4ubWlzYy5Mb2coZXJyLm5hbWUgKyAiOiAiICsgZXJyLm1lc3NhZ2UpIH0pCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW119KQoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vc3RvcnkvcGllLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ucmVxdWlyZShbIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmpzIiwgIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3L3BhdGguanMiXSwgZnVuY3Rpb24oKSB7CgkJCXZhciBoZWlnaHQgPSBtc2cuT3B0aW9uKGh0bWwuSEVJR0hUKXx8Y2FuLkNvbmZIZWlnaHQoKQoJCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4ub25pbXBvcnQuX3Nob3coY2FuLCBtc2cpCgkJCXZhciByID0gaGVpZ2h0LzItMjAsIG1hcmdpbiA9IDIwOyBjYW4uc3ZnLlZhbChodG1sLldJRFRILCAyKihyK21hcmdpbikpLCBjYW4uc3ZnLlZhbChodG1sLkhFSUdIVCwgMioocittYXJnaW4pKQoJCQljYW4uX2FyZ3MgPSBjYW4uYmFzZS5Db3B5KHtmaWVsZDogInZhbHVlIn0sIGNhbi5iYXNlLlBhcnNlVVJMKGNhbi5fZGlzcGxheSkpCgkJCWNhbi5vbmltcG9ydC5fZHJhdyhjYW4sIG1zZywgY2FuLl9hcmdzLmZpZWxkLCByK21hcmdpbiwgcittYXJnaW4sIHIsIG1hcmdpbiwgMCkKCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLnByb2plY3QpLCBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIG51bGwsIGNhbi51aS5wcm9qZWN0KQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QsIHRydWUpCgkJCXZhciByZXN0ID0gY2FuLkNvbmZXaWR0aCgpLWhlaWdodAoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkucHJvamVjdCwge3N0eWxlOiB7Im1heC13aWR0aCI6IHJlc3R9fSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLnByb2plY3QsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyLCBpbmRleCkgewoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdHIsIHtvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZyksIGNhbi5vbmltcG9ydC5fZHJhdyhjYW4sIG1zZywgY2FuLl9hcmdzLmZpZWxkLCByK21hcmdpbiwgcittYXJnaW4sIHIsIG1hcmdpbiwgaW5kZXgtMSkKCQkJCX19KQoJCQl9KQoJCX0pCgl9LAoJX2RyYXc6IGZ1bmN0aW9uKGNhbiwgbXNnLCBmaWVsZCwgeCwgeSwgciwgbWFyZ2luLCB3aGljaCkgewoJCWZ1bmN0aW9uIHBvcyh4LCB5LCByLCBhbmdsZSkgeyBhbmdsZSAtPSA5MAoJCQlyZXR1cm4gW3ggKyByICogTWF0aC5jb3MoYW5nbGUgKiBNYXRoLlBJIC8gMTgwKSwgeSArIHIgKiBNYXRoLnNpbihhbmdsZSAqIE1hdGguUEkgLyAxODApXQoJCX0KCQlmdW5jdGlvbiBwaWUoeCwgeSwgciwgYmVnaW4sIHNwYW4sIGNvbG9yLCBjYikgeyBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7c2hhcGU6ICJwYXRoIiwgc3R5bGU6IHsKCQkJInN0cm9rZS13aWR0aCI6IDEsIHN0cm9rZTogY29sb3IsIGZpbGw6IGNvbG9yLCBkOiBjYW4uYmFzZS5qb2lucyhbCgkJCQlbIk0iLCB4LCB5XSwgWyJMIl0uY29uY2F0KHBvcyh4LCB5LCByLCBiZWdpbikpLCBbIkEiLCByLCByLCAiMCIsIHNwYW4+MTgwPyAiMSI6ICIwIiwgIjEiXS5jb25jYXQocG9zKHgsIHksIHIsIGJlZ2luK3NwYW4pKSwgWyJaIl0KCQkJXSwgaWNlLlNQLCBpY2UuRlMpLAoJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCkKCQl9IH0pIH0KCgkJdmFyIHRvdGFsID0gMDsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7IHRvdGFsICs9IHBhcnNlSW50KHZhbHVlW2ZpZWxkXSkgfSkKCQl2YXIgY29sb3IgPSBbY2xpLlJFRCwgY2xpLllFTExPVywgY2xpLkdSRUVOLCBjbGkuQ1lBTiwgY2xpLkJMVUUsIGNsaS5QVVJQTEUsIGNsaS5XSElURSwgY2xpLkJMQUNLXQoJCXZhciBiZWdpbiA9IDA7IG1zZ1siY29sb3IiXSA9IFtdLCBtc2dbIndlaWdodCJdID0gW10sIG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsgdmFyIHNwYW4gPSBwYXJzZUludCh2YWx1ZVtmaWVsZF0pL3RvdGFsKjM2MAoJCQl2YXIgcCA9IGluZGV4PT13aGljaD8gcG9zKHgsIHksIG1hcmdpbiwgYmVnaW4rc3Bhbi8yKTogW3gsIHldOyBpbmRleCA9PSB3aGljaCAmJiBjYW4uU3RhdHVzKHZhbHVlKQoJCQl2YXIgYyA9IGNvbG9yW2luZGV4JWNvbG9yLmxlbmd0aF07IHBpZShwWzBdLCBwWzFdLCByLCBiZWdpbiwgc3BhbiwgYywgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWlmIChpbmRleCA9PSBjYW4uX2xhc3QpIHsgcmV0dXJuIH0gY2FuLl9sYXN0ID0gaW5kZXgKCQkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpLCBjYW4uc3ZnLlZhbHVlKCJjb3VudCIsIDApCgkJCQljYW4ub25pbXBvcnQuX2RyYXcoY2FuLCBtc2csIGZpZWxkLCB4LCB5LCByLCBtYXJnaW4sIGluZGV4KQoJCQkJY2FuLm9uaW1wb3J0Ll9wcm9maWxlKGNhbiwgZXZlbnQudGFyZ2V0KQoJCQl9KSwgYmVnaW4gKz0gc3BhbiwgbXNnLlB1c2goImNvbG9yIiwgJzxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOicrYysnIj4gICAgIDwvc3Bhbj4nKQoJCQltc2cuUHVzaCgid2VpZ2h0IiwgcGFyc2VJbnQocGFyc2VJbnQodmFsdWVbZmllbGRdKSoxMDAwMC90b3RhbCkvMTAwKyIlIikKCQl9KQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9pbnB1dC9kYXRlLmpzIgpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIuaOp+S7tuivpuaDhSIsIGxpc3Q6IFtdLCBkYXRlOiB7b25jbGljazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbWV0YSwgY2IsIHRhcmdldCkgeyBjYihmdW5jdGlvbihjYW4sIGNicykgewoJZnVuY3Rpb24gc2V0KG5vdykgeyB0YXJnZXQudmFsdWUgPSBjYW4udXNlci50aW1lKGNhbiwgbm93KSwgY2FuLmNsb3NlKCksIG1ldGEgJiYgbWV0YS5hY3Rpb24gPT0gaWNlLkFVVE8gJiYgY2FuLnJ1bih7fSkgfQoKCS8vIOa3u+WKoOaOp+S7tgoJdmFyIG5vdyA9IHRhcmdldC52YWx1ZT8gbmV3IERhdGUodGFyZ2V0LnZhbHVlKTogbmV3IERhdGUoKQoJY2FuLl90cmFucyA9IHsidG9kYXkiOiAi5LuK5aSpIiwgIm5leHQiOiAi5LiL5LiA5pyIIiwgInByZXYiOiAi5LiK5LiA5pyIIn0KCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fYWN0aW9uKSwgY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBbY2xpLkNMT1NFLAoJCVsiaG91ciJdLmNvbmNhdChjYW4uY29yZS5MaXN0KDI0KSksIFsibWludXRlIl0uY29uY2F0KGNhbi5jb3JlLkxpc3QoMCwgNjAsIDUpKSwgWyJzZWNvbmQiXS5jb25jYXQoY2FuLmNvcmUuTGlzdCgwLCA2MCwgNSkpLAoJCSJ0b2RheSIsICIiLCAicHJldiIsIFsieWVhciJdLmNvbmNhdChjYW4uY29yZS5MaXN0KG5vdy5nZXRGdWxsWWVhcigpIC0gMTAsIG5vdy5nZXRGdWxsWWVhcigpICsgMTApKSwKCQlbIm1vbnRoIl0uY29uY2F0KGNhbi5jb3JlLkxpc3QoMSwgMTMpKSwgIm5leHQiLAoJXSwgY2FuLl9hY3Rpb24sIHsgY2xvc2U6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5jbG9zZSgpIH0sCgkJImhvdXIiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0SG91cnMocGFyc2VJbnQodmFsdWUpfHwwKSwgc2hvdyhub3cpIH0sCgkJIm1pbnV0ZSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgIG5vdy5zZXRNaW51dGVzKHBhcnNlSW50KHZhbHVlKXx8MCksIHNob3cobm93KSB9LAoJCSJzZWNvbmQiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0U2Vjb25kcyhwYXJzZUludCh2YWx1ZSl8fDApLCBzaG93KG5vdykgfSwKCQkidG9kYXkiOiBmdW5jdGlvbihldmVudCkgeyAgbm93ID0gbmV3IERhdGUoKSwgc2V0KHNob3cobm93KSkgfSwKCgkJInByZXYiOiBmdW5jdGlvbihldmVudCkgeyAgbm93LnNldE1vbnRoKG5vdy5nZXRNb250aCgpLTEpLCBzaG93KG5vdykgfSwKCQkieWVhciI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgIG5vdy5zZXRGdWxsWWVhcihwYXJzZUludCh2YWx1ZSkpLCBzaG93KG5vdykgfSwKCQkibW9udGgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0TW9udGgocGFyc2VJbnQodmFsdWUpLTEpLCBzaG93KG5vdykgfSwKCQkibmV4dCI6IGZ1bmN0aW9uKGV2ZW50KSB7ICBub3cuc2V0TW9udGgobm93LmdldE1vbnRoKCkrMSksIHNob3cobm93KSB9LAoKCQki6ZqP5py6IjogZnVuY3Rpb24oZXZlbnQpIHsgIG5vdy5zZXREYXRlKChNYXRoLnJhbmRvbSgpICogMTAwIC0gNTApICsgbm93LmdldERhdGUoKSksIHNob3cobm93KSB9LAoJCSLliY3kuIDlubQiOiBmdW5jdGlvbihldmVudCkgeyAgbm93LnNldEZ1bGxZZWFyKG5vdy5nZXRGdWxsWWVhcigpLTEpLCBzaG93KG5vdykgfSwKCQki5ZCO5LiA5bm0IjogZnVuY3Rpb24oZXZlbnQpIHsgIG5vdy5zZXRGdWxsWWVhcihub3cuZ2V0RnVsbFllYXIoKSsxKSwgc2hvdyhub3cpIH0sCgl9KQoKCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fc3RhdHVzKQoJY2FuLl90YWJsZSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCBjYW4uX291dHB1dCwgW3t2aWV3OiBbY2hhdC5DT05URU5ULCBodG1sLlRBQkxFXX1dKS5maXJzdAoJdmFyIHRvZGF5ID0gbmV3IERhdGUoKTsgZnVuY3Rpb24gc2hvdyhub3cpIHsKCQkvLyDorr7nva7mjqfku7YKCQljYW4uQWN0aW9uKCJ5ZWFyIiwgbm93LmdldEZ1bGxZZWFyKCkpCgkJY2FuLkFjdGlvbigibW9udGgiLCBub3cuZ2V0TW9udGgoKSsxKQoJCWNhbi5BY3Rpb24oImhvdXIiLCBub3cuZ2V0SG91cnMoKSkKCQljYW4uQWN0aW9uKCJtaW51dGUiLCBwYXJzZUludChub3cuZ2V0TWludXRlcygpLzUpKjUpCgkJY2FuLkFjdGlvbigic2Vjb25kIiwgcGFyc2VJbnQobm93LmdldFNlY29uZHMoKS81KSo1KQoKCQkvLyDorr7nva7nu4Tku7YKCQljYW4ucGFnZS5BcHBlbmRzKGNhbiwgY2FuLl90YWJsZSwgW3t0aDogWyLml6UiLCAi5LiAIiwgIuS6jCIsICLkuIkiLCAi5ZubIiwgIuS6lCIsICLlha0iXX1dKQoJCXZhciB0cjsgZnVuY3Rpb24gYWRkKGRheSwgdHlwZSkgeyBpZiAoZGF5LmdldERheSgpID09IDApIHsgdHIgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX3RhYmxlLCBbe3R5cGU6IGh0bWwuVFJ9XSkubGFzdCB9CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRyLCBbe3RleHQ6IFtkYXkuZ2V0RGF0ZSgpLCBodG1sLlRELCBjYW4uYmFzZS5UaW1lKHRvZGF5LCAiJXktJW0tJWQiKSA9PSBjYW4uYmFzZS5UaW1lKGRheSwgIiV5LSVtLSVkIik/IGh0bWwuU0VMRUNUOiB0eXBlXSwKCQkJCWRhdGFzZXQ6IHtkYXRlOiBkYXkuZ2V0VGltZSgpfSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlzZXQobm93ID0gbmV3IERhdGUocGFyc2VJbnQoZXZlbnQudGFyZ2V0LmRhdGFzZXQuZGF0ZSkpKQoJCQkJfSwKCQkJfV0pCgkJfQoKCQkvLyDml7bpl7TljLrpl7QKCQl2YXIgb25lID0gbmV3IERhdGUobm93KTsgb25lLnNldERhdGUoMSkKCQl2YXIgZW5kID0gbmV3IERhdGUobm93KTsgZW5kLnNldE1vbnRoKG5vdy5nZXRNb250aCgpKzEpLCBlbmQuc2V0RGF0ZSgxKQoJCXZhciBoZWFkID0gbmV3IERhdGUob25lKTsgaGVhZC5zZXREYXRlKG9uZS5nZXREYXRlKCktb25lLmdldERheSgpKQoJCXZhciB0YWlsID0gbmV3IERhdGUoZW5kKTsgdGFpbC5zZXREYXRlKGVuZC5nZXREYXRlKCkrNy1lbmQuZ2V0RGF5KCkpCgoJCS8vIOaXtumXtOW6j+WIlwoJCWZvciAodmFyIGRheSA9IG5ldyBEYXRlKGhlYWQpOyBkYXkgPCBvbmU7IGRheS5zZXREYXRlKGRheS5nZXREYXRlKCkrMSkpIHsgYWRkKGRheSwgbWRiLlBSRVYpIH0KCQlmb3IgKHZhciBkYXkgPSBuZXcgRGF0ZShvbmUpOyBkYXkgPCBlbmQ7IGRheS5zZXREYXRlKGRheS5nZXREYXRlKCkrMSkpIHsgYWRkKGRheSwgbWRiLk1BSU4pIH0KCQlmb3IgKHZhciBkYXkgPSBuZXcgRGF0ZShlbmQpOyBlbmQuZ2V0RGF5KCkgIT0gMCAmJiBkYXkgPCB0YWlsOyBkYXkuc2V0RGF0ZShkYXkuZ2V0RGF0ZSgpKzEpKSB7IGFkZChkYXksIG1kYi5ORVhUKSB9CgoJCXJldHVybiBub3cKCX0gc2hvdyhub3cpLCBjYW4ub25sYXlvdXQuZmlndXJlKGV2ZW50LCBjYW4pLCBjYW4uYmFzZS5pc0Z1bmMoY2JzKSAmJiBjYnMoY2FuKQp9KX19IH0sIFsiIl0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9zbmlwcGV0LmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKQoJCWlmIChtc2cuT3B0aW9uKCJjb250ZW50IikpIHsKCQkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHtpbmRleDogIndlYi5jb2RlLnZpbWVyIiwgc3R5bGU6ICJmdWxsIn0sIGZ1bmN0aW9uKHN1YikgewoJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgcmVzID0gY2FuLnJlcXVlc3QoZXZlbnQpCgkJCQkJaWYgKGNtZHNbMV0gPT0gInBsdWdpbiIpIHsKCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgWyJhY3Rpb24iLCAidmltZXIiXSwgY21kcyksIGNiLCB0cnVlKQoJCQkJCQlyZXR1cm4KCQkJCQl9CgkJCQkJaWYgKGNtZHNbMV0gPT0gIm1haW4uZ28iKSB7IHJlcy5FY2hvKG1zZy5PcHRpb24oImNvbnRlbnQiKSkKCQkJCQkJY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsgY2FuLnN1YiAmJiBjYW4uc3ViLm9uYWN0aW9uWyLpobnnm64iXSh7fSwgY2FuLnN1YikgfSkKCQkJCQl9CgkJCQkJY2IocmVzKSwgY2FuLnN1YiA9IGNhbi5jb3JlLlZhbHVlKHN1YiwgIl9vdXRwdXRzLi0xIikKCQkJCX0KCQkJfSwgY2FuLl9vdXRwdXQpCgkJCXJldHVybgoJCX0KCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpCgkJY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgbXNnKQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmk43kvZzmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7Cgl9LAoJcnVuOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2cpIHsKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgImdvIiwgImhpLmdvIiwgY2FuLnN1Yi5vbmV4cG9ydC5jb250ZW50KGNhbi5zdWIpXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZykKCQl9LCB0cnVlKQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7Cn19KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL2NoYXQvbWVkaWEuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCWNhbi51aSA9IGNhbi5vbmxheW91dC5kaXNwbGF5KGNhbiwgdGFyZ2V0KQoJCWNhbi51aS5jYW52YXMgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkuZGlzcGxheSwgW3t0eXBlOiAiY2FudmFzIiwgd2lkdGg6IDMyMCwgaGVpZ2h0OiAyNDAsIHN0eWxlOiB7ZGlzcGxheTogIm5vbmUifX1dKS5maXJzdAoKCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkgewoJCQlyZXR1cm4ge3RleHQ6IFt2YWx1ZSwgInRkIl0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4uc3VwLm9uYWN0aW9uLmNoYW5nZShldmVudCwgY2FuLnN1cCwga2V5LCB2YWx1ZSwgZnVuY3Rpb24obXNnKSB7CgkJCQkJY2FuLnJ1bihldmVudCkKCQkJCX0pCgkJCX19CgkJfSwgY2FuLnVpLmNvbnRlbnQpCgoJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZy5SZXN1bHQoKSwgY2FuLnVpLmRpc3BsYXkpCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgl9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaTjeS9nOaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCX0sCgoJb3BlbjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCW5hdmlnYXRvci5nZXRVc2VyTWVkaWEoe3ZpZGVvOiB7d2lkdGg6IDMyMCwgaGVpZ2h0OiAyNDB9fSwgZnVuY3Rpb24oc3RyZWFtKSB7CgkJCXZhciB2aWRlbyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5jb250ZW50LCAidmlkZW8iKQoJCQl2aWRlby5zcmNPYmplY3QgPSBzdHJlYW0sIHZpZGVvLnBsYXkoKQoJCQljYW4udWkudmlkZW8gPSB2aWRlbwoJCX0sIGZ1bmN0aW9uKGVycm9yKSB7CgkJCWNhbi5taXNjLkxvZygib3BlbiBjYW1lcmEiLCBlcnJvcikKCQl9KQoJfSwKCXNuYXBzaG90OiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVpLmNhbnZhcy5nZXRDb250ZXh0KCIyZCIpLmRyYXdJbWFnZShjYW4udWkudmlkZW8sIDAsIDApCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmRpc3BsYXksIFt7dHlwZTogImltZyIsIHNyYzogY2FuLnVpLmNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlL3dlYnAnKX1dKQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXSwgCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY2hhdC90cmFucy5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQljYW4uZnJvbSA9IGNhbi5vbmltcG9ydC5fcGx1Z2luKGNhbiwgbmZzLkRJUiwgaHRtbC5MRUZULCAiZnJvbSIsICJ0byIpCgkJY2FuLnRvID0gY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBuZnMuRElSLCBodG1sLlJJR0hULCAidG8iLCAiZnJvbSIpCgkJY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBuZnMuVFJBU0gsIGh0bWwuTEVGVCwgImZyb20iKQoJCWNhbi5vbmltcG9ydC5fcGx1Z2luKGNhbiwgbmZzLlRSQVNILCBodG1sLlJJR0hULCAidG8iKQoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGNhbiwgaW5kZXgsIHBvcywgZnJvbSwgdG8pIHsKCQlyZXR1cm4gY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHt0eXBlOiBjaGF0LlNUT1JZLCBpbmRleDogaW5kZXh9LCBmdW5jdGlvbihzdWIpIHsKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl90YXJnZXQsIHtzdHlsZToge2Zsb2F0OiBwb3MsIGNsZWFyOiBwb3N9fSkKCQkJc3ViLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCkvMikKCQkJc3ViLl9sZWdlbmQuaW5uZXJIVE1MID0gY2FuLk9wdGlvbihmcm9tKStpY2UuU1AraW5kZXgKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl9vdXRwdXQsIHtzdHlsZTogeyJtYXgtd2lkdGgiOiBjYW4uQ29uZihodG1sLldJRFRIKS8yfX0pCgoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCQlpZiAoY2FuLm9uYWN0aW9uW2NtZHNbMV1dKSB7IHJldHVybiBjYW4ub25hY3Rpb25bY21kc1sxXV0oY2FuLCBmcm9tLCB0bywgZXZlbnQsIGNtZHMsIGNiKSB9CgoJCQkJdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KGV2ZW50LCB7X3BvZDogY2FuLk9wdGlvbihmcm9tKX0pCgkJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgaW5kZXhdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7Cgl9LAoJc2VuZDogZnVuY3Rpb24oY2FuLCBmcm9tLCB0bywgZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBfZnJvbSA9IGNhbltmcm9tXSwgX3RvID0gY2FuW3RvXQoJCXZhciBwYXRoID0gY2FuLnJlcXVlc3QoZXZlbnQpLk9wdGlvbihuZnMuUEFUSCkKCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtfaGFuZGxlOiBpY2UuVFJVRSwKCQkJZnJvbTogY2FuLk9wdGlvbihmcm9tKSwgZnJvbV9wYXRoOiBwYXRoLAoJCQl0bzogY2FuLk9wdGlvbih0byksIHRvX3BhdGg6IF90by5PcHRpb24obmZzLlBBVEgpK3BhdGguc3BsaXQoaWNlLlBTKS5wb3AoKSwKCQl9KQoJCWNhbi5ydW4oZXZlbnQsIGNtZHMsIGZ1bmN0aW9uKCkgeyBfdG8uVXBkYXRlKCkgfSwgdHJ1ZSkKCX0sCn0pCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jaGF0L3d4LmpzIgpWb2xjYW5vcygib25hY3Rpb24iLCB7c291cmNlOiBmdW5jdGlvbihjYW4sIG1zZykgewoJY2FuLnJlcXVpcmUoWyJodHRwczovL3Jlcy53eC5xcS5jb20vb3Blbi9qcy9qd2VpeGluLTEuNi4wLmpzIl0sIGZ1bmN0aW9uKGNhbikgewoJCXd4LmNvbmZpZyh7ZGVidWc6IG1zZy5PcHRpb24oImRlYnVnIikgPT0gaWNlLlRSVUUsCgkJCWFwcElkOiBtc2cuT3B0aW9uKCJhcHBpZCIpLCBzaWduYXR1cmU6IG1zZy5PcHRpb24oInNpZ25hdHVyZSIpLAoJCQlub25jZVN0cjogbXNnLk9wdGlvbigibm9uY2VzdHIiKSwgdGltZXN0YW1wOiBtc2cuT3B0aW9uKCJ0aW1lc3RhbXAiKSwKCgkJCWpzQXBpTGlzdDogY2FuLmNvcmUuSXRlbSh7CgkJCQlzY2FuUVJDb2RlOiBmdW5jdGlvbihjYikgeyB3eC5zY2FuUVJDb2RlKHtuZWVkUmVzdWx0OiBjYj8gMTogMCwgc2NhblR5cGU6IFsicXJDb2RlIiwiYmFyQ29kZSJdLCBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihyZXMucmVzdWx0U3RyLCBjYW4uYmFzZS5QYXJzZUpTT04ocmVzLnJlc3VsdFN0cikpCgkJCQl9IH0pIH0sCgkJCQlnZXRMb2NhdGlvbjogZnVuY3Rpb24oY2IpIHsgd3guZ2V0TG9jYXRpb24oe3R5cGU6ICJnY2owMiIsIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHt0eXBlOiAiZ2NqMDIiLCBuYW1lOiAi5b2T5YmN5L2N572uIiwgdGV4dDogIuW9k+WJjeS9jee9riIsIGxhdGl0dWRlOiBwYXJzZUludChyZXMubGF0aXR1ZGUqMTAwMDAwKSwgbG9uZ2l0dWRlOiBwYXJzZUludChyZXMubG9uZ2l0dWRlKjEwMDAwMCkgfSkKCQkJCX0gfSkgfSwKCQkJCW9wZW5Mb2NhdGlvbjogZnVuY3Rpb24obXNnKSB7IHd4Lm9wZW5Mb2NhdGlvbih7CgkJCQkJbGF0aXR1ZGU6IHBhcnNlSW50KG1zZy5PcHRpb24oImxhdGl0dWRlIikpLzEwMDAwMCwKCQkJCQlsb25naXR1ZGU6IHBhcnNlSW50KG1zZy5PcHRpb24oImxvbmdpdHVkZSIpKS8xMDAwMDAsCgkJCQkJbmFtZTogbXNnLk9wdGlvbihtZGIuTkFNRSksIGFkZHJlc3M6IG1zZy5PcHRpb24obWRiLlRFWFQpLAoJCQkJCXNjYWxlOiBtc2cuT3B0aW9uKCJzY2FsZSIpfHwxNCwgaW5mb1VybDogbXNnLk9wdGlvbihtZGIuTElOSyksCgkJCQl9KSB9LAoJCQkJY2hvb3NlSW1hZ2U6IGZ1bmN0aW9uKGNiLCBjb3VudCkgeyB3eC5jaG9vc2VJbWFnZSh7Y291bnQ6IGNvdW50fHw5LCBzaXplVHlwZTogWydvcmlnaW5hbCcsICdjb21wcmVzc2VkJ10sIHNvdXJjZVR5cGU6IFsnYWxidW0nLCAnY2FtZXJhJ10sIHN1Y2Nlc3M6IGZ1bmN0aW9uIChyZXMpIHsKCQkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHJlcy5sb2NhbElkcykKCQkJCX0gfSkgfSwKCQkJfSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4gY2FuLnVzZXIuYWdlbnRba2V5XSA9IHZhbHVlLCBrZXkgfSksCgkJfSkKCQl3eC5lcnJvcihmdW5jdGlvbihlcnIpIHsgY2FuLnVzZXIudG9hc3QoZXJyLCAid3ggbG9hZCIpIH0pCgkJd3gucmVhZHkoZnVuY3Rpb24oKSB7IGNhbi5taXNjLkxvZygicmVhZHkiKSB9KQoJfSkKfX0pCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jb2RlL2lubmVyL2Zhdm9yLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIF9pbml0OiBmdW5jdGlvbihjYW4sIGFyZ3MsIGNiKSB7CgljYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIHtpbmRleDogIndlYi5jb2RlLmZhdm9yIn0sIGZ1bmN0aW9uKHN1YikgewoJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQlpZiAoY2FuLm1pc2MucnVuQWN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwga2l0LkRpY3QoCgkJCQljb2RlLklOTkVSLCBmdW5jdGlvbihjbWRzKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBtc2cuT3B0aW9uKG5mcy5QQVRIKSwgbXNnLk9wdGlvbihuZnMuRklMRSksIG1zZy5PcHRpb24obmZzLkxJTkUpKQoJCQkJfSwKCQkJKSkpIHsgcmV0dXJuIH0KCgkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBjb2RlLkZBVk9SXSwgY21kcyksIGZ1bmN0aW9uKG1zZykgeyB2YXIgc3ViID0gbXNnLl9jYW4KCQkJCXN1Yi5vbm1vdGlvbi5jbGVhcihzdWIpLCBzdWIub25hcHBlbmQudGFibGUoc3ViLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKSB7CgkJCQkJaWYgKG1zZy5hcHBlbmQubGVuZ3RoID09IDIgJiYgbXNnLmFwcGVuZFswXSA9PSBtZGIuS0VZICYmIG1zZy5hcHBlbmRbMV0gPT0gbWRiLlZBTFVFKSB7CgkJCQkJCWlmIChrZXkgPT0gbWRiLlZBTFVFKSB7IGtleSA9IGxpbmUua2V5IH0KCQkJCQl9CgkJCQkJaWYgKGtleSAhPSBjdHguQUNUSU9OKSB7IHZhbHVlID0gc3ViLnBhZ2UucmVwbGFjZShzdWIsIHZhbHVlLCBpY2UuUFdELCAiIikgfQoKCQkJCQlyZXR1cm4ge3RleHQ6IFsiIiwgaHRtbC5URF0sIGxpc3Q6IFt7dGV4dDogW3ZhbHVlLCBodG1sLkRJVl19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldAoJCQkJCQlpZiAoW21kYi5aT05FLCBtZGIuSURdLmluZGV4T2Yoa2V5KSA+IC0xKSB7IHJldHVybiBzdWIub25hY3Rpb24uY2hhbmdlKGV2ZW50LCBzdWIsIGtleSwgdmFsdWUpIH0KCgkJCQkJCWlmICh0YXJnZXQudGFnTmFtZSA9PSAiSU5QVVQiICYmIHRhcmdldC50eXBlID09IGh0bWwuQlVUVE9OKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCwgbGluZSwgc3ViLk9wdGlvbigpKQoJCQkJCQkJcmV0dXJuIHN1Yi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCB0YXJnZXQubmFtZV0sIGZ1bmN0aW9uKG1zZykgeyBzdWIucnVuKCkgfSwgdHJ1ZSkKCQkJCQkJfQoKCQkJCQkJbGluZS5saW5lICYmIGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbGluZS5wYXRoLCBsaW5lLmZpbGUucmVwbGFjZShpY2UuUFdELCAiIiksIHBhcnNlSW50KGxpbmUubGluZSkpCgkJCQkJfX0KCQkJCX0sIHN1Yi5fb3V0cHV0KSwgc3ViLm9uYXBwZW5kLl9zdGF0dXMoc3ViLCBtc2cuT3B0aW9uKGljZS5NU0dfU1RBVFVTKSksIGNhbi5TdGF0dXMoIuagh+etvuaVsCIsIG1zZy5MZW5ndGgoKSkKCQkJfSwgdHJ1ZSkKCQl9LCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YikKCX0pCn19KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvZGF0YS5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYikgewoJCWNhbi51aSA9IGNhbi5vbmxheW91dC5kaXNwbGF5KGNhbikKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCgkJY2FuLnRhYmxlID0gY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSkgewoJCQlyZXR1cm4ge3RleHQ6IFt2YWx1ZSwgInRkIl0sIG9uY29udGV4dG1lbnU6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBjYW4ub25kZXRhaWwsIGNhbi5vbmRldGFpbC5saXN0LCBmdW5jdGlvbihldiwgY21kLCBtZXRhKSB7CgkJCQkJdmFyIGNiID0gbWV0YVtjbWRdOyBjYiAmJiBjYihldmVudCwgY2FuLCBjbWQsIHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKQoJCQkJfSkKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGV2ZW50LnRhcmdldCwge2NvbnRlbnRlZGl0YWJsZTogdHJ1ZX0pCgkJCX0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoa2V5ID09ICJwYXRoIikgeyBjYW4ucnVuKGV2ZW50LCBbY2FuLk9wdGlvbigicGF0aCIsIHZhbHVlKV0pIH0KCQkJfX0KCQl9LCBjYW4udWkuY29udGVudCkKCgkJY2FuLm9uZXhwb3J0Lmxpc3QgPSBtc2cuYXBwZW5kCgkJY2FuLm9uYWN0aW9uLl9jb21wdXRlKGV2ZW50LCBjYW4pCgl9LAp9KQpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFtdLAoJIuaxguWSjCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHJlcywgdGQsIGluZGV4KSB7CgkJcmVzW2luZGV4XSA9IHBhcnNlSW50KHRkLmlubmVyVGV4dCkgKyAocmVzW2luZGV4XXx8MCk7Cgl9LAoJIuacgOWkpyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHJlcywgdGQsIGluZGV4KSB7CgkJdmFyIG4gPSBwYXJzZUludCh0ZC5pbm5lclRleHQpOwoJCW4gPiAocmVzW2luZGV4XXx8LTEwMDAwKSAmJiAocmVzW2luZGV4XSA9IG4pOwoJfSwKCSLmnIDlsI8iOiBmdW5jdGlvbihldmVudCwgY2FuLCByZXMsIHRkLCBpbmRleCkgewoJCXZhciBuID0gcGFyc2VJbnQodGQuaW5uZXJUZXh0KTsKCQluIDwgKHJlc1tpbmRleF18fDEwMDAwKSAmJiAocmVzW2luZGV4XSA9IG4pOwoJfSwKCSLlubPlnYciOiBmdW5jdGlvbihldmVudCwgY2FuLCByZXMsIHRkLCBuY29sLCBjb2xzLCByb3dzLCBucm93KSB7CgkJcmVzW25jb2xdID0gcGFyc2VJbnQodGQuaW5uZXJUZXh0KSArIChyZXNbbmNvbF18fDApOwoJCWlmIChucm93ID09IHJvd3MubGVuZ3RoIC0gMSkgewoJCQlyZXNbbmNvbF0gPSByZXNbbmNvbF0gLyBucm93CgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLnu4Tku7boj5zljZUiLCBsaXN0OiBbIuS/neWtmCIsIFsibW9kZSIsICLlhajpgIkiLCAi5Z2X6YCJIiwgIuWPjemAiSIsICLlpJrpgIkiLCAi5ouW5YqoIiwgIue8lui+kSJdLCBbInNvbWUiLCAi5rGC5ZKMIiwgIuacgOWkpyIsICLmnIDlsI8iLCAi5bmz5Z2HIl1dLAoJX2NvbXB1dGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgbXVsID0gInRyIiArIChjYW4uQWN0aW9uKCJtb2RlIikgPT0gIuWFqOmAiSI/ICIiOiAiLnNlbGVjdCIpCgkJdmFyIG1ldGhvZCA9IGNhbi5vbmZpZ3VyZVtjYW4uQWN0aW9uKCJzb21lIildLCByZXMgPSB7fQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgbXVsLCBmdW5jdGlvbih0ciwgbnJvdywgcm93cykgewoJCQkobXVsICE9ICJ0ciIgfHwgbnJvdyA+IDApICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCAidGQiLCBmdW5jdGlvbih0ZCwgbmNvbCwgY29scykgewoJCQkJbWV0aG9kICYmIG1ldGhvZChldmVudCwgY2FuLCByZXMsIHRkLCBuY29sLCBjb2xzLCByb3dzLCBucm93KQoJCQl9KQoJCX0pCgoJCWNhbi5jb3JlLkl0ZW0ocmVzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCWNhbi5TdGF0dXMoY2FuLl9tc2cuYXBwZW5kW2tleV0sIHZhbHVlfHwiIikKCQl9KQoJfSwKCgki5L+d5a2YIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGNtZCwgY2FuLk9wdGlvbigicGF0aCIpLCBjYW4ub25leHBvcnQuZmlsZShjYW4pXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJfSwgdHJ1ZSkKCX0sCglzb21lOiBmdW5jdGlvbihldmVudCwgY2FuLCBjbWQpIHsKCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCX0sCgoJIuWFqOmAiSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNtZCAmJiBjYW4uQWN0aW9uKCJtb2RlIiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAib3ZlciIpCgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJaXRlbS5zZXRBdHRyaWJ1dGUoImNvbnRlbnRlZGl0YWJsZSIsIGZhbHNlKQoJCQlpdGVtLnNldEF0dHJpYnV0ZSgiZHJhZ2dhYmxlIiwgZmFsc2UpCgkJCWl0ZW0ub25tb3VzZWVudGVyID0gbnVsbAoJCQlpdGVtLm9uY2xpY2sgPSBudWxsCgkJfSkKCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCX0sCgki5Z2X6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbm1vdXNlZW50ZXIgPSBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJCWNhbi5vbmFjdGlvbi5fY29tcHV0ZShldmVudCwgY2FuKQoJCQl9CgkJfSkKCX0sCgki5Y+N6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbm1vdXNlZW50ZXIgPSBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJCWNhbi5vbmFjdGlvbi5fY29tcHV0ZShldmVudCwgY2FuKQoJCQl9CgkJfSkKCX0sCgki5aSa6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7CgkJCQljYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgaXRlbSwgInNlbGVjdCIpCgkJCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCQkJfQoJCX0pCgl9LAoJIuaLluWKqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNhbi5vbmFjdGlvblsi5YWo6YCJIl0oZXZlbnQsIGNhbiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uc2V0QXR0cmlidXRlKCJkcmFnZ2FibGUiLCB0cnVlKQoJCQlpdGVtLm9uZHJhZ3N0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpIHsgY2FuLmRyYWcgPSBpdGVtIH0KCQkJaXRlbS5vbmRyYWdvdmVyID0gZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGl0ZW0sICJvdmVyIil9CgkJCWl0ZW0ub25kcmFnbGVhdmUgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5DbGFzc0xpc3QuZGVsKGNhbiwgaXRlbSwgIm92ZXIiKSB9CgkJCWl0ZW0ub25kcm9wID0gZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0YWJsZSIsIGZ1bmN0aW9uKHRhYmxlKSB7CgkJCQkJdGFibGUuaW5zZXJ0QmVmb3JlKGNhbi5kcmFnLCBpdGVtKQoJCQkJfSkKCQkJfQoJCX0pCgl9LAoJIue8lui+kSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNtZCAmJiBjYW4uQWN0aW9uKCJtb2RlIiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uc2V0QXR0cmlidXRlKCJjb250ZW50ZWRpdGFibGUiLCB0cnVlKQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25kZXRhaWwiLCB7aGVscDogIue7hOS7tuivpuaDhSIsIGxpc3Q6IFsi5aSN5Yi2IiwgIuWIoOmZpCJdLAoJIuWkjeWItiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCwgdmFsdWUsIGtleSwgaW5kZXgsIGxpbmUpIHsKCQl2YXIgZW5kID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnRhYmxlLCBbe3R5cGU6ICJ0ciIsIGxpc3Q6IGNhbi5jb3JlLkxpc3QoY2FuLl9tc2cuYXBwZW5kLCBmdW5jdGlvbihrZXkpIHsKCQkJcmV0dXJuIHt0ZXh0OiBbbGluZVtrZXldLCAidGQiXX0KCQl9KX1dKS50cgoJCWNhbi50YWJsZS5pbnNlcnRCZWZvcmUoZW5kLCBldmVudC50YXJnZXQucGFyZW50Tm9kZSkKCX0sCgki5Yig6ZmkIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJZmlsZTogZnVuY3Rpb24oY2FuKSB7CgkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbih0cikgewoJCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdHIsICJ0aCx0ZCIsIGZ1bmN0aW9uKHRkKSB7cmV0dXJuIHRkLmlubmVySFRNTH0pLmpvaW4oIiwiKQoJCX0pLmpvaW4oIlxuIikKCX0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci9zZWFyY2guanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgYXJncywgY2IpIHsgdmFyIGhpc3RvcnkgPSBbXTsgY29uc3QgU0VBUkNIID0gImNhbi5jb2RlLmlubmVyLnNlYXJjaCIKCWZ1bmN0aW9uIHNob3cobXNnLCB3b3JkKSB7IGlmICghbXNnKSB7IHJldHVybiB9IGhpc3RvcnkucHVzaChtc2cpOyB2YXIgc3ViID0gbXNnLl9jYW47IHN1Yi5PcHRpb24oIndvcmQiLCB3b3JkfHxtc2cuX3dvcmQpCgkJIXN1Yi5wYWdlLkNsYXNzTGlzdC5oYXMoc3ViLCBzdWIuX2xlZ2VuZCwgInNlbGVjdCIpICYmIGNhbi51aS5zZWFyY2guc2VsZWN0KCkKCQlzdWIub25tb3Rpb24uY2xlYXIoc3ViKSwgc3ViLm9uYXBwZW5kLnRhYmxlKHN1YiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSkgewoJCQlyZXR1cm4ge3RleHQ6IFsiIiwgaHRtbC5URF0sIGxpc3Q6IFt7dGV4dDogW2Nhbi5wYWdlLnJlcGxhY2UoY2FuLCB2YWx1ZSwgaWNlLlBXRCwgIiIpLCBodG1sLkRJVl19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWxpbmUubGluZSAmJiBjYW4ub25pbXBvcnQudGFidmlldyhjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpLCBsaW5lLmZpbGUucmVwbGFjZShpY2UuUFdELCAiIiksIHBhcnNlSW50KGxpbmUubGluZSkpCgkJCX19CgkJfSwgc3ViLl9vdXRwdXQpLCBzdWIub25hcHBlbmQuYm9hcmQoc3ViLCBtc2cuUmVzdWx0KCkpLCBzdWIub25hcHBlbmQuX3N0YXR1cyhzdWIsIG1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMpKSwgY2FuLlN0YXR1cygi5qCH562+5pWwIiwgbXNnLkxlbmd0aCgpKQoJfQoJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sIFNFQVJDSCwgc2h5KCLmkJzntKIiLCB7fSwgWwoJCXt0eXBlOiBodG1sLlRFWFQsIG5hbWU6ICJ3b3JkIiwgdmFsdWU6IGNsaS5NQUlOLCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdFRhYmxlKGV2ZW50LCBjYW4uc3VwLCBldmVudC50YXJnZXQsIGZ1bmN0aW9uKHRyKSB7CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQsIGluZGV4KSB7IGluZGV4ID09IDAgJiYgdGQuY2xpY2soKSB9KQoJCQkJdHIuc2Nyb2xsSW50b1ZpZXcoKSwgY2FuLl9vdXRwdXQuc2Nyb2xsVG9wIC09IDYwCgkJCX0pCgkJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FTlRFUikgeyBjYW4uc3VwLlVwZGF0ZShldmVudCwgW2N0eC5BQ1RJT04sIGV2ZW50LmN0cmxLZXk/IG5mcy5HUkVQOiBuZnMuVEFHUywgY2FuLnN1cC5PcHRpb24oIndvcmQiKV0pIH0KCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVTQ0FQRSkgeyBldmVudC50YXJnZXQuYmx1cigpIH0KCQl9fSwKCQl7dHlwZTogaHRtbC5URVhULCBuYW1lOiAiZmlsdGVyIiwgdmFsdWU6ICIiLCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdFRhYmxlSW5wdXQoZXZlbnQsIGNhbi5zdXAsIGV2ZW50LnRhcmdldCkKCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVOVEVSKSB7IGNhbi5zdXAuVXBkYXRlKGV2ZW50LCBbY3R4LkFDVElPTiwgZXZlbnQuY3RybEtleT8gbmZzLkdSRVA6IG5mcy5UQUdTLCBjYW4uc3VwLk9wdGlvbigid29yZCIpXSkgfQoJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRVNDQVBFKSB7IGV2ZW50LnRhcmdldC5ibHVyKCkgfQoJCX19LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogbmZzLlRBR1N9LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogbmZzLkdSRVB9LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogY2xpLk1BS0V9LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogImhpc3RvcnkifSwKCQl7dHlwZTogaHRtbC5CVVRUT04sIG5hbWU6ICJsYXN0IiwgX3RyYW5zOiAi6L+U5ZueIn0sCgldLCBmdW5jdGlvbihtc2csIGNtZHMsIGNiKSB7IGlmIChjYW4ubWlzYy5ydW5BY3Rpb24oY2FuLCBtc2csIGNtZHMsIGNiLCBraXQuRGljdCgKCQkiaGlzdG9yeSIsIGZ1bmN0aW9uKGNtZHMpIHsKCQkJY2FuLmNvcmUuTGlzdChjYW4uaGlzdG9yeSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJbXNnLlB1c2gobmZzLkZJTEUsIGl0ZW0uZmlsZSkKCQkJCW1zZy5QdXNoKG5mcy5MSU5FLCBpdGVtLmxpbmUpCgkJCQltc2cuUHVzaChtZGIuVEVYVCwgaXRlbS50ZXh0KQoJCQl9KQoJCQlzaG93KG1zZykKCQl9LAoJCW5mcy5UQUdTLCBmdW5jdGlvbihjbWRzKSB7IG1zZy5PcHRpb24oa2l0LkRpY3QoaWNlLk1TR19IQU5ETEUsIGljZS5UUlVFLCBpY2UuTVNHX0ZJRUxEUywgImZpbGUsbGluZSx0ZXh0IikpCgkJCWNhbi5ydW4obXNnLl9ldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5TRUFSQ0gsIGNhbi5wYXJzZSwgY21kc1swXSwgY2FuLk9wdGlvbihuZnMuUEFUSCldLCBmdW5jdGlvbihtc2cpIHsgdmFyIHN1YiA9IG1zZy5fY2FuCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIGNhbi5Db25mSGVpZ2h0KCkvNCksIHNob3cobXNnLCBtc2cuX3dvcmQgPSBjbWRzWzBdKQoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhzdWIsIHN1Yi5fdGFyZ2V0LCBodG1sLlNFTEVDVCkgfHwgc3ViLl9sZWdlbmQuY2xpY2soKQoJCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgbXNnLl9jYW4uX2lucHV0c1sid29yZCJdLl90YXJnZXQpCgkJCX0sIHRydWUpCgkJfSwKCQluZnMuR1JFUCwgZnVuY3Rpb24oY21kcykgeyBtc2cuT3B0aW9uKGtpdC5EaWN0KGljZS5NU0dfSEFORExFLCBpY2UuVFJVRSwgaWNlLk1TR19GSUVMRFMsICJmaWxlLGxpbmUsdGV4dCIsIG5mcy5QQVRILCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkpCgkJCWNhbi5ydW4obXNnLl9ldmVudCwgW2N0eC5BQ1RJT04sIG5mcy5HUkVQLCBjbWRzWzBdXSwgZnVuY3Rpb24obXNnKSB7IHZhciBzdWIgPSBtc2cuX2NhbgoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfSEVJR0hULCBjYW4uQ29uZkhlaWdodCgpLzQpLCBzaG93KG1zZywgbXNnLl93b3JkID0gY21kc1swXSkKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoc3ViLCBzdWIuX3RhcmdldCwgaHRtbC5TRUxFQ1QpIHx8IHN1Yi5fbGVnZW5kLmNsaWNrKCkKCQkJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIG1zZy5fY2FuLl9pbnB1dHNbIndvcmQiXS5fdGFyZ2V0KQoJCQl9LCB0cnVlKQoJCX0sCgkJImxhc3QiLCBmdW5jdGlvbihjbWRzKSB7IGhpc3RvcnkucG9wKCksIHNob3coaGlzdG9yeS5wb3AoKSkgfSwKCSkpKSB7IHJldHVybiB9IGNhbi5ydW4obXNnLl9ldmVudCwgY21kcywgZnVuY3Rpb24obXNnKSB7IHNob3cobXNnKSB9LCB0cnVlKSB9KSkKCWNhbi5vbmltcG9ydC50b29sa2l0KGNhbiwge2luZGV4OiBTRUFSQ0h9LCBmdW5jdGlvbihzdWIpIHsKCQljYW4udWkuc2VhcmNoID0gc3ViLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YikKCQljYW4udWkuc2VhcmNoLl9zaG93ID0gc2hvdwoJfSkKfX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fYWN0aW9uKQoJCWNhbi5vbmltcG9ydC5fc2hvdyhjYW4sIG1zZyksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWNhbi5rZXlsaXN0ID0gW10sIGNhbi5vbmtleW1hcC5fYnVpbGQoY2FuKQoJfSwKCV9zaG93OiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4ucG9pbnQgPSBbXQoJCWNhbi5zdmcgPSBudWxsLCBjYW4uZ3JvdXAgPSBudWxsLCBjYW4udGVtcCA9IG51bGwsIGNhbi5jdXJyZW50ID0gbnVsbAoKCQkvLyDliqDovb3lm77lvaIKCQljYW4udWkgPSBjYW4ub25sYXlvdXQucHJvZmlsZShjYW4pLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmNvbnRlbnQsIG1zZy5SZXN1bHQoKXx8Y2FuLm9uZXhwb3J0LmNvbnRlbnQoY2FuKSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5TVkcsIGZ1bmN0aW9uKHN2ZykgewoJCQljYW4uc3ZnID0gY2FuLmdyb3VwID0gY2FuLm9uaW1wb3J0Ll9ibG9jayhjYW4sIHN2ZyksIGNhbi5vbmltcG9ydC5fZ3JvdXAoY2FuLCBzdmcpLmNsaWNrKCkKCQkJY2FuLmNvcmUuSXRlbUNCKGNhbi5vbmFjdGlvbiwgZnVuY3Rpb24oa2V5LCBjYikgeyBzdmdba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCBjYW4pIH0gfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgc3ZnLCAiKiIsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7IGNhbi5vbmltcG9ydC5fYmxvY2soY2FuLCBpdGVtKQoJCQkJaXRlbS50YWdOYW1lID09IHN2Zy5HICYmIGl0ZW0uVmFsdWUoaHRtbC5DTEFTUykgJiYgY2FuLm9uaW1wb3J0Ll9ncm91cChjYW4sIGl0ZW0pCgkJCX0pCgkJfSkKCQkvLyDpu5jorqTlj4LmlbAKCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7CgkJCWNhbi5jb3JlLkl0ZW0oewoJCQkJInN0cm9rZS13aWR0aCI6IDIsIHN0cm9rZTogY2xpLllFTExPVywgZmlsbDogY2xpLlBVUlBMRSwKCQkJCSJmb250LXNpemUiOiAyNCwgImZvbnQtZmFtaWx5IjogaHRtbC5NT05PU1BBQ0UsCgkJCQlnbzogaWNlLlJVTiwgc2hhcGU6ICJyZWN0IiwgZ3JpZDogMTAsCgkJCX0sIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgY2FuLnN2Zy5WYWx1ZShrZXksIGNhbi5BY3Rpb24oa2V5LCBjYW4uc3ZnLlZhbHVlKGtleSl8fHZhbHVlKSkgfSkKCgkJCXZhciBwaWQgPSBjYW4uT3B0aW9uKCJwaWQiKXx8Y2FuLnN2Zy5WYWx1ZSgicGlkIik7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkucHJvZmlsZSwgdHJ1ZSkKCQkJcGlkICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtwaWQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5vbmRldGFpbC5ydW4oe3RhcmdldDogaXRlbX0sIGNhbiksIGNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGl0ZW0pCgkJCX0pIHx8IGNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGNhbi5zdmcpLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2ZpbGUpCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5kaXNwbGF5LCB7c3R5bGU6IHsibWluLWhlaWdodCI6IDgwLCAibWF4LWhlaWdodCI6IGNhbi5Db25mKCJoZWlnaHQiKS1jYW4uc3ZnLlZhbCgiaGVpZ2h0IiktNTJ9fSkKCQl9KSAKCX0sCglfZ3JvdXA6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHZhciBuYW1lID0gdGFyZ2V0Lkdyb3VwcygpCgkJZnVuY3Rpb24gc2hvdyhldmVudCkgeyBjYW4uZ3JvdXAgPSB0YXJnZXQKCQkJY2FuLmNvcmUuTGlzdChbaHRtbC5TVFJPS0VfV0lEVEgsIGh0bWwuU1RST0tFLCBodG1sLkZJTEwsIGh0bWwuRk9OVF9TSVpFXSwgZnVuY3Rpb24oa2V5KSB7CgkJCQljYW4uQWN0aW9uKGtleSwgdGFyZ2V0LlZhbHVlKGtleSl8fGNhbi5BY3Rpb24oa2V5KSkKCQkJfSkKCQl9CgkJcmV0dXJuIChuYW1lIHx8IHRhcmdldCA9PSBjYW4uc3ZnKSAmJiBjYW4ub25hcHBlbmQuaXRlbShjYW4sIGh0bWwuSVRFTSwge25hbWU6IG5hbWV8fGh0bWwuU1ZHfSwgZnVuY3Rpb24oZXZlbnQpIHsgc2hvdyhldmVudCkKCQkJY2FuLm9uYWN0aW9uLnNob3coZXZlbnQsIGNhbikKCQl9LCBmdW5jdGlvbihldmVudCkgewoJCQljYW4udXNlci5jYXJ0ZVJpZ2h0KGV2ZW50LCBjYW4sIGNhbi5vbmFjdGlvbiwgW2ljZS5ISURFLCBpY2UuU0hPVywgbWRiLkNSRUFURSwgY2xpLkNMRUFSLCBtZGIuUkVNT1ZFXSkKCQl9LCBjYW4udWkucHJvamVjdCkKCX0sCglfYmxvY2s6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJdGFyZ2V0Lm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbihldmVudCkgewoJCQl2YXIgY2FydGUgPSBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBjYW4ub25kZXRhaWwsIG51bGwsIGZ1bmN0aW9uKGV2LCBidXR0b24sIG1ldGEpIHsKCQkJCW1ldGFbYnV0dG9uXShldmVudCwgY2FuLCBidXR0b24pCgkJCX0pOyBjYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYXJ0ZS5fdGFyZ2V0LCB7c3R5bGU6IHtsZWZ0OiBldmVudC5jbGllbnRYLCB0b3A6IGV2ZW50LmNsaWVudFl9fSkKCQl9CgkJdGFyZ2V0LlZhbCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKCQkJcmV0dXJuIHBhcnNlSW50KHRhcmdldC5WYWx1ZShrZXksIHZhbHVlID09IHVuZGVmaW5lZD8gdmFsdWU6IHBhcnNlSW50KHZhbHVlKXx8MCkpfHwwCgkJfQoJCXRhcmdldC5WYWx1ZSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgaWYgKGNhbi5iYXNlLmlzVW5kZWZpbmVkKGtleSkpIHsgcmV0dXJuIH0KCQkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsgY2FuLmNvcmUuSXRlbShrZXksIHRhcmdldC5WYWx1ZSk7IHJldHVybiB9CgoJCQl2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCB0YXJnZXQpCgkJCWtleSA9IGZpZ3VyZSAmJiBmaWd1cmUuZGF0YSAmJiBmaWd1cmUuZGF0YS5zaXplICYmIGZpZ3VyZS5kYXRhLnNpemVba2V5XSB8fCBrZXkKCQkJaWYgKGZpZ3VyZSAmJiBmaWd1cmUuZGF0YSAmJiBjYW4uYmFzZS5pc0Z1bmMoZmlndXJlLmRhdGFba2V5XSkpIHsKCQkJCXJldHVybiBmaWd1cmUuZGF0YVtrZXldKGNhbiwgdmFsdWUsIGtleSwgdGFyZ2V0KQoJCQl9CgoJCQlpZiAoa2V5ID09IGh0bWwuSU5ORVIpIHsKCQkJCXJldHVybiB2YWx1ZSAhPSB1bmRlZmluZWQgJiYgKHRhcmdldC5pbm5lckhUTUwgPSB2YWx1ZSksIHRhcmdldC5pbm5lckhUTUwKCQkJfQoJCQlpZiAoa2V5ID09IGljZS5TSElQKSB7CgkJCQlyZXR1cm4gdmFsdWUgIT0gdW5kZWZpbmVkICYmIHRhcmdldC5zZXRBdHRyaWJ1dGUoa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpLCBjYW4uYmFzZS5PYmoodGFyZ2V0LmdldEF0dHJpYnV0ZShrZXkpLCBbXSkKCQkJfQoJCQlyZXR1cm4gdmFsdWUgIT0gdW5kZWZpbmVkICYmIHRhcmdldC5zZXRBdHRyaWJ1dGUoa2V5LCB2YWx1ZSksIHRhcmdldC5nZXRBdHRyaWJ1dGUoa2V5fHxodG1sLkNMQVNTKQoJCQkJfHwgdGFyZ2V0W2tleV0mJnRhcmdldFtrZXldLmJhc2VWYWwmJnRhcmdldFtrZXldLmJhc2VWYWwudmFsdWUgfHwgdGFyZ2V0W2tleV0mJnRhcmdldFtrZXldLmJhc2VWYWwgfHwgIiIKCQl9CgkJdGFyZ2V0Lkdyb3VwID0gZnVuY3Rpb24oKSB7IHZhciBpdGVtID0gdGFyZ2V0CgkJCXdoaWxlIChpdGVtKSB7IGlmIChbaHRtbC5TVkcsIHN2Zy5HXS5pbmRleE9mKGl0ZW0udGFnTmFtZSkgPiAtMSkgeyByZXR1cm4gaXRlbSB9OyBpdGVtID0gaXRlbS5wYXJlbnROb2RlIH0KCQkJcmV0dXJuIGNhbi5zdmcKCQl9CgkJdGFyZ2V0Lkdyb3VwcyA9IGZ1bmN0aW9uKCkgeyB2YXIgaXRlbSA9IHRhcmdldAoJCQl2YXIgbGlzdCA9IFtdOyB3aGlsZSAoaXRlbSAmJiBpdGVtLnRhZ05hbWUgIT0gaHRtbC5TVkcpIHsKCQkJCWl0ZW0udGFnTmFtZSA9PSBzdmcuRyAmJiBpdGVtLlZhbHVlKGh0bWwuQ0xBU1MpICYmIGxpc3QucHVzaChpdGVtLlZhbHVlKGh0bWwuQ0xBU1MpKQoJCQkJaXRlbSA9IGl0ZW0ucGFyZW50Tm9kZQoJCQl9CgkJCXJldHVybiBsaXN0LnJldmVyc2UoKS5qb2luKGljZS5QVCkKCQl9CgkJcmV0dXJuIHRhcmdldAoJfSwKCV9wcm9maWxlOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgbGlzdCkgeyBjYW4uT3B0aW9uKCJwaWQiLCBjYW4ub25maWd1cmUuX3BpZChjYW4sIHRhcmdldCkpCgkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gdGFyZ2V0LlZhbHVlKCJwaWQiKSB9LCBjYW4udWkucHJvZmlsZSkpIHsgcmV0dXJuIH0KCgkJdmFyIGFjdGlvbiA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5wcm9maWxlLCBbe3ZpZXc6ICJhY3Rpb24ifV0pLmZpcnN0CgkJY2FuLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBjYW4ub25kZXRhaWwubGlzdCwgYWN0aW9uLCB7X2VuZ2luZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJCWNhbi5vbmRldGFpbFtidXR0b25dKHt0YXJnZXQ6IHRhcmdldH0sIGNhbiwgYnV0dG9uKQoJCX19KQoKCQl2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCB0YXJnZXQpCgkJbGlzdCA9IChsaXN0fHxbXSkuY29uY2F0KGZpZ3VyZS5kYXRhLmNvcHksIFtzdmcuWCwgc3ZnLlksIG1kYi5JTkRFWCwgY3R4LkFSR1NdKQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5wcm9maWxlLCBbe3R5cGU6IGh0bWwuVEFCTEUsIGNsYXNzTmFtZTogImNvbnRlbnQiLCBsaXN0OiBbCgkJCXt0aDogW21kYi5LRVksIG1kYi5WQUxVRV19LCB7dGQ6IFttZGIuVFlQRSwgdGFyZ2V0LnRhZ05hbWVdfSwge3RkOiBbInBpZCIsIHRhcmdldC5WYWx1ZSgicGlkIildfSwKCQldLmNvbmNhdChjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGtleSkgewoJCQlyZXR1cm4ga2V5ID0gZmlndXJlLmRhdGEuc2l6ZVtrZXldfHxrZXksIHt0ZDogW2tleSwgdGFyZ2V0LlZhbHVlKGtleSldLCBvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9ubW90aW9uLm1vZGlmeShjYW4sIGV2ZW50LnRhcmdldCwgZnVuY3Rpb24oZXZlbnQsIHZhbHVlLCBvbGQpIHsKCQkJCQl0YXJnZXQuVmFsdWUoa2V5LCB2YWx1ZSksIGNhbi5vbmZpZ3VyZS5fbW92ZShjYW4sIHRhcmdldCkKCQkJCX0pCgkJCX19CgkJfSkpIH1dKQoKCX0sCglkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCB2YWx1ZSkgewoJCXZhciBmaWd1cmUgPSBjYW4ub25maWd1cmVbdmFsdWUuc2hhcGVdCgkJdmFyIGRhdGEgPSBmaWd1cmUuZHJhdyhldmVudCwgY2FuLCB2YWx1ZS5wb2ludCwgdmFsdWUuc3R5bGUpCgkJY2FuLmNvcmUuSXRlbSh2YWx1ZS5zdHlsZSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyBkYXRhW2tleV0gPSB2YWx1ZSB9KQoJCXZhciBpdGVtID0gY2FuLm9uZmlndXJlLl9wdXNoKGNhbiwgZmlndXJlLmRhdGEubmFtZXx8dmFsdWUuc2hhcGUsIGRhdGEsIGNhbi5ncm91cHx8Y2FuLnN2ZykKCQljYW4uY29yZS5JdGVtQ0IodmFsdWUsIGZ1bmN0aW9uKGtleSwgY2IpIHsgaXRlbVtrZXldID0gY2IgfSkKCQljYW4ub25pbXBvcnQuX2Jsb2NrKGNhbiwgaXRlbSksIGNhbi5vbmZpZ3VyZS5fcGlkKGNhbiwgaXRlbSkKCQlyZXR1cm4gdmFsdWUuX2luaXQgJiYgdmFsdWUuX2luaXQoaXRlbSksIGl0ZW0KCX0sCn0sIFsiL3BsdWdpbi9sb2NhbC93aWtpL2RyYXcuY3NzIl0pClZvbGNhbm9zKCJvbmZpZ3VyZSIsIHtoZWxwOiAi5Zu+5b2i57uY5Yi2IiwgbGlzdDogW10sCglfZ2V0OiBmdW5jdGlvbihjYW4sIGl0ZW0sIG5hbWUpIHsKCQlyZXR1cm4gY2FuLm9uZmlndXJlW25hbWVdfHxjYW4ub25maWd1cmVbaXRlbS5nZXRBdHRyaWJ1dGUobWRiLk5BTUUpXXx8Y2FuLm9uZmlndXJlW2l0ZW0udGFnTmFtZV0KCX0sCglfcGlkOiBmdW5jdGlvbihjYW4sIGl0ZW0pIHsgaWYgKGl0ZW0uVmFsdWUoInBpZCIpKSB7IHJldHVybiBpdGVtLlZhbHVlKCJwaWQiKSB9CgkJdmFyIHBpZCA9ICJwIitjYW4uc3ZnLlZhbChtZGIuQ09VTlQsIGNhbi5zdmcuVmFsKG1kYi5DT1VOVCkrMSkKCQlpdGVtLlZhbHVlKGh0bWwuQ0xBU1MsIChpdGVtLlZhbHVlKGh0bWwuQ0xBU1MpK2ljZS5TUCtpdGVtLlZhbHVlKCJwaWQiLCBwaWQpKS50cmltKCkpCgkJcmV0dXJuIHBpZAoJfSwKCV9wdXNoOiBmdW5jdGlvbihjYW4sIHR5cGUsIGRhdGEsIHRhcmdldCkgewoJCXZhciBpdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIsIHR5cGUpCgkJdGFyZ2V0LmFwcGVuZENoaWxkKGNhbi5vbmltcG9ydC5fYmxvY2soY2FuLCBpdGVtKSksIGl0ZW0uVmFsdWUoZGF0YSkKCQlyZXR1cm4gaXRlbQoJfSwKCV9jb3B5OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQl2YXIgZGF0YSA9IHt9LCBmaWd1cmUgPSBjYW4ub25maWd1cmUuX2dldChjYW4sIHRhcmdldCksIHNpemUgPSBmaWd1cmUuZGF0YS5zaXplCgkJY2FuLmNvcmUuTGlzdChmaWd1cmUuZGF0YS5jb3B5LCBmdW5jdGlvbihpdGVtKSB7IGRhdGFbaXRlbV0gPSB0YXJnZXQuVmFsdWUoaXRlbSkgfSkKCQlkYXRhW3NpemUueHx8c3ZnLlhdID0gdGFyZ2V0LlZhbChzaXplLnh8fHN2Zy5YKSsxMAoJCWRhdGFbc2l6ZS55fHxzdmcuWV0gPSB0YXJnZXQuVmFsKHNpemUueXx8c3ZnLlkpKzEwCgkJcmV0dXJuIGNhbi5vbmZpZ3VyZS5fcHVzaChjYW4sIHRhcmdldC50YWdOYW1lLCBkYXRhLCBjYW4uZ3JvdXB8fGNhbi5zdmcpCgl9LAoJX21vdmU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBsaXN0KSB7CgkJY2FuLmNvcmUuTGlzdChsaXN0fHx0YXJnZXQuVmFsdWUoaWNlLlNISVApLCBmdW5jdGlvbihzaGlwKSB7CgkJCXNoaXAudGFyZ2V0ID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK3NoaXAucGlkKVswXQoJCQl2YXIgcCA9IGNhbi5vbmV4cG9ydC5hbmNob3IodGFyZ2V0LCBzaGlwLmFuY2hvciwge30pIAoJCQlpZiAoc2hpcC53aGljaCA9PSAxKSB7CgkJCQlzaGlwLnRhcmdldC5WYWwoIngxIiwgcC54KSwgc2hpcC50YXJnZXQuVmFsKCJ5MSIsIHAueSkKCQkJfSBlbHNlIGlmIChzaGlwLndoaWNoID09IDIpIHsKCQkJCXNoaXAudGFyZ2V0LlZhbCgieDIiLCBwLngpLCBzaGlwLnRhcmdldC5WYWwoInkyIiwgcC55KQoJCQl9CgkJfSkKCX0sCgoJc3ZnOiB7IC8vIDxzdmcgaGVpZ2h0PSIyMDAiIHdpZHRoPSI2MDAiIGNvdW50PSIwIiBncmlkPSIxMCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9InllbGxvdyIgZmlsbD0icHVycGxlIiBmb250LXNpemU9IjI0Ii8+CgkJZGF0YToge3NpemU6IHt9LCBjb3B5OiBbXX0sCgkJc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgeyByZXR1cm4gY2FuLm9uZXhwb3J0Ll9zaXplKGNhbiwgdGFyZ2V0LCBmaWd1cmUpIH0KCX0sCgl0ZXh0OiB7IC8vIDx0ZXh0IHg9IjYwIiB5PSIxMCI+aGk8dGV4dD4KCQlkYXRhOiB7cG9pbnRzOiAxLCBzaXplOiB7fSwgY29weTogW2h0bWwuSU5ORVJdfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCwgc3R5bGUpIHsgaWYgKHBvaW50Lmxlbmd0aCA8IDEgfHwgZXZlbnQudHlwZSA9PSAibW91c2Vtb3ZlIikgeyByZXR1cm4gfQoJCQl2YXIgcDAgPSBwb2ludFswXSwgdGV4dCA9IHN0eWxlJiZzdHlsZS5pbm5lcnx8Y2FuLnVzZXIucHJvbXB0KG1kYi5URVhUKQoJCQlyZXR1cm4gdGV4dD8ge3g6IHAwLngsIHk6IHAwLnksIGlubmVyOiB0ZXh0fTogbnVsbAoJCX0sCgkJc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgeyByZXR1cm4gY2FuLm9uZXhwb3J0Ll9wb3NpdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB9Cgl9LAoJY2lyY2xlOiB7IC8vIDxjaXJjbGUgcj0iMjAiIGN4PSIyNSIgY3k9Ijc1Ii8+CgkJZGF0YToge3BvaW50czogMiwgc2l6ZToge2hlaWdodDogc3ZnLlIsIHdpZHRoOiBzdmcuUiwgeDogImN4IiwgeTogImN5In0sIGNvcHk6IFtzdmcuUl19LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdCgkJCXJldHVybiB7cjogcGFyc2VJbnQoTWF0aC5zcXJ0KE1hdGgucG93KHAwLngtcDEueCwgMikrTWF0aC5wb3cocDAueS1wMS55LCAyKSkpLCBjeDogcDAueCwgY3k6IHAwLnl9CgkJfSwKCX0sCgllbGxpcHNlOiB7IC8vIDxlbGxpcHNlIHJ5PSI1IiByeD0iMjAiIGN4PSI3NSIgY3k9Ijc1Ii8+CgkJZGF0YToge3BvaW50czogMiwgc2l6ZToge2hlaWdodDogInJ5Iiwgd2lkdGg6ICJyeCIsIHg6ICJjeCIsIHk6ICJjeSJ9LCBjb3B5OiBbInJ5IiwgInJ4Il19LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdCgkJCXJldHVybiB7cnk6IE1hdGguYWJzKHAwLnkgLSBwMS55KSwgcng6IE1hdGguYWJzKHAwLnggLSBwMS54KSwgY3g6IHAwLngsIGN5OiBwMC55fQoJCX0sCgl9LAoJcmVjdDogeyAvLyA8cmVjdCBoZWlnaHQ9IjMwIiB3aWR0aD0iMzAiIHJ5PSIxMCIgcng9IjEwIiB4PSI2MCIgeT0iMTAiLz4KCQlkYXRhOiB7cG9pbnRzOiAyLCByeTogNCwgcng6IDQsIHNpemU6IHt9LCBjb3B5OiBbaHRtbC5IRUlHSFQsIGh0bWwuV0lEVEgsICJyeSIsICJyeCJdfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyBpZiAocG9pbnQubGVuZ3RoIDwgMikgeyByZXR1cm4gfQoJCQl2YXIgcDAgPSBwb2ludFswXSwgcDEgPSBwb2ludFsxXQoJCQlyZXR1cm4gewoJCQkJaGVpZ2h0OiBNYXRoLmFicyhwMC55LXAxLnkpLCB3aWR0aDogTWF0aC5hYnMocDAueC1wMS54KSwgcnk6IHRoaXMuZGF0YS5yeSwgcng6IHRoaXMuZGF0YS5yeCwKCQkJCXg6IHAwLnggPiBwMS54PyBwMS54OiBwMC54LCB5OiBwMC55ID4gcDEueT8gcDEueTogcDAueSwKCQkJfQoJCX0sCgkJdGV4dDogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsgcmV0dXJuIGRhdGEueCA9IHRhcmdldC5WYWwoc3ZnLlgpK3RhcmdldC5WYWwoaHRtbC5XSURUSCkvMiwgZGF0YS55ID0gdGFyZ2V0LlZhbChzdmcuWSkrdGFyZ2V0LlZhbChodG1sLkhFSUdIVCkvMiwgZGF0YSB9LAoJfSwKCWJsb2NrOiB7IC8vIDxyZWN0IGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgcnk9IjEwIiByeD0iMTAiIHg9IjYwIiB5PSIxMCIvPgoJCWRhdGE6IHtwb2ludHM6IDIsIHJ5OiA0LCByeDogNCwgc2l6ZToge30sIGNvcHk6IFtodG1sLkhFSUdIVCwgaHRtbC5XSURUSCwgInJ5IiwgInJ4Il19LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXRoaXMuX3RlbXAgJiYgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdGhpcy5fdGVtcCkgJiYgZGVsZXRlKHRoaXMuX3RlbXApCgkJCXRoaXMuX3RlbXAgPSBjYW4ub25maWd1cmUuX3B1c2goY2FuLCBzdmcuRywge30sIGNhbi5ncm91cHx8Y2FuLnN2ZykKCgkJCXZhciByZWN0ID0gY2FuLm9uZmlndXJlLl9wdXNoKGNhbiwgInJlY3QiLCBjYW4ub25maWd1cmUucmVjdC5kcmF3KGV2ZW50LCBjYW4sIHBvaW50KSwgdGhpcy5fdGVtcCkKCQkJaWYgKGV2ZW50LnR5cGUgPT0gaHRtbC5DTElDSykgewoJCQkJY2FuLm9uZmlndXJlLl9waWQoY2FuLCByZWN0KSwgZGVsZXRlKHRoaXMuX3RlbXApCgkJCX0KCQl9LAoJCXRleHQ6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IGNhbi5vbmZpZ3VyZS5yZWN0LnRleHQoY2FuLCBkYXRhLCB0YXJnZXQpIH0sCgl9LAoJbGluZTogeyAvLyA8bGluZSB4MT0iMTAiIHkxPSI1MCIgeDI9IjExMCIgeTI9IjE1MCIgeHg9IjEwMCIgeXk9IjEwMCIvPgoJCWRhdGE6IHtwb2ludHM6IDIsIHNpemU6IHt4OiAieDEiLCB5OiAieTEifSwgY29weTogWyJ4MSIsICJ5MSIsICJ4MiIsICJ5MiJdfSwKCQlncmlkOiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJCWlmICh0YXJnZXQgPT0gY2FuLnN2ZykgeyByZXR1cm4gfQoJCQl2YXIgcCA9IHBvaW50W3BvaW50Lmxlbmd0aC0xXSwgcG9zID0gY2FuLm9uZXhwb3J0LmN1cnNvcihldmVudCwgY2FuLCB0YXJnZXQpCgkJCXRhcmdldC5WYWwgJiYgY2FuLm9uZXhwb3J0LmFuY2hvcih0YXJnZXQsIHBvcywgcCkKCQkJcmV0dXJuIHAudGFyZ2V0ID0gdGFyZ2V0LCBwLmFuY2hvciA9IHBvcywgcG9pbnQKCQl9LAoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7IGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgkJCXZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdLCBzaGlwID0gW10KCQkJcDAudGFyZ2V0ICYmIHAwLnRhcmdldC5WYWx1ZSAmJiBzaGlwLnB1c2goe3BpZDogcDAudGFyZ2V0LlZhbHVlKCJwaWQiKX0pCgkJCXAxLnRhcmdldCAmJiBwMS50YXJnZXQuVmFsdWUgJiYgc2hpcC5wdXNoKHtwaWQ6IHAxLnRhcmdldC5WYWx1ZSgicGlkIil9KQoJCQlyZXR1cm4ge3gxOiBwMC54LCB5MTogcDAueSwgeDI6IHAxLngsIHkyOiBwMS55LCBzaGlwOiBzaGlwfQoJCX0sCgkJdGV4dDogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGRhdGEpIHsgcmV0dXJuIGRhdGEueCA9ICh0YXJnZXQuVmFsKCJ4MSIpK3RhcmdldC5WYWwoIngyIikpLzIsIGRhdGEueSA9ICh0YXJnZXQuVmFsKCJ5MSIpK3RhcmdldC5WYWwoInkyIikpLzIsIGRhdGEgfSwKCQlzaG93OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB7IHJldHVybiAiPCgiKyh0YXJnZXQuVmFsKCJ5MiIpLXRhcmdldC5WYWwoInkxIikpK2ljZS5GUysodGFyZ2V0LlZhbCgieDIiKS10YXJnZXQuVmFsKCJ4MSIpKSsiKSIrY2FuLm9uZXhwb3J0Ll9wb3NpdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB9LAoJfSwKfSwgW10pClZvbGNhbm9zKCJvbmtleW1hcCIsIHtoZWxwOiAi6ZSu55uY5Lqk5LqSIiwgbGlzdDogW10sCglfbW9kZTogewoJCW5vcm1hbDogewoJCQlncjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJnbyIsICJydW4iKSB9LAoJCQlnYTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJnbyIsICJhdXRvIikgfSwKCQkJZ206IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLkFjdGlvbigiZ28iLCAibWFudWFsIikgfSwKCgkJCWFkOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oIm1vZGUiLCAiZHJhdyIpIH0sCgkJCWFyOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oIm1vZGUiLCAicmVzaXplIikgfSwKCgkJCXN0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oInNoYXBlIiwgInRleHQiKSB9LAoJCQlzcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJzaGFwZSIsICJyZWN0IikgfSwKCQkJc2w6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLkFjdGlvbigic2hhcGUiLCAibGluZSIpIH0sCgkJCXNjOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oInNoYXBlIiwgImNpcmNsZSIpIH0sCgkJCXNlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oInNoYXBlIiwgImVsbGlwc2UiKSB9LAoKCQkJY3I6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAic3Ryb2tlIiwgInJlZCIpIH0sCgkJCWNiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJibHVlIikgfSwKCQkJY2c6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAic3Ryb2tlIiwgImdyZWVuIikgfSwKCQkJY3k6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAic3Ryb2tlIiwgInllbGxvdyIpIH0sCgkJCWNwOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJwdXJwbGUiKSB9LAoJCQljYzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJzdHJva2UiLCAiY3lhbiIpIH0sCgkJCWNoOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJibGFjayIpIH0sCgkJCWN3OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJ3aGl0ZSIpIH0sCgoJCQlmcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgInJlZCIpIH0sCgkJCWZiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAiYmx1ZSIpIH0sCgkJCWZnOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAiZ3JlZW4iKSB9LAoJCQlmeTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgInllbGxvdyIpIH0sCgkJCWZwOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAicHVycGxlIikgfSwKCQkJZmM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAiZmlsbCIsICJjeWFuIikgfSwKCQkJZmg6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAiZmlsbCIsICJibGFjayIpIH0sCgkJCWZ3OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAid2hpdGUiKSB9LAoJCX0sCgl9LCBfZW5naW5lOiB7fSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLnu4Tku7boj5zljZUiLCBsaXN0OiBbCgkJWyJzdHJva2Utd2lkdGgiLCAxLCAyLCAzLCA0LCA1XSwKCQlbInN0cm9rZSIsIGNsaS5SRUQsIGNsaS5ZRUxMT1csIGNsaS5HUkVFTiwgY2xpLkNZQU4sIGNsaS5CTFVFLCBjbGkuUFVSUExFLCBjbGkuQkxBQ0ssIGNsaS5XSElURV0sCgkJWyJmaWxsIiwgY2xpLlJFRCwgY2xpLllFTExPVywgY2xpLkdSRUVOLCBjbGkuQ1lBTiwgY2xpLkJMVUUsIGNsaS5QVVJQTEUsIGNsaS5CTEFDSywgY2xpLldISVRFLCAiIzAwMDAiXSwKCQlbImZvbnQtc2l6ZSIsIDEyLCAxNiwgMTgsIDI0LCAzMl0sCgoJCVsiZ28iLCBpY2UuUlVOLCBpY2UuQVVUTywgIm1hbnVhbCJdLAoJCVsibW9kZSIsICJkcmF3IiwgInJlc2l6ZSJdLAoJCVsic2hhcGUiLCAidGV4dCIsICJjaXJjbGUiLCAiZWxsaXBzZSIsICJyZWN0IiwgImJsb2NrIiwgImxpbmUiXSwKCQlbImdyaWQiLCAxLCAyLCAzLCA0LCA1LCAxMCwgMjBdLAoJXSwKCV9jaGFuZ2U6IGZ1bmN0aW9uKGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4uQWN0aW9uKGtleSwgdmFsdWUpLCBjYW4uZ3JvdXAuVmFsdWUoa2V5LCB2YWx1ZSkgfSwKCSJzdHJva2Utd2lkdGgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwga2V5LCB2YWx1ZSkgfSwKCXN0cm9rZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sIGtleSwgdmFsdWUpIH0sCglmaWxsOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwga2V5LCB2YWx1ZSkgfSwKCSJmb250LXNpemUiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwga2V5LCB2YWx1ZSkgfSwKCglnbzogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4uQWN0aW9uKGtleSwgdmFsdWUpIH0sCgltb2RlOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5BY3Rpb24oa2V5LCB2YWx1ZSkgfSwKCXNoYXBlOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IGNhbi5BY3Rpb24oa2V5LCB2YWx1ZSkgfSwKCgllZGl0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oImdvIiwgY2FuLkFjdGlvbigiZ28iKSA9PSBpY2UuUlVOPyBpY2UuQVVUTzogaWNlLlJVTikgfSwKCXNhdmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge2NvbnRlbnQ6IGNhbi5vbmV4cG9ydC5jb250ZW50KGNhbiwgY2FuLnN2Zyl9KQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBidXR0b24sIGNhbi5PcHRpb24obmZzLlBBVEgpXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJfSwgdHJ1ZSkKCX0sCgoJcHJvamVjdDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLnVpLnByb2plY3QpIH0sCglwcm9maWxlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4udWkucHJvZmlsZSkgfSwKCXNob3c6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnNob3coY2FuLCB7aW50ZXJ2YWw6IDEwMCwgbGVuZ3RoOiAxMH0sIG51bGwsIGNhbi5ncm91cCkgfSwKCWhpZGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLmhpZGUoY2FuLCB7aW50ZXJ2YWw6IDEwMCwgbGVuZ3RoOiAxMH0sIG51bGwsIGNhbi5ncm91cCkgfSwKCWNyZWF0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLnByb21wdCgiZ3JvdXAiLCAic29tZSIsIGZ1bmN0aW9uKG5hbWUpIHsKCQkJdmFyIGdyb3VwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIHN2Zy5HKQoJCQljYW4uZ3JvdXAuYXBwZW5kKGdyb3VwKSwgY2FuLm9uaW1wb3J0Ll9ibG9jayhjYW4sIGdyb3VwKQoJCQlncm91cC5WYWx1ZShodG1sLkNMQVNTLCBuYW1lKSwgY2FuLmNvcmUuTGlzdChbaHRtbC5TVFJPS0VfV0lEVEgsIGh0bWwuU1RST0tFLCBodG1sLkZJTEwsIGh0bWwuRk9OVF9TSVpFXSwgZnVuY3Rpb24obmFtZSkgewoJCQkJZ3JvdXAuVmFsdWUobmFtZSwgY2FuLkFjdGlvbihuYW1lKSkKCQkJfSksIGNhbi5vbmltcG9ydC5fZ3JvdXAoY2FuLCBncm91cCkuY2xpY2soKQoJCX0pCgl9LAoJcmVtb3ZlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGlmIChjYW4uZ3JvdXAgPT0gY2FuLnN2ZykgeyByZXR1cm4gfQoJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5ncm91cCkKCX0sCgljbGVhcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5ncm91cCksIGNhbi5wb2ludCA9IFtdLCBkZWxldGUoY2FuLnRlbXApCgl9LAoKCV9tb2RlOiB7CgkJZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKCQkJdmFyIHNoYXBlID0gY2FuLkFjdGlvbigic2hhcGUiKQoJCQl2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlW3NoYXBlXQoJCQlmaWd1cmUuZ3JpZCAmJiBmaWd1cmUuZ3JpZChldmVudCwgY2FuLCBwb2ludCkKCgkJCXZhciBkYXRhID0gZmlndXJlLmRyYXcgJiYgZmlndXJlLmRyYXcoZXZlbnQsIGNhbiwgcG9pbnQpCgkJCXZhciBpdGVtID0gZGF0YSAmJiBjYW4ub25maWd1cmUuX3B1c2goY2FuLCBmaWd1cmUuZGF0YS5uYW1lfHxzaGFwZSwgZGF0YSwgY2FuLmdyb3VwfHxjYW4uc3ZnKQoJCQlldmVudC50eXBlID09IGh0bWwuQ0xJQ0sgJiYgcG9pbnQubGVuZ3RoID09PSBmaWd1cmUuZGF0YS5wb2ludHMgJiYgKGNhbi5wb2ludCA9IFtdKSAKCgkJCWlmIChldmVudC50eXBlID09IGh0bWwuQ0xJQ0sgJiYgaXRlbSkgewoJCQkJdmFyIHBpZCA9IGNhbi5vbmZpZ3VyZS5fcGlkKGNhbiwgaXRlbSk7IGNhbi5jb3JlLkxpc3QocG9pbnQsIGZ1bmN0aW9uKHAsIGkpIHsgaWYgKCFwLnRhcmdldCkgeyByZXR1cm4gfQoJCQkJCXAudGFyZ2V0LlZhbHVlKGljZS5TSElQLCBwLnRhcmdldC5WYWx1ZShpY2UuU0hJUCkuY29uY2F0KFt7cGlkOiBwaWQsIHdoaWNoOiBpKzEsIGFuY2hvcjogcC5hbmNob3J9XSkpCgkJCQl9KQoJCQl9CgkJCXJldHVybiBpdGVtCgkJfSwKCQlyZXNpemU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50LCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxldmVudC50YXJnZXQKCQkJaWYgKGV2ZW50LnR5cGUgPT0gaHRtbC5DTElDSykgewoJCQkJaWYgKHBvaW50Lmxlbmd0aCA9PSAxKSB7CgkJCQkJY2FuLmN1cnJlbnQgPSB7dGFyZ2V0OiB0YXJnZXQsIGJlZ2luOiBjYW4uY29yZS5MaXN0KFt0YXJnZXRdLCBmdW5jdGlvbihpdGVtKSB7IGlmIChpdGVtLnRhZ05hbWUgPT0gc3ZnLkcpIHsgcmV0dXJuIH0KCQkJCQkJcmV0dXJuIHsKCQkJCQkJCWhlaWdodDogaXRlbS5WYWwoaHRtbC5IRUlHSFQpLCB3aWR0aDogaXRlbS5WYWwoaHRtbC5XSURUSCksIHg6IGl0ZW0uVmFsKHN2Zy5YKSwgeTogaXRlbS5WYWwoc3ZnLlkpLAoJCQkJCQkJdGFyZ2V0OiBpdGVtLCBzaGlwOiBjYW4uY29yZS5MaXN0KGl0ZW0uVmFsdWUoaWNlLlNISVApLCBmdW5jdGlvbihzaGlwKSB7CgkJCQkJCQkJcmV0dXJuIHNoaXAucGlkICYmIChzaGlwLnRhcmdldCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtzaGlwLnBpZClbMF0pICYmIHNoaXAKCQkJCQkJCX0pCgkJCQkJCX0KCQkJCQl9KSwgcG9zOiBjYW4ub25leHBvcnQuY3Vyc29yKGV2ZW50LCBjYW4sIHRhcmdldCl9CgkJCQkJcmV0dXJuCgkJCQl9CgkJCQlyZXR1cm4gY2FuLnBvaW50ID0gW10sIGRlbGV0ZShjYW4uY3VycmVudCkKCQkJfQoKCQkJY2FuLmN1cnJlbnQgJiYgY2FuLmNvcmUuTGlzdChjYW4uY3VycmVudC5iZWdpbiwgZnVuY3Rpb24oaXRlbSkgeyB2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCBpdGVtLnRhcmdldCkKCQkJCWNhbi5vbmV4cG9ydC5yZXNpemUoZXZlbnQsIGl0ZW0udGFyZ2V0LCBpdGVtLCBwb2ludFswXSwgcG9pbnRbMV0sIGNhbi5jdXJyZW50LnBvcykKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtpdGVtLnRhcmdldC5WYWx1ZShtZGIuVEVYVCksIGZ1bmN0aW9uKHRleHQpIHsKCQkJCQl0ZXh0LlZhbHVlKGNhbi5vbmV4cG9ydC5fdGV4dChjYW4sIGl0ZW0udGFyZ2V0LCBmaWd1cmUsIHt9KSkKCQkJCX0pCgkJCQljYW4ub25maWd1cmUuX21vdmUoY2FuLCBpdGVtLnRhcmdldCwgaXRlbS5zaGlwKQoJCQl9KQoJCX0sCgkJcnVuOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJCWNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGV2ZW50LnRhcmdldCkKCQl9LAoJfSwKCV9hdXRvOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCWlmIChjYW4ucG9pbnQubGVuZ3RoID4gMCkgeyByZXR1cm4gfQoJCWlmICh0YXJnZXQudGFnTmFtZSA9PSBtZGIuVEVYVCkgeyByZXR1cm4gfQoKCQl2YXIgcG9zID0gY2FuLm9uZXhwb3J0LmN1cnNvcihldmVudCwgY2FuLCBldmVudC50YXJnZXQpCgkJaWYgKHRhcmdldCA9PSBjYW4uc3ZnKSB7CgkJCWlmIChwb3MgPT0gNSkgewoJCQkJY2FuLkFjdGlvbihpY2UuTU9ERSwgImRyYXciKSwgY2FuLkFjdGlvbigic2hhcGUiLCBodG1sLkJMT0NLKQoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCB7c3R5bGU6IHtjdXJzb3I6ICJjcm9zc2hhaXIifX0pCgkJCX0gZWxzZSB7CgkJCQljYW4uQWN0aW9uKGljZS5NT0RFLCAicmVzaXplIikKCQkJfQoJCX0gZWxzZSB7CgkJCXN3aXRjaCAocG9zKSB7CgkJCQljYXNlIDU6CgkJCQljYXNlIDk6IGNhbi5BY3Rpb24oaWNlLk1PREUsICJyZXNpemUiKTsgYnJlYWsKCQkJCWRlZmF1bHQ6IGNhbi5BY3Rpb24oaWNlLk1PREUsICJkcmF3IiksIGNhbi5BY3Rpb24oInNoYXBlIiwgImxpbmUiKQoJCQl9CgkJfQoJfSwKCV9maWd1cmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50cywgdGFyZ2V0KSB7CgkJY2FuLnRlbXAgJiYgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLnRlbXApICYmIGRlbGV0ZShjYW4udGVtcCkKCQljYW4udGVtcCA9IGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25hY3Rpb24uX21vZGUsIGNhbi5BY3Rpb24oaWNlLk1PREUpXSwgW2V2ZW50LCBjYW4sIHBvaW50cywgdGFyZ2V0XSkKCQljYW4ucG9pbnQubGVuZ3RoID09IDAgJiYgZGVsZXRlKGNhbi50ZW1wKQoJfSwKCglvbm1vdXNlb3ZlcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25leHBvcnQuX3Nob3coY2FuLCBldmVudC50YXJnZXQpIH0sCglvbm1vdXNlbW92ZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgcG9pbnQgPSBjYW4ub25leHBvcnQuX3BvaW50KGV2ZW50LCBjYW4pCgkJaWYgKGNhbi5BY3Rpb24oImdvIikgPT0gaWNlLlJVTikgeyByZXR1cm4gfQoJCWNhbi5vbmV4cG9ydC5jdXJzb3IoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KQoJCWlmIChjYW4uQWN0aW9uKCJnbyIpID09IGljZS5BVVRPKSB7IGNhbi5vbmFjdGlvbi5fYXV0byhjYW4sIGV2ZW50LnRhcmdldCkgfQoJCWNhbi5vbmFjdGlvbi5fZmlndXJlKGV2ZW50LCBjYW4sIGNhbi5wb2ludC5jb25jYXQocG9pbnQpKQoJfSwKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIHBvaW50ID0gY2FuLm9uZXhwb3J0Ll9wb2ludChldmVudCwgY2FuKQoJCWlmIChjYW4uQWN0aW9uKCJnbyIpID09IGljZS5SVU4pIHsgY2FuLm9uaW1wb3J0Ll9wcm9maWxlKGNhbiwgZXZlbnQudGFyZ2V0KQoJCQlyZXR1cm4gZXZlbnQuc2hpZnRLZXk/IGNhbi5vbmFjdGlvbi5fbW9kZS5ydW4oZXZlbnQsIGNhbik6IGNhbi5vbmRldGFpbC5ydW4oZXZlbnQsIGNhbikKCQl9CgkJY2FuLm9uYWN0aW9uLl9maWd1cmUoZXZlbnQsIGNhbiwgY2FuLnBvaW50ID0gY2FuLnBvaW50LmNvbmNhdChwb2ludCkpCgl9LAoJb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbmRldGFpbC5sYWJlbChldmVudCwgY2FuKQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLnu4Tku7bor6bmg4UiLCBsaXN0OiBbY2xpLlNUQVJULCBpY2UuUlVOLCBpY2UuQ09QWSwgaHRtbC5MQUJFTCwgbWRiLk1PRElGWSwgInRvaW1hZ2UiLCBtZGIuREVMRVRFXSwKCXN0YXJ0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQl2YXIgbGlzdCA9IFt0YXJnZXRdLCBkaWN0ID0ge30KCQlmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsgdmFyIHNoaXAgPSBsaXN0W2ldLlZhbHVlKCJzaGlwIikKCQkJZm9yICh2YXIgaiA9IDA7IGogPCBzaGlwLmxlbmd0aDsgaisrKSB7IHZhciBwaWQgPSBzaGlwW2pdLnBpZAoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK3BpZCwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCXZhciBwaWQgPSBpdGVtLlZhbHVlKCJzaGlwIilbMV0ucGlkCgkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK3BpZCwgZnVuY3Rpb24oaXRlbSkgewoJCQkJCQkhZGljdFtwaWRdICYmIGxpc3QucHVzaChpdGVtKSwgZGljdFtwaWRdID0gdHJ1ZQoJCQkJCX0pCgkJCQl9KQoJCQl9CgkJfQoJCWNhbi5jb3JlLk5leHQobGlzdCwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgeyBjYW4uY29yZS5UaW1lcigzMDAwLCBmdW5jdGlvbigpIHsKCQkJY2FuLm9ubW90aW9uLnNob3coY2FuLCB7aW50ZXJ2YWw6IDMwMCwgbGVuZ3RoOiAxMH0sIG51bGwsIGl0ZW0pIAoJCQljYW4udXNlci50b2FzdChjYW4sIGl0ZW0uVmFsdWUoImluZGV4IikpCgkJCWNhbi5vbmRldGFpbC5ydW4oe3RhcmdldDogaXRlbX0sIGNhbiksIG5leHQoKQoJCX0pIH0pCgl9LAoJcnVuOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQlpZiAoIXRhcmdldC5WYWx1ZSgicGlkIikpIHsgY2FuLm9uZmlndXJlLl9waWQoY2FuLCB0YXJnZXQpIH0KCgkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gdGFyZ2V0LlZhbHVlKCJwaWQiKSB9LCBjYW4udWkuZGlzcGxheSkpIHsgcmV0dXJuIH0KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmRpc3BsYXkpLCBjYW4uc3ZnLlZhbHVlKCJwaWQiLCB0YXJnZXQuVmFsdWUoInBpZCIpKQoJCXZhciBpbmRleCA9IHRhcmdldC5WYWx1ZShtZGIuSU5ERVgpOyBpbmRleCAmJiBjYW4ub25hcHBlbmQucGx1Z2luKGNhbiwge3R5cGU6IGNoYXQuU1RPUlksIGluZGV4OiBpbmRleCwgYXJnczogdGFyZ2V0LlZhbHVlKGN0eC5BUkdTKX0sIGZ1bmN0aW9uKHN1YikgewoJCQlzdWIuQ29uZigiaGVpZ2h0IiwgY2FuLkNvbmYoImhlaWdodCIpLWNhbi5zdmcuVmFsKCJoZWlnaHQiKS01MiksIHN1Yi5Db25mKCJ3aWR0aCIsIGNhbi5Db25mKCJ3aWR0aCIpKQoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IGNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtpY2UuUlVOLCBpbmRleF0sIGNtZHMpLCBjYiwgdHJ1ZSkgfQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgc3ViLl9sZWdlbmQpLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLmRpc3BsYXksIHRydWUpCgkJfSwgY2FuLnVpLmRpc3BsYXkpCgl9LAoJY29weTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25maWd1cmUuX2NvcHkoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KSB9LAoJbGFiZWw6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldAoJCXZhciBkZWYgPSB0YXJnZXQuVmFsdWUobWRiLlRFWFQpOyBkZWYgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK2RlZiwgZnVuY3Rpb24oaXRlbSkgewoJCQlkZWYgPSBpdGVtLlZhbHVlKGh0bWwuSU5ORVIpCgkJfSkKCQljYW4udXNlci5wcm9tcHQoaHRtbC5MQUJFTCwgZGVmLCBmdW5jdGlvbih0ZXh0KSB7CgkJCWlmICh0YXJnZXQudGFnTmFtZSA9PSBodG1sLlRFWFQpIHsgcmV0dXJuIHRhcmdldC5pbm5lckhUTUwgPSB0ZXh0IH0KCgkJCWlmIChkZWYgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnN2ZywgaWNlLlBUK2RlZiwgZnVuY3Rpb24oaXRlbSkgewoJCQkJaXRlbS5WYWx1ZShodG1sLklOTkVSLCB0ZXh0KQoJCQl9KS5sZW5ndGggPiAwKSB7CgkJCQlyZXR1cm4KCQkJfQoKCQkJdmFyIGZpZ3VyZSA9IGNhbi5vbmZpZ3VyZS5fZ2V0KGNhbiwgdGFyZ2V0KQoJCQl2YXIgZGF0YSA9IGNhbi5vbmV4cG9ydC5fdGV4dChjYW4sIHRhcmdldCwgZmlndXJlLCB7aW5uZXI6IHRleHR9KQoJCQl2YXIgaXRlbSA9IGNhbi5vbmZpZ3VyZS5fcHVzaChjYW4sIGh0bWwuVEVYVCwgZGF0YSwgdGFyZ2V0Lkdyb3VwKCkpCgkJCXRhcmdldC5WYWx1ZShtZGIuVEVYVCwgY2FuLm9uZmlndXJlLl9waWQoY2FuLCBpdGVtKSkKCQl9KQoJfSwKCW1vZGlmeTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBldmVudC50YXJnZXQpIH0sCgl0b2ltYWdlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2ltYWdlKGV2ZW50LCBjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpLnNwbGl0KCIvIikucG9wKCkuc3BsaXQoIi4iKVswXSwgY2FuLnN2ZykgfSwKCSJkZWxldGUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQlpZiAodGFyZ2V0ID09IGNhbi5zdmcpIHsgcmV0dXJuIH0KCQljYW4uY29yZS5MaXN0KHRhcmdldC5WYWx1ZShpY2UuU0hJUCksIGZ1bmN0aW9uKHZhbHVlKSB7CgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCt2YWx1ZS5waWQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGl0ZW0pCgkJCX0pCgkJfSkKCQl0YXJnZXQuVmFsdWUobWRiLlRFWFQpICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCt0YXJnZXQuVmFsdWUobWRiLlRFWFQpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGl0ZW0pCgkJfSkKCQljYW4ucGFnZS5SZW1vdmUoY2FuLCB0YXJnZXQpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFsiZ3JvdXAiLCAiZmlndXJlIiwgImluZGV4IiwgInBvcyJdLAoJX3Nob3c6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHZhciBmaWd1cmUgPSBjYW4ub25maWd1cmUuX2dldChjYW4sIHRhcmdldCkKCQlmdW5jdGlvbiBzaG93KCkgeyByZXR1cm4gY2FuLm9uZXhwb3J0Ll9zaXplKGNhbiwgdGFyZ2V0LCBmaWd1cmUpK2ljZS5TUCtjYW4ub25leHBvcnQuX3Bvc2l0aW9uKGNhbiwgdGFyZ2V0LCBmaWd1cmUpIH0KCQljYW4uU3RhdHVzKCJmaWd1cmUiLCB0YXJnZXQudGFnTmFtZSsiOiIrdGFyZ2V0LlZhbHVlKCJwaWQiKStpY2UuU1ArKGZpZ3VyZT8gKGZpZ3VyZS5zaG93fHxzaG93KShjYW4sIHRhcmdldCwgZmlndXJlKTogIiIpKQoJCWNhbi5TdGF0dXMoImdyb3VwIiwgdGFyZ2V0Lkdyb3VwcygpfHxjYW4uZ3JvdXAuR3JvdXBzKCl8fGh0bWwuU1ZHKQoJCWNhbi5TdGF0dXMoImluZGV4IiwgdGFyZ2V0LlZhbHVlKCJpbmRleCIpKQoJfSwKCV9zaXplOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB7IHZhciBzaXplID0gZmlndXJlLmRhdGEuc2l6ZXx8e30KCQlyZXR1cm4gIjwoIit0YXJnZXQuVmFsKHNpemVbaHRtbC5IRUlHSFRdfHxodG1sLkhFSUdIVCkraWNlLkZTK3RhcmdldC5WYWwoc2l6ZVtodG1sLldJRFRIXXx8aHRtbC5XSURUSCkrIikiCgl9LAoJX3Bvc2l0aW9uOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB7IHZhciBzaXplID0gZmlndXJlLmRhdGEuc2l6ZXx8e30KCQlyZXR1cm4gIkAoIit0YXJnZXQuVmFsKHNpemVbc3ZnLlhdfHxzdmcuWCkraWNlLkZTK3RhcmdldC5WYWwoc2l6ZVtzdmcuWV18fHN2Zy5ZKSsiKSIKCX0sCglfdGV4dDogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSwgZGF0YSkgeyB2YXIgc2l6ZSA9IGZpZ3VyZS5kYXRhLnNpemV8fHt9CgkJaWYgKGZpZ3VyZS50ZXh0KSB7IHJldHVybiBmaWd1cmUudGV4dChjYW4sIGRhdGEsIHRhcmdldCkgfQoJCXJldHVybiBkYXRhLnggPSB0YXJnZXQuVmFsKHNpemVbc3ZnLlhdfHxzdmcuWCksIGRhdGEueSA9IHRhcmdldC5WYWwoc2l6ZVtzdmcuWV18fHN2Zy5ZKSwgZGF0YQoJfSwKCV9wb2ludDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBwID0gY2FuLnN2Zy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQoJCXZhciBwb2ludCA9IHt4OiBldmVudC5jbGllbnRYLXAueCwgeTogZXZlbnQuY2xpZW50WS1wLnl9CgkJcG9pbnQueCA9IHBvaW50LnggLSBwb2ludC54ICUgcGFyc2VJbnQoY2FuLkFjdGlvbigiZ3JpZCIpKQoJCXBvaW50LnkgPSBwb2ludC55IC0gcG9pbnQueSAlIHBhcnNlSW50KGNhbi5BY3Rpb24oImdyaWQiKSkKCQlyZXR1cm4gY2FuLlN0YXR1cygicG9zIiwgcG9pbnQueCtpY2UuRlMrcG9pbnQueSksIHBvaW50Cgl9LAoKCWNvbnRlbnQ6IGZ1bmN0aW9uKGNhbiwgc3ZnKSB7CgkJcmV0dXJuIFsnPHN2ZyB2ZXJ0aW9uPSIxLjEiIHhtbG5zPSJodHRwczovL3d3dy53My5vcmcvMjAwMC9zdmciIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiJ10uY29uY2F0KAoJCQlzdmc/IGNhbi5jb3JlLkxpc3QoW2h0bWwuSEVJR0hULCBodG1sLldJRFRILCBtZGIuQ09VTlQsICJwaWQiLCAiZ3JpZCIsIGh0bWwuU1RST0tFX1dJRFRILCBodG1sLlNUUk9LRSwgaHRtbC5GSUxMLCBodG1sLkZPTlRfU0laRV0sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCXJldHVybiBzdmcuVmFsdWUoaXRlbSk/IGljZS5TUCArIGl0ZW0gKyAnPSInICsgc3ZnLlZhbHVlKGl0ZW0pICsgJyInOiAiIgoJCQl9KTogWyIgaGVpZ2h0PSIrKChjYW4uQ29uZihodG1sLkhFSUdIVCl8fDQ1MCktNTApKyIgd2lkdGg9IisoY2FuLkNvbmYoaHRtbC5XSURUSCl8fDYwMCldKS5jb25jYXQoWyc+Jywgc3ZnPyBzdmcuaW5uZXJIVE1MOiAiIiwgIjwvc3ZnPiJdKS5qb2luKCIiKQoJfSwKCWN1cnNvcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgaXRlbSwgc2hvdykgewoJCXZhciBwID0gaXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKQoJCXZhciBxID0ge3g6IGV2ZW50LmNsaWVudFgsIHk6IGV2ZW50LmNsaWVudFl9CgoJCXZhciBwb3MgPSA1LCBtYXJnaW4gPSAyMAoJCXZhciB5ID0gKHEueS1wLnkpL3AuaGVpZ2h0CgkJaWYgKHkgPCAwLjIgJiYgcS55LXAueSA8IG1hcmdpbikgewoJCQlwb3MgLT0gMwoJCX0gZWxzZSBpZiAoeSA+IDAuOCAmJiBxLnktcC55LXAuaGVpZ2h0ID4gLW1hcmdpbikgewoJCQlwb3MgKz0gMwoJCX0KCQl2YXIgeCA9IChxLngtcC54KS9wLndpZHRoCgkJaWYgKHggPCAwLjIgJiYgcS54LXAueCA8IG1hcmdpbikgewoJCQlwb3MgLT0gMQoJCX0gZWxzZSBpZiAoeCA+IDAuOCAmJiBxLngtcC54LSBwLndpZHRoID4gLW1hcmdpbikgewoJCQlwb3MgKz0gMQoJCX0KCgkJcmV0dXJuIChzaG93fHxjYW4uc3ZnKS5zdHlsZS5jdXJzb3IgPSBbCgkJCSJudy1yZXNpemUiLCAibi1yZXNpemUiLCAibmUtcmVzaXplIiwKCQkJInctcmVzaXplIiwgIm1vdmUiLCAiZS1yZXNpemUiLAoJCQkic3ctcmVzaXplIiwgInMtcmVzaXplIiwgInNlLXJlc2l6ZSIsCgkJXVtwb3MtMV0sIHBvcwoJfSwKCWFuY2hvcjogZnVuY3Rpb24odGFyZ2V0LCBwb3MsIHBvaW50KSB7CgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAxOgoJCQljYXNlIDI6CgkJCWNhc2UgMzoKCQkJCXBvaW50LnkgPSB0YXJnZXQuVmFsKHN2Zy5ZKQoJCQkJYnJlYWsKCQkJY2FzZSA0OgoJCQljYXNlIDU6CgkJCWNhc2UgNjoKCQkJCXBvaW50LnkgPSB0YXJnZXQuVmFsKHN2Zy5ZKSArIHRhcmdldC5WYWwoaHRtbC5IRUlHSFQpIC8gMgoJCQkJYnJlYWsKCQkJY2FzZSA3OgoJCQljYXNlIDg6CgkJCWNhc2UgOToKCQkJCXBvaW50LnkgPSB0YXJnZXQuVmFsKHN2Zy5ZKSArIHRhcmdldC5WYWwoaHRtbC5IRUlHSFQpCgkJCQlicmVhawoJCX0KCgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAxOgoJCQljYXNlIDQ6CgkJCWNhc2UgNzoKCQkJCXBvaW50LnggPSB0YXJnZXQuVmFsKHN2Zy5YKQoJCQkJYnJlYWsKCQkJY2FzZSAyOgoJCQljYXNlIDU6CgkJCWNhc2UgODoKCQkJCXBvaW50LnggPSB0YXJnZXQuVmFsKHN2Zy5YKSArIHRhcmdldC5WYWwoaHRtbC5XSURUSCkgLyAyCgkJCQlicmVhawoJCQljYXNlIDM6CgkJCWNhc2UgNjoKCQkJY2FzZSA5OgoJCQkJcG9pbnQueCA9IHRhcmdldC5WYWwoc3ZnLlgpICsgdGFyZ2V0LlZhbChodG1sLldJRFRIKQoJCQkJYnJlYWsKCQl9CgkJcmV0dXJuIHBvaW50Cgl9LAoJcmVzaXplOiBmdW5jdGlvbihldmVudCwgaXRlbSwgYmVnaW4sIHAwLCBwMSwgcG9zKSB7CgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSA1OgoJCQkJaXRlbS5WYWx1ZShzdmcuWCwgYmVnaW4ueCArIHAxLnggLSBwMC54KQoJCQkJaXRlbS5WYWx1ZShzdmcuWSwgYmVnaW4ueSArIHAxLnkgLSBwMC55KQoJCQkJcmV0dXJuCgkJfQoKCQlzd2l0Y2ggKHBvcykgewoJCQljYXNlIDE6CgkJCWNhc2UgMjoKCQkJY2FzZSAzOgoJCQkJaXRlbS5WYWx1ZShzdmcuWSwgYmVnaW4ueSArIHAxLnkgLSBwMC55KQoJCQkJaXRlbS5WYWx1ZShodG1sLkhFSUdIVCwgYmVnaW4uaGVpZ2h0IC0gcDEueSArIHAwLnkpCgkJCQlicmVhawoJCX0KCQlzd2l0Y2ggKHBvcykgewoJCQljYXNlIDE6CgkJCWNhc2UgNDoKCQkJY2FzZSA3OgoJCQkJaXRlbS5WYWx1ZShzdmUuWCwgYmVnaW4ueCArIHAxLnggLSBwMC54KQoJCQkJaXRlbS5WYWx1ZShodG1sLldJRFRILCBiZWdpbi53aWR0aCAtIHAxLnggKyBwMC54KQoJCQkJYnJlYWsKCQl9CgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAzOgoJCQljYXNlIDY6CgkJCWNhc2UgOToKCQkJCWl0ZW0uVmFsdWUoaHRtbC5XSURUSCwgYmVnaW4ud2lkdGggKyBwMS54IC0gcDAueCkKCQkJCWJyZWFrCgkJfQoJCXN3aXRjaCAocG9zKSB7CgkJCWNhc2UgNzoKCQkJY2FzZSA4OgoJCQljYXNlIDk6CgkJCQlpdGVtLlZhbHVlKGh0bWwuSEVJR0hULCBiZWdpbi5oZWlnaHQgKyBwMS55IC0gcDAueSkKCQkJCWJyZWFrCgkJfQoJfSwKfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC9jb2RlL2lubmVyL3Nlc3MuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgYXJncywgY2IpIHsgdmFyIFNFU1MgPSAid2ViLmNvZGUuc2VzcyIKCWNhbi5vbmltcG9ydC50b29sa2l0KGNhbiwge2luZGV4OiBTRVNTfSwgZnVuY3Rpb24oc3ViKSB7CgkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpCgkJCWlmIChjYW4ubWlzYy5ydW5BY3Rpb24oY2FuLCBtc2csIGNtZHMsIGNiLCBraXQuRGljdCgKCQkJCW5mcy5TQVZFLCBmdW5jdGlvbihjbWRzKSB7CgkJCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIFNFU1NdLmNvbmNhdChbY3R4LkFDVElPTiwgbWRiLkNSRUFURSwKCQkJCQkJInRvb2wiLCBKU09OLnN0cmluZ2lmeShjYW4ub25leHBvcnQudG9vbChjYW4pKSwKCQkJCQkJInRhYnMiLCBKU09OLnN0cmluZ2lmeShjYW4ub25leHBvcnQudGFicyhjYW4pKSwKCQkJCQldKSwgY2IsIHRydWUpCgkJCQl9LAoJCQkJbmZzLkxPQUQsIGZ1bmN0aW9uKGNtZHMpIHsKCQkJCQljYW4ub25pbXBvcnQuc2VzcyhjYW4sIHsKCQkJCQkJdG9vbDogSlNPTi5wYXJzZShtc2cuT3B0aW9uKCJ0b29sIikpLAoJCQkJCQl0YWJzOiBKU09OLnBhcnNlKG1zZy5PcHRpb24oInRhYnMiKSksCgkJCQkJfSkKCQkJCX0sCgkJCSkpKSB7IHJldHVybiB9CgkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBTRVNTXS5jb25jYXQoY21kcyksIGNiLCB0cnVlKQoJCX0sIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJfSkKfX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY29kZS9pbm5lci90ZW1wbGF0ZS5qcyIKVm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYikgewoJY2FuLm9uaW1wb3J0LnRvb2xraXQoY2FuLCB7aW5kZXg6ICJ3ZWIuY29kZS50ZW1wbGF0ZSJ9LCBmdW5jdGlvbihzdWIpIHsKCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCQlpZiAoY2FuLm1pc2MucnVuQWN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwga2l0LkRpY3QoCgkJCQluZnMuREVGUywgZnVuY3Rpb24oY21kcykgewoJCQkJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKCJhcmdzIil8fCJbXSIpLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCk7IGNhbi5jb3JlLkl0ZW0oZGF0YSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyBtc2cuT3B0aW9uKGtleSwgdmFsdWUpIH0pCgkJCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBpY2UuUlVOLCAid2ViLmNvZGUudGVtcGxhdGUiLCBuZnMuREVGU10uY29uY2F0KGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQkJCQkJY2FuLm9uaW1wb3J0LnByb2plY3QoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkKCQkJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIG1zZy5PcHRpb24oIm1haW4iKSwgIiIsIGZ1bmN0aW9uKCkgewoJCQkJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGNtZHNbMV0sIDEsIGZ1bmN0aW9uKCkge30pCgkJCQkJCQl9LCB0cnVlKQoJCQkJCQl9LCB0cnVlKQoJCQkJCX0pCgkJCQl9LAoJCQkpKSkgeyByZXR1cm4gfQoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgIndlYi5jb2RlLnRlbXBsYXRlIl0uY29uY2F0KGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQl9LCB0cnVlKQoJCX0sIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJfSkKfX0pCgoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2lucHV0L3Byb3ZpbmNlLmpzIgpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIuaOp+S7tuivpuaDhSIsIGxpc3Q6IFtdLCBwcm92aW5jZToge29uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgY2IoZnVuY3Rpb24oY2FuLCBjYnMpIHsKCWNhbi5yZXF1aXJlKFsiL3JlcXVpcmUvc2h5bGludXguY29tL3gvZWNoYXJ0cy9lY2hhcnRzLmpzIiwgIi9yZXF1aXJlL3NoeWxpbnV4LmNvbS94L2VjaGFydHMvY2hpbmEuanMiXSwgZnVuY3Rpb24oKSB7CgkJdmFyIGNoaW5hX2NoYXJ0ID0gZWNoYXJ0cy5pbml0KGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBbe3R5cGU6IGh0bWwuRElWLCBzdHlsZToge3dpZHRoOiA2MDAsIGhlaWdodDogNDAwfX1dKS5maXJzdCkKCQljaGluYV9jaGFydC5zZXRPcHRpb24oe2dlbzoge21hcDogJ2NoaW5hJ319KSwgY2hpbmFfY2hhcnQub24oaHRtbC5DTElDSywgZnVuY3Rpb24gKHBhcmFtcykgewoJCQl0YXJnZXQudmFsdWUgPSBwYXJhbXMubmFtZSwgY2FuLmNsb3NlKCkKCQl9KSwgY2FuLlN0YXR1cyhtZGIuVE9UQUwsIDM0KSwgY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuKSwgY2FuLmJhc2UuaXNGdW5jKGNicykgJiYgY2JzKGNhbikKCX0pCn0pIH19LCB9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL3N0b3J5L3ZpZGVvLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCQljYW4ub25pbXBvcnQuc2VsZWN0KGNhbiwgbXNnKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4pLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpLCBjYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJY2FuLmNvcmUuVGltZXIoMTIwMDAsIGZ1bmN0aW9uKCkgeyBjYW4ub25hY3Rpb24ucGxheShldmVudCwgY2FuKSB9KQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAidGQgYSIsIGZ1bmN0aW9uKGEpIHsKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgYSwge3RhcmdldDogIiJ9KQoJCX0pCgl9LAoJc2VsZWN0OiBmdW5jdGlvbihjYW4sIG1zZykgewoJCW1zZy5DbGVhcigpLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBkb2N1bWVudC5ib2R5LCBjYW4uT3B0aW9uKCJ0YWdzIiksIGZ1bmN0aW9uKGEsIGluZGV4KSB7CgkJCW1zZy5QdXNoKG1kYi5JTkRFWCwgaW5kZXgpCgkJCW1zZy5QdXNoKG1kYi5OQU1FLCBhLmlubmVyVGV4dCkKCQkJbXNnLlB1c2gobWRiLkxJTkssIGEuaHJlZikKCQkJYS5ocmVmID09IGxvY2F0aW9uLmhyZWYgJiYgY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0ciwgaSkgewoJCQkJCWktMSA9PSBpbmRleCAmJiBjYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdHIsICJzZWxlY3QiKQoJCQkJfSkKCQkJfSkKCQl9KQoJCW1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMsIEpTT04uc3RyaW5naWZ5KFsKCQkJe25hbWU6ICJ0aW1lIiwgdmFsdWU6IGNhbi5iYXNlLlRpbWUobnVsbCwgIiV5LSVtLSVkICVIOiVNOiVTIil9LAoJCQl7bmFtZTogImNvdW50IiwgdmFsdWU6IG1zZy5MZW5ndGgoKX0sCgkJXSkpCgl9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaOp+S7tuS6pOS6kiIsIGxpc3Q6IFtdLAoJbmV4dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbXNnID0gY2FuLl9tc2cKCQltc2cuVGFibGUoZnVuY3Rpb24obGluZSwgaW5kZXgpIHsKCQkJaWYgKGxpbmUubGluayA9PSBsb2NhdGlvbi5ocmVmKSB7CgkJCQlsb2NhdGlvbi5ocmVmID0gbXNnLmxpbmtbaW5kZXgrMV0KCQkJfQoJCX0pCgl9LAoJcGxheTogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5wYWdlLlNlbGVjdEFsbChjYW4sIGRvY3VtZW50LmJvZHksIGh0bWwuVklERU8sIGZ1bmN0aW9uKHZpZGVvKSB7CgkJCXZpZGVvLnBsYXliYWNrUmF0ZSA9IHBhcnNlRmxvYXQoY2FuLk9wdGlvbigicmF0ZSIpKQoJCQl2aWRlby5jdXJyZW50VGltZSA9IHBhcnNlSW50KGNhbi5PcHRpb24oInNraXAiKSkKCQkJdmlkZW8ub250aW1ldXBkYXRlID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWlmICh2aWRlby5jdXJyZW50VGltZSA+IHBhcnNlSW50KGNhbi5PcHRpb24oIm5leHQiKSkpIHsKCQkJCQljYW4ub25hY3Rpb24ubmV4dChldmVudCwgY2FuKQoJCQkJfQoJCQl9LCB2aWRlby5wbGF5KCksIHZpZGVvLnJlcXVlc3RGdWxsc2NyZWVuKCkKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXX0pCgoKX2Nhbl9uYW1lID0gIi9wbHVnaW4vbG9jYWwvY2hhdC9kaXYuanMiClZvbGNhbm9zKCJvbmltcG9ydCIsIHtoZWxwOiAi5a+85YWl5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJCXZhciBtZXRhID0ge307IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSkgeyBtZXRhW3ZhbHVlLmtleV0gPSB2YWx1ZS52YWx1ZSB9KQoJCWNhbi5fbWV0YSA9IGNhbi5iYXNlLk9iaihtZXRhLnRleHQsIHttZXRhOiB7bmFtZTogbWV0YS5uYW1lfHwiaGkifSwgbGlzdDogW119KQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoKCQljYW4udWkgPSBjYW4ucGFnZS5BcHBlbmRzKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjaGF0LkxBWU9VVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQl7dHlwZTogaHRtbC5URCwgbGlzdDogW3t2aWV3OiBjaGF0LlBST0pFQ1R9XX0sCgkJCXt0eXBlOiBodG1sLlRELCBsaXN0OiBbe3ZpZXc6IGNoYXQuRElTUExBWX1dfSwKCQkJe3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFt7dmlldzogY2hhdC5QUk9GSUxFfV19LAoJCV19XSB9XSksIGNhbi51aS5wcm9qZWN0Ll9maWVsZHNldCA9IGNhbi51aS5kaXNwbGF5CgoJCWNhbi5vbmltcG9ydC5faXRlbShjYW4sIGNhbi5fbWV0YSwgY2FuLnVpLnByb2plY3QsIGNhbi5vbmltcG9ydC5fc2l6ZShjYW4pKS5jbGljaygpCgl9LAoJX3NpemU6IGZ1bmN0aW9uKGNhbikgewoJCXZhciB3aWR0aCA9IGNhbi5Db25mKGh0bWwuV0lEVEgpLTI2MCwgaGVpZ2h0ID0gY2FuLkNvbmYoaHRtbC5IRUlHSFQpLTEwMAoJCWlmIChjYW4uQ29uZigiYXV0by5jbWQiKSkgewoJCQl3aWR0aCA9IGNhbi5Db25mKGh0bWwuV0lEVEgpLCBoZWlnaHQgPSBjYW4uQ29uZihodG1sLkhFSUdIVCkKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2ZpbGUpCgkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX29wdGlvbikKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fYWN0aW9uKQoJCX0KCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kIHx8IGNhbi51c2VyLm1vZC5pc0RpdikgewoJCQl3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoLCBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLl9vdXRwdXQsIHtzdHlsZToge3dpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHR9fSkKCQl9CgkJcmV0dXJuIHdpZHRoCgl9LAoJX2l0ZW06IGZ1bmN0aW9uKGNhbiwgbm9kZSwgdGFyZ2V0LCB3aWR0aCkgeyB3aWR0aCA9IHdpZHRofHxub2RlLm1ldGEud2lkdGgKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIG5vZGUubWV0YS5uYW1lfHwiaGkiXX0sIHt2aWV3OiBbaHRtbC5MSVNUXX1dKQoJCXVpLmxpc3QuX2ZpZWxkc2V0ID0gY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBub2RlLm1ldGEsIHRhcmdldC5fZmllbGRzZXQsIHdpZHRoKQoKCQl2YXIgbXNnID0gY2FuLnJlcXVlc3Qoe30pOyBtc2cuUHVzaChub2RlLm1ldGEsICIiLCB0cnVlKQoJCXVpLml0ZW0ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4udWkucHJvamVjdCwgImRpdi5pdGVtIiwgdWkuaXRlbSkKCQkJY2FuLmN1cnJlbnQgPSB1aS5pdGVtLCBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkucHJvZmlsZSkKCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgYXJyYXkpIHsKCQkJCXJldHVybiB7dGV4dDogW3ZhbHVlLCBodG1sLlREXSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQlrZXkgPT0gInZhbHVlIiAmJiBjYW4ub25tb3Rpb24ubW9kaWZ5cyhjYW4sIGV2ZW50LnRhcmdldCwgZnVuY3Rpb24oZXZlbnQsIHZhbHVlLCBvbGQpIHsKCQkJCQkJbm9kZS5tZXRhW2xpbmUua2V5XSA9IHZhbHVlCgkJCQkJfSkKCQkJCX19CgkJCX0sIGNhbi51aS5wcm9maWxlKQoJCX0KCgkJdWkuaXRlbS5fYWRkID0gZnVuY3Rpb24oZGF0YSkgewoJCQlpZiAobm9kZS5tZXRhLnN0eWxlID09IGh0bWwuU1BBTikgeyB3aWR0aCA9IHdpZHRoICogbm9kZS5saXN0Lmxlbmd0aCB9CgkJCW5vZGUubGlzdC5wdXNoKGRhdGEpCgkJCWlmIChub2RlLm1ldGEuc3R5bGUgPT0gaHRtbC5TUEFOKSB7IHdpZHRoID0gd2lkdGggLyBub2RlLmxpc3QubGVuZ3RoIH0KCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgdWkubGlzdCksIGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHVpLmxpc3QuX2ZpZWxkc2V0KQoJCQljYW4uY29yZS5MaXN0KG5vZGUubGlzdCwgZnVuY3Rpb24obm9kZSkgeyBjYW4ub25pbXBvcnQuX2l0ZW0oY2FuLCBub2RlLCB1aS5saXN0LCB3aWR0aCkgfSkKCQl9CgkJaWYgKG5vZGUubWV0YS5zdHlsZSA9PSBodG1sLlNQQU4pIHsgd2lkdGggPSB3aWR0aCAvIG5vZGUubGlzdC5sZW5ndGggfQoJCWNhbi5jb3JlLkxpc3Qobm9kZS5saXN0LCBmdW5jdGlvbihub2RlKSB7IGNhbi5vbmltcG9ydC5faXRlbShjYW4sIG5vZGUsIHVpLmxpc3QsIHdpZHRoKSB9KQoJCXJldHVybiB1aS5pdGVtCgl9LAoJX3BsdWdpbjogZnVuY3Rpb24oY2FuLCBtZXRhLCB0YXJnZXQsIHdpZHRoKSB7CgkJdmFyIHNpemUgPSB7d2lkdGg6IHdpZHRoLCBoZWlnaHQ6IG1ldGEuaGVpZ2h0fQoJCXZhciBmaWVsZCA9IGNhbi5vbmFwcGVuZC5maWVsZChjYW4sIGNoYXQuTEFZT1VULCB7fSwgdGFyZ2V0KS5maWVsZHNldAoJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBmaWVsZCwgbWV0YS5zdHlsZSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBmaWVsZCwge3N0eWxlOiBzaXplfSkKCgkJbWV0YS5pbmRleCAmJiBjYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY3R4LkNPTU1BTkQsIG1ldGEuaW5kZXhdLCBmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgY2FuLmJhc2UuQ29weSh7CgkJCQlmZWF0dXJlOiBjYW4uYmFzZS5PYmoobXNnLkFwcGVuZCgibWV0YSIpKSwgCgkJCQlpbnB1dHM6IGNhbi5iYXNlLk9iaihtc2cuQXBwZW5kKCJsaXN0IikpLAoJCQkJYXJnczogbWV0YS5hcmdzLAoJCQkJbmFtZTogbWV0YS5uYW1lLAoJCQl9LCBzaXplKSwgWyIvcGx1Z2luL3N0YXRlLmpzIl0sIGZ1bmN0aW9uKHN1YikgewoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl9vdXRwdXQsICB7c3R5bGU6IHNpemV9KQoJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgewoJCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBtZXRhLmluZGV4XSwgY21kcyksIGNiLCB0cnVlKQoJCQkJfQoJCQl9LCB0YXJnZXQsIGZpZWxkKQoJCX0sIHRydWUpCgkJcmV0dXJuIGZpZWxkCgl9LCAKfSwgWyIvcGx1Z2luL2xvY2FsL2NoYXQvZGl2LmNzcyJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaTjeS9nOaVsOaNriIsIGxpc3Q6IFtdLAoJIua3u+WKoCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbWRiLk5BTUUsIGN0eC5JTkRFWCwgY3R4LkFSR1MsIGN0eC5TVFlMRSwgaHRtbC5IRUlHSFQsIGh0bWwuV0lEVEhdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5jdXJyZW50Ll9hZGQoe21ldGE6IGRhdGEsIGxpc3Q6IFtdfSkKCQl9KQoJfSwKCSLkv53lrZgiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCWNhbi5ydW4oZXZlbnQsIFttZGIuTU9ESUZZLCBtZGIuVEVYVCwgSlNPTi5zdHJpbmdpZnkoY2FuLl9tZXRhKV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKQoJCX0sIHRydWUpCgl9LAoJIumihOiniCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25tb3Rpb24uc2hhcmUoZXZlbnQsIGNhbiwgW10sIFttZGIuTElOSywgY2FuLm1pc2MuTWVyZ2VVUkwoY2FuLCB7X3BhdGg6ICIvY2hhdC9kaXYvIitjYW4uT3B0aW9uKCJoYXNoIil9KV0pCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCgpfY2FuX25hbWUgPSAiL3BsdWdpbi9sb2NhbC93aWtpL2RyYXcvcGF0aC5qcyIKVm9sY2Fub3MoIm9uZmlndXJlIiwge2hlbHA6ICLlm77lvaLnu5jliLYiLCBsaXN0OiBbXSwKICAgIHBhdGgydjogeyAvLyA8cGF0aCBkPSJNIHgwLHkwIFEgeDIseTIgeDMseTMgVCB4MSx5MSIvPgogICAgICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LCBjb3B5OiBbXX0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gbGluZShwMCwgcDEpIHsgcmV0dXJuIGNhbi5iYXNlLmpvaW5zKFsKICAgICAgICAgICAgICAgIHN2Zy5NLCBbcDAueCwgcDAueV0sIHN2Zy5RLCBbcDAueCwgcDAueSsocDEueS1wMC55KS8zXSwgWyhwMC54K3AxLngpLzIsIChwMC55K3AxLnkpLzJdLCBzdmcuVCwgW3AxLngsIHAxLnldCiAgICAgICAgICAgIF0pIH0KICAgICAgICAgICAgcmV0dXJuIHtmaWxsOiBodG1sLk5PTkUsIGQ6IGxpbmUocG9pbnRbMF0sIHBvaW50WzFdKX0KICAgICAgICB9LAogICAgfSwKICAgIHBhdGgyaDogeyAvLyA8cGF0aCBkPSJNIHgwLHkwIFEgeDIseTIgeDMseTMgVCB4MSx5MSIvPgogICAgICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LCBjb3B5OiBbXX0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gbGluZShwMCwgcDEpIHsgcmV0dXJuIGNhbi5iYXNlLmpvaW5zKFsKICAgICAgICAgICAgICAgIHN2Zy5NLCBbcDAueCwgcDAueV0sIHN2Zy5RLCBbcDAueCsocDEueC1wMC54KS8zLCBwMC55XSwgWyhwMC54K3AxLngpLzIsIChwMC55K3AxLnkpLzJdLCBzdmcuVCwgW3AxLngsIHAxLnldCiAgICAgICAgICAgIF0pIH0KICAgICAgICAgICAgcmV0dXJuIHtmaWxsOiBodG1sLk5PTkUsIGQ6IGxpbmUocG9pbnRbMF0sIHBvaW50WzFdKX0KICAgICAgICB9LAogICAgfSwKICAgIHBhdGg6IHsgLy8gPHBhdGggZD0iTTEwIDEwIEggOTAgViA5MCBIIDEwIFoiLz4KICAgICAgICBkYXRhOiB7c2l6ZToge30sIGNvcHk6IFsiZCIsICJ0dCIsICJ4eCIsICJ5eSJdLAogICAgICAgICAgICB4OiBmdW5jdGlvbihjYW4sIHZhbHVlLCBjbWQsIHRhcmdldCkgewogICAgICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0dC50eCA9IHZhbHVlLXRhcmdldC5WYWwoInh4IikKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieHgiKSt0dC50eAogICAgICAgICAgICB9LAogICAgICAgICAgICB5OiBmdW5jdGlvbihjYW4sIHZhbHVlLCBjbWQsIHRhcmdldCkgewogICAgICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0dC50eSA9IHZhbHVlLXRhcmdldC5WYWwoInl5IikKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieXkiKSt0dC50eQogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQsIHN0eWxlKSB7CiAgICAgICAgICAgIGlmIChzdHlsZSAmJiBzdHlsZS5kKSB7IHJldHVybiBzdHlsZSB9CiAgICAgICAgICAgIGlmIChwb2ludC5sZW5ndGggPT0gMSkgeyBjYW4uX3RlbXAgPSB7fSB9CiAgICAgICAgICAgIGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgogICAgICAgICAgICBpZiAoY2FuLmtleXMgJiYgY2FuLmtleXMubGVuZ3RoID4gMCkgeyB2YXIgazsKICAgICAgICAgICAgICAgIGsgPSBjYW4uX3RlbXBbcG9pbnQubGVuZ3RoLTFdID0gY2FuLmtleXNbMF0KICAgICAgICAgICAgICAgIHN3aXRjaCAoay50b1VwcGVyQ2FzZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiQyI6IGNhbi5fdGVtcFtwb2ludC5sZW5ndGgrMV0gPSAiLCIKICAgICAgICAgICAgICAgICAgICBjYXNlICJRIjogY2FuLl90ZW1wW3BvaW50Lmxlbmd0aF0gPSAiLCI7IGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhbi5rZXlzID0gY2FuLmtleXMuc2xpY2UoMSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHNraXAgPSAwCiAgICAgICAgICAgIHZhciBlbmQgPSBmYWxzZQogICAgICAgICAgICB2YXIgZGF0YSA9IHsKICAgICAgICAgICAgICAgIGQ6IGNhbi5jb3JlLkxpc3QocG9pbnQsIGZ1bmN0aW9uKHAsIGkpIHsgdmFyIGsgPSBwLmsKICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHNraXApIHtyZXR1cm59CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDogayA9ICJNIjsgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogayA9IGNhbi5fdGVtcFtpXSB8fCBwLmsgfHwgIkwiOyBicmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kKSB7cmV0dXJufQoKICAgICAgICAgICAgICAgICAgICBrID0gay50b1VwcGVyQ2FzZSgpCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIloiOiByZXR1cm4gY2FuLnBvaW50ID0gW10sIGNhbi5fdGVtcCA9IHt9LCBrCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIkwiOiByZXR1cm4gaysiICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiTSI6IHJldHVybiBrKyIgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJIIjogcmV0dXJuIGsrIiAiICsgcC54CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIlYiOiByZXR1cm4gaysiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiQSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBvaW50Lmxlbmd0aCAtIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IGVuZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIgMCAwIDAgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGguc3FydChNYXRoLnBvdyhwb2ludFtpKzFdLnggLSBwLngsIDIpICsgTWF0aC5wb3cocG9pbnRbaSsxXS55IC0gcC55LCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgciArICIgIiArIHIgKyAiIDAgMCAwICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGguc3FydChNYXRoLnBvdyhwb2ludFtpKzFdLnggLSBwLngsIDIpICsgTWF0aC5wb3cocG9pbnRbaSsxXS55IC0gcC55LCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcG9pbnRbaV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBwb2ludFtpXSA9IHBvaW50W2krMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50W2krMV0gPSB0ZW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGNhbi5wb2ludFtpXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGNhbi5wb2ludFtpXSA9IGNhbi5wb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW4ucG9pbnRbaSsxXSA9IHRlbXAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAueCA9IHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAueSA9IHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuZG9uZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXJnID0gIiAwIDAgMCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwID0gaSArIDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgcC54ICsgIiAiICsgcC55ICsgIiAwIDAgMCAiICsgcG9pbnRbaSsxXS54ICsgIiAiICsgcG9pbnRbaSsxXS55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJDIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocG9pbnQubGVuZ3RoIC0gaSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyAocG9pbnRbaS0xXS54K3AueCkvMiArICIgIiArIChwb2ludFtpLTFdLnkrcC55KS8yICsgIiwiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIsIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyAocG9pbnRbaS0xXS54K3AueCkvMiArICIgIiArIChwb2ludFtpLTFdLnkrcC55KS8yICsgIiwiICsgcC54ICsgIiAiICsgcC55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyBwb2ludFtpKzJdLnggKyAiICIgKyBwb2ludFtpKzJdLnkgKyAiLCIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50W2ldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcG9pbnRbaV0gPSBwb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludFtpKzFdID0gdGVtcAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcG9pbnRbaSsxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRbaSsxXSA9IHBvaW50W2krMl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50W2krMl0gPSB0ZW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmRvbmUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiUSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBvaW50Lmxlbmd0aCAtIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IGVuZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIsIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50W2ldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcG9pbnRbaV0gPSBwb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludFtpKzFdID0gdGVtcAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5kb25lID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgcC54ICsgIiAiICsgcC55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBrKyIgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLmpvaW4oIiAiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBkYXRhCiAgICAgICAgfSwKICAgICAgICB0ZXh0OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZGF0YSkgewogICAgICAgICAgICBkYXRhLnggPSAodGFyZ2V0LngxLmJhc2VWYWwudmFsdWUgKyB0YXJnZXQueDIuYmFzZVZhbC52YWx1ZSkgLyAyCiAgICAgICAgICAgIGRhdGEueSA9ICh0YXJnZXQueTEuYmFzZVZhbC52YWx1ZSArIHRhcmdldC55Mi5iYXNlVmFsLnZhbHVlKSAvIDIKICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICB9LAogICAgICAgIHNob3c6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHJldHVybiB0YXJnZXQudGFnTmFtZSArICIgIiArIHRhcmdldC5WYWx1ZSgiZCIpIH0sCiAgICB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy93YWxrX3RyYXNoLmpzIgpWb2xjYW5vcygib25pbXBvcnQiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIGxpc3Q6IFtdLAogICAgaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCBvdXRwdXQsIGFjdGlvbiwgb3B0aW9uKSB7b3V0cHV0LmlubmVySFRNTCA9ICIiOwogICAgICAgIGlmICghbXNnLnJlc3VsdCB8fCBtc2cucmVzdWx0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIHZhciB0YWJsZSA9IGNhbi5wYWdlLkFwcGVuZFRhYmxlKGNhbiwgbXNnLCBvdXRwdXQsIG1zZy5hcHBlbmQpOwogICAgICAgICAgICB0YWJsZS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHtzd2l0Y2ggKGV2ZW50LnRhcmdldC50YWdOYW1lKSB7CiAgICAgICAgICAgICAgICBjYXNlICJURCI6CiAgICAgICAgICAgICAgICAgICAgY2FuLm9uaW1wb3J0LndoaWNoKGV2ZW50LCB0YWJsZSwgbXNnLmFwcGVuZCwgZnVuY3Rpb24oaW5kZXgsIGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYW4uT3B0aW9uKCJmaWxlIiwgZXZlbnQudGFyZ2V0LmlubmVySFRNTC50cmltKCkpCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbi5ydW4oZXZlbnQsIFtldmVudC50YXJnZXQuaW5uZXJIVE1MLnRyaW0oKV0sIGZ1bmN0aW9uKG1zZykge30pCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgY2FzZSAiVEgiOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBjYXNlICJUUiI6CiAgICAgICAgICAgICAgICBjYXNlICJUQUJMRSI6CiAgICAgICAgICAgIH19CiAgICAgICAgICAgIHJldHVybiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZyksIHRhYmxlOwogICAgICAgIH0KCiAgICAgICAgLy8gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgYWN0aW9uLCBbe3R5cGU6ICJzY3JpcHQiLCBzcmM6ICJodHRwczovL2Nkbi5ib290Y3NzLmNvbS9lY2hhcnRzLzQuMi4wLXJjLjIvZWNoYXJ0cy5qcyJ9XSk7CiAgICAgICAgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgb3V0cHV0LCBbe2luY2x1ZGU6IFsicmVxdWlyZS9zaHlsaW51eC5jb20veC9lY2hhcnRzL2VjaGFydHMuanMiLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICBjYW4ucGFnZS5BcHBlbmQoY2FuLCBvdXRwdXQsIFt7aW5jbHVkZTogWyJyZXF1aXJlL3NoeWxpbnV4LmNvbS94L2VjaGFydHMvY2hpbmEuanMiLCBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICAgICAgdmFyIGNoaW5hX2NoYXJ0ID0gZWNoYXJ0cy5pbml0KGNhbi5wYWdlLkFwcGVuZChjYW4sIG91dHB1dCwgW3t0eXBlOiAiZGl2Iiwgc3R5bGU6IHt3aWR0aDogIjYwMHB4IiwgaGVpZ2h0OiAiNDAwcHgifX1dKS5sYXN0KTsKICAgICAgICAgICAgICAgIHZhciBkYXRhID0gbXNnLlRhYmxlKCkKCiAgICAgICAgICAgICAgICB2YXIgeURhdGEgPSBbXTsKICAgICAgICAgICAgICAgIHZhciBiYXJEYXRhID0gW107CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IChkYXRhLmxlbmd0aD4xMD8gMTA6IGRhdGEubGVuZ3RoKTsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgeURhdGEucHVzaChpICsgZGF0YVtpXS5uYW1lKTsKICAgICAgICAgICAgICAgICAgICBiYXJEYXRhLnB1c2goZGF0YVtpXSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogW3sKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbXNnLk9wdGlvbigidGl0bGUiKSwKICAgICAgICAgICAgICAgICAgICAgICAgc2hvdzogdHJ1ZSwgcmlnaHQ6IDI1MCwgdG9wOiAxMCwKICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFN0eWxlOiB7Y29sb3I6ICcjMkQzRTUzJywgZm9udFNpemU6IDE4fSwKICAgICAgICAgICAgICAgICAgICB9XSwKICAgICAgICAgICAgICAgICAgICB0b29sdGlwOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHRydWUsIGZvcm1hdHRlcjogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyYW1zLm5hbWUgKyI6ICIrcGFyYW1zLnZhbHVlCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICB2aXN1YWxNYXA6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NvbnRpbnVvdXMnLAogICAgICAgICAgICAgICAgICAgICAgICBvcmllbnQ6ICdob3Jpem9udGFsJywKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVdpZHRoOiAxMCwKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbUhlaWdodDogODAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IFsn6auYJywgJ+S9jiddLAogICAgICAgICAgICAgICAgICAgICAgICBzaG93TGFiZWw6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIHNlcmllc0luZGV4OiBbMF0sCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgbWF4OiBkYXRhWzFdLnZhbHVlLAogICAgICAgICAgICAgICAgICAgICAgICBpblJhbmdlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogWycjNkZDRjZBJywgJyNGRkZENjQnLCAnI0ZGNTAwMCddCiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTdHlsZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICcjN0I5M0E3JwogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBib3R0b206IDMwLAogICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiAnbGVmdCcsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBncmlkOiB7cmlnaHQ6IDEwLCB0b3A6IDEzNSwgYm90dG9tOiAxMDAsIHdpZHRoOiAnMjAlJ30sCiAgICAgICAgICAgICAgICAgICAgeEF4aXM6IHtzaG93OiBmYWxzZX0sCiAgICAgICAgICAgICAgICAgICAgeUF4aXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NhdGVnb3J5JywKICAgICAgICAgICAgICAgICAgICAgICAgaW52ZXJzZTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZUdhcDogMTYsCiAgICAgICAgICAgICAgICAgICAgICAgIGF4aXNMaW5lOiB7c2hvdzogZmFsc2UsIGxpbmVTdHlsZToge2NvbG9yOiAnI2RkZCd9fSwKICAgICAgICAgICAgICAgICAgICAgICAgYXhpc1RpY2s6IHtzaG93OiBmYWxzZSwgbGluZVN0eWxlOiB7Y29sb3I6ICcjZGRkJ319LAogICAgICAgICAgICAgICAgICAgICAgICBheGlzTGFiZWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbjogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludGVydmFsOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFN0eWxlOiB7Y29sb3I6ICcjNDU1QTc0JywgYWxpZ246ICdsZWZ0JywgZm9udFNpemU6IDE0fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpY2g6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyNGQUFBMzknLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnI2ZmZicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogJyM0MTk3RkQnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMjAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyUmFkaXVzOiAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlcjogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlSW50KHBhcmFtcy5zbGljZSgwLCAxKSkgPCAzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAne2F8JyArIChwYXJzZUludChwYXJhbXMuc2xpY2UoMCwgMSkpICsgMSkgKyAnfScgKyAnICAnICsgcGFyYW1zLnNsaWNlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbignXG4nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAne2J8JyArIChwYXJzZUludChwYXJhbXMuc2xpY2UoMCwgMSkpICsgMSkgKyAnfScgKyAnICAnICsgcGFyYW1zLnNsaWNlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0uam9pbignXG4nKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeURhdGEKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGdlbzogewogICAgICAgICAgICAgICAgICAgICAgICBtYXA6ICdjaGluYScsIGxlZnQ6ICdsZWZ0JywgcmlnaHQ6ICcxMDAnLAogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDoge2VtcGhhc2lzOiB7c2hvdzogZmFsc2V9fSwKICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVN0eWxlOiB7ZW1waGFzaXM6IHthcmVhQ29sb3I6ICcjZmZmNDY0J319LAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgc2VyaWVzOiBbewogICAgICAgICAgICAgICAgICAgICAgICByb2FtOiBmYWxzZSwgdHlwZTogJ21hcCcsIG5hbWU6ICdtYXBTZXInLAogICAgICAgICAgICAgICAgICAgICAgICBnZW9JbmRleDogMCwgbGFiZWw6IHtzaG93OiBmYWxzZX0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJvYW06IGZhbHNlLCB0eXBlOiAnYmFyJywgbmFtZTogJ2JhclNlcicsCiAgICAgICAgICAgICAgICAgICAgICAgIHZpc3VhbE1hcDogZmFsc2UsIGJhckdhcDogMCwgYmFyTWF4V2lkdGg6IDgsCiAgICAgICAgICAgICAgICAgICAgICAgIHpsZXZlbDogMTAwLCBpdGVtU3R5bGU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vcm1hbDogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBmdW5jdGlvbihwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnVpbGQgYSBjb2xvciBtYXAgYXMgeW91ciBuZWVkLgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29sb3JMaXN0ID0gW3tjb2xvclN0b3BzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAwLCBjb2xvcjogJyNGRkQxMTknfSwgLy8gMCUg5aSE55qE6aKc6ImyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAxLCBjb2xvcjogJyNGRkFDNEMnfSwgLy8gMTAwJSDlpITnmoTpopzoibIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX0sIHtjb2xvclN0b3BzOiBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAwLCBjb2xvcjogJyMwMEMwRkEnfSwgLy8gMCUg5aSE55qE6aKc6ImyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7b2Zmc2V0OiAxLCBjb2xvcjogJyMyRjk1RkEnfSwgLy8gMTAwJSDlpITnmoTpopzoibIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXX1dOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyYW1zLmRhdGFJbmRleCA8IDM/IGNvbG9yTGlzdFswXTogY29sb3JMaXN0WzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXJCb3JkZXJSYWRpdXM6IDE1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGJhckRhdGEKICAgICAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGNoaW5hX2NoYXJ0LnNldE9wdGlvbihvcHRpb24pOwogICAgICAgICAgICB9XX1dKTsKICAgICAgICB9XX1dKTsKICAgIH0sCiAgICB3aGljaDogZnVuY3Rpb24oZXZlbnQsIHRhYmxlLCBsaXN0LCBjYikge2lmIChldmVudC50YXJnZXQgPT0gdGFibGUpIHtyZXR1cm4gY2IoLTEsICIiKX0KICAgICAgICBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YWJsZSwgInRyIiwgZnVuY3Rpb24odHIsIGluZGV4KSB7aWYgKGV2ZW50LnRhcmdldCA9PSB0cikge3JldHVybiBjYihpbmRleC0xLCAiIil9CiAgICAgICAgICAgIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCAidGgsdGQiLCBmdW5jdGlvbih0ZCwgb3JkZXIpIHsKICAgICAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQgPT0gdGQpIHtyZXR1cm4gY2IoaW5kZXgtMSwgbGlzdFtvcmRlcl0pfQogICAgICAgICAgICB9KQogICAgICAgIH0pCiAgICB9LAp9KQoKCl9jYW5fbmFtZSA9ICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9oZWFydC5qcyIKVm9sY2Fub3MoImhlYXJ0Iiwge2hlbHA6ICLlv4PlvaIiLCBsaXN0OiBbXSwKICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LAogICAgICAgIGNvcHk6IFsiZCIsICJuYW1lIiwgIm1ldGEiLCAidHQiLCAieHgiLCAieXkiXSwKICAgICAgICB4OiBmdW5jdGlvbihldmVudCwgY2FuLCB2YWx1ZSwgY21kLCB0YXJnZXQpIHsKICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgaWYgKHZhbHVlICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgdHQudHggPSB2YWx1ZS10YXJnZXQuVmFsKCJ4eCIpCiAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgdGFyZ2V0LlZhbHVlKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKCIrdHQudHgrIiwiK3R0LnR5KyIpIikKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieHgiKSt0dC50eAogICAgICAgIH0sCiAgICAgICAgeTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdmFsdWUsIGNtZCwgdGFyZ2V0KSB7CiAgICAgICAgICAgIHZhciB0dCA9IEpTT04ucGFyc2UodGFyZ2V0LlZhbHVlKCJ0dCIpfHwneyJ0eCI6MCwgInR5IjowfScpCiAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHR0LnR5ID0gdmFsdWUtdGFyZ2V0LlZhbCgieXkiKQogICAgICAgICAgICAgICAgdGFyZ2V0LlZhbHVlKCJ0dCIsIEpTT04uc3RyaW5naWZ5KHR0KSkKICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5WYWwoInl5IikrdHQudHkKICAgICAgICB9LAogICAgfSwgLy8gPGhlYXJ0IGN4PSIyNSIgY3k9Ijc1IiByPSIyMCIvPgogICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsgaWYgKHBvaW50Lmxlbmd0aCA8IDIpIHtyZXR1cm59CgogICAgICAgIHZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdLCBwMiA9IHBvaW50WzJdOwogICAgICAgIHBsID0ge3g6IDIqcDAueCAtIHAxLngsIHk6MipwMC55LXAxLnl9CiAgICAgICAgdmFyIHIwID0gTWF0aC5zcXJ0KE1hdGgucG93KHAwLnggLSBwMS54LCAyKSwgTWF0aC5wb3cocDAueSAtIHAxLnksIDIpKSAvIDIKICAgICAgICB2YXIgZCA9IFsKICAgICAgICAgICAgICAgICJNIiwgcGwueCwgcGwueSwKICAgICAgICAgICAgICAgICJBIiwgcjAsIHIwLCAwLCAwLCAwLCBwMC54LCBwMC55LAogICAgICAgICAgICAgICAgIkEiLCByMCwgcjAsIDAsIDAsIDAsIHAxLngsIHAxLnksCiAgICAgICAgICAgIF0KCiAgICAgICAgaWYgKHBvaW50Lmxlbmd0aCA9PSAzKSB7CiAgICAgICAgICAgIHZhciByMSA9IE1hdGguc3FydChNYXRoLnBvdyhwMi54IC0gcDEueCwgMiksIE1hdGgucG93KHAyLnkgLSBwMS55LCAyKSkKICAgICAgICAgICAgZCA9IGQuY29uY2F0KFsKICAgICAgICAgICAgICAgICJBIiwgcjEsIHIxLCAxODAsIDAsIDAsIHAyLngsIHAyLnksCiAgICAgICAgICAgICAgICAiQSIsIHIxLCByMSwgMTgwLCAwLCAwLCBwbC54LCBwbC55LAogICAgICAgICAgICBdKQogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgICAgIG5hbWU6ICJoZWFydCIsIGQ6IGQuam9pbigiICIpLAogICAgICAgICAgICBtZXRhOiBKU09OLnN0cmluZ2lmeShwb2ludCksCiAgICAgICAgICAgIHR0OiBKU09OLnN0cmluZ2lmeSh7dHg6IDAsIHR5OiAwfSksCiAgICAgICAgICAgIHh4OiBwMC54LCB5eTpwMS55LAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGV2ZW50LnR5cGUgPT0gImNsaWNrIiAmJiBwb2ludC5sZW5ndGggPT0gMyAmJiAoY2FuLnBvaW50ID0gW10pLCBkYXRhCiAgICB9LAogICAgdGV4dDogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKICAgICAgICBkYXRhLnggPSB0YXJnZXQuVmFsKCJjeCIpCiAgICAgICAgZGF0YS55ID0gdGFyZ2V0LlZhbCgiY3kiKQogICAgICAgIHJldHVybiBkYXRhCiAgICB9LAogICAgc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKICAgICAgICByZXR1cm4gImhlYXJ0ICIgKyB0YXJnZXQuVmFsdWUoInR0IikKICAgIH0sCn0pCgoKX2Nhbl9uYW1lID0gIi9wdWJsaXNoL29yZGVyLmpzIgpWb2xjYW5vcygib25lbmdpbmUiLCB7fSkKCgpfY2FuX25hbWUgPSAiL2ZyYW1lLmpzIgpWb2xjYW5vcygib25lbmdpbmUiLCB7aGVscDogIuaQnOe0ouW8leaTjiIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtZXRhLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBjbWRzID0gY21kc3x8W10KCQkJcmV0dXJuIChjYW4ub25lbmdpbmVbY21kc1swXV18fGNhbi5vbmVuZ2luZS5fcmVtb3RlKShldmVudCwgY2FuLCBtc2csIGNhbiwgY21kcywgY2IpCgkJfQoKCQlpZiAoY2FuLm1pc2MuU2VhcmNoKGNhbiwgaWNlLk1TR19TRVNTSUQpKSB7CgkJCWNhbi5taXNjLkNvb2tpZVNlc3NpZChjYW4sIGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5NU0dfU0VTU0lEKSkKCQkJcmV0dXJuIGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5NU0dfU0VTU0lELCAiIikgCgkJfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuSUZSQU1FLCBmdW5jdGlvbihpdGVtKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIGl0ZW0pIH0pCgkJaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uKSB7IFZvbGNhbm9zLm1ldGEuYXJncyA9IGNhbi5iYXNlLk9iaihsb2NhbFN0b3JhZ2UuZ2V0SXRlbShjdHguQVJHUyksIHt9KSB9CgoJCWNhbi5vbmVuZ2luZS5saXN0ZW4oY2FuLCBjaGF0Lk9OU0VBUkNILCBmdW5jdGlvbihtc2csIHdvcmQpIHsgaWYgKHdvcmRbMF0gPT0gY3R4LkNPTU1BTkQgfHwgd29yZFsxXSAhPSAiIikgeyB2YXIgbWV0YSA9IGNhbi5vbmVuZ2luZS5wbHVnaW4ubWV0YQoJCQl2YXIgbGlzdCA9IHdvcmRbMV0gPT0gIiI/IG1ldGE6IG1ldGFbd29yZFsxXV0/IGtpdC5EaWN0KHdvcmRbMV0sIG1ldGFbd29yZFsxXV0pOiB7fQoJCQljYW4uY29yZS5JdGVtKGxpc3QsIGZ1bmN0aW9uKG5hbWUsIGNvbW1hbmQpIHsgbmFtZSA9IGNhbi5iYXNlLnRyaW1QcmVmaXgobmFtZSwgImNhbi4iKQoJCQkJY2FuLmNvcmUuTGlzdChtc2cuT3B0aW9uKGljZS5NU0dfRklFTERTKS5zcGxpdChpY2UuRlMpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJbXNnLlB1c2goaXRlbSwga2l0LkRpY3QoaWNlLkNUWCwgIm9uZW5naW5lIiwgaWNlLkNNRCwgImNvbW1hbmQiLAoJCQkJCQltZGIuVFlQRSwgImNhbiIsIG1kYi5OQU1FLCBuYW1lLCBtZGIuVEVYVCwgY29tbWFuZC5oZWxwLAoJCQkJCQljdHguQ09OVEVYVCwgImNhbiIsIGN0eC5DT01NQU5ELCBuYW1lCgkJCQkJKVtpdGVtXXx8IiIpCgkJCQl9KQoJCQl9KQoJCX0gfSkKCgkJY2FuLmNvcmUuTmV4dChsaXN0LCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGl0ZW0udHlwZSA9IGNoYXQuUEFORUwKCQkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgY2FuLmJhc2UuQ29weShpdGVtLCBjYW4uY29yZS5WYWx1ZShjYW4uX3Jvb3QsIFtjaGF0LlJJVkVSLCBpdGVtLm5hbWVdKSksIGl0ZW0ubGlzdCwgZnVuY3Rpb24ocGFuZWwpIHsKCQkJCXBhbmVsLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gcGFuZWwucmVxdWVzdChldmVudCk7IGNtZHMgPSBjbWRzfHxbXQoJCQkJCXJldHVybiAoY2FuLm9uZW5naW5lW2NtZHNbMF1dfHxjYW4ub25lbmdpbmUuX3JlbW90ZSkoZXZlbnQsIGNhbiwgbXNnLCBwYW5lbCwgY21kcywgY2IpCgkJCQl9LCBjYW5baXRlbS5uYW1lXSA9IHBhbmVsLCBwYW5lbC5fcm9vdCA9IGNhbiwgcGFuZWwuX3RyYW5zID0gcGFuZWwub25hY3Rpb24gJiYgcGFuZWwub25hY3Rpb24uX3RyYW5zfHx7fQoKCQkJCWNhbi5jb3JlLkl0ZW1DQihwYW5lbC5vbmFjdGlvbiwgZnVuY3Rpb24oa2V5LCBjYikgewoJCQkJCWNhbi5vbmVuZ2luZS5saXN0ZW4oY2FuLCBrZXksIGZ1bmN0aW9uKG1zZykgeyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2NhbjogcGFuZWwsIG1zZzogbXNnfSkgfSkKCQkJCX0pLCBjYW4uY29yZS5DYWxsRnVuYyhbcGFuZWwub25hY3Rpb24sICJfaW5pdCJdLCB7Y2FuOiBwYW5lbCwgY2I6IG5leHQsIHRhcmdldDogcGFuZWwuX3RhcmdldH0pCgkJCX0sIHRhcmdldCkKCQl9LCBmdW5jdGlvbigpIHsgY2FuLm1pc2MuTG9nKGNhbi51c2VyLnRpdGxlKCksIGljZS5SVU4sIGNhbikKCQkJY2FuLnJlcXVpcmUoW2Nhbi52b2xjYW5vXSwgbnVsbCwgZnVuY3Rpb24oY2FuLCBuYW1lLCBzdWIpIHsgY2FuW25hbWVdID0gc3ViIH0pCgkJCWNhbi5vbmxheW91dC50b3BpYyhjYW4pLCBjYW4ub25tb3Rpb24uX2luaXQoY2FuLCB0YXJnZXQpLCBjYW4ub25rZXltYXAuX2luaXQoY2FuKQoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTk1BSU4sIGNhbi5yZXF1ZXN0KCkpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQl9KQoJfSwKCV9zZWFyY2g6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1zZywgcGFuZWwsIGNtZHMsIGNiKSB7CgkJdmFyIHN1YiwgbW9kID0gY2FuLCBmdW4gPSBjYW4sIGtleSA9ICIiOyBjYW4uY29yZS5MaXN0KGNtZHNbMV0uc3BsaXQoaWNlLlBUKSwgZnVuY3Rpb24odmFsdWUpIHsKCQkJZnVuICYmIChzdWIgPSBtb2QsIG1vZCA9IGZ1biwgZnVuID0gbW9kW3ZhbHVlXSwga2V5ID0gdmFsdWUpCgkJfSk7IGlmICghc3ViIHx8ICFtb2QgfHwgIWZ1bikgeyBjYW4ubWlzYy5XYXJuKGljZS5FcnJOb3RGb3VuZCwgY21kcykKCQkJcmV0dXJuIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnLkVjaG8oaWNlLkVycldhcm4sIGljZS5FcnJOb3RGb3VuZCwgY21kcykpCgkJfQoKCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoZnVuLCB7CgkJCWV2ZW50OiBldmVudCwgY2FuOiBzdWIsIG1zZzogbXNnLCBjbWRzOiBjbWRzLnNsaWNlKDIpLCBjYjogY2IsIHRhcmdldDogc3ViLl90YXJnZXQsCgkJCWJ1dHRvbjoga2V5LCBjbWQ6IGtleSwgYXJnOiBjbWRzLnNsaWNlKDIpLCBsaXN0OiBjbWRzLnNsaWNlKDIpLAoJCX0sIG1vZCkKCX0sCglfZW5naW5lOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikgeyByZXR1cm4gZmFsc2UgfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1zZywgcGFuZWwsIGNtZHMsIGNiKSB7CgkJaWYgKGNtZHNbMF0gPT0gY3R4LkFDVElPTiAmJiBjbWRzWzFdID09IGljZS5SVU4gJiYgY2FuLm9uZW5naW5lLnBsdWdpbi5tZXRhW2NtZHNbMl1dKSB7CgkJCXJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhjYW4ub25lbmdpbmUucGx1Z2luLm1ldGFbY21kc1syXV0sIHttc2c6IG1zZywgY21kczogY21kcy5zbGljZSgzKSwgY2I6IGNifSksIHRydWUKCQl9CgkJdmFyIHAgPSBjYW4ub25lbmdpbmUucGx1Z2luLm1ldGFbY21kc1swXV07IGlmIChwKSB7CgkJCWlmIChwLm1ldGEgJiYgcC5tZXRhW2NtZHNbMV1dICYmIGNtZHNbMF0gPT0gY3R4LkFDVElPTikgewoJCQkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKHAubWV0YVtjbWRzWzFdXSwge2NhbjogY2FuLCBtc2c6IG1zZywgY21kczogY21kcy5zbGljZSgzKSwgY2I6IGNifSksIHRydWUKCQkJfSBlbHNlIGlmIChwLm1ldGEgJiYgcC5tZXRhW2NtZHNbMF1dKSB7CgkJCQlyZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMocC5tZXRhW2NtZHNbMF1dLCB7Y2FuOiBjYW4sIG1zZzogbXNnLCBjbWRzOiBjbWRzLnNsaWNlKDIpLCBjYjogY2J9KSwgdHJ1ZQoJCQl9CgkJCXJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhwLCB7Y2FuOiBjYW4sIG1zZzogbXNnLCBjbWRzOiBjbWRzLnNsaWNlKDEpLCBjYjogY2J9KSwgdHJ1ZQoJCX0KCQlyZXR1cm4gZmFsc2UKCX0sCglfcmVtb3RlOiBmdW5jdGlvbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikgewoJCW1zZy5vcHRpb24gPSBjYW4uY29yZS5MaXN0KG1zZy5vcHRpb24sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJcmV0dXJuIHtfdG9hc3Q6IHRydWUsIF9oYW5kbGU6IHRydWV9W2l0ZW1dICYmIGRlbGV0ZShtc2dbaXRlbV0pPyB1bmRlZmluZWQ6IGl0ZW0KCQl9KQoKCQlpZiAocGFuZWwub25lbmdpbmUuX2VuZ2luZShldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikpIHsgcmV0dXJuIH0KCQlpZiAocGFuZWwub25lbmdpbmUuX3BsdWdpbihldmVudCwgY2FuLCBtc2csIHBhbmVsLCBjbWRzLCBjYikpIHsgcmV0dXJuIH0KCgkJdmFyIGtleSA9IGNhbi5jb3JlLktleXMocGFuZWwuX25hbWUsIGNtZHMuam9pbihpY2UuRlMpKQoJCWlmIChjYW4udXNlci5pc0xvY2FsRmlsZSkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBtc2cuQ2xlYXIoaWNlLk1TR19BUFBFTkQpCgkJCXZhciByZXMgPSBWb2xjYW5vcy5tZXRhLnBhY2tba2V5XTsgcmVzPyBtc2cuQ29weShyZXMpOiBjYW4udXNlci50b2FzdChjYW4sICLnvLrlpLHmlbDmja4iKQoJCQlyZXR1cm4gY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJfQoKCQl2YXIgdG9hc3Q7IGlmIChtc2cuT3B0aW9uKCJfdG9hc3QiKSkgeyBjYW4uY29yZS5UaW1lcigxMDAwLCBmdW5jdGlvbigpIHsKCQkJdG9hc3QgPSB0b2FzdHx8Y2FuLnVzZXIudG9hc3QoY2FuLCBtc2cuT3B0aW9uKCJfdG9hc3QiKSwgbXNnLl9jYW4uX25hbWUsIC0xKQoJCX0pIH0KCQl2YXIgbmFtZXMgPSBtc2cuT3B0aW9uKCJfbmFtZXMiKXx8cGFuZWwuX25hbWVzfHwoKGNhbi5Db25mKCJpY2ViZXJnIil8fCIvY2hhdC8iKStwYW5lbC5fbmFtZSkKCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTlJFTU9URSwgY2FuLnJlcXVlc3Qoe30sIHtfZm9sbG93OiBwYW5lbC5fZm9sbG93LCBfbXNnOiBtc2csIF9jbWRzOiBjbWRzfSkpCgkJY2FuLm1pc2MuUnVuKGV2ZW50LCBjYW4sIHtuYW1lczogbmFtZXMsIGRhZW1vbjogY2FuLmNvcmUuS2V5cyhjYW4ub25kYWVtb24uX2xpc3RbMF0sIG1zZy5fZGFlbW9uKX0sIGNtZHMsIGZ1bmN0aW9uKG1zZykgewoJCQlWb2xjYW5vcy5tZXRhLnBhY2tba2V5XSA9IG1zZywgZGVsZXRlKG1zZy5faGFuZGxlKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJCXRvYXN0ICYmIHRvYXN0LmNsb3NlKCksIHRvYXN0ID0gdHJ1ZSwgZGVsZXRlKG1zZy5fdG9hc3QpCgkJfSkKCX0sCgoJcGx1Z2luOiBzaHkoIua3u+WKoOaPkuS7tiIsIHt9LCBbXSwgZnVuY3Rpb24oY2FuLCBuYW1lLCBjb21tYW5kKSB7IG5hbWUgPSBjYW4uYmFzZS50cmltUHJlZml4KG5hbWUsICJjYW4uIikKCQl2YXIgdHlwZSA9IGh0bWwuVEVYVDsgY29tbWFuZC5saXN0ID0gY2FuLmNvcmUuTGlzdChjb21tYW5kLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJc3dpdGNoICh0eXBlb2YgaXRlbSkgewoJCQkJY2FzZSBsYW5nLlNUUklORzogcmV0dXJuIGNhbi5jb3JlLlNwbGl0SW5wdXQoaXRlbSkKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6IHJldHVybiB0eXBlID0gaXRlbS50eXBlfHx0eXBlLCBpdGVtCgkJCX0KCQl9KSwgYXJndW1lbnRzLmNhbGxlZS5tZXRhW2Nhbi5jb3JlLktleXMoImNhbiIsIG5hbWUpXSA9IGNvbW1hbmQKCX0pLAoJbGlzdGVuOiBzaHkoIuebkeWQrOS6i+S7tiIsIHt9LCBbXSwgZnVuY3Rpb24oY2FuLCBuYW1lLCBjYikgeyBhcmd1bWVudHMuY2FsbGVlLm1ldGFbbmFtZV0gPSAoYXJndW1lbnRzLmNhbGxlZS5tZXRhW25hbWVdfHxbXSkuY29uY2F0KGNiKSB9KSwKCXNpZ25hbDogc2h5KCLop6blj5Hkuovku7YiLCBmdW5jdGlvbihjYW4sIG5hbWUsIG1zZykgeyBtc2cgPSBtc2d8fGNhbi5yZXF1ZXN0KCkKCQljYW4ubWlzYy5Mb2coZ2RiLlNJR05BTCwgbmFtZSwgbmFtZSA9PSBjaGF0Lk9OUkVNT1RFPyBtc2cuT3B0aW9uKCJfbXNnIik6IG1zZykKCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChjYW4ub25lbmdpbmUubGlzdGVuLm1ldGFbbmFtZV0sIGZ1bmN0aW9uKGNiKSB7IGNhbi5jb3JlLkNhbGxGdW5jKGNiLCB7ZXZlbnQ6IG1zZy5fZXZlbnQsIG1zZzogbXNnfSkgfSkubGVuZ3RoCgl9KSwKfSkKVm9sY2Fub3MoIm9uZGFlbW9uIiwge2hlbHA6ICLmjqjojZDlvJXmk44iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbmFtZSkgeyBpZiAoY2FuLnVzZXIuaXNMb2NhbEZpbGUpIHsgcmV0dXJuIH0KCQljYW4ubWlzYy5XU1MoY2FuLCB7dHlwZTogaHRtbC5DSFJPTUUsIG5hbWU6IGNhbi5taXNjLlNlYXJjaChjYW4sIGNsaS5EQUVNT04pfHxuYW1lfHwiIn0sIGZ1bmN0aW9uKGV2ZW50LCBtc2csIGNtZCwgYXJnKSB7IGlmICghbXNnKSB7IHJldHVybiB9CgkJCXZhciBzdWIgPSBjYW4ub25kYWVtb24uX2xpc3RbbXNnLk9wdGlvbihpY2UuTVNHX1RBUkdFVCldCgkJCWNhbi5iYXNlLmlzRnVuYyhjYW4ub25kYWVtb25bY21kXSk/IGNhbi5jb3JlLkNhbGxGdW5jKGNhbi5vbmRhZW1vbltjbWRdLCB7CgkJCQljYW46IGNhbiwgc3ViOiBzdWIsIG1zZzogbXNnLCBjbWQ6IGNtZCwgYXJnOiBhcmcsIGNiOiBmdW5jdGlvbigpIHsgbXNnLlJlcGx5KCkgfSwKCQkJfSk6IGNhbi5vbmVuZ2luZS5fc2VhcmNoKHt9LCBjYW4sIG1zZywgY2FuLCBbIl9zZWFyY2giLCBjbWRdLmNvbmNhdChhcmcpLCBmdW5jdGlvbigpIHsgbXNnLlJlcGx5KCkgfSkKCQl9KQoJfSwgX2xpc3Q6IFsiIl0sCglyZWZyZXNoOiBmdW5jdGlvbihjYW4sIG1zZywgc3ViKSB7IHN1Yi5VcGRhdGUoKSB9LAoJcHdkOiBmdW5jdGlvbihjYW4sIG1zZywgYXJnKSB7IGNhbi5vbmRhZW1vbi5fbGlzdFswXSA9IGFyZ1swXSB9LAoJZ3JvdzogZnVuY3Rpb24oY2FuLCBtc2csIHN1YiwgYXJnKSB7IHN1Yi5vbmltcG9ydC5fZ3JvdyhzdWIsIGNhbi5wYWdlLkNvbG9yKGFyZy5qb2luKCIiKSkpIH0sCgl0b2FzdDogZnVuY3Rpb24oY2FuLCBtc2csIGFyZykgeyBjYW4uY29yZS5DYWxsRnVuYyhjYW4udXNlci50b2FzdCwge2NhbjogY2FuLCBtc2c6IG1zZywgY21kczogYXJnfSkgfSwKfSkKVm9sY2Fub3MoIm9uYXBwZW5kIiwge2hlbHA6ICLmuLLmn5PlvJXmk44iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgbGlzdCwgY2IsIHRhcmdldCwgZmllbGQpIHsKCQltZXRhLm5hbWUgPSAobWV0YS5uYW1lfHwiIikuc3BsaXQoaWNlLlNQKVswXS5zcGxpdChpY2UuUFQpLnBvcCgpCgkJZmllbGQgPSBmaWVsZHx8Y2FuLm9uYXBwZW5kLmZpZWxkKGNhbiwgbWV0YS50eXBlLCBtZXRhLCB0YXJnZXQpLmZpcnN0CgkJdmFyIGxlZ2VuZCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkxFR0VORClbMF0KCQl2YXIgb3B0aW9uID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZmllbGQsIGh0bWwuRk9STV9PUFRJT04pWzBdCgkJdmFyIGFjdGlvbiA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkRJVl9BQ1RJT04pWzBdCgkJdmFyIG91dHB1dCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkRJVl9PVVRQVVQpWzBdCgkJdmFyIHN0YXR1cyA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGZpZWxkLCBodG1sLkRJVl9TVEFUVVMpWzBdCgoJCXZhciBzdWIgPSBWb2xjYW5vcyhtZXRhLm5hbWUsIHtfZm9sbG93OiBjYW4uY29yZS5LZXlzKGNhbi5fZm9sbG93LCBtZXRhLm5hbWUpLCBfdGFyZ2V0OiBmaWVsZCwKCQkJX2xlZ2VuZDogbGVnZW5kLCBfb3B0aW9uOiBvcHRpb24sIF9hY3Rpb246IGFjdGlvbiwgX291dHB1dDogb3V0cHV0LCBfc3RhdHVzOiBzdGF0dXMsCgkJCV9pbnB1dHM6IHt9LCBfb3V0cHV0czogW10sIF9oaXN0b3J5OiBbXSwKCgkJCVN0YXR1czogZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewoJCQkJaWYgKGNhbi5iYXNlLmlzT2JqZWN0KGtleSkpIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oa2V5LCBzdWIuU3RhdHVzKSwga2V5IH0KCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHN0YXR1cywgW1tbaHRtbC5ESVYsIGtleV0sIGh0bWwuU1BBTl1dLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJcmV0dXJuIHZhbHVlID09IHVuZGVmaW5lZD8gKHZhbHVlID0gaXRlbS5pbm5lckhUTUwpOiAoaXRlbS5pbm5lckhUTUwgPSB2YWx1ZSkKCQkJCX0pOyByZXR1cm4gdmFsdWUKCQkJfSwKCQkJQWN0aW9uOiBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHJldHVybiBjYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgYWN0aW9uLCBrZXksIHZhbHVlKVswXSB9LAoJCQlPcHRpb246IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBvcHRpb24sIGtleSwgdmFsdWUpWzBdIH0sCgkJCVVwZGF0ZTogZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiLCBzaWxlbnQpIHsgc3ViLm9uYXBwZW5kLl9vdXRwdXQwKHN1Yiwgc3ViLkNvbmYoKSwgZXZlbnR8fHt9LCBjbWRzfHxzdWIuSW5wdXQoKSwgY2IsIHNpbGVudCk7IHJldHVybiB0cnVlIH0sCgkJCUZvY3VzOiBmdW5jdGlvbigpIHsgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgb3B0aW9uLCBodG1sLklOUFVUX0FSR1MsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7IGluZGV4ID09IDAgJiYgaXRlbS5mb2N1cygpIH0pIH0sCgkJCUlucHV0OiBmdW5jdGlvbihjbWRzLCBzaWxlbnQpIHsKCQkJCWNtZHMgPSBjbWRzICYmIGNtZHMubGVuZ3RoID4gMD8gY21kczogY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIG9wdGlvbiwgIiIpLmNvbmNhdChjYW4ucGFnZS5TZWxlY3RBcmdzKGNhbiwgYWN0aW9uLCAiIikpLCBjbWRzID0gY2FuLmJhc2UudHJpbShjbWRzKQoJCQkJc2lsZW50IHx8IGNtZHNbMF0gPT0gY3R4LkFDVElPTiB8fCBjYW4uYmFzZS5FcShzdWIuX2hpc3Rvcnlbc3ViLl9oaXN0b3J5Lmxlbmd0aC0xXSwgY21kcykgfHwgc3ViLl9oaXN0b3J5LnB1c2goY21kcykKCQkJCXJldHVybiBjbWRzCgkJCX0sCgkJCUNsb25lOiBmdW5jdGlvbigpIHsgbWV0YS5hcmdzID0gY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIG9wdGlvbiwgIiIpCgkJCQljYW4ub25hcHBlbmQuX2luaXQoY2FuLCBtZXRhLCBsaXN0LCBmdW5jdGlvbihzdWIpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIsIHRydWUpCgkJCQkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBmb3IgKHZhciBrIGluIHN1Yi5faW5wdXRzKSB7IGNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIHN1Yi5faW5wdXRzW2tdLl90YXJnZXQpOyBicmVhayB9IH0pCgkJCQl9LCB0YXJnZXQpCgkJCX0sCgkJfSwgbGlzdCwgZnVuY3Rpb24oc3ViKSB7IHN1Yi5Db25mKG1ldGEpLCBtZXRhLmZlYXR1cmUgPSBjYW4uYmFzZS5PYmoobWV0YS5mZWF0dXJlLCB7fSkKCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGZpZWxkLCBtZXRhLmluZGV4PyBtZXRhLmluZGV4LnNwbGl0KGljZS5QVCkucG9wKCk6IG1ldGEubmFtZSkKCQkJdmFyIHN0eWxlID0gY2FuLmJhc2UuZ2V0VmFsaWQobWV0YS5zdHlsZSwgbWV0YS5mZWF0dXJlLnN0eWxlKTsgc3dpdGNoICh0eXBlb2Ygc3R5bGUpIHsKCQkJCWNhc2UgbGFuZy5TVFJJTkc6IGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBmaWVsZCwgc3R5bGUpOyBicmVhawoJCQkJY2FzZSBsYW5nLk9CSkVDVDogY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX3RhcmdldCwgc3R5bGUpOyBicmVhawoJCQl9CgoJCQltZXRhLmlucHV0cyAmJiBzdWIub25hcHBlbmQuX29wdGlvbihzdWIsIG1ldGEsIHN1Yi5fb3B0aW9uLCBtZXRhLm1zZykKCQkJaWYgKG1ldGEubXNnKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdCgpOyBtc2cuQ29weShjYW4uYmFzZS5PYmoobWV0YS5tc2cpKSwgc3ViLm9uYXBwZW5kLl9vdXRwdXQoc3ViLCBtc2csIG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKXx8bWV0YS5mZWF0dXJlLmRpc3BsYXkpIH0KCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fbGVnZW5kLCBraXQuRGljdChjYW4uQ29uZigibGVnZW5kX2V2ZW50Iil8fCJvbm1vdXNlZW50ZXIiLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnVzZXIuY2FydGUoZXZlbnQsIHN1Yiwgc3ViLm9uYWN0aW9uLCBzdWIub25hY3Rpb24ubGlzdC5jb25jYXQoW1si5omA5pyJIl0uY29uY2F0KGNhbi5jb3JlLkl0ZW0obWV0YS5mZWF0dXJlLl90cmFucykpXSksIGZ1bmN0aW9uKGV2ZW50LCBpdGVtLCBtZXRhKSB7CgkJCQkJdmFyIGNiID0gY2FuLmNvcmUuVmFsdWUoc3ViLCBbIl9vdXRwdXRzLi0xLm9uYWN0aW9uIiwgaXRlbV0pCgkJCQkJaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikpIHsgcmV0dXJuIGNiKGV2ZW50LCBjYW4uY29yZS5WYWx1ZShzdWIsICJfb3V0cHV0cy4tMSIpLCBpdGVtKSB9CgkJCQkJdmFyIGNiID0gbWV0YVtpdGVtXXx8bWV0YVsiX2VuZ2luZSJdCgkJCQkJaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikpIHsgcmV0dXJuIGNiKGV2ZW50LCBzdWIsIGl0ZW0pIH0KCQkJCX0pCgkJCX0pKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpCgkJfSk7IHJldHVybiBzdWIKCX0sCglfb3B0aW9uOiBmdW5jdGlvbihjYW4sIG1ldGEsIG9wdGlvbiwgc2tpcCkgeyBtZXRhID0gbWV0YXx8e307IHZhciBpbmRleCA9IC0xLCBhcmdzID0gY2FuLmJhc2UuT2JqKG1ldGEuYXJnc3x8bWV0YS5hcmd8fG1ldGEub3B0LCBbXSksIG9wdHMgPSBjYW4uYmFzZS5PYmoobWV0YS5vcHRzLCB7fSkKCQlmdW5jdGlvbiBhZGQoaXRlbSwgbmV4dCkgeyBpdGVtID0gY2FuLmJhc2UuaXNTdHJpbmcoaXRlbSk/IHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IGl0ZW19OiBpdGVtLCBpdGVtLnR5cGUgIT0gaHRtbC5CVVRUT04gJiYgaW5kZXgrKwoJCQlyZXR1cm4gVm9sY2Fub3MoaXRlbS5uYW1lLCB7X2ZvbGxvdzogY2FuLmNvcmUuS2V5cyhjYW4uX2ZvbGxvdywgaXRlbS5uYW1lKSwKCQkJCV90YXJnZXQ6IGNhbi5vbmFwcGVuZC5pbnB1dChjYW4sIGl0ZW0sIGFyZ3NbaW5kZXhdfHxvcHRzW2l0ZW0ubmFtZV0sIG9wdGlvbnx8Y2FuLl9vcHRpb24pLAoJCQkJX29wdGlvbjogb3B0aW9ufHxjYW4uX29wdGlvbiwgX2FjdGlvbjogY2FuLl9hY3Rpb24sIF9vdXRwdXQ6IGNhbi5fb3V0cHV0LCBfc3RhdHVzOiBjYW4uX3N0YXR1cywKCQkJCU9wdGlvbjogY2FuLk9wdGlvbiwgQWN0aW9uOiBjYW4uQWN0aW9uLCBTdGF0dXM6IGNhbi5TdGF0dXMsIENsb25lRmllbGQ6IGNhbi5DbG9uZSwKCQkJCUNsb25lSW5wdXQ6IGZ1bmN0aW9uKCkgeyBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBhZGQoaXRlbSkuX3RhcmdldCkgfSwKCQkJfSwgW2l0ZW0uZGlzcGxheSwgY2hhdC5QTFVHSU5fSU5QVVRfSlNdLCBmdW5jdGlvbihpbnB1dCkgeyBpbnB1dC5Db25mKGl0ZW0pCgkJCQlpbnB1dC5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpCgkJCQkJaWYgKGl0ZW0uX2NiKSB7IHJldHVybiBpdGVtLl9jYihldmVudCkgfQoJCQkJCWlmIChtc2cuUnVuQWN0aW9uKGV2ZW50LCBjYW4uY29yZS5WYWx1ZShjYW4sICJfb3V0cHV0cy4tMSIpLCBjbWRzKSkgeyByZXR1cm4gfQoJCQkJCWlmIChtc2cuUnVuQWN0aW9uKGV2ZW50LCBpbnB1dCwgY21kcykpIHsgcmV0dXJuIH0KCQkJCQlyZXR1cm4gY2FuLlVwZGF0ZShldmVudCwgY2FuLklucHV0KGNtZHMsIHNpbGVudCksIGNiLCBzaWxlbnQpCgkJCQl9LCBjYW4uX2lucHV0c1tpdGVtLm5hbWVdID0gaW5wdXQsIGlucHV0LnN1cCA9IGNhbgoKCQkJCWNhbi5jb3JlLkl0ZW1DQihpbnB1dC5vbmFjdGlvbiwgZnVuY3Rpb24oa2V5LCBjYikgeyBpbnB1dC5fdGFyZ2V0W2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgaW5wdXQpIH0gfSkKCQkJCWNhbi5jb3JlLkl0ZW1DQihpdGVtLCBmdW5jdGlvbihrZXksIGNiKSB7IGlucHV0Ll90YXJnZXRba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCBpbnB1dCkgfSB9KQoJCQkJc2tpcD8gbmV4dCgpOiBjYW4uY29yZS5DYWxsRnVuYyhbaW5wdXQub25hY3Rpb24sICJfaW5pdCJdLCBbaW5wdXQsIGl0ZW0sIG5leHQsIGlucHV0Ll90YXJnZXRdKTsKCQkJCShpdGVtLmFjdGlvbnx8Y2FuLmNvcmUuVmFsdWUobWV0YSwgW2N0eC5GRUFUVVJFLCBjdHguSU5QVVRTXSkpICYmIGNhbi5vbmFwcGVuZC5maWd1cmUoaW5wdXQsIGl0ZW0sIGlucHV0Ll90YXJnZXQpCgkJCX0pCgkJfTsgY2FuLmNvcmUuTmV4dChjYW4uYmFzZS5PYmoobWV0YS5pbnB1dHMsIGNhbi5jb3JlLlZhbHVlKGNhbiwgW2NoYXQuT05JTVBPUlQsIG1kYi5MSVNUXSkpLmNvbmNhdChtZXRhLnR5cGUgPT0gY2hhdC5GTE9BVD8gW3t0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogY2xpLkNMT1NFfV06IFtdKSwgYWRkKQoJfSwKCV9hY3Rpb246IGZ1bmN0aW9uKGNhbiwgbGlzdCwgYWN0aW9uLCBtZXRhKSB7CgkJbGlzdCA9IGNhbi5iYXNlLmdldFZhbGlkKGxpc3QsIGNhbi5jb3JlLkl0ZW0obWV0YSkpCgkJbGlzdCA9IGNhbi5iYXNlLk9iaihsaXN0LCBjYW4uY29yZS5WYWx1ZShjYW4sIFtjaGF0Lk9OQUNUSU9OLCBtZGIuTElTVF0pKQoJCXZhciBfbGlzdCA9IFtdOyBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsKCQkJc3dpdGNoIChsaXN0W2ldKSB7IGNhc2UgIiI6IF9saXN0LnB1c2goIiIpOyBicmVhawoJCQkJY2FzZSBtZGIuUEFHRToKCQkJCQlfbGlzdC5wdXNoKHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IG1kYi5MSU1JVCwgdmFsdWU6IGNhbi5fbXNnLk9wdGlvbihtZGIuTElNSVQpfSkKCQkJCQlfbGlzdC5wdXNoKHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6IG1kYi5PRkZFTkQsIHZhbHVlOiBjYW4uX21zZy5PcHRpb24obWRiLk9GRkVORCl9KQoJCQkJCV9saXN0LnB1c2gobWRiLlBSRVYsIG1kYi5ORVhUKQoJCQkJCWJyZWFrCgkJCQlkZWZhdWx0OgoJCQkJCShmdW5jdGlvbigpIHsKCQkJCQkJdmFyIGl0ZW0gPSBjYW4uY29yZS5TcGxpdElucHV0KGxpc3RbaV0sIGh0bWwuQlVUVE9OKTsKCQkJCQkJaWYgKGl0ZW0udHlwZSA9PSBodG1sLlNFTEVDVCkgewoJCQkJCQkJaXRlbS5faW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgewoJCQkJCQkJCXRhcmdldC52YWx1ZSA9IGl0ZW0udmFsdWV8fGl0ZW0udmFsdWVzWzBdCgkJCQkJCQkJdGFyZ2V0Lm9uY2hhbmdlID0gZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnJ1bihldmVudCkgfQoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCWl0ZW0uYWN0aW9uICYmIChmdW5jdGlvbigpIHsKCQkJCQkJCWl0ZW0uX2luaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsgY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIGl0ZW0sIHRhcmdldCkgfQoJCQkJCQl9KSgpLCBpdGVtLnR5cGUgPT0gaHRtbC5CVVRUT04/IF9saXN0LnB1c2gobGlzdFtpXSk6IF9saXN0LnB1c2goaXRlbSkKCQkJCQl9KSAoKQoJCQl9CgkJfQoJCW1ldGEgPSBtZXRhfHxjYW4ub25hY3Rpb24sIGFjdGlvbiA9IGFjdGlvbnx8Y2FuLl9hY3Rpb24sIGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGFjdGlvbikKCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChfbGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpZiAoaXRlbSA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIH0gY2FuLm9uYXBwZW5kLmlucHV0KGNhbiwgaXRlbSA9PSAiIj8gLyrnqbrnmb0qLyB7dHlwZTogaHRtbC5TUEFDRX06CgkJCWNhbi5iYXNlLmlzU3RyaW5nKGl0ZW0pPyAvKuaMiemUriovIHt0eXBlOiBodG1sLkJVVFRPTiwgdmFsdWU6IGNhbi51c2VyLnRyYW5zKGNhbiwgaXRlbSksIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl2YXIgY2IgPSBtZXRhW2l0ZW1dfHxtZXRhWyJfZW5naW5lIl07IGNiPyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2V2ZW50OiBldmVudCwgY2FuOiBjYW4sIGJ1dHRvbjogaXRlbX0pOiBjYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaXRlbV0uY29uY2F0KGNhbi5zdXAuSW5wdXQoKSkpCgoJCQl9LCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRU5URVIpIHsKCQkJCQl2YXIgY2IgPSBtZXRhW2l0ZW1dfHxtZXRhWyJfZW5naW5lIl07IGNiPyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2V2ZW50OiBldmVudCwgY2FuOiBjYW4sIGJ1dHRvbjogaXRlbX0pOiBjYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaXRlbV0uY29uY2F0KGNhbi5zdXAuSW5wdXQoKSkpCgkJCQl9CgoJCQl9fTogaXRlbS5sZW5ndGggPiAwPyAvKuWIl+ihqCovIHt0eXBlOiBodG1sLlNFTEVDVCwgbmFtZTogaXRlbVswXSwgdmFsdWVzOiBpdGVtLnNsaWNlKDEpLCBvbmNoYW5nZTogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciB3aGljaCA9IGl0ZW1bZXZlbnQudGFyZ2V0LnNlbGVjdGVkSW5kZXgrMV0KCQkJCWNhbi5jb3JlLkNhbGxGdW5jKG1ldGFbd2hpY2hdLCBbZXZlbnQsIGNhbiwgd2hpY2hdKQoJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMobWV0YVtpdGVtWzBdXSwgW2V2ZW50LCBjYW4sIGl0ZW1bMF0sIHdoaWNoXSkKCgkJCX19OiAvKuWFtuWugyovIGl0ZW0sICIiLCBhY3Rpb24pfSksIG1ldGEKCX0sCglfb3V0cHV0MDogZnVuY3Rpb24oY2FuLCBtZXRhLCBldmVudCwgY21kcywgY2IsIHNpbGVudCkgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQpOyBpZiAobXNnLlJ1bkFjdGlvbihldmVudCwgY2FuLCBjbWRzKSkgeyByZXR1cm4gfQoJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFKSAhPSBpY2UuVFJVRSAmJiBjbWRzICYmIGNtZHNbMF0gPT0gY3R4LkFDVElPTiAmJiBtZXRhLmZlYXR1cmVbY21kc1sxXV0pIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB7YWN0aW9uOiBjbWRzWzFdfSkKCQkJaWYgKGNhbi5iYXNlLmlzRnVuYyhtZXRhLmZlYXR1cmVbY21kc1sxXV0pKSB7IHJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhtZXRhLmZlYXR1cmVbY21kc1sxXV0sIHtjYW46IGNhbiwgbXNnOiBtc2csIGNtZHM6IGNtZHMuc2xpY2UoMil9KSB9CgkJCXJldHVybiBjYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBtZXRhLmZlYXR1cmVbY21kc1sxXV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB7X2hhbmRsZTogaWNlLlRSVUV9LCBjYW4uT3B0aW9uKCkpCgkJCQljYW4uVXBkYXRlKGV2ZW50LCBjbWRzLnNsaWNlKDAsIDIpLmNvbmNhdChhcmdzKSwgY2J8fGZ1bmN0aW9uKCkgewoJCQkJCWlmIChjYW4uY29yZS5DYWxsRnVuYyhbY2FuLnN1cCwgY2hhdC5PTklNUE9SVCwgaWNlLk1TR19QUk9DRVNTXSwge2NhbjogY2FuLnN1cCwgbXNnOiBtc2d9KSkgeyByZXR1cm4gfQoJCQkJCWlmIChjYW4uY29yZS5DYWxsRnVuYyhbY2FuLCBjaGF0Lk9OSU1QT1JULCBpY2UuTVNHX1BST0NFU1NdLCB7Y2FuOiBjYW4sIG1zZzogbXNnfSkpIHsgcmV0dXJuIH0KCQkJCQlpZiAobXNnLlJlc3VsdCgpLmxlbmd0aCA+IDAgfHwgbXNnLkxlbmd0aCgpID4gMCkgewoJCQkJCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpCgkJCQkJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZykKCQkJCQl9IGVsc2UgewoJCQkJCQljYW4uVXBkYXRlKCkKCQkJCQl9CgkJCQl9LCB0cnVlKQoJCQl9KQoJCX0KCgkJaWYgKGNhbi5iYXNlLmlzVW5kZWZpbmVkKG1zZy5fZGFlbW9uKSkgewoJCQljYW4uYmFzZS5pc1VuZGVmaW5lZChjYW4uX2RhZW1vbikgJiYgY2FuLm9uZGFlbW9uLl9saXN0WzBdICYmIChjYW4uX2RhZW1vbiA9IGNhbi5vbmRhZW1vbi5fbGlzdC5wdXNoKGNhbiktMSkKCQkJaWYgKGNhbi5fZGFlbW9uKSB7IG1zZy5PcHRpb24oaWNlLk1TR19EQUVNT04sIGNhbi5jb3JlLktleXMoY2FuLm9uZGFlbW9uLl9saXN0WzBdLCBjYW4uX2RhZW1vbikpIH0KCQl9CgkJaWYgKG1ldGEgJiYgbWV0YS5pbmRleCAmJiBtZXRhLmluZGV4LmluZGV4T2YoImNhbi4iKSA9PSAwKSB7CgkJCWNhbi5vbmVuZ2luZS5fcGx1Z2luKGV2ZW50LCBjYW4sIG1zZywgY2FuLCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbbWV0YS5pbmRleF0sIGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWlmIChjYW4uYmFzZS5pc0Z1bmMoY2IpKSB7IGNhbi5jb3JlLkNhbGxGdW5jKGNiLCB7Y2FuOiBjYW4sIG1zZzogbXNnfSk7IHJldHVybiB9CgkJCQkhc2lsZW50ICYmIGNhbi5vbmFwcGVuZC5fb3V0cHV0KGNhbiwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSl8fG1ldGEuZGlzcGxheXx8bWV0YS5mZWF0dXJlLmRpc3BsYXkpCgkJCX0pCgkJCXJldHVybgoJCX0KCgkJcmV0dXJuIGNhbi5ydW4oZXZlbnQsIGNtZHMsIGZ1bmN0aW9uKG1zZykgeyB2YXIgc3ViID0gY2FuLmNvcmUuVmFsdWUoY2FuLCAiX291dHB1dHMuLTEiKXx8e307IGNhbi5fbXNnID0gbXNnLCBzdWIuX21zZyA9IG1zZwoJCQlpZiAoY2FuLmJhc2UuaXNGdW5jKGNiKSkgeyBjYW4uY29yZS5DYWxsRnVuYyhjYiwge2NhbjogY2FuLCBtc2c6IG1zZ30pOyByZXR1cm4gfQoJCQl2YXIgcHJvY2VzcyA9IG1zZy5fY2FuID09IGNhbiB8fCBtc2cuX2NhbiA9PSBzdWIKCQkJaWYgKHByb2Nlc3MgJiYgY2FuLmNvcmUuQ2FsbEZ1bmMoW3N1YiwgY2hhdC5PTklNUE9SVCwgaWNlLk1TR19QUk9DRVNTXSwge2Nhbjogc3ViLCBtc2c6IG1zZ30pKSB7IHJldHVybiB9CgkJCWlmIChwcm9jZXNzICYmIGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4sIGNoYXQuT05JTVBPUlQsIGljZS5NU0dfUFJPQ0VTU10sIHtjYW46IGNhbiwgbXNnOiBtc2d9KSkgeyByZXR1cm4gfQoJCQkhc2lsZW50ICYmIGNhbi5vbmFwcGVuZC5fb3V0cHV0KGNhbiwgbXNnLCBtc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSl8fG1ldGEuZGlzcGxheXx8bWV0YS5mZWF0dXJlLmRpc3BsYXkpCgkJfSkKCX0sCglfb3V0cHV0OiBmdW5jdGlvbihjYW4sIG1zZywgZGlzcGxheSwgb3V0cHV0LCBhY3Rpb24sIGNiKSB7IGRpc3BsYXkgPSBkaXNwbGF5fHxjaGF0LlBMVUdJTl9UQUJMRV9KUywgb3V0cHV0ID0gb3V0cHV0fHxjYW4uX291dHB1dAoJCVZvbGNhbm9zKGRpc3BsYXksIHtfZm9sbG93OiBjYW4uY29yZS5LZXlzKGNhbi5fZm9sbG93LCBkaXNwbGF5KSwgX2Rpc3BsYXk6IGRpc3BsYXksIF90YXJnZXQ6IG91dHB1dCwgX2ZpZWxkczogY2FuLl90YXJnZXQsCgkJCV9vcHRpb246IGNhbi5fb3B0aW9uLCBfYWN0aW9uOiBjYW4uX2FjdGlvbiwgX291dHB1dDogY2FuLl9vdXRwdXQsIF9zdGF0dXM6IGNhbi5fc3RhdHVzLCBfbGVnZW5kOiBjYW4uX2xlZ2VuZCwgX2lucHV0czoge30sCgkJCVVwZGF0ZTogY2FuLlVwZGF0ZSwgT3B0aW9uOiBjYW4uT3B0aW9uLCBBY3Rpb246IGNhbi5BY3Rpb24sIFN0YXR1czogY2FuLlN0YXR1cywKCQl9LCBbZGlzcGxheSwgY2hhdC5QTFVHSU5fVEFCTEVfSlNdLCBmdW5jdGlvbih0YWJsZSkgeyB0YWJsZS5Db25mKGNhbi5Db25mKCkpCgkJCXRhYmxlLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYiwgc2lsZW50KSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQkJCWlmIChtc2cuUnVuQWN0aW9uKGV2ZW50LCB0YWJsZSwgY21kcykpIHsgcmV0dXJuIH0KCQkJCXJldHVybiBjYW4uVXBkYXRlKGV2ZW50LCBjYW4uSW5wdXQoY21kcywgc2lsZW50KSwgY2IsIHNpbGVudCkKCQkJfSwgY2FuLl9vdXRwdXRzICYmIGNhbi5fb3V0cHV0cy5wdXNoKHRhYmxlKSwgdGFibGUuc3VwID0gY2FuLCB0YWJsZS5fbXNnID0gbXNnCgoJCQlpZiAoY2FuLkNvbmYoY3R4LklOREVYKSA9PSAiY2FuLmNvZGUuaW5uZXIucGx1Z2luIiAmJiB0YWJsZS5vbmltcG9ydCAmJiB0YWJsZS5vbmltcG9ydC5saXN0Lmxlbmd0aCA+IDApIHsKCQkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fb3B0aW9uKSwgY2FuLm9uYXBwZW5kLl9vcHRpb24oY2FuLCB7aW5wdXRzOiB0YWJsZS5vbmltcG9ydC5saXN0fSkKCQkJfQoKCQkJdGFibGUuX2FyZ3MgPSBjYW4uYmFzZS5QYXJzZVVSTCh0YWJsZS5fZGlzcGxheSkKCQkJdGFibGUuX3RyYW5zID0gY2FuLmJhc2UuQ29weSh0YWJsZS5fdHJhbnN8fHt9LCBjYW4uY29yZS5WYWx1ZSh0YWJsZSwgIm9uYWN0aW9uLl90cmFucyIpKQoJCQljYW4uY29yZS5DYWxsRnVuYyhbdGFibGUsIGNoYXQuT05JTVBPUlQsICJfaW5pdCJdLCB7Y2FuOiB0YWJsZSwgbXNnOiBtc2csIGxpc3Q6IG1zZy5yZXN1bHR8fG1zZy5hcHBlbmR8fFtdLCBjYjogZnVuY3Rpb24obXNnKSB7CgkJCQlhY3Rpb24gPT09IGZhbHNlIHx8IHRhYmxlLm9uYXBwZW5kLl9hY3Rpb24odGFibGUsIG1zZy5PcHRpb24oaWNlLk1TR19BQ1RJT04pfHxjYW4uQ29uZihpY2UuTVNHX0FDVElPTiksIGFjdGlvbikKCQkJCWFjdGlvbiA9PT0gZmFsc2UgfHwgdGFibGUub25hcHBlbmQuX3N0YXR1cyh0YWJsZSwgbXNnLk9wdGlvbihpY2UuTVNHX1NUQVRVUykpCgkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQkJfSwgdGFyZ2V0OiBvdXRwdXR8fGNhbi5fb3V0cHV0fSkKCQl9KQoJfSwKCV9zdGF0dXM6IGZ1bmN0aW9uKGNhbiwgbGlzdCwgc3RhdHVzKSB7IHN0YXR1cyA9IHN0YXR1c3x8Y2FuLl9zdGF0dXMsIGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHN0YXR1cykKCQljYW4uY29yZS5MaXN0KGNhbi5iYXNlLk9iaihsaXN0LCBjYW4uY29yZS5WYWx1ZShjYW4sIFtjaGF0Lk9ORVhQT1JULCBtZGIuTElTVF0pKSwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtID0gY2FuLmJhc2UuaXNPYmplY3QoaXRlbSk/IGl0ZW06IHtuYW1lOiBpdGVtfQoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBzdGF0dXMsIFt7dmlldzogY2FuLmJhc2Uuam9pbihbaHRtbC5JVEVNLCBpdGVtLm5hbWVdKSwgdGl0bGU6IGl0ZW0ubmFtZSwgbGlzdDogWwoJCQkJe3RleHQ6IFtpdGVtLm5hbWUsIGh0bWwuTEFCRUxdfSwge3RleHQ6IFsiOiAiLCBodG1sLkxBQkVMXX0sIHt0ZXh0OiBbKGl0ZW0udmFsdWV8fCIiKSsiIiwgaHRtbC5TUEFOLCBpdGVtLm5hbWVdfSwKCQkJXSwgfV0pCgkJfSkKCX0sCgoJdGFiczogZnVuY3Rpb24oY2FuLCBsaXN0LCBjYiwgY2JzLCBhY3Rpb24sIGVhY2gpIHsgYWN0aW9uID0gYWN0aW9ufHxjYW4uX2FjdGlvbgoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCBhY3Rpb24sIGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24obWV0YSkgewoJCQlyZXR1cm4ge3RleHQ6IFttZXRhLm5hbWUsIGh0bWwuRElWLCBodG1sLlRBQlNdLCB0aXRsZTogbWV0YS50ZXh0LCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGFjdGlvbiwgImRpdi50YWJzIiwgZXZlbnQudGFyZ2V0KQoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgbWV0YSkKCQkJfSwgX2luaXQ6IGZ1bmN0aW9uKGl0ZW0pIHsgY29uc3QgT1ZFUiA9ICJvdmVyIgoJCQkJZnVuY3Rpb24gY2xvc2UoaXRlbSkgeyB2YXIgbmV4dCA9IGl0ZW0ubmV4dFNpYmxpbmd8fGl0ZW0ucHJldmlvdXNTaWJsaW5nCgkJCQkJaXRlbS5fY2xvc2UoaXRlbSkgfHwgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaXRlbSksIG5leHQgJiYgbmV4dC5jbGljaygpCgkJCQl9CgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBpdGVtLCB7ZHJhZ2dhYmxlOiB0cnVlLCBfY2xvc2U6IGNicywKCQkJCQlvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCWNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIGtpdC5EaWN0KAoJCQkJCQkJImNsb3NlIHRhYiIsIGZ1bmN0aW9uKGV2ZW50KSB7IGNsb3NlKGl0ZW0pIH0sCgkJCQkJCQkiY2xvc2Ugb3RoZXIiLCBmdW5jdGlvbihldmVudCkgewoJCQkJCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGFjdGlvbiwgaHRtbC5ESVZfVEFCUywgZnVuY3Rpb24oX2l0ZW0pIHsgX2l0ZW0gPT0gaXRlbSB8fCBjbG9zZShfaXRlbSkgfSkKCQkJCQkJCX0sCgkJCQkJCQkiY2xvc2UgYWxsIiwgZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgYWN0aW9uLCBodG1sLkRJVl9UQUJTLCBjbG9zZSkgfQoJCQkJCQkpLCBbImNsb3NlIHRhYiIsICJjbG9zZSBvdGhlciIsICJjbG9zZSBhbGwiXSkKCQkJCQl9LAoJCQkJCW9uZHJhZ3N0YXJ0OiBmdW5jdGlvbihldmVudCkgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OyB0YXJnZXQuY2xpY2soKQoJCQkJCQlhY3Rpb24uX2Ryb3AgPSBmdW5jdGlvbihldmVudCwgYmVmb3JlKSB7IGFjdGlvbi5pbnNlcnRCZWZvcmUodGFyZ2V0LCBiZWZvcmUpIH0KCQkJCQl9LAoJCQkJCW9uZHJhZ292ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7IGV2ZW50LnByZXZlbnREZWZhdWx0KCksIGFjdGlvbi5fZHJvcChldmVudCwgZXZlbnQudGFyZ2V0KSB9LAoJCQkJCW9uZHJvcDogZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKSwgYWN0aW9uLl9kcm9wKGV2ZW50LCBldmVudC50YXJnZXQpIH0sCgkJCQl9KSwgY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBpdGVtLmNsaWNrKCkgfSkKCQkJCWNhbi5iYXNlLmlzRnVuYyhlYWNoKSAmJiBlYWNoKGl0ZW0pCgkJCX19CgkJfSkpLmZpcnN0Cgl9LAoJbGlzdDogZnVuY3Rpb24oY2FuLCByb290LCBjYiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl9vdXRwdXQKCQljYW4uY29yZS5MaXN0KHJvb3QubGlzdCwgZnVuY3Rpb24oaXRlbSkgewoJCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIGl0ZW0ubWV0YS5uYW1lXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGl0ZW0pIHx8IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCB1aS5saXN0KQoJCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5ESVZfSVRFTSwgZXZlbnQudGFyZ2V0KQoJCQl9fSwge3ZpZXc6IGh0bWwuTElTVH1dKTsgY2FuLm9uYXBwZW5kLmxpc3QoY2FuLCBpdGVtLCBjYiwgdWkubGlzdCkKCQl9KQoJfSwKCWl0ZW06IGZ1bmN0aW9uKGNhbiwgdHlwZSwgaXRlbSwgY2IsIGNicywgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl9vdXRwdXQKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW3R5cGUsIGh0bWwuRElWLCBpdGVtLm5pY2t8fGl0ZW0ubmFtZV0sCgkJCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCB1aS5maXJzdCkKCQkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCB0YXJnZXQsIGNhbi5jb3JlLktleXMoaHRtbC5ESVYsIHR5cGUpLCB1aS5maXJzdCkKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgeyBjYnMoZXZlbnQsIHVpLmZpcnN0KSB9LAoJCX1dKTsgcmV0dXJuIHVpLmZpcnN0Cgl9LAoJdHJlZTogZnVuY3Rpb24oY2FuLCBsaXN0LCBmaWVsZCwgc3BsaXQsIGNiLCB0YXJnZXQsIG5vZGUpIHsKCQlub2RlID0gbm9kZXx8eyIiOiB0YXJnZXR9OyBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbVtmaWVsZF0gJiYgY2FuLmNvcmUuTGlzdChpdGVtW2ZpZWxkXS5zcGxpdChzcGxpdCksIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpIHsgaWYgKCF2YWx1ZSkgeyByZXR1cm4gfQoJCQkJdmFyIGxhc3QgPSBhcnJheS5zbGljZSgwLCBpbmRleCkuam9pbihzcGxpdCksIG5hbWUgPSBhcnJheS5zbGljZSgwLCBpbmRleCsxKS5qb2luKHNwbGl0KQoJCQkJaWYgKG5vZGVbbmFtZV0pIHsgcmV0dXJuIH0KCQkJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIG5vZGVbbGFzdF0sIFt7dmlldzogIml0ZW0iLCBsaXN0OiBbe3ZpZXc6IFsic3dpdGNoIiwgImRpdiIsIChpbmRleD09YXJyYXkubGVuZ3RoLTE/IiI6IiYjODk2MzsiKV19LCB7dmlldzogWyJuYW1lIiwgaHRtbC5ESVYsIHZhbHVlKyhpbmRleD09YXJyYXkubGVuZ3RoLTE/IiI6IiIpXX1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWluZGV4IDwgYXJyYXkubGVuZ3RoIC0gMT8gY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIG5vZGVbbmFtZV0sIGZ1bmN0aW9uKCkgewoJCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdWlbInN3aXRjaCJdLCAib3BlbiIpCgkJCQkJfSwgZnVuY3Rpb24oKSB7CgkJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCB1aVsic3dpdGNoIl0sICJvcGVuIikKCQkJCQl9KTogY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihldmVudCwgaXRlbSkKCQkJCQlpZiAobm9kZVtuYW1lXS5jaGlsZEVsZW1lbnRDb3VudCA9PSAyKSB7IG5vZGVbbmFtZV0uZmlyc3RDaGlsZC5jbGljaygpIH0KCQkJCX19LCB7dmlldzogaHRtbC5MSVNULCBzdHlsZToge2Rpc3BsYXk6IGh0bWwuTk9ORX0sIF9pbml0OiBmdW5jdGlvbihsaXN0KSB7IGl0ZW0uZXhwYW5kICYmIGNhbi5wYWdlLnN0eWxlKGNhbiwgbGlzdCwgaHRtbC5ESVNQTEFZLCBodG1sLkJMT0NLKSB9fV0pCgkJCQlub2RlW25hbWVdID0gdWkubGlzdAoJCQl9KQoJCX0pOyByZXR1cm4gbm9kZQoJfSwKCWZpZWxkOiBmdW5jdGlvbihjYW4sIHR5cGUsIGl0ZW0sIHRhcmdldCkgeyB0eXBlID0gdHlwZXx8aHRtbC5QTFVHSU4sIGl0ZW0gPSBpdGVtfHx7fQoJCXZhciBuYW1lID0gKGl0ZW0ubmlja3x8aXRlbS5uYW1lfHwiIikuc3BsaXQoaWNlLlNQKVswXQoJCXZhciB0aXRsZSA9ICFpdGVtLmhlbHAgfHwgY2FuLnVzZXIubGFuZ3VhZ2UoY2FuKSA9PSAiZW4iPyBuYW1lOiBuYW1lKyIoIitpdGVtLmhlbHAuc3BsaXQoaWNlLlNQKVswXSsiKSIKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgW3t2aWV3OiBbY2FuLmJhc2Uuam9pbihbdHlwZXx8IiIsIGl0ZW0ubmFtZXx8IiIsIGl0ZW0ucG9zfHwiIl0pLCBodG1sLkZJRUxEU0VUXSwgbGlzdDogWwoJCQluYW1lICYmIHt0ZXh0OiBbdGl0bGUsIGh0bWwuTEVHRU5EXX0sIHt2aWV3OiBbaHRtbC5PUFRJT04sIGh0bWwuRk9STV19LCB7dmlldzogW2h0bWwuQUNUSU9OXX0sIHt2aWV3OiBbaHRtbC5PVVRQVVRdfSwge3ZpZXc6IFtodG1sLlNUQVRVU119LAoJCV19XSkKCX0sCglpbnB1dDogZnVuY3Rpb24oY2FuLCBpdGVtLCB2YWx1ZSwgdGFyZ2V0LCBzdHlsZSkgewoJCXN3aXRjaCAoaXRlbS50eXBlKSB7CgkJCWNhc2UgIiI6IHJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFtpdGVtXSkKCQkJY2FzZSBodG1sLlNQQUNFOiByZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IGNhbi5iYXNlLmpvaW4oW2h0bWwuSVRFTSwgaHRtbC5TUEFDRV0pfV0pCgkJfQoKCQl2YXIgaW5wdXQgPSBjYW4ucGFnZS5pbnB1dChjYW4sIGl0ZW0sIHZhbHVlKQoJCXZhciBiciA9IGlucHV0LnR5cGUgPT0gaHRtbC5URVhUQVJFQT8gW3t0eXBlOiBodG1sLkJSLCBzdHlsZToge2NsZWFyOiBodG1sLkJPVEh9fV06IFtdCgkJdmFyIHRpdGxlID0gY2FuLkNvbmYoW2N0eC5GRUFUVVJFLCBjaGF0LlRJVExFLCBpdGVtLm5hbWVdLmpvaW4oaWNlLlBUKSl8fCIiOyB0aXRsZSAmJiAoaW5wdXQudGl0bGUgPSB0aXRsZSkKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCAoW3t2aWV3OiBzdHlsZXx8Y2FuLmJhc2Uuam9pbihbaHRtbC5JVEVNLCBpdGVtLnR5cGVdKSwgb25rZXlkb3duOiBmdW5jdGlvbihldmVudCkgewoJCQlpdGVtLnR5cGUgPT0gaHRtbC5URVhUQVJFQSAmJiBldmVudC5rZXkgPT0gbGFuZy5UQUIgICYmIGNhbi5vbmtleW1hcC5pbnNlcnRUZXh0KGV2ZW50LnRhcmdldCwgIlx0IikKCQkJaXRlbS50eXBlID09IGh0bWwuVEVYVCAmJiBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbiksIGNhbi5vbm1vdGlvbi5zZWxlY3RGaWVsZChldmVudCwgY2FuKQoJCX0sIGxpc3Q6IFtpbnB1dF19XSkuY29uY2F0KGJyKSlbaXRlbS5uYW1lXQoJfSwKCXRhYmxlOiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCwgc29ydCkgeyBpZiAobXNnLkxlbmd0aCgpID09IDApIHsgcmV0dXJuIH0KCQl2YXIgdGFibGUgPSBjYW4ucGFnZS5BcHBlbmRUYWJsZShjYW4sIG1zZywgdGFyZ2V0fHxjYW4uX291dHB1dCwgbXNnLmFwcGVuZCwgY2J8fGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkgewoJCQlpZiAobXNnLmFwcGVuZC5sZW5ndGggPT0gMiAmJiBtc2cuYXBwZW5kWzBdID09IG1kYi5LRVkgJiYgbXNnLmFwcGVuZFsxXSA9PSBtZGIuVkFMVUUpIHsKCQkJCWlmIChrZXkgPT0gbWRiLlZBTFVFKSB7IGtleSA9IGxpbmUua2V5IH0KCQkJCWxpbmUgPSB7fSwgY2FuLmNvcmUuTGlzdChhcnJheSwgZnVuY3Rpb24oaXRlbSkgeyBsaW5lW2l0ZW0ua2V5XSA9IGl0ZW0udmFsdWUgfSkKCQkJfQoKCQkJaWYgKGtleSA9PSAiZXh0cmEuY21kIikgewoJCQkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHtjdHg6IGxpbmVbImV4dHJhLmN0eCJdLCBjbWQ6IGxpbmVbImV4dHJhLmNtZCJdLCBhcmc6IGxpbmVbImV4dHJhLmFyZyJdfSwgZnVuY3Rpb24oc3ViKSB7CgkJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGxpbmUsIGNhbi5PcHRpb24oKSkKCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIGNhbi5jb3JlLktleXMobGluZVsiZXh0cmEuY3R4Il0sIGxpbmVbImV4dHJhLmNtZCJdKV0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJCQl9CgkJCQl9LCB0YXJnZXR8fGNhbi5fb3V0cHV0KQoJCQl9CgoJCQlmdW5jdGlvbiBydW4oY21kcykgeyB2YXIgbXNnID0gY2FuLnN1cC5yZXF1ZXN0KGV2ZW50LCBsaW5lLCBjYW4uT3B0aW9uKCkpCgkJCQlyZXR1cm4gY2FuLnJ1bihldmVudCwgY21kcywgZnVuY3Rpb24obXNnKSB7CgkJCQkJaWYgKGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4uc3VwLCBjaGF0Lk9OSU1QT1JULCBpY2UuTVNHX1BST0NFU1NdLCB7Y2FuOiBjYW4uc3VwLCBtc2c6IG1zZ30pKSB7IHJldHVybiB9CgkJCQkJaWYgKG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKSAhPSAiIikgewoJCQkJCQljYW4ub25hcHBlbmQuX291dHB1dChjYW4uc3VwLCBtc2csIG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKSkKCQkJCQl9IGVsc2UgaWYgKG1zZy5SZXN1bHQoKS5sZW5ndGggPiAwIHx8IG1zZy5MZW5ndGgoKSA+IDApIHsKCQkJCQkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCQkJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLlVwZGF0ZSgpCgkJCQkJfQoJCQkJfSwgdHJ1ZSkKCQkJfQoKCQkJcmV0dXJuIHt0ZXh0OiBbdmFsdWUsIGh0bWwuVERdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJCQlpZiAodGFyZ2V0LnRhZ05hbWUgPT0gIklOUFVUIiAmJiB0YXJnZXQudHlwZSA9PSBodG1sLkJVVFRPTikgeyByZXR1cm4gcnVuKFtjdHguQUNUSU9OLCB0YXJnZXQubmFtZV0pIH0KCQkJCWlmIChrZXkgPT0gbWRiLkhBU0ggJiYgY2FuLnVzZXIubW9kLmlzRGl2KSB7IHJldHVybiBjYW4udXNlci5qdW1wcygiL2NoYXQvZGl2LyIrdmFsdWUpIH0KCQkJCWNhbi5zdXAub25hY3Rpb24uY2hhbmdlKGV2ZW50LCBjYW4uc3VwLCBrZXksIGV2ZW50LnRhcmdldC5pbm5lclRleHQpCgoJCQl9LCBvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBpZiAoW21kYi5LRVldLmluZGV4T2Yoa2V5KSA+IC0xKSB7IHJldHVybiB9CgkJCQl2YXIgaXRlbSA9IGNhbi5jb3JlLkxpc3QoY2FuLkNvbmYoImZlYXR1cmUuaW5zZXJ0IiksIGZ1bmN0aW9uKGl0ZW0pIHsgaWYgKGl0ZW0ubmFtZSA9PSBrZXkpIHsgcmV0dXJuIGl0ZW0gfSB9KVswXXx8e25hbWU6IGtleSwgdmFsdWU6IHZhbHVlfQoJCQkJaXRlbS5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgY2FuLnJ1bihjYW4ucmVxdWVzdChldmVudCwgbGluZSkuX2V2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkgfQoJCQkJY2FuLm9ubW90aW9uLm1vZGlmeXMoY2FuLCBldmVudC50YXJnZXQsIGZ1bmN0aW9uKGV2ZW50LCB2YWx1ZSwgb2xkKSB7IHJ1bihbY3R4LkFDVElPTiwgbWRiLk1PRElGWSwga2V5LCB2YWx1ZV0pIH0sIGl0ZW0pCgkJCX19CgkJfSk7IHRhYmxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIHRhYmxlLCB7Y2xhc3NOYW1lOiBjaGF0LkNPTlRFTlR9KQoJCWlmIChtc2cuYXBwZW5kICYmIG1zZy5hcHBlbmRbbXNnLmFwcGVuZC5sZW5ndGgtMV0gPT0gImFjdGlvbiIpIHsgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhYmxlLCAiYWN0aW9uIikgfQoJCWNhbi5fdGFibGUgPSB0YWJsZSwgY2FuLnN1cCAmJiAoY2FuLnN1cC5fdGFibGUgPSB0YWJsZSkKCQlyZXR1cm4gc29ydCAmJiBjYW4ucGFnZS5SYW5nZVRhYmxlKGNhbiwgdGFibGUsIHNvcnQpLCB0YWJsZQoJfSwKCWJvYXJkOiBmdW5jdGlvbihjYW4sIHRleHQsIHRhcmdldCkgeyB0ZXh0ICYmIHRleHQuUmVzdWx0ICYmICh0ZXh0ID0gdGV4dC5SZXN1bHQoKSk7IGlmICghdGV4dCkgeyByZXR1cm4gfQoJCXZhciBjb2RlID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgW3t0ZXh0OiBbY2FuLnBhZ2UuQ29sb3IodGV4dCksIGh0bWwuRElWLCBodG1sLkNPREVdfV0pLmNvZGUKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjb2RlLCBodG1sLklOUFVUX0JVVFRPTiwgZnVuY3Rpb24odGFyZ2V0KSB7CgkJCXRhcmdldC5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsgdmFyIG1zZyA9IGNhbi5zdXAucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCQkJcmV0dXJuIGNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCB0YXJnZXQubmFtZV0sIGZ1bmN0aW9uKG1zZykgeyBjYW4ucnVuKCkgfSwgdHJ1ZSkKCQkJfQoJCX0pCgkJcmV0dXJuIChjb2RlLnNjcm9sbEJ5ICYmIGNvZGUuc2Nyb2xsQnkoMCwgMTAwMDApKSwgY29kZQoJfSwKCXBhcnNlOiBmdW5jdGlvbihjYW4sIGxpc3QsIHRhcmdldCwga2V5cywgZGF0YSwgdHlwZSkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi5fb3V0cHV0LCBkYXRhID0gZGF0YXx8e30KCQlpZiAoIWxpc3QpIHsgcmV0dXJuIH0gZWxzZSBpZiAoY2FuLmJhc2UuaXNBcnJheShsaXN0KSkgewoJCQlyZXR1cm4gY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihtZXRhLCBpbmRleCkgewoJCQkJcmV0dXJuIGNhbi5vbmFwcGVuZC5wYXJzZShjYW4sIG1ldGEsIHRhcmdldCwga2V5cywgZGF0YSwgdHlwZSkKCQkJfSkKCgkJfSBlbHNlIGlmIChjYW4uYmFzZS5pc1N0cmluZyhsaXN0KSkgewoJCQl2YXIgbHMgPSBjYW4uY29yZS5TcGxpdChsaXN0LCAiIiwgIjo9QCIpOyBpZiAobHMubGVuZ3RoID09IDEpIHsKCQkJCXZhciBtZXRhID0gdHlwZT8ge3R5cGU6IHR5cGUsIG5hbWU6IGxzWzBdfToge3R5cGU6IGxzWzBdfQoJCQl9IGVsc2UgewoJCQkJdmFyIG1ldGEgPSB7bmFtZTogbHNbMF19OyBmb3IgKHZhciBpID0gMTsgaSA8IGxzLmxlbmd0aDsgaSArPSAyKSB7IHN3aXRjaCAobHNbaV0pIHsKCQkJCQljYXNlICI6IjogbWV0YS50eXBlID0gbHNbaSsxXTsgYnJlYWsKCQkJCQljYXNlICI9IjogbWV0YS52YWx1ZSA9IGxzW2krMV07IGJyZWFrCgkJCQkJY2FzZSAiQCI6IG1ldGEuYWN0aW9uID0gbHNbaSsxXTsgYnJlYWsKCQkJCX0gfQoJCQl9CgoJCX0gZWxzZSBpZiAoY2FuLmJhc2UuaXNPYmplY3QobGlzdCkpIHsgdmFyIG1ldGEgPSBsaXN0IH0KCgkJa2V5cyA9IGNhbi5jb3JlLktleXMoa2V5cywgbWV0YS5uYW1lfHxtZXRhLnR5cGUpIAoJCXZhciBpdGVtID0ge3ZpZXc6IG1ldGEudHlwZX0sIGluaXQsIHN1YnR5cGU7IHN3aXRjaCAobWV0YS50eXBlKSB7CgkJCWNhc2UgaHRtbC5IRUFEOiBzdWJ0eXBlID0gIm1lbnUiLCBkYXRhID0ge30KCQkJCWluaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsgZGF0YS5oZWFkID0gdGFyZ2V0CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgaHRtbC5MQVlPVVQpCgkJCQl9CgkJCQlicmVhawoJCQljYXNlIGh0bWwuTEVGVDogc3VidHlwZSA9ICJpdGVtIgoJCQkJaW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgewoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YXJnZXQsIGh0bWwuTEFZT1VUKQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgdmFyIGhlaWdodCA9IHRhcmdldC5wYXJlbnROb2RlLm9mZnNldEhlaWdodAoJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQucGFyZW50Tm9kZSwgY2FuLnBhZ2UuS2V5cyhodG1sLkRJVl9MQVlPVVRfSEVBRCwgaHRtbC5ESVZfTEFZT1VUX0ZPT1QpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCQloZWlnaHQgLT0gaXRlbS5vZmZzZXRIZWlnaHQKCQkJCQkJfSksIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkhFSUdIVCwgaGVpZ2h0KQoJCQkJCX0pCgkJCQl9CgkJCQlicmVhawoJCQljYXNlIGh0bWwuTUFJTjoKCQkJCWluaXQgPSBmdW5jdGlvbih0YXJnZXQpIHsgZGF0YS5tYWluID0gdGFyZ2V0CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgaHRtbC5MQVlPVVQpCgkJCQkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyB2YXIgaGVpZ2h0ID0gdGFyZ2V0LnBhcmVudE5vZGUub2Zmc2V0SGVpZ2h0CgkJCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldC5wYXJlbnROb2RlLCBjYW4ucGFnZS5LZXlzKGh0bWwuRElWX0xBWU9VVF9IRUFELCBodG1sLkRJVl9MQVlPVVRfRk9PVCksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQkJCWhlaWdodCAtPSBpdGVtLm9mZnNldEhlaWdodAoJCQkJCQl9KSwgY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuSEVJR0hULCBoZWlnaHQpCgkJCQkJfSkKCgkJCQkJY2FuLmNvcmUuVGltZXIoMTAwLCBmdW5jdGlvbigpIHsKCQkJCQkJdmFyIHdpZHRoID0gdGFyZ2V0LnBhcmVudE5vZGUub2Zmc2V0V2lkdGgKCQkJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LnBhcmVudE5vZGUsIGh0bWwuRElWX0xBWU9VVF9MRUZULCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCQl3aWR0aCAtPSBpdGVtLm9mZnNldFdpZHRoKzEKCQkJCQkJfSksIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLldJRFRILCB3aWR0aCkKCQkJCQl9KQoKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5GT09UOgoJCQkJaW5pdCA9IGZ1bmN0aW9uKHRhcmdldCkgeyBkYXRhLmZvb3QgPSB0YXJnZXQKCQkJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgdGFyZ2V0LCBodG1sLkxBWU9VVCkKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgaHRtbC5UQUJTOgoJCQkJaXRlbS5saXN0ID0gW3t2aWV3OiAibmFtZSJ9LCB7dmlldzogaHRtbC5QQUdFfV0sIGl0ZW0uX2luaXQgPSBmdW5jdGlvbihfdGFyZ2V0LCB1aSkgewoJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLnBhZ2UsIFt7dmlldzogaHRtbC5JTlBVVCwgbGlzdDogW3t0eXBlOiBodG1sLklOUFVULCBvbmtleXVwOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBfdGFyZ2V0LCBbaHRtbC5ESVZfUEFHRSwgaHRtbC5ESVZfSVRFTV0sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5zZXQoY2FuLCBpdGVtLCBodG1sLkhJREUsIGl0ZW0uaW5uZXJUZXh0LmluZGV4T2YoZXZlbnQudGFyZ2V0LnZhbHVlKSA9PSAtMSkKCQkJCQkJfSkKCQkJCQl9fV19XSkKCQkJCQljYW4uY29yZS5MaXN0KG1ldGEubGlzdCwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdWkubmFtZSwgW3t2aWV3OiBbaHRtbC5JVEVNLCBodG1sLkRJViwgaXRlbS5uYW1lfHxpdGVtXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBfdGFyZ2V0LCBbW2h0bWwuRElWX1BBR0UsIGh0bWwuRElWX0xJU1RdXSwgaW5kZXgpCgkJCQkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgdWkubmFtZSwgaHRtbC5ESVZfSVRFTSwgaW5kZXgpCgkJCQkJCQl1aS5wYWdlLnNjcm9sbFRvKDAsIDApCgkJCQkJCX19XSkKCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdWkucGFnZSwgW3t2aWV3OiBbaHRtbC5JVEVNLCBodG1sLkRJViwgaXRlbS5uYW1lXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5uZWcoY2FuLCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcsIGh0bWwuU0VMRUNUKQoJCQkJCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIHVpLm5hbWUsIGh0bWwuRElWX0lURU0sIGluZGV4KQoJCQkJCQl9fSwge3ZpZXc6IFtodG1sLkxJU1RdLCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCQkJCQljYW4ub25hcHBlbmQucGFyc2UoY2FuLCBpdGVtLmxpc3QsIHRhcmdldCwgY2FuLmNvcmUuS2V5cyhrZXlzLCBpdGVtLm5hbWUpLCBkYXRhLCBodG1sLklURU0pCgkJCQkJCX19XSkKCQkJCQl9KQoJCQkJCWNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7IHZhciBoZWlnaHQgPSB0YXJnZXQub2Zmc2V0SGVpZ2h0CgkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdWkucGFnZSwgaHRtbC5IRUlHSFQsIGhlaWdodC0xMC0obWV0YS5zdHlsZT8gMDogdWkubmFtZS5vZmZzZXRIZWlnaHQpKQoJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIF90YXJnZXQsIGh0bWwuSEVJR0hULCBoZWlnaHQtMTApCgkJCQkJfSksIGNhbi5wYWdlLlNlbGVjdChjYW4sIHVpLm5hbWUsIGh0bWwuRElWX0lURU0pWzBdLmNsaWNrKCkKCQkJCX0KCQkJCWJyZWFrCgkJCWNhc2UgInVzZXJuYW1lIjoKCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgWwoJCQkJCWNhbi5iYXNlLkNvcHkoe3ZpZXc6IFsidXNlcm5hbWUiLCAiZGl2Il0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl9LCBsaXN0OiBbe3ZpZXc6IFsic29tZSIsIGh0bWwuRElWLCBjYW4udXNlci5pbmZvLnVzZXJuaWNrXX0sIHtpbWc6IGNhbi51c2VyLmluZm8uYXZhdGFyfV19KV0pCgkJCQlyZXR1cm4KCQl9CgoJCWl0ZW0uX2luaXQgPSBpdGVtLl9pbml0fHxmdW5jdGlvbih0YXJnZXQpIHsKCQkJbWV0YS5saXN0ICYmIGNhbi5vbmFwcGVuZC5wYXJzZShjYW4sIG1ldGEubGlzdCwgdGFyZ2V0LCBrZXlzLCBkYXRhLCB0eXBlfHxzdWJ0eXBlKQoJCQljYW4uYmFzZS5pc0Z1bmMoaW5pdCkgJiYgaW5pdCh0YXJnZXQpLCBjYW4uYmFzZS5pc0Z1bmMobWV0YS5pbml0KSAmJiBtZXRhLmluaXQodGFyZ2V0KQoJCX0KCQlpZiAoY2FuLmJhc2UuaXNTdHJpbmcobWV0YS5zdHlsZSkpIHsgaXRlbS5jbGFzc05hbWUgPSBtZXRhLnN0eWxlIH0KCQlpZiAoY2FuLmJhc2UuaXNPYmplY3QobWV0YS5zdHlsZSkpIHsgaXRlbS5zdHlsZSA9IG1ldGEuc3R5bGUgfQoKCQlpZiAoKG1ldGEudHlwZXx8dHlwZSkgPT0gaHRtbC5NRU5VKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW2Nhbi5iYXNlLkNvcHkoe3ZpZXc6IFtodG1sLk1FTlUsIGh0bWwuRElWLCBtZXRhLm5hbWV8fG1ldGFdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJaWYgKG1ldGEubGlzdCAmJiBtZXRhLmxpc3QubGVuZ3RoID4gMCkgeyByZXR1cm4gfQoJCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIG1ldGEubmFtZSkgfHwgY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGh0bWwuTUVOVSwgY2FuLnJlcXVlc3QoZXZlbnQsIHtpdGVtOiBtZXRhLm5hbWV9KSkKCQkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJbWV0YS5saXN0ICYmIG1ldGEubGlzdC5sZW5ndGggPiAwICYmIGNhbi51c2VyLmNhcnRlKGV2ZW50LCBjYW4sIHt9LCBtZXRhLmxpc3QsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGl0ZW0pIHx8IGNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBtZXRhLm5hbWUsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7aXRlbTogaXRlbX0pKQoJCQkJfSkKCQkJfX0pXSkuZmlyc3QKCQkJcmV0dXJuCgkJfQoJCWlmICgodHlwZXx8c3VidHlwZSkgPT0gaHRtbC5JVEVNKSB7IGl0ZW0udmlldyA9IGl0ZW0udmlld3x8aHRtbC5MSVNUCgkJCWlmIChtZXRhLmFjdGlvbiA9PSAiYXV0byIpIHsKCQkJCW1ldGEuaW5pdCA9IG1ldGEuaW5pdHx8ZnVuY3Rpb24oaXRlbSkgeyBjYW4uY29yZS5UaW1lcigxMDAsIGZ1bmN0aW9uKCkgeyBpdGVtLmNsaWNrKCkgfSkgfQoJCQl9CgkJCWlmIChkZWNvZGVVUklDb21wb25lbnQobG9jYXRpb24uaGFzaCkgPT0gIiMiK2Nhbi5jb3JlLktleXMoa2V5cywgaXRlbS5uYW1lKSkgewoJCQkJbWV0YS5pbml0ID0gbWV0YS5pbml0fHxmdW5jdGlvbihpdGVtKSB7IGNhbi5jb3JlLlRpbWVyKDMwMCwgZnVuY3Rpb24oKSB7IGl0ZW0uY2xpY2soKSB9KSB9CgkJCX0gCgoJCQl2YXIgX2l0ZW0gPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFtjYW4uYmFzZS5Db3B5KHt2aWV3OiBbaHRtbC5JVEVNLCBodG1sLkRJViwgbWV0YS5uYW1lfHxtZXRhXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWxvY2F0aW9uLmhhc2ggPSBjYW4uY29yZS5LZXlzKGtleXMsIGl0ZW0ubmFtZSkKCgkJCQlpZiAobWV0YS5hY3Rpb24gPT0gIm9wZW4iKSB7CgkJCQkJaWYgKGNhbi5taXNjLlNlYXJjaChjYW4sICJwb2QiKSkgewoJCQkJCQljYW4udXNlci5vcGVuKCIvY2hhdC9wb2QvIitjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikrIi9jbWQvIittZXRhLmluZGV4KQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNhbi51c2VyLm9wZW4oIi9jaGF0L2NtZC8iK21ldGEuaW5kZXgpCgkJCQkJfQoJCQkJCXJldHVybgoJCQkJfQoJCQkJaWYgKG1ldGEuYWN0aW9uID09ICJwdXNoIikgewoJCQkJCWlmIChjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikpIHsKCQkJCQkJY2FuLnVzZXIuanVtcHMoIi9jaGF0L3BvZC8iK2Nhbi5taXNjLlNlYXJjaChjYW4sICJwb2QiKSsiL2NtZC8iK21ldGEuaW5kZXgpCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLnVzZXIuanVtcHMoIi9jaGF0L2NtZC8iK21ldGEuaW5kZXgpCgkJCQkJfQoJCQkJCXJldHVybgoJCQkJfQoJCQkJc3dpdGNoIChtZXRhLnR5cGUpIHsKCQkJCQljYXNlIGh0bWwuUExVR0lOOgoJCQkJCQlpZiAoY2FuLm9ubW90aW9uLmNhY2hlKGNhbiwgZnVuY3Rpb24oKSB7IHJldHVybiBrZXlzIH0sIGRhdGEubWFpbikpIHsgYnJlYWsgfQoJCQkJCQlpZiAoY2FuLmJhc2UuRXh0KG1ldGEuaW5kZXgpID09IG5mcy5aTUwgfHwgY2FuLmJhc2UuRXh0KG1ldGEuaW5kZXgpID09IG5mcy5JTUwpIHsKCQkJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGRhdGEubWFpbiwgW3t0eXBlOiBodG1sLklGUkFNRSwgc3JjOiAiL2NoYXQvY21kLyIrbWV0YS5pbmRleCwKCQkJCQkJCQloZWlnaHQ6IGRhdGEubWFpbi5vZmZzZXRIZWlnaHQsIHdpZHRoOiBkYXRhLm1haW4ub2Zmc2V0V2lkdGgsCgkJCQkJCQl9XSkKCQkJCQkJCWJyZWFrCgkJCQkJCX0KCgkJCQkJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCB7aW5kZXg6IG1ldGEuaW5kZXgsIGFyZ3M6IGNhbi5iYXNlLk9iaihtZXRhLmFyZ3MpfSwgZnVuY3Rpb24oc3ViKSB7CgkJCQkJCQlzdWIuQ29uZkhlaWdodChkYXRhLm1haW4ub2Zmc2V0SGVpZ2h0LTE2MCkKCQkJCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgewoJCQkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKGRhdGEubWFpbi5vZmZzZXRXaWR0aC00MCkpCgkJCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIHN1Yi5faW5kZXh8fG1ldGEuaW5kZXhdLCBjbWRzKSwgZnVuY3Rpb24obXNnKSB7CgkJCQkJCQkJCWNiKG1zZyksIGNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsKCQkJCQkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl90YWJsZSwgaHRtbC5NQVhfSEVJR0hULCBkYXRhLm1haW4ub2Zmc2V0SGVpZ2h0LTE1MCkKCQkJCQkJCQkJfSkKCQkJCQkJCQl9LCB0cnVlKQoJCQkJCQkJfQoJCQkJCQl9LCBkYXRhLm1haW4pCgkJCQkJZGVmYXVsdDoKCQkJCQkJbWV0YS5saXN0ICYmIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcpCgkJCQl9CgkJCX19KV0pLmZpcnN0OyBjYW4uY29yZS5JdGVtQ0IobWV0YSwgZnVuY3Rpb24oa2V5LCBjYikgeyBfaXRlbVtrZXldID0gY2FuLmJhc2UuaXNGdW5jKGNiKT8gY2I6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2IsIGNhbi5yZXF1ZXN0KGV2ZW50KSkKCQkJfSB9KQoJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IG1ldGEuaW5pdCAmJiBtZXRhLmluaXQoX2l0ZW0pIH0pCgkJCWlmICghbWV0YS5saXN0KSB7IHJldHVybiB9CgkJfQoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFtpdGVtXSkuZmlyc3QKCX0sCglfcGFyc2U6IGZ1bmN0aW9uKGNhbiwgdGV4dCkgeyB2YXIgc3RhY2sgPSBbe19kZWVwOiAtMSwgbGlzdDogW119XQoJCWNhbi5jb3JlLkxpc3QoY2FuLmNvcmUuU3BsaXQodGV4dCwgaWNlLk5MLCBpY2UuTkwsIGljZS5OTCksIGZ1bmN0aW9uKGxpbmUpIHsgaWYgKGxpbmUgPT0gIiIpIHsgcmV0dXJuIH0KCQkJdmFyIGRlZXAgPSAwOyBmb3IgKHZhciBpID0gMDsgaSA8IGxpbmUubGVuZ3RoOyBpKyspIHsgaWYgKGxpbmVbaV0gPT0gaWNlLlNQKSB7IGRlZXArKyB9IGVsc2UgaWYgKGxpbmVbaV0gPT0gaWNlLlRCKSB7IGRlZXAgKz0gNCB9IGVsc2UgeyBicmVhayB9IH0KCQkJZm9yICh2YXIgaSA9IHN0YWNrLmxlbmd0aC0xOyBpID4gMDsgaS0tKSB7IGlmIChkZWVwIDw9IHN0YWNrW2ldLl9kZWVwKSB7IHN0YWNrLnBvcCgpIH0gfQoKCQkJdmFyIGl0ZW0gPSB7X2RlZXA6IGRlZXAsIGxpc3Q6IFtdfTsgdmFyIGxpc3QgPSBzdGFja1tzdGFjay5sZW5ndGgtMV07IGxpc3QubGlzdC5wdXNoKGl0ZW0pOyBpZiAoZGVlcCA+IGxpc3QuX2RlZXApIHsgc3RhY2sucHVzaChpdGVtKSB9CgkJCXZhciBscyA9IGNhbi5jb3JlLlNwbGl0KGxpbmUpOyBzd2l0Y2ggKGxzWzBdKSB7CgkJCQljYXNlIGh0bWwuSEVBRDoKCQkJCWNhc2UgaHRtbC5MRUZUOgoJCQkJY2FzZSBodG1sLk1BSU46CgkJCQljYXNlIGh0bWwuRk9PVDoKCQkJCWNhc2UgaHRtbC5UQUJTOgoJCQkJY2FzZSAidXNlcm5hbWUiOgoJCQkJY2FzZSBodG1sLk1FTlU6IGl0ZW0udHlwZSA9IGxzWzBdOyBicmVhawoJCQkJZGVmYXVsdDogaXRlbS5uYW1lID0gbHNbMF07IGJyZWFrCgkJCX0KCQkJZm9yICh2YXIgaSA9IDE7IGkgPCBscy5sZW5ndGg7IGkgKz0gMikgeyBjYW4uY29yZS5WYWx1ZShpdGVtLCBsc1tpXSwgbHNbaSsxXSkKCQkJCWlmIChsc1tpXSA9PSBjdHguSU5ERVgpIHsgaXRlbS50eXBlID0gaXRlbS50eXBlfHxodG1sLlBMVUdJTiB9CgkJCX0KCQl9KQoJCXJldHVybiB7dHlwZTogImRlbW8iLCBzdHlsZToge2hlaWdodDogY2FuLkNvbmZIZWlnaHQoKXx8d2luZG93LmlubmVySGVpZ2h0fSwgbGlzdDogc3RhY2tbMF0ubGlzdH0KCX0sCgoJX3BsdWdpbjogZnVuY3Rpb24oY2FuLCB2YWx1ZSwgbWV0YSwgY2IsIHRhcmdldCkgewoJCW1ldGEuZmVhdHVyZSA9IGNhbi5iYXNlLmdldFZhbGlkKG1ldGEuZmVhdHVyZSwgY2FuLmJhc2UuT2JqKHZhbHVlLm1ldGEpKXx8e30KCQltZXRhLmlucHV0cyA9IGNhbi5iYXNlLmdldFZhbGlkKG1ldGEuaW5wdXRzLCBjYW4uYmFzZS5PYmoodmFsdWUubGlzdCkpfHxbXQoJCW1ldGEuYXJncyA9IGNhbi5iYXNlLmdldFZhbGlkKGNhbi5iYXNlLk9iaihtZXRhLmFyZ3MpLCBjYW4uYmFzZS5PYmoobWV0YS5hcmcpLCBjYW4uYmFzZS5PYmoodmFsdWUuYXJncyksIGNhbi5iYXNlLk9iaih2YWx1ZS5hcmcpKXx8W10KCQltZXRhLmRpc3BsYXkgPSBtZXRhLmRpc3BsYXl8fHZhbHVlLmRpc3BsYXkKCgkJbWV0YS5oZWlnaHQgPSBtZXRhLmhlaWdodHx8Y2FuLkNvbmYoaHRtbC5IRUlHSFQpCgkJbWV0YS53aWR0aCA9IG1ldGEud2lkdGh8fGNhbi5Db25mKGh0bWwuV0lEVEgpCgoJCW1ldGEudHlwZSA9IG1ldGEudHlwZXx8Y2hhdC5QTFVHSU4KCQltZXRhLm5hbWUgPSBtZXRhLm5hbWV8fHZhbHVlLm5hbWUKCQltZXRhLmhlbHAgPSBtZXRhLmhlbHB8fHZhbHVlLmhlbHAKCgkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgbWV0YSwgW2NoYXQuUExVR0lOX1NUQVRFX0pTXSwgZnVuY3Rpb24oc3ViLCBza2lwKSB7CgkJCXN1Yi5faW5kZXggPSB2YWx1ZS5pbmRleHx8bWV0YS5pbmRleAoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IGNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBzdWIuX2luZGV4XSwgY21kcyksIGNiKSB9CgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViLCBtZXRhLCBza2lwKQoJCX0sIHRhcmdldHx8Y2FuLl9vdXRwdXQpCgl9LAoJcGx1Z2luOiBmdW5jdGlvbihjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgbWV0YSA9IG1ldGF8fHt9LCBtZXRhLmluZGV4ID0gbWV0YS5pbmRleHx8Y2FuLmNvcmUuS2V5cyhtZXRhLmN0eCwgbWV0YS5jbWQpCgkJdmFyIHAgPSBjYW4ub25lbmdpbmUucGx1Z2luLm1ldGFbbWV0YS5pbmRleF0sIHJlcyA9IHt9OyBmdW5jdGlvbiBjYnMoc3ViLCBtZXRhLCBza2lwKSB7IHJlcy5fX3Byb3RvX18gPSBzdWIsIGNiKHN1YiwgbWV0YSwgc2tpcCkgfQoJCShtZXRhLm1ldGEgfHwgbWV0YS5pbnB1dHMgJiYgbWV0YS5pbnB1dHMubGVuZ3RoID4gMCk/IC8qIOWxgOmDqOWRveS7pCAqLyBjYW4ub25hcHBlbmQuX3BsdWdpbihjYW4sIHttZXRhOiBtZXRhLm1ldGEsIGxpc3Q6IG1ldGEubGlzdH0sIG1ldGEsIGNicywgdGFyZ2V0KToKCQkJcD8gLyog5YmN56uv5ZG95LukICovIGNhbi5vbmFwcGVuZC5fcGx1Z2luKGNhbiwge25hbWU6IG1ldGEuaW5kZXgsIGhlbHA6IHAuaGVscCwgbWV0YTogcC5tZXRhLCBsaXN0OiBwLmxpc3R9LCBtZXRhLCBmdW5jdGlvbihzdWIsIG1ldGEsIHNraXApIHsKCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsKCQkJCQlpZiAocC5tZXRhICYmIHAubWV0YVtjbWRzWzFdXSAmJiBjbWRzWzBdID09IGN0eC5BQ1RJT04pIHsKCQkJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMocC5tZXRhW2NtZHNbMV1dLCB7Y2FuOiBzdWIsIG1zZzogY2FuLnJlcXVlc3QoZXZlbnQpLCBjbWRzOiBjbWRzLnNsaWNlKDIpLCBjYjogY2J9KQoJCQkJCX0gZWxzZSBpZiAocC5tZXRhICYmIHAubWV0YVtjbWRzWzBdXSkgewoJCQkJCQljYW4uY29yZS5DYWxsRnVuYyhwLm1ldGFbY21kc1swXV0sIHtjYW46IHN1YiwgbXNnOiBjYW4ucmVxdWVzdChldmVudCksIGNtZHM6IGNtZHMuc2xpY2UoMSksIGNiOiBjYn0pCgkJCQkJfSBlbHNlIHsKCQkJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMocCwge2Nhbjogc3ViLCBtc2c6IGNhbi5yZXF1ZXN0KGV2ZW50KSwgY21kczogY21kcywgY2I6IGNifSkKCQkJCQl9CgkJCQl9CgkJCQljYW4uYmFzZS5pc0Z1bmMoY2JzKSAmJiBjYnMoc3ViLCBtZXRhLCBza2lwKQoJCQl9LCB0YXJnZXQpOiAvKiDlkI7nq6/lkb3ku6QgKi8gY2FuLnJ1bihjYW4ucmVxdWVzdCh7fSwgbWV0YSkuX2V2ZW50LCBbY3R4LkFDVElPTiwgY3R4LkNPTU1BTkQsIG1ldGEuaW5kZXhdLCBmdW5jdGlvbihtc2cpIHsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7CgkJCQljYW4ub25hcHBlbmQuX3BsdWdpbihjYW4sIHZhbHVlLCBtZXRhLCBjYnMsIHRhcmdldCkKCQkJfSkgfSwgdHJ1ZSkKCQlyZXR1cm4gcmVzCgl9LAoJZmlndXJlOiBmdW5jdGlvbihjYW4sIG1ldGEsIHRhcmdldCwgY2JzKSB7IGlmIChbaHRtbC5CVVRUT04sIGh0bWwuU0VMRUNUXS5pbmRleE9mKG1ldGEudHlwZSkgPiAtMSkgeyByZXR1cm4gfQoJCXZhciBpbnB1dCA9IG1ldGEuYWN0aW9ufHxtZGIuS0VZOyBpbnB1dCAhPSBpY2UuQVVUTyAmJiBjYW4ucmVxdWlyZShbIi9wbHVnaW4vaW5wdXQvIitpbnB1dCsiLmpzIl0sIGZ1bmN0aW9uKGNhbikgewoJCQljYW4uY29yZS5JdGVtQ0IoY2FuLm9uZmlndXJlW2lucHV0XSwgZnVuY3Rpb24oa2V5LCBvbikgeyB2YXIgbGFzdCA9IHRhcmdldFtrZXldOyB0YXJnZXRba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IG9uKGV2ZW50LCBjYW4sIG1ldGEsIGZ1bmN0aW9uKGNiKSB7CgkJCQlpZiAodGFyZ2V0Ll9jYW4pIHsgcmV0dXJuIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IodGFyZ2V0Ll9jYW4sIGNicykgfQoJCQkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwge3R5cGU6IGh0bWwuSU5QVVQsIG5hbWU6IGlucHV0LCBwb3M6IGNoYXQuRkxPQVR9LCBbIi9wbHVnaW4vaW5wdXQvIitpbnB1dCsiLmpzIl0sIGZ1bmN0aW9uKHN1YikgeyBzdWIuQ29uZihtZXRhKQoJCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KGV2ZW50LCBjYW4uT3B0aW9uKCkpOyAobWV0YS5ydW58fGNhbi5ydW4pKGV2ZW50LCBjbWRzLCBjYiwgdHJ1ZSkgfQoJCQkJCXN1Yi5jbG9zZSA9IGZ1bmN0aW9uKCkgeyBjYW4ucGFnZS5SZW1vdmUoY2FuLCBzdWIuX3RhcmdldCksIGRlbGV0ZSh0YXJnZXQuX2NhbikgfSwgdGFyZ2V0Ll9jYW4gPSBzdWIKCgkJCQkJY2FuLm9uYXBwZW5kLl9hY3Rpb24oc3ViLCBbY2xpLkNMT1NFLCBjbGkuQ0xFQVIsIGNsaS5SRUZSRVNIXSwgc3ViLl9hY3Rpb24sIGtpdC5EaWN0KAoJCQkJCQljbGkuUkVGUkVTSCwgZnVuY3Rpb24oZXZlbnQpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpIH0sCgkJCQkJCWNsaS5DTEVBUiwgZnVuY3Rpb24oZXZlbnQpIHsgdGFyZ2V0LnZhbHVlID0gIiIgfSwKCQkJCQkJY2xpLkNMT1NFLCBmdW5jdGlvbihldmVudCkgeyBzdWIuY2xvc2UoKSB9LAoJCQkJCSkpLCBjYW4ub25hcHBlbmQuX3N0YXR1cyhzdWIsIFttZGIuVE9UQUwsIG1kYi5JTkRFWF0pCgoJCQkJCWNhbi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl90YXJnZXQsIG1ldGEuc3R5bGUpLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgc3ViLl90YXJnZXQpCgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIsIGZ1bmN0aW9uKHN1YiwgaGlkZSkgeyBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgc3ViLl90YXJnZXQsICFoaWRlKSwgY2FuLmJhc2UuaXNGdW5jKGNicykgJiYgY2JzKHN1YikgfSkKCQkJCX0sIGRvY3VtZW50LmJvZHkpCgkJCX0sIHRhcmdldCwgbGFzdCkgfSB9KQoJCX0pCgl9LAoJZmxvYXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYikgewoJCXZhciB1aSA9IGNhbi5vbmFwcGVuZC5maWVsZChjYW4sICJzdG9yeSB0b2FzdCBmbG9hdCIsIHt9LCBkb2N1bWVudC5ib2R5KQoJCXVpLmNsb3NlID0gZnVuY3Rpb24oKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLmZpcnN0KSB9CgoJCWNhbi5nZXRBY3Rpb25TaXplKGZ1bmN0aW9uKGxlZnQsIHRvcCwgaGVpZ2h0LCB3aWR0aCkgewoJCQljYW4ucGFnZS5zdHlsZShjYW4sIHVpLm91dHB1dCwgaHRtbC5NQVhfSEVJR0hULCBoZWlnaHQtMjgsIGh0bWwuTUFYX1dJRFRILCB3aWR0aCkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB1aS5maXJzdCwgaHRtbC5MRUZULCBsZWZ0LCBodG1sLlRPUCwgdG9wKQoJCX0pCgoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgW2NsaS5DTE9TRSwgY2xpLlJFRlJFU0gsIHtpbnB1dDogaHRtbC5URVhULCBwbGFjZWhvbGRlcjogImZpbHRlciIsIF9pbml0OiBmdW5jdGlvbihpbnB1dCkgewoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgImtleW1hcC5mb2N1cyIsIGNhbi5yZXF1ZXN0KHt9LCB7Y2I6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoZXZlbnQudGFyZ2V0LnRhZ05hbWUgPT0gIklOUFVUIikgeyByZXR1cm4gfQoJCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVTQ0FQRSkgeyB1aS5jbG9zZSgpOyByZXR1cm4gfQoJCQkJaWYgKGV2ZW50LmtleSA9PSBpY2UuU1ApIHsgaW5wdXQuZm9jdXMoKSwgY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpIH0KCQkJfX0pKQoJCX0sIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pCgkJCWlmIChldmVudC5rZXkgIT0gbGFuZy5FTlRFUikgeyByZXR1cm4gfQoJCQlldmVudC50YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgLTEpCgoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB1aS5vdXRwdXQsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyLCBpbmRleCkgeyBpZiAoaW5kZXggPT0gMCkgeyByZXR1cm4gfQoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRyLCBodG1sLkhJRERFTikKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCkgeyBpZiAodGQuaW5uZXJUZXh0LmluZGV4T2YoZXZlbnQudGFyZ2V0LnZhbHVlKSA+IC0xKSB7CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIHRyLCBodG1sLkhJRERFTikKCQkJCX0gfSkKCQkJfSkKCQl9fV0sIHVpLmFjdGlvbiwga2l0LkRpY3QoY2xpLkNMT1NFLCB1aS5jbG9zZSwgY2xpLlJFRlJFU0gsIGZ1bmN0aW9uKGV2ZW50KSB7IHVpLmNsb3NlKCksIGNhbi50b2FzdC5jbGljaygpfSkpCgoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgZnVuY3Rpb24odmFsdWUsIGtleSwgaW5kZXgsIGxpbmUsIGxpc3QpIHsKCQkJcmV0dXJuIHt0ZXh0OiBbdmFsdWUsIGh0bWwuVERdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgbGlzdCkKCQkJfX0KCQl9LCB1aS5vdXRwdXQpLCBjYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cuUmVzdWx0KCksIHVpLm91dHB1dCkKCQlyZXR1cm4gdWkKCX0sCgp9KQpWb2xjYW5vcygib25sYXlvdXQiLCB7aGVscDogIumhtemdouW4g+WxgCIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxkb2N1bWVudC5ib2R5CgkJaWYgKGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5GSUVMRFNFVF9NQUlOKyIucGFnZSIpLmxlbmd0aCA+IDApIHsKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBodG1sLkZJRUxEU0VUX0xFRlQsIGZ1bmN0aW9uKGZpZWxkLCBpbmRleCkgewoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBmaWVsZCwgIiIpCgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9MRUZULCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBvdXRwdXQsICIiKQoJCQkJfSkKCQkJfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBodG1sLkZJRUxEU0VUX01BSU4sIGZ1bmN0aW9uKGZpZWxkLCBpbmRleCkgewoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBmaWVsZCwgIiIpCgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9NQUlOLCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBvdXRwdXQsICIiKQoJCQkJfSkKCQkJfSkKCQkJcmV0dXJuCgkJfQoKCQl2YXIgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCwgaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBjYW4ucGFnZS5LZXlzKGh0bWwuRklFTERTRVRfSEVBRCwgaHRtbC5GSUVMRFNFVF9GT09UKSwgZnVuY3Rpb24oZmllbGQpIHsKCQkJaGVpZ2h0IC09IGZpZWxkLm9mZnNldEhlaWdodAoJCX0pCgoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5GSUVMRFNFVF9MRUZULCBmdW5jdGlvbihmaWVsZCwgaW5kZXgpIHsKCQkJdmFyIG9mZnNldCA9IGNhbi51c2VyLmlzTW9iaWxlICYmICFjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAxMDA6IDAKCQkJY2FuLnVzZXIuaXNNb2JpbGUgfHwgKHdpZHRoIC09IGZpZWxkLm9mZnNldFdpZHRoKQoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGZpZWxkLCBoZWlnaHQtb2Zmc2V0KQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9MRUZULCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIG91dHB1dCwgaGVpZ2h0LWh0bWwuQUNUSU9OX0hFSUdIVC0xLW9mZnNldCkKCQkJfSkKCQl9KQoKCQljYW4udXNlci5pc01vYmlsZSB8fCBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuRklFTERTRVRfTUFJTiwgZnVuY3Rpb24oZmllbGQsIGluZGV4KSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgZmllbGQsIGh0bWwuSEVJR0hULCBoZWlnaHQsIGh0bWwuV0lEVEgsIHdpZHRoKQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9NQUlOLCBodG1sLkRJVl9PVVRQVVRdXSwgZnVuY3Rpb24ob3V0cHV0KSB7CgkJCQloZWlnaHQgLT0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZmllbGQsIGh0bWwuRElWX0FDVElPTilbMF0ub2Zmc2V0SGVpZ2h0CgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIG91dHB1dCwgaGVpZ2h0KQoJCQl9KQoJCX0pCgoJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBjaGF0Lk9OU0laRSwgY2FuLnJlcXVlc3Qoe30sIHt3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0fSkpCgl9LAoJdG9waWM6IGZ1bmN0aW9uKGNhbiwgdG9waWMpIHsgdG9waWMgJiYgKGNhbi5fdG9waWMgPSB0b3BpYykKCQljYW4udXNlci50b3BpYyhjYW4sIGNhbi5fdG9waWMgfHwgY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5UT1BJQykgfHwgVm9sY2Fub3MubWV0YS5hcmdzLnRvcGljIHx8IChjYW4uYmFzZS5pc05pZ2h0KCk/IGNoYXQuQkxBQ0s6IGNoYXQuV0hJVEUpKQoJfSwKCWJhY2tncm91bmQ6IGZ1bmN0aW9uKGNhbiwgdXJsLCB0YXJnZXQpIHsKCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldHx8ZG9jdW1lbnQuYm9keSwgaHRtbC5CQUNLR1JPVU5ELCB1cmwgPT0gIiIgfHwgdXJsID09ICJ2b2lkIj8gIiI6ICd1cmwoIicrdXJsKyciKScpCgl9LAoJZmlndXJlOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIHJpZ2h0LCBsYXlvdXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCWlmIChsYXlvdXQpIHsgcmV0dXJuIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBsYXlvdXQpLCBjYW4ub25tb3Rpb24ubW92ZShjYW4sIHRhcmdldCwgbGF5b3V0KSwgbGF5b3V0IH0KCQlpZiAoIWV2ZW50IHx8ICFldmVudC50YXJnZXQgfHwgIWV2ZW50LmNsaWVudFgpIHsgcmV0dXJuIHt9IH0KCgkJdmFyIGxlZnQgPSBldmVudC5jbGllbnRYLWV2ZW50Lm9mZnNldFgsIHRvcCA9IGV2ZW50LmNsaWVudFktZXZlbnQub2Zmc2V0WStldmVudC50YXJnZXQub2Zmc2V0SGVpZ2h0LTU7IGlmIChyaWdodCkgewoJCQl2YXIgbGVmdCA9IGV2ZW50LmNsaWVudFgtZXZlbnQub2Zmc2V0WCtldmVudC50YXJnZXQub2Zmc2V0V2lkdGgsIHRvcCA9IGV2ZW50LmNsaWVudFktZXZlbnQub2Zmc2V0WQoJCX0KCgkJbGF5b3V0ID0ge2xlZnQ6IGxlZnQsIHRvcDogdG9wfQoJCWlmIChsYXlvdXQudG9wIDwgMCkgeyBsYXlvdXQudG9wID0gMCB9CgkJaWYgKGxheW91dC5sZWZ0IDwgMCkgeyBsYXlvdXQubGVmdCA9IDAgfQoJCWlmIChsYXlvdXQubGVmdCt0YXJnZXQub2Zmc2V0V2lkdGg+d2luZG93LmlubmVyV2lkdGgpIHsKCQkJbGF5b3V0LnJpZ2h0ID0gMCwgbGF5b3V0LmxlZnQgPSAiIgoJCX0KCQlpZiAoIShjYW4udXNlci5pc01vYmlsZSAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpKSAmJiB0b3ArdGFyZ2V0Lm9mZnNldEhlaWdodD53aW5kb3cuaW5uZXJIZWlnaHQtMzIpIHsKCQkJbGF5b3V0LmJvdHRvbSA9IHdpbmRvdy5pbm5lckhlaWdodCAtIGV2ZW50LmNsaWVudFkrZXZlbnQub2Zmc2V0WSwgbGF5b3V0LnRvcCA9ICIiCgkJCWlmIChyaWdodCkgeyBsYXlvdXQuYm90dG9tIC09IHRhcmdldC5vZmZzZXRIZWlnaHQgfQoJCX0KCQlyZXR1cm4gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGxheW91dCksIGNhbi5vbm1vdGlvbi5tb3ZlKGNhbiwgdGFyZ2V0LCBsYXlvdXQpLCBsYXlvdXQKCX0sCgoJZGlzcGxheTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCXJldHVybiBjYW4ucGFnZS5BcHBlbmRzKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjaGF0LkxBWU9VVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFsKCQkJe3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dmlldzogY2hhdC5DT05URU5UfV19LAoJCQl7dHlwZTogaHRtbC5UUiwgbGlzdDogW3t2aWV3OiBjaGF0LkRJU1BMQVl9XX0sCgkJXX1dKQoJfSwKCXByb2plY3Q6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjaGF0LkxBWU9VVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQl7dHlwZTogaHRtbC5URCwgbGlzdDogW3t2aWV3OiBjaGF0LlBST0pFQ1QsIHN0eWxlOiB7ZGlzcGxheTogaHRtbC5OT05FfX1dfSwge3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFsKCQkJCXt2aWV3OiBbY2hhdC5MQVlPVVQsIGh0bWwuVEFCTEVdLCBsaXN0OiBbCgkJCQkJe3R5cGU6IGh0bWwuVFIsIGxpc3Q6IFt7dmlldzogY2hhdC5DT05URU5UfV19LAoJCQkJCXt0eXBlOiBodG1sLlRSLCBsaXN0OiBbe3ZpZXc6IGNoYXQuRElTUExBWX1dfSwKCQkJCV19CgkJCV19CgkJXX1dIH1dKQoJfSwKCXByb2ZpbGU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl9vdXRwdXQKCQlmdW5jdGlvbiB0b2dnbGUodmlldykgewoJCQl2aWV3Ll90b2dnbGU/IHZpZXcuX3RvZ2dsZShldmVudCwgdmlldy5zdHlsZS5kaXNwbGF5ID09IGh0bWwuTk9ORSk6IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCB2aWV3KQoJCQlyZXR1cm4gdmlldy5zdHlsZS5kaXNwbGF5ID09IGh0bWwuTk9ORQoJCX0KCgkJdmFyIGd0ID0gIiYjMTAwOTU7IiwgbHQgPSAiJiMxMDA5NDsiLCBkb3duID0gIiYjNzA5OyIsIHVwID0gIiYjNzA4OyIKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2NoYXQuTEFZT1VULCBodG1sLlRBQkxFXSwgbGlzdDogWwoJCQl7dmlldzogW2NoYXQuUFJPSkVDVCwgaHRtbC5URF0sIGxpc3Q6IFt7dmlldzogW2NoYXQuUFJPSkVDVF19XX0sCgkJCXt0eXBlOiBodG1sLlRELCBsaXN0OiBbCgkJCQl7dHlwZTogaHRtbC5UUiwgbGlzdDogW3t0eXBlOiBodG1sLlRSLCBsaXN0OiBbCgkJCQkJe3ZpZXc6IFtjaGF0LkNPTlRFTlQsIGh0bWwuVERdLCBsaXN0OiBbe3ZpZXc6IFtjaGF0LkNPTlRFTlRdfSwKCQkJCQkJe3ZpZXc6IFtbaHRtbC5UT0dHTEUsIGNoYXQuUFJPSkVDVF1dLCBsaXN0OiBbe3RleHQ6IFtndCwgaHRtbC5ESVZdfV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCQlldmVudC50YXJnZXQuaW5uZXJIVE1MID0gdG9nZ2xlKGNhbi51aS5wcm9qZWN0KT8gZ3Q6IGx0CgkJCQkJCX19LAoJCQkJCQl7dmlldzogW1todG1sLlRPR0dMRSwgY2hhdC5QUk9GSUxFXV0sIGxpc3Q6IFt7dGV4dDogW2x0LCBodG1sLkRJVl19XSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQkJCWV2ZW50LnRhcmdldC5pbm5lckhUTUwgPSB0b2dnbGUoY2FuLnVpLnByb2ZpbGUpPyBsdDogZ3QKCQkJCQkJfX0sCgkJCQkJCXt2aWV3OiBbW2h0bWwuVE9HR0xFLCBjaGF0LkRJU1BMQVldXSwgbGlzdDogW3t0ZXh0OiBbdXAsIGh0bWwuRElWXX1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCQkJZXZlbnQudGFyZ2V0LmlubmVySFRNTCA9IHRvZ2dsZShjYW4udWkuZGlzcGxheSk/IHVwOiBkb3duCgkJCQkJCX19LAoJCQkJCV19LAoJCQkJCXt2aWV3OiBbY2hhdC5QUk9GSUxFLCBodG1sLlREXSwgbGlzdDogW3t2aWV3OiBbY2hhdC5QUk9GSUxFXSwgc3R5bGU6IHtkaXNwbGF5OiBodG1sLk5PTkV9fV19LAoJCQkJXX1dfSwKCQkJCXt2aWV3OiBbY2hhdC5ESVNQTEFZLCBodG1sLlRSXSwgbGlzdDogW3t2aWV3OiBbY2hhdC5ESVNQTEFZXSwgc3R5bGU6IHtkaXNwbGF5OiBodG1sLk5PTkV9fV19CgkJCV19CgkJXSB9XSk7IHJldHVybiBjYW4udWkgPSB1aQoJfSwKfSkKVm9sY2Fub3MoIm9ubW90aW9uIiwge2hlbHA6ICLliqjmgIHnibnmlYgiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIm9yaWVudGF0aW9uY2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvcmllbnRhdGlvbmNoYW5nZSIpCgkJfSksIGNhbi5vbm1vdGlvbi5mbG9hdC5hdXRvKGNhbiwgdGFyZ2V0KQoJfSwKCWZvY3VzOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyBpZiAoIXRhcmdldCkgeyByZXR1cm4gfQoJCXRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZSAmJiB0YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UoMCwgLTEpLCB0YXJnZXQuZm9jdXMoKQoJfSwKCXNoYXJlOiBmdW5jdGlvbihldmVudCwgY2FuLCBpbnB1dCwgYXJncykgewoJCXJldHVybiBjYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBpbnB1dCwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgX2FyZ3MpIHsKCQkJY2FuLnNlYXJjaChjYW4ucmVxdWVzdChldmVudCwge2FyZ3M6IFttZGIuVFlQRSwgY2hhdC5GSUVMRF0uY29uY2F0KGFyZ3N8fFtdLCBfYXJnc3x8W10pfSkuX2V2ZW50LCBbWyJIZWFkZXIiLCBjaGF0Lk9OQUNUSU9OLCB3ZWIuU0hBUkVdXSkKCQl9KQoJfSwKCXN0b3J5OiB7CgkJX2hhc2g6IHsKCQkJc3Bhcms6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgdGFyZ2V0KSB7CgkJCQltZXRhW21kYi5OQU1FXSA9PSBodG1sLklOTkVSPyBjYW4ub25tb3Rpb24uY29weShjYW4sIHRhcmdldCk6IGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5TUEFOLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJY2FuLm9ubW90aW9uLmNvcHkoY2FuLCBpdGVtKQoJCQkJfSkKCQkJfSwKCQl9LAoJCWF1dG86IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHZhciB0aGF0ID0gdGhpcwoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXR8fGNhbi5fb3V0cHV0LCAiLnN0b3J5IiwgZnVuY3Rpb24oaXRlbSkgeyB2YXIgbWV0YSA9IGl0ZW0uZGF0YXNldAoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBpdGVtLCBjYW4uYmFzZS5PYmoobWV0YS5zdHlsZSkpCgkJCQljYW4uY29yZS5DYWxsRnVuYyh0aGF0Ll9oYXNoW21ldGEudHlwZV0sIFtjYW4sIG1ldGEsIHRhcmdldHx8Y2FuLl9vdXRwdXRdKQoJCQl9KQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXR8fGNhbi5fb3V0cHV0LCBodG1sLklGUkFNRSwgZnVuY3Rpb24oaXRlbSkgewoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBpdGVtLCBodG1sLkhFSUdIVCwgY2FuLkNvbmYoaHRtbC5IRUlHSFQpLTg4LCBodG1sLldJRFRILCBjYW4uQ29uZihodG1sLldJRFRIKS0zMCkKCQkJfSkKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgaHRtbC5TVkcsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWl0ZW0ub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJY2FuLnVzZXIuY2FydGUoZXZlbnQsIGNhbiwga2l0LkRpY3QobWRiLkVYUE9SVCwgZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgoJCQkJCX0pLCBbbWRiLkVYUE9SVF0pCgkJCQl9CgkJCX0pCgkJfSwKCX0sCglmbG9hdDoge19oYXNoOiB7fSwKCQlkZWw6IGZ1bmN0aW9uKGNhbiwga2V5KSB7CgkJCWtleSA9PSBjaGF0LkNBUlRFICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGRvY3VtZW50LmJvZHksIGNhbi5jb3JlLktleXMoaHRtbC5ESVYsIGNoYXQuQ0FSVEUpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBpdGVtKQoJCQl9KQoJCQl2YXIgbGFzdCA9IHRoaXMuX2hhc2hba2V5XTsgaWYgKCFsYXN0KSB7IHJldHVybiB9CgkJCWxhc3QuY2xvc2U/IGxhc3QuY2xvc2UoKTogY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgbGFzdC5fdGFyZ2V0KQoJCX0sCgkJYWRkOiBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUpIHsgcmV0dXJuIHRoaXMuZGVsKGNhbiwga2V5KSwgdGhpcy5faGFzaFtrZXldID0gdmFsdWUgfSwKCQlhdXRvOiBmdW5jdGlvbihjYW4sIHRhcmdldCwga2V5KSB7IHZhciB0aGF0ID0gdGhpcwoJCQl2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoYXJndW1lbnRzKS5zbGljZSgyKQoJCQlpZiAobGlzdC5sZW5ndGggPT0gMCkgeyBsaXN0ID0gW2NoYXQuQ0FSVEUsIGNoYXQuSU5QVVRdIH0KCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCB7b25tb3VzZW92ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7IAoJCQkJaWYgKGNhbi5wYWdlLnRhZ2lzKGh0bWwuSU1HLCBldmVudC50YXJnZXQpKSB7IHJldHVybiB9CgkJCQljYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGtleSwgaW5kZXgpIHsgdGhhdC5kZWwoY2FuLCBrZXkpIH0pCgkJCX19KQoJCX0sCgl9LAoJY2FjaGU6IGZ1bmN0aW9uKGNhbiwgbmV4dCkgeyB2YXIgbGlzdCA9IGNhbi5iYXNlLk9iaihjYW4uY29yZS5MaXN0KGFyZ3VtZW50cykuc2xpY2UoMiksIFtjYW4uX291dHB1dF0pCgkJY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtKSB7IGNhbi5wYWdlLkNhY2hlKGl0ZW0uX2NhY2hlX2tleSwgaXRlbSwgaXRlbS5zY3JvbGxUb3ArMSkgfSkKCQl2YXIga2V5ID0gbmV4dChjYW4uX2NhY2hlX2RhdGEgPSBjYW4uX2NhY2hlX2RhdGF8fHt9KQoJCXJldHVybiBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIHBvcyA9IGNhbi5wYWdlLkNhY2hlKGl0ZW0uX2NhY2hlX2tleSA9IGtleSwgaXRlbSkKCQkJaWYgKHBvcykgeyBpdGVtLnNjcm9sbFRvICYmIGl0ZW0uc2Nyb2xsVG8oMCwgcG9zLTEpOyByZXR1cm4gaXRlbSB9CgkJfSkubGVuZ3RoID4gMAoJfSwKCWNsZWFyOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyByZXR1cm4gY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0fHxjYW4uX291dHB1dCwgIiIpLCB0cnVlIH0sCglkZWxheTogZnVuY3Rpb24oY2FuLCBjYikgeyBjYW4uY29yZS5UaW1lcigxMDAsIGNiKSB9LAoKCWhpZGRlbjogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHNob3cpIHsKCQljYW4ucGFnZS5zdHlsZURpc3BsYXkoY2FuLCB0YXJnZXR8fGNhbi5fdGFyZ2V0LCBzaG93PyAiIjogaHRtbC5OT05FKQoJfSwKCXRvZ2dsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIHNob3csIGhpZGUpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCXZhciBzdGF0dXMgPSB0YXJnZXQuc3R5bGUuZGlzcGxheSA9PSBodG1sLk5PTkUKCQlpZiAoIShzdGF0dXM/IGNhbi5iYXNlLmlzRnVuYyhzaG93KSAmJiBzaG93KCk6IGNhbi5iYXNlLmlzRnVuYyhoaWRlKSAmJiBoaWRlKCkpKSB7CgkJCWNhbi5wYWdlLnN0eWxlRGlzcGxheShjYW4sIHRhcmdldCwgc3RhdHVzPyAiIjogaHRtbC5OT05FKQoJCX0KCQlyZXR1cm4gc3RhdHVzCgl9LAoJc2VsZWN0OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgbmFtZSwgd2hpY2gpIHsKCQl2YXIgb2xkID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBuYW1lLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQlpZiAoY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGl0ZW0sICJzZWxlY3QiKSkgeyByZXR1cm4gaW5kZXggfQoJCX0pWzBdCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBuYW1lLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3Quc2V0KGNhbiwgaXRlbSwgaHRtbC5TRUxFQ1QsIGl0ZW0gPT0gd2hpY2ggfHwgd2hpY2ggPT0gaW5kZXgpCgkJfSkKCQlyZXR1cm4gb2xkCgl9LAoJbW9kaWZ5OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgY2IsIGl0ZW0pIHsgdmFyIGJhY2sgPSB0YXJnZXQuaW5uZXJIVE1MLCB0ZXh0ID0gdGFyZ2V0LmlubmVyVGV4dAoJCWlmIChiYWNrLmxlbmd0aCA+IDEyMCB8fCBiYWNrLmluZGV4T2YoaWNlLk5MKSA+IC0xKSB7CgkJCXJldHVybiBjYW4ub25tb3Rpb24ubW9kaWZ5cyhjYW4sIHRhcmdldCwgY2IpCgkJfQoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dHlwZTogaHRtbC5JTlBVVCwgdmFsdWU6IHRhcmdldC5pbm5lclRleHQsIHN0eWxlOiB7CgkJCXdpZHRoOiB0YXJnZXQub2Zmc2V0V2lkdGggPiA0MDA/IDQwMDogdGFyZ2V0Lm9mZnNldFdpZHRoLTIwLAoJCX0sIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJc3dpdGNoIChldmVudC5rZXkpIHsKCQkJCWNhc2UgbGFuZy5FTlRFUjogdGFyZ2V0LmlubmVySFRNTCA9IGV2ZW50LnRhcmdldC52YWx1ZQoJCQkJCWV2ZW50LnRhcmdldC52YWx1ZSA9PSBiYWNrIHx8IGNiKGV2ZW50LCBldmVudC50YXJnZXQudmFsdWUsIGJhY2spCgkJCQkJYnJlYWsKCQkJCWNhc2UgbGFuZy5FU0NBUEU6IHRhcmdldC5pbm5lckhUTUwgPSBiYWNrOyBicmVhawoJCQkJZGVmYXVsdDogY2FuLm9ua2V5bWFwLmlucHV0KGV2ZW50LCBjYW4pCgkJCX0KCQl9LCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCWl0ZW0gJiYgY2FuLm9uYXBwZW5kLmZpZ3VyZShjYW4sIGl0ZW0sIHRhcmdldCksIHRhcmdldC52YWx1ZSA9IHRleHQKCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgdGFyZ2V0KQoJCX19XSkKCX0sCgltb2RpZnlzOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgY2IsIGl0ZW0pIHsgdmFyIGJhY2sgPSB0YXJnZXQuaW5uZXJIVE1MCgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIHRhcmdldCwgW3t0eXBlOiBodG1sLlRFWFRBUkVBLCB2YWx1ZTogdGFyZ2V0LmlubmVyVGV4dCwgc3R5bGU6IHsKCQkJd2lkdGg6IHRhcmdldC5vZmZzZXRXaWR0aCA+IDQwMD8gNDAwOiB0YXJnZXQub2Zmc2V0V2lkdGgtMjAsIGhlaWdodDogdGFyZ2V0Lm9mZnNldEhlaWdodCA8IDYwPyA2MDogdGFyZ2V0Lm9mZnNldEhlaWdodC0yMCwKCQl9LCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCXN3aXRjaCAoZXZlbnQua2V5KSB7CgkJCQljYXNlIGxhbmcuRU5URVI6CgkJCQkJaWYgKGV2ZW50LmN0cmxLZXkpIHsgdGFyZ2V0LmlubmVySFRNTCA9IGV2ZW50LnRhcmdldC52YWx1ZQoJCQkJCQlldmVudC50YXJnZXQudmFsdWUgPT0gYmFjayB8fCBjYihldmVudCwgZXZlbnQudGFyZ2V0LnZhbHVlLCBiYWNrKQoJCQkJCX0KCQkJCQlicmVhawoJCQkJY2FzZSBsYW5nLkVTQ0FQRTogdGFyZ2V0LmlubmVySFRNTCA9IGJhY2s7IGJyZWFrCgkJCQlkZWZhdWx0OiBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbikKCQkJfQoJCX0sIF9pbml0OiBmdW5jdGlvbih0YXJnZXQpIHsKCQkJaXRlbSAmJiBjYW4ub25hcHBlbmQuZmlndXJlKGNhbiwgaXRlbSwgdGFyZ2V0KQoJCQljYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgkJfX1dKQoJfSwKCXRvaW1hZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG5hbWUsIHRhcmdldCkgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7bmFtZTogIm5hbWUiLCB2YWx1ZTogbmFtZX1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhKSB7CgkJCWNhbi5yZXF1aXJlKFsiaHR0cHM6Ly9jZG4uanNkZWxpdnIubmV0L25wbS9odG1sMmNhbnZhc0AxLjAuMC1yYy41L2Rpc3QvaHRtbDJjYW52YXMubWluLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQkJaHRtbDJjYW52YXModGFyZ2V0fHxjYW4uX3RhcmdldCkudGhlbihmdW5jdGlvbiAoY2FudmFzKSB7CgkJCQkJY2FuLnBhZ2UuQ3JlYXRlKGNhbiwgaHRtbC5BLCB7aHJlZjogY2FudmFzLnRvRGF0YVVSTCgiaW1hZ2UvcG5nIiksIGRvd25sb2FkOiBkYXRhLm5hbWV9KS5jbGljaygpCgkJCQl9KQoJCQl9KQoJCX0pCgl9LAoKCWxpbms6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCB0ZXh0KSB7CgkJaWYgKHRhcmdldC5pbm5lclRleHQgPT0gIiIpIHsgdGFyZ2V0LmlubmVyVGV4dCA9IHRhcmdldC5ocmVmIH0KCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB0YXJnZXQsIHt0YXJnZXQ6ICJfYmxhbmsifSkKCX0sCgljb3B5OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgdGV4dCwgY2IpIHsKCQl0YXJnZXQudGl0bGUgPSAi54K55Ye75aSN5Yi2IiwgdGFyZ2V0Lm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewoJCQljYW4udXNlci5jb3B5KGV2ZW50LCBjYW4sIHRleHR8fHRhcmdldC5pbm5lclRleHQpCgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQpCgkJfQoJfSwKCW1vdmU6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBsYXlvdXQsIGNiKSB7IHZhciBiZWdpbjsgbGF5b3V0ID0gbGF5b3V0fHx7fQoJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBsYXlvdXQpLCB0YXJnZXQub25tb3VzZWRvd24gPSBmdW5jdGlvbihldmVudCkgewoJCQlsYXlvdXQuaGVpZ2h0ID0gdGFyZ2V0Lm9mZnNldEhlaWdodCwgbGF5b3V0LndpZHRoID0gdGFyZ2V0Lm9mZnNldFdpZHRoCgkJCWxheW91dC5sZWZ0ID0gdGFyZ2V0Lm9mZnNldExlZnQsIGxheW91dC50b3AgPSB0YXJnZXQub2Zmc2V0VG9wCgkJCWJlZ2luID0gY2FuLmJhc2UuQ29weSh7eDogZXZlbnQueCwgeTogZXZlbnQueX0sIGxheW91dCkKCQl9LCB0YXJnZXQub25tb3VzZXVwID0gZnVuY3Rpb24oZXZlbnQpIHsgYmVnaW4gPSBudWxsIH0KCgkJdGFyZ2V0Lm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24oZXZlbnQpIHsgaWYgKCFiZWdpbiB8fCAhZXZlbnQuY3RybEtleSkgeyByZXR1cm4gfQoJCQlpZiAoZXZlbnQuc2hpZnRLZXkpIHsKCQkJCWxheW91dC53aWR0aCA9IGxheW91dC53aWR0aCArIGV2ZW50LnggLSBiZWdpbi54IAoJCQkJbGF5b3V0LmhlaWdodCA9IGxheW91dC5oZWlnaHQgKyBldmVudC55IC0gYmVnaW4ueQoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuSEVJR0hULCBsYXlvdXQuaGVpZ2h0LCBodG1sLldJRFRILCBsYXlvdXQud2lkdGgpCgkJCX0gZWxzZSB7CgkJCQlsYXlvdXQudG9wID0gYmVnaW4udG9wICsgZXZlbnQueSAtIGJlZ2luLnkKCQkJCWxheW91dC5sZWZ0ID0gYmVnaW4ubGVmdCArIGV2ZW50LnggLSBiZWdpbi54IAoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTEVGVCwgbGF5b3V0LmxlZnQsIGh0bWwuVE9QLCBsYXlvdXQudG9wKQoJCQl9CgkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih0YXJnZXQsIGxheW91dCkKCQl9CgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih0YXJnZXQsIGxheW91dCkKCX0sCglzaG93OiBmdW5jdGlvbihjYW4sIHRpbWUsIGNiLCB0YXJnZXQpIHsgdGFyZ2V0ID0gdGFyZ2V0fHxjYW4uX3RhcmdldAoJCXRpbWUgPSBjYW4uYmFzZS5pc09iamVjdCh0aW1lKT8gdGltZToge2ludGVydmFsOiAxMCwgbGVuZ3RoOiB0aW1lfHwzMH0KCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5PUEFDSVRZLCAwLCBodG1sLkRJU1BMQVksIGh0bWwuQkxPQ0spCgkJY2FuLmNvcmUuVGltZXIodGltZSwgZnVuY3Rpb24oZXZlbnQsIHZhbHVlLCBpbmRleCkgewoJCQljYW4ucGFnZS5zdHlsZShjYW4sIHRhcmdldCwgaHRtbC5PUEFDSVRZLCAoaW5kZXgrMSkvdGltZS5sZW5ndGgpCgkJfSwgY2IpCgl9LAoJaGlkZTogZnVuY3Rpb24oY2FuLCB0aW1lLCBjYiwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8Y2FuLl90YXJnZXQKCQl0aW1lID0gY2FuLmJhc2UuaXNPYmplY3QodGltZSk/IHRpbWU6IHt2YWx1ZTogMTAsIGxlbmd0aDogdGltZXx8MjB9CgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuT1BBQ0lUWSwgMSkKCQljYW4uY29yZS5UaW1lcih0aW1lLCBmdW5jdGlvbihldmVudCwgdmFsdWUsIGluZGV4KSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLk9QQUNJVFksIDEtKGluZGV4KzEpL3RpbWUubGVuZ3RoKQoJCX0sIGZ1bmN0aW9uKCkgeyBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCksIGNhbi5wYWdlLnN0eWxlKGNhbiwgdGFyZ2V0LCBodG1sLkRJU1BMQVksIGh0bWwuTk9ORSkgfSkKCX0sCgoJc2VsZWN0RmllbGQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQlpZiAoZXZlbnQua2V5ID09ICJFbnRlciIpIHsgcmV0dXJuIGNhbi5ydW4oZXZlbnQpIH0KCQlpZiAoIWV2ZW50LmN0cmxLZXkgfHwgZXZlbnQua2V5IDwgIjAiIHx8IGV2ZW50LmtleSA+ICI5IikgeyByZXR1cm4gfQoJCWlmIChldmVudC5zaGlmdEtleSkgewoJCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vcHRpb24sICJpbnB1dFt0eXBlPWJ1dHRvbl0iLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQkJaW5kZXggPT0gZXZlbnQua2V5ICYmIChpdGVtLmNsaWNrKCkpCgkJCX0pCgkJfQoJCWlmIChldmVudC5rZXkgPT0gIjAiKSB7IHJldHVybiBjYW4ub25pbXBvcnQuX2JhY2soY2FuKSB9CgoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0ciwgaW5kZXgpIHsgaWYgKGluZGV4ID09IGV2ZW50LmtleSkgewoJCQl2YXIgaGVhZCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRILCBmdW5jdGlvbih0aCwgb3JkZXIpIHsgcmV0dXJuIHRoLmlubmVyVGV4dCB9KQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQsIGluZGV4KSB7IGNhbi5PcHRpb24oaGVhZFtpbmRleF0sIHRkLmlubmVyVGV4dCkgfSkKCQkJY2FuLlVwZGF0ZShldmVudCkKCQl9IH0pCgl9LAoJc2VsZWN0VGFibGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY2IpIHsgaWYgKCFldmVudC5jdHJsS2V5KSB7IHJldHVybiB9CgkJZnVuY3Rpb24gc2VsZWN0KG9yZGVyKSB7IHZhciBpbmRleCA9IDAKCQkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0cikgewoJCQkJaWYgKGNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgaHRtbC5ISURERU4pKSB7IHJldHVybiB9CgkJCQlpZiAoIWNhbi5wYWdlLkNsYXNzTGlzdC5zZXQoY2FuLCB0ciwgaHRtbC5TRUxFQ1QsIG9yZGVyID09IGluZGV4KyspKSB7IHJldHVybiB0ciB9CgkJCQlyZXR1cm4gY2FuLlN0YXR1cyhtZGIuSU5ERVgsIGluZGV4LTEpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHRyKSwgdHIKCQkJfSkubGVuZ3RoCgkJfQoJCXZhciB0b3RhbCA9IHNlbGVjdCh0YXJnZXQuX2luZGV4KTsgc3dpdGNoIChldmVudC5rZXkpIHsKCQkJY2FzZSAibiI6IHNlbGVjdCh0YXJnZXQuX2luZGV4ID0gKCh0YXJnZXQuX2luZGV4KSsxKSAlIHRvdGFsKTsgYnJlYWsKCQkJY2FzZSAicCI6IHNlbGVjdCh0YXJnZXQuX2luZGV4ID0gKHRhcmdldC5faW5kZXgtMSkgPCAwPyB0b3RhbC0xOiAodGFyZ2V0Ll9pbmRleC0xKSk7IGJyZWFrCgkJCWRlZmF1bHQ6IHRhcmdldC5faW5kZXggPSAwOyByZXR1cm4KCQl9IGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJfSwKCXNlbGVjdFRhYmxlSW5wdXQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY2IpIHsKCQlpZiAodGFyZ2V0LnZhbHVlID09ICIiKSB7IHJldHVybiBjYigpIH0KCQlpZiAoZXZlbnQuY3RybEtleSkgewoJCQlmdW5jdGlvbiBzZWxlY3Qob3JkZXIpIHsgaWYgKG9yZGVyID09IDApIHsgdGFyZ2V0LnZhbHVlID0gdGFyZ2V0Ll92YWx1ZSB9CgkJCQl2YXIgaW5kZXggPSAwOyByZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyKSB7CgkJCQkJaWYgKGNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgaHRtbC5ISURERU4pKSB7IHJldHVybiB9CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmRlbChjYW4sIHRyLCBodG1sLlNFTEVDVCk7IGlmIChvcmRlciAhPSBpbmRleCsrKSB7IHJldHVybiB0ciB9CgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRyLCBodG1sLlNFTEVDVCksIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCwgaW5kZXgpIHsKCQkJCQkJdGFyZ2V0Ll92YWx1ZSA9IHRhcmdldC5fdmFsdWV8fHRhcmdldC52YWx1ZSwgaW5kZXggPT0gMCAmJiAodGFyZ2V0LnZhbHVlID0gdGQuaW5uZXJUZXh0KQoJCQkJCX0pOyByZXR1cm4gdHIKCQkJCX0pLmxlbmd0aAoJCQl9CgkJCXZhciB0b3RhbCA9IHNlbGVjdCh0YXJnZXQuX2luZGV4KTsgc3dpdGNoIChldmVudC5rZXkpIHsKCQkJCWNhc2UgIm4iOiBzZWxlY3QodGFyZ2V0Ll9pbmRleCA9ICgodGFyZ2V0Ll9pbmRleCkrMSkgJSB0b3RhbCk7IGJyZWFrCgkJCQljYXNlICJwIjogc2VsZWN0KHRhcmdldC5faW5kZXggPSAodGFyZ2V0Ll9pbmRleC0xKSA8IDA/IHRvdGFsLTE6ICh0YXJnZXQuX2luZGV4LTEpKTsgYnJlYWsKCQkJCWRlZmF1bHQ6IHRhcmdldC5faW5kZXggPSAwLCB0YXJnZXQuX3ZhbHVlID0gIiI7IHJldHVybgoJCQl9IHJldHVybiBjYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQl9CgoJCXRhcmdldC5faW5kZXggPSAwLCB0YXJnZXQuX3ZhbHVlID0gIiIKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5UUiwgZnVuY3Rpb24odHIsIGluZGV4KSB7CgkJCXZhciBoYXMgPSBmYWxzZTsgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdHIsIGh0bWwuVEQsIGZ1bmN0aW9uKHRkKSB7CgkJCQloYXMgPSBoYXMgfHwgdGQuaW5uZXJUZXh0LmluZGV4T2YodGFyZ2V0LnZhbHVlKT4tMQoJCQl9KSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIHRyLCBodG1sLkhJRERFTiwgIWhhcyAmJiBpbmRleCAhPSAwKQoJCX0pCgoJCXZhciB0b3RhbCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBodG1sLlRSLCBmdW5jdGlvbih0cikgewoJCQlpZiAoIWNhbi5wYWdlLkNsYXNzTGlzdC5oYXMoY2FuLCB0ciwgaHRtbC5ISURERU4pKSB7IHJldHVybiB0cn0KCQl9KS5sZW5ndGgtMTsgdG90YWwgPT0gMCAmJiBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQljYW4uU3RhdHVzKGtpdC5EaWN0KG1kYi5UT1RBTCwgdG90YWwsIG1kYi5JTkRFWCwgdGFyZ2V0Ll9pbmRleCkpCgl9LAp9KQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIumUruebmOS6pOS6kiIsIGxpc3Q6IFtdLCBfZm9jdXM6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQlkb2N1bWVudC5ib2R5Lm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewoJCQlpZiAod2luZG93LndlYnZpZXcpIHsKCQkJCWlmIChldmVudC50YXJnZXQudGFnTmFtZSA9PSAiQSIpIHsKCQkJCQl3aW5kb3cub3BlbihldmVudC50YXJnZXQuaHJlZikKCQkJCX0KCQkJfQoJCX0KCQljYW4ub25rZXltYXAuX2J1aWxkKGNhbiksIGRvY3VtZW50LmJvZHkub25rZXlkb3duID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJaWYgKGV2ZW50Lm1ldGFLZXkpIHsgaWYgKHdpbmRvdy53ZWJ2aWV3KSB7CgkJCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQkJCWNhc2UgInEiOiB3aW5kb3cudGVybWluYXRlKCk7IGJyZWFrCgkJCQkJY2FzZSAidyI6IHdpbmRvdy5jbG9zZSgpOyBicmVhawoJCQkJCWNhc2UgInIiOiBsb2NhdGlvbi5yZWxvYWQoKTsgYnJlYWsKCQkJCQljYXNlICJmIjogY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbm9wZW5zZWFyY2giLCBjYW4ucmVxdWVzdCh7fSwge3R5cGU6ICIqIn0pKTsgYnJlYWsKCQkJCQljYXNlICJbIjogaGlzdG9yeS5iYWNrKCk7IGJyZWFrCgkJCQkJY2FzZSAiXSI6IGhpc3RvcnkuZm9yd2FyZCgpOyBicmVhawoJCQkJfQoJCQl9IHJldHVybiB9CgkJCWlmIChjYW4ucGFnZS50YWdpcyhbaHRtbC5TRUxFQ1QsIGh0bWwuSU5QVVQsIGh0bWwuVEVYVEFSRUFdLCBldmVudC50YXJnZXQpKSB7IHJldHVybiB9CgkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwgeyJtb2RlbCI6ICJub3JtYWwifSk7IGlmIChtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFKSA9PSBpY2UuVFJVRSkgeyByZXR1cm4gfQoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgY2hhdC5PTktFWURPV04sIG1zZyk7IGlmIChtc2cuT3B0aW9uKGljZS5NU0dfSEFORExFKSA9PSBpY2UuVFJVRSkgeyByZXR1cm4gfQoJCQljYW4uX2tleWxpc3QgPSBjYW4ub25rZXltYXAuX3BhcnNlKGV2ZW50LCBjYW4sIG1zZy5PcHRpb24oIm1vZGVsIiksIGNhbi5fa2V5bGlzdCwgY2FuLl9vdXRwdXQpCgkJfQoJfSwKCV9idWlsZDogZnVuY3Rpb24oY2FuKSB7CgkJY2FuLmNvcmUuSXRlbShjYW4ub25rZXltYXAuX21vZGUsIGZ1bmN0aW9uKGl0ZW0sIHZhbHVlKSB7IHZhciBlbmdpbmUgPSB7bGlzdDoge319CgkJCWNhbi5jb3JlLkl0ZW0odmFsdWUsIGZ1bmN0aW9uKGtleSwgY2IpIHsgdmFyIG1hcCA9IGVuZ2luZQoJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBrZXkubGVuZ3RoOyBpKyspIHsKCQkJCQlpZiAoIW1hcC5saXN0W2tleVtpXV0pIHsgbWFwLmxpc3Rba2V5W2ldXSA9IHtsaXN0OiB7fX0gfQoJCQkJCW1hcCA9IG1hcC5saXN0W2tleVtpXV07IGlmIChpID09IGtleS5sZW5ndGgtMSkgeyBtYXAuY2IgPSBjYiB9CgkJCQl9CgkJCX0pLCBjYW4ub25rZXltYXAuX2VuZ2luZVtpdGVtXSA9IGVuZ2luZQoJCX0pCgl9LAoJX3BhcnNlOiBmdW5jdGlvbihldmVudCwgY2FuLCBtb2RlLCBsaXN0LCB0YXJnZXQpIHsgbGlzdCA9IGxpc3R8fFtdCgkJaWYgKFsiQ29udHJvbCIsICJTaGlmdCJdLmluZGV4T2YoZXZlbnQua2V5KSA+IC0xKSB7IHJldHVybiBsaXN0IH0KCQlsaXN0LnB1c2goZXZlbnQua2V5KTsgZm9yICh2YXIgcHJlID0gMDsgcHJlIDwgbGlzdC5sZW5ndGg7IHByZSsrKSB7CgkJCWlmICgiMCIgPD0gbGlzdFtwcmVdICYmIGxpc3RbcHJlXSA8PSAiOSIpIHsgY29udGludWUgfSBicmVhawoJCX07IHZhciBjb3VudCA9IHBhcnNlSW50KGxpc3Quc2xpY2UoMCwgcHJlKS5qb2luKCIiKSl8fDEKCgkJdmFyIG1hcCA9IGNhbi5vbmtleW1hcC5fbW9kZVttb2RlXQoJCWZ1bmN0aW9uIHJlcGVhdChjYiwgY291bnQpIHsgbGlzdCA9IFtdOyBmb3IgKHZhciBpID0gMTsgaSA8PSBjb3VudDsgaSsrKSB7IGlmIChjYihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSkgeyBicmVhayB9IH0gfQoJCXZhciBjYiA9IG1hcCAmJiBtYXBbZXZlbnQua2V5XTsgaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgZXZlbnQua2V5Lmxlbmd0aCA+IDEpIHsgcmVwZWF0KGNiLCBjb3VudCk7IHJldHVybiBsaXN0IH0KCQl2YXIgY2IgPSBtYXAgJiYgbWFwW2V2ZW50LmtleS50b0xvd2VyQ2FzZSgpXTsgaWYgKGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgZXZlbnQua2V5Lmxlbmd0aCA+IDEpIHsgcmVwZWF0KGNiLCBjb3VudCk7IHJldHVybiBsaXN0IH0KCgkJdmFyIG1hcCA9IGNhbi5vbmtleW1hcC5fZW5naW5lW21vZGVdOyBpZiAoIW1hcCkgeyByZXR1cm4gW10gfQoJCWZvciAodmFyIGkgPSBwcmU7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrICkgewoJCQl2YXIgbWFwID0gbWFwLmxpc3RbbGlzdFtpXV07IGlmICghbWFwKSB7IHJldHVybiBbXSB9CgkJCWlmIChpID09IGxpc3QubGVuZ3RoLTEgJiYgY2FuLmJhc2UuaXNGdW5jKG1hcC5jYikpIHsgcmVwZWF0KG1hcC5jYiwgY291bnQpOyByZXR1cm4gW10gfQoJCX0KCQlyZXR1cm4gbGlzdAoJfSwKCV9tb2RlOiB7CgkJaW5zZXJ0OiB7CgkJCWprOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdGFyZ2V0LmJsdXIoKSwgY2FuLm9ua2V5bWFwLmRlbGV0ZVRleHQodGFyZ2V0LCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQtMSwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0KSB9LAoJCQlFc2NhcGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyB0YXJnZXQuYmx1cigpIH0sCgkJCUVudGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdmFyIGhpcyA9IHRhcmdldC5faGlzdG9yeXx8W10KCQkJCWhpcy5wdXNoKHRhcmdldC52YWx1ZSksIHRhcmdldC5faGlzdG9yeSA9IGhpcywgdGFyZ2V0Ll9jdXJyZW50ID0gaGlzLmxlbmd0aAoJCQkJY2FuLnBhZ2UudGFnaXMoaHRtbC5JTlBVVCwgZXZlbnQudGFyZ2V0KSAmJiBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCB0YXJnZXQpCgkJCX0sCgkJfSwKCQlpbnNlcnRfY3RybDogewoJCQlwOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCXZhciBoaXMgPSB0YXJnZXQuX2hpc3Rvcnl8fFtdLCBwb3MgPSB0YXJnZXQuX2N1cnJlbnR8fDAKCQkJCXBvcyA9IC0tcG9zICUgKGhpcy5sZW5ndGgrMSk7IGlmIChwb3MgPCAwKSB7IHBvcyA9IGhpcy5sZW5ndGggfQoJCQkJdGFyZ2V0Ll9jdXJyZW50ID0gcG9zLCB0YXJnZXQudmFsdWUgPSBoaXNbcG9zXXx8IiIKCQkJfSwKCQkJbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQl2YXIgaGlzID0gdGFyZ2V0Ll9oaXN0b3J5fHxbXSwgcG9zID0gdGFyZ2V0Ll9jdXJyZW50fHwwCgkJCQlwb3MgPSArK3BvcyAlIChoaXMubGVuZ3RoKzEpCgkJCQl0YXJnZXQuX2N1cnJlbnQgPSBwb3MsIHRhcmdldC52YWx1ZSA9IGhpc1twb3NdfHwiIgoJCQl9LAoKCQkJdTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgMCwgdGFyZ2V0LnNlbGVjdGlvbkVuZCkgfSwKCQkJazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0KSB9LAoJCQloOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmRlbGV0ZVRleHQodGFyZ2V0LCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQtMSwgMSkgfSwKCQkJZDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5kZWxldGVUZXh0KHRhcmdldCwgMCwgdGFyZ2V0LnNlbGVjdGlvblN0YXJ0KSB9LAoJCQl3OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdmFyIHN0YXJ0ID0gdGFyZ2V0LnNlbGVjdGlvblN0YXJ0LTIsIGVuZCA9IHRhcmdldC5zZWxlY3Rpb25FbmQtMQoJCQkJZm9yICh2YXIgaSA9IHN0YXJ0OyBpID49IDA7IGktLSkgewoJCQkJCWlmICh0YXJnZXQudmFsdWVbZW5kXSA9PSBpY2UuU1AgJiYgdGFyZ2V0LnZhbHVlW2ldICE9IGljZS5TUCkgeyBicmVhayB9CgkJCQkJaWYgKHRhcmdldC52YWx1ZVtlbmRdICE9IGljZS5TUCAmJiB0YXJnZXQudmFsdWVbaV0gPT0gaWNlLlNQKSB7IGJyZWFrIH0KCQkJCX0gY2FuLm9ua2V5bWFwLmRlbGV0ZVRleHQodGFyZ2V0LCBpKzEsIGVuZC1pKQoJCQl9LAoJCX0sCgl9LCBfZW5naW5lOiB7fSwKCglpbnB1dDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBpZiAoZXZlbnQubWV0YWtleSkgeyByZXR1cm4gfSB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJdGFyZ2V0Ll9rZXlzID0gY2FuLm9ua2V5bWFwLl9wYXJzZShldmVudCwgY2FuLCBldmVudC5jdHJsS2V5PyAiaW5zZXJ0X2N0cmwiOiBtZGIuSU5TRVJULCB0YXJnZXQuX2tleXMsIHRhcmdldCkKCX0sCglwcmV2ZW50OiBmdW5jdGlvbihldmVudCkgeyBldmVudC5zdG9wUHJvcGFnYXRpb24oKSwgZXZlbnQucHJldmVudERlZmF1bHQoKTsgcmV0dXJuIHRydWUgfSwKCWRlbGV0ZVRleHQ6IGZ1bmN0aW9uKHRhcmdldCwgc3RhcnQsIGNvdW50KSB7IHZhciBlbmQgPSBjb3VudD8gc3RhcnQrY291bnQ6IHRhcmdldC52YWx1ZS5sZW5ndGgKCQl2YXIgY3V0ID0gdGFyZ2V0LnZhbHVlLnNsaWNlKHN0YXJ0LCBlbmQpCgkJdGFyZ2V0LnZhbHVlID0gdGFyZ2V0LnZhbHVlLnN1YnN0cmluZygwLCBzdGFydCkrdGFyZ2V0LnZhbHVlLnN1YnN0cmluZyhlbmQsIHRhcmdldC52YWx1ZS5sZW5ndGgpCgkJcmV0dXJuIHRhcmdldC5zZXRTZWxlY3Rpb25SYW5nZShzdGFydCwgc3RhcnQpLCBjdXQKCX0sCglpbnNlcnRUZXh0OiBmdW5jdGlvbih0YXJnZXQsIHRleHQpIHsgdmFyIHN0YXJ0ID0gdGFyZ2V0LnNlbGVjdGlvblN0YXJ0CgkJdmFyIGJlZm9yZSA9IHRhcmdldC52YWx1ZS5zbGljZSgwLCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQpCgkJdmFyIGFmdGVyID0gdGFyZ2V0LnZhbHVlLnNsaWNlKHRhcmdldC5zZWxlY3Rpb25FbmQpCgkJdGFyZ2V0LnZhbHVlID0gYmVmb3JlK3RleHQrYWZ0ZXIKCQlyZXR1cm4gdGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKHN0YXJ0KzEsIHN0YXJ0KzEpCgl9LAoJY3Vyc29yTW92ZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGNvdW50LCBiZWdpbikgeyBiZWdpbiAhPSB1bmRlZmluZWQgJiYgdGFyZ2V0LnNldFNlbGVjdGlvblJhbmdlKGJlZ2luLCBiZWdpbikKCQl0YXJnZXQuc2V0U2VsZWN0aW9uUmFuZ2UodGFyZ2V0LnNlbGVjdGlvblN0YXJ0K2NvdW50LCB0YXJnZXQuc2VsZWN0aW9uU3RhcnQrY291bnQpCgl9LAp9KQpfY2FuX25hbWUgPSAiIgoK",
        "/page/index.css": "Ym9keSwgZmllbGRzZXQsIHRhYmxlLCB0ciwgdGgsIHRkIHsgcGFkZGluZzowOyBib3JkZXI6MDsgbWFyZ2luOjA7IH0KYm9keSB7IGJhY2tncm91bmQtY29sb3I6YmxhY2s7IGNvbG9yOmN5YW47IGZvbnQtc2l6ZToxNHB4OyBmb250LWZhbWlseTpzYW5zLXNlcmlmOyB9CgpsZWdlbmQgeyBiYWNrZ3JvdW5kLWNvbG9yOiMzMzk5OTk7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjBweCAyMHB4OyBtYXJnaW4tdG9wOjRweCA1cHg7IH0Kc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjpibGFjazsgY29sb3I6Y3lhbjsgcGFkZGluZzowIDEwcHg7IGhlaWdodDoxLjkycmVtOyB9CnRleHRhcmVhIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyBoZWlnaHQ6NjBweDsgd2lkdGg6NDAwcHg7IH0KaW5wdXRbdHlwZT1idXR0b25dIHsgYmFja2dyb3VuZC1jb2xvcjpibGFjazsgY29sb3I6Y3lhbjsgfQppbnB1dFtuYW1lPWNtZF0geyBiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyBjb2xvcjp3aGl0ZTsgd2lkdGg6MjQwcHg7IH0KaW5wdXRbdHlwZT10ZXh0XSB7IGJhY2tncm91bmQtY29sb3I6Y3lhbjsgY29sb3I6YmxhY2s7IHBhZGRpbmc6MCA0cHg7IGhlaWdodDoxLjY1cmVtOyB3aWR0aDo4MnB4OyB9CmlucHV0W3R5cGU9cGFzc3dvcmRdIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyBjb2xvcjpibGFjazsgcGFkZGluZzowIDRweDsgaGVpZ2h0OjEuNjVyZW07IHdpZHRoOjgycHg7IH0KaW5wdXRbbmFtZT13aGVyZV0geyB3aWR0aDozMjBweDsgfQppbnB1dFtuYW1lPWRhdGVdIHsgd2lkdGg6MTUwcHg7IH0KaW5wdXRbbmFtZT1wYXRoXSB7IHdpZHRoOjE2MHB4OyB9CmlucHV0W25hbWU9bGluZV0geyB3aWR0aDo0MHB4OyB9CmlucHV0W25hbWU9bGltaXRdIHsgd2lkdGg6NTBweDsgfQppbnB1dFtuYW1lPW9mZmVuZF0geyB3aWR0aDo1MHB4OyB9CmlucHV0W25hbWU9dGV4dF0geyB3aWR0aDoxNjBweDsgfQppbnB1dFtuYW1lPXVybF0geyB3aWR0aDozMjBweDsgfQoKZmllbGRzZXQucGx1Z2luLmNvbmZpZyBmb3JtLm9wdGlvbiBpbnB1dFtuYW1lPWtleV0geyB3aWR0aDoyNDBweDsgfQp0YWJsZS5sYXlvdXQgeyBib3JkZXItc3BhY2luZzowOyB9CnRhYmxlLmxheW91dCB0ZCB7IHZlcnRpY2FsLWFsaWduOnRvcDsgfQp0YWJsZS5sYXlvdXQgdGQuY29udGVudCB7IHBvc2l0aW9uOnJlbGF0aXZlOyB9CnRhYmxlLmxheW91dCBkaXYudG9nZ2xlIHsgZm9udC1zaXplOjI0cHg7IGJhY2tncm91bmQtY29sb3I6I2UxYWVhZTQ1OyBwb3NpdGlvbjphYnNvbHV0ZTsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZT5kaXYgeyBjb2xvcjp3aGl0ZTsgZGlzcGxheTp0YWJsZS1jZWxsOyB9CnRhYmxlLmxheW91dCBkaXYudG9nZ2xlLnByb2plY3QgeyBwYWRkaW5nLXRvcDogNTBweDsgaGVpZ2h0OjEwMHB4OyB3aWR0aDoxNXB4OyB0b3A6MjAlOyBsZWZ0OjBweDsgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6MTBweDsgYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6MTBweDsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZS5wcm9maWxlIHsgcGFkZGluZy10b3A6IDUwcHg7IGhlaWdodDoxMDBweDsgd2lkdGg6MTVweDsgdG9wOjIwJTsgcmlnaHQ6MHB4OyBib3JkZXItdG9wLWxlZnQtcmFkaXVzOjEwcHg7IGJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MTBweDsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZS5kaXNwbGF5IHsgb3ZlcmZsb3c6aGlkZGVuOyBtYXJnaW4tdG9wOi0xN3B4OyBoZWlnaHQ6MTVweDsgd2lkdGg6MTAwcHg7IHBvc2l0aW9uOnN0aWNreTsgbGVmdDo0MCU7IGJvcmRlci10b3AtbGVmdC1yYWRpdXM6MTBweDsgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6MTBweDsgfQp0YWJsZS5sYXlvdXQgZGl2LnRvZ2dsZS5kaXNwbGF5PmRpdiB7IGNvbG9yOndoaXRlOyB0ZXh0LWFsaWduOmNlbnRlcjsgaGVpZ2h0OjE1cHg7IHdpZHRoOjEwMHB4OyB9CmZpZWxkc2V0LkFjdGlvbi5jbWQ+ZGl2LnRvZ2dsZS5wcm9qZWN0IHsgZGlzcGxheTpub25lOyB9Cgp0YWJsZS5jb250ZW50IHRyIHsgYmFja2dyb3VuZC1jb2xvcjojMDQyNzJmNDU7IH0KdGFibGUuY29udGVudCB0ci5zaG93IHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IH0KdGFibGUuY29udGVudCB0aCB7IGJhY2tncm91bmQtY29sb3I6IzBmYmQ0NTsgcGFkZGluZzoycHggNnB4OyB9CnRhYmxlLmNvbnRlbnQgdGQgeyBwYWRkaW5nOjJweCA2cHg7IH0KdGFibGUuY29udGVudC5hY3Rpb24gdGQ6bGFzdC1jaGlsZCwgdGFibGUuY29udGVudC5hY3Rpb24gdGg6bGFzdC1jaGlsZCB7IGJhY2tncm91bmQtY29sb3I6IzdkYzZkN2ViOyBwb3NpdGlvbjpzdGlja3k7IHJpZ2h0OjA7IH0KdGFibGUuY29udGVudCB0aGVhZCB7IHBvc2l0aW9uOnN0aWNreTsgdG9wOi0xcHg7IH0KCnRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPWNyZWF0ZV0geyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IH0KdGQ+aW5wdXRbdHlwZT1idXR0b25dW25hbWU9cmVtb3ZlXSB7IGJhY2tncm91bmQtY29sb3I6cmVkOyB9CnRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPXN0YXJ0XSB7IGJhY2tncm91bmQtY29sb3I6IzUyY2U3ODsgfQp0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1vcGVuXSB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgfQp0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1zdG9wXSB7IGJhY2tncm91bmQtY29sb3I6cmVkOyB9CnRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPWRlbGV0ZV0geyBiYWNrZ3JvdW5kLWNvbG9yOnJlZDsgfQp0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1pbnNlcnRdIHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyB9CgpkaXYudGFicyB7IGJhY2tncm91bmQtY29sb3I6IzAwMDAwMDM4OyBjb2xvcjp3aGl0ZTsgcGFkZGluZzo1cHg7IG1hcmdpbjowIDFweDsgfQpkaXYuY29kZSB7IGJhY2tncm91bmQtY29sb3I6IzM0M2EzNDQ1OyBjb2xvcjp3aGl0ZTsgcGFkZGluZzoxMHB4OyBib3JkZXI6c29saWQgM3B4IGdyZWVuOyB9CmRpdi5zdG9yeVtkYXRhLXR5cGU9c3BhcmtdIHsgYmFja2dyb3VuZC1jb2xvcjojMjE2OWE5YTY7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjRweCAxMHB4OyBib3JkZXItbGVmdDpzb2xpZCA0cHggYmx1ZTsgbWFyZ2luOjEwcHg7IH0KZmllbGRzZXQucGFuZWwuU2VhcmNoIGRpdi5zdG9yeVtkYXRhLXR5cGU9c3BhcmtdIHsgcGFkZGluZzowcHg7IG1hcmdpbjowcHg7IH0KCmJvZHkubW9iaWxlIGZvcm0ub3B0aW9uPmRpdi5pdGVtIHsgbWFyZ2luLXJpZ2h0OjBweDsgfQpmb3JtLm9wdGlvbj5kaXYuaXRlbSB7IG1hcmdpbi1yaWdodDowcHg7IG1hcmdpbi1yaWdodDo1cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0uc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjojMDAwMDsgfQpmb3JtLm9wdGlvbj5kaXYuaXRlbSBpbnB1dC5hcmdzLmNoYXIgeyB3aWR0aDoyMHB4OyB9CmZvcm0ub3B0aW9uPmRpdi5pdGVtIGlucHV0LmFyZ3MudGlueSB7IHdpZHRoOjQwcHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJncy5sb25nIHsgd2lkdGg6MjQwcHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJncy5mdWxsIHsgd2lkdGg6NDgwcHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPUlEXSB7IHdpZHRoOjQ4cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPWlkXSB7IHdpZHRoOjQ4cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPWxpbWl0XSB7IHdpZHRoOjQ4cHg7IH0KZm9ybS5vcHRpb24+ZGl2Lml0ZW0gaW5wdXQuYXJnc1tuYW1lPW9mZnNldF0geyB3aWR0aDo0OHB4OyB9CmZvcm0ub3B0aW9uPmRpdi5pdGVtIGlucHV0LmFyZ3NbbmFtZT1vZmZlbmRdIHsgd2lkdGg6NDhweDsgfQpmb3JtLm9wdGlvbj5kaXYuaXRlbS50ZXh0YXJlYSB7IG1hcmdpbi10b3A6NHB4OyB9CgpkaXYuYWN0aW9uPmRpdi5pdGVtIHsgbWFyZ2luLXJpZ2h0OjNweDsgfQpkaXYuYWN0aW9uPmRpdi5pdGVtLnNlbGVjdCB7IGJhY2tncm91bmQ6bm9uZTsgfQpkaXYuYWN0aW9uPmRpdi5pdGVtLnNwYWNlIHsgd2lkdGg6MTBweDsgfQpkaXYub3V0cHV0IHsgcG9zaXRpb246cmVsYXRpdmU7IH0KZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IHsgYmFja2dyb3VuZC1jb2xvcjojNDM1ZjhjOGM7IH0KZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IGRpdi5wcm9qZWN0IHsgbWluLXdpZHRoOjg4cHg7IG1heC13aWR0aDozNjBweDsgfQpkaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2Lml0ZW0geyBwYWRkaW5nOjJweCAxMHB4OyB9CmRpdi5vdXRwdXQgdGQucHJvamVjdCBkaXYucHJvamVjdCBkaXYubGlzdCB7IG1hcmdpbi1sZWZ0OjEwcHg7IH0KZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IGRpdi5wcm9qZWN0IGRpdi5zd2l0Y2ggeyBjb2xvcjojMGQxYmMyOyB3aWR0aDoxMnB4OyBmbG9hdDpsZWZ0OyB0cmFuc2Zvcm06IHJvdGF0ZSg5MGRlZykgdHJhbnNsYXRlKDJweCwgMHB4KTsgfQpkaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2LnN3aXRjaC5vcGVuIHsgdHJhbnNmb3JtOiByb3RhdGUoMTgwZGVnKSB0cmFuc2xhdGUoLTRweCwgMXB4KTsgfQpkaXYub3V0cHV0IHRkLnByb2ZpbGUgeyBiYWNrZ3JvdW5kLWNvbG9yOiM3MTkwOWM5MTsgfQpkaXYuc3RhdHVzPmRpdi5pdGVtIHsgcGFkZGluZzo0cHg7IGhlaWdodDoxOHB4OyB9CgpmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4geyBiYWNrZ3JvdW5kLWNvbG9yOiMwNjFjM2M5ZTsgcGFkZGluZzoxMHB4OyBtYXJnaW46MTBweDsgfQpmaWVsZHNldC5wbHVnaW4gZGl2LnN0YXR1cyB7IGJvcmRlci10b3A6MXB4IHNvbGlkIGRhcmtjeWFuOyB9CmZpZWxkc2V0LnN0b3J5IGRpdi5zdGF0dXMgeyBib3JkZXItdG9wOjFweCBzb2xpZCBkYXJrY3lhbjsgfQovKiBmaWVsZHNldC5zdG9yeT5sZWdlbmQgeyBoZWlnaHQ6MzBweDsgbWFyZ2luLXJpZ2h0OjVweDsgZmxvYXQ6bGVmdDsgfSAqLwpmaWVsZHNldC5zdG9yeT5sZWdlbmQgeyBwYWRkaW5nOjAgMjBweDsgbWFyZ2luOjVweCAwOyB9CmZpZWxkc2V0LmZsb2F0IHsgYmFja2dyb3VuZC1jb2xvcjojMDIzNTMxY2Y7IH0KLyogZmllbGRzZXQuZmxvYXQ+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6YmxvY2s7IGhlaWdodDoyLjNyZW07IH0gKi8KZmllbGRzZXQuZmxvYXQgdGFibGUgeyBjb2xvcjp3aGl0ZTsgfQoKZmllbGRzZXQub3V0cHV0PmZvcm0ub3B0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0Lm91dHB1dD5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0Lm91dHB1dCBkaXYuc3RhdHVzIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0Lm91dHB1dCBkaXYudG9nZ2xlIHsgZGlzcGxheTpub25lOyB9CgpmaWVsZHNldC5pbnB1dCB7IGJhY2tncm91bmQtY29sb3I6IzBkNDE0MmE2OyB0b3A6MzJweDsgfQpmaWVsZHNldC5pbnB1dC5rZXkuZmxvYXQgZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbnB1dCBkaXYub3V0cHV0IHsgbWF4LWhlaWdodDo0MDBweDsgfQpmaWVsZHNldC5pbnB1dCB0YWJsZSB7IGNvbG9yOndoaXRlOyB9CmZpZWxkc2V0LmlucHV0IHRkIHsgd29yZC1icmVhazprZWVwLWFsbDsgfQoKYm9keT5kaXYudG9hc3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwZTMzNjliMzsgY29sb3I6eWVsbG93OyBwYWRkaW5nOjVweDsgfQpib2R5PmRpdi50b2FzdCBkaXYudGl0bGUgeyBjb2xvcjojY2FlODUwOyB3b3JkLWJyZWFrOmJyZWFrLWFsbDsgZmxvYXQ6bGVmdDsgfQpib2R5PmRpdi50b2FzdCBkaXYuZHVyYXRpb24geyBjb2xvcjpncmF5OyBmbG9hdDpyaWdodDsgfQpib2R5PmRpdi50b2FzdCBkaXYuY29udGVudCB7IHRleHQtYWxpZ246Y2VudGVyOyB9CmJvZHk+ZGl2LnRvYXN0IGRpdi5wcm9ncmVzcyB7IGJvcmRlcjpzb2xpZCAycHggZ3JlZW47IG1hcmdpbi1sZWZ0Oi0ycHg7IGhlaWdodDoxMHB4OyBjbGVhcjpib3RoOyB9CmJvZHk+ZGl2LnRvYXN0IGRpdi5wcm9ncmVzcyBkaXYuY3VycmVudCB7IGJhY2tncm91bmQtY29sb3I6cmVkOyBoZWlnaHQ6MTBweDsgfQoKYm9keT5kaXYuY2FydGUgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyOTViNjE7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjRweDsgbWluLXdpZHRoOjgwcHg7IH0KYm9keT5kaXYuY2FydGUgZGl2Lml0ZW0geyBwYWRkaW5nOjNweCAxMnB4OyB9CmJvZHk+ZGl2LmlucHV0IHsgYmFja2dyb3VuZC1jb2xvcjojMGQ0MTQyYTY7IHBhZGRpbmc6NXB4OyB9CmJvZHk+ZGl2LmlucHV0IGRpdi5pdGVtIHsgZmxvYXQ6bGVmdDsgfQpib2R5PmRpdi5pbnB1dCB0ciB0ZDpmaXJzdC1jaGlsZCB7IHRleHQtYWxpZ246Y2VudGVyOyB9CmJvZHk+ZGl2LmlucHV0IGRpdi5jb250ZW50IHsgb3ZlcmZsb3c6YXV0bzsgbWF4LWhlaWdodDoyMDBweDsgfQpib2R5PmRpdi5pbnB1dCBzZWxlY3QgeyB3aWR0aDoxODNweDsgbWFyZ2luOjVweDsgfQpib2R5PmRpdi5pbnB1dCBpbnB1dFt0eXBlPXRleHRdIHsgd2lkdGg6MTcxcHg7IG1hcmdpbjo1cHg7IH0KYm9keT5kaXYuaW5wdXQgaW5wdXRbbmFtZT11c2VybmFtZV0geyB3aWR0aDoxNzFweDsgbWFyZ2luOjVweDsgfQpib2R5PmRpdi5pbnB1dCBpbnB1dFtuYW1lPXBhc3N3b3JkXSB7IHdpZHRoOjE3MXB4OyBtYXJnaW46NXB4OyB9CmJvZHk+ZGl2LmlucHV0IHRleHRhcmVhIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyBwYWRkaW5nOjRweDsgbWFyZ2luOjVweDsgYm9yZGVyOjJweCBpbnNldCAjMTRhNThlOyBoZWlnaHQ6MTIwcHg7IHdpZHRoOjE3MXB4OyB9CmJvZHk+ZGl2LmlucHV0LmxvZ2luIHsgcGFkZGluZzoxMHB4OyB9Cgpib2R5PmRpdi51cGxvYWQgeyBiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyBjb2xvcjp5ZWxsb3c7IHBhZGRpbmc6NXB4OyB9CmJvZHk+ZGl2LnVwbG9hZCBkaXYuaXRlbSB7IGZsb2F0OmxlZnQ7IH0KYm9keT5kaXYudXBsb2FkIGRpdi5vdXRwdXQgeyBib3JkZXI6c29saWQgMXB4IHJlZDsgfQpib2R5PmRpdi51cGxvYWQgZGl2LnByb2dyZXNzIHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IGhlaWdodDoxMHB4OyB3aWR0aDowOyB9CmJvZHk+ZGl2LnVwbG9hZCBkaXYuc3RhdHVzIGRpdi5jb3N0IHsgZmxvYXQ6bGVmdDsgfQpib2R5PmRpdi51cGxvYWQgZGl2LnN0YXR1cyBkaXYuc2hvdyB7IGZsb2F0OnJpZ2h0OyB9CmJvZHk+ZGl2LnVwbG9hZCBkaXYuc3RhdHVzIGRpdi5zaXplIHsgdGV4dC1hbGlnbjpjZW50ZXI7IH0KYm9keT5kaXYudXBsb2FkIGlucHV0W3R5cGU9ZmlsZV0geyB3aWR0aDoyNDBweDsgfQoKYm9keS53aGl0ZSB7IGJhY2tncm91bmQtY29sb3I6cmdiYSg1LDM0LDU2LDAuNzUpOyBjb2xvcjp3aGl0ZTsgfQpib2R5LndoaXRlIGZpZWxkc2V0LkFjdGlvbiB7IGNvbG9yOmJsYWNrOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uPmRpdi5hY3Rpb24geyBjb2xvcjp3aGl0ZTsgfQpib2R5LndoaXRlIGZpZWxkc2V0LkFjdGlvbiBmaWVsZHNldC5wbHVnaW4geyBiYWNrZ3JvdW5kLWNvbG9yOiNmZmZmZmY3ODsgfQpib2R5LndoaXRlIGZpZWxkc2V0LkFjdGlvbiBmaWVsZHNldC5wbHVnaW4uZnVsbCB7IGJhY2tncm91bmQtY29sb3I6I2ZmZmZmZmZmOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uIGZpZWxkc2V0LnBsdWdpbi5GdWxsIHsgYmFja2dyb3VuZC1jb2xvcjojY2NlMGY0ZWI7IGNvbG9yOndoaXRlOyB6LWluZGV4OjEwOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uIGZpZWxkc2V0LnN0b3J5LkZ1bGwgeyBiYWNrZ3JvdW5kLWNvbG9yOiNjY2UwZjRlYjsgY29sb3I6d2hpdGU7IHotaW5kZXg6MTA7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5BY3Rpb24gZmllbGRzZXQucGx1Z2luLkZ1bGwgdGFibGUuY29udGVudCB7IGNvbG9yOndoaXRlOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuQWN0aW9uIGZpZWxkc2V0LnN0b3J5LkZ1bGwgdGFibGUuY29udGVudCB7IGNvbG9yOndoaXRlOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuU2VhcmNoIHRhYmxlIHsgY29sb3I6d2hpdGU7IH0KYm9keS53aGl0ZSBmaWVsZHNldC53b3JkLmZsb2F0IHsgYmFja2dyb3VuZC1jb2xvcjojM2Q1NTY5OyBjb2xvcjpibGFjazsgfQoKYm9keS53aGl0ZSBsZWdlbmQgeyBib3JkZXItcmFkaXVzOjEwcHggMTBweCAxMHB4IDEwcHg7IH0KYm9keS53aGl0ZSBzZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiM5OUNDNjY7IGNvbG9yOndoaXRlOyBib3JkZXI6MnB4IHNvbGlkICM5OUNDNjY7IGJvcmRlci1yYWRpdXM6MTBweCAxMHB4IDEwcHggMTBweDsgfQpib2R5LndoaXRlIGlucHV0W3R5cGU9YnV0dG9uXSB7IGJhY2tncm91bmQtY29sb3I6I0ZGOTkwMDsgY29sb3I6d2hpdGU7IGJvcmRlcjoycHggc29saWQgI0ZGOTkwMDsgYm9yZGVyLXJhZGl1czoxMHB4OyB9CmJvZHkud2hpdGUgaW5wdXRbdHlwZT10ZXh0XSB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOmJsYWNrOyBib3JkZXI6MnB4IHNvbGlkICMxNGE1OGU7IGJvcmRlci1yYWRpdXM6NnB4OyB9CmJvZHkud2hpdGUgaW5wdXRbdHlwZT1wYXNzd29yZF0geyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsgYm9yZGVyOjJweCBzb2xpZCAjMTRhNThlOyBib3JkZXItcmFkaXVzOjZweDsgfQpib2R5LndoaXRlIGlucHV0W25hbWU9Y21kXSB7IGJhY2tncm91bmQtY29sb3I6YmxhY2s7IGNvbG9yOndoaXRlOyB3aWR0aDoyNDBweDsgfQoKYm9keS53aGl0ZSB0YWJsZS5jb250ZW50IHsgY29sb3I6YmxhY2s7IH0KYm9keS53aGl0ZSB0YWJsZS5jb250ZW50IHRyIHsgYmFja2dyb3VuZC1jb2xvcjojZTFmMWZmMWY7IH0KYm9keS53aGl0ZSB0YWJsZS5jb250ZW50IHRoIHsgYmFja2dyb3VuZC1jb2xvcjojOTlDQ0ZGOyB9Cgpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPee7k+adn10geyBiYWNrZ3JvdW5kLWNvbG9yOnJlZDsgfQpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPXN0b3BdIHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IH0KYm9keS53aGl0ZSB0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1vcGVuXSB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgfQpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPXN0YXJ0XSB7IGJhY2tncm91bmQtY29sb3I6IzUyY2U3ODsgfQpib2R5LndoaXRlIHRkPmlucHV0W3R5cGU9YnV0dG9uXVtuYW1lPWNyZWF0ZV0geyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IH0KYm9keS53aGl0ZSB0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1yZW1vdmVdIHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IH0KYm9keS53aGl0ZSB0ZD5pbnB1dFt0eXBlPWJ1dHRvbl1bbmFtZT1pbnNlcnRdIHsgYmFja2dyb3VuZC1jb2xvcjpibHVlOyB9CmJvZHkud2hpdGUgdGQ+aW5wdXRbdHlwZT1idXR0b25dW25hbWU9ZGVsZXRlXSB7IGJhY2tncm91bmQtY29sb3I6cmVkOyB9Cgpib2R5LnByaW50IHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IH0KYm9keS5wcmludCBsZWdlbmQsIGJvZHkucHJpbnQgc2VsZWN0LCBib2R5LnByaW50IGlucHV0W3R5cGU9dGV4dF0geyBib3gtc2hhZG93OjBweCAwcHggMHB4IDBweCAjNjI2YmQwOyB9CmJvZHkucHJpbnQgZmllbGRzZXQuSGVhZGVyLCBib2R5LnByaW50IGZpZWxkc2V0LlJpdmVyLCBib2R5LnByaW50IGZpZWxkc2V0LkFjdGlvbiwgYm9keS5wcmludCBmaWVsZHNldC5Gb290ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsgfQpib2R5LnByaW50IGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lml0ZW0uc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgYm9yZGVyOnNvbGlkIDJweCByZWQ7IH0KYm9keS5wcmludCBmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IGRpdi5pdGVtIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgfQoKYm9keS5tb2JpbGU+ZGl2LmlucHV0IGlucHV0W25hbWU9dXNlcm5hbWVdIHsgd2lkdGg6MjY0cHg7IH0KYm9keS5tb2JpbGU+ZGl2LmlucHV0IGlucHV0W25hbWU9cGFzc3dvcmRdIHsgd2lkdGg6MjY0cHg7IH0KYm9keS5tb2JpbGUgbGVnZW5kIHsgZm9udC1zaXplOjEuNnJlbTsgfQpib2R5Lm1vYmlsZSBpbnB1dCB7IGZvbnQtc2l6ZToxLjRyZW07IH0KYm9keS5tb2JpbGUgdGV4dGFyZWEgeyBmb250LXNpemU6MS4ycmVtOyB9CmJvZHkubW9iaWxlIGlucHV0W3R5cGU9dGV4dF0geyBwYWRkaW5nLXRvcDozcHg7IGhlaWdodDoyLjQ3cmVtOyB9CmJvZHkubW9iaWxlLndoaXRlIGlucHV0W3R5cGU9dGV4dF0geyBwYWRkaW5nLXRvcDozcHg7IGhlaWdodDoyLjM1cmVtOyB9CmJvZHkubW9iaWxlIHNlbGVjdCB7IGZvbnQtc2l6ZToxLjRyZW07IG1hcmdpbi10b3A6M3B4OyBoZWlnaHQ6NDJweDsgfQpib2R5Lm1vYmlsZT5kaXYuY2FydGUgeyBmb250LXNpemU6MS42cmVtOyB9CmJvZHkubW9iaWxlPmRpdi5jYXJ0ZSBkaXYuaXRlbSB7IGZvbnQtc2l6ZToxLjZyZW07IH0KYm9keS5tb2JpbGU+ZGl2LmlucHV0LmxvZ2luIGlucHV0IHsgZm9udC1zaXplOjEuNHJlbTsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5IZWFkZXIuaGVhZCB7IHdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyLmhlYWQgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMDAwMDBiODsgZm9udC1zaXplOjEuNnJlbTsgaGVpZ2h0OjNyZW07IHBvc2l0aW9uOmZpeGVkOyB0b3A6MDsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5IZWFkZXIuaGVhZCBkaXYub3V0cHV0IHsgaGVpZ2h0OjNyZW07IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyLmhlYWQ+ZGl2Lm91dHB1dCBkaXYubWVudSB7IGhlaWdodDoyLjZyZW07IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyLmhlYWQgZGl2LnN0YXRlLnRpbWUgeyBkaXNwbGF5Om5vbmU7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaD5pbnB1dCB7IGhlaWdodDozOHB4OyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZSBmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dD5kaXYuc2VhcmNoPmlucHV0IHsgd2lkdGg6MjQwcHg7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuUml2ZXIubGVmdCB7IGJhY2tncm91bmQtY29sb3I6IzI0Mzk1MGJmOyBmb250LXNpemU6MnJlbTsgbWluLXdpZHRoOjI0MHB4OyBwb3NpdGlvbjpmaXhlZDsgdG9wOjNyZW07IHotaW5kZXg6MTA7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCB7IHdpZHRoOjMyMHB4OyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lml0ZW0geyBmb250LXNpemU6MS42cmVtOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LkFjdGlvbi5tYWluIHsgbWFyZ2luLXRvcDozcmVtOyBtYXJnaW4tYm90dG9tOjNyZW07IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuQWN0aW9uLm1haW4uY21kIHsgbWFyZ2luLXRvcDowOyBtYXJnaW4tYm90dG9tOjA7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuRm9vdGVyLmZvb3QgeyB3aWR0aDotd2Via2l0LWZpbGwtYXZhaWxhYmxlOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LkZvb3Rlci5mb290IHsgYmFja2dyb3VuZC1jb2xvcjojMDAwMDAwYjg7IGZvbnQtc2l6ZToxLjZyZW07IGhlaWdodDozcmVtOyBwb3NpdGlvbjpmaXhlZDsgYm90dG9tOjA7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuRm9vdGVyLmZvb3QgZGl2Lm91dHB1dCB7IGhlaWdodDozcmVtOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LkZvb3Rlci5mb290PmRpdi5vdXRwdXQgZGl2IHsgaGVpZ2h0OjIuNnJlbTsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5Gb290ZXI+ZGl2Lm91dHB1dCBpbnB1dFtuYW1lPWNtZF0geyBoZWlnaHQ6MzhweDsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgaW5wdXRbbmFtZT1jbWRdIHsgd2lkdGg6MjQwcHg7IH0KYm9keS5tb2JpbGUubGFuZHNjYXBlIGZpZWxkc2V0LkhlYWRlci5oZWFkIHsgcG9zaXRpb246dW5zZXQ7IH0KYm9keS5tb2JpbGUubGFuZHNjYXBlIGZpZWxkc2V0LkhlYWRlci5oZWFkIGRpdi5zdGF0ZS50aW1lIHsgZGlzcGxheTpibG9jazsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuQWN0aW9uLm1haW4geyBtYXJnaW4tdG9wOjA7IG1hcmdpbi1ib3R0b206MDsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuRm9vdGVyLmZvb3QgeyBwb3NpdGlvbjp1bnNldDsgfQoKYm9keS5tb2JpbGUgZmllbGRzZXQuZHJhdy5zcGlkZSBkaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LmRyYXcudHJlbmQgZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuZHJhdy5zcGlkZSBkaXYuYWN0aW9uIHsgZGlzcGxheTpibG9jazsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQuZHJhdy50cmVuZCBkaXYuYWN0aW9uIHsgZGlzcGxheTpibG9jazsgfQoKLyogZm9udCAqLwoqIHsgdGFiLXNpemU6NDsgfQp0ZXh0YXJlYSB7IHRhYi1zaXplOjI7IH0KbGVnZW5kIHsgZm9udC1zaXplOjEuMnJlbTsgfQpzZWxlY3QsIGlucHV0IHsgZm9udC1zaXplOjEuMXJlbTsgfQp0YWJsZS5jb250ZW50IHRoLCB0YWJsZS5jb250ZW50IHRkLCBkaXYuaXRlbSwgZGl2LnRhYnMsIGRpdi5jb2RlLCBjb2RlLnN0b3J5LCBkaXYuc3RvcnlbZGF0YS10eXBlPXNwYXJrXSB7IGZvbnQtc2l6ZToxLjFyZW07IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgfQpkaXYuc3RhdHVzPmRpdi5pdGVtPmxhYmVsIHsgZm9udC1zaXplOjAuNnJlbTsgZm9udC1mYW1pbHk6bW9ub3NwYWNlOyB9CnN2ZyB7IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsgfQoKLyogZGlzcGxheSAqLwpmb3JtLm9wdGlvbiwgZGl2LmFjdGlvbiB7IGRpc3BsYXk6Y29udGVudHM7IH0KLmhpZGUsIC5oaWRkZW4sIGZvcm0ub3B0aW9uPmRpdi5pdGVtPmxhYmVsLCBkaXYuYWN0aW9uPmRpdi5pdGVtPmxhYmVsLCBmaWVsZHNldC5wYW5lbD5sZWdlbmQsIGZpZWxkc2V0Lm91dHB1dD5sZWdlbmQsIGZpZWxkc2V0LmlucHV0PmxlZ2VuZCB7IGRpc3BsYXk6bm9uZTsgfQpkaXYub3V0cHV0LCBkaXYuc3RhdHVzLCBkaXYuY29udGVudCwgZGl2LnByb2plY3QgZGl2Lml0ZW0sIGRpdi5pdGVtLnRleHRhcmVhLCBkaXYuY29kZSwgZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya10sIHAuc3RvcnksIGgxLCBoMiwgaDMgeyBjbGVhcjpib3RoOyB9CmZvcm0ub3B0aW9uLCBmb3JtLm9wdGlvbj5kaXYuaXRlbSwgZGl2LmFjdGlvbiwgZGl2LmFjdGlvbj5kaXYuaXRlbSwgZGl2LmFjdGlvbj5kaXYudGFicywgZGl2LnByb2plY3QsIGRpdi5zdGF0dXM+ZGl2Lml0ZW0sIGZpZWxkc2V0LmZsb2F0PmxlZ2VuZCB7IGZsb2F0OmxlZnQ7IH0KZGl2LmNvZGUsIGRpdi5zdG9yeSwgZGl2LmFjdGlvbiwgZGl2Lm91dHB1dCwgZGl2LnN0YXR1cywgZGl2LnByb2plY3QsIGRpdi5jb250ZW50LCBkaXYucHJvZmlsZSwgZGl2LmRpc3BsYXksIHRhYmxlLmNvbnRlbnQsIHRhYmxlLmNvbnRlbnQgdGQsIGJvZHk+ZGl2LnRvYXN0IHsgb3ZlcmZsb3c6YXV0bzsgfQpkaXYuY29kZSwgZGl2LnN0b3J5LCBkaXYuaXRlbSwgZGl2LmNvbnRlbnQsIHRhYmxlLmNvbnRlbnQsIHRleHRhcmVhIHsgd2hpdGUtc3BhY2U6cHJlOyB9CmRpdi5jb2RlLCBkaXYuc3RvcnksIGRpdi5pdGVtIHsgdGV4dC1hbGlnbjpsZWZ0OyB9CgovKiBwb3NpdGlvbiBjdXJzb3IgKi8KZmllbGRzZXQuZmxvYXQsIGZpZWxkc2V0LmlucHV0LCBib2R5PmRpdi50b2FzdCwgYm9keT5kaXYuY2FydGUsIGJvZHk+ZGl2LmlucHV0LCBib2R5PmRpdi51cGxvYWQgeyBwb3NpdGlvbjpmaXhlZDsgei1pbmRleDoxMDsgfQpsZWdlbmQsIHNlbGVjdCwgaW5wdXRbdHlwZT1idXR0b25dLCBkaXYuaXRlbSwgZGl2LnRhYnMsIHRoLCB0ZCwgaDEsIGgyLCBoMyB7IGN1cnNvcjpwb2ludGVyOyB9CmRpdi50aXRsZSwgZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya10geyBjdXJzb3I6Y29weTsgfQoKLyogYm94LXNoYWRvdyAqLwpmaWVsZHNldC5wbHVnaW4geyBib3gtc2hhZG93OjJweCAycHggMTBweCA0cHggIzYyNmJkMDsgfQpmaWVsZHNldC5wbHVnaW46aG92ZXIgeyBib3gtc2hhZG93OjRweCA0cHggMTJweCA2cHggIzYyNmJkMDsgfQpmaWVsZHNldC5zdG9yeSB7IGNsZWFyOmJvdGg7IGZsb2F0OmxlZnQ7IGJveC1zaGFkb3c6NHB4IDRweCAxMHB4IDFweCAjNjI2YmQwOyB9CmZpZWxkc2V0LnN0b3J5OmhvdmVyIHsgYm94LXNoYWRvdzoxMnB4IDEycHggMTJweCA2cHggIzU3NjRlZmQxOyB9CmRpdi5zdG9yeVtkYXRhLXR5cGU9c3BhcmtdIHsgYm94LXNoYWRvdzo0cHggNHB4IDEwcHggMXB4ICM2MjZiZDA7IH0KZGl2LnN0b3J5W2RhdGEtdHlwZT1zcGFya10gc3Bhbjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6ZGVlcHNreWJsdWU7IGJveC1zaGFkb3c6NHB4IDRweCAyMHB4IDRweCAjMjkzMThlOyB9CmxlZ2VuZCwgc2VsZWN0LCB0ZXh0YXJlYSwgaW5wdXRbdHlwZT10ZXh0XSwgZGl2LmNvZGUgeyBib3gtc2hhZG93OjRweCA0cHggMjBweCA0cHggIzYyNmJkMDsgfQoKLyogaG92ZXIgKi8KLnNlbGVjdCwgZGl2Lml0ZW0uc2VsZWN0LCBkaXYuaXRlbTpob3ZlciwgdGFibGUuY29udGVudCB0aDpob3ZlciwgdGFibGUuY29udGVudCB0ZC5zZWxlY3QsIHRhYmxlLmNvbnRlbnQgdGQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOmNvcm5mbG93ZXJibHVlOyB9CmRpdi50YWJzLnNlbGVjdCwgZGl2LnRhYnM6aG92ZXIsIHRhYmxlLmNvbnRlbnQgdHIuc2VsZWN0LCB0YWJsZS5jb250ZW50IHRyOmhvdmVyLCBoMTpob3ZlciwgaDI6aG92ZXIsIGgzOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpzdGVlbGJsdWU7IH0KCmlucHV0W3R5cGU9dGV4dF06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyB9CmlucHV0W25hbWU9Y21kXTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOmJsYWNrOyB9CmlucHV0W3R5cGU9YnV0dG9uXTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6Z3JheTsgY29sb3I6Y3lhbjsgfQoKYm9keS53aGl0ZSBsZWdlbmQ6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOnNreWJsdWU7IH0KYm9keS53aGl0ZSBpbnB1dFt0eXBlPXRleHRdOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpjeWFuOyB9CmJvZHkud2hpdGUgaW5wdXRbbmFtZT1jbWRdOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IH0KYm9keS53aGl0ZSBpbnB1dFt0eXBlPWJ1dHRvbl06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiNGRkNDMzM7IGJvcmRlcjoycHggc29saWQgI0ZGQ0MzMzsgfQpib2R5LndoaXRlIHRhYmxlLmNvbnRlbnQgdGg6aG92ZXIsIGJvZHkud2hpdGUgdGFibGUuY29udGVudCB0ZC5zZWxlY3QsIGJvZHkud2hpdGUgdGFibGUuY29udGVudCB0ZDpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzY0OTVlZDYzOyB9CmJvZHkud2hpdGUgdGFibGUuY29udGVudCB0cjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzQ2ODJiNDZiOyB9CmJvZHkud2hpdGUgZGl2Lml0ZW0uc2VsZWN0LCBib2R5LndoaXRlIGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpzdGVlbGJsdWU7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5mbG9hdCB0YWJsZSB7IGNvbG9yOndoaXRlOyB9Cgpib2R5Lm1vYmlsZSBkaXYub3V0cHV0IGRpdi5jb2RlIHsgZm9udC1zaXplOjEycHg7IH0KYm9keS5tb2JpbGUgZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtIHsgaGVpZ2h0OjE2MHB4OyBmbG9hdDpub25lOyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW0geyB3aWR0aDphdXRvOyBmbG9hdDpsZWZ0OyB9CmRpdi5vdXRwdXQuY2FyZCBkaXYuaXRlbSB7IHBhZGRpbmc6MTBweDsgYm9yZGVyOnNvbGlkIDFweCAjZTdlN2U3OyBtYXJnaW46MTBweDsgaGVpZ2h0OjEyMHB4OyB3aWR0aDoyNDBweDsgZmxvYXQ6bGVmdDsgcG9zaXRpb246cmVsYXRpdmU7IH0KZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtPmRpdi50aXRsZSB7IGZvbnQtc2l6ZToxLjJyZW07IGZvbnQtd2VpZ2h0OmJvbGQ7IHBhZGRpbmc6MTBweDsgYm9yZGVyLWJvdHRvbTogc29saWQgMXB4ICNlN2U3ZTc7IH0KZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtPmRpdi5jb250ZW50IHsgcGFkZGluZzoxMHB4OyBoZWlnaHQ6MjRweDsgfQoKYm9keS5zaW1wbGUgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkhlYWRlciB7IGJvcmRlci1ib3R0b206c29saWQgMXB4ICNlN2U3ZTc7IGhlaWdodDo2MHB4OyBkaXNwbGF5OmJsb2NrOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LlJpdmVyIHsgYm9yZGVyLXJpZ2h0OnNvbGlkIDFweCAjZTdlN2U3OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgeyBwYWRkaW5nOjEwcHggMTBweDsgd2lkdGg6MjAwcHg7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbSB7IGNvbG9yOmJsYWNrOyBwYWRkaW5nOjEwcHggNDBweDsgYm9yZGVyLWxlZnQ6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5pdGVtLnNlbGVjdCB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzAxNTJkOTsgY29sb3I6d2hpdGU7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYubGlzdCBkaXYuaXRlbSB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOmJsYWNrOyBib3JkZXItbGVmdDpub25lOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lmxpc3QgZGl2Lml0ZW0uc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjojMDE1MmQ5OyBjb2xvcjp3aGl0ZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjojMDE1MmQ5OyBjb2xvcjp3aGl0ZTsgfQoKYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuQWN0aW9uIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2LmFjdGlvbiB7IGJhY2tncm91bmQ6d2hpdGU7IHBhZGRpbmc6MTBweDsgYm9yZGVyLWJvdHRvbTogc29saWQgMXB4IHJlZDsgaGVpZ2h0OjM4cHg7IHdpZHRoOjYwMHB4OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkFjdGlvbj5kaXYuYWN0aW9uIGRpdi50YWJzIHsgcGFkZGluZzoxMHB4OyBtYXJnaW46MTBweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24udGFicz5kaXYub3V0cHV0IHsgbWFyZ2luLXRvcDo1OHB4OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkFjdGlvbj5kaXYub3V0cHV0PmZpZWxkc2V0LnBsdWdpbi5pbm5lciB7IGJveC1zaGFkb3c6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4uaW5uZXI+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LkFjdGlvbj5kaXYub3V0cHV0PmZpZWxkc2V0LnBsdWdpbi5pbm5lcj5mb3JtLm9wdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4uaW5uZXI+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5BY3Rpb24+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4uaW5uZXI+ZGl2LnN0YXR1cyB7IGRpc3BsYXk6bm9uZTsgfQoKYm9keS5zaW1wbGUgZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtIHsgbWluLXdpZHRoOjI0MHB4OyBib3JkZXItcmFkaXVzOjVweDsgYm94LXNoYWRvdzoycHggMnB4IDZweCAxcHggZ3JheTsgfQpib2R5LnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBib3gtc2hhZG93OjVweCA1cHggMTBweCA1cHggZ3JheTsgfQpib2R5LnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW0+ZGl2LnRpdGxlIHsgYm9yZGVyLWJvdHRvbTpzb2xpZCAxcHggI2U3ZTdlNzsgfQpib2R5LndoaXRlLnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgaW5wdXRbdHlwZT1idXR0b25dOmhvdmVyIHsgYm94LXNoYWRvdzoycHggMnB4IDhweCAycHggZ3JheTsgfQpib2R5LndoaXRlLnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgaW5wdXRbdHlwZT1idXR0b25dIHsgYm94LXNoYWRvdzoycHggMnB4IDZweCAxcHggZ3JheTsgY29sb3I6d2hpdGU7IH0KYm9keS53aGl0ZS5zaW1wbGUgZGl2Lm91dHB1dC5jYXJkIGlucHV0W3R5cGU9YnV0dG9uXSB7IGJhY2tncm91bmQtY29sb3I6IzAxNTJkOTsgZm9udC1zaXplOjAuOHJlbTsgcGFkZGluZzo1cHggMTBweDsgYm9yZGVyOm5vbmU7IGJvcmRlci1yYWRpdXM6NXB4OyB9CmJvZHkubW9iaWxlLnNpbXBsZSBkaXYub3V0cHV0LmNhcmQgZGl2Lml0ZW0geyB3aWR0aDotd2Via2l0LWZpbGwtYXZhaWxhYmxlOyB9CmJvZHkubW9iaWxlLmxhbmRzY2FwZS5zaW1wbGUgZGl2Lm91dHB1dC5jYXJkIGRpdi5pdGVtIHsgd2lkdGg6YXV0bzsgZmxvYXQ6bGVmdDsgfQoKYm9keS53aGl0ZS5zaW1wbGU+ZGl2LmNhcnRlIHsgYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6YmxhY2s7IGJvcmRlcjpzb2xpZCAxcHggI2U3ZTdlNzsgfQpib2R5LndoaXRlLnNpbXBsZT5kaXYuY2FydGUgZGl2Lml0ZW0geyBmb250LXNpemU6MXJlbTsgfQpib2R5LndoaXRlLnNpbXBsZT5kaXYuY2FydGUgZGl2Lml0ZW06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMTUyZDk7IGNvbG9yOndoaXRlOyB9CmJvZHkud2hpdGUuc2ltcGxlIGlucHV0W3R5cGU9YnV0dG9uXSB7IGJhY2tncm91bmQtY29sb3I6IzAxNTJkOTsgYm9yZGVyOm5vbmU7IGJvcmRlci1yYWRpdXM6NXB4OyBoZWlnaHQ6MzFweDsgYm94LXNoYWRvdzoycHggMnB4IDZweCAxcHggZ3JheTsgfQoK",
        "/page/index.html": "PCFET0NUWVBFIGh0bWw+CjxoZWFkPgogICAgPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCxpbml0aWFsLXNjYWxlPTAuOCxtYXhpbXVtLXNjYWxlPTAuOCx1c2VyLXNjYWxhYmxlPTAiPgogICAgPG1ldGEgY2hhcnNldD0idXRmLTgiPjx0aXRsZT52b2xjYW5vczwvdGl0bGU+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIiBocmVmPSIvcGFnZS9pbmRleC5jc3MiPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiB0eXBlPSJ0ZXh0L2NzcyIgaHJlZj0iL3BhZ2UvY2FjaGUuY3NzIj4KICAgIDxsaW5rIHJlbD0ic2hvcnRjdXQgaWNvbiIgdHlwZT0iaW1hZ2UvaWNvIiBocmVmPSIvZmF2aWNvbi5pY28iPgo8L2hlYWQ+Cjxib2R5PgogICAgPHNjcmlwdCBzcmM9Ii9wcm90by5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iL3BhZ2UvY2FjaGUuanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9Ii9wYWdlL2luZGV4LmpzIj48L3NjcmlwdD4KPC9ib2R5PgoK",
        "/page/index.js": "Vm9sY2Fub3Moe25hbWU6ICJjaGF0IiwgcGFuZWxzOiBbCgkJe25hbWU6ICJIZWFkZXIiLCBoZWxwOiAi5qCH6aKY5qCPIiwgcG9zOiBjaGF0LkhFQUQsIHN0YXRlOiBbInRpbWUiLCAidXNlcm5pY2siLCAiYXZhdGFyIl19LAoJCXtuYW1lOiAiUml2ZXIiLCAgaGVscDogIue+pOiBiue7hCIsIHBvczogaHRtbC5MRUZULCBhY3Rpb246IFsiY3JlYXRlIiwgInJlZnJlc2giXX0sCgkJe25hbWU6ICJBY3Rpb24iLCBoZWxwOiAi5bel5L2c5Y+wIiwgcG9zOiBjaGF0Lk1BSU59LAoJCXtuYW1lOiAiRm9vdGVyIiwgaGVscDogIueKtuaAgeadoSIsIHBvczogY2hhdC5GT09ULCBzdGF0ZTogWyJuY21kIl19LAoJCXtuYW1lOiAiU2VhcmNoIiwgaGVscDogIuaQnOe0ouahhiIsIHBvczogY2hhdC5BVVRPfSwKCV0sIG1haW46IHtuYW1lOiAiSGVhZGVyIiwgbGlzdDogWyIvcHVibGlzaC9vcmRlci5qcyJdfSwgcml2ZXI6IHsKCXByb2R1Y3Q6IHtuYW1lOiAi5Lqn5ZOB576kIiwgc3Rvcm06IHsKCQlvZmZpY2U6IHtuYW1lOiAi5Yqe5YWsIG9mZmljZSIsICBsaXN0OiBbCgkJCXtuYW1lOiAiZmVlbCIsIGhlbHA6ICLlvbHpn7PlqpLkvZMiLCBpbmRleDogIndlYi53aWtpLmZlZWwifSwKCQkJe25hbWU6ICJkcmF3IiwgaGVscDogIuaAnee7tOWvvOWbviIsIGluZGV4OiAid2ViLndpa2kuZHJhdyJ9LAoJCQl7bmFtZTogImRhdGEiLCBoZWxwOiAi5pWw5o2u6KGo5qC8IiwgaW5kZXg6ICJ3ZWIud2lraS5kYXRhIn0sCgkJCXtuYW1lOiAicGxhbiIsIGhlbHA6ICLorqHliJLku7vliqEiLCBpbmRleDogIndlYi50ZWFtLnBsYW4ifSwKCQkJe25hbWU6ICJjb250ZXh0IiwgaGVscDogIue8lueoiyIsIGluZGV4OiAid2ViLndpa2kud29yZCIsIGFyZ3M6IFsic3JjL21haW4uc2h5Il19LAoJCV19LAoJfX0sCglwcm9qZWN0OiB7bmFtZTogIueglOWPkee+pCIsIHN0b3JtOiB7CgkJc3R1ZGlvOiB7bmFtZTogIueglOWPkSBzdHVkaW8iLCBsaXN0OiBbCgkJCXtuYW1lOiAidmltZXIiLCBoZWxwOiAi57yW6L6R5ZmoIiwgaW5kZXg6ICJ3ZWIuY29kZS52aW1lciJ9LAoJCQl7bmFtZTogInJlcG9zIiwgaGVscDogIuS7o+eggeW6kyIsIGluZGV4OiAid2ViLmNvZGUuZ2l0LnN0YXR1cyJ9LAoJCQl7bmFtZTogInBsYW4iLCBoZWxwOiAi5Lu75Yqh6KGoIiwgaW5kZXg6ICJ3ZWIudGVhbS5wbGFuIn0sCgkJCXtuYW1lOiAidG9kbyIsIGhlbHA6ICLlvoXlip7pobkiLCBpbmRleDogIndlYi50ZWFtLnRvZG8ifSwKCQkJe25hbWU6ICJjdHgiLCBoZWxwOiAi5LiK5LiL5paHIiwgaW5kZXg6ICJ3ZWIud2lraS53b3JkIn0sCgkJXX0sCgl9fSwKCXByb2ZpbGU6IHtuYW1lOiAi5rWL6K+V576kIiwgc3Rvcm06IHsKCQl3ZWJzaXRlOiB7bmFtZTogIuWumuWItiB3ZWJzaXRlIiwgaW5kZXg6IFsKCQkJIndlYi5jaGF0LndlYnNpdGUiLAoJCQkid2ViLmNoYXQuZGl2IiwKCQkJIndlYi5jb2RlLnZpbWVyIiwKCQkJIndlYi5kcmVhbSIsCgkJXX0sCgkJcmVsZWFzZToge25hbWU6ICLlj5HluIMgcmVsZWFzZSIsIGluZGV4OiBbCgkJCSJ3ZWIuY29kZS5pbnN0YWxsIiwgIndlYi5jb2RlLnVwZ3JhZGUiLCAid2ViLmNvZGUucHVibGlzaCIsICJ3ZWIuY29kZS5jb21waWxlIiwgIndlYi5jb2RlLmF1dG9nZW4iLCAid2ViLmNvZGUuYmlucGFjayIsICJ3ZWIuY29kZS53ZWJwYWNrIiwKCQkJIndlYi5jb2RlLmdpdC5zdGF0dXMiLCAid2ViLmNvZGUuZ2l0LnNlcnZlciIsCgkJXX0sCgkJcmVzZWFyY2g6IHtuYW1lOiAi5rWL6K+VIHJlc2VhcmNoIiwgaW5kZXg6IFsKCQkJIndlYi5jb2RlLmZhdm9yIiwgIndlYi5jb2RlLmJlbmNoIiwgIndlYi5jb2RlLnBwcm9mIiwKCQkJIndlYi5jb2RlLmNhc2UiLAoJCV19LAoJfX0sCglvcGVyYXRlOiB7bmFtZTogIui/kOe7tOe+pCIsIHN0b3JtOiB7CgkJYWFhOiB7bmFtZTogIuadg+mZkCBhYWEiLCBpbmRleDogWwoJCQkidXNlciIsICJ0b3RwIiwgInNlc3MiLCAicm9sZSIsCgkJXX0sCgkJd2ViOiB7bmFtZTogIuW6lOeUqCB3ZWIiLCBpbmRleDogWwoJCQkic2VydmUiLCAic3BhY2UiLCAiZHJlYW0iLCAicm91dGUiLAoJCQkic2hhcmUiLCAic3BpZGUiLCAiY2FjaGUiLCAic3RvcnkiLAoJCV19LAoJCWNsaToge25hbWU6ICLns7vnu58gY2xpIiwgaW5kZXg6IFsKCQkJInFyY29kZSIsICJkYWVtb24iLCAic3lzdGVtIiwgInJ1bnRpbWUiLAoJCV19LAoJCW5mczoge25hbWU6ICLmlofku7YgbmZzIiwgaW5kZXg6IFsKCQkJImNhdCIsICJkaXIiLCAidGFpbCIsICJ0cmFzaCIsCgkJXX0sCgl9fSwKfX0pCg==",
        "/panel/action.css": "ZmllbGRzZXQuQWN0aW9uIHsgYmFja2dyb3VuZC1jb2xvcjpyZ2JhKDExNCwgMTUzLCAxNjIsIDAuNTQpOyBtaW4td2lkdGg6MTYwcHg7IH0KZmllbGRzZXQuQWN0aW9uPmRpdi5hY3Rpb24geyBiYWNrZ3JvdW5kLWNvbG9yOiMxNTljYzdiMDsgcGFkZGluZzowOyBtYXJnaW46MDsgaGVpZ2h0OjI4cHg7IGRpc3BsYXk6bm9uZTsgcG9zaXRpb246YWJzb2x1dGU7IH0KCmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5hY3Rpb24geyBkaXNwbGF5OmJsb2NrOyB9CmZpZWxkc2V0LkFjdGlvbi50YWJzPmRpdi5vdXRwdXQgeyBtYXJnaW4tdG9wOjI4cHg7IH0KZmllbGRzZXQuQWN0aW9uLnRhYnM+ZGl2Lm91dHB1dD5maWVsZHNldD5sZWdlbmQgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuQWN0aW9uLnRhYnM+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4geyBkaXNwbGF5Om5vbmU7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuQWN0aW9uLnRhYnM+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4uc2VsZWN0IHsgZGlzcGxheTpibG9jazsgfQpmaWVsZHNldC5BY3Rpb24uZ3JpZD5kaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbiB7IG92ZXJmbG93OmF1dG87IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuQWN0aW9uLmdyaWQ+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4+ZGl2Lm91dHB1dCB7IG92ZXJmbG93OmF1dG87IH0KZmllbGRzZXQuQWN0aW9uLmZyZWU+ZGl2Lm91dHB1dCBmaWVsZHNldC5wbHVnaW4geyBwb3NpdGlvbjphYnNvbHV0ZTsgfQpmaWVsZHNldC5BY3Rpb24uZnJlZT5kaXYub3V0cHV0IGZpZWxkc2V0LnBsdWdpbi5zZWxlY3QgeyBkaXNwbGF5OmJsb2NrOyB9CmZpZWxkc2V0LkFjdGlvbi5mbG93PmRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luIHsgZmxvYXQ6bGVmdDsgfQoKZmllbGRzZXQuQWN0aW9uIGRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luLkZ1bGwgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwNzM5NDdmMjsgcGFkZGluZzowOyBtYXJnaW46MDsgcG9zaXRpb246Zml4ZWQ7IGxlZnQ6MDsgdG9wOjA7IG92ZXJmbG93OmF1dG87IHotaW5kZXg6MTA7IH0KZmllbGRzZXQuQWN0aW9uIGRpdi5vdXRwdXQgZmllbGRzZXQucGx1Z2luLkZ1bGw+bGVnZW5kIHsgZmxvYXQ6bGVmdDsgZGlzcGxheTpjb250ZW50czsgfQpmaWVsZHNldC5BY3Rpb24gZGl2Lm91dHB1dCBmaWVsZHNldC5zdG9yeS5GdWxsIHsgYmFja2dyb3VuZC1jb2xvcjojMDczOTQ3ZjI7IHBhZGRpbmc6MDsgbWFyZ2luOjA7IHBvc2l0aW9uOmZpeGVkOyBsZWZ0OjA7IHRvcDowOyBvdmVyZmxvdzphdXRvOyB6LWluZGV4OjEwOyB9CmZpZWxkc2V0LkFjdGlvbiBkaXYub3V0cHV0IGZpZWxkc2V0LnN0b3J5LkZ1bGw+bGVnZW5kIHsgaGVpZ2h0OjMwcHg7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuQWN0aW9uPmRpdi5wcm9qZWN0LnRvZ2dsZSB7CgliYWNrZ3JvdW5kLWNvbG9yOmNvcm5zaWxrOyBvcGFjaXR5OjAuNDsgY29sb3I6dGVhbDsgZm9udC1zaXplOiAyOHB4OyBwYWRkaW5nLXRvcDogNTBweDsgaGVpZ2h0OiAxMDBweDsgd2lkdGg6MjBweDsgcG9zaXRpb246IGZpeGVkOyB0b3A6IDMwJTsKCWJvcmRlci10b3AtcmlnaHQtcmFkaXVzOjIwcHg7IGJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjIwcHg7Cn0KCmZpZWxkc2V0LnBhbmVsLmNtZD5kaXYub3V0cHV0PmZpZWxkc2V0LnBsdWdpbiB7IHBhZGRpbmc6MDsgbWFyZ2luOjA7IH0KZmllbGRzZXQucGFuZWwuY21kPmRpdi5vdXRwdXQ+ZmllbGRzZXQucGx1Z2luPmxlZ2VuZCB7IGJhY2tncm91bmQtY29sb3I6ZGFya2N5YW47IHBhZGRpbmc6MCAxMHB4OyBtYXJnaW4tcmlnaHQ6M3B4OyBoZWlnaHQ6MzBweDsgZmxvYXQ6bGVmdDsgfQpib2R5Lm1vYmlsZSBmaWVsZHNldC5wYW5lbC5jbWQ+ZGl2Lm91dHB1dD5maWVsZHNldC5wbHVnaW4+bGVnZW5kIHsgaGVpZ2h0OjQycHg7IH0KCmRpdi5vdXRwdXQuZm9ybSBkaXYuaXRlbSB7CgltYXJnaW46MTBweCA0MHB4Owp9CmRpdi5vdXRwdXQuZm9ybSBkaXYuaXRlbSBkaXYubGFiZWwgewoJbWFyZ2luOjVweCAwcHg7Cn0KCg==",
        "/panel/action.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJdmFyIHJpdmVyID0gY2FuLkNvbmYoY2hhdC5SSVZFUiksIHN0b3JtID0gY2FuLkNvbmYoY2hhdC5TVE9STSkKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKSwgY2FuLmNvcmUuTmV4dChtc2cuVGFibGUoKSwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQlpdGVtLmhlaWdodCA9IGNhbi5Db25mKGh0bWwuSEVJR0hUKS1jYW4uQ29uZihodG1sLk1BUkdJTl9ZKQoJCQlpdGVtLndpZHRoID0gY2FuLkNvbmYoaHRtbC5XSURUSCktY2FuLkNvbmYoaHRtbC5NQVJHSU5fWCkKCQkJaXRlbS5mZWF0dXJlID0gY2FuLmJhc2UuT2JqKGl0ZW0uZmVhdHVyZXx8aXRlbS5tZXRhKQoJCQlpdGVtLmlucHV0cyA9IGNhbi5iYXNlLk9iaihpdGVtLmlucHV0c3x8aXRlbS5saXN0KQoKCQkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIGl0ZW0sIGZ1bmN0aW9uKHN1YiwgbWV0YSwgc2tpcCkgewoJCQkJY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCByaXZlciwgc3Rvcm0sIHN1YiwgbWV0YSksIHNraXAgfHwgbmV4dCgpCgkJCX0pCgkJfSwgZnVuY3Rpb24oKSB7CgkJCWNhbi5vbmFjdGlvbi5sYXlvdXQoY2FuLCBjYW4ubWlzYy5TZWFyY2hPckNvbmYoY2FuLCBjaGF0LkxBWU9VVCl8fFZvbGNhbm9zLm1ldGEuYXJncy5sYXlvdXR8fCJhdXRvIiwgdHJ1ZSkKCQkJY2FuLm9uaW1wb3J0Ll9tZW51KGNhbiwgbXNnKSwgY2FuLm9ua2V5bWFwLl9pbml0KGNhbikKCQl9KQoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGNhbiwgcml2ZXIsIHN0b3JtLCBzdWIsIG1ldGEpIHsgc3ViLl90YXJnZXQuX21ldGEgPSBtZXRhCgkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gc3ViLnJlcXVlc3QoZXZlbnQpCgkJCXJldHVybiBjYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbcml2ZXIsIHN0b3JtLCBtZXRhLmlkfHxtZXRhLmluZGV4XSwgY21kcyksIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJCX0pCgkJfSwgY2FuLl9wbHVnaW5zID0gY2FuLm1pc2MuY29uY2F0KGNhbiwgY2FuLl9wbHVnaW5zLCBbc3ViXSkKCgkJbWV0YS5pZCAmJiAoc3ViLl9vcHRpb24uZGF0YXNldCA9IHN1Yi5fb3B0aW9uLmRhdGFzZXR8fHt9LCBzdWIuX29wdGlvbi5kYXRhc2V0LmlkID0gbWV0YS5pZCkKCgkJY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sICJvcmllbnRhdGlvbmNoYW5nZSIsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBtZXRhLndpZHRoLShjYW4udXNlci5pc1dpbmRvd3M/IDIwOiAwKSkKCQl9KQoJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBtZXRhLndpZHRoLShjYW4udXNlci5pc1dpbmRvd3M/IDIwOiAwKSkKCgkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLl9hY3Rpb24sIFt7dmlldzogW2h0bWwuVEFCUywgaHRtbC5ESVYsIG1ldGEubmFtZV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5GSUVMRFNFVF9QTFVHSU4sIHN1Yi5fdGFyZ2V0KQoJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9hY3Rpb24sIGh0bWwuRElWX1RBQlMsIGV2ZW50LnRhcmdldCkKCQl9LCBvbm1vdXNlZW50ZXI6IHN1Yi5fbGVnZW5kLm9ubW91c2VlbnRlciwgb25kYmxjbGljazogc3ViLl9sZWdlbmQub25jbGlja31dKQoJfSwKCV9tZW51OiBmdW5jdGlvbihjYW4sIG1zZykgeyBpZiAoY2FuLnVzZXIubW9kLmlzUG9kfHxjYW4udXNlci5pc01vYmlsZSkgeyByZXR1cm4gfQoJCWNhbi5zZXRIZWFkZXJNZW51KGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKGNoYXQuTUVOVVMpLCBjYW4uQ29uZihjaGF0Lk1FTlVTKXx8Y2FuLm9uYWN0aW9uLl9tZW51cyksIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGxpc3QpIHsKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmFjdGlvbiwgbGlzdFswXV0sIFtjYW4sIGJ1dHRvbl0pCgkJfSkKCX0sCgoJX3NoYXJlOiBmdW5jdGlvbihjYW4sIHNoYXJlKSB7IHNoYXJlICYmIGNhbi5ydW4oe30sIFsiX3NoYXJlIiwgc2hhcmVdLCBmdW5jdGlvbihtc2cpIHsKCQljYW4udXNlci50aXRsZShtc2cuT3B0aW9uT3JTZWFyY2goY2hhdC5USVRMRSkpCgkJY2FuLnNldEhlYWRlcihjaGF0LlRPUElDLCBtc2cuT3B0aW9uT3JTZWFyY2goY2hhdC5UT1BJQykpCgoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMSkgewoJCQljYW4uc2VhcmNoKGV2ZW50LCBbIkhlYWRlci5vbm1vdGlvbi5oaWRkZW4iXSkKCQkJY2FuLnNlYXJjaChldmVudCwgWyJGb290ZXIub25tb3Rpb24uaGlkZGVuIl0pCgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBjYW4uX3RhcmdldCwgImNtZCIpCgkJCWNhbi5Db25mKGh0bWwuSEVJR0hULCB3aW5kb3cuaW5uZXJIZWlnaHQpCgkJCWNhbi5Db25mKGh0bWwuV0lEVEgsIHdpbmRvdy5pbm5lcldpZHRoKQoJCX0KCgkJY2FuLkNvbmYoaHRtbC5NQVJHSU5fWCwgMCwgaHRtbC5NQVJHSU5fWSwgMipodG1sLkFDVElPTl9IRUlHSFQpCgkJY2FuLm9ubGF5b3V0Ll9pbml0KGNhbiwgZG9jdW1lbnQuYm9keSkKCgkJY2FuLkNvbmYoY2hhdC5SSVZFUiwgIl9zaGFyZSIsIGNoYXQuU1RPUk0sIHNoYXJlKQoJCW1zZy5MZW5ndGgoKSA+IDAgJiYgY2FuLm9uaW1wb3J0Ll9pbml0KGNhbiwgbXNnKQoJfSkgfSwKCV9jbWQ6IGZ1bmN0aW9uKGNhbiwgaXRlbSwgbmV4dCkgewoJCWNhbi5iYXNlLkNvcHkoaXRlbSwgewoJCQloZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodC1jYW4uQ29uZihodG1sLk1BUkdJTl9ZKSsoY2FuLnVzZXIuaXNXaW5kb3dzPyAxNzogMCksCgkJCXdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCwKCQkJb3B0czogY2FuLm1pc2MuU2VhcmNoKGNhbiksCgkJfSkKCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwgaXRlbSwgZnVuY3Rpb24oc3ViLCBtZXRhLCBza2lwKSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCB3aW5kb3cuaW5uZXJXaWR0aCkKCQkJY2FuLnVzZXIudGl0bGUobWV0YS5uYW1lKSwgc2tpcCB8fCBuZXh0KCkKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZW5naW5lIiwge2hlbHA6ICLop6PmnpDlvJXmk44iLCBsaXN0OiBbXSwgX2VuZ2luZTogZnVuY3Rpb24oZXZlbnQsIHBhZ2UsIG1zZywgY2FuLCBjbWRzLCBjYikgewoJdmFyIHN0b3JtID0gY2FuLmNvcmUuVmFsdWUoY2FuLl9yb290LCBjYW4uY29yZS5LZXlzKGNoYXQuUklWRVIsIGNtZHNbMF0sIGNoYXQuU1RPUk0sIGNtZHNbMV0pKQoJaWYgKCFzdG9ybSB8fCBjbWRzLmxlbmd0aCAhPSAyKSB7IHJldHVybiBmYWxzZSB9CgoJaWYgKHN0b3JtLmluZGV4KSB7IC8vIOWRveS7pOe0ouW8lQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09NTUFORF0uY29uY2F0KHN0b3JtLmluZGV4KSwgY2IpCgl9IGVsc2UgeyAvLyDlkb3ku6TliJfooagKCQljYW4uY29yZS5MaXN0KHN0b3JtLmxpc3QsIGZ1bmN0aW9uKHZhbHVlKSB7CgkJCW1zZy5QdXNoKG1kYi5OQU1FLCB2YWx1ZS5uYW1lfHwiIikKCQkJbXNnLlB1c2gobWRiLkhFTFAsIHZhbHVlLmhlbHB8fCIiKQoJCQltc2cuUHVzaChjdHguSU5QVVRTLCBKU09OLnN0cmluZ2lmeSh2YWx1ZS5pbnB1dHMpKQoJCQltc2cuUHVzaChjdHguRkVBVFVSRSwgSlNPTi5zdHJpbmdpZnkodmFsdWUuZmVhdHVyZSkpCgkJCW1zZy5QdXNoKGN0eC5JTkRFWCwgdmFsdWUuaW5kZXh8fCIiKQoJCQltc2cuUHVzaChjdHguQVJHUywgdmFsdWUuYXJnc3x8IltdIikKCQkJbXNnLlB1c2goaWNlLk1TR19BQ1RJT04sIHZhbHVlLl9hY3Rpb258fCIiKQoJCQltc2cuUHVzaCgiZGlzcGxheSIsIHZhbHVlLmRpc3BsYXl8fCIiKQoJCX0pLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCX0KCXJldHVybiB0cnVlCn19KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuS6pOS6kuaTjeS9nCIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBjYiwgdGFyZ2V0KSB7CgkJY2FuLkNvbmYoaHRtbC5NQVJHSU5fWSwgNCpodG1sLlBMVUdJTl9NQVJHSU4rMipodG1sLkFDVElPTl9IRUlHSFQraHRtbC5BQ1RJT05fTUFSR0lOKQoJCWNhbi5Db25mKGh0bWwuTUFSR0lOX1gsIDQqaHRtbC5QTFVHSU5fTUFSR0lOKQoKCQlpZiAoY2FuLnVzZXIubW9kLmlzUG9kIHx8IGNhbi51c2VyLmlzTW9iaWxlKSB7CgkJCXZhciBndCA9ICImIzEwMDk1OyIsIGx0ID0gIiYjMTAwOTQ7IjsgZnVuY3Rpb24gdG9nZ2xlKHZpZXcpIHsgcmV0dXJuICFjYW4uc2V0Uml2ZXIoImRpc3BsYXkiKSB9CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbW2h0bWwuVE9HR0xFLCBjaGF0LlBST0pFQ1RdXSwgbGlzdDogW3t0ZXh0OiBbZ3QsIGh0bWwuRElWXX1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJZXZlbnQudGFyZ2V0LmlubmVySFRNTCA9IHRvZ2dsZSgpPyBndDogbHQKCQkJfX1dKQoJCX0KCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJwYXJzZSIsIHNoeSgi6Kej5p6QIiwgewoJCQkic2hvdyI6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjbWRzKSB7CgkJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9sZWdlbmQpCgkJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9vcHRpb24pCgkJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9zdGF0dXMpCgoJCQkJY2FuLkNvbmZIZWlnaHQoY2FuLkNvbmZIZWlnaHQoKStjYW4uQ29uZihodG1sLk1BUkdJTl9ZKS0oY2FuLnVzZXIuaXNXaW5kb3dzPyAxNzogMCkpCgoJCQkJY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sICJtZW51IiwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0KGNhbiwgbXNnLk9wdGlvbihodG1sLklURU0pKSB9KQoJCQkJY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sICLpq5jnuqfphY3nva4iLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCBtc2cuT3B0aW9uKGh0bWwuSVRFTSkpIH0pCgkJCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgImgxIiwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0KGNhbiwgImgxIikgfSkKCgkJCQljYW4ub25hcHBlbmQucGFyc2UoY2FuLCBjYW4ub25hcHBlbmQuX3BhcnNlKGNhbiwgY21kc1swXSkpCgkJCX0sCgkJfSwgWyJ0ZXh0IiwgInNob3c6YnV0dG9uQGF1dG8iXSwgZnVuY3Rpb24obXNnLCBjbWRzLCBjYikgeyBjYW4ucnVuKHt9LCBjbWRzLCBjYiwgdHJ1ZSkgfSkpCgoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAiY29va2llIiwgc2h5KCLmj5DnpLoiLCB7fSwgWyJ0ZXh0IiwgImxpc3QiLCAiYmFjayJdLCBmdW5jdGlvbihtc2csIGNtZHMpIHsKCQkJY2FuLmNvcmUuSXRlbShjYW4ubWlzYy5Db29raWUoY2FuKSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewoJCQkJbXNnLlB1c2goImtleSIsIGtleSkKCQkJCW1zZy5QdXNoKCJ2YWx1ZSIsIHZhbHVlKQoJCQl9KQoJCX0pKQoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAiYWxlcnQiLCBzaHkoIuaPkOekuiIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQljYW4udXNlci5hbGVydChjbWRzWzBdKQoJCX0pKQoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAicGx1Z2luIiwgc2h5KCLmj5Lku7YiLCB7fSwgWyJ0ZXh0IiwgImxpc3QiLCAiYmFjayJdLCBmdW5jdGlvbihtc2csIGNtZHMpIHsKCQkJbXNnLkVjaG8oImhlbGxvIHdvcmxkIikKCQl9KSkKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgImluZm8iLCBzaHkoIuS/oeaBryIsIHt9LCBbInRleHQiLCAibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQltc2cuRWNobygiaGVsbG8gd29ybGQiKQoJCX0pKQoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAibG9nIiwgc2h5KCLml6Xlv5ciLCB7fSwgWyJ0ZXh0IiwgImxpc3QiLCAiYmFjayJdLCBmdW5jdGlvbihtc2csIGNtZHMpIHsKCQkJY29uc29sZS5sb2coY21kc1swXSkKCQl9KSkKCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJuZnMuc2F2ZSIsIHNoeSgi5L+d5a2Y5paH5Lu2Iiwge30sIFsiZmlsZT1oaS50eHQiLCAidGV4dDp0ZXh0YXJlYT0naGVsbG8gd29ybGQnIiwgInNhdmU6YnV0dG9uIl0sIGZ1bmN0aW9uKG1zZywgY21kcywgY2IpIHsKCQkJY2FuLm1pc2MucnVuQWN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwga2l0LkRpY3QoCgkJCQkic2F2ZSIsIGZ1bmN0aW9uKGNtZHMpIHsgY2FuLnVzZXIuZG93bmxvYWRzKGNhbiwgY21kc1sxXSwgY21kc1swXSkgfQoJCQkpKQoJCX0pKQoKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgInBpZSIsIHNoeSgi5q+U5L6L5Zu+Iiwge30sIFsibGlzdCIsICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQltc2cuRGlzcGxheVN0b3J5KCJwaWUuanMiKQoJCQltc2cuUHVzaCgidmFsdWUiLCAyMDApCgkJCW1zZy5QdXNoKCJ2YWx1ZSIsIDMwMCkKCQkJbXNnLlB1c2goInZhbHVlIiwgNDAwKQoJCX0pKQoJCWNhbi5vbmVuZ2luZS5wbHVnaW4oY2FuLCAiY2FuLmNvZGUuaW5uZXIucGx1Z2luIiwgc2h5KCLmj5Lku7YiLCB7fSwgW3t0eXBlOiAiYnV0dG9uIiwgbmFtZTogImxpc3QiLCBhY3Rpb246ICJhdXRvIn0sICJiYWNrIl0sIGZ1bmN0aW9uKG1zZywgY21kcykge30pKQoKCQl0YXJnZXQub250b3VjaHN0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbmFjdGlvbl90b3VjaCIsIGNhbi5yZXF1ZXN0KGV2ZW50KSkKCQl9LCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCX0sCglfbWVudXM6IFsKCQlbY2hhdC5MQVlPVVQsICJhdXRvIiwgInRhYnMiLCAiZ3JpZCIsICJmcmVlIiwgImZsb3ciLCAicGFnZSIsICJ0b2ltYWdlIl0sCgkJW2ljZS5IRUxQLCAidHV0b3IiLCAibWFudWFsIiwgInNlcnZpY2UiLCAiZGV2b3BzIiwgInJlZmVyIl0sCgldLAoJX3RyYW5zOiB7CgkJImxheW91dCI6ICLluIPlsYAiLAoJCSJhdXRvIjogIum7mOiupOW4g+WxgCIsCgkJImZsb3ciOiAi5rWB5Yqo5biD5bGAIiwKCQkiZ3JpZCI6ICLnvZHmoLzluIPlsYAiLAoJCSJ0YWJzIjogIuagh+etvuW4g+WxgCIsCgkJImZyZWUiOiAi6Ieq55Sx5biD5bGAIiwKCQkicGFnZSI6ICLnvZHpobXluIPlsYAiLAoJCSJ0b2ltYWdlIjogIueUn+aIkOWbvueJhyIsCgoJCSJoZWxwIjogIuW4ruWKqSIsCgkJInR1dG9yIjogIuWFpemXqOeugOS7iyIsCgkJIm1hbnVhbCI6ICLkvb/nlKjmiYvlhowiLAoJCSJzZXJ2aWNlIjogIuacjeWKoeaJi+WGjCIsCgkJImRldm9wcyI6ICLnvJbnqIvmiYvlhowiLAoJCSJyZWZlciI6ICLlj4LogIPmiYvlhowiLAoJfSwKCW9ubWFpbjogZnVuY3Rpb24oY2FuKSB7CgkJY2FuLm9uaW1wb3J0Ll9zaGFyZShjYW4sIGNhbi5taXNjLlNlYXJjaChjYW4sIHdlYi5TSEFSRSkpCgl9LAoJb25sb2dpbjogZnVuY3Rpb24oY2FuKSB7IGlmICghY2FuLkNvbmYoY2hhdC5UT09MKSAmJiAhY2FuLnVzZXIubW9kLmlzQ21kKSB7IHJldHVybiB9CgkJY2FuLkNvbmYoaHRtbC5NQVJHSU5fWCwgMCwgaHRtbC5NQVJHSU5fWSwgMipodG1sLkFDVElPTl9IRUlHSFQpCgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fdGFyZ2V0LCBpY2UuQ01EKQoJCWNhbi5vbmxheW91dC5faW5pdChjYW4pCgoJCWNhbi5fbmFtZXMgPSBsb2NhdGlvbi5wYXRobmFtZQoJCWNhbi5Db25mKGNoYXQuVE9PTCk/IGNhbi5jb3JlLk5leHQoY2FuLkNvbmYoY2hhdC5UT09MKSwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQljYW4ub25pbXBvcnQuX2NtZChjYW4sIGl0ZW0sIG5leHQpCgoJCX0pOiBjYW4ucnVuKGNhbi5yZXF1ZXN0KCkuX2V2ZW50LCBbY3R4LkFDVElPTiwgY3R4LkNPTU1BTkRdLCBmdW5jdGlvbihtc2cpIHsKCQkJY2FuLmNvcmUuTmV4dChtc2cuVGFibGUoKSwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQkJY2FuLm9uaW1wb3J0Ll9jbWQoY2FuLCBpdGVtLCBuZXh0KQoJCQl9KQoJCX0pCgl9LAoJb25zdG9ybV9zZWxlY3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCByaXZlciwgc3Rvcm0pIHsgY2FuLm9ubGF5b3V0Ll9pbml0KGNhbikKCQlpZiAoY2FuLm9ubW90aW9uLmNhY2hlKGNhbiwgZnVuY3Rpb24oKSB7CgkJCXZhciBrZXkgPSBjYW4uY29yZS5LZXlzKGNhbi5Db25mKGNoYXQuUklWRVIsIHJpdmVyKSwgY2FuLkNvbmYoY2hhdC5TVE9STSwgc3Rvcm0pKQoJCQlyZXR1cm4ga2V5CgkJfSwgY2FuLl9hY3Rpb24sIGNhbi5fb3V0cHV0KSkgewoJCQl2YXIgY29uZiA9IGNhbi5jb3JlLlZhbHVlKGNhbi5fcm9vdCwgY2FuLmNvcmUuS2V5cyhjaGF0LlJJVkVSLCByaXZlciwgY2hhdC5TVE9STSwgc3Rvcm0pKXx8e30KCQkJY2FuLm9uYWN0aW9uLmxheW91dChjYW4sIGNvbmYubGF5b3V0fHxjYW4ubWlzYy5TZWFyY2hPckNvbmYoY2FuLCBjaGF0LkxBWU9VVCl8fFZvbGNhbm9zLm1ldGEuYXJncy5sYXlvdXR8fCJhdXRvIiwgdHJ1ZSkKCQkJcmV0dXJuCgkJfQoKCQljYW4ucnVuKHt9LCBbcml2ZXIsIHN0b3JtXSwgZnVuY3Rpb24obXNnKSB7IGlmIChtc2cuTGVuZ3RoKCkgPiAwKSB7IHJldHVybiBjYW4ub25pbXBvcnQuX2luaXQoY2FuLCBtc2cpIH0KCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbmFjdGlvbl9ub3Rvb2wiLCBjYW4ucmVxdWVzdCh7fSwge3JpdmVyOiByaXZlciwgc3Rvcm06IHN0b3JtfSkpCgkJfSkKCX0sCglvbnNlYXJjaDogZnVuY3Rpb24oY2FuLCBtc2csIHdvcmQpIHsKCQlpZiAod29yZFswXSA9PSBtZGIuUExVR0lOIHx8IHdvcmRbMV0gIT0gIiIpIHsgY2FuLm9uZXhwb3J0LnBsdWdpbihjYW4sIG1zZywgd29yZCkgfQoJfSwKCW9uc2l6ZTogZnVuY3Rpb24oY2FuLCBtc2csIGhlaWdodCwgd2lkdGgpIHsgY2FuLkNvbmYoe2hlaWdodDogaGVpZ2h0LCB3aWR0aDogd2lkdGh9KSB9LAoKCWhlbHA6IGZ1bmN0aW9uKGNhbiwgYnV0dG9uKSB7IGNhbi51c2VyLm9wZW4oIi9oZWxwLyIrYnV0dG9uKyIuc2h5IikgfSwKCWxheW91dDogZnVuY3Rpb24oY2FuLCBidXR0b24sIHNpbGVudCkgewoJCWlmIChidXR0b24gPT0gInRvaW1hZ2UiKSB7CgkJCWNhbi5vbm1vdGlvbi50b2ltYWdlKGV2ZW50LCBjYW4sIGRvY3VtZW50LnRpdGxlLCBjYW4uX291dHB1dCkKCQkJcmV0dXJuCgkJfQoJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBjYW4uX3RhcmdldCwgY2FuLkNvbmYoY2hhdC5MQVlPVVQpKQoJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBjYW4uX3RhcmdldCwgY2FuLkNvbmYoY2hhdC5MQVlPVVQsIGJ1dHRvbikpCgoJCWlmIChidXR0b24gPT0gImF1dG8iKSB7CgkJCWNhbi5Db25mKGNoYXQuTEFZT1VULCAiIikKCgkJfSBlbHNlIGlmIChidXR0b24gPT0gInRhYnMiKSB7CgkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5GSUVMRFNFVF9QTFVHSU4sIDApCgkJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4uX2FjdGlvbiwgaHRtbC5ESVZfVEFCUywgMCkKCQl9IGVsc2UgaWYgKGJ1dHRvbiA9PSAiZnJlZSIpIHsKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl90YXJnZXQsIFtbaHRtbC5ESVZfT1VUUFVULCBodG1sLkZJRUxEU0VUX1BMVUdJTl1dLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgewoJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgaXRlbSwge3N0eWxlOiB7bGVmdDogNDAqaW5kZXgsIHRvcDogNDAqaW5kZXh9fSkKCQkJCWNhbi5vbm1vdGlvbi5tb3ZlKGNhbiwgaXRlbSwge2xlZnQ6IDQwKmluZGV4LCB0b3A6IDQwKmluZGV4fSkKCQkJfSkKCQl9IGVsc2UgaWYgKGJ1dHRvbiA9PSAiZ3JpZCIpIHsKCQkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiAibSIsIHZhbHVlOiAyfSwge25hbWU6ICJuIiwgdmFsdWU6IDJ9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgYXJncykgewoJCQkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24oaGVpZ2h0LCB3aWR0aCkgeyB2YXIgbSA9IHBhcnNlSW50KGRhdGEubSl8fDIsIG4gPSBwYXJzZUludChkYXRhLm4pfHwyCgkJCQkJY2FuLnBhZ2UuY3NzKGNhbi5iYXNlLnJlcGxhY2VBbGwoY2hhdC5BQ1RJT05fTEFZT1VUX0ZNVCwgIl93aWR0aCIsICh3aWR0aC0oNCptKzEpKmh0bWwuUExVR0lOX01BUkdJTikvbSsicHgiLCAiX2hlaWdodCIsIChoZWlnaHQtKDQqbisxKSpodG1sLlBMVUdJTl9NQVJHSU4pL24rInB4IikpCgkJCQl9KQoJCQl9LCBzaWxlbnQpCgkJfQoJCWNhbi5vbmxheW91dC5faW5pdChjYW4pCgl9LAp9KQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIumUruebmOS6pOS6kiIsIGxpc3Q6IFtdLCBfZm9jdXM6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQljYW4ub25rZXltYXAuX2J1aWxkKGNhbiksIGNhbi5vbmVuZ2luZS5saXN0ZW4oY2FuLCAib25rZXlkb3duIiwgZnVuY3Rpb24obXNnLCBtb2RlbCkgewoJCQljYW4uX2tleWxpc3QgPSBjYW4ub25rZXltYXAuX3BhcnNlKG1zZy5fZXZlbnQsIGNhbiwgbW9kZWwsIGNhbi5fa2V5bGlzdHx8W10sIGNhbi5fb3V0cHV0KQoJCX0pCgl9LAoJX21vZGU6IHsKCQlub3JtYWw6IHsKCQkJajogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHRhcmdldC5zY3JvbGxCeSgwLCBldmVudC5jdHJsS2V5PyAzMDA6IDMwKSB9LAoJCQlrOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgdGFyZ2V0LnNjcm9sbEJ5KDAsIGV2ZW50LmN0cmxLZXk/IC0zMDA6IC0zMCkgfSwKCgkJCWI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIkhlYWRlci5vbmFjdGlvbi5ibGFjayJdKSB9LAoJCQl3OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLnNlYXJjaChldmVudCwgWyJIZWFkZXIub25hY3Rpb24ud2hpdGUiXSkgfSwKCgkJCWc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4uc2VhcmNoKGV2ZW50LCBbIlJpdmVyLm9uZGV0YWlsLuWIm+W7uue+pOe7hCJdKSB9LAoJCQlzOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLnNlYXJjaChldmVudCwgWyJSaXZlci5vbmRldGFpbC7mt7vliqDlupTnlKgiXSkgfSwKCQkJdDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5zZWFyY2goZXZlbnQsIFsiUml2ZXIub25kZXRhaWwu5re75Yqg5bel5YW3Il0pIH0sCgoJCQkiICI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgewoJCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbnNlYXJjaGZvY3VzIikKCQkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9LAoJCQkiOiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgewoJCQkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbmNvbW1hbmRmb2N1cyIpCgkJCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQkJfSwKCQkJZW50ZXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4ubWlzYy5Mb2coImVudGVyIikgfSwKCQkJZXNjYXBlOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGRvY3VtZW50LmJvZHksIGh0bWwuRklFTERTRVRfQVVUTywgZnVuY3Rpb24oaXRlbSkgewoJCQkJCS8vIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBpdGVtKQoJCQkJfSkKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGRvY3VtZW50LmJvZHksIGNhbi5wYWdlLktleXMoaHRtbC5GSUVMRFNFVF9GTE9BVCwgaHRtbC5ESVZfRkxPQVQpLCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaXRlbSkKCQkJCX0pCgkJCX0sCgkJfSwKCX0sIF9lbmdpbmU6IHt9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJYXJnczogZnVuY3Rpb24oY2FuLCBjYiwgdGFyZ2V0KSB7CgkJY2FuLmNvcmUuTmV4dChjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtbaHRtbC5GSUVMRFNFVF9QTFVHSU4sIGh0bWwuRk9STV9PUFRJT05dXSksIGZ1bmN0aW9uKGl0ZW0sIG5leHQsIGluZGV4LCBhcnJheSkgewoJCQlpdGVtLmRhdGFzZXQuYXJncyA9IEpTT04uc3RyaW5naWZ5KGNhbi5wYWdlLlNlbGVjdChjYW4sIGl0ZW0sIGh0bWwuT1BUSU9OX0FSR1MsIGZ1bmN0aW9uKGl0ZW0pIHsgcmV0dXJuIGl0ZW0udmFsdWV8fCIiIH0pKQoJCQljYihpdGVtLCBuZXh0LCBpbmRleCwgYXJyYXkpCgkJfSkKCX0sCglzaXplOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCW1zZy5PcHRpb24oaHRtbC5UT1AsIGNhbi5fdGFyZ2V0Lm9mZnNldFRvcCkKCQltc2cuT3B0aW9uKGh0bWwuTEVGVCwgY2FuLl90YXJnZXQub2Zmc2V0TGVmdCkKCQltc2cuT3B0aW9uKGh0bWwuV0lEVEgsIGNhbi5fdGFyZ2V0Lm9mZnNldFdpZHRoKQoJCWlmIChtc2cuT3B0aW9uKGh0bWwuSEVJR0hULCBjYW4uX3RhcmdldC5vZmZzZXRIZWlnaHQtY2FuLl9hY3Rpb24ub2Zmc2V0SGVpZ2h0KSA+IHdpbmRvdy5pbm5lckhlaWdodCkgewoJCQltc2cuT3B0aW9uKGh0bWwuSEVJR0hULCB3aW5kb3cuaW5uZXJIZWlnaHQtMipodG1sLkFDVElPTl9IRUlHSFQpCgkJfQoJCW1zZy5PcHRpb24oaHRtbC5TQ1JPTEwsIGNhbi51c2VyLmlzTW9iaWxlPyBjYW4uX3RhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUuc2Nyb2xsVG9wOiBjYW4uX291dHB1dC5zY3JvbGxUb3ApCgkJbXNnLk9wdGlvbihodG1sLk1BUkdJTl9YLCBjYW4uQ29uZihodG1sLk1BUkdJTl9YKSkKCQltc2cuT3B0aW9uKGh0bWwuTUFSR0lOX1ksIGNhbi5Db25mKGh0bWwuTUFSR0lOX1kpKQoJfSwKCWxheW91dDogZnVuY3Rpb24oY2FuLCBtc2cpIHsgcmV0dXJuIGNhbi5Db25mKGNoYXQuTEFZT1VUKSB9LAoJcGx1Z2luOiBmdW5jdGlvbihjYW4sIG1zZywgd29yZCkgeyB2YXIgZmllbGRzID0gY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbihpY2UuTVNHX0ZJRUxEUykpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIFtbaHRtbC5GSUVMRFNFVF9QTFVHSU4sIGh0bWwuTEVHRU5EXV0sIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaWYgKGl0ZW0uaW5uZXJIVE1MLmluZGV4T2Yod29yZFsxXSkgPT0gLTEpIHsgcmV0dXJuIH0KCgkJCXZhciBtZXRhID0gaXRlbS5wYXJlbnROb2RlLl9tZXRhCgkJCXZhciBsaXN0ID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgaXRlbS5uZXh0U2libGluZywgaHRtbC5PUFRJT05fQVJHUywgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS52YWx1ZXx8IiIgfSkKCgkJCXZhciBkYXRhID0ge2N0eDogIndlYi5jaGF0IiwgY21kOiBjdHguQUNUSU9OLAoJCQkJdHlwZTogbWRiLlBMVUdJTiwgbmFtZTogaXRlbS5pbm5lckhUTUwsIHRleHQ6IHNoeSgi6Lez6L2sIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQl2YXIgaW5wdXQgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBpdGVtLnBhcmVudE5vZGUsIGh0bWwuSU5QVVRfQVJHUylbMF0KCQkJCQlpbnB1dCAmJiBpbnB1dC5mb2N1cygpCgkJCQl9KSwgYXJndW1lbnQ6IEpTT04uc3RyaW5naWZ5KGxpc3QpLAoJCQl9CgkJCWlmIChtZXRhLmluZGV4KSB7CgkJCQlkYXRhLmNvbnRleHQgPSAiIiwgZGF0YS5jb21tYW5kID0gbWV0YS5pbmRleAoJCQl9IGVsc2UgaWYgKG1ldGEuY21kKSB7CgkJCQlkYXRhLmNvbnRleHQgPSBtZXRhLmN0eCwgZGF0YS5jb21tYW5kID0gbWV0YS5jbWQKCQkJfSBlbHNlIHsKCQkJCXJldHVybgoJCQl9CgkJCW1zZy5QdXNoKGRhdGEsIGZpZWxkcykKCQl9KQoJfSwKfSkKCg==",
        "/panel/footer.css": "ZmllbGRzZXQuRm9vdGVyIHsgcGFkZGluZzowIDVweDsgaGVpZ2h0OjMycHg7IGNsZWFyOmJvdGg7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgeyBoZWlnaHQ6MzJweDsgb3ZlcmZsb3c6aGlkZGVuOyB9CmZpZWxkc2V0LkZvb3Rlcj5kaXYub3V0cHV0PmRpdiB7IHBhZGRpbmc6NXB4OyBoZWlnaHQ6MjJweDsgY3Vyc29yOnBvaW50ZXI7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQ+ZGl2OmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjojMmU1MTVmOyBib3JkZXItdG9wOnNvbGlkIDJweCByZWQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgZGl2LnRpdGxlIHsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5Gb290ZXI+ZGl2Lm91dHB1dCBkaXYuc3RhdGUgeyBmbG9hdDpyaWdodDsgfQpmaWVsZHNldC5Gb290ZXI+ZGl2Lm91dHB1dCBkaXYudG9hc3QgeyBiYWNrZ3JvdW5kLWNvbG9yOmRhcmtjeWFuOyBmbG9hdDpyaWdodDsgfQpmaWVsZHNldC5Gb290ZXI+ZGl2Lm91dHB1dCBkaXYuY21kIHsgcGFkZGluZzowcHg7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgaW5wdXRbbmFtZT1jbWRdIHsgaGVpZ2h0OjI1cHg7IHdpZHRoOjEyMHB4OyBib3JkZXItcmFkaXVzOjA7IH0KZmllbGRzZXQuRm9vdGVyPmRpdi5vdXRwdXQgaW5wdXRbbmFtZT1jbWRdOmZvY3VzIHsgd2lkdGg6MzIwcHg7IH0K",
        "/panel/footer.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQljYW4ub25pbXBvcnQuX3RpdGxlKGNhbiwgbXNnLCB0YXJnZXQpCgkJY2FuLm9uaW1wb3J0Ll9zdGF0ZShjYW4sIG1zZywgdGFyZ2V0KQoJCWNhbi5vbmltcG9ydC5fdG9hc3QoY2FuLCBtc2csIHRhcmdldCkKCQljYW4ub25pbXBvcnQuX2NsaShjYW4sIG1zZywgdGFyZ2V0KQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoKCQljYW4uY29yZS5UaW1lcigxMDAsIGZ1bmN0aW9uKCkgewoJCQl3aW5kb3cud2VidmlldyAmJiBjYW4uc2V0SGVhZGVyTWVudShbIuWQjumAgCIsICLliJfooagiXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgbGlzdCkgewoJCQkJc3dpdGNoIChidXR0b24pIHsKCQkJCQljYXNlICLlkI7pgIAiOiBoaXN0b3J5LmJhY2soKTsgYnJlYWsKCQkJCQljYXNlICLliJfooagiOiB3aW5kb3cubWVudSgpOyBicmVhawoJCQkJfQoJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmFjdGlvbiwgbGlzdFswXV0sIFtjYW4sIGJ1dHRvbl0pCgkJCX0pCgkJfSkKCX0sCglfdGl0bGU6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQkhY2FuLnVzZXIuaXNNb2JpbGUgJiYgY2FuLmNvcmUuTGlzdChtc2cucmVzdWx0LCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbY2hhdC5USVRMRSwgaHRtbC5ESVYsIGl0ZW1dLCB0aXRsZTogIuiBlOezu+ermemVvyJ9XSkKCQl9KQoJfSwKCV9zdGF0ZTogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCWNhbi5jb3JlLkxpc3QoY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5TVEFURSl8fGNhbi5Db25mKGNoYXQuU1RBVEUpLCBbIm5jbWQiXSksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IFtjYW4uYmFzZS5qb2luKFtjaGF0LlNUQVRFLCBpdGVtXSksIGh0bWwuRElWLCBjYW4uQ29uZihpdGVtKV0sIGxpc3Q6IFsKCQkJCXt0ZXh0OiBbaXRlbSwgaHRtbC5MQUJFTF19LCB7dGV4dDogWyI6ICIsIGh0bWwuTEFCRUxdfSwge3RleHQ6IFtjYW4uQ29uZihpdGVtKXx8IiIsIGh0bWwuU1BBTiwgaXRlbV19LAoJCQldLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnNob3cgPSBjYW4uc2hvdz8gKGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5zaG93KSwgbnVsbCk6IGNhbi5vbmFjdGlvbi5fY21kKGNhbikKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5zaG93LCB7c3R5bGU6IHtsZWZ0OiAiIiwgdG9wOiAiIiwgcmlnaHQ6IDAsIGJvdHRvbTogY2FuLm9uZXhwb3J0LmhlaWdodChjYW4pfX0pCgkJCX19XSkKCQl9KQoJfSwKCV90b2FzdDogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCWNhbi50b2FzdCA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBjaGF0LlRPQVNULCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4uc2hvdyA9IGNhbi5zaG93PyAoY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLnNob3cpLCBudWxsKTogY2FuLm9uYXBwZW5kLmZsb2F0KGNhbiwgY2FuLl90b2FzdCkuZmlyc3QKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnNob3csIHtzdHlsZToge2xlZnQ6ICIiLCB0b3A6ICIiLCByaWdodDogMCwgYm90dG9tOiBjYW4ub25leHBvcnQuaGVpZ2h0KGNhbil9fSkKCQl9fV0pLmZpcnN0Cgl9LAoJX2NsaTogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCWNhbi5vbmFwcGVuZC5pbnB1dChjYW4sIHt0eXBlOiBodG1sLlRFWFQsIG5hbWU6ICJjbWQiLCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmtleW1hcC5pbnB1dChldmVudCwgY2FuKTsgaWYgKGV2ZW50LmtleSAhPSBsYW5nLkVOVEVSKSB7IHJldHVybiB9CgkJCXN3aXRjaCAoZXZlbnQudGFyZ2V0LnZhbHVlKSB7CgkJCQljYXNlIGNsaS5DTEVBUjogY2FuLmNsaSAmJiBjYW4uY2xpLmNsb3NlKCk7IGJyZWFrCgkJCQljYXNlIGNsaS5DTE9TRTogY2FuLmNsaSAmJiBjYW4uY2xpLmNsb3NlKCk7IGJyZWFrCgkJCQlkZWZhdWx0OgoJCQkJCWNhbi5ydW4oZXZlbnQsIFtpY2UuUlVOXS5jb25jYXQoY2FuLmNvcmUuU3BsaXQoZXZlbnQudGFyZ2V0LnZhbHVlLCBpY2UuU1ApKSwgZnVuY3Rpb24obXNnKSB7CgkJCQkJCWNhbi5jbGkgJiYgY2FuLmNsaS5jbG9zZSgpCgkJCQkJCWNhbi5jbGkgPSBjYW4ub25hcHBlbmQuZmxvYXQoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBsaXN0KSB7CgoJCQkJCQl9KSwgY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLmNsaS5maXJzdCwge3N0eWxlOiB7Ym90dG9tOiBjYW4ub25leHBvcnQuaGVpZ2h0KGNhbiksIHRvcDogIiJ9fSkKCQkJCQl9KQoJCQl9CgkJfX0sICIiLCB0YXJnZXQsICJ0aXRsZSBjbWQiKQoJfSwKCgl0b2FzdDogZnVuY3Rpb24oY2FuLCBtc2csIHRpdGxlLCBjb250ZW50LCBmaWxlbGluZSwgdGltZSkgeyBjYW4uX3RvYXN0ID0gY2FuLl90b2FzdHx8Y2FuLnJlcXVlc3QoKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi50b2FzdCwgW3RpbWUuc3BsaXQoaWNlLlNQKS5wb3AoKSwgdGl0bGUsIGNvbnRlbnRdLmpvaW4oaWNlLlNQKSkKCQljYW4uX3RvYXN0LlB1c2goe3RpbWU6IHRpbWUsIGZpbGVsaW5lOiBmaWxlbGluZSwgdGl0bGU6IHRpdGxlLCBjb250ZW50OiBjb250ZW50fSkKCX0sCgluY21kOiBmdW5jdGlvbihjYW4sIG1zZywgX2ZvbGxvdywgX2NtZHMpIHsgdmFyIE5DTUQgPSAibmNtZCI7IGNhbi5fY21kcyA9IGNhbi5fY21kc3x8Y2FuLnJlcXVlc3QoKQoJCWNhbi5fY21kcy5QdXNoKHt0aW1lOiBjYW4uYmFzZS5UaW1lKCksIGZvbGxvdzogX2ZvbGxvdywgY21kczogX2NtZHN9KQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCBjYW4uY29yZS5LZXlzKGh0bWwuU1BBTiwgTkNNRCksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5pbm5lckhUTUwgPSBjYW4uQ29uZihOQ01ELCBwYXJzZUludChjYW4uQ29uZihOQ01EKXx8IjAiKSsxKyIiKSsiIgoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuS6pOS6kuaVsOaNriIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBjYiwgdGFyZ2V0KSB7CgkJaWYgKGNhbi51c2VyLm1vZC5pc1BvZCkgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQpCgkJfSBlbHNlIGlmIChjYW4udXNlci5pc01vYmlsZSkgewoJCQkvLyBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQpCgkJfSBlbHNlIGlmIChjYW4udXNlci5pc0V4dGVuc2lvbikgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQpCgkJfQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJfSwKCW9ubG9naW46IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGNhbi5ydW4oe30sIFtdLCBmdW5jdGlvbihtc2cpIHsgY2FuLm9uaW1wb3J0Ll9pbml0KGNhbiwgbXNnLCBbXSwgbnVsbCwgY2FuLl9vdXRwdXQpIH0pIH0sCglvbnRvYXN0OiBmdW5jdGlvbihjYW4sIG1zZykgeyBjYW4uY29yZS5DYWxsRnVuYyhjYW4ub25pbXBvcnQudG9hc3QsIHtjYW46IGNhbiwgbXNnOiBtc2d9KSB9LAoJb25yZW1vdGU6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7IGNhbi5jb3JlLkNhbGxGdW5jKGNhbi5vbmltcG9ydC5uY21kLCB7Y2FuOiBjYW4sIG1zZzogbXNnfSkgfSwKCW9uY29tbWFuZGZvY3VzOiBmdW5jdGlvbihjYW4pIHsgCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYuY21kIGlucHV0IiwgZnVuY3Rpb24odGFyZ2V0KSB7IHRhcmdldC5mb2N1cygpIH0pCgl9LAoKCV9jbWQ6IGZ1bmN0aW9uKGNhbikgewoJCXJldHVybiBjYW4ub25hcHBlbmQuZmxvYXQoY2FuLCBjYW4uX2NtZHMsIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBsaXN0KSB7CgkJCXZhciBjbWRzID0gY2FuLmJhc2UuT2JqKGxpbmUuY21kcyk7IHN3aXRjaCAobGluZS5mb2xsb3cpIHsKCQkJCWNhc2UgImNoYXQuQWN0aW9uIjogY21kcyA9IGNtZHMuc2xpY2UoMik7IGJyZWFrCgkJCQljYXNlICJjaGF0LkZvb3RlciI6IGNtZHMgPSBjbWRzLnNsaWNlKDIpOyBicmVhawoJCQl9CgkJCXN3aXRjaCAoY21kc1swXSkgewoJCQkJY2FzZSAid2ViLndpa2kud29yZCI6IGNtZHMgPSBjbWRzLnNsaWNlKDUpOyBicmVhawoJCQl9CgoJCQljYW4uZ2V0KCJBY3Rpb24iLCAic2l6ZSIsIGZ1bmN0aW9uKG1zZywgdG9wLCBsZWZ0LCB3aWR0aCwgaGVpZ2h0KSB7CgkJCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwge2luZGV4OiBjbWRzWzBdLCBhcmdzOiBjbWRzLnNsaWNlKDEpLCBoZWlnaHQ6IGhlaWdodC0xMDAsIHdpZHRoOiB3aWR0aH0sIGZ1bmN0aW9uKHN1YikgewoJCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kLCBjYikgewoJCQkJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgY21kc1swXV0sIGNtZCksIGNiKQoJCQkJCX0KCgkJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl90YXJnZXQsIHtzdHlsZToge3RvcDogdG9wKzEwMCwgbGVmdDogbGVmdH19KQoJCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHN1Yi5fbGVnZW5kLCB7c3R5bGU6IHtkaXNwbGF5OiBodG1sLkJMT0NLfX0pCgkJCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl9vdXRwdXQsIHtzdHlsZTogeyJtYXgtd2lkdGgiOiB3aWR0aH19KQoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBzdWIuX3RhcmdldCwgY2hhdC5GTE9BVCkKCQkJCX0sIGRvY3VtZW50LmJvZHkpCgkJCX0pCgkJfSkuZmlyc3QKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW10sCgloZWlnaHQ6IGZ1bmN0aW9uKGNhbikgeyByZXR1cm4gY2FuLl90YXJnZXQub2Zmc2V0SGVpZ2h0IH0sCn0pCgo=",
        "/panel/header.css": "ZmllbGRzZXQuSGVhZGVyIHsgZm9udC1zaXplOjEuMmVtOyBwYWRkaW5nOjAgNXB4OyBoZWlnaHQ6MzJweDsgb3ZlcmZsb3c6aGlkZGVuOyB6LWluZGV4OjEwOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0IHsgaGVpZ2h0OjMycHg7IG92ZXJmbG93OmhpZGRlbjsgfQpmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dD5kaXYgeyBwYWRkaW5nOjVweDsgaGVpZ2h0OjIycHg7IGN1cnNvcjpwb2ludGVyOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0PmRpdjpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgYm9yZGVyLWJvdHRvbTpzb2xpZCAycHggcmVkOyB9CmZpZWxkc2V0LkhlYWRlcj5kaXYub3V0cHV0PmRpdi50aXRsZSB7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnN0YXRlIHsgZmxvYXQ6cmlnaHQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnN0YXRlLmF2YXRhcj5pbWcgeyBoZWlnaHQ6MS40ZW07IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaCB7IG1hcmdpbi1sZWZ0OjIwcHg7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQ+ZGl2LnNlYXJjaD5pbnB1dCB7IG1hcmdpbi10b3A6LTVweDsgaGVpZ2h0OjI1cHg7IGJvcmRlci1yYWRpdXM6MDsgfQpmaWVsZHNldC5IZWFkZXI+ZGl2Lm91dHB1dCBkaXYubWVudSB7IHBhZGRpbmc6NXB4OyBoZWlnaHQ6MjFweDsgY3Vyc29yOnBvaW50ZXI7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuSGVhZGVyPmRpdi5vdXRwdXQgZGl2Lm1lbnU6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyZTUxNWY7IGJvcmRlci1ib3R0b206c29saWQgMnB4IHJlZDsgfQoKZGl2LmhlYWQgewoJYmFja2dyb3VuZC1jb2xvcjojNDA0MDQwOyBwYWRkaW5nOjVweDsgaGVpZ2h0OjQycHg7IGNsZWFyOmJvdGg7Cn0KZGl2LmxlZnQgZGl2LnVzZXJuYW1lIGRpdiB7Cgljb2xvcjp3aGl0ZTsgdGV4dC1hbGlnbjpjZW50ZXI7IHBhZGRpbmc6MTBweDsKfQpkaXYubGVmdCBkaXYudXNlcm5hbWUgaW1nIHsKCXBhZGRpbmc6MCAxMHB4OyB3aWR0aDoxMDBweDsKfQpkaXYuaGVhZCBkaXYudXNlcm5hbWUgaW1nIHsKCWhlaWdodDo0MHB4OyBmbG9hdDpsZWZ0Owp9CmRpdi5oZWFkIGRpdi51c2VybmFtZSBkaXYgewoJcGFkZGluZzoxMnB4OyBmbG9hdDpsZWZ0Owp9CmRpdi5oZWFkIGRpdi51c2VybmFtZSB7Cgljb2xvcjp3aGl0ZTsgZmxvYXQ6cmlnaHQ7CglwYWRkaW5nLXJpZ2h0OjEwcHg7Cn0KZGl2LmhlYWQgZGl2Lm1lbnUgewoJY29sb3I6d2hpdGU7IGN1cnNvcjpwb2ludGVyOyBwYWRkaW5nOjEwcHg7IGZsb2F0OmxlZnQ7Cn0KZGl2LmhlYWQgZGl2Lm1lbnU6aG92ZXIgewoJYmFja2dyb3VuZC1jb2xvcjojMzIzMjMyOwp9CmRpdi5sZWZ0IHsKCXdpZHRoOjEyMHB4OwoJYmFja2dyb3VuZC1jb2xvcjojMzIzMjMyOyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0Owp9CmRpdi5sZWZ0OmhvdmVyIHsKCWJhY2tncm91bmQtY29sb3I6IzMyMzIzMjsKfQpkaXYubGVmdCBkaXYuaXRlbSB7CgliYWNrZ3JvdW5kLWNvbG9yOiMzMjMyMzI7Cgljb2xvcjp3aGl0ZTsgcGFkZGluZzo1cHggMTBweDsKfQpkaXYubGVmdCBkaXYuaXRlbTpob3ZlciB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7Cn0KZGl2Lm1haW4gewoJYmFja2dyb3VuZC1jb2xvcjojY2NjY2NjOyBoZWlnaHQ6MTgwcHg7IHdpZHRoOjE4MHB4OyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0Owp9CmRpdi5tYWluIGlmcmFtZSB7Cglib3JkZXI6MDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gewoJYmFja2dyb3VuZC1jb2xvcjojZjhmOGY4OyBwYWRkaW5nOjEwcHg7IG1hcmdpbjoxMHB4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiBmb3JtLm9wdGlvbiBkaXYuaXRlbSB7CiAJbWFyZ2luOjEwcHg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIGRpdi5hY3Rpb24gZGl2Lml0ZW0gewogCW1hcmdpbjoxMHB4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiBsZWdlbmQgewoJYm94LXNoYWRvdzpub25lOwoJYmFja2dyb3VuZC1jb2xvcjojZTRlNGU0OwoJY29sb3I6YmxhY2s7CglkaXNwbGF5OmJsb2NrOwoJZmxvYXQ6bGVmdDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gZm9ybS5vcHRpb24gewoJZGlzcGxheTpibG9jazsKCWNsZWFyOmJvdGg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIHNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsKIAlib3JkZXI6c29saWQgMXB4IGdyYXk7IG91dGxpbmU6bm9uZTsKCWJveC1zaGFkb3c6bm9uZTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gaW5wdXRbdHlwZT10ZXh0XSB7CgliYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBjb2xvcjpibGFjazsgcGFkZGluZzoycHggMTBweDsKIAlib3JkZXI6c29saWQgMXB4IGdyYXk7IG91dGxpbmU6bm9uZTsKCWJvcmRlci1yYWRpdXM6M3B4IDNweDsKCWJveC1zaGFkb3c6bm9uZTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gaW5wdXRbdHlwZT1idXR0b25dIHsKCWJhY2tncm91bmQtY29sb3I6Ymx1ZTsgY29sb3I6d2hpdGU7IHBhZGRpbmc6NHB4IDEwcHg7Cglib3JkZXI6bm9uZTsgYm9yZGVyLXJhZGl1czozcHggM3B4Owp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiB0YWJsZS5jb250ZW50IHsKIAlib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7CglkaXNwbGF5OmJsb2NrOwp9CmRpdi5tYWluIGZpZWxkc2V0LnBsdWdpbiB0YWJsZS5jb250ZW50IHRoZWFkIHsKCXotaW5kZXg6MTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gdGFibGUuY29udGVudCB0ciB7Cglib3JkZXI6c29saWQgMXB4IGxpZ2h0Z3JheTsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gdGFibGUuY29udGVudCB0aCB7CgliYWNrZ3JvdW5kLWNvbG9yOiNmYmZiZmI7IGNvbG9yOnJnYmEoMCwwLDAsLjQ1KTsgZm9udC13ZWlnaHQ6MTAwOyBwYWRkaW5nOjEwcHg7Cn0KZGl2Lm1haW4gZmllbGRzZXQucGx1Z2luIHRhYmxlLmNvbnRlbnQgdGQgewoJYmFja2dyb3VuZC1jb2xvcjp3aGl0ZTsgY29sb3I6ICM1YzVjNWM7IHBhZGRpbmc6MTBweDsKfQpkaXYubWFpbiBmaWVsZHNldC5wbHVnaW4gZGl2LnN0YXR1cyB7Cgljb2xvcjpibGFjazsKfQpkaXYuZm9vdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGhlaWdodDozMnB4OyBjbGVhcjpib3RoOwp9CgpkaXYudGFiczpob3ZlciB7CgliYWNrZ3JvdW5kLWNvbG9yOiMyNzI3Mjc7Cn0KZGl2LnRhYnMgZGl2Lm5hbWUgewoJaGVpZ2h0OjQ2cHg7IHdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7Cglwb3NpdGlvbjpzdGlja3k7IHRvcDo1cHg7Cgl6LWluZGV4OjE7Cn0KZGl2LnRhYnMgZGl2Lm5hbWUgZGl2Lml0ZW0gewoJY29sb3I6Z3JheTsgcGFkZGluZzoxMHB4OyBmbG9hdDpsZWZ0Owp9CmRpdi50YWJzIGRpdi5uYW1lIGRpdi5pdGVtLnNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGNvbG9yOndoaXRlOwogCWJvcmRlci1ib3R0b206c29saWQgcmVkIDJweDsKfQpkaXYudGFicyBkaXYucGFnZSB7CglvdmVyZmxvdzphdXRvOyBjbGVhcjpib3RoOwp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5pbnB1dCB7CglwYWRkaW5nOjVweDsgcG9zaXRpb246c3RpY2t5OyB0b3A6MHB4Owp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5pbnB1dCBpbnB1dCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMyMTIxMjE7IGNvbG9yOndoaXRlOyBib3JkZXI6MDsgb3V0bGluZTpub25lOyB3aWR0aDoyMzBweDsKfQpkaXYudGFicyBkaXYucGFnZT5kaXYuaXRlbSB7CgliYWNrZ3JvdW5kLWNvbG9yOiM0MDQwNDA7IGNsZWFyOmJvdGg7IGRpc3BsYXk6bm9uZTsKfQpkaXYudGFicyBkaXYucGFnZT5kaXYubGlzdCB7CglwYWRkaW5nLWxlZnQ6MjBweDsgZGlzcGxheTpub25lOyBjbGVhcjpib3RoOwp9CmRpdi50YWJzIGRpdi5wYWdlPmRpdi5saXN0LnNlbGVjdCB7CgliYWNrZ3JvdW5kLWNvbG9yOiMzMjMyMzI7IGRpc3BsYXk6YmxvY2s7Cn0KZGl2LmxlZnQgZGl2Lmxpc3QgewoJcGFkZGluZy1sZWZ0OjIwcHg7Cn0KCmRpdi50YWJzLmxlZnQgZGl2Lm5hbWUgewoJZmxvYXQ6bGVmdDsKfQpkaXYudGFicy5sZWZ0IGRpdi5uYW1lIGRpdi5pdGVtIHsKCWJvcmRlci1ib3R0b206bm9uZTsgZmxvYXQ6bm9uZTsKfQpkaXYudGFicy5sZWZ0IGRpdi5uYW1lIGRpdi5pdGVtLnNlbGVjdCB7Cglib3JkZXItcmlnaHQ6c29saWQgcmVkIDJweDsKfQpkaXYudGFicy5sZWZ0IGRpdi5wYWdlIHsKCXdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7CiAJY2xlYXI6bm9uZTsgZmxvYXQ6bGVmdDsKfQpkaXYudGFicy5sZWZ0IGRpdi5wYWdlPmRpdi5pdGVtIHsKCWRpc3BsYXk6YmxvY2s7Cn0KCmRpdi50YWJzLnZvaWQgZGl2Lm5hbWUgewoJZGlzcGxheTpub25lOwp9CmRpdi50YWJzLnZvaWQgZGl2LnBhZ2U+ZGl2Lml0ZW0gewoJZGlzcGxheTpibG9jazsKfQoK",
        "/panel/header.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYiwgdGFyZ2V0KSB7CgkJY2FuLkNvbmYoYWFhLlVTRVJOSUNLLCBtc2cuT3B0aW9uKGFhYS5VU0VSTklDSyl8fG1zZy5PcHRpb24oaWNlLk1TR19VU0VSTklDSyl8fG1zZy5PcHRpb24oaWNlLk1TR19VU0VSTkFNRSl8fGNhbi5Db25mKGFhYS5VU0VSTklDSykpCgkJY2FuLnVzZXIuaW5mby51c2VybmljayA9IGNhbi5Db25mKGFhYS5VU0VSTklDSykKCQljYW4udXNlci5pbmZvLmF2YXRhciA9IG1zZy5PcHRpb24oYWFhLkFWQVRBUikKCQljYW4ub25kYWVtb24uX2luaXQoY2FuKQoKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgInRvcGljIiwgc2h5KCLkuLvpopgiLCB7CgkJCSJkZW1vIjogZnVuY3Rpb24oY2FuLCBtc2csIGNtZHMpIHsgY2FuLm9ubGF5b3V0LnRvcGljKGNhbiwgY21kc1swXSkgfSwKCQl9LCBbInRvcGljOnNlbGVjdD13aGl0ZSxibGFjayIsICJydW46YnV0dG9uIiwgImRlbW86YnV0dG9uIl0sIGZ1bmN0aW9uKG1zZywgY21kcykgewoJCQljYW4ub25sYXlvdXQudG9waWMoY2FuLCBjbWRzWzBdKQoJCX0pKQoKCQljYW4ub25sYXlvdXQudG9waWMoY2FuLCBjYW4uQ29uZigidG9waWMiKSkKCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kKSB7CgkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX2ZpZWxkcykKCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGRvY3VtZW50LmJvZHksICJzaW1wbGUiKQoJCX0KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQljYW4ub25pbXBvcnQuX2FnZW50KGNhbiwgbXNnLCB0YXJnZXQpCgkJY2FuLm9uaW1wb3J0Ll9ncmFudChjYW4sIG1zZywgdGFyZ2V0KQoJCWlmIChjYW4uQ29uZigiZGlzcGxheSIpICE9ICJzaW1wbGUiKSB7CgkJCWNhbi5vbmltcG9ydC5fdGl0bGUoY2FuLCBtc2csIHRhcmdldCkKCQkJY2FuLm9uaW1wb3J0Ll9zdGF0ZShjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX3NlYXJjaChjYW4sIG1zZywgdGFyZ2V0KQoJCQljYW4ub25pbXBvcnQuX2JhY2tncm91bmQoY2FuLCBtc2csIHRhcmdldCkKCQkJY2FuLm9uaW1wb3J0Ll9hdmF0YXIoY2FuLCBtc2csIHRhcmdldCkKCQkJY2FuLm9uaW1wb3J0Ll9tZW51cyhjYW4sIG1zZywgdGFyZ2V0KQoKCQl9CgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgl9LAoJX2FnZW50OiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLnJ1bih7fSwgW2NoYXQuQUdFTlRdLCBmdW5jdGlvbihtc2cpIHsgaWYgKCFtc2cuT3B0aW9uKG5mcy5TQ1JJUFQpKSB7IHJldHVybiB9CgkJCWNhbi5yZXF1aXJlKGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKG5mcy5TQ1JJUFQpKSwgZnVuY3Rpb24oY2FuKSB7IGNhbi5vbmFjdGlvbi5zb3VyY2UoY2FuLCBtc2cpIH0pCgkJfSkKCX0sCglfZ3JhbnQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQlpZiAoY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5HUkFOVCkpIHsKCQkJaWYgKGNhbi51c2VyLmNvbmZpcm0oY2hhdC5HUkFOVCtpY2UuU1ArY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5HUkFOVCkpKSB7CgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY2hhdC5HUkFOVCwgd2ViLlNQQUNFLCBjYW4ubWlzYy5TZWFyY2goY2FuLCBjaGF0LkdSQU5UKV0pCgkJCX0KCQkJY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5HUkFOVCwgIiIpCgkJfQoJfSwKCV90aXRsZTogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCWNhbi51c2VyLnRpdGxlKGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuVElUTEUpfHxjYW4ubWlzYy5TZWFyY2goY2FuLCBpY2UuUE9EKSkKCQkhY2FuLnVzZXIuaXNNb2JpbGUgJiYgY2FuLmNvcmUuTGlzdChjYW4uYmFzZS5nZXRWYWxpZChtc2cucmVzdWx0LCBjYW4uQ29uZihjaGF0LlRJVExFKXx8WyJzaHlsaW51eC5jb20veC9jb250ZXh0cyJdKSwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2NoYXQuVElUTEUsIGh0bWwuRElWLCBpdGVtXSwgdGl0bGU6ICLov5Tlm57kuLvpobUiLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9uYWN0aW9uLnRpdGxlKGV2ZW50LCBjYW4pCgkJCX0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsgdmFyIGxpc3QgPSBtc2cuVGFibGUoKQoJCQkJY2FuLnVzZXIuY2FydGUoZXZlbnQsIGNhbiwge30sIGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS5uYW1lIH0pLCBmdW5jdGlvbihldmVudCwgaXRlbSwgbWV0YSwgaW5kZXgpIHsKCQkJCQlldmVudC5zaGlmdEtleT8gY2FuLnVzZXIub3BlbihsaXN0W2luZGV4XS5wYXRoKTogY2FuLnVzZXIuanVtcHMobGlzdFtpbmRleF0ucGF0aCkKCQkJCX0pCgkJCX19XSkKCQl9KQoJfSwKCV9zdGF0ZTogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgewoJCWNhbi5jb3JlLkxpc3QoY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5TVEFURSl8fGNhbi5Db25mKGNoYXQuU1RBVEUpLCBbbWRiLlRJTUUsIGFhYS5VU0VSTklDS10pLCBmdW5jdGlvbihpdGVtKSB7CgkJCWlmIChpdGVtID09IGFhYS5BVkFUQVIgKSB7IGlmIChjYW4udXNlci5pc0xvY2FsRmlsZSkgeyByZXR1cm4gfQoJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6IGNhbi5iYXNlLmpvaW4oW2NoYXQuU1RBVEUsIGl0ZW1dKSwgbGlzdDogW3tpbWc6IGljZS5TUH1dLCBvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJaWYgKG1zZy5PcHRpb24oYWFhLkFWQVRBUikuaW5kZXhPZigiaHR0cCIpID09IDApIHsKCQkJCQkJY2FuLm9uYWN0aW9uLmNhcnRlKGV2ZW50LCBjYW4sIFtjYW4ucGFnZS5Gb3JtYXQoaHRtbC5JTUcsIG1zZy5PcHRpb24oYWFhLkFWQVRBUiksIDE2MCldKQoJCQkJCX0gZWxzZSB7CgkJCQkJCWNhbi5vbmFjdGlvbi5jYXJ0ZShldmVudCwgY2FuLCBbY2FuLnBhZ2UuRm9ybWF0KGh0bWwuSU1HLCAiL3NoYXJlL2xvY2FsL2F2YXRhciIsIDE2MCldKQoJCQkJCX0KCQkJCX19XSk7IHJldHVybgoJCQl9CgoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2Nhbi5iYXNlLmpvaW4oW2NoYXQuU1RBVEUsIGl0ZW1dKSwgaHRtbC5ESVYsIChjYW4uQ29uZihpdGVtKXx8IiIpLnNsaWNlKDAsIDEwKV0sIG9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25hY3Rpb24sIGl0ZW1dLCBbZXZlbnQsIGNhbiwgaXRlbV0pCgkJCX0sIF9pbml0OiBmdW5jdGlvbih0YXJnZXQpIHsgaXRlbSA9PSBtZGIuVElNRSAmJiBjYW4ub25pbXBvcnQuX3RpbWUoY2FuLCB0YXJnZXQpIH19XSkKCQl9KQoJfSwKCV9zZWFyY2g6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQl2YXIgdWkgPSBjYW4ub25hcHBlbmQuaW5wdXQoY2FuLCB7dHlwZTogaHRtbC5URVhULCBuYW1lOiBtZGIuU0VBUkNILCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmtleW1hcC5pbnB1dChldmVudCwgY2FuKTsgc3dpdGNoIChldmVudC5rZXkpIHsKCQkJCWNhc2UgbGFuZy5FTlRFUjogY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sICJvbm9wZW5zZWFyY2giLCBjYW4ucmVxdWVzdChldmVudCwge3R5cGU6ICIqIiwgd29yZDogZXZlbnQudGFyZ2V0LnZhbHVlfSkpCgkJCX0KCQl9fSwgIiIsIHRhcmdldCwgInRpdGxlIHNlYXJjaCIpLnBhcmVudE5vZGUKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dHlwZTogInNlYXJjaCIsIGxpc3Q6IFt7dmlldzogWyJtZW51IiwgImRpdiIsIGNhbi51c2VyLnRyYW5zKGNhbiwgInNlYXJjaCIpXSwgb25jbGljazogZnVuY3Rpb24oKSB7CgkJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCAib25vcGVuc2VhcmNoIiwgY2FuLnJlcXVlc3QoZXZlbnQsIHt0eXBlOiAiKiIsIHdvcmQ6ICIifSkpCgkJfX1dIH1dKQoJCWNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi5wYWdlLk1vZGlmeShjYW4sIHVpLCB7c3R5bGU6IHtmbG9hdDogaHRtbC5SSUdIVH19KQoJfSwKCV9iYWNrZ3JvdW5kOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWlmIChjYW4uQ29uZigiYmFja2dyb3VuZCIpID09ICJfIikgeyByZXR1cm4gfQoJCWlmIChjYW4udXNlci5pc0V4dGVuc2lvbiB8fCBjYW4udXNlci5pc0xvY2FsRmlsZSkgeyByZXR1cm4gfQoJCW1zZy5PcHRpb24oYWFhLkJBQ0tHUk9VTkQpICYmIGNhbi5vbmxheW91dC5iYWNrZ3JvdW5kKGNhbiwgIi9zaGFyZS9sb2NhbC9iYWNrZ3JvdW5kIiwgZG9jdW1lbnQuYm9keSkKCX0sCglfYXZhdGFyOiBmdW5jdGlvbihjYW4sIG1zZykgeyBpZiAoY2FuLnVzZXIuaXNFeHRlbnNpb24gfHwgY2FuLnVzZXIuaXNMb2NhbEZpbGUpIHsgcmV0dXJuIH0gaWYgKCFtc2cuT3B0aW9uKGFhYS5BVkFUQVIpKSB7IHJldHVybiB9CgkJaWYgKG1zZy5PcHRpb24oYWFhLkFWQVRBUikuaW5kZXhPZigiaHR0cCIpID09IDApIHsKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgImRpdi5zdGF0ZS5hdmF0YXI+aW1nIiwge3NyYzogbXNnLk9wdGlvbihhYWEuQVZBVEFSKX0pCgkJfSBlbHNlIHsKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgImRpdi5zdGF0ZS5hdmF0YXI+aW1nIiwge3NyYzogIi9zaGFyZS9sb2NhbC9hdmF0YXIifSkKCQl9Cgl9LAoJX21lbnVzOiBmdW5jdGlvbihjYW4sIG1zZywgdGFyZ2V0KSB7CgkJY2FuLnNldEhlYWRlck1lbnUoY2FuLnVzZXIubW9kLmlzUG9kfHxjYW4udXNlci5pc0V4dGVuc2lvbnx8Y2FuLnVzZXIuaXNNb2JpbGU/IFtjdHguQ09ORklHXToKCQkJY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5NRU5VUyl8fGNhbi5Db25mKGNoYXQuTUVOVVMpLCBjYW4ub25hY3Rpb24uX21lbnVzKSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbikgewoJCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoY2FuLm9uYWN0aW9uW2J1dHRvbl18fGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCQljYW4ucnVuKGV2ZW50LCBbYnV0dG9uXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0KGNhbiwgIuaJp+ihjOaIkOWKnyIsIGNhbi51c2VyLnRyYW5zKGNhbiwgYnV0dG9uKSkgfSkKCQkJCX0sIHtldmVudDogZXZlbnQsIGNhbjogY2FuLCBidXR0b246IGJ1dHRvbn0pCgkJCX0pCgl9LAoKCV90aW1lOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCWNhbi5jb3JlLlRpbWVyKHtpbnRlcnZhbDogNTAwfSwgZnVuY3Rpb24oKSB7IGNhbi5vbmltcG9ydC50aW1lKGNhbiwgdGFyZ2V0KSB9KQoJCWNhbi5vbmFwcGVuZC5maWd1cmUoY2FuLCB7YWN0aW9uOiAiZGF0ZSIsIHN0eWxlOiB7Im1pbi13aWR0aCI6IDMwNn19LCB0YXJnZXQsIGZ1bmN0aW9uKHN1YikgewoJCQljYW4uZ2V0KCJBY3Rpb24iLCAic2l6ZSIsIGZ1bmN0aW9uKG1zZywgdG9wKSB7CgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBzdWIuX3RhcmdldCwge3N0eWxlOiB7dG9wOiB0b3AsIHJpZ2h0OiAwLCBsZWZ0OiBudWxsfX0pCgkJCX0pCgkJfSksIHRhcmdldC5vbm1vdXNlZW50ZXIgPSB0YXJnZXQuY2xpY2sKCX0sCgl0aW1lOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyBjYW4ub25sYXlvdXQudG9waWMoY2FuKQoJCXRhcmdldC5pbm5lckhUTUwgPSBjYW4udXNlci50aW1lKGNhbiwgbnVsbCwgIiV3ICVIOiVNOiVTIikKCX0sCgl0b3BpYzogZnVuY3Rpb24oY2FuLCB0b3BpYykgeyBjYW4ub25sYXlvdXQudG9waWMoY2FuLCBjYW4uX3RvcGljID0gdG9waWMpIH0sCgliYWNrZ3JvdW5kOiBmdW5jdGlvbihldmVudCwgY2FuLCB1cmwpIHsgaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uIHx8IGNhbi51c2VyLmlzTG9jYWxGaWxlKSB7IHJldHVybiB9CgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGFhYS5CQUNLR1JPVU5ELCB1cmxdLCBmdW5jdGlvbihtc2cpIHsgY2FuLm9uaW1wb3J0Ll9iYWNrZ3JvdW5kKGNhbiwgbXNnKSB9KQoJfSwKCWF2YXRhcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdXJsKSB7IGlmIChjYW4udXNlci5pc0V4dGVuc2lvbiB8fCBjYW4udXNlci5pc0xvY2FsRmlsZSkgeyByZXR1cm4gfQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBhYWEuQVZBVEFSLCB1cmxdLCBmdW5jdGlvbihtc2cpIHsgY2FuLm9uaW1wb3J0Ll9hdmF0YXIoY2FuLCBtc2cpIH0pCgl9LAoJbWVudTogZnVuY3Rpb24oY2FuLCBjbWRzLCBjYiwgdHJhbnMpIHsKCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLl9vdXRwdXQsIFt7dHlwZTogY21kc1swXSwgbGlzdDogY2FuLmNvcmUuTGlzdChjbWRzLnNsaWNlKDEpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWlmIChjYW4uYmFzZS5pc1N0cmluZyhpdGVtKSkgewoJCQkJcmV0dXJuIHt2aWV3OiBbaHRtbC5NRU5VLCBodG1sLkRJViwgY2FuLnVzZXIudHJhbnMoY2FuLCBpdGVtLCB0cmFucyldLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQsIGl0ZW0sIGNtZHMpCgkJCQl9fQoKCQkJfSBlbHNlIGlmIChjYW4uYmFzZS5pc0FycmF5KGl0ZW0pKSB7CgkJCQl2YXIgbGlzdCA9IGNhbi5jb3JlLkxpc3QoaXRlbSwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7IHJldHVybiBjYW4udXNlci50cmFucyhjYW4sIHZhbHVlLCB0cmFucykgfSkKCQkJCXJldHVybiB7dmlldzogW2h0bWwuTUVOVSwgaHRtbC5ESVYsIGNhbi51c2VyLnRyYW5zKGNhbiwgbGlzdFswXSwgdHJhbnMpXSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5vbmFjdGlvbi5jYXJ0ZShldmVudCwgY2FuLCBsaXN0LnNsaWNlKDEpLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBtZXRhLCBpbmRleCkgewoJCQkJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGV2ZW50LCBpdGVtW2luZGV4KzFdLCBpdGVtKQoJCQkJCX0sIHRyYW5zKQoJCQkJfX0KCgkJCX0gZWxzZSBpZiAoY2FuLmJhc2UuaXNPYmplY3QoaXRlbSkpIHsKCQkJCXJldHVybiBpdGVtCgkJCX0KCQl9KSB9XSkuZmlyc3QKCX0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5Lqk5LqS5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIGNiLCB0YXJnZXQpIHsKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCX0sCglfbWVudXM6IFtbInNldHRpbmciLCBjaGF0LkJMQUNLLCBjaGF0LldISVRFLCBjaGF0LlBSSU5ULCAid2VicGFjayIsICJ0b2ltYWdlIiwgY3R4LkNPTkZJR11dLAoJX3RyYW5zOiB7CgkJInNlYXJjaCI6ICLmkJzntKIiLAoJCSJjcmVhdGUiOiAi5Yib5bu6IiwKCQkic2hhcmUiOiAi5YWx5LqrIiwKCgkJInNldHRpbmciOiAi6K6+572uIiwKCQkiYmxhY2siOiAi6buR6Imy5Li76aKYIiwKCQkid2hpdGUiOiAi55m96Imy5Li76aKYIiwKCQkicHJpbnQiOiAi5omT5Y2w5Li76aKYIiwKCQkidG9pbWFnZSI6ICLnlJ/miJDlm77niYciLAoJCSJjb25maWciOiAi5ouJ5Y+W6YWN572uIiwKCgkJInNoYXJldXNlciI6ICLlhbHkuqvnlKjmiLciLAoJCSJzZXRuaWNrIjogIuiuvue9ruaYteensCIsCgkJInBhc3N3b3JkIjogIuS/ruaUueWvhueggSIsCgkJImxhbmd1YWdlIjogIuivreiogOWcsOWMuiIsCgkJImNoaW5lc2UiOiAi5Lit5paHIiwKCQkiY2xlYXIiOiAi5riF6Zmk6IOM5pmvIiwKCX0sCglvbm1haW46IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJZnVuY3Rpb24gaW5pdCgpIHsgY2FuLnJ1bih7fSwgW10sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4uYmFzZS5Db3B5KGNhbi5vbmFjdGlvbi5fdHJhbnMsIGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKGNoYXQuVFJBTlMpLCB7fSkpCgkJCWNhbi5vbmltcG9ydC5faW5pdChjYW4sIG1zZywgZnVuY3Rpb24obXNnKSB7IGNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCBjaGF0Lk9OTE9HSU4sIG1zZykgfSwgY2FuLl9vdXRwdXQpCgkJfSkgfQoKCQkvLyDnmbvlvZXmo4Dmn6UKCQljYW4udXNlci5pc0xvY2FsRmlsZT8gaW5pdCgpOiBjYW4ucnVuKHt9LCBbY2hhdC5DSEVDS10sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4uQ29uZihhYWEuVVNFUk5JQ0ssIG1zZy5PcHRpb24oaWNlLk1TR19VU0VSTklDSyl8fG1zZy5PcHRpb24oaWNlLk1TR19VU0VSTkFNRSkpPyBpbml0KCk6CgkJCQltc2cuT3B0aW9uKGNoYXQuU1NPKT8gY2FuLnVzZXIuanVtcHMobXNnLk9wdGlvbihjaGF0LlNTTykpOgoJCQkJY2FuLnVzZXIubG9naW4oY2FuLCBpbml0LCBtc2cuT3B0aW9uKGFhYS5MT0dJTiksIG1zZy5PcHRpb24oImxvZ2luLmRldiIpKQoJCX0pCgl9LAoJb25zdG9ybV9zZWxlY3Q6IGZ1bmN0aW9uKGNhbiwgbXNnLCByaXZlciwgc3Rvcm0pIHsgY2FuLkNvbmYoY2hhdC5SSVZFUiwgcml2ZXIpLCBjYW4uQ29uZihjaGF0LlNUT1JNLCBzdG9ybSkgfSwKCW9uc2VhcmNoZm9jdXM6IGZ1bmN0aW9uKGNhbikgewoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fb3V0cHV0LCAiZGl2LnNlYXJjaCBpbnB1dCIsIGZ1bmN0aW9uKHRhcmdldCkgeyB0YXJnZXQuZm9jdXMoKSB9KQoJfSwKCW9ud2VicGFjazogZnVuY3Rpb24oY2FuLCBtc2cpIHsgY2FuLm9uYWN0aW9uWyJ3ZWJwYWNrIl0obXNnLl9ldmVudCwgY2FuKSB9LAoKCXRpdGxlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIGFyZ3MgPSB7fTsgY2FuLmNvcmUuTGlzdChbY2hhdC5USVRMRSwgY2hhdC5UT1BJQywgY2hhdC5MQVlPVVRdLCBmdW5jdGlvbihrZXkpIHsKCQkJdmFyIHZhbHVlID0gY2FuLm1pc2MuU2VhcmNoKGNhbiwga2V5KTsgdmFsdWUgJiYgKGFyZ3Nba2V5XSA9IHZhbHVlKQoJCX0pCgkJY2FuLnVzZXIuanVtcHMoY2FuLm1pc2MuTWVyZ2VVUkwoY2FuLCBhcmdzLCB0cnVlKSkKCX0sCgoJYmxhY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBjYW4ub25sYXlvdXQudG9waWMoY2FuLCBidXR0b24pLCBjYW4ub25sYXlvdXQuX2luaXQoY2FuKSB9LAoJd2hpdGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBjYW4ub25sYXlvdXQudG9waWMoY2FuLCBidXR0b24pLCBjYW4ub25sYXlvdXQuX2luaXQoY2FuKSB9LAoJcHJpbnQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBjYW4ub25sYXlvdXQudG9waWMoY2FuLCBjYW4uYmFzZS5qb2luKFtjaGF0LldISVRFLCBidXR0b25dKSkKCQljYW4uc2V0KCJSaXZlciIsIGh0bWwuSEVJR0hULCAtMSksIGNhbi5zZXQoIkFjdGlvbiIsIGh0bWwuSEVJR0hULCAtMSkKCX0sCgljb25maWc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6ICJzY29wZSIsIHZhbHVlOiAiZXRjL2xvY2FsLnNoeSJ9XSwgZnVuY3Rpb24oZXYsIGJ1dHRvbiwgbWV0YSwgbGlzdCwgYXJncykgewoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY3R4LkNPTkZJR10uY29uY2F0KGFyZ3MpLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIuanVtcHMobXNnLlJlc3VsdCgpKSB9KQoJCX0pCgl9LAoJd2VicGFjazogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7bmFtZTogbWRiLk5BTUUsIHZhbHVlOiBjYW4udXNlci50aXRsZSgpfV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIG1ldGEsIGxpc3QpIHsKCQkJY2FuLmNvcmUuSXRlbShWb2xjYW5vcy5tZXRhLnBhY2ssIGZ1bmN0aW9uKGtleSwgbXNnKSB7IAoJCQkJY2FuLmNvcmUuTGlzdChbIl9ldmVudCIsICJfY2FuIiwgIl94aHIiLCBpY2UuTVNHX1NFU1NJRCwgIiJdLCBmdW5jdGlvbihrZXkpIHsgZGVsZXRlKG1zZ1trZXldKSB9KQoJCQl9KQoJCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHsKCQkJCXRvcGljOiBjYW4uX3RvcGljLCBsYXlvdXQ6ICBjYW4uZ2V0QWN0aW9uKGNoYXQuTEFZT1VUKSwKCQkJCXJpdmVyOiBjYW4uQ29uZihjaGF0LlJJVkVSKSwgc3Rvcm06IGNhbi5Db25mKGNoYXQuU1RPUk0pLAoJCQkJbmFtZTogbWV0YS5uYW1lLCBjb250ZW50OiBKU09OLnN0cmluZ2lmeShWb2xjYW5vcy5tZXRhLnBhY2spLAoJCQkJYXJnczogIm5hbWUsdG9waWMsbGF5b3V0LHJpdmVyLHN0b3JtIiwKCQkJfSkKCgkJCXZhciB0b2FzdCA9IGNhbi51c2VyLnRvYXN0KGNhbiwgIuaJk+WMheS4rS4uLiIsIGNvZGUuV0VCUEFDSywgMTAwMDAwMCkKCQkJY2FuLnJ1bihldmVudCwgW2NvZGUuV0VCUEFDS10sIGZ1bmN0aW9uKG1zZykgewoJCQkJdG9hc3QuY2xvc2UoKSwgY2FuLnVzZXIudG9hc3QoY2FuLCAi5omT5YyF5oiQ5YqfIiwgY29kZS5XRUJQQUNLKQoJCQkJY2FuLnVzZXIuZG93bmxvYWQoY2FuLCAiL3NoYXJlL2xvY2FsLyIrbXNnLlJlc3VsdCgpLCBuYW1lKyIuaHRtbCIpCgkJCX0pCgkJfSkKCX0sCgl0b2ltYWdlOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgY2FuLm9ubW90aW9uLnRvaW1hZ2UoZXZlbnQsIGNhbiwgZG9jdW1lbnQudGl0bGUsIGRvY3VtZW50LmJvZHkpIH0sCgoJY2FydGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGxpc3QsIGNiLCB0cmFucykgeyBjYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBjYW4ub25hY3Rpb24sIGxpc3QsIGNiKSB9LAoJc2hhcmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGFyZ3MpIHsKCQljYW4udXNlci5zaGFyZShjYW4sIGNhbi5yZXF1ZXN0KGV2ZW50KSwgW2N0eC5BQ1RJT04sIGNoYXQuU0hBUkVdLmNvbmNhdChhcmdzfHxbXSwKCQkJW2NoYXQuUklWRVIsIGNhbi5Db25mKGNoYXQuUklWRVIpLCBjaGF0LlNUT1JNLCBjYW4uQ29uZihjaGF0LlNUT1JNKV0pKQoJfSwKCgl1c2VybmljazogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLm1vZC5pc1BvZCB8fCBjYW4udXNlci5pc0V4dGVuc2lvbiB8fCBjYW4udXNlci5pc0xvY2FsRmlsZSB8fCBjYW4ub25hY3Rpb24uY2FydGUoZXZlbnQsIGNhbiwgWyJzaGFyZXVzZXIiLCAic2V0bmljayIsICJwYXNzd29yZCIsIFthYWEuTEFOR1VBR0UsIGFhYS5DSElORVNFLCBhYWEuRU5HTElTSF0sIGNsaS5DTEVBUiwgYWFhLkxPR09VVF0pCgl9LAoJc2hhcmV1c2VyOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi51c2VyLnNoYXJlKGNhbiwgY2FuLnJlcXVlc3QoZXZlbnQpLCBbY3R4LkFDVElPTiwgY2hhdC5TSEFSRSwgbWRiLlRZUEUsIGFhYS5MT0dJTl0pIH0sCglzZXRuaWNrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIHVpID0gY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiBhYWEuVVNFUk5JQ0ssIHZhbHVlOiBjYW4uQ29uZihhYWEuVVNFUk5JQ0spfV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLnJ1bihldmVudCwgW2FhYS5VU0VSTklDSywgbGlzdFswXV0sIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIGNhbi5jb3JlLktleXMoaHRtbC5ESVYsIGFhYS5VU0VSTklDSyksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBpdGVtLCBjYW4uQ29uZihhYWEuVVNFUk5JQ0ssIGxpc3RbMF0pKQoJCQkJfSksIGNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJCX0sIHRydWUpCgkJfSkKCQljYW4udXNlci5pc01vYmlsZSAmJiBjYW4ucGFnZS5Nb2RpZnkoY2FuLCB1aS5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IDQwLCByaWdodDogMCwgbGVmdDogIiJ9fSkKCX0sCglwYXNzd29yZDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciB1aSA9IGNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7bmFtZTogaHRtbC5QQVNTV09SRCwgdHlwZTogaHRtbC5QQVNTV09SRCwgYWN0aW9uOiBpY2UuQVVUT30sIHtuYW1lOiBodG1sLlBBU1NXT1JELCB0eXBlOiBodG1sLlBBU1NXT1JELCBhY3Rpb246IGljZS5BVVRPfV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJaWYgKGxpc3RbMF0gIT0gbGlzdFsxXSkgewoJCQkJY2FuLnVzZXIudG9hc3QoY2FuLCAi5a+G56CB5LiN5LiA6Ie0IikKCQkJCXVpLmZvY3VzKCkKCQkJCXJldHVybiB0cnVlCgkJCX0KCgkJCWNhbi5ydW4oZXZlbnQsIFthYWEuUEFTU1dPUkQsIGxpc3RbMF1dLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJCX0sIHRydWUpCgkJfSkKCQljYW4udXNlci5pc01vYmlsZSAmJiBjYW4ucGFnZS5Nb2RpZnkoY2FuLCB1aS5fdGFyZ2V0LCB7c3R5bGU6IHt0b3A6IDQwLCByaWdodDogMCwgbGVmdDogIiJ9fSkKCX0sCgljaGluZXNlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5taXNjLlNlYXJjaChjYW4sIGFhYS5MQU5HVUFHRSwgInpoIikgfSwKCWVuZ2xpc2g6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm1pc2MuU2VhcmNoKGNhbiwgYWFhLkxBTkdVQUdFLCAiZW4iKSB9LAoJY2xlYXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0LmJhY2tncm91bmQoZXZlbnQsIGNhbiwgIiIpLCBjYW4ub25pbXBvcnQuYXZhdGFyKGV2ZW50LCBjYW4sICIiKSwgY2FuLnVzZXIucmVsb2FkKHRydWUpIH0sCglsb2dvdXQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnVzZXIubG9nb3V0KGNhbikgfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXSwKCWhlaWdodDogZnVuY3Rpb24oY2FuKSB7IHJldHVybiBjYW4uX3RhcmdldC5vZmZzZXRIZWlnaHQgfSwKCXRvcGljOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5fdG9waWMgfSwKfSkKCg==",
        "/panel/river.css": "ZmllbGRzZXQuUml2ZXIgeyBvdmVyZmxvdzphdXRvOyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgeyB3aWR0aDoxODBweDsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5pdGVtIHsgcGFkZGluZzozcHggMTZweDsgYm9yZGVyLWxlZnQ6c29saWQgM3B4ICMwMGZmYWU7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbS5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyZTUxNWY7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzJlNTE1ZjsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IHsgcGFkZGluZy1sZWZ0OjVweDsgbWFyZ2luLWxlZnQ6OHB4OyB9CmZpZWxkc2V0LlJpdmVyPmRpdi5vdXRwdXQgZGl2Lmxpc3QgZGl2Lml0ZW0geyBiYWNrZ3JvdW5kLWNvbG9yOiMwNzM1NDBiNTsgYm9yZGVyLWxlZnQ6c29saWQgM3B4ICNjY2RjNGM7IH0KZmllbGRzZXQuUml2ZXI+ZGl2Lm91dHB1dCBkaXYubGlzdCBkaXYuaXRlbS5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOnN0ZWVsYmx1ZTsgfQpmaWVsZHNldC5SaXZlcj5kaXYub3V0cHV0IGRpdi5saXN0IGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjpzdGVlbGJsdWU7IH0K",
        "/panel/river.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJaWYgKG1zZy5PcHRpb24oaWNlLk1TR19SSVZFUikgPT0gIl9zaGFyZSIpIHsgcmV0dXJuIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuKSB9CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5yaXZlcl9saXN0ID0ge30sIGNhbi5zdG9ybV9saXN0ID0ge30KCgkJY2FuLm9uaW1wb3J0Ll9tYWluKGNhbiwgbXNnKSwgY2FuLm9uaW1wb3J0Ll9tZW51KGNhbiwgbXNnKQoJCXZhciBzZWxlY3Q7IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBtc2cuVGFibGUoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJcmV0dXJuIGNhbi5vbmltcG9ydC5fcml2ZXIoY2FuLCBpdGVtLCBmdW5jdGlvbih0YXJnZXQpIHsKCQkJCShpbmRleCA9PSAwIHx8IGl0ZW0uaGFzaCA9PSBjYW4uX21haW5fcml2ZXIpICYmIChzZWxlY3QgPSB0YXJnZXQpCgkJCX0pCgkJfSkpLCBzZWxlY3QgJiYgc2VsZWN0LmNsaWNrKCkKCX0sCglfbWFpbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsgY2FuLl9tYWluX3JpdmVyID0gInByb2plY3QiLCBjYW4uX21haW5fc3Rvcm0gPSAic3R1ZGlvIgoJCWlmIChjYW4udXNlci5pc0V4dGVuc2lvbikgeyB2YXIgYXJncyA9IFZvbGNhbm9zLm1ldGEuYXJncwoJCQljYW4uX21haW5fcml2ZXIgPSBhcmdzLnJpdmVyfHwicHJvZHVjdCIsIGNhbi5fbWFpbl9zdG9ybSA9IGFyZ3Muc3Rvcm18fCJjaHJvbWUiCgkJfQoJCWlmIChjYW4udXNlci5pc01vYmlsZSkgeyBjYW4uX21haW5fcml2ZXIgPSAicHJvZHVjdCIsIGNhbi5fbWFpbl9zdG9ybSA9ICJvZmZpY2UiIH0KCQlpZiAoY2FuLnVzZXIuaXNXZWlYaW4pIHsgY2FuLl9tYWluX3JpdmVyID0gInNlcnZpY2UiLCBjYW4uX21haW5fc3Rvcm0gPSAid3giIH0KCgkJY2FuLl9tYWluX3RpdGxlID0gY2FuLm1pc2MuU2VhcmNoKGNhbiwgY2hhdC5USVRMRSl8fG1zZy5PcHRpb24oaWNlLk1TR19USVRMRSl8fFZvbGNhbm9zLm1ldGEuYXJncy50aXRsZXx8Y2FuLm1pc2MuU2VhcmNoKGNhbiwgaWNlLlBPRCl8fGNhbi5fbWFpbl90aXRsZQoJCWNhbi5fbWFpbl9yaXZlciA9IGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuUklWRVIpfHxtc2cuT3B0aW9uKGljZS5NU0dfUklWRVIpfHxWb2xjYW5vcy5tZXRhLmFyZ3Mucml2ZXJ8fGNhbi5fbWFpbl9yaXZlcgoJCWNhbi5fbWFpbl9zdG9ybSA9IGNhbi5taXNjLlNlYXJjaChjYW4sIGNoYXQuU1RPUk0pfHxtc2cuT3B0aW9uKGljZS5NU0dfU1RPUk0pfHxWb2xjYW5vcy5tZXRhLmFyZ3Muc3Rvcm18fGNhbi5fbWFpbl9zdG9ybQoJfSwKCV9tZW51OiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsgcmV0dXJuIH0KCQl2YXIgbGlzdCA9IFtdCgkJY2FuLnNldEhlYWRlck1lbnUobGlzdC5jb25jYXQoY2FuLmJhc2UuT2JqKG1zZy5PcHRpb24oY2hhdC5NRU5VUyksIGNhbi5Db25mKGNoYXQuTUVOVVMpfHxjYW4ub25kZXRhaWwuX21lbnVzKSksIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24pIHsKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmRldGFpbCwgYnV0dG9uXSwgW2V2ZW50LCBjYW4sIGJ1dHRvbiwgY2FuLkNvbmYoY2hhdC5SSVZFUiksIGNhbi5Db25mKGNoYXQuU1RPUk0pXSkKCQl9KQoJfSwKCV9jYXJ0ZTogZnVuY3Rpb24oY2FuLCBsaXN0LCByaXZlciwgc3Rvcm0pIHsgaWYgKGNhbi51c2VyLmlzTW9iaWxlKSB7IHJldHVybiB9CgkJaWYgKGNhbi5jb3JlLlZhbHVlKGNhbi5fcm9vdCwgY2FuLmNvcmUuS2V5cyhjaGF0LlJJVkVSLCByaXZlcikpKSB7IHJldHVybiB9CgoJCWNhbi5vbmFjdGlvbi5jYXJ0ZShldmVudCwgY2FuLCBsaXN0LCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBtb2R1bGUpIHsKCQkJbW9kdWxlW2J1dHRvbl0oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pCgkJfSkKCX0sCglfcml2ZXI6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgY2IpIHsKCQlyZXR1cm4ge3RleHQ6IFttZXRhLm5hbWUsIGh0bWwuRElWLCBodG1sLklURU1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25hY3Rpb24uc3Rvcm0oZXZlbnQsIGNhbiwgbWV0YS5oYXNoKQoKCQl9LCBvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5vbmltcG9ydC5fY2FydGUoY2FuLCBjYW4ub25kZXRhaWwubGlzdCwgbWV0YS5oYXNoKQoKCQl9LCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7IGNiKHRhcmdldCkKCQkJY2FuLnJpdmVyX2xpc3RbbWV0YS5oYXNoXSA9IHRhcmdldAoJCX19Cgl9LAoJX3N0b3JtOiBmdW5jdGlvbihjYW4sIG1ldGEsIHJpdmVyKSB7CgkJcmV0dXJuIHt0ZXh0OiBbbWV0YS5uYW1lLCBodG1sLkRJViwgaHRtbC5JVEVNXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9uYWN0aW9uLmFjdGlvbihldmVudCwgY2FuLCByaXZlciwgbWV0YS5oYXNoKQoJCQljYW4udXNlci50aXRsZShjYW4uX21haW5fdGl0bGV8fG1ldGEubmFtZSkKCgkJfSwgb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25pbXBvcnQuX2NhcnRlKGNhbiwgY2FuLm9uZGV0YWlsLnN1Ymxpc3QsIHJpdmVyLCBtZXRhLmhhc2gpCgoJCX0sIF9pbml0OiBmdW5jdGlvbih0YXJnZXQpIHsKCQkJY2FuLnN0b3JtX2xpc3RbY2FuLmNvcmUuS2V5cyhyaXZlciwgbWV0YS5oYXNoKV0gPSB0YXJnZXQKCQl9fQoJfSwKCSJkaXNwbGF5IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBzaG93ID0gY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi5fdGFyZ2V0KTsgY2FuLm9ubGF5b3V0Ll9pbml0KGNhbikKCQlyZXR1cm4gc2hvdwoJfSwKfSkKVm9sY2Fub3MoIm9uZW5naW5lIiwge2hlbHA6ICLop6PmnpDlvJXmk44iLCBsaXN0OiBbXSwgX2VuZ2luZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbXNnLCBwYW5lbCwgY21kcywgY2IpIHsKCXZhciBsaXN0ID0gY2FuLl9yb290LnJpdmVyCgljbWRzLmxlbmd0aCA9PSAwICYmIGNhbi5jb3JlLkl0ZW1Tb3J0KGxpc3QsICJvcmRlciIsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKCQlpZiAoY2FuLmNvcmUuSXRlbSh2YWx1ZS5zdG9ybSkubGVuZ3RoID09IDApIHsgcmV0dXJuIH0KCQltc2cuUHVzaCh7aGFzaDoga2V5LCBuYW1lOiBjYW4udXNlci5sYW5ndWFnZShjYW4pID09ICJlbiI/IGtleTogdmFsdWUubmFtZX0pIC8vIOe+pOe7hOWIl+ihqAoJfSk7IGlmIChjbWRzLmxlbmd0aCAhPSAxICYmIGNtZHNbMV0gIT0gY2hhdC5TVE9STSkgeyByZXR1cm4gZmFsc2UgfQoKCXZhciByaXZlciA9IGxpc3RbY21kc1swXV07IGlmICghcml2ZXIpIHsgcmV0dXJuIGZhbHNlIH0KCWNhbi5jb3JlLkl0ZW1Tb3J0KHJpdmVyLnN0b3JtLCAib3JkZXIiLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJbXNnLlB1c2goe2hhc2g6IGtleSwgbmFtZTogY2FuLnVzZXIubGFuZ3VhZ2UoY2FuKSA9PSAiZW4iPyBrZXk6IHZhbHVlLm5hbWV9KSAvLyDlupTnlKjliJfooagKCX0pLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZyk7IHJldHVybiB0cnVlCn19KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaOp+S7tuS6pOS6kiIsIGxpc3Q6IFtdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBjYiwgdGFyZ2V0KSB7CgkJaWYgKGNhbi51c2VyLm1vZC5pc1dlYikgewoKCQl9IGVsc2UgaWYgKGNhbi51c2VyLm1vZC5pc1BvZCkgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQpCgkJfSBlbHNlIGlmIChjYW4udXNlci5pc0V4dGVuc2lvbikgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQpCgkJfSBlbHNlIGlmIChjYW4udXNlci5pc01vYmlsZSkgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQpCgkJfQoKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCX0sCglvbmxvZ2luOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgY2FuLkNvbmYoY3R4LkFDVElPTil8fGNhbi5vbmFjdGlvbi5saXN0KQoJCWNhbi5ydW4oe30sIFtdLCBmdW5jdGlvbihtc2cpIHsgY2FuLm9uaW1wb3J0Ll9pbml0KGNhbiwgbXNnLCBbXSwgbnVsbCwgY2FuLl9vdXRwdXQpIH0pCgl9LAoJb25zZWFyY2g6IGZ1bmN0aW9uKGNhbiwgbXNnLCB3b3JkKSB7CgkJaWYgKHdvcmRbMF0gPT0gY2hhdC5TVE9STSB8fCB3b3JkWzFdICE9ICIiKSB7IGNhbi5vbmV4cG9ydC5zdG9ybShjYW4sIG1zZywgd29yZCkgfQoJfSwKCW9uc3Rvcm1fc2VsZWN0OiBmdW5jdGlvbihjYW4sIG1zZywgcml2ZXIsIHN0b3JtKSB7IHZhciBhcmdzID0ge3JpdmVyOiByaXZlciwgc3Rvcm06IHN0b3JtfQoJCWlmIChjYW4udXNlci5pc0V4dGVuc2lvbikgeyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShjdHguQVJHUywgSlNPTi5zdHJpbmdpZnkoYXJncykpIH0KCX0sCglvbmFjdGlvbl90b3VjaDogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQljYW4ub25tb3Rpb24uZmxvYXQuZGVsKGNhbiwgY2hhdC5DQVJURSkKCQljYW4udXNlci5pc01vYmlsZSAmJiBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbikKCX0sCglvbmFjdGlvbl9ub3Rvb2w6IGZ1bmN0aW9uKGNhbiwgbXNnLCByaXZlciwgc3Rvcm0pIHsKCQljYW4ub25kZXRhaWxbIua3u+WKoOW3peWFtyJdKG1zZy5fZXZlbnQsIGNhbiwgIua3u+WKoOW3peWFtyIsIHJpdmVyLCBzdG9ybSkKCX0sCgoJY2FydGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGxpc3QsIGNiKSB7CgkJY2FuLnVzZXIuY2FydGVSaWdodChldmVudCwgY2FuLCBjYW4ub25kZXRhaWwsIGxpc3QsIGNiKQoJfSwKCXN0b3JtOiBmdW5jdGlvbihldmVudCwgY2FuLCByaXZlcikgeyBjYW4uc3VibGlzdCA9IGNhbi5zdWJsaXN0fHx7fQoJCWNhbi5vbm1vdGlvbi5zZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgImRpdi5pdGVtIiwgY2FuLnJpdmVyX2xpc3Rbcml2ZXJdKQoJCXZhciBsaXN0ID0gY2FuLnN1Ymxpc3Rbcml2ZXJdOyBpZiAobGlzdCkgeyByZXR1cm4gY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGxpc3QpIH0KCgkJY2FuLnJ1bih7fSwgW3JpdmVyLCBjaGF0LlNUT1JNXSwgZnVuY3Rpb24obXNnKSB7CgkJCXZhciBzZWxlY3QgPSAwOyBsaXN0ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLl9vdXRwdXQsIFt7dmlldzogaHRtbC5MSVNULCBsaXN0OiBtc2cuVGFibGUoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJCXJpdmVyID09IGNhbi5fbWFpbl9yaXZlciAmJiBpdGVtLmhhc2ggPT0gY2FuLl9tYWluX3N0b3JtICYmIChzZWxlY3QgPSBpbmRleCkKCQkJCXJldHVybiBjYW4ub25pbXBvcnQuX3N0b3JtKGNhbiwgaXRlbSwgcml2ZXIpCgkJCX0pIH1dKS5maXJzdCwgbGlzdC5jaGlsZHJlbi5sZW5ndGggPiAwICYmIGxpc3QuY2hpbGRyZW5bc2VsZWN0XS5jbGljaygpCgoJCQlldmVudC50YXJnZXQubmV4dFNpYmxpbmcgJiYgY2FuLl9vdXRwdXQuaW5zZXJ0QmVmb3JlKGxpc3QsIGV2ZW50LnRhcmdldC5uZXh0U2libGluZykKCQkJY2FuLnN1Ymxpc3Rbcml2ZXJdID0gbGlzdAoJCX0pCgl9LAoJYWN0aW9uOiBmdW5jdGlvbihldmVudCwgY2FuLCByaXZlciwgc3Rvcm0pIHsKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4uc3VibGlzdFtyaXZlcl0sIHtzdHlsZToge2Rpc3BsYXk6IGh0bWwuQkxPQ0t9fSkKCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYuaXRlbSIsIGNhbi5yaXZlcl9saXN0W3JpdmVyXSkKCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYubGlzdCBkaXYuaXRlbSIsIGNhbi5zdG9ybV9saXN0W2Nhbi5jb3JlLktleXMocml2ZXIsIHN0b3JtKV0pCgoJCWNhbi5vbmVuZ2luZS5zaWduYWwoY2FuLCAib25zdG9ybV9zZWxlY3QiLCBjYW4ucmVxdWVzdChldmVudCwgewoJCQlyaXZlcjogY2FuLkNvbmYoY2hhdC5SSVZFUiwgcml2ZXIpLCBzdG9ybTogY2FuLkNvbmYoY2hhdC5TVE9STSwgc3Rvcm0pLAoJCX0pKQoJfSwKCgljcmVhdGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci50cmFucyhjYW4sIHsicHVibGljIjogIuWFrOW8gOe+pCIsICJwcm90ZWN0ZWQiOiAi5YaF6YOo576kIiwgInByaXZhdGUiOiAi56eB5pyJ576kIn0pCgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgWwoJCQl7bmFtZTogbWRiLlRZUEUsIHZhbHVlczogW2NoYXQuUFVCTElDLCBjaGF0LlBST1RFQ1RFRCwgY2hhdC5QUklWQVRFXSwgX3RyYW5zOiAi57G75Z6LIn0sCgkJCXtuYW1lOiBtZGIuTkFNRSwgdmFsdWU6ICJoaSIsIF90cmFuczogIue+pOWQjSJ9LCB7bmFtZTogbWRiLlRFWFQsIHZhbHVlOiAiaGVsbG8iLCBfdHJhbnM6ICLnroDku4sifSwKCQldLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBtZXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuQ1JFQVRFXS5jb25jYXQoYXJncyksIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLm1pc2MuU2VhcmNoKGNhbiwge3JpdmVyOiBtc2cuUmVzdWx0KCl9KQoJCQl9KQoJCX0pCgl9LAoJcmVmcmVzaDogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBhcmdzID0ge3JpdmVyOiBjYW4uQ29uZihjaGF0LlJJVkVSKSwgc3Rvcm06IGNhbi5Db25mKGNoYXQuU1RPUk0pLAoJCQl0b3BpYzogY2FuLmdldEhlYWRlcihjaGF0LlRPUElDKSwgbGF5b3V0OiBjYW4uZ2V0QWN0aW9uKGNoYXQuTEFZT1VUKSwKCQl9CgkJaWYgKGNhbi51c2VyLmlzRXh0ZW5zaW9uKSB7IGxvY2FsU3RvcmFnZS5zZXRJdGVtKGN0eC5BUkdTLCBKU09OLnN0cmluZ2lmeShhcmdzKSkgfQoJCWNhbi5taXNjLlNlYXJjaChjYW4sIGFyZ3MpCgl9LAp9KQpWb2xjYW5vcygib25kZXRhaWwiLCB7aGVscDogIuiPnOWNleS6pOS6kiIsCglsaXN0OiBbIuWFseS6q+e+pOe7hCIsICLmt7vliqDlupTnlKgiLCAi5re75Yqg6K6+5aSHIiwgIua3u+WKoOeUqOaItyIsICLph43lkb3lkI3nvqTnu4QiLCAi5Yig6Zmk576k57uEIl0sCglzdWJsaXN0OiBbIuWFseS6q+W6lOeUqCIsICLmt7vliqDlt6XlhbciLCAi5L+d5a2Y5Y+C5pWwIiwgIumHjeWRveWQjeW6lOeUqCIsICLliKDpmaTlupTnlKgiXSwKCV9tZW51czogWwoJCVsiY3JlYXRlIiwgIuWIm+W7uue+pOe7hCIsICLmt7vliqDlupTnlKgiLCAi5re75Yqg5bel5YW3IiwgIua3u+WKoOiuvuWkhyIsICLliJvlu7rnqbrpl7QiXSwKCQlbInNoYXJlIiwgIuWFseS6q+e+pOe7hCIsICLlhbHkuqvlupTnlKgiLCAi5YWx5Lqr5bel5YW3IiwgIuS4i+i9veW6lOeUqCIsICLorr/pl67nqbrpl7QiXSwKCV0sCgoJIuWIm+W7uue+pOe7hCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLmNyZWF0ZShldmVudCwgY2FuKSB9LAoJIuWFseS6q+e+pOe7hCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsKCQljYW4ub25tb3Rpb24uc2hhcmUoZXZlbnQsIGNhbiwgW3tuYW1lOiBjaGF0LlRJVExFLCB2YWx1ZTogcml2ZXJ9XSwgW21kYi5UWVBFLCBjaGF0LlJJVkVSXSkKCX0sCgki5re75Yqg5bqU55SoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlcikgeyBjYW4ub25kZXRhaWwuY3JlYXRlKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIH0sCgki5YWx5Lqr5bqU55SoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4ub25tb3Rpb24uc2hhcmUoZXZlbnQsIGNhbiwgW3tuYW1lOiBjaGF0LlRJVExFLCB2YWx1ZTogc3Rvcm19XSwgW21kYi5UWVBFLCBjaGF0LlNUT1JNXSkKCX0sCgki5re75Yqg5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4udXNlci5zZWxlY3QoZXZlbnQsIGNhbiwgY3R4LkNPTU1BTkQsICJjb250ZXh0LGNvbW1hbmQiLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCWNhbi5ydW4oe30sIFtyaXZlciwgY2hhdC5TVE9STSwgY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgbWRiLkhBU0gsIHN0b3JtXS5jb25jYXQoW2ljZS5QT0QsICIiLCBpY2UuQ1RYLCBpdGVtWzBdLCBpY2UuQ01ELCBpdGVtWzFdXSksIGZ1bmN0aW9uKG1zZykgewoJCQkJbmV4dCgpCgkJCX0pCgkJfSwgZnVuY3Rpb24oKSB7CgkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogcml2ZXIsIHN0b3JtOiBzdG9ybX0pCgkJfSkKCX0sCgki5YWx5Lqr5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4udXNlci5zZWxlY3QoZXZlbnQsIGNhbiwgbWRiLlBMVUdJTiwgIm5hbWUsY29udGV4dCxjb21tYW5kLGFyZ3VtZW50IiwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQljYW4udXNlci5zaGFyZShjYW4sIGNhbi5yZXF1ZXN0KGV2ZW50KSwgW3JpdmVyLCBjdHguQUNUSU9OLCBjaGF0LlNIQVJFLCBtZGIuVFlQRSwgY2hhdC5GSUVMRCwKCQkJCW1kYi5OQU1FLCBpdGVtWzJdLCBtZGIuVEVYVCwgaXRlbVszXSwgY2hhdC5USVRMRSwgaXRlbVswXSwgY2hhdC5SSVZFUiwgcml2ZXIsIGNoYXQuU1RPUk0sIHN0b3JtLAoJCQldKQoJCX0pCgl9LAoKCSLmt7vliqDorr7lpIciOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyKSB7CgkJY2FuLnVzZXIuc2VsZWN0KGV2ZW50LCBjYW4sIHdlYi5TUEFDRSwgInR5cGUsbmFtZSx0ZXh0IiwgZnVuY3Rpb24oaXRlbSwgbmV4dCkgewoJCQljYW4ucnVuKHt9LCBbcml2ZXIsIGNoYXQuTk9ERSwgY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgbWRiLlRZUEUsIGl0ZW1bMF0sIG1kYi5OQU1FLCBpdGVtWzFdXSwgZnVuY3Rpb24obXNnKSB7CgkJCQluZXh0KCkKCQkJfSkKCQl9KQoJfSwKCSLkuIvovb3lupTnlKgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgewoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBhYWEuSU5WSVRFXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0KGNhbiwgewoJCQkJdGl0bGU6ICLkuIvovb3lupTnlKgiLCBkdXJhdGlvbjogLTEsIHdpZHRoOiAtMzAwLAoJCQkJY29udGVudDogbXNnLlJlc3VsdCgpLCBhY3Rpb246IFtjbGkuQ0xPU0VdLAoJCQl9KQoJCX0pCgl9LAoJIuWIm+W7uuepuumXtCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7IGNhbi5yZXF1ZXN0KGV2ZW50LCB7YWN0aW9uOiBidXR0b259KQoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFt7bmFtZTogIm5hbWUiLCB2YWx1ZTogImhpIn0sIHtuYW1lOiAicmVwb3MifSwge25hbWU6ICJ0ZW1wbGF0ZSJ9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSwgbGlzdCwgYXJncykgewoJCQljYW4ucmVxdWVzdChldmVudCwge190b2FzdDogIuWIm+W7uuS4rS4uLiJ9KQoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY2xpLlNUQVJUXS5jb25jYXQoYXJncywgY2hhdC5SSVZFUiwgcml2ZXIpLCBmdW5jdGlvbihtc2cpIHsKCQkJCXZhciBsaW5rID0gY2FuLm1pc2MuTWVyZ2VVUkwoY2FuLCB7X3BhdGg6ICIvY2hhdC9wb2QvIitjYW4uY29yZS5LZXlzKGNhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpLCBtc2cuT3B0aW9uKG1kYi5OQU1FKSl9KQoJCQkJY2FuLnVzZXIudG9hc3QoY2FuLCBsaW5rKSwgY2FuLnVzZXIub3BlbihsaW5rKQoJCQl9KQoJCX0pCgl9LAoJIuiuv+mXruepuumXtCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnVzZXIuc2VsZWN0KHtyaXZlcjogcml2ZXJ9LCBjYW4sIHdlYi5TUEFDRSwgInRpbWUsdHlwZSxuYW1lLHRleHQiKQoJfSwKCgoJIua3u+WKoOeUqOaItyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsKCQljYW4udXNlci5zZWxlY3QoZXZlbnQsIGNhbiwgY2hhdC5VU0VSLCAidXNlcm5pY2ssdXNlcm5hbWUiLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7CgkJCWNhbi5ydW4oe30sIFtyaXZlciwgY2hhdC5VU0VSLCBjdHguQUNUSU9OLCBtZGIuSU5TRVJULCBhYWEuVVNFUk5BTUUsIGl0ZW1bMF1dLCBmdW5jdGlvbihtc2cpIHsKCQkJCW5leHQoKQoJCQl9KQoJCX0pCgl9LAoJIumHjeWRveWQjee+pOe7hCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbWRiLk5BTUVdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBtZXRhLCBsaXN0KSB7CgkJCWNhbi5ydW4oY2FuLnJlcXVlc3QoZXZlbnQsIHtoYXNoOiByaXZlcn0pLl9ldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5NT0RJRlksIG1kYi5OQU1FLCBtZXRhLm5hbWVdLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5taXNjLlNlYXJjaChjYW4sIHtyaXZlcjogcml2ZXJ9KQoJCQl9KQoJCX0pCgl9LAoJIuWIoOmZpOe+pOe7hCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIpIHsKCQljYW4ucnVuKGNhbi5yZXF1ZXN0KGV2ZW50LCB7aGFzaDogcml2ZXJ9KS5fZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuUkVNT1ZFXSwgZnVuY3Rpb24obXNnKSB7IGNhbi5taXNjLlNlYXJjaChjYW4sIHt9KSB9KQoJfSwKCgki5L+d5a2Y5Y+C5pWwIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlciwgc3Rvcm0pIHsKCQljYW4uZ2V0QWN0aW9uKGN0eC5BUkdTLCBmdW5jdGlvbihpdGVtLCBuZXh0LCBpbmRleCwgYXJyYXkpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KHt9LCB7aGFzaDogc3Rvcm0sIGlkOiBpdGVtLmRhdGFzZXQuaWR9KQoJCQl2YXIgdG9hc3QgPSBjYW4udXNlci50b2FzdChjYW4sIChpbmRleCsxKStpY2UuUFMrYXJyYXkubGVuZ3RoLCBidXR0b24sIDEwMDAwLCAoaW5kZXgrMSkqMTAwL2FycmF5Lmxlbmd0aCkKCQkJY2FuLnJ1bihtc2cuX2V2ZW50LCBbcml2ZXIsIGNoYXQuU1RPUk0sIGN0eC5BQ1RJT04sIG1kYi5NT0RJRlksIGljZS5BUkcsIGl0ZW0uZGF0YXNldC5hcmdzXSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4uY29yZS5UaW1lcigyMDAsIGZ1bmN0aW9uKCkgewoJCQkJCXRvYXN0LmNsb3NlKCksIG5leHQoKSwgaW5kZXggPT0gYXJyYXkubGVuZ3RoLTEgJiYgY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbiwgYnV0dG9uKQoJCQkJfSkKCQkJfSkKCQl9KQoJfSwKCSLph43lkb3lkI3lupTnlKgiOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIHJpdmVyLCBzdG9ybSkgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFttZGIuTkFNRV0sIGZ1bmN0aW9uKGV2LCBidXR0b24sIG1ldGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLnJ1bihjYW4ucmVxdWVzdChldmVudCwge2hhc2g6IHN0b3JtfSkuX2V2ZW50LCBbcml2ZXIsIGNoYXQuU1RPUk0sIGN0eC5BQ1RJT04sIG1kYi5NT0RJRlldLmNvbmNhdChhcmdzKSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4ubWlzYy5TZWFyY2goY2FuLCB7cml2ZXI6IHJpdmVyLCBzdG9ybTogc3Rvcm19KQoJCQl9KQoJCX0pCgl9LAoJIuWIoOmZpOW6lOeUqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbiwgcml2ZXIsIHN0b3JtKSB7CgkJY2FuLnJ1bihjYW4ucmVxdWVzdChldmVudCwge2hhc2g6IHN0b3JtfSkuX2V2ZW50LCBbcml2ZXIsIGNoYXQuU1RPUk0sIGN0eC5BQ1RJT04sIG1kYi5SRU1PVkVdLCBmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm1pc2MuU2VhcmNoKGNhbiwge3JpdmVyOiByaXZlcn0pCgkJfSkKCX0sCgoKCWNyZWF0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uLCByaXZlcikgewoJCWNhbi51c2VyLnRyYW5zKGNhbiwgeyJwdWJsaWMiOiAi5YWs5byA5bqU55SoIiwgInByb3RlY3RlZCI6ICLnvqTnu4TlupTnlKgiLCAicHJpdmF0ZSI6ICLkuKrkurrlupTnlKgifSkKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbCgkJCXtuYW1lOiBtZGIuVFlQRSwgdmFsdWVzOiBbY2hhdC5QVUJMSUMsIGNoYXQuUFJPVEVDVEVELCBjaGF0LlBSSVZBVEVdLCBfdHJhbnM6ICLnsbvlnosifSwKCQkJe25hbWU6IG1kYi5OQU1FLCB2YWx1ZTogImhpIiwgX3RyYW5zOiAi5ZCN56ewIn0sIHtuYW1lOiBtZGIuVEVYVCwgdmFsdWU6ICJoZWxsbyIsIF90cmFuczogIueugOS7iyJ9LAoJCV0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIG1ldGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLnJ1bih7fSwgW3JpdmVyLCBjaGF0LlNUT1JNLCBjdHguQUNUSU9OLCBtZGIuQ1JFQVRFXS5jb25jYXQoYXJncyksIGZ1bmN0aW9uKG1zZykgewoJCQkJY2FuLm1pc2MuU2VhcmNoKGNhbiwge3JpdmVyOiByaXZlciwgc3Rvcm06IG1zZy5SZXN1bHQoKX0pCgkJCX0pCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW10sCgl3aWR0aDogZnVuY3Rpb24oY2FuKSB7IHJldHVybiBjYW4uX3RhcmdldC5vZmZzZXRXaWR0aCB9LAoJc3Rvcm06IGZ1bmN0aW9uKGNhbiwgbXNnLCB3b3JkKSB7CgkJdmFyIGZpZWxkcyA9IChtc2cuT3B0aW9uKGljZS5NU0dfRklFTERTKXx8ImN0eCxjbWQsdHlwZSxuYW1lLHRleHQiKS5zcGxpdCgiLCIpCgkJY2FuLmNvcmUuSXRlbShjYW4uX3Jvb3Qucml2ZXIsIGZ1bmN0aW9uKHJpdmVyLCB2YWx1ZSkgewoJCQljYW4uY29yZS5JdGVtKHZhbHVlLnN0b3JtLCBmdW5jdGlvbihzdG9ybSwgaXRlbSkgewoJCQkJaWYgKHdvcmRbMV0gIT0gIiIgJiYgd29yZFsxXSAhPSBzdG9ybSAmJiB3b3JkWzFdICE9IGl0ZW0ubmFtZSkgeyByZXR1cm4gfQoKCQkJCXZhciBkYXRhID0ge2N0eDogIndlYi5jaGF0IiwgY21kOiBjaGF0LlNUT1JNLAoJCQkJCXR5cGU6IHJpdmVyLCBuYW1lOiBzdG9ybSwgdGV4dDogc2h5KCLot7PovawiLCBmdW5jdGlvbihldmVudCkgewoJCQkJCQljYW4ub25hY3Rpb24uYWN0aW9uKGV2ZW50LCBjYW4sIHJpdmVyLCBzdG9ybSkKCQkJCQl9KSwKCQkJCX07IGNhbi5jb3JlLkxpc3QoZmllbGRzLCBmdW5jdGlvbihrZXkpIHsgbXNnLlB1c2goa2V5LCBkYXRhW2tleV18fCIiKSB9KQoJCQl9KQoJCX0pCgl9LAp9KQoK",
        "/panel/search.css": "ZmllbGRzZXQuU2VhcmNoIHsgYmFja2dyb3VuZDojMDQxYTI1YmQ7IHBhZGRpbmc6MTBweDsgcG9zaXRpb246Zml4ZWQ7IGxlZnQ6MHB4OyB0b3A6MjZweDsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LlNlYXJjaCBpbnB1dC53b3JkIHsgd2lkdGg6LXdlYmtpdC1maWxsLWF2YWlsYWJsZTsgfQpmaWVsZHNldC5TZWFyY2ggZGl2Lm91dHB1dCBkaXYuY29udGVudCB0YWJsZSB7IG1pbi13aWR0aDo0MDBweDsgfQpmaWVsZHNldC5TZWFyY2ggZGl2Lm91dHB1dCBkaXYuZGlzcGxheSB7IG1heC1oZWlnaHQ6MjAwcHg7IH0KZmllbGRzZXQuU2VhcmNoIGRpdi5vdXRwdXQgYSB7IGNvbG9yOnllbGxvdzsgfQo=",
        "/panel/search.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLmxpc3QgPSBtc2cuVGFibGUoKSwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmNvbnRlbnQpCgkJdmFyIHRhYmxlID0gY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSwgYXJyYXkpIHsgY2FuLlN0YXR1cyhtZGIuVE9UQUwsIGluZGV4KzEpCgkJCXJldHVybiB7dGV4dDogW2tleSA9PSBtZGIuVEVYVCAmJiBjYW4uYmFzZS5pc0Z1bmMobGluZS50ZXh0KSAmJiBsaW5lLnRleHQuaGVscCB8fCB2YWx1ZSwgaHRtbC5URF0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25hY3Rpb25bY2FuLnR5cGUgPT0gIioifHxldmVudC5jdHJsS2V5PyBjaGF0LlBMVUdJTjogbWRiLlNFTEVDVF0oZXZlbnQsIGNhbiwgaW5kZXgpIAoJCQl9fQoJCX0sIGNhbi51aS5jb250ZW50LCBjYW4uY29yZS5MaXN0KChtc2cuT3B0aW9uKCJzb3J0Iil8fCJjdHgsY21kLHR5cGUsbmFtZSx0ZXh0Iikuc3BsaXQoaWNlLkZTKSwgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gbGlzdC5pbmRleE9mKGl0ZW0pCgkJfSkpOyB0YWJsZSAmJiBjYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkuZGlzcGxheSwge3N0eWxlOiB7d2lkdGg6IHRhYmxlLm9mZnNldFdpZHRofX0pCgkJY2FuLm9ubW90aW9uLnN0b3J5LmF1dG8oY2FuKQoKCQljYW4ub25hcHBlbmQuX3N0YXR1cyhjYW4sIGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKCJfc3RhdHVzIiksIFtdKS5jb25jYXQoe25hbWU6ICJzZWxlY3RlZCIsIHZhbHVlOiAiMCJ9KSkKCQljYW4uZ2V0QWN0aW9uU2l6ZShmdW5jdGlvbihtc2csIGhlaWdodCkgewoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkucHJvZmlsZSwga2l0LkRpY3QoaHRtbC5NQVhfSEVJR0hULCBjYW4uYmFzZS5NaW4oaGVpZ2h0LSh0YWJsZSYmdGFibGUub2Zmc2V0SGVpZ2h0fHwwKSwgaGVpZ2h0LzIpKSkKCQl9KQoJCW1zZy5MZW5ndGgoKSA9PSAxICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRhYmxlLCBodG1sLlREKVswXS5jbGljaygpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJBIiwgZnVuY3Rpb24oaXRlbSkgewoJCQlpdGVtLm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgeyBjYW4udXNlci5vcGVuKGl0ZW0uaHJlZiksIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KSB9CgkJfSkKCX0sCglfd29yZDogZnVuY3Rpb24oY2FuLCBtc2csIGNtZHMsIGZpZWxkcykgeyBjYW4udHlwZSA9IGNtZHNbMF0KCQl2YXIgY2IgPSBjYW4ub25hY3Rpb25bY21kc1sxXV07IGlmIChjYikgeyBjYih7fSwgY2FuKTsgcmV0dXJuIH0KCgkJdmFyIHJlcyA9IGNhbi5yZXF1ZXN0KHt9LCB7CgkJCXdvcmQ6IGNtZHMsIGZpZWxkczogZmllbGRzLmpvaW4oaWNlLkZTKSwgc29ydDogbXNnLk9wdGlvbigic29ydCIpLAoJCQlyaXZlcjogbXNnLk9wdGlvbihjaGF0LlJJVkVSKSwgaW5kZXg6IG1zZy5PcHRpb24oImluZGV4IiksCgkJfSkKCgkJY2FuLm9uZW5naW5lLnNpZ25hbChjYW4sIGNoYXQuT05TRUFSQ0gsIHJlcykKCQljYW4ucnVuKHJlcy5fZXZlbnQsIGNtZHMsIGZ1bmN0aW9uKHJlcykgeyBjYW4ub25pbXBvcnQuX2luaXQoY2FuLCByZXMsIGZpZWxkcykgfSkKCQljYW4ub25tb3Rpb24uc2hvdyhjYW4pLCBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBjYW4udWkud29yZCkKCX0sCgoJc2VsZWN0OiBmdW5jdGlvbihjYW4sIG1zZywgY21kcywgY2IpIHsgY2FuLnVpLndvcmQudmFsdWUgPSBjbWRzWzFdCgkJdmFyIGZpZWxkcyA9IChjbWRzWzJdfHxtc2cuT3B0aW9uKGljZS5NU0dfRklFTERTKXx8ImN0eCxjbWQsdHlwZSxuYW1lLHRleHQiKS5zcGxpdChpY2UuRlMpCgkJY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIGNhbi51aS5kaXNwbGF5LCBbe3RoOiBmaWVsZHN9XSksIGNhbi5jYiA9IGZ1bmN0aW9uKCkgewoJCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKGNhbi5vbmV4cG9ydC5zZWxlY3QoY2FuKSksIGNhbi5vbm1vdGlvbi5oaWRlKGNhbikKCQl9CgoJCWNhbi5pbnB1dCA9IGZ1bmN0aW9uKGV2ZW50LCB3b3JkKSB7IGNtZHNbMV0gPSB3b3JkfHxjbWRzWzFdCgkJCWNhbi5vbmltcG9ydC5fd29yZChjYW4sIG1zZywgY21kcywgZmllbGRzKQoJCX0sIGNhbi5vbmltcG9ydC5fd29yZChjYW4sIG1zZywgY21kcywgZmllbGRzKQoKCQljYW4uZ2V0QWN0aW9uU2l6ZShmdW5jdGlvbihtc2csIHRvcCwgbGVmdCwgd2lkdGgsIGhlaWdodCkgewoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4uX3RhcmdldCwge3N0eWxlOiB7dG9wOiB0b3AsIGxlZnQ6IGxlZnR9fSkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLl9vdXRwdXQsIHtzdHlsZToga2l0LkRpY3QoaHRtbC5NQVhfSEVJR0hULCBoZWlnaHQtNzEsIGh0bWwuTUFYX1dJRFRILCB3aWR0aC0yKmh0bWwuUExVR0lOX01BUkdJTil9KQoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkuY29udGVudCwge3N0eWxlOiBraXQuRGljdChodG1sLk1BWF9XSURUSCwgd2lkdGgtMipodG1sLlBMVUdJTl9NQVJHSU4pfSkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmRpc3BsYXksIHtzdHlsZToga2l0LkRpY3QoaHRtbC5NQVhfV0lEVEgsIHdpZHRoLTIqaHRtbC5QTFVHSU5fTUFSR0lOKX0pCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5Lqk5LqS5pON5L2cIiwgbGlzdDogW2NsaS5DTEVBUiwgY2xpLkNMT1NFLCBjbGkuRE9ORV0sIF9pbml0OiBmdW5jdGlvbihjYW4sIGNiLCB0YXJnZXQpIHsKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQpCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgl9LAoJb25sb2dpbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQljYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIGNhbi5Db25mKGh0bWwuQUNUSU9OKXx8Y2FuLm9uYWN0aW9uLmxpc3QpCgkJY2FuLnVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLl9vdXRwdXQsIFsKCQkJe2lucHV0OiBbIndvcmQiLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbikKCQkJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FU0NBUEUpIHsgY2FuLm9ubW90aW9uLmhpZGUoY2FuKSB9CgoJCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVOVEVSKSB7IGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQkJCWlmIChldmVudC5zaGlmdEtleSkgeyB2YXIgZmlyc3QgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUilbMV0KCQkJCQkJcmV0dXJuIGNhbi5vbmFjdGlvbltjYW4udHlwZSA9PSAiKiI/IGNoYXQuUExVR0lOOiBodG1sLlNFTEVDVF0oZXZlbnQsIGNhbiwgZmlyc3QuZGF0YXNldC5pbmRleCkKCQkJCQl9CgkJCQkJaWYgKGV2ZW50LmN0cmxLZXkpIHsgcmV0dXJuIGNhbi5vbmFjdGlvbltjbGkuRE9ORV0oZXZlbnQsIGNhbikgfQoJCQkJCWNhbi5pbnB1dChldmVudCwgZXZlbnQudGFyZ2V0LnZhbHVlKQoJCQkJfQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVFIsIGZ1bmN0aW9uKHRyLCBpbmRleCkgewoJCQkJCWlmIChpbmRleCA9PSAwKSB7IHJldHVybiB9CgkJCQkJdmFyIGhhcyA9IGZhbHNlOyBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQpIHsKCQkJCQkJaGFzID0gaGFzIHx8IHRkLmlubmVyVGV4dC5pbmRleE9mKGV2ZW50LnRhcmdldC52YWx1ZSkgPiAtMQoJCQkJCX0pCgkJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIHRyLCBodG1sLkhJRERFTiwgIWhhcykKCQkJCX0pCgkJCX1dfSwKCQkJe3ZpZXc6IGNoYXQuQ09OVEVOVH0sIHt2aWV3OiBodG1sLlNUQVRVU30sIHt2aWV3OiBbY2hhdC5ESVNQTEFZLCBodG1sLlRBQkxFXX0se3ZpZXc6IGNoYXQuUFJPRklMRX0sCgkJXSksIGNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBjYW4udWkuZGlzcGxheSwgY2hhdC5DT05URU5UKQoJfSwKCW9ub3BlbnNlYXJjaDogZnVuY3Rpb24oY2FuLCBtc2csIHR5cGUsIHdvcmQpIHsgY2FuLm9uaW1wb3J0LnNlbGVjdChjYW4sIG1zZywgW3R5cGV8fCIqIiwgd29yZHx8IiJdKSB9LAoKCWNsZWFyOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5wcm9maWxlKSB9LAoJZG9uZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYmFzZS5pc0Z1bmMoY2FuLmNiKSAmJiBjYW4uY2IoKSB9LAoJY2xvc2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLmhpZGUoY2FuKSB9LAoKCXNlbGVjdDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgaW5kZXgpIHsgdmFyIGxpbmUgPSBjYW4ubGlzdFtpbmRleF0KCQlpZiAoY2FuLmJhc2UuaXNGdW5jKGxpbmUudGV4dCkpIHsgcmV0dXJuIGNhbi5vbm1vdGlvbi5oaWRlKGNhbiksIGxpbmUudGV4dChldmVudCkgfQoKCQlpZiAobGluZS5jdHggPT0gIndlYi5jaGF0IiAmJiBsaW5lLmNtZCA9PSAiL3NlYXJjaCIpIHsKCQkJcmV0dXJuIGNhbi5vbmltcG9ydC5zZWxlY3QoY2FuLCBtc2csIFtsaW5lLnR5cGUsIGxpbmUubmFtZSwgbGluZS50ZXh0XSwgY2FuLmNiKQoJCX0KCgkJdmFyIGZpZWxkcyA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5kaXNwbGF5LCBodG1sLlRILCBmdW5jdGlvbihpdGVtKSB7IHJldHVybiBpdGVtLmlubmVyVGV4dCB9KQoJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5kaXNwbGF5LCBbe3RkOiBjYW4uY29yZS5MaXN0KGZpZWxkcywgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gbGluZVtpdGVtXQoJCX0pLCBkYXRhOiB7aW5kZXg6IGluZGV4fSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUpCgkJCWNhbi5TdGF0dXMoInNlbGVjdGVkIiwgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmRpc3BsYXksIGh0bWwuVFIpLmxlbmd0aC0xKQoJCX19XSksIGNhbi5TdGF0dXMoInNlbGVjdGVkIiwgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmRpc3BsYXksIGh0bWwuVFIpLmxlbmd0aC0xKQoJfSwKCglwbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGluZGV4KSB7IHZhciBsaW5lID0gY2FuLmxpc3RbaW5kZXhdCgkJaWYgKGV2ZW50LnRhcmdldC50YWdOYW1lID09ICJBIikgeyByZXR1cm4gfQoJCWlmIChsaW5lLmN0eCA9PSAid2ViLndpa2kiICYmIGxpbmUuY21kID09ICJ3b3JkIikgeyByZXR1cm4gfQoJCWlmIChjYW4uYmFzZS5pc0Z1bmMobGluZS50ZXh0KSkgeyByZXR1cm4gY2FuLm9ubW90aW9uLmhpZGUoY2FuKSwgbGluZS50ZXh0KGV2ZW50KSB9CgoJCXZhciBjbWQgPSBsaW5lLmNtZCA9PSBjdHguQ09NTUFORD8gY2FuLmNvcmUuS2V5cyhsaW5lLnR5cGUsIGxpbmUubmFtZS5zcGxpdChpY2UuU1ApWzBdKTogY2FuLmNvcmUuS2V5cyhsaW5lLmN0eCwgbGluZS5jbWQpCgkJY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHt0eXBlOiBjaGF0LlBMVUdJTiwgaW5kZXg6IGNtZHx8bXNnLk9wdGlvbihtZGIuSU5ERVgpfSwgZnVuY3Rpb24oc3ViLCBtZXRhKSB7CgkJCWNhbi5nZXRBY3Rpb25TaXplKGZ1bmN0aW9uKG1zZywgaGVpZ2h0LCB3aWR0aCkgeyBoZWlnaHQgPSBjYW4uYmFzZS5NaW4oaGVpZ2h0IC0gY2FuLnVpLmNvbnRlbnQub2Zmc2V0SGVpZ2h0KzIwNCwgaGVpZ2h0LzIpCgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBzdWIuX291dHB1dCwge3N0eWxlOiBraXQuRGljdChodG1sLk1BWF9IRUlHSFQsIGhlaWdodC0yNiwgaHRtbC5NQVhfV0lEVEgsIHdpZHRoLTQwKX0pCgkJCQlzdWIuQ29uZihodG1sLkhFSUdIVCwgaGVpZ2h0KzI4KSwgc3ViLkNvbmYoaHRtbC5XSURUSCwgd2lkdGgtNjApCgkJCX0pCgoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBtZXRhLmluZGV4XSwgY21kcyksIGNiLCB0cnVlKQoJCQl9CgkJCXN1Yi5Gb2N1cygpCgkJfSwgY2FuLnVpLnByb2ZpbGUpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJc2VsZWN0OiBmdW5jdGlvbihjYW4pIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmRpc3BsYXksIGh0bWwuVFIsIGZ1bmN0aW9uKHRyKSB7CgkJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQpIHsgcmV0dXJuIHRkLmlubmVySFRNTCB9KQoJCX0pLnNsaWNlKDEpCgl9LAp9KQoK",
        "/plugin/input.js": "Vm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgY2IsIHRhcmdldCkgewoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKTsgc3dpdGNoIChtZXRhLnR5cGUpIHsKCQkJY2FzZSBodG1sLlNFTEVDVDogbWV0YS52YWx1ZSAmJiAodGFyZ2V0LnZhbHVlID0gbWV0YS52YWx1ZSk7IGJyZWFrCgkJCWNhc2UgaHRtbC5CVVRUT046IG1ldGEuYWN0aW9uID09IGljZS5BVVRPICYmIHRhcmdldC5jbGljaygpOyBicmVhawoJCX0KCX0sCglydW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnJ1bihldmVudCkgfSwKCWxpc3Q6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5Db25mKCJtb2RlIikgIT0gInNpbXBsZSIgJiYgY2FuLnJ1bihldmVudCkgfSwKCWJhY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmltcG9ydC5fYmFjayhjYW4uc3VwKSB9LAoJcmVmcmVzaDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ucnVuKGV2ZW50KSB9LAoKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5yZXF1ZXN0KGV2ZW50LCB7X3RvYXN0OiAi5omn6KGM5LitLi4uIn0pCgkJY2FuLkNvbmYobWRiLlRZUEUpID09IGh0bWwuQlVUVE9OICYmIGNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjYW4uQ29uZihtZGIuTkFNRSldLmNvbmNhdChjYW4uc3VwLklucHV0KCkpKQoJfSwKCW9uY2hhbmdlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAucmVxdWVzdChldmVudCwge190b2FzdDogIuaJp+ihjOS4rS4uLiJ9KQoJCWlmIChjYW4uQ29uZihtZGIuVFlQRSkgPT0gaHRtbC5TRUxFQ1QpIHsgY2FuLnJ1bihldmVudCkgfQoJfSwKCW9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuaW5wdXQoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KQoJCWlmIChjYW4uQ29uZihtZGIuVFlQRSkgPT0gaHRtbC5URVhUQVJFQSkgeyBpZiAoIWV2ZW50LmN0cmxLZXkpIHsgcmV0dXJuIH0gfQoJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FTlRFUikgewoJCQljYW4ucnVuKGV2ZW50KSwgY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgZXZlbnQudGFyZ2V0KQoJCQljYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQl9IGlmICghZXZlbnQuY3RybEtleSkgeyByZXR1cm4gfQoKCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQljYXNlICJiIjogY2FuLkNsb25lSW5wdXQoKTsgYnJlYWsKCQkJY2FzZSAibSI6IGNhbi5DbG9uZUZpZWxkKCk7IGJyZWFrCgkJCWRlZmF1bHQ6IHJldHVybgoJCX0gY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgl9LAp9KQoK",
        "/plugin/input/date.css": "ZmllbGRzZXQuaW5wdXQuZGF0ZSBkaXYuYWN0aW9uIHsgaGVpZ2h0OjRyZW07IH0KZmllbGRzZXQuaW5wdXQuZGF0ZSBkaXYuYWN0aW9uIGRpdi5zcGFjZSB7IHdpZHRoOjA7IGNsZWFyOmJvdGg7IH0KZmllbGRzZXQuaW5wdXQuZGF0ZSBkaXYub3V0cHV0IHRkLnByZXYgeyBjb2xvcjpncmF5OyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgZGl2Lm91dHB1dCB0ZC5uZXh0IHsgY29sb3I6Z3JheTsgfQpmaWVsZHNldC5pbnB1dC5kYXRlIGRpdi5vdXRwdXQgdGQgeyBwYWRkaW5nOjJweCAxMXB4OyB9CmZpZWxkc2V0LmlucHV0LmRhdGUgdGFibGUgeyB0ZXh0LWFsaWduOmNlbnRlcjsgd2lkdGg6MjgwcHg7IH0KZmllbGRzZXQuaW5wdXQuZGF0ZSB0YWJsZSB0ZC5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IH0KZmllbGRzZXQuaW5wdXQuZGF0ZSB0YWJsZSB0ZDpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgfQpib2R5LndoaXRlIGZpZWxkc2V0LmlucHV0LmRhdGUgdGFibGUgeyBjb2xvcjp3aGl0ZTsgfQoK",
        "/plugin/input/date.js": "Vm9sY2Fub3MoIm9uZmlndXJlIiwge2hlbHA6ICLmjqfku7bor6bmg4UiLCBsaXN0OiBbXSwgZGF0ZToge29uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgY2IoZnVuY3Rpb24oY2FuLCBjYnMpIHsKCWZ1bmN0aW9uIHNldChub3cpIHsgdGFyZ2V0LnZhbHVlID0gY2FuLnVzZXIudGltZShjYW4sIG5vdyksIGNhbi5jbG9zZSgpLCBtZXRhICYmIG1ldGEuYWN0aW9uID09IGljZS5BVVRPICYmIGNhbi5ydW4oe30pIH0KCgkvLyDmt7vliqDmjqfku7YKCXZhciBub3cgPSB0YXJnZXQudmFsdWU/IG5ldyBEYXRlKHRhcmdldC52YWx1ZSk6IG5ldyBEYXRlKCkKCWNhbi5fdHJhbnMgPSB7InRvZGF5IjogIuS7iuWkqSIsICJuZXh0IjogIuS4i+S4gOaciCIsICJwcmV2IjogIuS4iuS4gOaciCJ9CgljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uX2FjdGlvbiksIGNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgW2NsaS5DTE9TRSwKCQlbImhvdXIiXS5jb25jYXQoY2FuLmNvcmUuTGlzdCgyNCkpLCBbIm1pbnV0ZSJdLmNvbmNhdChjYW4uY29yZS5MaXN0KDAsIDYwLCA1KSksIFsic2Vjb25kIl0uY29uY2F0KGNhbi5jb3JlLkxpc3QoMCwgNjAsIDUpKSwKCQkidG9kYXkiLCAiIiwgInByZXYiLCBbInllYXIiXS5jb25jYXQoY2FuLmNvcmUuTGlzdChub3cuZ2V0RnVsbFllYXIoKSAtIDEwLCBub3cuZ2V0RnVsbFllYXIoKSArIDEwKSksCgkJWyJtb250aCJdLmNvbmNhdChjYW4uY29yZS5MaXN0KDEsIDEzKSksICJuZXh0IiwKCV0sIGNhbi5fYWN0aW9uLCB7IGNsb3NlOiBmdW5jdGlvbihldmVudCkgeyBjYW4uY2xvc2UoKSB9LAoJCSJob3VyIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyAgbm93LnNldEhvdXJzKHBhcnNlSW50KHZhbHVlKXx8MCksIHNob3cobm93KSB9LAoJCSJtaW51dGUiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0TWludXRlcyhwYXJzZUludCh2YWx1ZSl8fDApLCBzaG93KG5vdykgfSwKCQkic2Vjb25kIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyAgbm93LnNldFNlY29uZHMocGFyc2VJbnQodmFsdWUpfHwwKSwgc2hvdyhub3cpIH0sCgkJInRvZGF5IjogZnVuY3Rpb24oZXZlbnQpIHsgIG5vdyA9IG5ldyBEYXRlKCksIHNldChzaG93KG5vdykpIH0sCgoJCSJwcmV2IjogZnVuY3Rpb24oZXZlbnQpIHsgIG5vdy5zZXRNb250aChub3cuZ2V0TW9udGgoKS0xKSwgc2hvdyhub3cpIH0sCgkJInllYXIiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7ICBub3cuc2V0RnVsbFllYXIocGFyc2VJbnQodmFsdWUpKSwgc2hvdyhub3cpIH0sCgkJIm1vbnRoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyAgbm93LnNldE1vbnRoKHBhcnNlSW50KHZhbHVlKS0xKSwgc2hvdyhub3cpIH0sCgkJIm5leHQiOiBmdW5jdGlvbihldmVudCkgeyAgbm93LnNldE1vbnRoKG5vdy5nZXRNb250aCgpKzEpLCBzaG93KG5vdykgfSwKCgkJIumaj+acuiI6IGZ1bmN0aW9uKGV2ZW50KSB7ICBub3cuc2V0RGF0ZSgoTWF0aC5yYW5kb20oKSAqIDEwMCAtIDUwKSArIG5vdy5nZXREYXRlKCkpLCBzaG93KG5vdykgfSwKCQki5YmN5LiA5bm0IjogZnVuY3Rpb24oZXZlbnQpIHsgIG5vdy5zZXRGdWxsWWVhcihub3cuZ2V0RnVsbFllYXIoKS0xKSwgc2hvdyhub3cpIH0sCgkJIuWQjuS4gOW5tCI6IGZ1bmN0aW9uKGV2ZW50KSB7ICBub3cuc2V0RnVsbFllYXIobm93LmdldEZ1bGxZZWFyKCkrMSksIHNob3cobm93KSB9LAoJfSkKCgljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uX3N0YXR1cykKCWNhbi5fdGFibGUgPSBjYW4ucGFnZS5BcHBlbmRzKGNhbiwgY2FuLl9vdXRwdXQsIFt7dmlldzogW2NoYXQuQ09OVEVOVCwgaHRtbC5UQUJMRV19XSkuZmlyc3QKCXZhciB0b2RheSA9IG5ldyBEYXRlKCk7IGZ1bmN0aW9uIHNob3cobm93KSB7CgkJLy8g6K6+572u5o6n5Lu2CgkJY2FuLkFjdGlvbigieWVhciIsIG5vdy5nZXRGdWxsWWVhcigpKQoJCWNhbi5BY3Rpb24oIm1vbnRoIiwgbm93LmdldE1vbnRoKCkrMSkKCQljYW4uQWN0aW9uKCJob3VyIiwgbm93LmdldEhvdXJzKCkpCgkJY2FuLkFjdGlvbigibWludXRlIiwgcGFyc2VJbnQobm93LmdldE1pbnV0ZXMoKS81KSo1KQoJCWNhbi5BY3Rpb24oInNlY29uZCIsIHBhcnNlSW50KG5vdy5nZXRTZWNvbmRzKCkvNSkqNSkKCgkJLy8g6K6+572u57uE5Lu2CgkJY2FuLnBhZ2UuQXBwZW5kcyhjYW4sIGNhbi5fdGFibGUsIFt7dGg6IFsi5pelIiwgIuS4gCIsICLkuowiLCAi5LiJIiwgIuWbmyIsICLkupQiLCAi5YWtIl19XSkKCQl2YXIgdHI7IGZ1bmN0aW9uIGFkZChkYXksIHR5cGUpIHsgaWYgKGRheS5nZXREYXkoKSA9PSAwKSB7IHRyID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLl90YWJsZSwgW3t0eXBlOiBodG1sLlRSfV0pLmxhc3QgfQoJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0ciwgW3t0ZXh0OiBbZGF5LmdldERhdGUoKSwgaHRtbC5URCwgY2FuLmJhc2UuVGltZSh0b2RheSwgIiV5LSVtLSVkIikgPT0gY2FuLmJhc2UuVGltZShkYXksICIleS0lbS0lZCIpPyBodG1sLlNFTEVDVDogdHlwZV0sCgkJCQlkYXRhc2V0OiB7ZGF0ZTogZGF5LmdldFRpbWUoKX0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJc2V0KG5vdyA9IG5ldyBEYXRlKHBhcnNlSW50KGV2ZW50LnRhcmdldC5kYXRhc2V0LmRhdGUpKSkKCQkJCX0sCgkJCX1dKQoJCX0KCgkJLy8g5pe26Ze05Yy66Ze0CgkJdmFyIG9uZSA9IG5ldyBEYXRlKG5vdyk7IG9uZS5zZXREYXRlKDEpCgkJdmFyIGVuZCA9IG5ldyBEYXRlKG5vdyk7IGVuZC5zZXRNb250aChub3cuZ2V0TW9udGgoKSsxKSwgZW5kLnNldERhdGUoMSkKCQl2YXIgaGVhZCA9IG5ldyBEYXRlKG9uZSk7IGhlYWQuc2V0RGF0ZShvbmUuZ2V0RGF0ZSgpLW9uZS5nZXREYXkoKSkKCQl2YXIgdGFpbCA9IG5ldyBEYXRlKGVuZCk7IHRhaWwuc2V0RGF0ZShlbmQuZ2V0RGF0ZSgpKzctZW5kLmdldERheSgpKQoKCQkvLyDml7bpl7Tluo/liJcKCQlmb3IgKHZhciBkYXkgPSBuZXcgRGF0ZShoZWFkKTsgZGF5IDwgb25lOyBkYXkuc2V0RGF0ZShkYXkuZ2V0RGF0ZSgpKzEpKSB7IGFkZChkYXksIG1kYi5QUkVWKSB9CgkJZm9yICh2YXIgZGF5ID0gbmV3IERhdGUob25lKTsgZGF5IDwgZW5kOyBkYXkuc2V0RGF0ZShkYXkuZ2V0RGF0ZSgpKzEpKSB7IGFkZChkYXksIG1kYi5NQUlOKSB9CgkJZm9yICh2YXIgZGF5ID0gbmV3IERhdGUoZW5kKTsgZW5kLmdldERheSgpICE9IDAgJiYgZGF5IDwgdGFpbDsgZGF5LnNldERhdGUoZGF5LmdldERhdGUoKSsxKSkgeyBhZGQoZGF5LCBtZGIuTkVYVCkgfQoKCQlyZXR1cm4gbm93Cgl9IHNob3cobm93KSwgY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuKSwgY2FuLmJhc2UuaXNGdW5jKGNicykgJiYgY2JzKGNhbikKfSl9fSB9LCBbIiJdKQoK",
        "/plugin/input/key.js": "Vm9sY2Fub3MoIm9uZmlndXJlIiwge2hlbHA6ICLmjqfku7bor6bmg4UiLCBsaXN0OiBbXSwga2V5OiB7CglfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCkgeyB2YXIgY2FsbCA9IGFyZ3VtZW50cy5jYWxsZWU7IHRhcmdldC5fbXNnID0gbXNnCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgZnVuY3Rpb24odmFsdWUsIGtleSwgaW5kZXgsIGxpbmUpIHsKCQkJcmV0dXJuIHt0ZXh0OiBbdmFsdWUsIGh0bWwuVERdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyB0YXJnZXQudmFsdWUgPSBsaW5lW2tleV0KCQkJCWlmIChtc2cuT3B0aW9uKGljZS5NU0dfUFJPQ0VTUykgIT0gaWNlLlBST0NFU1NfQUdBSU4pIHsgcmV0dXJuIGNhbi5jbG9zZSgpIH0KCQkJCXRhcmdldC5faG9sZCA9IHRydWUKCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuSU5QVVRTLCBjYW4uQ29uZihtZGIuTkFNRSksIHRhcmdldC52YWx1ZV0sIGZ1bmN0aW9uKG1zZykgeyBjYWxsKGNhbiwgbXNnLCB0YXJnZXQpIH0pCgkJCX19CgkJfSksIGNhbi5TdGF0dXMobWRiLlRPVEFMLCBtc2cuTGVuZ3RoKCkpLCBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl90YXJnZXQsIG1zZy5MZW5ndGgoKSA+IDApCgl9LAoJX3Nob3c6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG5hbWUsIGNicywgdGFyZ2V0LCB2YWx1ZSkgewoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuSU5QVVRTLCBuYW1lLCB2YWx1ZXx8dGFyZ2V0LnZhbHVlXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5vbmZpZ3VyZS5rZXkuX2luaXQoY2FuLCBtc2csIHRhcmdldCksIGNhbi5iYXNlLmlzRnVuYyhjYnMpICYmIGNicyhjYW4sIG1zZy5MZW5ndGgoKSA9PSAwKQoJCX0pCgl9LAoJLy8gb25mb2N1czogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbWV0YSwgY2IsIHRhcmdldCkgeyBpZiAodGFyZ2V0Ll9maWd1cmUpIHsgcmV0dXJuIH0gdGFyZ2V0Ll9maWd1cmUgPSB7fTsgY2IoZnVuY3Rpb24oY2FuLCBjYnMpIHsKCS8vIAl0YXJnZXQuX2ZpZ3VyZSA9IGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiwgY2FuLl90YXJnZXQsIGZhbHNlLCB7dG9wOiBjYW4ucGFnZS5vZmZzZXRUb3AodGFyZ2V0KSt0YXJnZXQub2Zmc2V0SGVpZ2h0LCBsZWZ0OiBjYW4ucGFnZS5vZmZzZXRMZWZ0KHRhcmdldCl9KQoJLy8gCWNhbi5vbmZpZ3VyZS5rZXkuX3Nob3coZXZlbnQsIGNhbiwgbWV0YS5uYW1lLCBjYnMsIHRhcmdldCksIGNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIHRhcmdldCkKCS8vIH0pIH0sCglvbmJsdXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsKCQl0YXJnZXQuX2hvbGQgfHwgY2FuLm9ubW90aW9uLmRlbGF5KGNhbiwgZnVuY3Rpb24oKSB7IGRlbGV0ZSh0YXJnZXQuX2ZpZ3VyZSksIHRhcmdldC5fY2FuICYmIHRhcmdldC5fY2FuLmNsb3NlKCkgfSkKCQl0YXJnZXQuX2hvbGQgPSBmYWxzZQoJfSwKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQpIHsgaWYgKHRhcmdldC5fZmlndXJlKSB7IHRhcmdldC5fZmlndXJlID0gY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuLCBjYW4uY29yZS5WYWx1ZSh0YXJnZXQsICJfY2FuLl90YXJnZXQiKXx8e30pOyByZXR1cm4gfSB0YXJnZXQuX2ZpZ3VyZSA9IHt9OyBjYihmdW5jdGlvbihjYW4sIGNicykgewoJCXRhcmdldC5fZmlndXJlID0gY2FuLm9ubGF5b3V0LmZpZ3VyZShldmVudCwgY2FuKQoJCWNhbi5vbmZpZ3VyZS5rZXkuX3Nob3coZXZlbnQsIGNhbiwgbWV0YS5uYW1lLCBjYnMsIHRhcmdldCksIGNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIHRhcmdldCkKCX0pIH0sCglvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIG1ldGEsIGNiLCB0YXJnZXQsIGxhc3QpIHsgdmFyIHN1YiA9IHRhcmdldC5fY2FuCgkJc3dpdGNoIChldmVudC5rZXkpIHsKCQkJY2FzZSBsYW5nLlNISUZUOiBicmVhawoJCQljYXNlIGxhbmcuQ09OVFJPTDogYnJlYWsKCQkJY2FzZSBsYW5nLkVOVEVSOgoJCQkJaWYgKGV2ZW50LmN0cmxLZXkgJiYgY2FuLnBhZ2UudGFnaXMoaHRtbC5URVhUQVJFQSwgdGFyZ2V0KSkgewoJCQkJCWNhbi5iYXNlLmlzRnVuYyhsYXN0KSAmJiBsYXN0KGV2ZW50LCBjYW4pCgkJCQl9CgkJCQlzdWIgJiYgc3ViLmNsb3NlKCk7IGJyZWFrCgkJCWNhc2UgbGFuZy5FU0NBUEU6IGV2ZW50LnRhcmdldC5ibHVyKCk7IGJyZWFrCgkJCWNhc2UgbGFuZy5QUzogY2FuLm9uZmlndXJlLmtleS5fc2hvdyhldmVudCwgc3ViLCBtZXRhLm5hbWUsIG51bGwsIHRhcmdldCwgdGFyZ2V0LnZhbHVlK2ljZS5QUyk7IGJyZWFrCgkJCWNhc2UgbGFuZy5UQUI6IAoJCQkJaWYgKGNhbi5wYWdlLnRhZ2lzKGh0bWwuVEVYVEFSRUEsIHRhcmdldCkpIHsKCQkJCQljYW4ub25rZXltYXAuaW5zZXJ0VGV4dChldmVudC50YXJnZXQsICJcdCIpLCBjYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQkJCQlicmVhawoJCQkJfQoJCQlkZWZhdWx0OgoJCQkJc3ViICYmIGNhbi5vbm1vdGlvbi5zZWxlY3RUYWJsZUlucHV0KGV2ZW50LCBzdWIsIHRhcmdldCwgZnVuY3Rpb24oKSB7CgkJCQkJY2FuLm9uZmlndXJlLmtleS5fc2hvdyhldmVudCwgc3ViLCBtZXRhLm5hbWUsIG51bGwsIHRhcmdldCkKCQkJCX0pLCBjYW4uYmFzZS5pc0Z1bmMobGFzdCkgJiYgbGFzdChldmVudCwgY2FuKQoJCX0KCX0sCn19KQoK",
        "/plugin/input/province.js": "Vm9sY2Fub3MoIm9uZmlndXJlIiwge2hlbHA6ICLmjqfku7bor6bmg4UiLCBsaXN0OiBbXSwgcHJvdmluY2U6IHtvbmNsaWNrOiBmdW5jdGlvbihldmVudCwgY2FuLCBtZXRhLCBjYiwgdGFyZ2V0KSB7IGNiKGZ1bmN0aW9uKGNhbiwgY2JzKSB7CgljYW4ucmVxdWlyZShbIi9yZXF1aXJlL3NoeWxpbnV4LmNvbS94L2VjaGFydHMvZWNoYXJ0cy5qcyIsICIvcmVxdWlyZS9zaHlsaW51eC5jb20veC9lY2hhcnRzL2NoaW5hLmpzIl0sIGZ1bmN0aW9uKCkgewoJCXZhciBjaGluYV9jaGFydCA9IGVjaGFydHMuaW5pdChjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX291dHB1dCwgW3t0eXBlOiBodG1sLkRJViwgc3R5bGU6IHt3aWR0aDogNjAwLCBoZWlnaHQ6IDQwMH19XSkuZmlyc3QpCgkJY2hpbmFfY2hhcnQuc2V0T3B0aW9uKHtnZW86IHttYXA6ICdjaGluYSd9fSksIGNoaW5hX2NoYXJ0Lm9uKGh0bWwuQ0xJQ0ssIGZ1bmN0aW9uIChwYXJhbXMpIHsKCQkJdGFyZ2V0LnZhbHVlID0gcGFyYW1zLm5hbWUsIGNhbi5jbG9zZSgpCgkJfSksIGNhbi5TdGF0dXMobWRiLlRPVEFMLCAzNCksIGNhbi5vbmxheW91dC5maWd1cmUoZXZlbnQsIGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYnMpICYmIGNicyhjYW4pCgl9KQp9KSB9fSwgfSkKCg==",
        "/plugin/local/chat/div.css": "ZmllbGRzZXQuZGl2IGRpdi5vdXRwdXQgdGQgeyB2ZXJ0aWNhbC1hbGlnbjp0b3A7IH0KZmllbGRzZXQuZGl2IGRpdi5vdXRwdXQgZmllbGRzZXQuc3Bhbj5maWVsZHNldCB7IG92ZXJmbG93OmF1dG87IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQucGFuZWwuY21kLm1haW4gZmllbGRzZXQuZGl2PmxlZ2VuZCB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5wYW5lbC5jbWQubWFpbiBmaWVsZHNldC5kaXY+Zm9ybS5vcHRpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQucGFuZWwuY21kLm1haW4gZmllbGRzZXQuZGl2PmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQucGFuZWwuY21kLm1haW4gZmllbGRzZXQuZGl2IGRpdi5wcm9qZWN0IHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZC5tYWluIGZpZWxkc2V0LmRpdiBkaXYucHJvZmlsZSB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC53b3JkPmRpdi5vdXRwdXQgZmllbGRzZXQuc3Bhbj5maWVsZHNldCB7IG92ZXJmbG93OmF1dG87IGZsb2F0OmxlZnQ7IH0K",
        "/plugin/local/chat/div.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJdmFyIG1ldGEgPSB7fTsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlKSB7IG1ldGFbdmFsdWUua2V5XSA9IHZhbHVlLnZhbHVlIH0pCgkJY2FuLl9tZXRhID0gY2FuLmJhc2UuT2JqKG1ldGEudGV4dCwge21ldGE6IHtuYW1lOiBtZXRhLm5hbWV8fCJoaSJ9LCBsaXN0OiBbXX0pCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgoJCWNhbi51aSA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dmlldzogW2NoYXQuTEFZT1VULCBodG1sLlRBQkxFXSwgbGlzdDogW3t0eXBlOiBodG1sLlRSLCBsaXN0OiBbCgkJCXt0eXBlOiBodG1sLlRELCBsaXN0OiBbe3ZpZXc6IGNoYXQuUFJPSkVDVH1dfSwKCQkJe3R5cGU6IGh0bWwuVEQsIGxpc3Q6IFt7dmlldzogY2hhdC5ESVNQTEFZfV19LAoJCQl7dHlwZTogaHRtbC5URCwgbGlzdDogW3t2aWV3OiBjaGF0LlBST0ZJTEV9XX0sCgkJXX1dIH1dKSwgY2FuLnVpLnByb2plY3QuX2ZpZWxkc2V0ID0gY2FuLnVpLmRpc3BsYXkKCgkJY2FuLm9uaW1wb3J0Ll9pdGVtKGNhbiwgY2FuLl9tZXRhLCBjYW4udWkucHJvamVjdCwgY2FuLm9uaW1wb3J0Ll9zaXplKGNhbikpLmNsaWNrKCkKCX0sCglfc2l6ZTogZnVuY3Rpb24oY2FuKSB7CgkJdmFyIHdpZHRoID0gY2FuLkNvbmYoaHRtbC5XSURUSCktMjYwLCBoZWlnaHQgPSBjYW4uQ29uZihodG1sLkhFSUdIVCktMTAwCgkJaWYgKGNhbi5Db25mKCJhdXRvLmNtZCIpKSB7CgkJCXdpZHRoID0gY2FuLkNvbmYoaHRtbC5XSURUSCksIGhlaWdodCA9IGNhbi5Db25mKGh0bWwuSEVJR0hUKQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkucHJvZmlsZSkKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fb3B0aW9uKQoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgkJfQoJCWlmIChjYW4udXNlci5tb2QuaXNDbWQgfHwgY2FuLnVzZXIubW9kLmlzRGl2KSB7CgkJCXdpZHRoID0gd2luZG93LmlubmVyV2lkdGgsIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodAoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4uX291dHB1dCwge3N0eWxlOiB7d2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodH19KQoJCX0KCQlyZXR1cm4gd2lkdGgKCX0sCglfaXRlbTogZnVuY3Rpb24oY2FuLCBub2RlLCB0YXJnZXQsIHdpZHRoKSB7IHdpZHRoID0gd2lkdGh8fG5vZGUubWV0YS53aWR0aAoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBbaHRtbC5JVEVNLCBodG1sLkRJViwgbm9kZS5tZXRhLm5hbWV8fCJoaSJdfSwge3ZpZXc6IFtodG1sLkxJU1RdfV0pCgkJdWkubGlzdC5fZmllbGRzZXQgPSBjYW4ub25pbXBvcnQuX3BsdWdpbihjYW4sIG5vZGUubWV0YSwgdGFyZ2V0Ll9maWVsZHNldCwgd2lkdGgpCgoJCXZhciBtc2cgPSBjYW4ucmVxdWVzdCh7fSk7IG1zZy5QdXNoKG5vZGUubWV0YSwgIiIsIHRydWUpCgkJdWkuaXRlbS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi51aS5wcm9qZWN0LCAiZGl2Lml0ZW0iLCB1aS5pdGVtKQoJCQljYW4uY3VycmVudCA9IHVpLml0ZW0sIGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5wcm9maWxlKQoJCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lLCBhcnJheSkgewoJCQkJcmV0dXJuIHt0ZXh0OiBbdmFsdWUsIGh0bWwuVERdLCBvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWtleSA9PSAidmFsdWUiICYmIGNhbi5vbm1vdGlvbi5tb2RpZnlzKGNhbiwgZXZlbnQudGFyZ2V0LCBmdW5jdGlvbihldmVudCwgdmFsdWUsIG9sZCkgewoJCQkJCQlub2RlLm1ldGFbbGluZS5rZXldID0gdmFsdWUKCQkJCQl9KQoJCQkJfX0KCQkJfSwgY2FuLnVpLnByb2ZpbGUpCgkJfQoKCQl1aS5pdGVtLl9hZGQgPSBmdW5jdGlvbihkYXRhKSB7CgkJCWlmIChub2RlLm1ldGEuc3R5bGUgPT0gaHRtbC5TUEFOKSB7IHdpZHRoID0gd2lkdGggKiBub2RlLmxpc3QubGVuZ3RoIH0KCQkJbm9kZS5saXN0LnB1c2goZGF0YSkKCQkJaWYgKG5vZGUubWV0YS5zdHlsZSA9PSBodG1sLlNQQU4pIHsgd2lkdGggPSB3aWR0aCAvIG5vZGUubGlzdC5sZW5ndGggfQoJCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB1aS5saXN0KSwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgdWkubGlzdC5fZmllbGRzZXQpCgkJCWNhbi5jb3JlLkxpc3Qobm9kZS5saXN0LCBmdW5jdGlvbihub2RlKSB7IGNhbi5vbmltcG9ydC5faXRlbShjYW4sIG5vZGUsIHVpLmxpc3QsIHdpZHRoKSB9KQoJCX0KCQlpZiAobm9kZS5tZXRhLnN0eWxlID09IGh0bWwuU1BBTikgeyB3aWR0aCA9IHdpZHRoIC8gbm9kZS5saXN0Lmxlbmd0aCB9CgkJY2FuLmNvcmUuTGlzdChub2RlLmxpc3QsIGZ1bmN0aW9uKG5vZGUpIHsgY2FuLm9uaW1wb3J0Ll9pdGVtKGNhbiwgbm9kZSwgdWkubGlzdCwgd2lkdGgpIH0pCgkJcmV0dXJuIHVpLml0ZW0KCX0sCglfcGx1Z2luOiBmdW5jdGlvbihjYW4sIG1ldGEsIHRhcmdldCwgd2lkdGgpIHsKCQl2YXIgc2l6ZSA9IHt3aWR0aDogd2lkdGgsIGhlaWdodDogbWV0YS5oZWlnaHR9CgkJdmFyIGZpZWxkID0gY2FuLm9uYXBwZW5kLmZpZWxkKGNhbiwgY2hhdC5MQVlPVVQsIHt9LCB0YXJnZXQpLmZpZWxkc2V0CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGZpZWxkLCBtZXRhLnN0eWxlKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGZpZWxkLCB7c3R5bGU6IHNpemV9KQoKCQltZXRhLmluZGV4ICYmIGNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09NTUFORCwgbWV0YS5pbmRleF0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQuX2luaXQoY2FuLCBjYW4uYmFzZS5Db3B5KHsKCQkJCWZlYXR1cmU6IGNhbi5iYXNlLk9iaihtc2cuQXBwZW5kKCJtZXRhIikpLCAKCQkJCWlucHV0czogY2FuLmJhc2UuT2JqKG1zZy5BcHBlbmQoImxpc3QiKSksCgkJCQlhcmdzOiBtZXRhLmFyZ3MsCgkJCQluYW1lOiBtZXRhLm5hbWUsCgkJCX0sIHNpemUpLCBbIi9wbHVnaW4vc3RhdGUuanMiXSwgZnVuY3Rpb24oc3ViKSB7CgkJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBzdWIuX291dHB1dCwgIHtzdHlsZTogc2l6ZX0pCgkJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIG1ldGEuaW5kZXhdLCBjbWRzKSwgY2IsIHRydWUpCgkJCQl9CgkJCX0sIHRhcmdldCwgZmllbGQpCgkJfSwgdHJ1ZSkKCQlyZXR1cm4gZmllbGQKCX0sIAp9LCBbIi9wbHVnaW4vbG9jYWwvY2hhdC9kaXYuY3NzIl0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5pON5L2c5pWw5o2uIiwgbGlzdDogW10sCgki5re75YqgIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFttZGIuTkFNRSwgY3R4LklOREVYLCBjdHguQVJHUywgY3R4LlNUWUxFLCBodG1sLkhFSUdIVCwgaHRtbC5XSURUSF0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEsIGxpc3QsIGFyZ3MpIHsKCQkJY2FuLmN1cnJlbnQuX2FkZCh7bWV0YTogZGF0YSwgbGlzdDogW119KQoJCX0pCgl9LAoJIuS/neWtmCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCBjYW4uT3B0aW9uKCkpCgkJY2FuLnJ1bihldmVudCwgW21kYi5NT0RJRlksIG1kYi5URVhULCBKU09OLnN0cmluZ2lmeShjYW4uX21ldGEpXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJfSwgdHJ1ZSkKCX0sCgki6aKE6KeIIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi5zaGFyZShldmVudCwgY2FuLCBbXSwgW21kYi5MSU5LLCBjYW4ubWlzYy5NZXJnZVVSTChjYW4sIHtfcGF0aDogIi9jaGF0L2Rpdi8iK2Nhbi5PcHRpb24oImhhc2giKX0pXSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW119KQoK",
        "/plugin/local/chat/media.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnVpID0gY2FuLm9ubGF5b3V0LmRpc3BsYXkoY2FuLCB0YXJnZXQpCgkJY2FuLnVpLmNhbnZhcyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5kaXNwbGF5LCBbe3R5cGU6ICJjYW52YXMiLCB3aWR0aDogMzIwLCBoZWlnaHQ6IDI0MCwgc3R5bGU6IHtkaXNwbGF5OiAibm9uZSJ9fV0pLmZpcnN0CgoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgZnVuY3Rpb24odmFsdWUsIGtleSwgaW5kZXgsIGxpbmUsIGFycmF5KSB7CgkJCXJldHVybiB7dGV4dDogW3ZhbHVlLCAidGQiXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5zdXAub25hY3Rpb24uY2hhbmdlKGV2ZW50LCBjYW4uc3VwLCBrZXksIHZhbHVlLCBmdW5jdGlvbihtc2cpIHsKCQkJCQljYW4ucnVuKGV2ZW50KQoJCQkJfSkKCQkJfX0KCQl9LCBjYW4udWkuY29udGVudCkKCgkJY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgbXNnLlJlc3VsdCgpLCBjYW4udWkuZGlzcGxheSkKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCX0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5pON5L2c5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJfSwKCglvcGVuOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJbmF2aWdhdG9yLmdldFVzZXJNZWRpYSh7dmlkZW86IHt3aWR0aDogMzIwLCBoZWlnaHQ6IDI0MH19LCBmdW5jdGlvbihzdHJlYW0pIHsKCQkJdmFyIHZpZGVvID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ2aWRlbyIpCgkJCXZpZGVvLnNyY09iamVjdCA9IHN0cmVhbSwgdmlkZW8ucGxheSgpCgkJCWNhbi51aS52aWRlbyA9IHZpZGVvCgkJfSwgZnVuY3Rpb24oZXJyb3IpIHsKCQkJY2FuLm1pc2MuTG9nKCJvcGVuIGNhbWVyYSIsIGVycm9yKQoJCX0pCgl9LAoJc25hcHNob3Q6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udWkuY2FudmFzLmdldENvbnRleHQoIjJkIikuZHJhd0ltYWdlKGNhbi51aS52aWRlbywgMCwgMCkKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkuZGlzcGxheSwgW3t0eXBlOiAiaW1nIiwgc3JjOiBjYW4udWkuY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2Uvd2VicCcpfV0pCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLCAKfSkKCg==",
        "/plugin/local/chat/trans.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQljYW4uZnJvbSA9IGNhbi5vbmltcG9ydC5fcGx1Z2luKGNhbiwgbmZzLkRJUiwgaHRtbC5MRUZULCAiZnJvbSIsICJ0byIpCgkJY2FuLnRvID0gY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBuZnMuRElSLCBodG1sLlJJR0hULCAidG8iLCAiZnJvbSIpCgkJY2FuLm9uaW1wb3J0Ll9wbHVnaW4oY2FuLCBuZnMuVFJBU0gsIGh0bWwuTEVGVCwgImZyb20iKQoJCWNhbi5vbmltcG9ydC5fcGx1Z2luKGNhbiwgbmZzLlRSQVNILCBodG1sLlJJR0hULCAidG8iKQoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGNhbiwgaW5kZXgsIHBvcywgZnJvbSwgdG8pIHsKCQlyZXR1cm4gY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHt0eXBlOiBjaGF0LlNUT1JZLCBpbmRleDogaW5kZXh9LCBmdW5jdGlvbihzdWIpIHsKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl90YXJnZXQsIHtzdHlsZToge2Zsb2F0OiBwb3MsIGNsZWFyOiBwb3N9fSkKCQkJc3ViLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCkvMikKCQkJc3ViLl9sZWdlbmQuaW5uZXJIVE1MID0gY2FuLk9wdGlvbihmcm9tKStpY2UuU1AraW5kZXgKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgc3ViLl9vdXRwdXQsIHtzdHlsZTogeyJtYXgtd2lkdGgiOiBjYW4uQ29uZihodG1sLldJRFRIKS8yfX0pCgoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7CgkJCQlpZiAoY2FuLm9uYWN0aW9uW2NtZHNbMV1dKSB7IHJldHVybiBjYW4ub25hY3Rpb25bY21kc1sxXV0oY2FuLCBmcm9tLCB0bywgZXZlbnQsIGNtZHMsIGNiKSB9CgoJCQkJdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KGV2ZW50LCB7X3BvZDogY2FuLk9wdGlvbihmcm9tKX0pCgkJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgaW5kZXhdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7Cgl9LAoJc2VuZDogZnVuY3Rpb24oY2FuLCBmcm9tLCB0bywgZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBfZnJvbSA9IGNhbltmcm9tXSwgX3RvID0gY2FuW3RvXQoJCXZhciBwYXRoID0gY2FuLnJlcXVlc3QoZXZlbnQpLk9wdGlvbihuZnMuUEFUSCkKCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtfaGFuZGxlOiBpY2UuVFJVRSwKCQkJZnJvbTogY2FuLk9wdGlvbihmcm9tKSwgZnJvbV9wYXRoOiBwYXRoLAoJCQl0bzogY2FuLk9wdGlvbih0byksIHRvX3BhdGg6IF90by5PcHRpb24obmZzLlBBVEgpK3BhdGguc3BsaXQoaWNlLlBTKS5wb3AoKSwKCQl9KQoJCWNhbi5ydW4oZXZlbnQsIGNtZHMsIGZ1bmN0aW9uKCkgeyBfdG8uVXBkYXRlKCkgfSwgdHJ1ZSkKCX0sCn0pCg==",
        "/plugin/local/chat/wx.js": "Vm9sY2Fub3MoIm9uYWN0aW9uIiwge3NvdXJjZTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCWNhbi5yZXF1aXJlKFsiaHR0cHM6Ly9yZXMud3gucXEuY29tL29wZW4vanMvandlaXhpbi0xLjYuMC5qcyJdLCBmdW5jdGlvbihjYW4pIHsKCQl3eC5jb25maWcoe2RlYnVnOiBtc2cuT3B0aW9uKCJkZWJ1ZyIpID09IGljZS5UUlVFLAoJCQlhcHBJZDogbXNnLk9wdGlvbigiYXBwaWQiKSwgc2lnbmF0dXJlOiBtc2cuT3B0aW9uKCJzaWduYXR1cmUiKSwKCQkJbm9uY2VTdHI6IG1zZy5PcHRpb24oIm5vbmNlc3RyIiksIHRpbWVzdGFtcDogbXNnLk9wdGlvbigidGltZXN0YW1wIiksCgoJCQlqc0FwaUxpc3Q6IGNhbi5jb3JlLkl0ZW0oewoJCQkJc2NhblFSQ29kZTogZnVuY3Rpb24oY2IpIHsgd3guc2NhblFSQ29kZSh7bmVlZFJlc3VsdDogY2I/IDE6IDAsIHNjYW5UeXBlOiBbInFyQ29kZSIsImJhckNvZGUiXSwgc3VjY2VzczogZnVuY3Rpb24gKHJlcykgewoJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IocmVzLnJlc3VsdFN0ciwgY2FuLmJhc2UuUGFyc2VKU09OKHJlcy5yZXN1bHRTdHIpKQoJCQkJfSB9KSB9LAoJCQkJZ2V0TG9jYXRpb246IGZ1bmN0aW9uKGNiKSB7IHd4LmdldExvY2F0aW9uKHt0eXBlOiAiZ2NqMDIiLCBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYih7dHlwZTogImdjajAyIiwgbmFtZTogIuW9k+WJjeS9jee9riIsIHRleHQ6ICLlvZPliY3kvY3nva4iLCBsYXRpdHVkZTogcGFyc2VJbnQocmVzLmxhdGl0dWRlKjEwMDAwMCksIGxvbmdpdHVkZTogcGFyc2VJbnQocmVzLmxvbmdpdHVkZSoxMDAwMDApIH0pCgkJCQl9IH0pIH0sCgkJCQlvcGVuTG9jYXRpb246IGZ1bmN0aW9uKG1zZykgeyB3eC5vcGVuTG9jYXRpb24oewoJCQkJCWxhdGl0dWRlOiBwYXJzZUludChtc2cuT3B0aW9uKCJsYXRpdHVkZSIpKS8xMDAwMDAsCgkJCQkJbG9uZ2l0dWRlOiBwYXJzZUludChtc2cuT3B0aW9uKCJsb25naXR1ZGUiKSkvMTAwMDAwLAoJCQkJCW5hbWU6IG1zZy5PcHRpb24obWRiLk5BTUUpLCBhZGRyZXNzOiBtc2cuT3B0aW9uKG1kYi5URVhUKSwKCQkJCQlzY2FsZTogbXNnLk9wdGlvbigic2NhbGUiKXx8MTQsIGluZm9Vcmw6IG1zZy5PcHRpb24obWRiLkxJTkspLAoJCQkJfSkgfSwKCQkJCWNob29zZUltYWdlOiBmdW5jdGlvbihjYiwgY291bnQpIHsgd3guY2hvb3NlSW1hZ2Uoe2NvdW50OiBjb3VudHx8OSwgc2l6ZVR5cGU6IFsnb3JpZ2luYWwnLCAnY29tcHJlc3NlZCddLCBzb3VyY2VUeXBlOiBbJ2FsYnVtJywgJ2NhbWVyYSddLCBzdWNjZXNzOiBmdW5jdGlvbiAocmVzKSB7CgkJCQkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihyZXMubG9jYWxJZHMpCgkJCQl9IH0pIH0sCgkJCX0sIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgcmV0dXJuIGNhbi51c2VyLmFnZW50W2tleV0gPSB2YWx1ZSwga2V5IH0pLAoJCX0pCgkJd3guZXJyb3IoZnVuY3Rpb24oZXJyKSB7IGNhbi51c2VyLnRvYXN0KGVyciwgInd4IGxvYWQiKSB9KQoJCXd4LnJlYWR5KGZ1bmN0aW9uKCkgeyBjYW4ubWlzYy5Mb2coInJlYWR5IikgfSkKCX0pCn19KQo=",
        "/plugin/local/code/inner.css": "ZmllbGRzZXQuc3RvcnkuaW5uZXI+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lcj5mb3JtLm9wdGlvbiBpbnB1dFtuYW1lPXBhdGhdIHsgd2lkdGg6ODBweDsgfQpmaWVsZHNldC5pbm5lcj5mb3JtLm9wdGlvbiBpbnB1dFtuYW1lPWZpbGVdIHsgd2lkdGg6MTYwcHg7IH0KZmllbGRzZXQuaW5uZXI+ZGl2LmFjdGlvbj5kaXYudGFicyB7IGJhY2tncm91bmQtY29sb3I6IzVjODA5YzVjOyBoZWlnaHQ6MThweDsgfQpmaWVsZHNldC5pbm5lcj5kaXYuYWN0aW9uPmRpdi50YWJzOmhvdmVyIHsgYmFja2dyb3VuZC1jb2xvcjojMDEzYjY3NWM7IH0KZmllbGRzZXQuaW5uZXI+ZGl2LmFjdGlvbj5kaXYudGFicy5zZWxlY3QgeyBiYWNrZ3JvdW5kLWNvbG9yOiMwMTNiNjc1YzsgYm9yZGVyLWJvdHRvbTpzb2xpZCAycHggIzc5OTliMjsgZm9udC1zaXplOjFyZW07IGhlaWdodDoxOXB4OyB9CgpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHsgY29sb3I6d2hpdGU7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IGRpdi5wcm9qZWN0IHsgd2lkdGg6MTgwcHg7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYucHJvamVjdCBkaXYua2luZCB7IGJhY2tncm91bmQtY29sb3I6Y29ybmZsb3dlcmJsdWU7IGNvbG9yOndoaXRlOyBmb250LWZhbWlseTptb25vc3BhY2U7IGZvbnQtc2l6ZToxLjFyZW07IHRleHQtYWxpZ246Y2VudGVyOyBwYWRkaW5nOjVweDsgY2xlYXI6Ym90aDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IGRpdi5pdGVtIGRpdi5uYW1lIHsgcGFkZGluZzowIDE2cHg7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB7IGNvbG9yOndoaXRlOyBmb250LXNpemU6MS4xcmVtOyBmb250LWZhbWlseTptb25vc3BhY2U7IHBvc2l0aW9uOnJlbGF0aXZlOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdHIuc2VsZWN0IHsgYmFja2dyb3VuZC1jb2xvcjojMDAwMGZmNmI7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ci5zZWxlY3QgdGQubGluZSB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgYm9yZGVyOnNvbGlkIDFweCByZWQ7IGJvcmRlci1yaWdodDpzb2xpZCAycHggcmVkOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQubGluZTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6Z3JlZW47IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC5saW5lIHsgcG9zaXRpb246c3RpY2t5OyBsZWZ0OjA7IHRleHQtYWxpZ246cmlnaHQ7IHBhZGRpbmc6MCA2cHg7IGJvcmRlci1yaWdodDpzb2xpZCAycHggcmVkOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCB7IHRleHQtYWxpZ246bGVmdDsgd2hpdGUtc3BhY2U6cHJlOyBwYWRkaW5nLWxlZnQ6MTBweDsgY3Vyc29yOnRleHQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uY29tbWVudCB7IGJhY2tncm91bmQtY29sb3I6Ymx1ZTsgY29sb3I6Y3lhbjsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5rZXl3b3JkIHsgY29sb3I6eWVsbG93OyBmb250LXdlaWdodDpib2xkOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmRhdGF0eXBlIHsgY29sb3I6bGlnaHRncmVlbjsgZm9udC13ZWlnaHQ6Ym9sZDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5mdW5jdGlvbiB7IGNvbG9yOmN5YW47IGZvbnQtd2VpZ2h0OmJvbGQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uY29uc3RhbnQgeyBjb2xvcjptYWdlbnRhOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLnN0cmluZyB7IGNvbG9yOm1hZ2VudGE7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCBsZWdlbmQgeyBtYXJnaW4tcmlnaHQ6NHB4OyBoZWlnaHQ6MzBweDsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9maWxlPmRpdi5vdXRwdXQ+ZmllbGRzZXQ+bGVnZW5kIHsgcGFkZGluZzowLjFyZW07IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuZGlzcGxheSB7IGJvcmRlcjpzb2xpZCAxcHggZ3JlZW55ZWxsb3c7IH0KCmZpZWxkc2V0LmlubmVyIGRpdi5vdXRwdXQgZmllbGRzZXQudG9vbGtpdCB7IHBvc2l0aW9uOmFic29sdXRlOyBib3R0b206MHB4OyByaWdodDowcHg7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5vdXRwdXQ+ZmllbGRzZXQgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBmaWVsZHNldC50b29sa2l0PmRpdi5vdXRwdXQ+ZmllbGRzZXQuc2VsZWN0IHsgZGlzcGxheTpibG9jazsgfQpmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGZpZWxkc2V0LnRvb2xraXQ+ZGl2Lm91dHB1dD5maWVsZHNldD5sZWdlbmQgeyBmbG9hdDpsZWZ0OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZmllbGRzZXQudG9vbGtpdD5kaXYuc3RhdHVzPmxlZ2VuZCB7IGJhY2tncm91bmQ6IzBkOTY5ZjhhOyBwYWRkaW5nOjRweCA0cHg7IGJvcmRlci1sZWZ0OnNvbGlkIDJweCByZWQ7IGZsb2F0OnJpZ2h0OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZmllbGRzZXQudG9vbGtpdD5kaXYuc3RhdHVzPmxlZ2VuZC5zZWxlY3QgeyBiYWNrZ3JvdW5kOmdyZWVuOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZmllbGRzZXQudG9vbGtpdD5kaXYuc3RhdHVzPmxlZ2VuZDpob3ZlciB7IGJhY2tncm91bmQ6Z3JlZW47IH0KZmllbGRzZXQuaW5uZXI+ZGl2LnN0YXR1cyB7IGhlaWdodDoyNnB4OyB9CmZpZWxkc2V0LmlubmVyPmRpdi5zdGF0dXMgbGVnZW5kIHsgYmFja2dyb3VuZDojMGQ5NjlmOGE7IGZvbnQtc2l6ZToxLjFyZW07IHBhZGRpbmc6MHB4IDEwcHg7IGJvcmRlci1sZWZ0OnNvbGlkIDJweCByZWQ7IGN1cnNvcjpwb2ludGVyOyBmbG9hdDpyaWdodDsgfQpmaWVsZHNldC5pbm5lcj5kaXYuc3RhdHVzIGxlZ2VuZC5zZWxlY3QgeyBiYWNrZ3JvdW5kOmdyZWVuOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5zdGF0dXMgbGVnZW5kOmhvdmVyIHsgYmFja2dyb3VuZDpncmVlbjsgfQoKZmllbGRzZXQuaW5uZXIuZmxvYXQgbGVnZW5kIHsgaGVpZ2h0OjMwcHg7IH0KZmllbGRzZXQuaW5uZXIuZmxvYXQgZGl2Lm91dHB1dCB7IGJhY2tncm91bmQtY29sb3I6IzMzMmYxZWNmOyB9CmZpZWxkc2V0LmlubmVyLmZsb2F0IGRpdi5zdGF0dXMgeyBjb2xvcjp3aGl0ZTsgfQoKZmllbGRzZXQuaW5uZXIuZnVsbD5sZWdlbmQgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5mb3JtLm9wdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5pbm5lci5mdWxsPmRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuaW5uZXIuZnVsbD5kaXYuc3RhdHVzIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyLmZ1bGw+ZGl2Lm91dHB1dCBkaXYucHJvZmlsZT5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyLmZ1bGw+ZGl2Lm91dHB1dCBkaXYuZGlzcGxheT5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyLmZ1bGw+ZGl2Lm91dHB1dCBkaXYuZGlzcGxheT5kaXYuc3RhdHVzIHsgZGlzcGxheTpub25lOyB9Cgpib2R5LndoaXRlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2plY3QgeyBjb2xvcjojYTJkYWQyOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB7IGJhY2tncm91bmQtY29sb3I6IzAxM2I2NzVjOyB9CmJvZHkud2hpdGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHNwYW4uc3RyaW5nIHsgY29sb3I6I2E3MDNhNzsgfQoKYm9keS5tb2JpbGUgZmllbGRzZXQuaW5uZXIuZmxvYXQgbGVnZW5kIHsgaGVpZ2h0OjQycHg7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQuaW5uZXI+Zm9ybS5vcHRpb24gaW5wdXRbbmFtZT1maWxlXSB7IHdpZHRoOjkwcHg7IH0KYm9keS5tb2JpbGUgZmllbGRzZXQucGx1Z2luLmlubmVyIGRpdi5hY3Rpb24geyBkaXNwbGF5Om5vbmU7IH0KYm9keS5tb2JpbGUubGFuZHNjYXBlIGZpZWxkc2V0LnBsdWdpbi5pbm5lciBkaXYuYWN0aW9uIHsgZGlzcGxheTpjb250ZW50czsgfQpib2R5Lm1vYmlsZS5sYW5kc2NhcGUgZmllbGRzZXQucGx1Z2luLmlubmVyIGZvcm0ub3B0aW9uIGlucHV0W3R5cGU9YnV0dG9uXSB7IGRpc3BsYXk6bm9uZTsgfQoKLnVuc2VsZWN0YWJsZSB7Cgktd2Via2l0LXRvdWNoLWNhbGxvdXQ6bm9uZTsKCS13ZWJraXQtdXNlci1zZWxlY3Q6bm9uZTsKCS1raHRtbC11c2VyLXNlbGVjdDpub25lOwoJLW1vei11c2VyLXNlbGVjdDpub25lOwoJLW1zLXVzZXItc2VsZWN0Om5vbmU7Cgktby11c2VyLXNlbGVjdDpub25lOwoJdXNlci1zZWxlY3Q6bm9uZTsKfQoKZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi50YWJzIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYucGF0aCB7IGRpc3BsYXk6bm9uZTsgfQoKYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi50YWJzIHsgYmFja2dyb3VuZDojNTQ2RTdBOyBwYWRkaW5nOjBweDsgaGVpZ2h0OjM4cHg7IG92ZXJmbG93OmF1dG87IGRpc3BsYXk6YmxvY2s7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5jb250ZW50PmRpdi50YWJzIGRpdi50YWJzIHsgYmFja2dyb3VuZDojNjk4MThkOyBjb2xvcjp3aGl0ZTsgZm9udC1zaXplOjFyZW07IHBhZGRpbmc6MTBweDsgZmxvYXQ6bGVmdDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgZGl2LnRhYnMuc2VsZWN0IHsgYmFja2dyb3VuZDojNDU1QTY0OyBib3gtc2hhZG93OjBweCAwcHggNXB4IDFweCBncmV5OyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYucGF0aCB7CgliYWNrZ3JvdW5kOiM0NTVBNjQ7IGNvbG9yOndoaXRlOyBwYWRkaW5nOjRweCAxMHB4OwoJbWFyZ2luLWJvdHRvbTo0cHg7IGJveC1zaGFkb3c6MHB4IDBweCA1cHggMXB4ICM5MEE0QUU7CgljbGVhcjpib3RoOyBkaXNwbGF5OmJsb2NrOwp9Cgpib2R5LndoaXRlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYudGFicyB7IGJhY2tncm91bmQ6I2YzZjNmMzsgfQpib2R5LndoaXRlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgdGQuY29udGVudD5kaXYudGFicyBkaXYudGFicyB7IGJhY2tncm91bmQ6I2VjZWNlYzsgY29sb3I6YmxhY2s7IGZvbnQtc2l6ZToxcmVtOyBwYWRkaW5nOjEwcHg7IGZsb2F0OmxlZnQ7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnRhYnMgZGl2LnRhYnMuc2VsZWN0IHsgYmFja2dyb3VuZDogd2hpdGU7IGJveC1zaGFkb3c6MHB4IDBweCA1cHggMXB4IGdyZXk7IH0KYm9keS53aGl0ZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLmNvbnRlbnQ+ZGl2LnBhdGggeyBiYWNrZ3JvdW5kOndoaXRlOyBjb2xvcjpibGFjazsgZm9udC1mYW1pbHk6bW9ub3NwYWNlOyBib3gtc2hhZG93OjBweCAwcHggNXB4IDFweCBncmV5OyB9Cgpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgeyB3aWR0aDoyNDBweDsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IHRkLnByb2plY3QgZGl2LnByb2plY3QgZGl2LmtpbmQgeyBwYWRkaW5nOjEwcHg7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IGRpdi5wcm9qZWN0IGRpdi5raW5kIHsgY29sb3I6IHdoaXRlOyBmb250LXNpemU6IDEuMnJlbTsgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTsgaGVpZ2h0OjE4cHg7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCB0ZC5wcm9qZWN0IGRpdi5wcm9qZWN0IGRpdi5raW5kOmZpcnN0LWNoaWxkIHsgcG9zaXRpb246c3RpY2t5OyB0b3A6MCB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgeyBiYWNrZ3JvdW5kLWNvbG9yOiMyNjMyMzhjMjsgZm9udC1zaXplOjE2cHg7IH0KYm9keS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYudG9nZ2xlIHsgZGlzcGxheTpub25lOyB9CmJvZHkuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnRvZ2dsZS5wcm9maWxlIHsgYmFja2dyb3VuZC1jb2xvcjojNjY0ZjRmNDU7IGRpc3BsYXk6YmxvY2s7IH0KCmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnByb2plY3QgZGl2LmFjdGlvbiBkaXYuaXRlbSB7IGZsb2F0OmxlZnQ7IHdpZHRoOmF1dG87IHBhZGRpbmc6dW5zZXQ7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYucHJvamVjdCB7IGJhY2tncm91bmQ6bGlnaHR5ZWxsb3c7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYucHJvamVjdCBkaXYuaXRlbSB7IGNvbG9yOmJsYWNrOyBmb250LXNpemU6MTZweDsgd2lkdGg6LXdlYmtpdC1maWxsLWF2YWlsYWJsZTsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5wcm9qZWN0IGRpdi5pdGVtOmhvdmVyIHsgYmFja2dyb3VuZDojZTNlNmYxOyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgeyBiYWNrZ3JvdW5kLWNvbG9yOndoaXRlOyBmb250LXNpemU6MTZweDsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRyLnNlbGVjdCB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ci5zZWxlY3QgdGQubGluZSB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOmJsYWNrOyBib3JkZXI6bm9uZTsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRyLnNlbGVjdCB0ZC50ZXh0IHsgYm9yZGVyOnNvbGlkIDFweCAjZTdlN2U3OyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQubGluZSB7IGJhY2tncm91bmQtY29sb3I6d2hpdGU7IGNvbG9yOiMyMzc4OTM7IHBhZGRpbmctdG9wOjRweDsgYm9yZGVyLXJpZ2h0Om5vbmU7IH0KYm9keS53aGl0ZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCB0ZC50ZXh0IHsgY29sb3I6YmxhY2s7IHBhZGRpbmctdG9wOjJweDsgYm9yZGVyOnNvbGlkIDFweCB3aGl0ZTsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5zdHJpbmcgeyBjb2xvcjojYTMxNTE1OyB9CmJvZHkud2hpdGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LmNvbnRlbnQgdGQudGV4dCBzcGFuLmZ1bmN0aW9uIHsgY29sb3I6Izc5NWUyNjsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IHRkLnRleHQgc3Bhbi5rZXl3b3JkIHsgY29sb3I6Ymx1ZTsgfQpib2R5LndoaXRlLnNpbXBsZSB0ZC5jb250ZW50PmRpdi5jb250ZW50IHsgYmFja2dyb3VuZDogd2hpdGU7IGJveC1zaGFkb3c6MHB4IDBweCA1cHggMXB4IGdyZXk7IH0KYm9keS53aGl0ZS5zaW1wbGUgZGl2LnN0YXR1cyB7IGNvbG9yOmJsYWNrOyB9Cgpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIHNwYW4geyBjb2xvcjpibGFjazsgfQpib2R5LndoaXRlLnNpbXBsZSBmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIHNwYW4ua2V5IHsgY29sb3I6Ymx1ZTsgfQpib2R5LnNpbXBsZSBmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIHNwYW4uc3RyaW5nIHsgY29sb3I6bWFnZW50YTsgfQoKYm9keS5tb2JpbGUuc2ltcGxlIGZpZWxkc2V0LmlubmVyPmRpdi5vdXRwdXQgZGl2LnRvZ2dsZSB7IGRpc3BsYXk6YmxvY2s7IH0KYm9keS5tb2JpbGUuc2ltcGxlIGlucHV0W3R5cGU9YnV0dG9uXSB7IGhlaWdodDo0NXB4OyB9CmJvZHkubW9iaWxlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi5jb250ZW50IGxlZ2VuZCB7IGhlaWdodDo0NXB4OyB9CmJvZHkubW9iaWxlLnNpbXBsZSBmaWVsZHNldC5pbm5lcj5kaXYub3V0cHV0IGRpdi50b2dnbGUgeyBiYWNrZ3JvdW5kLWNvbG9yOmxpZ2h0Ymx1ZTsgd2lkdGg6MzBweDsgfQpib2R5Lm1vYmlsZS5zaW1wbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYudG9nZ2xlLmRpc3BsYXkgeyBiYWNrZ3JvdW5kLWNvbG9yOmxpZ2h0Ymx1ZTsgbWFyZ2luLXRvcDotMzNweDsgaGVpZ2h0OjMwcHg7IHdpZHRoOjEwMHB4OyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LkFjdGlvbiBkaXYub3V0cHV0IGZpZWxkc2V0LkZ1bGw+bGVnZW5kIHsgZmxvYXQ6bm9uZTsgfQoKYm9keS5tb2JpbGUgZmllbGRzZXQuaW5uZXI+ZGl2Lm91dHB1dCBkaXYuY29udGVudCBsZWdlbmQgeyBoZWlnaHQ6NDVweDsgfQo=",
        "/plugin/local/code/inner.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCQljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgImNhbi5jb2RlLmlubmVyLnBsdWdpbiIsIHNoeSgi5o+S5Lu2Iiwge30sIFtpY2UuTElTVCwgaWNlLkJBQ0tdLCBmdW5jdGlvbihtc2csIGNtZHMpIHsKCQkJY29uc29sZS5sb2coIndoYXQiKQoJCX0pKQoJCWNhbi5Db25mKGNhbi5fYXJncykKCgkJY2FuLm9uZW5naW5lLnBsdWdpbihjYW4sICJjYW4uY29kZS5pbm5lci5rZXltYXAiLCBzaHkoIuaMiemUriIsIHt9LCBbIm1vZGUiLCAia2V5IiwgaWNlLkxJU1QsIGljZS5CQUNLXSwgZnVuY3Rpb24obXNnLCBjbWRzKSB7CgkJCWNhbi5jb3JlLkl0ZW0oY2FuLm9ua2V5bWFwLl9tb2RlLCBmdW5jdGlvbihtb2RlLCB2YWx1ZSkgewoJCQkJKCFjbWRzWzBdIHx8IGNtZHNbMF0gPT0gbW9kZSkgJiYgY2FuLmNvcmUuSXRlbSh2YWx1ZSwgZnVuY3Rpb24oa2V5LCBmdW5jKSB7CgkJCQkJaWYgKGNtZHNbMF0gPT0gbW9kZSAmJiBjbWRzWzFdID09IGtleSkgewoJCQkJCQltc2cuUHVzaCgia2V5IiwgIm1vZGUiKQoJCQkJCQltc2cuUHVzaCgidmFsdWUiLCBtb2RlKQoJCQkJCQltc2cuUHVzaCgia2V5IiwgImtleSIpCgkJCQkJCW1zZy5QdXNoKCJ2YWx1ZSIsIGtleSkKCQkJCQkJbXNnLlB1c2goImtleSIsICJoZWxwIikKCQkJCQkJbXNnLlB1c2goInZhbHVlIiwgZnVuYy5oZWxwKQoJCQkJCQltc2cuUHVzaCgia2V5IiwgImZ1bmMiKQoJCQkJCQltc2cuUHVzaCgidmFsdWUiLCBmdW5jLnRvU3RyaW5nKCkpCgkJCQkJfSBlbHNlIGlmICghY21kc1swXSB8fCAhY21kc1sxXSkgewoJCQkJCQlmdW5jLmhlbHAgJiYgbXNnLlB1c2goa2l0LkRpY3QoIm1vZGUiLCBtb2RlLCAia2V5Iiwga2V5LCAiaGVscCIsIGZ1bmMuaGVscCkpCgkJCQkJfQoJCQkJfSkKCQkJfSksIG1zZy5TdGF0dXNUaW1lQ291bnQoKQoJCX0pKQoKCQljYW4ub25lbmdpbmUubGlzdGVuKGNhbiwgIm9yaWVudGF0aW9uY2hhbmdlIiwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJaWYgKGNhbi51c2VyLm1vZC5pc0NtZCkgeyBjYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQpLCBjYW4uQ29uZldpZHRoKHdpbmRvdy5pbm5lcldpZHRoKSB9CgkJCWNhbi51c2VyLnRvYXN0KGNhbiwgY2FuLkNvbmZIZWlnaHQoKSsiIikKCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJfSkKCgkJdmFyIHBhdGhzID0gY2FuLmNvcmUuU3BsaXQoY2FuLk9wdGlvbihuZnMuUEFUSCksIGljZS5GUyk7IGNhbi5PcHRpb24obmZzLlBBVEgsIHBhdGhzWzBdKQoJCXZhciBmaWxlcyA9IGNhbi5jb3JlLlNwbGl0KGNhbi5PcHRpb24obmZzLkZJTEUpLCBpY2UuRlMpOyBjYW4uT3B0aW9uKG5mcy5GSUxFLCBmaWxlc1swXSkKCQkvLyBjYW4udGFidmlldyA9IGNhbi50YWJ2aWV3fHx7fSwgY2FuLnRhYnZpZXdbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBtc2cKCQljYW4udGFidmlldyA9IGNhbi50YWJ2aWV3fHx7fQoJCWNhbi5oaXN0b3J5ID0gY2FuLmhpc3Rvcnl8fFtdLCBjYW4udG9vbGtpdCA9IHt9LCBjYW4uZXh0ZW50aW9ucyA9IHt9LCBjYW4ucHJvZmlsZV9zaXplID0ge30KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5vbmxheW91dC5wcm9maWxlKGNhbikKCQljYW4ub25pbXBvcnQuX3Byb2plY3QoY2FuLCBjYW4udWkucHJvamVjdCkKCQljYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBjYW4udWkucHJvZmlsZSkKCQljYW4ub25pbXBvcnQuX2Rpc3BsYXkoY2FuLCBjYW4udWkuZGlzcGxheSkKCgkJY2FuLnVpLl90YWJzID0gY2FuLnBhZ2UuaW5zZXJ0QmVmb3JlKGNhbiwgW3t2aWV3OiAidGFicyJ9XSwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLnVpLl9wYXRoID0gY2FuLnBhZ2UuaW5zZXJ0QmVmb3JlKGNhbiwgW3t2aWV3OiAicGF0aCJ9XSwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgoJCWNhbi5Db25mKCJtb2RlIikgPT0gInNpbXBsZSI/IGNhbi5vbmltcG9ydC5fc2ltcGxlKGNhbik6IGNhbi5vbmltcG9ydC5wcm9qZWN0KGNhbiwgcGF0aHMsIGZ1bmN0aW9uKCkgewoJCQljYW4ub25pbXBvcnQuX3Rvb2xraXQoY2FuLCBjYW4udWkudG9vbGtpdCksIGNhbi5vbmltcG9ydC5fc2Vzc2lvbihjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5fa2V5ZG93bihjYW4pCgkJCWNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgewoJCQkJY2FuLmNvcmUuTmV4dChmaWxlcy5zbGljZSgxKSwgZnVuY3Rpb24oZmlsZSwgbmV4dCkgewoJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGZpbGUsIGNhbi5PcHRpb24obmZzLkxJTkUpLCBuZXh0KQoJCQkJfSkKCQkJfSkKCQl9KQoJCWlmIChsb2NhdGlvbi5oYXNoKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGRlY29kZVVSSUNvbXBvbmVudChsb2NhdGlvbi5oYXNoKS5zbGljZSgxKSwgMSkKCQl9IGVsc2UgewoJCQljYW4ub25pbXBvcnQudGFidmlldyhjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuTElORSkpCgkJfQoKCQljYW4udXNlci5pc01vYmlsZSAmJiAhY2FuLnVzZXIuaXNMYW5kc2NhcGUoKSAmJiBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgl9LAoJX3NpbXBsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQljYW4udGFidmlld1tjYW4ub25leHBvcnQua2V5cyhjYW4pXSA9IGNhbi5fbXNnCgkJY2FuLkNvbmYoaHRtbC5IRUlHSFQsICIiKSwgY2FuLnVpLnByb2plY3QuX3RvZ2dsZSgpCgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGNhbi5fZmllbGRzLCBjaGF0Lk9VVFBVVCkKCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJzaW1wbGUiKQoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkuX3RhYnMpCgl9LAoJX3Byb2plY3Q6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7CgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgdGFyZ2V0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIH0KCX0sCglfcHJvZmlsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVR9XSk7IGNhbi51aS5wcm9maWxlX291dHB1dCA9IHVpLm91dHB1dAoJCXZhciBhY3Rpb24gPSBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIGtpdC5EaWN0KAoJCQljbGkuQ0xPU0UsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCB0YXJnZXQpLCBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikgfSwKCQkJY2xpLkNMRUFSLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB1aS5vdXRwdXQpIH0sCgkJCWNsaS5TSE9XLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuWxleekuiJdKGV2ZW50LCBjYW4pIH0sCgkJCSLliqDovb0iLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuWKoOi9vSJdKGV2ZW50LCBjYW4pLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9LAoKCQkJIumTvuaOpSIsIGZ1bmN0aW9uKGV2ZW50KSB7IHZhciBwb2QgPSBjYW4ubWlzYy5TZWFyY2goY2FuLCAicG9kIikKCQkJCWlmIChwb2QpIHsKCQkJCQljYW4udXNlci5vcGVuKGNhbi5iYXNlLlBhdGgoIi9jaGF0LyIsICJwb2QiLCBwb2QsICJjbWQiLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpKQoJCQkJfSBlbHNlIHsKCQkJCQljYW4udXNlci5vcGVuKGNhbi5iYXNlLlBhdGgoIi9jaGF0LyIsICJjbWQiLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpKQoJCQkJfQoJCQl9LAoJCQltZGIuUExVR0lOLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW2N0eC5JTkRFWCwgY3R4LkFSR1NdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIGRhdGEsIHVpLm91dHB1dCkKCQkJCX0pCgkJCX0sCgkJCWh0bWwuV0lEVEgsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGh0bWwuV0lEVEgsIHZhbHVlOiA1MH1dLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCQkJY2FuLnByb2ZpbGVfc2l6ZVtjYW4ub25leHBvcnQua2V5cyhjYW4pXSA9IGNhbi5Db25mV2lkdGgoKSpwYXJzZUludChkYXRhLndpZHRoKS8xMDAKCQkJCQljYW4ub25hY3Rpb25bIuWxleekuiJdKGV2ZW50LCBjYW4pCgkJCQl9KQoJCQl9LAoJCSkpCgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCwgc2hvdykgeyBhY3Rpb25bc2hvdz8gY2xpLlNIT1c6IGNsaS5DTE9TRV0oZXZlbnQpIH0KCX0sCglfZGlzcGxheTogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5BQ1RJT059LCB7dmlldzogaHRtbC5PVVRQVVR9LCB7dmlldzogaHRtbC5TVEFUVVN9XSkKCQljYW4udWkuZGlzcGxheV9vdXRwdXQgPSB1aS5vdXRwdXQsIGNhbi51aS5kaXNwbGF5X3N0YXR1cyA9IHVpLnN0YXR1cwoJCXZhciBhY3Rpb24gPSBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFtdLCB1aS5hY3Rpb24sIGtpdC5EaWN0KAoJCQljbGkuQ0xPU0UsIGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCB0YXJnZXQpLCBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikgfSwKCQkJY2xpLkNMRUFSLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB1aS5vdXRwdXQpIH0sCgkJCWNsaS5FWEVDLCBmdW5jdGlvbihldmVudCkgeyBjYW4ub25hY3Rpb25bIuaJp+ihjCJdKGV2ZW50LCBjYW4pIH0sCgkJCW1kYi5QTFVHSU4sIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbY3R4LklOREVYLCBjdHguQVJHU10sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEpIHsKCQkJCQljYW4ub25pbXBvcnQucGx1Z2luKGNhbiwgZGF0YSwgdWkub3V0cHV0KQoJCQkJfSkKCQkJfSwKCQkJaHRtbC5IRUlHSFQsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbe25hbWU6IGh0bWwuSEVJR0hULCB2YWx1ZTogNTB9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQkJCWNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBjYW4uQ29uZkhlaWdodCgpKnBhcnNlSW50KGRhdGEuaGVpZ2h0KS8xMDAKCQkJCQljYW4ub25hY3Rpb25bIuaJp+ihjCJdKGV2ZW50LCBjYW4pCgkJCQl9KQoJCQl9LAoJCSkpCgkJdGFyZ2V0Ll90b2dnbGUgPSBmdW5jdGlvbihldmVudCwgc2hvdykgeyBhY3Rpb25bc2hvdz8gY2xpLkVYRUM6IGNsaS5DTE9TRV0oZXZlbnQpIH0KCX0sCglfdG9vbGtpdDogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQljYW4udWkudG9vbGtpdCA9IGNhbi5vbmFwcGVuZC5maWVsZChjYW4sICJ0b29sa2l0Iiwge30sIGNhbi5fb3V0cHV0KQoJfSwKCV9zZXNzaW9uOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5vbmltcG9ydC5zZXNzKGNhbiwgIiIsIGZ1bmN0aW9uKCkgeyBjYW4ub25pbXBvcnQuc2VzcyhjYW4sIHsKCQkJcGx1ZzogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJwbHVnIikpLnJldmVyc2UoKSwKCQkJZXh0czogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJleHRzIikpLnJldmVyc2UoKSwKCQkJdGFiczogY2FuLmNvcmUuU3BsaXQobXNnLk9wdGlvbk9yU2VhcmNoKCJ0YWJzIikpLAoJCX0pIH0pCgl9LAoJX2tleWRvd246IGZ1bmN0aW9uKGNhbikgeyBjYW4ub25rZXltYXAuX2J1aWxkKGNhbikKCQljYW4udXNlci5tb2QuaXNDbWQgJiYgY2FuLm9uZW5naW5lLmxpc3RlbihjYW4sIGNoYXQuT05LRVlET1dOLCBmdW5jdGlvbihldmVudCkgewoJCQljYW4uX2tleV9saXN0ID0gY2FuLm9ua2V5bWFwLl9wYXJzZShldmVudCwgY2FuLCAicGx1Z2luIiwgY2FuLl9rZXlfbGlzdCwgY2FuLnVpLmNvbnRlbnQpCgkJfSkKCX0sCgoJcHJvamVjdDogZnVuY3Rpb24oY2FuLCBwYXRoLCBjYikgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4udWkucHJvamVjdCkKCQkvLyBjYW4ub25hcHBlbmQuX2FjdGlvbihjYW4sIFsi5omn6KGMIiwgIumihOiniCIsICLkv53lrZgiXSwgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLnByb2plY3QsIFt7dmlldzogImFjdGlvbiJ9XSkuZmlyc3QsIHsKCQkvLyAJIuaJp+ihjCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5omn6KGMIl0oZXZlbnQsIGNhbikgfSwKCQkvLyAJIumihOiniCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5bGV56S6Il0oZXZlbnQsIGNhbikgfSwKCQkvLyAJIuS/neWtmCI6IGZ1bmN0aW9uKGV2ZW50KSB7IGNhbi5vbmFjdGlvblsi5L+d5a2YIl0oZXZlbnQsIGNhbikgfSwKCQkvLyB9KQoJCS8vIGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi51aS5wcm9qZWN0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogW3t0eXBlOiAiaW5wdXQiLCBkYXRhOiB7dHlwZTogInRleHQifSwgb25rZXl1cDogZnVuY3Rpb24oZXZlbnQpIHsKCQkvLyAJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLnByb2plY3QsICJkaXYuaXRlbSIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkvLyAJCWlmIChpdGVtLmlubmVyVGV4dC5pbmRleE9mKGV2ZW50LnRhcmdldC52YWx1ZSkgPT0gLTEpIHsKCQkvLyAJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgaXRlbSwgImhpZGUiKQoJCS8vIAkJfSBlbHNlIHsKCQkvLyAJCQljYW4ucGFnZS5DbGFzc0xpc3QuZGVsKGNhbiwgaXRlbSwgImhpZGUiKQoJCS8vIAkJfQoJCS8vIAl9KQoJCS8vIH19IF19LCBdKQoJCXZhciBwcm9qZWN0ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLnByb2plY3QsIFsKCQkJe3ZpZXc6ICJraW5kIiwgaW5uZXI6ICJzb3VyY2UiLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGV2ZW50LnRhcmdldC5uZXh0U2libGluZykKCQkJfX0sIHt2aWV3OiAic291cmNlIn0sCgkJCXt2aWV3OiAia2luZCIsIGlubmVyOiAibW9kdWxlIiwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBldmVudC50YXJnZXQubmV4dFNpYmxpbmcpCgkJCX19LCB7dmlldzogIm1vZHVsZSJ9LAoJCQl7dmlldzogImtpbmQiLCBpbm5lcjogInBsdWdpbiIsIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgZXZlbnQudGFyZ2V0Lm5leHRTaWJsaW5nKQoJCQl9fSwge3ZpZXc6ICJwbHVnaW4ifSwKCQldKQoKCQljYW4uY29yZS5OZXh0KHBhdGgsIGZ1bmN0aW9uKHBhdGgsIG5leHQsIGluZGV4LCBhcnJheSkgewoJCQl2YXIgbGlzdCA9IHByb2plY3Quc291cmNlOyBpZiAoYXJyYXkubGVuZ3RoID4gMSkgewoJCQkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgcHJvamVjdC5zb3VyY2UsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIHBhdGhdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCB1aS5saXN0KQoJCQkJfX0sIHt2aWV3OiBodG1sLkxJU1R9XSk7IGxpc3QgPSB1aS5saXN0CgkJCQlpZiAoaW5kZXggPiAwKSB7IHVpLml0ZW0uY2xpY2soKSB9CgkJCX0KCQkJY2FuLnJ1bihjYW4ucmVxdWVzdCh7fSwge2Rpcl9yb290OiBwYXRoLCBkaXJfZGVlcDogdHJ1ZX0pLl9ldmVudCwgW2ljZS5QV0RdLCBmdW5jdGlvbihtc2cpIHsgY2FuLl9maWxlID0gbXNnLlRhYmxlKCkKCQkJCWNhbi5jb3JlLkxpc3QoY2FuLl9maWxlLCBmdW5jdGlvbihpdGVtKSB7IGlmIChjYW4uT3B0aW9uKG5mcy5GSUxFKS5pbmRleE9mKGl0ZW0ucGF0aCkgPT0gMCkgeyBpdGVtLmV4cGFuZCA9IHRydWUgfSB9KQoJCQkJY2FuLm9uYXBwZW5kLnRyZWUoY2FuLCBjYW4uX2ZpbGUsIG5mcy5QQVRILCBpY2UuUFMsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBwYXRoLCBpdGVtLnBhdGgpCgkJCQl9LCBsaXN0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pLCBjYW4uU3RhdHVzKCLmlofku7bmlbAiLCBtc2cuTGVuZ3RoKCkpLCBuZXh0KCkKCQkJfSwgdHJ1ZSkKCQl9LCBmdW5jdGlvbigpIHsgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpIH0pCgoJCWNhbi5ydW4oY2FuLnJlcXVlc3Qoe30sIHtmaWVsZHM6ICJpbmRleCJ9KS5fZXZlbnQsIFtjdHguQUNUSU9OLCBjdHguQ09NTUFORCwgInNlYXJjaCIsICJjb21tYW5kIl0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQudHJlZShjYW4sIG1zZy5UYWJsZSgpLCBjdHguSU5ERVgsIGljZS5QVCwgZnVuY3Rpb24oZXZlbnQsIGl0ZW0pIHsKCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGl0ZW0uaW5kZXgsIGN0eC5JTkRFWCkKCQkJfSwgcHJvamVjdC5tb2R1bGUpCgkJfSkKCgkJY2FuLm9uYXBwZW5kLnRyZWUoY2FuLCBjYW4uY29yZS5JdGVtKGNhbi5vbmVuZ2luZS5wbHVnaW4ubWV0YSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB7aW5kZXg6IGNhbi5iYXNlLnRyaW1QcmVmaXgoa2V5LCAiY2FuLiIpfSB9KSwgY3R4LklOREVYLCBpY2UuUFQsIGZ1bmN0aW9uKGV2ZW50LCBpdGVtKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksICJjYW4uIitpdGVtLmluZGV4LCBjdHguSU5ERVgpCgkJfSwgcHJvamVjdC5wbHVnaW4pCgl9LAoJdGFidmlldzogZnVuY3Rpb24oY2FuLCBwYXRoLCBmaWxlLCBsaW5lLCBjYiwgc2tpcCwgc2tpcDIpIHsgdmFyIGtleSA9IGNhbi5vbmV4cG9ydC5rZXlzKGNhbiwgZmlsZSwgcGF0aCkKCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kKSB7IGxvY2F0aW9uLmhhc2ggPSBmaWxlIH0KCQlpZiAoIXNraXAgJiYgY2FuLnRhYnZpZXdba2V5XSkgeyBjYW4udXNlci5tb2QuaXNDbWQgJiYgY2FuLnVzZXIudGl0bGUocGF0aCtmaWxlKQoJCQljYW4uX21zZyAmJiBjYW4uX21zZy5PcHRpb24obmZzLkxJTkUsIGNhbi5PcHRpb24obmZzLkxJTkUpKSwgY2FuLl9tc2cgPSBjYW4udGFidmlld1trZXldCgkJCWNhbi5PcHRpb24oe3BhdGg6IHBhdGgsIGZpbGU6IGZpbGUsIGxpbmU6IGxpbmV8fGNhbi5fbXNnLk9wdGlvbihuZnMuTElORSl8fDF9KQoJCQlyZXR1cm4gY2FuLl9tc2cuT3B0aW9uKGNhbi5PcHRpb24oKSksIGNhbi5vbnN5bnRheC5faW5pdChjYW4sIGNhbi5fbXNnLCBjYiwgc2tpcDIpCgkJfQoKCQlmdW5jdGlvbiBzaG93KG1zZykgeyBjYW4udGFidmlld1trZXldID0gbXNnCgkJCXZhciBza2lwMiA9IHNraXAKCQkJbXNnLl90YWIgPSBjYW4ub25hcHBlbmQudGFicyhjYW4sIFt7bmFtZTogZmlsZS5zcGxpdChtc2cuT3B0aW9uKG5mcy5MSU5FKSA9PSBjdHguSU5ERVg/IGljZS5QVDogaWNlLlBTKS5wb3AoKSwgdGV4dDogZmlsZX1dLCBmdW5jdGlvbihldmVudCwgbWV0YSkgewoJCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBwYXRoLCBmaWxlLCAiIiwgY2IsIGZhbHNlLCBza2lwMiksIGNiID0gbnVsbCwgc2tpcDIgPSBmYWxzZQoJCQl9LCBmdW5jdGlvbihpdGVtKSB7IGRlbGV0ZShjYW4udGFidmlld1trZXldKSB9LCBjYW4udWkuX3RhYnMsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIHtvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl9fSkKCQkJfSkKCQl9CgoJCWNhbi5PcHRpb24oe3BhdGg6IHBhdGgsIGZpbGU6IGZpbGUsIGxpbmU6IGxpbmV8fDF9KQoJCWxpbmUgPT0gY3R4LklOREVYPyBzaG93KGNhbi5yZXF1ZXN0KHt9LCB7aW5kZXg6IGZpbGUsIGxpbmU6IGxpbmV9KSk6IGNhbi5ydW4oe30sIFtwYXRoLCBmaWxlXSwgc2hvdywgdHJ1ZSkKCX0sCglwcm9maWxlOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciB3aWR0aCA9IGNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV18fChjYW4uQ29uZldpZHRoKCktY2FuLnVpLnByb2plY3Qub2Zmc2V0V2lkdGgpLzIKCQltc2cgJiYgY2FuLm9uaW1wb3J0LnByb2Nlc3MoY2FuLCBtc2csIGNhbi51aS5wcm9maWxlX291dHB1dCwgd2lkdGgtMzIpCgkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9maWxlLCB0cnVlKSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgl9LAoJZGlzcGxheTogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVpZ2h0ID0gY2FuLnByb2ZpbGVfc2l6ZVtjYW4ub25leHBvcnQua2V5cyhjYW4pXXx8e3NoOiBjYW4uQ29uZkhlaWdodCgpLzJ9W2Nhbi5wYXJzZV18fGNhbi5Db25mSGVpZ2h0KCkvNAoJCW1zZyAmJiBjYW4ub25pbXBvcnQucHJvY2VzcyhjYW4sIG1zZywgY2FuLnVpLmRpc3BsYXlfb3V0cHV0LCBjYW4uQ29uZldpZHRoKCkpCgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4udWkuZGlzcGxheV9vdXRwdXQsIGh0bWwuTUFYX0hFSUdIVCwgaGVpZ2h0KQoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkuZGlzcGxheSwgdHJ1ZSksIGNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJfSwKCXRvb2xraXQ6IGZ1bmN0aW9uKGNhbiwgbWV0YSwgY2IpIHsKCQltZXRhLm9wdHMgPSBtZXRhLm9wdHN8fHtyZXBvczogY2FuLmJhc2UudHJpbVN1ZmZpeChjYW4uYmFzZS50cmltUHJlZml4KGNhbi5PcHRpb24obmZzLlBBVEgpLCAidXNyLyIpLCBpY2UuUFMpIH0KCQljYW4ub25pbXBvcnQucGx1Z2luKGNhbiwgbWV0YSwgY2FuLnVpLnRvb2xraXQub3V0cHV0LCBmdW5jdGlvbihzdWIpIHsKCQkJc3ViLkNvbmZIZWlnaHQoY2FuLkNvbmZIZWlnaHQoKS00Kmh0bWwuQUNUSU9OX0hFSUdIVCksIHN1Yi5Db25mV2lkdGgoY2FuLkNvbmZXaWR0aCgpKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIHN1Yi5Db25mSGVpZ2h0KCkpCgkJCXN1Yi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCkpCgkJCXN1Yi5zZWxlY3QgPSBmdW5jdGlvbigpIHsgcmV0dXJuIHN1Yi5fbGVnZW5kLmNsaWNrKCksIHN1YiB9CgoJCQljYW4uX3N0YXR1cy5hcHBlbmRDaGlsZChzdWIuX2xlZ2VuZCksIHN1Yi5fbGVnZW5kLm9uY2xpY2sgPSBmdW5jdGlvbihldmVudCkgewoJCQkJaWYgKGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5fc3RhdHVzLCBpY2UuUFQraHRtbC5TRUxFQ1QpWzBdID09IGV2ZW50LnRhcmdldCkgewoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBldmVudC50YXJnZXQsIGh0bWwuU0VMRUNUKQoJCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBzdWIuX3RhcmdldCwgaHRtbC5TRUxFQ1QpCgkJCQkJcmV0dXJuCgkJCQl9CgkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLl9zdGF0dXMsIGh0bWwuTEVHRU5ELCBldmVudC50YXJnZXQpCgkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLnVpLnRvb2xraXQub3V0cHV0LCBodG1sLkZJRUxEU0VULCBzdWIuX3RhcmdldCkKCQkJCWNhbi5vbm1vdGlvbi5mb2N1cyhjYW4sIGNhbi5wYWdlLlNlbGVjdChjYW4sIHN1Yi5fb3B0aW9uLCBodG1sLk9QVElPTl9BUkdTKVswXSkKCQkJfSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpCgkJCWNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7IGNhbi5vbmFwcGVuZC5fb3B0aW9uKHN1Yiwge2lucHV0czogW3t0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogY2xpLkNMT1NFLCBfY2I6IGZ1bmN0aW9uKCkgewoJCQkJc3ViLl9sZWdlbmQuY2xpY2soKQoJCQl9fV19KSB9KQoJCX0pCgl9LAoJcHJvY2VzczogZnVuY3Rpb24oY2FuLCBtc2csIHRhcmdldCwgd2lkdGgpIHsKCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHRhcmdldCkKCQlpZiAobXNnLk9wdGlvbihpY2UuTVNHX1BST0NFU1MpID09ICJfZmllbGQiKSB7CgkJCW1zZy5UYWJsZShmdW5jdGlvbihtZXRhKSB7IG1ldGEuZGlzcGxheSA9IG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKQoJCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIG1ldGEsIHRhcmdldCwgZnVuY3Rpb24oc3ViKSB7IHdpZHRoICYmIHN1Yi5Db25mV2lkdGgod2lkdGgpCgkJCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgc3ViLl9vcHRpb24sIGh0bWwuT1BUSU9OX0FSR1MpWzBdKQoJCQkJfSkKCQkJfSkKCQl9IGVsc2UgaWYgKG1zZy5PcHRpb24oaWNlLk1TR19ESVNQTEFZKSAhPSAiIikgewoJCQljYW4ub25hcHBlbmQuX291dHB1dChjYW4sIG1zZywgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVkpLCB0YXJnZXQsIGZhbHNlLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJCQl9KQoJCX0gZWxzZSB7CgkJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgbnVsbCwgdGFyZ2V0KQoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2csIHRhcmdldCkKCQl9Cgl9LAoJcGx1Z2luOiBmdW5jdGlvbihjYW4sIG1ldGEsIHRhcmdldCwgY2IpIHsKCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwgbWV0YSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5PcHRpb24oKSkKCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCBtZXRhLmluZGV4XSwgY21kcyksIGNiLCB0cnVlKQoJCQl9LCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKHN1YikKCQl9LCB0YXJnZXQpCgl9LAoJbGF5b3V0OiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgd2lkdGggPSBjYW4uQ29uZldpZHRoKCkrKGNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi51c2VyLm1vZC5pc0NtZCAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAxNjogMCktKGNhbi51c2VyLmlzV2luZG93cyAmJiAhY2FuLnVzZXIubW9kLmlzQ21kPyAyMDogMCkKCQljYW4ucGFnZS5zdHlsZVdpZHRoKGNhbiwgY2FuLnVpLnByb2ZpbGVfb3V0cHV0LCBjYW4ucHJvZmlsZV9zaXplW2Nhbi5vbmV4cG9ydC5rZXlzKGNhbildfHwod2lkdGgtY2FuLnVpLnByb2plY3Qub2Zmc2V0V2lkdGgpLzIpCgkJY2FuLnBhZ2Uuc3R5bGVXaWR0aChjYW4sIGNhbi51aS5jb250ZW50LCB3aWR0aC1jYW4udWkucHJvamVjdC5vZmZzZXRXaWR0aC1jYW4udWkucHJvZmlsZS5vZmZzZXRXaWR0aCkKCQljYW4ucGFnZS5zdHlsZVdpZHRoKGNhbiwgY2FuLnVpLmRpc3BsYXksIHdpZHRoLWNhbi51aS5wcm9qZWN0Lm9mZnNldFdpZHRoKQoKCQlpZiAoIWhlaWdodCAmJiBjYW4uQ29uZigibW9kZSIpID09ICJzaW1wbGUiKSB7IHJldHVybiB9CgkJdmFyIGhlaWdodCA9IGNhbi5Db25mSGVpZ2h0KCktKGNhbi51c2VyLmlzTW9iaWxlICYmIGNhbi51c2VyLm1vZC5pc0NtZD8gKGNhbi51c2VyLmlzTGFuZHNjYXBlKCk/IDE0OiA1NCk6IDApLShjYW4udXNlci5pc1dpbmRvd3M/IDIwOiAwKQoJCWlmICghaGVpZ2h0IHx8IGhlaWdodCA+IHdpbmRvdy5pbm5lckhlaWdodCkgeyBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQgLSAyMDAgfQoJCWlmIChjYW4udXNlci5pc01vYmlsZSAmJiBjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIGhlaWdodCA8IDIwMCkgeyBoZWlnaHQgPSA0MDAgfQoKCQlpZiAoY2FuLnVzZXIubW9kLmlzQ21kKSB7IGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLnByb2plY3QsIGhlaWdodCsyKmh0bWwuQUNUSU9OX0hFSUdIVCkKCQkJaWYgKGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodCkgewoJCQkJdmFyIHJlc3QgPSBjYW4udWkuZGlzcGxheS5vZmZzZXRIZWlnaHQrY2FuLnVpLl9wYXRoLm9mZnNldEhlaWdodCtjYW4udWkuX3RhYnMub2Zmc2V0SGVpZ2h0KzUKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodC1yZXN0KQoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGNhbi51aS5wcm9qZWN0Lm9mZnNldEhlaWdodC1yZXN0K2h0bWwuQUNUSU9OX0hFSUdIVCs2KQoJCQl9IGVsc2UgewoJCQkJdmFyIHJlc3QgPSBjYW4udWkuZGlzcGxheS5vZmZzZXRIZWlnaHQrNQoJCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkuY29udGVudCwgaGVpZ2h0LTgpCgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi51aS5wcm9maWxlX291dHB1dCwgaGVpZ2h0K2h0bWwuQUNUSU9OX0hFSUdIVCs2LTgpCgkJCX0KCQl9IGVsc2UgewoJCQl2YXIgcmVzdCA9IGNhbi51aS5kaXNwbGF5Lm9mZnNldEhlaWdodCtjYW4udWkuX3BhdGgub2Zmc2V0SGVpZ2h0K2Nhbi51aS5fdGFicy5vZmZzZXRIZWlnaHQrNQoJCQljYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5jb250ZW50LCBjYW4udXNlci5tb2QuaXNDbWQgfHwgY2FuLnVzZXIuaXNNb2JpbGU/IGh0bWwuSEVJR0hUOiBodG1sLk1BWF9IRUlHSFQsIGhlaWdodCkKCQkJY2FuLnBhZ2Uuc3R5bGVIZWlnaHQoY2FuLCBjYW4udWkucHJvamVjdCwgY2FuLnVpLmNvbnRlbnQub2Zmc2V0SGVpZ2h0K3Jlc3QpCgkJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QuaGFzKGNhbiwgY2FuLl9maWVsZHMsICJmdWxsIikpIHsKCQkJCWNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnVpLnByb2ZpbGVfb3V0cHV0LCBjYW4udWkuY29udGVudC5vZmZzZXRIZWlnaHQpCgkJCX0gZWxzZSB7CgkJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi51aS5wcm9maWxlX291dHB1dCwgY2FuLnVpLmNvbnRlbnQub2Zmc2V0SGVpZ2h0LWh0bWwuQUNUSU9OX0hFSUdIVC0yKQoJCQl9CgkJfQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGh0bWwuSUZSQU1FLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwKCQkJCWh0bWwuSEVJR0hULCBjYW4udWkucHJvZmlsZV9vdXRwdXQub2Zmc2V0SGVpZ2h0LTQsCgkJCQlodG1sLldJRFRILCBjYW4udWkucHJvZmlsZV9vdXRwdXQub2Zmc2V0V2lkdGgtNSwKCQkJCSJtYXJnaW4tbGVmdCIsICItMTBweCIsICJtYXJnaW4tdG9wIiwgIi0xMHB4IiwKCQkJCSJwb3NpdGlvbiIsICJhYnNvbHV0ZSIsICJib3JkZXIiLCAiMCIKCQkJKQoJCX0pCgl9LAoJZXh0czogZnVuY3Rpb24oY2FuLCB1cmwsIGNiKSB7CgkJY2FuLnJlcXVpcmUoW3VybF0sIGZ1bmN0aW9uKCkge30sIGZ1bmN0aW9uKGNhbiwgbmFtZSwgc3ViKSB7IHN1Yi5faW5pdChjYW4sIGNhbi5iYXNlLlBhcnNlVVJMKHN1Yi5fcGF0aCksIGZ1bmN0aW9uKHN1YikgewoJCQljYW4uZXh0ZW50aW9uc1t1cmwuc3BsaXQoIj8iKVswXV0gPSBzdWIsIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJCX0pIH0pCgl9LAoJc2VzczogZnVuY3Rpb24oY2FuLCBzZXNzLCBjYikgeyBzZXNzID0gc2Vzc3x8Y2FuLmJhc2UuT2JqKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ3ZWIuY29kZS5pbm5lci5zZXNzIiksIHt9KQoJCWNhbi5jb3JlLk5leHQoc2Vzcy5wbHVnLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGNhbi5vbmltcG9ydC50b29sa2l0KGNhbiwge2luZGV4OiBpdGVtfSwgZnVuY3Rpb24oc3ViKSB7IGNhbi50b29sa2l0W2l0ZW1dID0gc3ViLCBuZXh0KCkgfSkgfSwgZnVuY3Rpb24oKSB7CgkJCWNhbi5jb3JlLk5leHQoc2Vzcy5leHRzLCBmdW5jdGlvbihpdGVtLCBuZXh0KSB7IGNhbi5vbmltcG9ydC5leHRzKGNhbiwgaXRlbSwgbmV4dCkgfSwgZnVuY3Rpb24oKSB7CgkJCQljYW4uY29yZS5OZXh0KHNlc3MudGFicywgZnVuY3Rpb24oaXRlbSwgbmV4dCkgeyB2YXIgbHMgPSBpdGVtLnNwbGl0KGljZS5ERik7IGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbHNbMF0sIGxzWzFdLCBsc1syXSwgbmV4dCkgfSwgY2IpCgkJCX0pCgkJfSkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbnN5bnRheCIsIHtoZWxwOiAi6K+t5rOV6auY5LquIiwgbGlzdDogWyJrZXl3b3JkIiwgInByZWZpeCIsICJsaW5lIl0sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHNraXApIHsKCQlpZiAobXNnLk9wdGlvbihjdHguSU5ERVgpKSB7CgkJCWNhbi51aS5fcGF0aC5pbm5lclRleHQgPSBtc2cuT3B0aW9uKG5mcy5GSUxFKQoJCX0gZWxzZSB7CgkJCWNhbi51aS5fcGF0aC5pbm5lclRleHQgPSBjYW4uYmFzZS5QYXRoKG1zZy5PcHRpb24obmZzLlBBVEgpLCBtc2cuT3B0aW9uKG5mcy5GSUxFKSkKCQl9CgoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbihjYWNoZV9kYXRhKSB7CgkJCWNhbi5maWxlICYmIChjYWNoZV9kYXRhW2Nhbi5maWxlXSA9IHtjdXJyZW50OiBjYW4uY3VycmVudCwgbWF4OiBjYW4ubWF4LAoJCQkJcHJvZmlsZV9kaXNwbGF5OiBjYW4udWkucHJvZmlsZS5zdHlsZS5kaXNwbGF5LCBkaXNwbGF5X2Rpc3BsYXk6IGNhbi51aS5kaXNwbGF5LnN0eWxlLmRpc3BsYXksCgkJCX0pCgkJCWNhbi5maWxlID0gY2FuLmJhc2UuUGF0aChtc2cuT3B0aW9uKG5mcy5QQVRIKSwgbXNnLk9wdGlvbihuZnMuRklMRSkpCgkJCWNhbi5wYXJzZSA9IGNhbi5iYXNlLkV4dChjYW4uZmlsZSksIGNhbi5TdGF0dXMoIuaooeW8jyIsICJwbHVnaW4iKQoKCQkJdmFyIHAgPSBjYWNoZV9kYXRhW2Nhbi5maWxlXTsgcCAmJiAoY2FuLmN1cnJlbnQgPSBwLmN1cnJlbnQsIGNhbi5tYXggPSBwLm1heCkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLnByb2ZpbGUsIHtzdHlsZToge2Rpc3BsYXk6IHA/IHAucHJvZmlsZV9kaXNwbGF5OiBodG1sLk5PTkV9fSkKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLmRpc3BsYXksIHtzdHlsZToge2Rpc3BsYXk6IHA/IHAuZGlzcGxheV9kaXNwbGF5OiBodG1sLk5PTkV9fSkKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi5fYWN0aW9uLCBodG1sLkRJVl9UQUJTLCBtc2cuX3RhYikKCQkJY2FuLm9ubW90aW9uLnNlbGVjdChjYW4sIGNhbi51aS5fdGFicywgaHRtbC5ESVZfVEFCUywgbXNnLl90YWIpCgkJCWNhbi5vbm1vdGlvbi5kZWxheShjYW4sIGZ1bmN0aW9uKCkgeyBjYW4ub25pbXBvcnQubGF5b3V0KGNhbikKCQkJCW1zZy5PcHRpb24oY3R4LklOREVYKSAmJiBjYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5PUFRJT05fQVJHUylbMF0pCgkJCX0pCgkJCXJldHVybiBjYW4uZmlsZQoJCX0sIGNhbi51aS5jb250ZW50LCBjYW4udWkucHJvZmlsZV9vdXRwdXQsIGNhbi51aS5kaXNwbGF5X291dHB1dCkgJiYgIXNraXApIHsKCQkJcmV0dXJuIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKG51bGwsIGNhbiwgbXNnLk9wdGlvbihuZnMuTElORSkpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKCkKCQl9CgoJCWlmIChtc2cuT3B0aW9uKGN0eC5JTkRFWCkpIHsKCQkJY2FuLm9uaW1wb3J0LnBsdWdpbihjYW4sIHtpbmRleDogbXNnLk9wdGlvbihjdHguSU5ERVgpfSwgY2FuLnVpLmNvbnRlbnQsIGZ1bmN0aW9uKHN1YikgewoJCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9XSURUSCwgc3ViLkNvbmZXaWR0aChjYW4udWkuY29udGVudC5vZmZzZXRXaWR0aCkpCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIHN1Yi5Db25mSGVpZ2h0KGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodC0yKmh0bWwuQUNUSU9OX0hFSUdIVCkpCgkJCQljYW4ub25tb3Rpb24uZGVsYXkoY2FuLCBmdW5jdGlvbigpIHsKCQkJCQljYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5PUFRJT05fQVJHUylbMF0pCgkJCQl9KSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYigpCgkJCX0pCgkJCXJldHVybgoJCX0KCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmNvbnRlbnQpCgkJZnVuY3Rpb24gaW5pdChwKSB7IGNhbi5tYXggPSAwLCBjYW4uY29yZS5MaXN0KGNhbi5scyA9IG1zZy5SZXN1bHQoKS5zcGxpdChpY2UuTkwpLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5vbmFjdGlvbi5hcHBlbmRMaW5lKGNhbiwgaXRlbSkKCQl9KSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUobnVsbCwgY2FuLCBtc2cuT3B0aW9uKG5mcy5MSU5FKSksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoKQoJCQltc2cuT3B0aW9uKG5mcy5GSUxFKS5pbmRleE9mKCJ3ZWJzaXRlLyIpID09IDAgJiYgY2FuLm9uYWN0aW9uWyLlsZXnpLoiXSh7fSwgY2FuKQoJCQlpZiAoY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGNhbi5fZmllbGRzLCBjaGF0LlBMVUdJTikpIHsKCQkJCXAgJiYgcC5yZW5kZXIgJiYgY2FuLm9uYWN0aW9uWyLlsZXnpLoiXSh7fSwgY2FuKQoJCQkJcCAmJiBwLmVuZ2luZSAmJiBjYW4ub25hY3Rpb25bIuaJp+ihjCJdKHt9LCBjYW4pCgkJCX0KCQkJY2FuLm9uaW1wb3J0LmxheW91dChjYW4pCgkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhjYW4sIGNhbi5fZmllbGRzLCBjaGF0LlNUT1JZKSAmJiAhY2FuLnVzZXIubW9kLmlzQ21kKSB7CgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5wcm9qZWN0LCBodG1sLk1JTl9IRUlHSFQsIGNhbi5Db25mSGVpZ2h0KCktMjAwKQoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5NSU5fSEVJR0hULCBjYW4uQ29uZkhlaWdodCgpLTIwMCkKCQkJfQoJCX0KCQljYW4uQ29uZigicGx1ZyIpICYmIChjYW4ub25zeW50YXhbY2FuLnBhcnNlXSA9IGNhbi5Db25mKCJwbHVnIikpCgkJdmFyIHAgPSBjYW4ub25zeW50YXhbY2FuLnBhcnNlXTsgIXA/IGNhbi5ydW4oe30sIFtjdHguQUNUSU9OLCBtZGIuUExVR0lOLCBjYW4ucGFyc2UsIG1zZy5PcHRpb24obmZzLkZJTEUpLCBtc2cuT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgewoJCQlpbml0KHAgPSBjYW4ub25zeW50YXhbY2FuLnBhcnNlXSA9IGNhbi5iYXNlLk9iaihtc2cuUmVzdWx0KCkpKQoJCX0sIHRydWUpOiBpbml0KHApCgl9LAoJX3BhcnNlOiBmdW5jdGlvbihjYW4sIGxpbmUpIHsgaWYgKGxpbmUuaW5kZXhPZigiPGh0bWwiKSA9PSAwKSB7IHJldHVybiBsaW5lIH0KCQlsaW5lID0gY2FuLnBhZ2UucmVwbGFjZShjYW4sIGxpbmV8fCIiKQoKCQlmdW5jdGlvbiB3cmFwKHR5cGUsIHN0cikgeyByZXR1cm4gdHlwZT8gJzxzcGFuIGNsYXNzPSInK3R5cGUrJyI+JytzdHIrJzwvc3Bhbj4nOiBzdHIgfQoJCXZhciBwID0gY2FuLm9uc3ludGF4W2Nhbi5wYXJzZV07IGlmICghcCkgeyByZXR1cm4gbGluZSB9IHAgPSBjYW4ub25zeW50YXhbcC5saW5rXXx8cCwgcC5zcGxpdCA9IHAuc3BsaXR8fHt9CgkJcC5rZXl3b3JkICYmIChsaW5lID0gY2FuLmNvcmUuTGlzdChjYW4uY29yZS5TcGxpdChsaW5lLCBwLnNwbGl0LnNwYWNlfHwiXHQgIiwgcC5zcGxpdC5vcGVyYXRvcnx8IntbKC4sOjshfDw+KV19Iiwge2RldGFpbDogdHJ1ZX0pLCBmdW5jdGlvbihpdGVtLCBpbmRleCwgYXJyYXkpIHsKCQkJaXRlbSA9IGNhbi5iYXNlLmlzT2JqZWN0KGl0ZW0pPyBpdGVtOiB7dGV4dDogaXRlbX0KCQkJdmFyIHRleHQgPSBpdGVtLnRleHQ7IHZhciB0eXBlID0gaXRlbS5rZXl3b3JkfHxwLmtleXdvcmRbdGV4dF0KCgkJCXN3aXRjaCAoaXRlbS50eXBlKSB7IGNhc2UgaHRtbC5TUEFDRTogcmV0dXJuIHRleHQKCQkJCWNhc2UgbGFuZy5TVFJJTkc6IHJldHVybiB3cmFwKGxhbmcuU1RSSU5HLCBpdGVtLmxlZnQrdGV4dCtpdGVtLnJpZ2h0KQoJCQkJZGVmYXVsdDogcmV0dXJuIHdyYXAodHlwZSwgdGV4dCkKCQkJfQoJCX0pLmpvaW4oIiIpKQoKCQlwLnByZWZpeCAmJiBjYW4uY29yZS5JdGVtKHAucHJlZml4LCBmdW5jdGlvbihwcmUsIHR5cGUpIHsKCQkJaWYgKGNhbi5iYXNlLmJlZ2luV2l0aChsaW5lLCBwcmUpKSB7CgkJCQlsaW5lID0gd3JhcCh0eXBlLCBsaW5lKQoJCQl9IGVsc2UgewoJCQkJdmFyIGxzID0gbGluZS5zcGxpdChwcmUpOyBpZiAobHMubGVuZ3RoID4gMSkgewoJCQkJCWxpbmUgPSBsc1swXSArIHdyYXAodHlwZSwgcHJlICsgbHNbMV0pCgkJCQl9CgkJCX0KCQl9KQoJCXAuc3VmZml4ICYmIGNhbi5jb3JlLkl0ZW0ocC5zdWZmaXgsIGZ1bmN0aW9uKGVuZCwgdHlwZSkgewoJCQlpZiAoY2FuLmJhc2UuZW5kV2l0aChsaW5lLCBlbmQpKSB7IGxpbmUgPSB3cmFwKHR5cGUsIGxpbmUpIH0KCQl9KQoJCXJldHVybiBsaW5lCgl9LAp9KQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIuWvvOWFpeaVsOaNriIsIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgY2IsIHRhcmdldCkgewoJfSwKCV9wbHVnaW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHt9LAoJX25vcm1hbDogZnVuY3Rpb24oZXZlbnQsIGNhbikge30sCglfaW5zZXJ0OiBmdW5jdGlvbihldmVudCwgY2FuKSB7fSwKCV9tb2RlOiB7CgkJcGx1Z2luOiB7CgkJCUVzY2FwZTogc2h5KCLmuIXlsY8iLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5riF5bGPIikgfSksCgkJCWc6IHNoeSgi5pCc57SiIiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuaQnOe0oiIpIH0pLAoJCQlmOiBzaHkoIuaJk+W8gOaWh+S7tiIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmiZPlvIAiKSB9KSwKCQkJdDogc2h5KCLmt7vliqDlkb3ku6QiLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5re75YqgIikgfSksCgkJCXA6IHNoeSgi5re75Yqg5o+S5Lu2IiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuaPkuS7tiIpIH0pLAoJCQllOiBzaHkoIua3u+WKoOaJqeWxlSIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmianlsZUiKSB9KSwKCgkJCW06IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICJhdXRvZ2VuIikgfSwKCQkJYzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgImNvbXBpbGUiKSB9LAoJCQl3OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAid2Vic2l0ZSIpIH0sCgoJCQlyOiBzaHkoIuaJp+ihjOWRveS7pCIsIGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmFjdGlvbnMoZXZlbnQsICLmiafooYwiKSB9KSwKCQkJdjogc2h5KCLlsZXnpLoiLCBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5hY3Rpb25zKGV2ZW50LCAi5bGV56S6IikgfSksCgkJCWE6IHNoeSgi5YWo5bGPIiwgZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uYWN0aW9ucyhldmVudCwgIuWFqOWxjyIpIH0pLAoKCQkJajogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uY3VycmVudC5zY3JvbGwoMSkgfSwKCQkJazogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uY3VycmVudC5zY3JvbGwoLTEpIH0sCgkJCUo6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKGNhbi5jdXJyZW50LndpbmRvdygpLTMpIH0sCgkJCUs6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKC1jYW4uY3VycmVudC53aW5kb3coKSszKSB9LAoKCQkJaTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuX2luc2VydChldmVudCwgY2FuKSB9LAoJCQluOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fbm9ybWFsKGV2ZW50LCBjYW4pIH0sCgkJCSI6IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIHtpbmRleDogImNsaS5zeXN0ZW0ifSwgZnVuY3Rpb24oc3ViKSB7IGNhbi50b29sa2l0WyJjbGkuc3lzdGVtIl0gPSBzdWIuc2VsZWN0KCkgfSkgfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5o6n5Lu25Lqk5LqSIiwgbGlzdDogWyLmkJzntKIiLCAi5omT5byAIiwgIua3u+WKoCIsICLmj5Lku7YiLCAi5omp5bGVIl0sCglfdHJhbnM6IHt3aWR0aDogIuWuveW6piIsIGhlaWdodDogIumrmOW6piIsIHdlYnNpdGU6ICLnvZHpobUifSwKCSLliqDovb0iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIGZpbGUgPSBjYW4uYmFzZS5QYXRoKCIvcmVxdWlyZS8iLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgY2FuLk9wdGlvbihuZnMuRklMRSkpCgkJZGVsZXRlKFZvbGNhbm9zLm1ldGEuY2FjaGVbZmlsZV0pLCBldmFsKGBcbl9jYW5fbmFtZSA9ICJgK2ZpbGUrYCJcbmArY2FuLm9uZXhwb3J0LmNvbnRlbnQoY2FuKStgXG5fY2FuX25hbWUgPSAiIlxuY29uc29sZS5sb2coIm9uY2UiKWApCgl9LAoJIuWIt+aWsCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCAic3JjLyIsICJtYWluLmdvIiwgIiIsIGZ1bmN0aW9uKCkge30sIHNraXApIH0sCgki5pCc57SiIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIFttZGIuTkFNRSwgW2N0eC5BQ1RJT04sIG5mcy5UQUdTLCBuZnMuR1JFUCwgY2xpLk1BS0VdXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQljYW4udWkuc2VhcmNoLlVwZGF0ZSh7fSwgW2N0eC5BQ1RJT04sIGRhdGEuYWN0aW9uLCBkYXRhLm5hbWVdKQoJCX0pCgl9LAoJIuaJk+W8gCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbbmZzLkZJTEVdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGRhdGEuZmlsZSkKCQkJY2FuLm9uaW1wb3J0LnByb2plY3QoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkKCQl9KQoJfSwKCSLmt7vliqAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW2N0eC5JTkRFWF0sIGZ1bmN0aW9uKGV2ZW50LCBidXR0b24sIGRhdGEpIHsKCQkJY2FuLm9uaW1wb3J0LnRhYnZpZXcoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSwgZGF0YS5pbmRleCwgY3R4LklOREVYKQoJCX0pCgl9LAoJIuaPkuS7tiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbY3R4LklOREVYXSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQl2YXIgc3ViID0gY2FuLnRvb2xraXRbZGF0YS5pbmRleF07IGlmIChzdWIpIHsgc3ViLnNlbGVjdCgpOyByZXR1cm4gfQoJCQljYW4ub25pbXBvcnQudG9vbGtpdChjYW4sIGRhdGEsIGZ1bmN0aW9uKHN1YikgeyBjYW4udG9vbGtpdFtkYXRhLmluZGV4XSA9IHN1Yi5zZWxlY3QoKSB9KQoJCX0pCgl9LAoJIuaJqeWxlSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBbInVybCJdLCBmdW5jdGlvbihldmVudCwgYnV0dG9uLCBkYXRhKSB7CgkJCXZhciBzdWIgPSBjYW4uZXh0ZW50aW9uc1tkYXRhLnVybF07IGlmIChzdWIpIHsgc3ViLnNlbGVjdCgpOyByZXR1cm4gfQoJCQljYW4ub25pbXBvcnQuZXh0cyhjYW4sIGRhdGEudXJsLCBmdW5jdGlvbihzdWIpIHsgY2FuLmV4dGVudGlvbnNbZGF0YS51cmxdID0gc3ViLnNlbGVjdCgpIH0pCgkJfSkKCX0sCgki5L+d5a2YIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25leHBvcnQuc2VzcyhjYW4pLCBjYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSB9LAoJIumhueebriI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi51aS5wcm9qZWN0KSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIH0sCgki5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLnVpLnRvb2xraXQuZmllbGRzZXQpIH0sCgki5omn6KGMIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25pbXBvcnQuZGlzcGxheShjYW4pLCBjYW4ucmVxdWVzdChldmVudCwge190b2FzdDogIuaJp+ihjOS4rS4uLiJ9KQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuRU5HSU5FLCBjYW4ucGFyc2UsIGNhbi5PcHRpb24obmZzLkZJTEUpLCBjYW4uT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQuX3N0YXR1cyhjYW4sIG1zZy5PcHRpb24oaWNlLk1TR19TVEFUVVMpLCBjYW4udWkuZGlzcGxheV9zdGF0dXMpCgkJCWNhbi5vbmltcG9ydC5kaXNwbGF5KGNhbiwgbXNnKSwgY2FuLm9uaW1wb3J0LmxheW91dChjYW4pIAoJCX0sIHRydWUpCgl9LAoJIuWxleekuiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0LnByb2ZpbGUoY2FuKSwgY2FuLnJlcXVlc3QoZXZlbnQsIHtfdG9hc3Q6ICLmuLLmn5PkuK0uLi4ifSkKCQlpZiAoY2FuLk9wdGlvbihuZnMuRklMRSkuaW5kZXhPZigid2Vic2l0ZS8iKSA9PSAwKSB7CgkJCWNhbi5wcm9maWxlX3NpemVbY2FuLm9uZXhwb3J0LmtleXMoY2FuKV0gPSBjYW4ucHJvZmlsZV9zaXplW2Nhbi5vbmV4cG9ydC5rZXlzKGNhbildIHx8IGNhbi5Db25mV2lkdGgoKSpwYXJzZUludCg3MCkvMTAwCgkJfQoJCWNhbi5wYXJzZSA9PSAianMiICYmIGNhbi5vbmFjdGlvblsi5Yqg6L29Il0oZXZlbnQsIGNhbikKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlJFTkRFUiwgY2FuLnBhcnNlLCBjYW4uT3B0aW9uKG5mcy5GSUxFKSwgY2FuLk9wdGlvbihuZnMuUEFUSCldLCBmdW5jdGlvbihtc2cpIHsKCQkJY2FuLm9uaW1wb3J0LnByb2ZpbGUoY2FuLCBtc2cpCgkJfSwgdHJ1ZSkKCX0sCgki5riF5bGPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBkb2N1bWVudC5ib2R5LCAiLmlucHV0LmZsb2F0IiwgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgaXRlbSkKCQl9KS5sZW5ndGggPiAwKSB7IHJldHVybiB9CgoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkudG9vbGtpdC5zdGF0dXMsICJsZWdlbmQuc2VsZWN0IiwgZnVuY3Rpb24oaXRlbSkgewoJCQlyZXR1cm4gaXRlbS5jbGljaygpLCBpdGVtCgkJfSkubGVuZ3RoID4gMCkgeyByZXR1cm4gfQoJCWlmIChjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX3N0YXR1cywgImxlZ2VuZC5zZWxlY3QiLCBmdW5jdGlvbihpdGVtKSB7CgkJCXJldHVybiBpdGVtLmNsaWNrKCksIGl0ZW0KCQl9KS5sZW5ndGggPiAwKSB7IHJldHVybiB9CgoJCWlmIChjYW4udWkucHJvZmlsZS5zdHlsZS5kaXNwbGF5ID09ICIiKSB7CgkJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkucHJvZmlsZSkKCQl9IGVsc2UgaWYgKGNhbi51aS5kaXNwbGF5LnN0eWxlLmRpc3BsYXkgPT0gIiIpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCX0gZWxzZSBpZiAoY2FuLnVpLnByb2plY3Quc3R5bGUuZGlzcGxheSA9PSAiIikgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2plY3QpCgkJfSBlbHNlIHsKCQkJY2FuLm9uYWN0aW9uWyLlhajlsY8iXShldmVudCwgY2FuKQoJCX0KCQljYW4ub25pbXBvcnQubGF5b3V0KGNhbikKCX0sCgki5YWo5bGPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgY2FuLl9maWVsZHMsICJmdWxsIikpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQpCgkJfSBlbHNlIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0LCB0cnVlKQoJCQljYW4uQ29uZkhlaWdodCh3aW5kb3cuaW5uZXJIZWlnaHQtMipodG1sLkFDVElPTl9IRUlHSFQpCgkJfQoJCWNhbi5vbmltcG9ydC5sYXlvdXQoY2FuKQoJfSwKCWJhY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLmhpc3RvcnkucG9wKCk7IHZhciBsYXN0ID0gY2FuLmhpc3RvcnkucG9wKCkKCQlsYXN0ICYmIGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbGFzdC5wYXRoLCBsYXN0LmZpbGUsIGxhc3QubGluZSkKCQljYW4uU3RhdHVzKCLot7PovazmlbAiLCBjYW4uaGlzdG9yeS5sZW5ndGgpCgl9LAoKCXNjcm9sbExpbmU6IGZ1bmN0aW9uKGNhbiwgY291bnQpIHsgdmFyIHNpemUgPSAyMDsgY2FuLmN1cnJlbnQuc2Nyb2xsKGNvdW50KnNpemUpIH0sCglhcHBlbmRMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7CgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmNvbnRlbnQsIFt7dHlwZTogaHRtbC5UUiwgbGlzdDogWwoJCQl7dmlldzogWyJsaW5lIHVuc2VsZWN0YWJsZSIsIGh0bWwuVEQsICsrY2FuLm1heF0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCB1aS50cikKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbi5mYXZvckxpbmUoY2FuLCB1aS50ZXh0LmlubmVyVGV4dCkKCQkJfX0sCgoJCQl7dmlldzogW2h0bWwuVEVYVCwgaHRtbC5URF0sIGxpc3Q6IFtjYW4ub25zeW50YXguX3BhcnNlKGNhbiwgdmFsdWUpXSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIHVpLnRyKQoKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciBzID0gZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKCkudG9TdHJpbmcoKSwgc3RyID0gdWkudGV4dC5pbm5lclRleHQKCQkJCXZhciBiZWdpbiA9IHN0ci5pbmRleE9mKHMpLCBlbmQgPSBiZWdpbitzLmxlbmd0aAoKCQkJCWZvciAodmFyIGkgPSBiZWdpbjsgaSA+PSAwOyBpLS0pIHsKCQkJCQlpZiAoc3RyW2ldLm1hdGNoKC9bYS16QS1aMC05Xy5dLykpIHsgcyA9IHN0ci5zbGljZShpLCBlbmQpIH0gZWxzZSB7IGJyZWFrIH0KCQkJCX0KCgkJCQlpZiAocy5pbmRleE9mKCJraXQuIikgPT0gMCkgeyBzID0gcy5yZXBsYWNlKCJraXQuIiwgInRvb2xraXRzLiIpIH0KCQkJCWlmIChzLmluZGV4T2YoIi4iKSA9PSAwKSB7IHMgPSBzLnNsaWNlKDEpIH0KCQkJCWNhbi5vbmFjdGlvbi5zZWFyY2hMaW5lKGV2ZW50LCBjYW4sIHMpCgkJCX19CgkJXX1dKTsgcmV0dXJuIHVpLnRyCgl9LAoJX2dldExpbmU6IGZ1bmN0aW9uKGNhbiwgbGluZSkgewoJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycmF5KSB7IGlmIChpdGVtID09IGxpbmUgfHwgaW5kZXgrMSA9PSBsaW5lKSB7IHJldHVybiBpdGVtIH0gfSlbMF0KCX0sCglfZ2V0TGluZW5vOiBmdW5jdGlvbihjYW4sIGxpbmUpIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVFIsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnJheSkgeyBpZiAoaXRlbSA9PSBsaW5lIHx8IGluZGV4KzEgPT0gbGluZSkgeyByZXR1cm4gaW5kZXgrMSB9IH0pWzBdCgl9LAoJc2VsZWN0TGluZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbGluZSkgeyBpZiAoIWxpbmUpIHsgcmV0dXJuIHBhcnNlSW50KGNhbi5jb3JlLlZhbHVlKGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBbW1todG1sLlRSLCBodG1sLlNFTEVDVF0sIFtodG1sLlRELCAibGluZSJdXV0pWzBdLCAiaW5uZXJUZXh0IikpIH0KCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycmF5KSB7IGlmIChsaW5lIDwgMCB8fCBsaW5lID4gYXJyYXkubGVuZ3RoKSB7IHJldHVybiB9CgkJCWlmICghY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIGl0ZW0sIGh0bWwuU0VMRUNULCBpdGVtID09IGxpbmUgfHwgaW5kZXgrMSA9PSBsaW5lKSkgeyByZXR1cm4gfQoJCQl2YXIgbHMgPSBjYW4uZmlsZS5zcGxpdChpY2UuUFMpCgkJCWlmIChscy5sZW5ndGggPiA0KSB7IGxzID0gW2xzLnNsaWNlKDAsIDIpLmpvaW4oaWNlLlBTKSsiLy4uLi8iK2xzLnNsaWNlKC0yKS5qb2luKGljZS5QUyldIH0KCQkJbGluZSA9IGl0ZW0sIGNhbi5TdGF0dXMoa2l0LkRpY3QoIuaWh+S7tuWQjSIsIGxzLmpvaW4oaWNlLlBTKSwgIuino+aekOWZqCIsIGNhbi5wYXJzZSwgIuW9k+WJjeihjCIsIGNhbi5vbmV4cG9ydC5wb3NpdGlvbihjYW4sIGNhbi5PcHRpb24obmZzLkxJTkUsIGluZGV4KzEpKSkpCgkJfSkKCgkJY2FuLmJhc2UuaXNPYmplY3QobGluZSkgJiYgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgbGluZSwgInRkLnRleHQiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5jdXJyZW50ID0gewoJCQkJd2luZG93OiBmdW5jdGlvbigpIHsgcmV0dXJuIHBhcnNlSW50KGNhbi51aS5jb250ZW50Lm9mZnNldEhlaWdodC9jYW4uY3VycmVudC5saW5lLm9mZnNldEhlaWdodCkgfSwKCQkJCXNjcm9sbDogZnVuY3Rpb24oY291bnQpIHsgaWYgKGNvdW50KSB7IGNhbi51aS5jb250ZW50LnNjcm9sbFRvcCArPSBjb3VudCpjYW4uY3VycmVudC5saW5lLm9mZnNldEhlaWdodCB9CgkJCQkJcmV0dXJuIHBhcnNlSW50KChjYW4uY3VycmVudC5saW5lLm9mZnNldFRvcC1jYW4udWkuY29udGVudC5zY3JvbGxUb3ApL2Nhbi5jdXJyZW50LmxpbmUub2Zmc2V0SGVpZ2h0KQoJCQkJfSwKCgkJCQlwcmV2OiBmdW5jdGlvbigpIHsgcmV0dXJuIGxpbmUucHJldmlvdXNTaWJsaW5nIH0sCgkJCQluZXh0OiBmdW5jdGlvbigpIHsgcmV0dXJuIGxpbmUubmV4dFNpYmxpbmcgfSwKCQkJCWxpbmU6IGxpbmUsIHRleHQ6IGZ1bmN0aW9uKHRleHQpIHsKCQkJCQlyZXR1cm4gdGV4dCAhPSB1bmRlZmluZWQgJiYgY2FuLm9uYWN0aW9uLm1vZGlmeUxpbmUoY2FuLCBsaW5lLCB0ZXh0KSwgaXRlbS5pbm5lclRleHQKCQkJCX0sCgkJCX0KCgkJCWlmICghZXZlbnQpIHsKCQkJCXZhciBzY3JvbGwgPSBjYW4uY3VycmVudC5zY3JvbGwoKTsgaWYgKHNjcm9sbCA8IDUpIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKHNjcm9sbC01KSB9IGVsc2UgewoJCQkJCXZhciB3aW5kb3cgPSBjYW4uY3VycmVudC53aW5kb3coKTsgaWYgKHNjcm9sbCA+IHdpbmRvdy8yKSB7IGNhbi5jdXJyZW50LnNjcm9sbChzY3JvbGwtd2luZG93LzIpIH0KCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXZhciBzY3JvbGwgPSBjYW4uY3VycmVudC5zY3JvbGwoKTsgaWYgKHNjcm9sbCA8IDMpIHsgY2FuLmN1cnJlbnQuc2Nyb2xsKHNjcm9sbC0zKSB9IGVsc2UgewoJCQkJCXZhciB3aW5kb3cgPSBjYW4uY3VycmVudC53aW5kb3coKTsgaWYgKHNjcm9sbCA+IHdpbmRvdy00KSB7IGNhbi5jdXJyZW50LnNjcm9sbChzY3JvbGwtd2luZG93KzQpIH0KCQkJCX0KCQkJfQoKCQkJdmFyIHB1c2ggPSB7cGF0aDogY2FuLk9wdGlvbihuZnMuUEFUSCksIGZpbGU6IGNhbi5PcHRpb24obmZzLkZJTEUpLCBsaW5lOiBjYW4uT3B0aW9uKG5mcy5MSU5FKSwgdGV4dDogY2FuLmN1cnJlbnQudGV4dCgpfQoJCQljYW4uYmFzZS5FcSh7cGF0aDogcHVzaC5wYXRoLCBmaWxlOiBwdXNoLmZpbGUsIGxpbmU6IHB1c2gubGluZX0sIGNhbi5oaXN0b3J5W2Nhbi5oaXN0b3J5Lmxlbmd0aC0xXSkgfHwgY2FuLmhpc3RvcnkucHVzaChwdXNoKQoJCQljYW4uU3RhdHVzKCLot7PovazmlbAiLCBjYW4uaGlzdG9yeS5sZW5ndGgpCgkJCWNhbi5vbmFjdGlvbi5fc2VsZWN0TGluZShldmVudCwgY2FuKQoJCX0pCgl9LAoJX3NlbGVjdExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgfSwKCXNlYXJjaExpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHZhbHVlKSB7IGlmICghY2FuLnVpLnNlYXJjaCkgeyByZXR1cm4gfQoJCWNhbi51aS5zZWFyY2guVXBkYXRlKGV2ZW50LCBbY3R4LkFDVElPTiwgbmZzLlRBR1MsIHZhbHVlLnRyaW0oKV0pCgl9LAoJZmF2b3JMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7CgkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3tuYW1lOiAiem9uZSIsIHZhbHVlOiAiaGkifSwge25hbWU6ICJuYW1lIiwgdmFsdWU6ICJoZWxsbyJ9XSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSkgewoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgY29kZS5GQVZPUiwgY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgbWRiLlpPTkUsIGRhdGEuem9uZXx8IiIsCgkJCQltZGIuVFlQRSwgY2FuLnBhcnNlLCBtZGIuTkFNRSwgZGF0YS5uYW1lfHwiIiwgbWRiLlRFWFQsICh2YWx1ZXx8IiIpLnRyaW1SaWdodCgpLAoJCQkJbmZzLlBBVEgsIGNhbi5PcHRpb24obmZzLlBBVEgpLCBuZnMuRklMRSwgY2FuLk9wdGlvbihuZnMuRklMRSksIG5mcy5MSU5FLCBjYW4uT3B0aW9uKG5mcy5MSU5FKSwKCQkJXSwgZnVuY3Rpb24obXNnKSB7IGNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pIH0sIHRydWUpCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogWyLmlofku7bmlbAiLCAi6Kej5p6Q5ZmoIiwgIuaWh+S7tuWQjSIsICLlvZPliY3ooYwiLCAi6Lez6L2s5pWwIiwgIuagh+etvuaVsCJdLAoJc2VzczogZnVuY3Rpb24oY2FuKSB7CgkJbG9jYWxTdG9yYWdlLnNldEl0ZW0oIndlYi5jb2RlLmlubmVyLnNlc3MiLCBKU09OLnN0cmluZ2lmeSh7CgkJCSJ0YWJzIjogY2FuLm9uZXhwb3J0LnRhYnMoY2FuKSwgInBsdWciOiBjYW4ub25leHBvcnQucGx1ZyhjYW4pLCAiZXh0cyI6IGNhbi5vbmV4cG9ydC5leHRzKGNhbiksCgkJfSkpCgl9LAoJa2V5czogZnVuY3Rpb24oY2FuLCBmaWxlLCBwYXRoKSB7IHJldHVybiAocGF0aHx8Y2FuLk9wdGlvbihuZnMuUEFUSCkpKyI6IisoZmlsZXx8Y2FuLk9wdGlvbihuZnMuRklMRSkpIH0sCgl0YWJzOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnRhYnZpZXcsIGZ1bmN0aW9uKGtleSwgbXNnKSB7IHJldHVybiBrZXkraWNlLkRGK21zZy5PcHRpb24obmZzLkxJTkUpIH0pIH0sCglwbHVnOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnRvb2xraXQpIH0sCglleHRzOiBmdW5jdGlvbihjYW4pIHsgcmV0dXJuIGNhbi5jb3JlLkl0ZW0oY2FuLnBsdWdpbnMpIH0sCglwb3NpdGlvbjogZnVuY3Rpb24oY2FuLCBpbmRleCwgdG90YWwpIHsgdG90YWwgPSB0b3RhbHx8Y2FuLm1heAoJCXJldHVybiAocGFyc2VJbnQoaW5kZXgpKStpY2UuUFMrcGFyc2VJbnQodG90YWwpKyIgPSAiK3BhcnNlSW50KChpbmRleCkqMTAwL3RvdGFsKSsiJSIKCX0sCgljb250ZW50OiBmdW5jdGlvbihjYW4pIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ZC50ZXh0IiwgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gaXRlbS5pbm5lclRleHQgfSkuam9pbihpY2UuTkwpCgl9LAp9KQoK",
        "/plugin/local/code/inner/favor.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYikgewoJY2FuLm9uaW1wb3J0LnRvb2xraXQoY2FuLCB7aW5kZXg6ICJ3ZWIuY29kZS5mYXZvciJ9LCBmdW5jdGlvbihzdWIpIHsKCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQkJaWYgKGNhbi5taXNjLnJ1bkFjdGlvbihjYW4sIG1zZywgY21kcywgY2IsIGtpdC5EaWN0KAoJCQkJY29kZS5JTk5FUiwgZnVuY3Rpb24oY21kcykgewoJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgbXNnLk9wdGlvbihuZnMuUEFUSCksIG1zZy5PcHRpb24obmZzLkZJTEUpLCBtc2cuT3B0aW9uKG5mcy5MSU5FKSkKCQkJCX0sCgkJCSkpKSB7IHJldHVybiB9CgoJCQljYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbY3R4LkFDVElPTiwgY29kZS5GQVZPUl0sIGNtZHMpLCBmdW5jdGlvbihtc2cpIHsgdmFyIHN1YiA9IG1zZy5fY2FuCgkJCQlzdWIub25tb3Rpb24uY2xlYXIoc3ViKSwgc3ViLm9uYXBwZW5kLnRhYmxlKHN1YiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSkgewoJCQkJCWlmIChtc2cuYXBwZW5kLmxlbmd0aCA9PSAyICYmIG1zZy5hcHBlbmRbMF0gPT0gbWRiLktFWSAmJiBtc2cuYXBwZW5kWzFdID09IG1kYi5WQUxVRSkgewoJCQkJCQlpZiAoa2V5ID09IG1kYi5WQUxVRSkgeyBrZXkgPSBsaW5lLmtleSB9CgkJCQkJfQoJCQkJCWlmIChrZXkgIT0gY3R4LkFDVElPTikgeyB2YWx1ZSA9IHN1Yi5wYWdlLnJlcGxhY2Uoc3ViLCB2YWx1ZSwgaWNlLlBXRCwgIiIpIH0KCgkJCQkJcmV0dXJuIHt0ZXh0OiBbIiIsIGh0bWwuVERdLCBsaXN0OiBbe3RleHQ6IFt2YWx1ZSwgaHRtbC5ESVZdfV0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQkJCQkJaWYgKFttZGIuWk9ORSwgbWRiLklEXS5pbmRleE9mKGtleSkgPiAtMSkgeyByZXR1cm4gc3ViLm9uYWN0aW9uLmNoYW5nZShldmVudCwgc3ViLCBrZXksIHZhbHVlKSB9CgoJCQkJCQlpZiAodGFyZ2V0LnRhZ05hbWUgPT0gIklOUFVUIiAmJiB0YXJnZXQudHlwZSA9PSBodG1sLkJVVFRPTikgeyB2YXIgbXNnID0gc3ViLnJlcXVlc3QoZXZlbnQsIGxpbmUsIHN1Yi5PcHRpb24oKSkKCQkJCQkJCXJldHVybiBzdWIucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgdGFyZ2V0Lm5hbWVdLCBmdW5jdGlvbihtc2cpIHsgc3ViLnJ1bigpIH0sIHRydWUpCgkJCQkJCX0KCgkJCQkJCWxpbmUubGluZSAmJiBjYW4ub25pbXBvcnQudGFidmlldyhjYW4sIGxpbmUucGF0aCwgbGluZS5maWxlLnJlcGxhY2UoaWNlLlBXRCwgIiIpLCBwYXJzZUludChsaW5lLmxpbmUpKQoJCQkJCX19CgkJCQl9LCBzdWIuX291dHB1dCksIHN1Yi5vbmFwcGVuZC5fc3RhdHVzKHN1YiwgbXNnLk9wdGlvbihpY2UuTVNHX1NUQVRVUykpLCBjYW4uU3RhdHVzKCLmoIfnrb7mlbAiLCBtc2cuTGVuZ3RoKCkpCgkJCX0sIHRydWUpCgkJfSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpCgl9KQp9fSkKCg==",
        "/plugin/local/code/inner/search.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYikgeyB2YXIgaGlzdG9yeSA9IFtdOyBjb25zdCBTRUFSQ0ggPSAiY2FuLmNvZGUuaW5uZXIuc2VhcmNoIgoJZnVuY3Rpb24gc2hvdyhtc2csIHdvcmQpIHsgaWYgKCFtc2cpIHsgcmV0dXJuIH0gaGlzdG9yeS5wdXNoKG1zZyk7IHZhciBzdWIgPSBtc2cuX2Nhbjsgc3ViLk9wdGlvbigid29yZCIsIHdvcmR8fG1zZy5fd29yZCkKCQkhc3ViLnBhZ2UuQ2xhc3NMaXN0LmhhcyhzdWIsIHN1Yi5fbGVnZW5kLCAic2VsZWN0IikgJiYgY2FuLnVpLnNlYXJjaC5zZWxlY3QoKQoJCXN1Yi5vbm1vdGlvbi5jbGVhcihzdWIpLCBzdWIub25hcHBlbmQudGFibGUoc3ViLCBtc2csIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKSB7CgkJCXJldHVybiB7dGV4dDogWyIiLCBodG1sLlREXSwgbGlzdDogW3t0ZXh0OiBbY2FuLnBhZ2UucmVwbGFjZShjYW4sIHZhbHVlLCBpY2UuUFdELCAiIiksIGh0bWwuRElWXX1dLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJbGluZS5saW5lICYmIGNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGxpbmUuZmlsZS5yZXBsYWNlKGljZS5QV0QsICIiKSwgcGFyc2VJbnQobGluZS5saW5lKSkKCQkJfX0KCQl9LCBzdWIuX291dHB1dCksIHN1Yi5vbmFwcGVuZC5ib2FyZChzdWIsIG1zZy5SZXN1bHQoKSksIHN1Yi5vbmFwcGVuZC5fc3RhdHVzKHN1YiwgbXNnLk9wdGlvbihpY2UuTVNHX1NUQVRVUykpLCBjYW4uU3RhdHVzKCLmoIfnrb7mlbAiLCBtc2cuTGVuZ3RoKCkpCgl9CgljYW4ub25lbmdpbmUucGx1Z2luKGNhbiwgU0VBUkNILCBzaHkoIuaQnOe0oiIsIHt9LCBbCgkJe3R5cGU6IGh0bWwuVEVYVCwgbmFtZTogIndvcmQiLCB2YWx1ZTogY2xpLk1BSU4sIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQljYW4ub25tb3Rpb24uc2VsZWN0VGFibGUoZXZlbnQsIGNhbi5zdXAsIGV2ZW50LnRhcmdldCwgZnVuY3Rpb24odHIpIHsKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCBodG1sLlRELCBmdW5jdGlvbih0ZCwgaW5kZXgpIHsgaW5kZXggPT0gMCAmJiB0ZC5jbGljaygpIH0pCgkJCQl0ci5zY3JvbGxJbnRvVmlldygpLCBjYW4uX291dHB1dC5zY3JvbGxUb3AgLT0gNjAKCQkJfSkKCQkJaWYgKGV2ZW50LmtleSA9PSBsYW5nLkVOVEVSKSB7IGNhbi5zdXAuVXBkYXRlKGV2ZW50LCBbY3R4LkFDVElPTiwgZXZlbnQuY3RybEtleT8gbmZzLkdSRVA6IG5mcy5UQUdTLCBjYW4uc3VwLk9wdGlvbigid29yZCIpXSkgfQoJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRVNDQVBFKSB7IGV2ZW50LnRhcmdldC5ibHVyKCkgfQoJCX19LAoJCXt0eXBlOiBodG1sLlRFWFQsIG5hbWU6ICJmaWx0ZXIiLCB2YWx1ZTogIiIsIG9ua2V5ZG93bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQljYW4ub25tb3Rpb24uc2VsZWN0VGFibGVJbnB1dChldmVudCwgY2FuLnN1cCwgZXZlbnQudGFyZ2V0KQoJCQlpZiAoZXZlbnQua2V5ID09IGxhbmcuRU5URVIpIHsgY2FuLnN1cC5VcGRhdGUoZXZlbnQsIFtjdHguQUNUSU9OLCBldmVudC5jdHJsS2V5PyBuZnMuR1JFUDogbmZzLlRBR1MsIGNhbi5zdXAuT3B0aW9uKCJ3b3JkIildKSB9CgkJCWlmIChldmVudC5rZXkgPT0gbGFuZy5FU0NBUEUpIHsgZXZlbnQudGFyZ2V0LmJsdXIoKSB9CgkJfX0sCgkJe3R5cGU6IGh0bWwuQlVUVE9OLCBuYW1lOiBuZnMuVEFHU30sCgkJe3R5cGU6IGh0bWwuQlVUVE9OLCBuYW1lOiBuZnMuR1JFUH0sCgkJe3R5cGU6IGh0bWwuQlVUVE9OLCBuYW1lOiBjbGkuTUFLRX0sCgkJe3R5cGU6IGh0bWwuQlVUVE9OLCBuYW1lOiAiaGlzdG9yeSJ9LAoJCXt0eXBlOiBodG1sLkJVVFRPTiwgbmFtZTogImxhc3QiLCBfdHJhbnM6ICLov5Tlm54ifSwKCV0sIGZ1bmN0aW9uKG1zZywgY21kcywgY2IpIHsgaWYgKGNhbi5taXNjLnJ1bkFjdGlvbihjYW4sIG1zZywgY21kcywgY2IsIGtpdC5EaWN0KAoJCSJoaXN0b3J5IiwgZnVuY3Rpb24oY21kcykgewoJCQljYW4uY29yZS5MaXN0KGNhbi5oaXN0b3J5LCBmdW5jdGlvbihpdGVtKSB7CgkJCQltc2cuUHVzaChuZnMuRklMRSwgaXRlbS5maWxlKQoJCQkJbXNnLlB1c2gobmZzLkxJTkUsIGl0ZW0ubGluZSkKCQkJCW1zZy5QdXNoKG1kYi5URVhULCBpdGVtLnRleHQpCgkJCX0pCgkJCXNob3cobXNnKQoJCX0sCgkJbmZzLlRBR1MsIGZ1bmN0aW9uKGNtZHMpIHsgbXNnLk9wdGlvbihraXQuRGljdChpY2UuTVNHX0hBTkRMRSwgaWNlLlRSVUUsIGljZS5NU0dfRklFTERTLCAiZmlsZSxsaW5lLHRleHQiKSkKCQkJY2FuLnJ1bihtc2cuX2V2ZW50LCBbY3R4LkFDVElPTiwgbWRiLlNFQVJDSCwgY2FuLnBhcnNlLCBjbWRzWzBdLCBjYW4uT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgeyB2YXIgc3ViID0gbXNnLl9jYW4KCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKS80KSwgc2hvdyhtc2csIG1zZy5fd29yZCA9IGNtZHNbMF0pCgkJCQljYW4ucGFnZS5DbGFzc0xpc3QuaGFzKHN1Yiwgc3ViLl90YXJnZXQsIGh0bWwuU0VMRUNUKSB8fCBzdWIuX2xlZ2VuZC5jbGljaygpCgkJCQljYW4ub25tb3Rpb24uZm9jdXMoY2FuLCBtc2cuX2Nhbi5faW5wdXRzWyJ3b3JkIl0uX3RhcmdldCkKCQkJfSwgdHJ1ZSkKCQl9LAoJCW5mcy5HUkVQLCBmdW5jdGlvbihjbWRzKSB7IG1zZy5PcHRpb24oa2l0LkRpY3QoaWNlLk1TR19IQU5ETEUsIGljZS5UUlVFLCBpY2UuTVNHX0ZJRUxEUywgImZpbGUsbGluZSx0ZXh0IiwgbmZzLlBBVEgsIGNhbi5PcHRpb24obmZzLlBBVEgpKSkKCQkJY2FuLnJ1bihtc2cuX2V2ZW50LCBbY3R4LkFDVElPTiwgbmZzLkdSRVAsIGNtZHNbMF1dLCBmdW5jdGlvbihtc2cpIHsgdmFyIHN1YiA9IG1zZy5fY2FuCgkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fb3V0cHV0LCBodG1sLk1BWF9IRUlHSFQsIGNhbi5Db25mSGVpZ2h0KCkvNCksIHNob3cobXNnLCBtc2cuX3dvcmQgPSBjbWRzWzBdKQoJCQkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmhhcyhzdWIsIHN1Yi5fdGFyZ2V0LCBodG1sLlNFTEVDVCkgfHwgc3ViLl9sZWdlbmQuY2xpY2soKQoJCQkJY2FuLm9ubW90aW9uLmZvY3VzKGNhbiwgbXNnLl9jYW4uX2lucHV0c1sid29yZCJdLl90YXJnZXQpCgkJCX0sIHRydWUpCgkJfSwKCQkibGFzdCIsIGZ1bmN0aW9uKGNtZHMpIHsgaGlzdG9yeS5wb3AoKSwgc2hvdyhoaXN0b3J5LnBvcCgpKSB9LAoJKSkpIHsgcmV0dXJuIH0gY2FuLnJ1bihtc2cuX2V2ZW50LCBjbWRzLCBmdW5jdGlvbihtc2cpIHsgc2hvdyhtc2cpIH0sIHRydWUpIH0pKQoJY2FuLm9uaW1wb3J0LnRvb2xraXQoY2FuLCB7aW5kZXg6IFNFQVJDSH0sIGZ1bmN0aW9uKHN1YikgewoJCWNhbi51aS5zZWFyY2ggPSBzdWIsIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJCWNhbi51aS5zZWFyY2guX3Nob3cgPSBzaG93Cgl9KQp9fSkKCg==",
        "/plugin/local/code/inner/sess.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYikgeyB2YXIgU0VTUyA9ICJ3ZWIuY29kZS5zZXNzIgoJY2FuLm9uaW1wb3J0LnRvb2xraXQoY2FuLCB7aW5kZXg6IFNFU1N9LCBmdW5jdGlvbihzdWIpIHsKCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCkKCQkJaWYgKGNhbi5taXNjLnJ1bkFjdGlvbihjYW4sIG1zZywgY21kcywgY2IsIGtpdC5EaWN0KAoJCQkJbmZzLlNBVkUsIGZ1bmN0aW9uKGNtZHMpIHsKCQkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgU0VTU10uY29uY2F0KFtjdHguQUNUSU9OLCBtZGIuQ1JFQVRFLAoJCQkJCQkidG9vbCIsIEpTT04uc3RyaW5naWZ5KGNhbi5vbmV4cG9ydC50b29sKGNhbikpLAoJCQkJCQkidGFicyIsIEpTT04uc3RyaW5naWZ5KGNhbi5vbmV4cG9ydC50YWJzKGNhbikpLAoJCQkJCV0pLCBjYiwgdHJ1ZSkKCQkJCX0sCgkJCQluZnMuTE9BRCwgZnVuY3Rpb24oY21kcykgewoJCQkJCWNhbi5vbmltcG9ydC5zZXNzKGNhbiwgewoJCQkJCQl0b29sOiBKU09OLnBhcnNlKG1zZy5PcHRpb24oInRvb2wiKSksCgkJCQkJCXRhYnM6IEpTT04ucGFyc2UobXNnLk9wdGlvbigidGFicyIpKSwKCQkJCQl9KQoJCQkJfSwKCQkJKSkpIHsgcmV0dXJuIH0KCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIFNFU1NdLmNvbmNhdChjbWRzKSwgY2IsIHRydWUpCgkJfSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihzdWIpCgl9KQp9fSkKCg==",
        "/plugin/local/code/inner/template.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBhcmdzLCBjYikgewoJY2FuLm9uaW1wb3J0LnRvb2xraXQoY2FuLCB7aW5kZXg6ICJ3ZWIuY29kZS50ZW1wbGF0ZSJ9LCBmdW5jdGlvbihzdWIpIHsKCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiKSB7IHZhciBtc2cgPSBzdWIucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCQlpZiAoY2FuLm1pc2MucnVuQWN0aW9uKGNhbiwgbXNnLCBjbWRzLCBjYiwga2l0LkRpY3QoCgkJCQluZnMuREVGUywgZnVuY3Rpb24oY21kcykgewoJCQkJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIGNhbi5iYXNlLk9iaihtc2cuT3B0aW9uKCJhcmdzIil8fCJbXSIpLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCk7IGNhbi5jb3JlLkl0ZW0oZGF0YSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyBtc2cuT3B0aW9uKGtleSwgdmFsdWUpIH0pCgkJCQkJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBpY2UuUlVOLCAid2ViLmNvZGUudGVtcGxhdGUiLCBuZnMuREVGU10uY29uY2F0KGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQkJCQkJY2FuLm9uaW1wb3J0LnByb2plY3QoY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKSkKCQkJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIG1zZy5PcHRpb24oIm1haW4iKSwgIiIsIGZ1bmN0aW9uKCkgewoJCQkJCQkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIGNtZHNbMV0sIDEsIGZ1bmN0aW9uKCkge30pCgkJCQkJCQl9LCB0cnVlKQoJCQkJCQl9LCB0cnVlKQoJCQkJCX0pCgkJCQl9LAoJCQkpKSkgeyByZXR1cm4gfQoJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgaWNlLlJVTiwgIndlYi5jb2RlLnRlbXBsYXRlIl0uY29uY2F0KGNtZHMpLCBmdW5jdGlvbihtc2cpIHsKCQkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQl9LCB0cnVlKQoJCX0sIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2Ioc3ViKQoJfSkKfX0pCgoK",
        "/plugin/local/code/snippet.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbikKCQlpZiAobXNnLk9wdGlvbigiY29udGVudCIpKSB7CgkJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCB7aW5kZXg6ICJ3ZWIuY29kZS52aW1lciIsIHN0eWxlOiAiZnVsbCJ9LCBmdW5jdGlvbihzdWIpIHsKCQkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIHJlcyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQkJCWlmIChjbWRzWzFdID09ICJwbHVnaW4iKSB7CgkJCQkJCWNhbi5ydW4oZXZlbnQsIGNhbi5taXNjLmNvbmNhdChjYW4sIFsiYWN0aW9uIiwgInZpbWVyIl0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJCQkJcmV0dXJuCgkJCQkJfQoJCQkJCWlmIChjbWRzWzFdID09ICJtYWluLmdvIikgeyByZXMuRWNobyhtc2cuT3B0aW9uKCJjb250ZW50IikpCgkJCQkJCWNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7IGNhbi5zdWIgJiYgY2FuLnN1Yi5vbmFjdGlvblsi6aG555uuIl0oe30sIGNhbi5zdWIpIH0pCgkJCQkJfQoJCQkJCWNiKHJlcyksIGNhbi5zdWIgPSBjYW4uY29yZS5WYWx1ZShzdWIsICJfb3V0cHV0cy4tMSIpCgkJCQl9CgkJCX0sIGNhbi5fb3V0cHV0KQoJCQlyZXR1cm4KCQl9CgkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKQoJCWNhbi5vbmFwcGVuZC5ib2FyZChjYW4sIG1zZykKCX0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5pON5L2c5pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewoJfSwKCXJ1bjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbXNnKSB7CgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGljZS5SVU4sICJnbyIsICJoaS5nbyIsIGNhbi5zdWIub25leHBvcnQuY29udGVudChjYW4uc3ViKV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJfSwgdHJ1ZSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW10sIF9pbml0OiBmdW5jdGlvbihjYW4sIG1zZywgbGlzdCwgY2IsIHRhcmdldCkgewp9fSkKCg==",
        "/plugin/local/code/vimer.css": "ZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBpbnB1dC5jdXJyZW50IHsKCWJhY2tncm91bmQtY29sb3I6IzAwMDAwMDAwOyBjb2xvcjojMDAwMDAwMDA7IGZvbnQtc2l6ZToxZW07IGZvbnQtZmFtaWx5Om1vbm9zcGFjZTsKCXBhZGRpbmc6MDsgcGFkZGluZy1sZWZ0OjExcHg7IGJvcmRlcjpub25lOyBvdXRsaW5lOm5vbmU7IG1hcmdpbjowOyBtYXJnaW4tdG9wOi0xcHg7CiAJaGVpZ2h0OjIycHg7IHBvc2l0aW9uOmFic29sdXRlOwp9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgaW5wdXQuY3VycmVudC5ub3JtYWwgeyBjYXJldC1jb2xvcjpncmF5OyB9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgaW5wdXQuY3VycmVudC5pbnNlcnQgeyBjYXJldC1jb2xvcjp5ZWxsb3c7IH0KCmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlIHsKCWhlaWdodDoyMHB4OyBwb3NpdGlvbjphYnNvbHV0ZTsgbGVmdDozMnB4OyBtYXJnaW4tdG9wOjIwcHg7CglkaXNwbGF5Om5vbmU7Cn0KZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBkaXYuY29tcGxldGUuaW5zZXJ0IHsKCWRpc3BsYXk6YmxvY2s7Cn0KZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBkaXYuY29tcGxldGUgZGl2LnByZSB7Cglmb250LXNpemU6MS4xcmVtOyBjb2xvcjojZjBmOGZmMDA7IG1hcmdpbi1sZWZ0OjVweDsgZmxvYXQ6bGVmdDsKfQpmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB0YWJsZSB7CgliYWNrZ3JvdW5kOmxpZ2h0Ymx1ZTsgbWF4LWhlaWdodDo0MDBweDsgbWF4LXdpZHRoOjgwMHB4OyBvdmVyZmxvdzphdXRvOyBkaXNwbGF5OmJsb2NrOyBmbG9hdDpsZWZ0Owp9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlIHRhYmxlLmNvbnRlbnQgdGggewoJZGlzcGxheTpub25lOwp9CmZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgZGl2LmNvbXBsZXRlIHRhYmxlLmNvbnRlbnQgdGQgewoJZm9udC1zaXplOjEuMXJlbTsKfQoKYm9keS5zaW1wbGUgZmllbGRzZXQudmltZXI+ZGl2Lm91dHB1dCBkaXYuY29tcGxldGUgZGl2LnByZSB7Cglmb250LXNpemU6MXJlbTsKfQpib2R5LnNpbXBsZSBmaWVsZHNldC52aW1lcj5kaXYub3V0cHV0IGRpdi5jb21wbGV0ZSB0YWJsZS5jb250ZW50IHRkIHsKCWZvbnQtc2l6ZToxcmVtOwp9Cgpib2R5LndoaXRlIGZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgaW5wdXQuY3VycmVudC5pbnNlcnQgeyBjYXJldC1jb2xvcjpibGFjazsgfQpib2R5LndoaXRlIGZpZWxkc2V0LnZpbWVyPmRpdi5vdXRwdXQgaW5wdXQuY3VycmVudC5ub3JtYWwgeyBjYXJldC1jb2xvcjpsaWdodGdyYXk7IH0K",
        "/plugin/local/code/vimer.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnJlcXVpcmUoWyJpbm5lci5qcyJdLCBmdW5jdGlvbihjYW4pIHsgY2FuLm9uaW1wb3J0LmlubmVyX2luaXQoY2FuLCBtc2csIGZ1bmN0aW9uKCkgeyBjYW4udW5kbyA9IFtdLCBjYW4ucmVkbyA9IFtdCgkJCWNhbi5vbmtleW1hcC5fYnVpbGQoY2FuKSwgY2FuLm9uaW1wb3J0Ll9pbnB1dChjYW4pLCBjYW4ub25rZXltYXAuX3BsdWdpbih7fSwgY2FuKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgoJCX0sIHRhcmdldCkgfSwgZnVuY3Rpb24oY2FuLCBuYW1lLCBzdWIpIHsgbmFtZSA9PSBjaGF0Lk9OSU1QT1JUICYmIChjYW4ub25pbXBvcnQuaW5uZXJfaW5pdCA9IHN1Yi5faW5pdCkKCQkJaWYgKG5hbWUgPT0gY2hhdC5PTkFDVElPTikgeyBjYW4uX3RyYW5zID0gY2FuLmJhc2UuQ29weShjYW4uX3RyYW5zfHx7fSwgc3ViLl90cmFucykgfQoJCQlpZiAobmFtZSA9PSBjaGF0Lk9OS0VZTUFQKSB7IGNhbi5iYXNlLkNvcHkoY2FuLm9ua2V5bWFwLl9tb2RlLCBzdWIuX21vZGUpCgkJCQljYW4uY29yZS5JdGVtKGNhbi5vbmtleW1hcC5fbW9kZS5ub3JtYWwsIGZ1bmN0aW9uKGssIHYpIHsgc3ViLl9tb2RlLnBsdWdpbltrXSB8fCAoc3ViLl9tb2RlLnBsdWdpbltrXSA9IHYpIH0pCgkJCQljYW4uY29yZS5JdGVtKHN1Yi5fbW9kZS5wbHVnaW4sIGZ1bmN0aW9uKGssIHYpIHsgY2FuLm9ua2V5bWFwLl9tb2RlLm5vcm1hbFtrXSB8fCAoY2FuLm9ua2V5bWFwLl9tb2RlLm5vcm1hbFtrXSA9IHYpIH0pCgkJCX0KCQl9KQoJfSwKCV9pbnB1dDogZnVuY3Rpb24oY2FuKSB7CgkJdmFyIHVpID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmNvbnRlbnQucGFyZW50Tm9kZSwgWwoJCQl7dmlldzogWyJjdXJyZW50IiwgaHRtbC5JTlBVVF0sIHNwZWxsY2hlY2s6IGZhbHNlLCBvbmtleWRvd246IGZ1bmN0aW9uKGV2ZW50KSB7IGlmIChldmVudC5tZXRhS2V5KSB7IHJldHVybiB9CgkJCQlpZiAoZXZlbnQuY3RybEtleSAmJiBjYW4ub25hY3Rpb24uX2NvbXBsZXRlKGV2ZW50LCBjYW4pKSB7IHJldHVybiB9CgkJCQljYW4uX2tleWxpc3QgPSBjYW4ub25rZXltYXAuX3BhcnNlKGV2ZW50LCBjYW4sIGNhbi5tb2RlKyhldmVudC5jdHJsS2V5PyAiX2N0cmwiOiAiIiksIGNhbi5fa2V5bGlzdCwgY2FuLnVpLmN1cnJlbnQpCgkJCQljYW4ubW9kZSA9PSAiaW5zZXJ0IiAmJiBjYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IGNhbi5jdXJyZW50LnRleHQoY2FuLnVpLmN1cnJlbnQudmFsdWUpIH0pCgkJCQljYW4ubW9kZSA9PSAibm9ybWFsIiAmJiBjYW4uU3RhdHVzKCLmjInplK4iLCBjYW4uX2tleWxpc3Quam9pbigiIikpCgkJCQljYW4ubW9kZSA9PSAibm9ybWFsIiAmJiBjYW4ub25rZXltYXAucHJldmVudChldmVudCkKCQkJfSwgb25rZXl1cDogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLm9uYWN0aW9uLl9jb21wbGV0ZShldmVudCwgY2FuKQoKCQkJfSwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbikKCgkJCX19LCB7dmlldzogWyJjb21wbGV0ZSJdfSwKCQldKTsgY2FuLnVpLmN1cnJlbnQgPSB1aS5jdXJyZW50LCBjYW4udWkuY29tcGxldGUgPSB1aS5jb21wbGV0ZQoJfSwKfSwgWyIiXSkKVm9sY2Fub3MoIm9ua2V5bWFwIiwge2hlbHA6ICLplK7nm5jkuqTkupIiLCBsaXN0OiBbXSwKCV9tb2RlbDogZnVuY3Rpb24oY2FuLCB2YWx1ZSkgeyBjYW4uU3RhdHVzKCLmqKHlvI8iLCBjYW4ubW9kZSA9IHZhbHVlKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5jdXJyZW50LCB7Y2xhc3NOYW1lOiBbImN1cnJlbnQiLCBjYW4ubW9kZV19KSwgdmFsdWUKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkuY29tcGxldGUsIHtjbGFzc05hbWU6IFsiY29tcGxldGUiLCBjYW4ubW9kZV19KSwgdmFsdWUKCX0sCglfcGx1Z2luOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fbW9kZWwoY2FuLCAicGx1Z2luIikKCQljYW4udWkuY3VycmVudC5ibHVyKCkKCX0sCglfbm9ybWFsOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fbW9kZWwoY2FuLCAibm9ybWFsIikKCQljYW4udWkuY3VycmVudC5mb2N1cygpCgl9LAoJX2luc2VydDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25rZXltYXAuX21vZGVsKGNhbiwgImluc2VydCIpCgkJY2FuLnVpLmN1cnJlbnQuZm9jdXMoKSwgY2FuLnVpLmNvbnRlbnQuc2Nyb2xsTGVmdCAtPSAxMDAwMAoJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCS8vIGNhbi5fa2V5bGlzdCA9IFtdCgl9LAoKCV9tb2RlOiB7CgkJbm9ybWFsX2N0cmw6IHsKCQkJZjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgewoJCQkJdmFyIGxpbmUgPSBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuKStjYW4uY3VycmVudC53aW5kb3coKS0zLWNhbi5jdXJyZW50LnNjcm9sbCgpCgkJCQlyZXR1cm4gY2FuLmN1cnJlbnQuc2Nyb2xsKGxpbmUpLCBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBsaW5lKSwgdHJ1ZQoJCQl9LAoJCQliOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSB7CgkJCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4pLWNhbi5jdXJyZW50LndpbmRvdygpKzMKCQkJCXJldHVybiBjYW4uY3VycmVudC5zY3JvbGwobGluZSksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUpLCB0cnVlCgkJCX0sCgkJfSwKCQlub3JtYWw6IHsKCQkJZXNjYXBlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmtleW1hcC5fcGx1Z2luKGV2ZW50LCBjYW4pIH0sCgkJCUFycm93TGVmdDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAtMSkgfSwKCQkJQXJyb3dSaWdodDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAxKSB9LAoJCQlBcnJvd0Rvd246IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQubmV4dCgpKSB9LAoJCQlBcnJvd1VwOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5jdXJyZW50LnByZXYoKSkgfSwKCgkJCSIuIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IHZhciBjYiA9IGNhbi5yZWRvLnBvcCgpOyBjYiAmJiBjYigpIH0sCgkJCXU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyB2YXIgY2IgPSBjYW4udW5kby5wb3AoKTsgY2IgJiYgY2IoKSB9LAoJCQlKOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsKCQkJCXZhciBuZXh0ID0gY2FuLmN1cnJlbnQubmV4dCgpOyBpZiAoIW5leHQpIHsgcmV0dXJuIH0KCQkJCXZhciBsaW5lID0gY2FuLmN1cnJlbnQubGluZSwgdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKQoJCQkJdmFyIHJlc3QgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBuZXh0LCAidGQudGV4dCIpWzBdLmlubmVyVGV4dAoJCQkJY2FuLmN1cnJlbnQudGV4dCh0ZXh0LnRyaW1SaWdodCgpK2ljZS5TUCtyZXN0LnRyaW1MZWZ0KCkpLCBjYW4ub25hY3Rpb24uZGVsZXRlTGluZShjYW4sIG5leHQpCgkJCQljYW4udW5kby5wdXNoKGZ1bmN0aW9uKCkgeyBjYW4ub25hY3Rpb24ubW9kaWZ5TGluZShjYW4sIGxpbmUsIHRleHQpLCBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIHJlc3QsIGxpbmUubmV4dFNpYmxpbmcpIH0pCgkJCX0sCgkJCUg6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyBjYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIHRhcmdldCwgMCwgMCkgfSwKCQkJaDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAtMSkgfSwKCQkJbDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgdGFyZ2V0LCAxKSB9LAoJCQlMOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQpIHsgY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCB0YXJnZXQsIDAsIC0xKSB9LAoJCQlqOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5jdXJyZW50Lm5leHQoKSkgfSwKCQkJazogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4uY3VycmVudC5wcmV2KCkpIH0sCgoJCQlnZzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0LCBjb3VudCkgeyByZXR1cm4gY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY291bnQpLCB0cnVlIH0sCgkJCUc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgcmV0dXJuIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNvdW50ID0gY291bnQ+MT8gY291bnQ6IGNhbi5tYXgpLCB0cnVlIH0sCgkJCXp0OiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSB7IHJldHVybiBjYW4uY3VycmVudC5zY3JvbGwoY2FuLmN1cnJlbnQuc2Nyb2xsKCktKGNvdW50PjE/IGNvdW50OiAzKSksIHRydWUgfSwKCQkJeno6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgcmV0dXJuIGNhbi5jdXJyZW50LnNjcm9sbChjYW4uY3VycmVudC5zY3JvbGwoKS0oY291bnQgPSBjb3VudD4xPyBjb3VudDogY2FuLmN1cnJlbnQud2luZG93KCkvMikpLCB0cnVlIH0sCgkJCXpiOiBmdW5jdGlvbihldmVudCwgY2FuLCB0YXJnZXQsIGNvdW50KSB7IHJldHVybiBjYW4uY3VycmVudC5zY3JvbGwoY2FuLmN1cnJlbnQuc2Nyb2xsKCktY2FuLmN1cnJlbnQud2luZG93KCkrKGNvdW50PjE/IGNvdW50OiA1KSksIHRydWUgfSwKCgkJCWk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbikgfSwKCQkJSTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5faW5zZXJ0KGV2ZW50LCBjYW4pLCBjYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIHRhcmdldCwgMCwgMCkgfSwKCQkJYTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5faW5zZXJ0KGV2ZW50LCBjYW4pLCBjYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIHRhcmdldCwgMSkgfSwKCQkJQTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5faW5zZXJ0KGV2ZW50LCBjYW4pLCBjYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIHRhcmdldCwgMCwgLTEpIH0sCgkJCW86IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIHRleHQgPSBjYW4uY3VycmVudC50ZXh0KCkKCQkJCXRleHQgPSB0ZXh0LnN1YnN0cigwLCB0ZXh0LmluZGV4T2YodGV4dC50cmltTGVmdCgpKSkrKHRleHQuZW5kc1dpdGgoInsiKT8iXHQiOiIiKQoJCQkJY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgdGV4dCwgY2FuLmN1cnJlbnQubmV4dCgpKSkKCQkJCWNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgY2FuLnVpLmN1cnJlbnQsIDEwMDApCgkJCX0sCgkJCU86IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIHRleHQgPSBjYW4uY3VycmVudC50ZXh0KCkKCQkJCXRleHQgPSB0ZXh0LnN1YnN0cigwLCB0ZXh0LmluZGV4T2YodGV4dC50cmltTGVmdCgpKSkrKHRleHQuZW5kc1dpdGgoIn0iKT8iXHQiOiIiKQoJCQkJY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbiksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgdGV4dCwgY2FuLmN1cnJlbnQubGluZSkpCgkJCQljYW4ub25rZXltYXAuY3Vyc29yTW92ZShjYW4sIGNhbi51aS5jdXJyZW50LCAxMDAwKQoJCQl9LAoKCQkJeXk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgY2FuLl9sYXN0X3RleHQgPSBjYW4uY3VycmVudC50ZXh0KCkgfSwKCQkJZGQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIHsgdmFyIHRleHQgPSBjYW4uY3VycmVudC50ZXh0KCksIGxpbmUgPSBjYW4ub25hY3Rpb24uX2dldExpbmVubyhjYW4sIGNhbi5jdXJyZW50LmxpbmUpCgkJCQljYW4uX2xhc3RfdGV4dCA9IGNhbi5jdXJyZW50LnRleHQoKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLm9uYWN0aW9uLmRlbGV0ZUxpbmUoY2FuLCBjYW4uY3VycmVudC5saW5lKSkKCQkJCWNhbi51bmRvLnB1c2goZnVuY3Rpb24oKSB7IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgdGV4dCwgbGluZSksIGNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGxpbmUpIH0pCgkJCQl2YXIgY2FsbGVlID0gYXJndW1lbnRzLmNhbGxlZQoJCQkJY2FuLnJlZG8ucHVzaChmdW5jdGlvbigpIHsgY2FsbGVlKGV2ZW50LCBjYW4sIHRhcmdldCwgY291bnQpIH0pCgkJCX0sCgkJCXA6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCXZhciBsaW5lID0gY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCBjYW4uX2xhc3RfdGV4dCwgY2FuLmN1cnJlbnQubmV4dCgpKQoJCQkJY2FuLnVuZG8ucHVzaChmdW5jdGlvbigpIHsgY2FuLm9uYWN0aW9uLmRlbGV0ZUxpbmUoY2FuLCBsaW5lKSwgY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgbGluZS0xKSB9KQoJCQl9LAoJCQlQOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJCQl2YXIgbGluZSA9IGNhbi5vbmFjdGlvbi5pbnNlcnRMaW5lKGNhbiwgY2FuLl9sYXN0X3RleHQsIGNhbi5jdXJyZW50LmxpbmUpCgkJCQljYW4udW5kby5wdXNoKGZ1bmN0aW9uKCkgeyBjYW4ub25hY3Rpb24uZGVsZXRlTGluZShjYW4sIGxpbmUpLCBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBsaW5lKzEpIH0pCgkJCX0sCgoJCQlzOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5zYXZlKGV2ZW50LCBjYW4pIH0sCgkJCW06IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLmF1dG9nZW4oZXZlbnQsIGNhbiwgImF1dG9nZW4iKSB9LAoJCQljOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5jb21waWxlKGV2ZW50LCBjYW4sICJjb21waWxlIikgfSwKCQl9LAoJCWluc2VydDogewoJCQlqazogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7IGNhbi5vbmtleW1hcC5fbm9ybWFsKGV2ZW50LCBjYW4pCgkJCQljYW4ub25rZXltYXAuZGVsZXRlVGV4dCh0YXJnZXQsIHRhcmdldC5zZWxlY3Rpb25TdGFydC0xLCAxKQoJCQkJY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSkKCQkJfSwKCQkJRXNjYXBlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJCQlpZiAoZXZlbnQua2V5ICE9ICJFc2NhcGUiKSB7IHJldHVybiB9CgkJCQljYW4ub25rZXltYXAuX25vcm1hbChldmVudCwgY2FuKQoJCQl9LAoJCQlUYWI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIlRhYiIpIHsgcmV0dXJuIH0KCQkJCWNhbi5vbmtleW1hcC5pbnNlcnRUZXh0KGNhbi51aS5jdXJyZW50LCAiXHQiKQoJCQkJY2FuLm9ua2V5bWFwLnByZXZlbnQoZXZlbnQpCgkJCX0sCgoJCQlFbnRlcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQlpZiAoZXZlbnQua2V5ICE9ICJFbnRlciIpIHsgcmV0dXJuIH0KCQkJCXZhciByZXN0ID0gY2FuLm9ua2V5bWFwLmRlbGV0ZVRleHQodGFyZ2V0LCB0YXJnZXQuc2VsZWN0aW9uRW5kKSwgdGV4dCA9IGNhbi51aS5jdXJyZW50LnZhbHVlCgkJCQl2YXIgbGVmdCA9IHRleHQuc3Vic3RyKDAsIHRleHQuaW5kZXhPZih0ZXh0LnRyaW1MZWZ0KCkpKXx8KHRleHQudHJpbVJpZ2h0KCkgPT0gIiI/IHRleHQ6ICIiKQoJCQkJaWYgKHRleHQuZW5kc1dpdGgoInsiKSkgeyBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGxlZnQrIn0iLCBjYW4uY3VycmVudC5uZXh0KCkpLCBsZWZ0ICs9ICJcdCIgfQoJCQkJaWYgKHRleHQuZW5kc1dpdGgoIlsiKSkgeyBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGxlZnQrIl0iLCBjYW4uY3VycmVudC5uZXh0KCkpLCBsZWZ0ICs9ICJcdCIgfQoJCQkJaWYgKHRleHQuZW5kc1dpdGgoIigiKSkgeyBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGxlZnQrIikiLCBjYW4uY3VycmVudC5uZXh0KCkpLCBsZWZ0ICs9ICJcdCIgfQoJCQkJaWYgKHRleHQuZW5kc1dpdGgoImAiKSAmJiBjYW4uYmFzZS5jb3VudCh0ZXh0LCAiYCIpJTI9PTEpIHsgY2FuLm9uYWN0aW9uLmluc2VydExpbmUoY2FuLCBsZWZ0KyJgIiwgY2FuLmN1cnJlbnQubmV4dCgpKSB9CgoJCQkJdmFyIGxpbmUgPSBjYW4ub25hY3Rpb24uaW5zZXJ0TGluZShjYW4sIGxlZnQrcmVzdC50cmltTGVmdCgpLCBjYW4uY3VycmVudC5uZXh0KCkpCgkJCQljYW4uY3VycmVudC50ZXh0KHRleHQudHJpbVJpZ2h0KCl8fHRleHQpLCBjYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBsaW5lKQoJCQkJY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCBjYW4udWkuY3VycmVudCwgbGVmdC5sZW5ndGgsIDApCgkJCX0sCgkJCUJhY2tzcGFjZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJCQlpZiAoZXZlbnQua2V5ICE9ICJCYWNrc3BhY2UiKSB7IHJldHVybiB9CgkJCQlpZiAodGFyZ2V0LnNlbGVjdGlvblN0YXJ0ID4gMCkgeyByZXR1cm4gfQoJCQkJaWYgKCFjYW4uY3VycmVudC5wcmV2KCkpIHsgcmV0dXJuIH0KCQkJCWNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoKCQkJCXZhciByZXN0ID0gY2FuLmN1cnJlbnQudGV4dCgpCgkJCQljYW4ub25hY3Rpb24uc2VsZWN0TGluZShldmVudCwgY2FuLCBjYW4uY3VycmVudC5wcmV2KCkpCgkJCQljYW4ub25hY3Rpb24uZGVsZXRlTGluZShjYW4sIGNhbi5jdXJyZW50Lm5leHQoKSkKCQkJCXZhciBwb3MgPSBjYW4uY3VycmVudC50ZXh0KCkubGVuZ3RoCgoJCQkJY2FuLnVpLmN1cnJlbnQudmFsdWUgPSBjYW4uY3VycmVudC50ZXh0KCkrcmVzdAoJCQkJY2FuLm9ua2V5bWFwLmN1cnNvck1vdmUoY2FuLCBjYW4udWkuY3VycmVudCwgMCwgcG9zKQoJCQl9LAoJCQlBcnJvd1VwOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJCQlpZiAoZXZlbnQua2V5ICE9ICJBcnJvd1VwIikgeyByZXR1cm4gfQoJCQkJY2FuLm9uYWN0aW9uLnNlbGVjdExpbmUoZXZlbnQsIGNhbiwgY2FuLmN1cnJlbnQucHJldigpKQoJCQl9LAoJCQlBcnJvd0Rvd246IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQkJCWlmIChldmVudC5rZXkgIT0gIkFycm93RG93biIpIHsgcmV0dXJuIH0KCQkJCWNhbi5vbmFjdGlvbi5zZWxlY3RMaW5lKGV2ZW50LCBjYW4sIGNhbi5jdXJyZW50Lm5leHQoKSkKCQkJfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5o6n5Lu25Lqk5LqSIiwgbGlzdDogW25mcy5TQVZFLCBjb2RlLkFVVE9HRU4sIGNvZGUuQ09NUElMRSwgbmZzLlNDUklQVCwgY2hhdC5XRUJTSVRFLCB3ZWIuRFJFQU0sIGNvZGUuUFVCTElTSF0sCglfcnVuOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24sIGFyZ3MsIGNiKSB7CgkJY2FuLnJ1bkFjdGlvbihldmVudCwgYnV0dG9uLCBhcmdzLCBjYnx8ZnVuY3Rpb24obXNnKSB7CgkJCWNhbi5vbmltcG9ydC50YWJ2aWV3KGNhbiwgY2FuLk9wdGlvbihuZnMuUEFUSCksIG1zZy5PcHRpb24obmZzLkZJTEUpKQoJCQljYW4ub25pbXBvcnQucHJvamVjdChjYW4sIGNhbi5PcHRpb24obmZzLlBBVEgpKSwgY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbiwgYnV0dG9uKQoJCX0pCgl9LAoJX3J1bnM6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyB2YXIgbWV0YSA9IGNhbi5Db25mKCk7IGNhbi5yZXF1ZXN0KGV2ZW50LCB7YWN0aW9uOiBidXR0b259KQoJCWNhbi51c2VyLmlucHV0KGV2ZW50LCBjYW4sIG1ldGEuZmVhdHVyZVtidXR0b25dLCBmdW5jdGlvbihldiwgYnRuLCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCWNhbi5vbmFjdGlvbi5fcnVuKGV2ZW50LCBjYW4sIGJ1dHRvbiwgYXJncykKCQl9KQoJfSwKCXNhdmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBjYW4ucmVxdWVzdChldmVudCwge2ZpbGU6IGNhbi5PcHRpb24obmZzLkZJTEUpLCBjb250ZW50OiBjYW4ub25leHBvcnQuY29udGVudChjYW4pfSkKCQljYW4ucnVuQWN0aW9uKGV2ZW50LCBuZnMuU0FWRSwgW2Nhbi5wYXJzZSwgY2FuLk9wdGlvbihuZnMuRklMRSksIGNhbi5PcHRpb24obmZzLlBBVEgpXSwgZnVuY3Rpb24oKSB7CgkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4sIGJ1dHRvbikKCQl9KQoJfSwKCWF1dG9nZW46IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgeyBjYW4ub25hY3Rpb24uX3J1bnMoZXZlbnQsIGNhbiwgYnV0dG9uKSB9LAoJY29tcGlsZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IHZhciB0b2FzdDAgPSBjYW4udXNlci50b2FzdFByb2Nlc3MoY2FuLCAi57yW6K+R5LitLi4uIikKCQljYW4ucnVuQWN0aW9uKGV2ZW50LCBidXR0b24sIFtdLCBmdW5jdGlvbihtc2cpIHsgdG9hc3QwLmNsb3NlKCkKCQkJaWYgKG1zZy5MZW5ndGgoKSA9PSAwKSB7IHZhciB0b2FzdDEgPSBjYW4udXNlci50b2FzdFByb2Nlc3MoY2FuLCAi6YeN5ZCv5LitLi4uIikKCQkJCWNhbi5jb3JlLlRpbWVyKDMwMDAsIGZ1bmN0aW9uKCkgeyB0b2FzdDEuY2xvc2UoKSwgY2FuLm9uYWN0aW9uWyLlsZXnpLoiXSh7fSwgY2FuKSB9KQoJCQl9IGVsc2UgeyBjYW4udWkuc2VhcmNoLl9zaG93KG1zZykgfQoJCX0pCgl9LAoJc2NyaXB0OiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQljYW4ucmVxdWVzdChldmVudCwge2ZpbGU6ICJoaS9oaS5qcyJ9KQoJCWNhbi5vbmFjdGlvbi5fcnVucyhldmVudCwgY2FuLCBidXR0b24pCgl9LAoJd2Vic2l0ZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJY2FuLnJlcXVlc3QoZXZlbnQsIHtmaWxlOiAiaGkuem1sIn0pCgkJY2FuLm9uYWN0aW9uLl9ydW5zKGV2ZW50LCBjYW4sIGJ1dHRvbikKCX0sCglwdWJsaXNoOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQljYW4ucnVuQWN0aW9uKGV2ZW50LCBidXR0b24sIFtdLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3RDb25maXJtKGNhbiwgYnV0dG9uLCBtc2cuUmVzdWx0KCkpIH0pCgl9LAoKCWxpc3RUYWdzOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsgdmFyIGxpc3QgPSBbXQoJCWNhbi5jb3JlLkl0ZW0oY2FuLnJlcXVlc3QoZXZlbnQpLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGlmIChrZXkuaW5kZXhPZigiXyIpID09IDApIHsgcmV0dXJuIH0KCQkJbGlzdC5wdXNoKHt6b25lOiAibXNnIiwgdHlwZTogdHlwZW9mIHZhbHVlLCBuYW1lOiBrZXksIHRleHQ6IGNhbi5iYXNlLmlzT2JqZWN0KHZhbHVlKT8gIiI6ICh2YWx1ZSsiIikuc3BsaXQoaWNlLk5MKVswXSwKCQkJCXBhdGg6ICJ1c3Ivdm9sY2Fub3MvIiwgZmlsZTogImxpYi9taXNjLmpzIiwgbGluZTogMSwKCQkJfSkKCQl9KQoJCWNhbi5jb3JlLkxpc3QoW2Nhbi5iYXNlLCBjYW4uY29yZSwgY2FuLm1pc2MsIGNhbi5wYWdlLCBjYW4udXNlciwgY2FuLm9uZW5naW5lLCBjYW4ub25kYWVtb24sIGNhbi5vbmFwcGVuZCwgY2FuLm9ubGF5b3V0LCBjYW4ub25tb3Rpb24sIGNhbi5vbmtleW1hcF0sIGZ1bmN0aW9uKGxpYikgewoJCQljYW4uY29yZS5JdGVtKGxpYiwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyBpZiAoa2V5LmluZGV4T2YoIl8iKSA9PSAwIHx8ICFsaWIuaGFzT3duUHJvcGVydHkoa2V5KSkgeyByZXR1cm4gfQoJCQkJbGlzdC5wdXNoKHt6b25lOiBsaWIuX25hbWUsIHR5cGU6IHR5cGVvZiB2YWx1ZSwgbmFtZToga2V5LCB0ZXh0OiBjYW4uYmFzZS5pc09iamVjdCh2YWx1ZSk/ICIiOiAodmFsdWUrIiIpLnNwbGl0KGljZS5OTClbMF0sCgkJCQkJcGF0aDogInVzci92b2xjYW5vcy8iLCBmaWxlOiBsaWIuX3BhdGgsIGxpbmU6IDEsCgkJCQl9KQoJCQl9KQoJCX0pCgkJY2FuLnJlcXVlc3QoZXZlbnQsIHt0ZXh0OiBjYW4uYmFzZS5Gb3JtYXQobGlzdCl9KQoJCWNhbi5ydW5BY3Rpb24oZXZlbnQsIGJ1dHRvbikKCX0sCglfY29tcGxldGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhcmdldCkgeyB0YXJnZXQgPSB0YXJnZXR8fGNhbi51aS5jb21wbGV0ZQoJCWlmIChldmVudCA9PSB1bmRlZmluZWQpIHsgcmV0dXJuIH0KCQl2YXIgcHJlID0gY2FuLnVpLmN1cnJlbnQudmFsdWUuc2xpY2UoMCwgY2FuLnVpLmN1cnJlbnQuc2VsZWN0aW9uU3RhcnQpCgkJdmFyIGVuZCA9IGNhbi51aS5jdXJyZW50LnZhbHVlLnNsaWNlKGNhbi51aS5jdXJyZW50LnNlbGVjdGlvblN0YXJ0KQoJCXZhciB0eXBlID0gY2FuLmNvcmUuU3BsaXQocHJlKS5wb3AoKXx8IiIKCQl2YXIgbmFtZSA9IGNhbi5jb3JlLlNwbGl0KHR5cGUsICIiLCBpY2UuUFQpLnBvcCgpfHwiIgoJCXR5cGUgPSBjYW4uYmFzZS50cmltU3VmZml4KHR5cGUsIG5hbWUpCgkJdHlwZSA9IGNhbi5iYXNlLnRyaW1TdWZmaXgodHlwZSwgaWNlLlBUKQoJCWNvbnN0IFBSRSA9ICJwcmUiCgoJCWZ1bmN0aW9uIHVwZGF0ZSh0YXJnZXQpIHsgY2FuLnJlcXVlc3QoZXZlbnQsIHt0eXBlOiB0eXBlLCBuYW1lOiBuYW1lLCB0ZXh0OiBwcmUsIGZpbGU6IGNhbi5PcHRpb24obmZzLkZJTEUpfSkKCQkJY2FuLnJ1bkFjdGlvbihldmVudCwgImNvbXBsZXRlIiwgW10sIGZ1bmN0aW9uKG1zZykgeyBjYW4udWkuY29tcGxldGUuX21zZyA9IG1zZwoJCQkJaWYgKG1zZy5MZW5ndGgoKSA9PSAwICYmIGNhbi5iYXNlLkV4dChjYW4uT3B0aW9uKG5mcy5GSUxFKSkgPT0gbmZzLkpTKSB7CgkJCQkJbXNnLm5hbWUgPSBbXSwgbXNnLnR5cGUgPSBbXSwgbXNnLnRleHQgPSBbXQoJCQkJCWNhbi5jb3JlLkl0ZW0oY2FuLmNvcmUuVmFsdWUod2luZG93LCB0eXBlKSwgZnVuY3Rpb24oaywgdikgewoJCQkJCQltc2cuUHVzaChtZGIuTkFNRSwgayksIG1zZy5QdXNoKG1kYi5UWVBFLCB0eXBlb2YgdikKCQkJCQkJdHJ5IHsgbXNnLlB1c2gobWRiLlRFWFQsIHYpIH0gY2F0Y2ggKGUpIHsgbXNnLlB1c2gobWRiLlRFWFQsICIiKSB9CgkJCQkJfSkKCQkJCQltc2cuYXBwZW5kID0gW21kYi5OQU1FLCBtZGIuVFlQRSwgbWRiLlRFWFRdCgkJCQl9CgkJCQltc2cuTGVuZ3RoKCkgPT0gMCAmJiBwcmUudHJpbSgpID09ICIiICYmIGNhbi5jb3JlLkl0ZW0oY2FuLmNvcmUuVmFsdWUoY2FuLm9uc3ludGF4W2Nhbi5wYXJzZV0sIGNvZGUuS0VZV09SRCksIGZ1bmN0aW9uKGspIHsKCQkJCQltc2cuUHVzaChtZGIuTkFNRSwgaykKCQkJCX0pCgkJCQkKCQkJCWNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dmlldzogW1BSRSwgaHRtbC5ESVYsIHByZV19XSkKCQkJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZywgZnVuY3Rpb24odmFsdWUsIGtleSwgaW5kZXgpIHsgcmV0dXJuIHt0ZXh0OiBbdmFsdWUsIGh0bWwuVERdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCXZhciBsZWZ0ID0gY2FuLnVpLmN1cnJlbnQudmFsdWUuc2xpY2UoMCwgY2FuLnVpLmN1cnJlbnQuc2VsZWN0aW9uU3RhcnQpK3ZhbHVlCgkJCQkJY2FuLmN1cnJlbnQudGV4dChjYW4udWkuY3VycmVudC52YWx1ZSA9IGxlZnQrY2FuLnVpLmN1cnJlbnQudmFsdWUuc2xpY2UoY2FuLnVpLmN1cnJlbnQuc2VsZWN0aW9uRW5kKSkKCQkJCQljYW4udWkuY3VycmVudC5mb2N1cygpLCBjYW4udWkuY29udGVudC5zY3JvbGxMZWZ0IC09IDEwMDAwLCBjYW4udWkuY3VycmVudC5zZXRTZWxlY3Rpb25SYW5nZShsZWZ0Lmxlbmd0aCwgbGVmdC5sZW5ndGgpCgkJCQl9fSB9LCB0YXJnZXQpCgkJCX0pCgkJfQoKCQlmdW5jdGlvbiBmaWx0ZXIoKSB7CgkJCXJldHVybiBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtodG1sLlRCT0RZLCAgaHRtbC5UUl0sIGZ1bmN0aW9uKHRyKSB7CgkJCQlpZiAoIWNhbi5wYWdlLkNsYXNzTGlzdC5zZXQoY2FuLCB0ciwgaHRtbC5ISURFLCBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URCwgZnVuY3Rpb24odGQpIHsKCQkJCQlpZiAodGQuaW5uZXJUZXh0LnRvTG93ZXJDYXNlKCkuaW5kZXhPZihjYW4uYmFzZS50cmltU3VmZml4KChuYW1lID09IGljZS5QVD8gdHlwZTogbmFtZSkudG9Mb3dlckNhc2UoKSwgIigiKSkgPT0gMCkgeyByZXR1cm4gdGQgfQoJCQkJfSkubGVuZ3RoID09IDApKSB7IHJldHVybiB0ciB9CgkJCX0pLmxlbmd0aCA+IChuYW1lID09IGljZS5QVD8gMTogMCkKCQl9CgoJCWZ1bmN0aW9uIHNlbGVjdChpbmRleCwgdG90YWwpIHsgaW5kZXggPSAoaW5kZXgrKHRvdGFsKzEpKSUodG90YWwrMSkKCQkJaWYgKGluZGV4ID09IHRvdGFsKSB7IGNhbi5jdXJyZW50LnRleHQoY2FuLnVpLmN1cnJlbnQudmFsdWUgPSBjYW4udWkuY29tcGxldGUuX21zZy5PcHRpb24oUFJFKSkgfQoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIFtodG1sLlRCT0RZLCAidHI6bm90KC5oaWRlKSJdLCBmdW5jdGlvbih0ciwgaSkgeyBpZiAoY2FuLnBhZ2UuQ2xhc3NMaXN0LnNldChjYW4sIHRyLCBodG1sLlNFTEVDVCwgaSA9PSBpbmRleCkpIHsKCQkJCWNhbi5jdXJyZW50LnRleHQoY2FuLnVpLmN1cnJlbnQudmFsdWUgPSBjYW4udWkuY29tcGxldGUuX21zZy5PcHRpb24oUFJFKStjYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgaHRtbC5URClbMF0uaW5uZXJUZXh0KQoJCQl9IH0pCgkJCXJldHVybiBpbmRleAoJCX0KCgkJaWYgKGV2ZW50LmN0cmxLZXkpIHsKCQkJaWYgKGV2ZW50LnR5cGUgPT0gImtleXVwIikgewoJCQkJdmFyIHRvdGFsID0gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCBbaHRtbC5UQk9EWSwgInRyOm5vdCguaGlkZSkiXSkubGVuZ3RoCgkJCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQkJCWNhc2UgIm4iOiBjYW4udWkuY29tcGxldGUuX2luZGV4ID0gc2VsZWN0KGNhbi51aS5jb21wbGV0ZS5faW5kZXgrMSwgdG90YWwpOyBicmVhawoJCQkJCWNhc2UgInAiOiBjYW4udWkuY29tcGxldGUuX2luZGV4ID0gc2VsZWN0KGNhbi51aS5jb21wbGV0ZS5faW5kZXgtMSwgdG90YWwpOyBicmVhawoJCQkJCWRlZmF1bHQ6IHJldHVybiBmYWxzZQoJCQkJfQoJCQkJcmV0dXJuIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJCQl9CgkJCXJldHVybgoJCX0KCgkJY2FuLmN1cnJlbnQubGluZS5hcHBlbmRDaGlsZChjYW4udWkuY29tcGxldGUpLCBjYW4ucGFnZS5zdHlsZShjYW4sIGNhbi51aS5jb21wbGV0ZSwgaHRtbC5MRUZULCBjYW4udWkuY3VycmVudC5vZmZzZXRMZWZ0LTEsIGh0bWwuTUFSR0lOX1RPUCwgY2FuLnVpLmN1cnJlbnQub2Zmc2V0SGVpZ2h0KzQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCAiZGl2LnByZSIsIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS5pbm5lclRleHQgPSBjYW4udWkuY29tcGxldGUuX21zZy5PcHRpb24oUFJFKXx8cHJlIH0pCgkJaWYgKHByZSA9PSAiIikgeyByZXR1cm4gdXBkYXRlKHRhcmdldCkgfQoKCQlzd2l0Y2ggKGV2ZW50LmtleSkgewoJCQljYXNlIGh0bWwuRU5URVI6IHVwZGF0ZSh0YXJnZXQpOyBicmVhawoJCQljYXNlIGh0bWwuVEFCOiB1cGRhdGUodGFyZ2V0KTsgYnJlYWsKCQkJY2FzZSBpY2UuU1A6IHVwZGF0ZSh0YXJnZXQpOyBicmVhawoJCQljYXNlIGljZS5QVDogdXBkYXRlKHRhcmdldCk7IGJyZWFrCgkJCWRlZmF1bHQ6IGZpbHRlcigpIHx8IHVwZGF0ZSh0YXJnZXQpOyBicmVhawoJCX0gY2FuLnVpLmNvbXBsZXRlLl9pbmRleCA9IC0xCgl9LAoKCV9zZWxlY3RMaW5lOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLmN1cnJlbnQubGluZSwgInRkLnRleHQiLCBmdW5jdGlvbih0ZCkgeyBjYW4udWkuY3VycmVudC52YWx1ZSA9IHRkLmlubmVyVGV4dAoJCQljYW4uY3VycmVudC5saW5lLmFwcGVuZENoaWxkKGNhbi51aS5jdXJyZW50KSwgY2FuLnBhZ2Uuc3R5bGUoY2FuLCBjYW4udWkuY3VycmVudCwgaHRtbC5MRUZULCB0ZC5vZmZzZXRMZWZ0LTEsIGh0bWwuV0lEVEgsIGNhbi51aS5jb250ZW50LnN0eWxlLndpZHRoKQoJCQlpZiAoZXZlbnQpIHsKCQkJCWlmIChldmVudC50eXBlID09ICJjbGljayIgJiYgY2FuLm1vZGUgIT0gImluc2VydCIpIHsgY2FuLm9ua2V5bWFwLl9pbnNlcnQoZXZlbnQsIGNhbikKCQkJCQljYW4uY29yZS5UaW1lcigxMCwgZnVuY3Rpb24oKSB7IGNhbi5vbmFjdGlvbi5fY29tcGxldGUoZXZlbnQsIGNhbikgfSkKCQkJCX0KCQkJCWNhbi51aS5jdXJyZW50LmZvY3VzKCksIGNhbi51aS5jb250ZW50LnNjcm9sbExlZnQgLT0gMTAwMDAKCQkJCWNhbi5vbmtleW1hcC5jdXJzb3JNb3ZlKGNhbiwgY2FuLnVpLmN1cnJlbnQsIDAsIChldmVudC5vZmZzZXRYKS8xMi0xKQoJCQl9CgkJfSkKCX0sCglyZXJhbmtMaW5lOiBmdW5jdGlvbihjYW4sIHZhbHVlKSB7IGNhbi5tYXggPSAwCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVFIsIGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7CgkJCWNhbi5tYXgrKywgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgaXRlbSwgInRkLmxpbmUiLCBmdW5jdGlvbihpdGVtKSB7IGl0ZW0uaW5uZXJUZXh0ID0gaW5kZXgrMSB9KQoJCX0pCgl9LAoJaW5zZXJ0TGluZTogZnVuY3Rpb24oY2FuLCB2YWx1ZSwgYmVmb3JlKSB7CgkJdmFyIGxpbmUgPSBjYW4ub25hY3Rpb24uYXBwZW5kTGluZShjYW4sIHZhbHVlKQoJCWJlZm9yZSAmJiBjYW4udWkuY29udGVudC5pbnNlcnRCZWZvcmUobGluZSwgY2FuLm9uYWN0aW9uLl9nZXRMaW5lKGNhbiwgYmVmb3JlKSkKCQlyZXR1cm4gY2FuLm9uYWN0aW9uLnJlcmFua0xpbmUoY2FuKSwgY2FuLm9uYWN0aW9uLl9nZXRMaW5lbm8oY2FuLCBsaW5lKQoJfSwKCWRlbGV0ZUxpbmU6IGZ1bmN0aW9uKGNhbiwgbGluZSkgeyBsaW5lID0gY2FuLm9uYWN0aW9uLl9nZXRMaW5lKGNhbiwgbGluZSkKCQl2YXIgbmV4dCA9IGxpbmUubmV4dFNpYmxpbmd8fGxpbmUucHJldmlvdXNTaWJsaW5nCgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgbGluZSksIGNhbi5vbmFjdGlvbi5yZXJhbmtMaW5lKGNhbikKCQlyZXR1cm4gbmV4dAoJfSwKCW1vZGlmeUxpbmU6IGZ1bmN0aW9uKGNhbiwgbGluZSwgdmFsdWUpIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgaHRtbC5UUiwgZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsKCQkJaWYgKGl0ZW0gIT0gbGluZSAmJiBpbmRleCsxICE9IGxpbmUpIHsgcmV0dXJuIH0KCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgaXRlbSwgInRkLnRleHQiLCBmdW5jdGlvbihpdGVtKSB7CgkJCQljYW4ucGFnZS5BcHBlbmRzKGNhbiwgaXRlbSwgW2Nhbi5vbnN5bnRheC5fcGFyc2UoY2FuLCB2YWx1ZSldKQoJCQl9KQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFsi5paH5Lu25pWwIiwgIuaooeW8jyIsICLmjInplK4iLCAi6Kej5p6Q5ZmoIiwgIuaWh+S7tuWQjSIsICLlvZPliY3ooYwiLCAi6Lez6L2s5pWwIl19KQoK",
        "/plugin/local/team/plan.css": "ZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IHRkIHsgdmVydGljYWwtYWxpZ246dG9wOyB9CmZpZWxkc2V0LnBsYW4+ZGl2Lm91dHB1dCB0ZC5vdmVyIHsgYm9yZGVyOnNvbGlkIDJweCByZWQ7IH0KZmllbGRzZXQucGxhbj5kaXYub3V0cHV0IHRkIGRpdi5kYXRlIHsgY29sb3I6Z3JheTsgfQpmaWVsZHNldC5wbGFuPmRpdi5vdXRwdXQgZGl2LnByZXBhcmUgeyBiYWNrZ3JvdW5kLWNvbG9yOmJsdWU7IGNvbG9yOndoaXRlOyB9CmZpZWxkc2V0LnBsYW4+ZGl2Lm91dHB1dCBkaXYucHJvY2VzcyB7IGJhY2tncm91bmQtY29sb3I6Z3JlZW47IGNvbG9yOndoaXRlOyB9CmZpZWxkc2V0LnBsYW4+ZGl2Lm91dHB1dCBkaXYuY2FuY2VsIHsgYmFja2dyb3VuZC1jb2xvcjp5ZWxsb3c7IGNvbG9yOndoaXRlOyB9CmZpZWxkc2V0LnBsYW4+ZGl2Lm91dHB1dCBkaXYuZmluaXNoIHsgYmFja2dyb3VuZC1jb2xvcjpyZWQ7IGNvbG9yOndoaXRlOyB9CmJvZHkubW9iaWxlIGZpZWxkc2V0LnBsYW4+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQo=",
        "/plugin/local/team/plan.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgdGFyZ2V0KQoJCWNhbi51aSA9IGNhbi5vbmxheW91dC5wcm9maWxlKGNhbikKCQljYW4ub25pbXBvcnRbY2FuLk9wdGlvbigic2NhbGUiKXx8IndlZWsiXShjYW4sIG1zZykKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkucHJvamVjdCwge3N0eWxlOiB7Im1heC1oZWlnaHQiOiBjYW4udWkuY29udGVudC5vZmZzZXRIZWlnaHR9fSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkucHJvZmlsZSwge3N0eWxlOiB7Im1heC1oZWlnaHQiOiBjYW4udWkuY29udGVudC5vZmZzZXRIZWlnaHR9fSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkucHJvZmlsZSwge3N0eWxlOiB7ZGlzcGxheTogImJsb2NrIn19KQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWNhbi51c2VyLmlzTW9iaWxlICYmICFjYW4udXNlci5pc0xhbmRzY2FwZSgpICYmIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4udWkucHJvamVjdCkKCX0sCglfY29udGVudDogZnVuY3Rpb24oY2FuLCBtc2csIGhlYWQsIGxpc3QsIGtleSwgZ2V0LCBzZXQpIHsKCQl2YXIgaGFzaCA9IHt9OyBtc2cuVGFibGUoZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7IHZhciBrID0ga2V5KGNhbi5iYXNlLkRhdGUodmFsdWUuYmVnaW5fdGltZSkpOyBoYXNoW2tdID0gKGhhc2hba118fFtdKS5jb25jYXQoW3ZhbHVlXSkgfSkKCgkJY2FuLnN1cC50YXNrICYmIChjYW4uc3VwLnRhc2suX3RhcmdldCA9IG51bGwpCgkJdmFyIGJlZ2luX3RpbWUgPSBjYW4uYmFzZS5EYXRlKGNhbi5PcHRpb24oImJlZ2luX3RpbWUiKSkKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkuY29udGVudCwgW3t2aWV3OiBbY2hhdC5DT05URU5ULCBodG1sLlRBQkxFXSwgbGlzdDogY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihob3VyLCByb3cpIHsKCQkJcmV0dXJuIHt0eXBlOiBodG1sLlRSLCBsaXN0OiBjYW4uY29yZS5MaXN0KGhlYWQsIGZ1bmN0aW9uKHdlZWssIGNvbCkgewoJCQkJaWYgKHJvdyA9PSAwKSB7IHJldHVybiB7dGV4dDogW3dlZWssIGh0bWwuVEhdfSB9CgkJCQlpZiAoY29sID09IDApIHsgcmV0dXJuIHt0ZXh0OiBbaG91ciwgaHRtbC5URF19IH0KCQkJCXJldHVybiBjYW4ub25pbXBvcnQuX3Rhc2soY2FuLCBtc2csIGdldChiZWdpbl90aW1lLCBjb2wsIHJvdywgaGFzaCksIHNldChiZWdpbl90aW1lLCBjb2wsIHJvdykpCgkJCX0pfQoJCX0pIH1dKQoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMCkgeyByZXR1cm4gfQoJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgaWYgKCFjYW4uc3VwLnRhc2spIHsgcmV0dXJuIH0KCQkJdmFyIHRhcmdldCA9IGNhbi5zdXAudGFzay5fdGFyZ2V0fHxjYW4udGFzay5fdGFyZ2V0CgkJCWNhbi5zdXAudGFzayA9IG51bGwsIHRhcmdldC5jbGljaygpCgkJCWNhbi5TdGF0dXMoImNvdW50IiwgbXNnLkxlbmd0aCgpKQoJCX0pCgl9LAoJX3Rhc2s6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCB0aW1lKSB7IHJldHVybiB7dGV4dDogWyIiLCBodG1sLlREXSwKCQlvbmRibGNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQljYW4ub25hY3Rpb24uaW5zZXJ0VGFzayhldmVudCwgY2FuLCB0aW1lK2Nhbi5iYXNlLlRpbWUobnVsbCwgIiV5LSVtLSVkICVIOiVNOiVTIikuc2xpY2UodGltZS5sZW5ndGgpKQoJCX0sCgkJb25kcm9wOiBmdW5jdGlvbihldmVudCkgeyBldmVudC5wcmV2ZW50RGVmYXVsdCgpCgkJCWNhbi5kcm9wKGV2ZW50LCBldmVudC50YXJnZXQsIHRpbWUpCgkJfSwKCQlvbmRyYWdvdmVyOiBmdW5jdGlvbihldmVudCkgeyBldmVudC5wcmV2ZW50RGVmYXVsdCgpCgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCBodG1sLlRELCBmdW5jdGlvbihpdGVtKSB7CgkJCQljYW4ucGFnZS5DbGFzc0xpc3RbZXZlbnQudGFyZ2V0ID09IGl0ZW0/ICJhZGQiOiAiZGVsIl0oY2FuLCBpdGVtLCAib3ZlciIpCgkJCX0pCgkJfSwKCQlsaXN0OiBjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKHRhc2spIHsgcmV0dXJuIGNhbi5iYXNlLmlzU3RyaW5nKHRhc2spPyB7dGV4dDogW3Rhc2ssIGh0bWwuRElWLCAiZGF0ZSJdfToKCQkJCXt0ZXh0OiBbY2FuLm9uZXhwb3J0W2Nhbi5BY3Rpb24oInZpZXciKXx8InRleHQiXShjYW4sIHRhc2spLCBodG1sLkRJViwgY2FuLm9uZXhwb3J0LnN0eWxlKGNhbiwgdGFzayldLAoJCQkJCW9uZHJhZ3N0YXJ0OiBmdW5jdGlvbihldmVudCkgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OyBjYW4uZHJvcCA9IGZ1bmN0aW9uKGV2ZW50LCB0ZCwgdGltZSkgeyB0ZC5hcHBlbmQodGFyZ2V0KQoJCQkJCQljYW4ub25hY3Rpb24ubW9kaWZ5VGFzayhldmVudCwgY2FuLCB0YXNrLCAiYmVnaW5fdGltZSIsIHRpbWUrdGFzay5iZWdpbl90aW1lLnNsaWNlKHRpbWUubGVuZ3RoKSwgdGFzay5iZWdpbl90aW1lKQoJCQkJCX0gfSwgZHJhZ2dhYmxlOiB0aW1lICE9IHVuZGVmaW5lZCwKCgkJCQkJdGl0bGU6IGNhbi5vbmV4cG9ydC50aXRsZShjYW4sIHRhc2spLCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7CgkJCQkJCXZhciBpdGVtID0gY2FuLm9uYXBwZW5kLml0ZW0oY2FuLCBodG1sLklURU0sIHtuaWNrOiB0YXNrLm5hbWUrIjoiK3Rhc2sudGV4dH0sIGZ1bmN0aW9uKCkgewoJCQkJCQkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgeyBjYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuVEQsIHRhcmdldC5wYXJlbnROb2RlKSB9KQoJCQkJCQkJY2FuLm9uaW1wb3J0Ll9wcm9maWxlKGNhbiwgdGFzaykKCQkJCQkJfSwgZnVuY3Rpb24oKSB7CgoJCQkJCQl9LCBjYW4udWkucHJvamVjdCk7IHRhc2suX3RhcmdldCA9IHRhcmdldCwgY2FuLnRhc2sgPSBjYW4udGFza3x8dGFzaywgY2FuLnN1cC50YXNrID0gY2FuLnN1cC50YXNrfHx0YXNrCgkJCQkJCWNhbi5zdXAudGFzay56b25lID09IHRhc2suem9uZSAmJiBjYW4uc3VwLnRhc2suaWQgPT0gdGFzay5pZCAmJiAoY2FuLnN1cC50YXNrLl90YXJnZXQgPSB0YXJnZXQpCgkJCQkJCXRhcmdldC5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsgaXRlbS5jbGljaygpIH0KCQkJCQl9LAoJCQkJfQoJCX0pLAoJfSB9LAoJX3Byb2ZpbGU6IGZ1bmN0aW9uKGNhbiwgdGFzaykgewoJCWlmIChjYW4uc3VwLnRhc2sgJiYgY2FuLnN1cC50YXNrLnBvZCA9PSB0YXNrLnBvZCAmJiBjYW4uc3VwLnRhc2suaWQgPT0gdGFzay5pZCkgeyByZXR1cm4gfQoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsgcmV0dXJuIGNhbi5zdXAudGFzayA9IHRhc2ssIGNhbi5TdGF0dXModGFzayksIFt0YXNrLnBvZCwgdGFzay56b25lLCB0YXNrLmlkXS5qb2luKGljZS5QVCkgfSwgY2FuLnVpLnByb2ZpbGUsIGNhbi51aS5kaXNwbGF5KSkgeyByZXR1cm4gfQoKCQl0YXNrLmV4dHJhICYmIGNhbi5jb3JlLkl0ZW0oY2FuLmJhc2UuT2JqKHRhc2suZXh0cmEpLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHRhc2tbImV4dHJhLiIra2V5XSA9IHZhbHVlIH0pLCBkZWxldGUodGFzay5leHRyYSkKCQl2YXIgdGFibGUgPSBjYW4ucGFnZS5BcHBlbmRzKGNhbiwgY2FuLnVpLnByb2ZpbGUsIFt7dmlldzogW2NoYXQuQ09OVEVOVCwgaHRtbC5UQUJMRV0sIGxpc3Q6IFt7dGg6IFsia2V5IiwgInZhbHVlIl19XX1dKS5maXJzdAoJCWNhbi5jb3JlLkl0ZW0odGFzaywgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyBrZXkgIT0gIl90YXJnZXQiICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhYmxlLCBbewoJCQl0ZDogW2tleSwga2V5ID09ICJwb2QiICYmIHZhbHVlICE9ICIiPyBjYW4ucGFnZS5Gb3JtYXQoImEiLCBjYW4ubWlzYy5NZXJnZVVSTChjYW4sIHtwb2Q6IHZhbHVlfSksIHZhbHVlKTogdmFsdWVdLAoJCQlvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyBpZiAoZXZlbnQudGFyZ2V0LnR5cGUgPT0gImJ1dHRvbiIpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCBjYW4uc3VwLnRhc2spCgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgZXZlbnQudGFyZ2V0Lm5hbWVdLCBmdW5jdGlvbihtc2cpIHsgY2FuLlVwZGF0ZSgpIH0sIHRydWUpCgkJCX0gfSwKCQkJb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsgY2FuLm9ubW90aW9uLm1vZGlmeShjYW4sIGV2ZW50LnRhcmdldCwgZnVuY3Rpb24oZXYsIHZhbHVlLCBvbGQpIHsKCQkJCWNhbi5vbmFjdGlvbi5tb2RpZnlUYXNrKGV2ZW50LCBjYW4sIHRhc2ssIGtleSwgdmFsdWUpCgkJCX0sIHtuYW1lOiBrZXksIGFjdGlvbjoga2V5LmluZGV4T2YoInRpbWUiKSA+IDA/ICJkYXRlIjogImtleSJ9KSB9LAoJCX1dKSB9KSwgY2FuLm9uaW1wb3J0Ll9kaXNwbGF5KGNhbiwgdGFzaykKCX0sCglfZGlzcGxheTogZnVuY3Rpb24oY2FuLCB0YXNrKSB7IGlmICghdGFza1siZXh0cmEuY21kIl0pIHsgcmV0dXJuIH0KCQljYW4ub25hcHBlbmQucGx1Z2luKGNhbiwge3R5cGU6IGNoYXQuU1RPUlksIGN0eDogdGFza1siZXh0cmEuY3R4Il0sIGNtZDogdGFza1siZXh0cmEuY21kIl0sIGFyZzogdGFza1siZXh0cmEuYXJnIl19LCBmdW5jdGlvbihzdWIsIG1ldGEpIHsKCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGtpdC5EaWN0KCJ0YXNrLnBvZCIsIHRhc2tbInBvZCJdLCAidGFzay56b25lIiwgdGFzay56b25lLCAidGFzay5pZCIsIHRhc2suaWQpKQoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIHRhc2tbbWRiLlpPTkVdLCB0YXNrW21kYi5JRF1dLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQl9LCBjYW4udWkuZGlzcGxheSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkuZGlzcGxheSwge3N0eWxlOiB7ZGlzcGxheTogaHRtbC5CTE9DS319KQoJfSwKCglkYXk6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJdmFyIGhlYWQgPSBbImhvdXIiLCAidGFzayJdCgkJdmFyIGxpc3QgPSBbMF07IGZvciAodmFyIGkgPSA3OyBpIDwgMjQ7IGkrKykgeyBsaXN0LnB1c2goY2FuLmJhc2UuTnVtYmVyKGksIDIpKSB9CgoJCWZ1bmN0aW9uIGtleSh0aW1lKSB7IHJldHVybiBjYW4uYmFzZS5OdW1iZXIodGltZS5nZXRIb3VycygpLCAyKSB9CgkJZnVuY3Rpb24gZ2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93LCBoYXNoKSB7IHJldHVybiBoYXNoW2xpc3Rbcm93XV0gfQoJCWZ1bmN0aW9uIHNldChiZWdpbl90aW1lLCBjb2wsIHJvdykgeyByZXR1cm4gY2FuLmJhc2UuVGltZShiZWdpbl90aW1lLCAiJXktJW0tJWQgIikrbGlzdFtyb3ddIH0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKCXdlZWs6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJdmFyIGhlYWQgPSBbImhvdXIiXS5jb25jYXQoWyLlkajml6UiLCAi5ZGo5LiAIiwgIuWRqOS6jCIsICLlkajkuIkiLCAi5ZGo5ZubIiwgIuWRqOS6lCIsICLlkajlha0iXSkKCQl2YXIgbGlzdCA9IFswXTsgZm9yICh2YXIgaSA9IDc7IGkgPCAyNDsgaSsrKSB7IGxpc3QucHVzaChjYW4uYmFzZS5OdW1iZXIoaSwgMikpIH0KCgkJZnVuY3Rpb24ga2V5KHRpbWUpIHsgcmV0dXJuIHRpbWUuZ2V0RGF5KCkrIiAiK2Nhbi5iYXNlLk51bWJlcih0aW1lLmdldEhvdXJzKCksIDIpIH0KCQlmdW5jdGlvbiBnZXQoYmVnaW5fdGltZSwgY29sLCByb3csIGhhc2gpIHsgcmV0dXJuIGhhc2hbY29sLTErIiAiK2xpc3Rbcm93XV0gfQoJCWZ1bmN0aW9uIHNldChiZWdpbl90aW1lLCBjb2wsIHJvdykgeyByZXR1cm4gY2FuLmJhc2UuVGltZShjYW4uYmFzZS5UaW1lQWRkKGJlZ2luX3RpbWUsIC1iZWdpbl90aW1lLmdldERheSgpK2NvbC0xKSwgIiV5LSVtLSVkICIpK2xpc3Rbcm93XSB9CgoJCWNhbi5vbmltcG9ydC5fY29udGVudChjYW4sIG1zZywgaGVhZCwgbGlzdCwga2V5LCBnZXQsIHNldCkKCX0sCgltb250aDogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQl2YXIgaGVhZCA9IFsib3JkZXIiXS5jb25jYXQoWyLlkajml6UiLCAi5ZGo5LiAIiwgIuWRqOS6jCIsICLlkajkuIkiLCAi5ZGo5ZubIiwgIuWRqOS6lCIsICLlkajlha0iXSkKCQl2YXIgbGlzdCA9IFswXTsgZm9yICh2YXIgaSA9IDE7IGkgPCA2OyBpKyspIHsgbGlzdC5wdXNoKGkpIH0KCgkJZnVuY3Rpb24ga2V5KHRpbWUpIHsgcmV0dXJuIGNhbi5iYXNlLlRpbWUodGltZSwgIiV5LSVtLSVkIikgfQoJCWZ1bmN0aW9uIGdldChiZWdpbl90aW1lLCBjb2wsIHJvdywgaGFzaCkgewoJCQl2YXIgYmVnaW4gPSBjYW4uYmFzZS5UaW1lQWRkKGJlZ2luX3RpbWUsIC0oYmVnaW5fdGltZS5nZXREYXRlKCktMSkpCgkJCXZhciBsYXN0ID0gY2FuLmJhc2UuVGltZUFkZChiZWdpbl90aW1lLCAtKGJlZ2luX3RpbWUuZ2V0RGF0ZSgpLTEpLWJlZ2luLmdldERheSgpKQoJCQl2YXIgZGF5ID0gY2FuLmJhc2UuVGltZUFkZChsYXN0LCAocm93LTEpKjcrY29sKQoJCQlyZXR1cm4gW2RheS5nZXREYXRlKCkrIiJdLmNvbmNhdChoYXNoW2tleShkYXkpXXx8W10pCgkJfQoJCWZ1bmN0aW9uIHNldChiZWdpbl90aW1lLCBjb2wsIHJvdykgewoJCQl2YXIgYmVnaW4gPSBjYW4uYmFzZS5UaW1lQWRkKGJlZ2luX3RpbWUsIC0oYmVnaW5fdGltZS5nZXREYXRlKCktMSkpCgkJCXZhciBsYXN0ID0gY2FuLmJhc2UuVGltZUFkZChiZWdpbl90aW1lLCAtKGJlZ2luX3RpbWUuZ2V0RGF0ZSgpLTEpLWJlZ2luLmdldERheSgpKQoJCQl2YXIgZGF5ID0gY2FuLmJhc2UuVGltZUFkZChsYXN0LCAocm93LTEpKjcrY29sKQoJCQlyZXR1cm4ga2V5KGRheSkKCQl9CgoJCWNhbi5vbmltcG9ydC5fY29udGVudChjYW4sIG1zZywgaGVhZCwgbGlzdCwga2V5LCBnZXQsIHNldCkKCX0sCgl5ZWFyOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciBoZWFkID0gWyJtb250aCJdLmNvbmNhdChbIuWRqOaXpSIsICLlkajkuIAiLCAi5ZGo5LqMIiwgIuWRqOS4iSIsICLlkajlm5siLCAi5ZGo5LqUIiwgIuWRqOWFrSJdKTsKCQl2YXIgbGlzdCA9IFswXTsgZm9yICh2YXIgaSA9IDE7IGkgPCAxMzsgaSsrKSB7IGxpc3QucHVzaChpKSB9CgoJCWZ1bmN0aW9uIGtleSh0aW1lKSB7IHJldHVybiBjYW4uYmFzZS5UaW1lKHRpbWUsICIleS0lbSAiKSt0aW1lLmdldERheSgpIH0KCQlmdW5jdGlvbiBnZXQoYmVnaW5fdGltZSwgY29sLCByb3csIGhhc2gpIHsgcmV0dXJuIGhhc2hbYmVnaW5fdGltZS5nZXRGdWxsWWVhcigpKyItIitjYW4uYmFzZS5OdW1iZXIocm93LCAyKSsiICIrKGNvbC0xKV0gfQoJCWZ1bmN0aW9uIHNldChiZWdpbl90aW1lLCBjb2wsIHJvdykgeyByZXR1cm4gYmVnaW5fdGltZS5nZXRGdWxsWWVhcigpKyItIitjYW4uYmFzZS5OdW1iZXIobGlzdFtyb3ddLCAyKSB9CgoJCWNhbi5vbmltcG9ydC5fY29udGVudChjYW4sIG1zZywgaGVhZCwgbGlzdCwga2V5LCBnZXQsIHNldCkKCX0sCglsb25nOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciBiZWdpbl90aW1lID0gY2FuLmJhc2UuRGF0ZShjYW4uYmFzZS5UaW1lKGNhbi5PcHRpb24oImJlZ2luX3RpbWUiKSwgIiV5LSVtLSVkICVIOiVNOiVTIikpCgkJdmFyIGJlZ2luID0gYmVnaW5fdGltZS5nZXRGdWxsWWVhcigpIC0gNQoKCQl2YXIgaGVhZCA9IFsibW9udGgiXTsgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7IGhlYWQucHVzaChiZWdpbitpKSB9CgkJdmFyIGxpc3QgPSBbMF07IGZvciAodmFyIGkgPSAxOyBpIDwgMTM7IGkrKykgeyBsaXN0LnB1c2goaSkgfQoKCQlmdW5jdGlvbiBrZXkodGltZSkgeyByZXR1cm4gY2FuLmJhc2UuVGltZSh0aW1lLCAiJXktJW0iKSB9CgkJZnVuY3Rpb24gZ2V0KGJlZ2luX3RpbWUsIGNvbCwgcm93LCBoYXNoKSB7IHJldHVybiBoYXNoW2JlZ2luK2NvbC0xKyItIitjYW4uYmFzZS5OdW1iZXIocm93LCAyKV0gfQoJCWZ1bmN0aW9uIHNldChiZWdpbl90aW1lLCBjb2wsIHJvdykgeyByZXR1cm4gYmVnaW4rY29sLTErIi0iK2Nhbi5iYXNlLk51bWJlcihyb3csIDIpIH0KCgkJY2FuLm9uaW1wb3J0Ll9jb250ZW50KGNhbiwgbXNnLCBoZWFkLCBsaXN0LCBrZXksIGdldCwgc2V0KQoJfSwKfSwgWyIiXSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLnu4Tku7bkuqTkupIiLCBsaXN0OiBbCgkJImluc2VydCIsICJleHBvcnQiLCAiaW1wb3J0IiwKCQlbImxldmVsIiwgImFsbCIsICJsMSIsICJsMiIsICJsMyIsICJsNCIsICJsNSJdLAoJCVsic3RhdHVzIiwgImFsbCIsICJwcmVwYXJlIiwgInByb2Nlc3MiLCAiY2FuY2VsIiwgImZpbmlzaCJdLAoJCVsic2NvcmUiLCAiYWxsIiwgInMxIiwgInMyIiwgInMzIiwgInM0IiwgInM1Il0sCgkJWyJ2aWV3IiwgIiIsICJuYW1lIiwgInRleHQiLCAibGV2ZWwiLCAic2NvcmUiXSwKCV0sCglpbnNlcnRUYXNrOiBmdW5jdGlvbihldmVudCwgY2FuLCB0aW1lKSB7IHZhciBtc2cgPSBjYW4uc3VwLnJlcXVlc3QoZXZlbnQsIHtiZWdpbl90aW1lOiB0aW1lfSkKCQljYW4udXNlci5pbnB1dChldmVudCwgY2FuLCBjYW4uQ29uZigiZmVhdHVyZS5pbnNlcnQiKSwgZnVuY3Rpb24oZXZlbnQsIGJ1dHRvbiwgZGF0YSwgbGlzdCkgewoJCQljYW4ucnVuKGV2ZW50LCBjYW4uYmFzZS5TaW1wbGUoY3R4LkFDVElPTiwgbWRiLklOU0VSVCwgZGF0YSwgImJlZ2luX3RpbWUiLCB0aW1lKSwgdHJ1ZSkKCQl9KQoJfSwKCW1vZGlmeVRhc2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRhc2ssIGtleSwgdmFsdWUpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50LCB0YXNrKQoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuTU9ESUZZLCBrZXksIHZhbHVlLCB0YXNrW2tleV1dKQoJfSwKCglfZmlsdGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7IHZhciBjb3VudCA9IDAKCQlpZiAodmFsdWUgPT0gImFsbCIpIHsKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJkaXYuaXRlbSIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAiaGlkZSIpLCBjb3VudCsrCgkJCX0pCgkJfSBlbHNlIHsKCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJkaXYuaXRlbSIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCAiaGlkZSIpCgkJCX0pCgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAiZGl2LiIrdmFsdWUsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAiaGlkZSIpLCBjb3VudCsrCgkJCX0pCgkJfQoJCWNhbi5BY3Rpb24oa2V5LCB2YWx1ZSksIGNhbi5TdGF0dXMoImNvdW50IiwgY291bnQpCgl9LAoJbGV2ZWw6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgY2FuLm9uYWN0aW9uLl9maWx0ZXIoZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgfSwKCXN0YXR1czogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2ZpbHRlcihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB9LAoJc2NvcmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgY2FuLm9uYWN0aW9uLl9maWx0ZXIoZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgfSwKCXZpZXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsKCQljYW4uQWN0aW9uKGtleSwgdmFsdWUpCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLnByb2plY3QpCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLm9uaW1wb3J0W2Nhbi5PcHRpb24oInNjYWxlIildKGNhbiwgY2FuLl9tc2cpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFsiY291bnQiLCAiYmVnaW5fdGltZSIsICJ6b25lIiwgImlkIiwgInR5cGUiLCAibmFtZSIsICJ0ZXh0Il0sCgluYW1lOiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuIHRhc2submFtZSB9LAoJdGV4dDogZnVuY3Rpb24oY2FuLCB0YXNrKSB7IHJldHVybiB0YXNrLm5hbWUrIjogIisodGFzay50ZXh0fHwiIikgfSwKCWxldmVsOiBmdW5jdGlvbihjYW4sIHRhc2spIHsgcmV0dXJuICJsLSIrKHRhc2subGV2ZWx8fDMpKyI6ICIrKHRhc2submFtZXx8IiIpIH0sCglzY29yZTogZnVuY3Rpb24oY2FuLCB0YXNrKSB7IHJldHVybiAicy0iKyh0YXNrLmxldmVsfHwzKSsiOiAiKyh0YXNrLm5hbWV8fCIiKSB9LAoJdGl0bGU6IGZ1bmN0aW9uKGNhbiwgdGFzaykgeyByZXR1cm4gdGFzay56b25lKyI6ICIrKHRhc2sudHlwZXx8IiIpIH0sCglzdHlsZTogZnVuY3Rpb24oY2FuLCB0YXNrKSB7IHJldHVybiBbIml0ZW0iLCB0YXNrLnN0YXR1cywgImlkIit0YXNrLmlkLCAibCIrKHRhc2subGV2ZWx8fCIiKSwgInMiKyh0YXNrLnNjb3JlfHwiIildLmpvaW4oIiAiKSB9LAp9KQoK",
        "/plugin/local/wiki/data.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYikgewoJCWNhbi51aSA9IGNhbi5vbmxheW91dC5kaXNwbGF5KGNhbikKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCgkJY2FuLnRhYmxlID0gY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBpbmRleCwgbGluZSkgewoJCQlyZXR1cm4ge3RleHQ6IFt2YWx1ZSwgInRkIl0sIG9uY29udGV4dG1lbnU6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4udXNlci5jYXJ0ZShldmVudCwgY2FuLCBjYW4ub25kZXRhaWwsIGNhbi5vbmRldGFpbC5saXN0LCBmdW5jdGlvbihldiwgY21kLCBtZXRhKSB7CgkJCQkJdmFyIGNiID0gbWV0YVtjbWRdOyBjYiAmJiBjYihldmVudCwgY2FuLCBjbWQsIHZhbHVlLCBrZXksIGluZGV4LCBsaW5lKQoJCQkJfSkKCQkJfSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGV2ZW50LnRhcmdldCwge2NvbnRlbnRlZGl0YWJsZTogdHJ1ZX0pCgkJCX0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoa2V5ID09ICJwYXRoIikgeyBjYW4ucnVuKGV2ZW50LCBbY2FuLk9wdGlvbigicGF0aCIsIHZhbHVlKV0pIH0KCQkJfX0KCQl9LCBjYW4udWkuY29udGVudCkKCgkJY2FuLm9uZXhwb3J0Lmxpc3QgPSBtc2cuYXBwZW5kCgkJY2FuLm9uYWN0aW9uLl9jb21wdXRlKGV2ZW50LCBjYW4pCgl9LAp9KQpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFtdLAoJIuaxguWSjCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHJlcywgdGQsIGluZGV4KSB7CgkJcmVzW2luZGV4XSA9IHBhcnNlSW50KHRkLmlubmVyVGV4dCkgKyAocmVzW2luZGV4XXx8MCk7Cgl9LAoJIuacgOWkpyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHJlcywgdGQsIGluZGV4KSB7CgkJdmFyIG4gPSBwYXJzZUludCh0ZC5pbm5lclRleHQpOwoJCW4gPiAocmVzW2luZGV4XXx8LTEwMDAwKSAmJiAocmVzW2luZGV4XSA9IG4pOwoJfSwKCSLmnIDlsI8iOiBmdW5jdGlvbihldmVudCwgY2FuLCByZXMsIHRkLCBpbmRleCkgewoJCXZhciBuID0gcGFyc2VJbnQodGQuaW5uZXJUZXh0KTsKCQluIDwgKHJlc1tpbmRleF18fDEwMDAwKSAmJiAocmVzW2luZGV4XSA9IG4pOwoJfSwKCSLlubPlnYciOiBmdW5jdGlvbihldmVudCwgY2FuLCByZXMsIHRkLCBuY29sLCBjb2xzLCByb3dzLCBucm93KSB7CgkJcmVzW25jb2xdID0gcGFyc2VJbnQodGQuaW5uZXJUZXh0KSArIChyZXNbbmNvbF18fDApOwoJCWlmIChucm93ID09IHJvd3MubGVuZ3RoIC0gMSkgewoJCQlyZXNbbmNvbF0gPSByZXNbbmNvbF0gLyBucm93CgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLnu4Tku7boj5zljZUiLCBsaXN0OiBbIuS/neWtmCIsIFsibW9kZSIsICLlhajpgIkiLCAi5Z2X6YCJIiwgIuWPjemAiSIsICLlpJrpgIkiLCAi5ouW5YqoIiwgIue8lui+kSJdLCBbInNvbWUiLCAi5rGC5ZKMIiwgIuacgOWkpyIsICLmnIDlsI8iLCAi5bmz5Z2HIl1dLAoJX2NvbXB1dGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgbXVsID0gInRyIiArIChjYW4uQWN0aW9uKCJtb2RlIikgPT0gIuWFqOmAiSI/ICIiOiAiLnNlbGVjdCIpCgkJdmFyIG1ldGhvZCA9IGNhbi5vbmZpZ3VyZVtjYW4uQWN0aW9uKCJzb21lIildLCByZXMgPSB7fQoKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4udWkuY29udGVudCwgbXVsLCBmdW5jdGlvbih0ciwgbnJvdywgcm93cykgewoJCQkobXVsICE9ICJ0ciIgfHwgbnJvdyA+IDApICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIHRyLCAidGQiLCBmdW5jdGlvbih0ZCwgbmNvbCwgY29scykgewoJCQkJbWV0aG9kICYmIG1ldGhvZChldmVudCwgY2FuLCByZXMsIHRkLCBuY29sLCBjb2xzLCByb3dzLCBucm93KQoJCQl9KQoJCX0pCgoJCWNhbi5jb3JlLkl0ZW0ocmVzLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCWNhbi5TdGF0dXMoY2FuLl9tc2cuYXBwZW5kW2tleV0sIHZhbHVlfHwiIikKCQl9KQoJfSwKCgki5L+d5a2YIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGNtZCwgY2FuLk9wdGlvbigicGF0aCIpLCBjYW4ub25leHBvcnQuZmlsZShjYW4pXSwgZnVuY3Rpb24obXNnKSB7CgkJCWNhbi51c2VyLnRvYXN0U3VjY2VzcyhjYW4pCgkJfSwgdHJ1ZSkKCX0sCglzb21lOiBmdW5jdGlvbihldmVudCwgY2FuLCBjbWQpIHsKCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCX0sCgoJIuWFqOmAiSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNtZCAmJiBjYW4uQWN0aW9uKCJtb2RlIiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAib3ZlciIpCgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJaXRlbS5zZXRBdHRyaWJ1dGUoImNvbnRlbnRlZGl0YWJsZSIsIGZhbHNlKQoJCQlpdGVtLnNldEF0dHJpYnV0ZSgiZHJhZ2dhYmxlIiwgZmFsc2UpCgkJCWl0ZW0ub25tb3VzZWVudGVyID0gbnVsbAoJCQlpdGVtLm9uY2xpY2sgPSBudWxsCgkJfSkKCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCX0sCgki5Z2X6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbm1vdXNlZW50ZXIgPSBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJCWNhbi5vbmFjdGlvbi5fY29tcHV0ZShldmVudCwgY2FuKQoJCQl9CgkJfSkKCX0sCgki5Y+N6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbm1vdXNlZW50ZXIgPSBmdW5jdGlvbigpIHsKCQkJCWNhbi5wYWdlLkNsYXNzTGlzdC5kZWwoY2FuLCBpdGVtLCAic2VsZWN0IikKCQkJCWNhbi5vbmFjdGlvbi5fY29tcHV0ZShldmVudCwgY2FuKQoJCQl9CgkJfSkKCX0sCgki5aSa6YCJIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY21kICYmIGNhbi5BY3Rpb24oIm1vZGUiLCBjbWQpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0ciIsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJaXRlbS5vbmNsaWNrID0gZnVuY3Rpb24oKSB7CgkJCQljYW4ucGFnZS5DbGFzc0xpc3QubmVnKGNhbiwgaXRlbSwgInNlbGVjdCIpCgkJCQljYW4ub25hY3Rpb24uX2NvbXB1dGUoZXZlbnQsIGNhbikKCQkJfQoJCX0pCgl9LAoJIuaLluWKqCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNhbi5vbmFjdGlvblsi5YWo6YCJIl0oZXZlbnQsIGNhbiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uc2V0QXR0cmlidXRlKCJkcmFnZ2FibGUiLCB0cnVlKQoJCQlpdGVtLm9uZHJhZ3N0YXJ0ID0gZnVuY3Rpb24oZXZlbnQpIHsgY2FuLmRyYWcgPSBpdGVtIH0KCQkJaXRlbS5vbmRyYWdvdmVyID0gZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIGl0ZW0sICJvdmVyIil9CgkJCWl0ZW0ub25kcmFnbGVhdmUgPSBmdW5jdGlvbihldmVudCkgeyBjYW4ucGFnZS5DbGFzc0xpc3QuZGVsKGNhbiwgaXRlbSwgIm92ZXIiKSB9CgkJCWl0ZW0ub25kcm9wID0gZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKQoJCQkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsICJ0YWJsZSIsIGZ1bmN0aW9uKHRhYmxlKSB7CgkJCQkJdGFibGUuaW5zZXJ0QmVmb3JlKGNhbi5kcmFnLCBpdGVtKQoJCQkJfSkKCQkJfQoJCX0pCgl9LAoJIue8lui+kSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCkgewoJCWNtZCAmJiBjYW4uQWN0aW9uKCJtb2RlIiwgY21kKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0uc2V0QXR0cmlidXRlKCJjb250ZW50ZWRpdGFibGUiLCB0cnVlKQoJCX0pCgl9LAp9KQpWb2xjYW5vcygib25kZXRhaWwiLCB7aGVscDogIue7hOS7tuivpuaDhSIsIGxpc3Q6IFsi5aSN5Yi2IiwgIuWIoOmZpCJdLAoJIuWkjeWItiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGNtZCwgdmFsdWUsIGtleSwgaW5kZXgsIGxpbmUpIHsKCQl2YXIgZW5kID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnRhYmxlLCBbe3R5cGU6ICJ0ciIsIGxpc3Q6IGNhbi5jb3JlLkxpc3QoY2FuLl9tc2cuYXBwZW5kLCBmdW5jdGlvbihrZXkpIHsKCQkJcmV0dXJuIHt0ZXh0OiBbbGluZVtrZXldLCAidGQiXX0KCQl9KX1dKS50cgoJCWNhbi50YWJsZS5pbnNlcnRCZWZvcmUoZW5kLCBldmVudC50YXJnZXQucGFyZW50Tm9kZSkKCX0sCgki5Yig6ZmkIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgY21kKSB7CgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgZXZlbnQudGFyZ2V0LnBhcmVudE5vZGUpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdLAoJZmlsZTogZnVuY3Rpb24oY2FuKSB7CgkJcmV0dXJuIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5jb250ZW50LCAidHIiLCBmdW5jdGlvbih0cikgewoJCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdHIsICJ0aCx0ZCIsIGZ1bmN0aW9uKHRkKSB7cmV0dXJuIHRkLmlubmVySFRNTH0pLmpvaW4oIiwiKQoJCX0pLmpvaW4oIlxuIikKCX0sCn0pCgo=",
        "/plugin/local/wiki/draw.css": "ZmllbGRzZXQuZHJhdyBkaXYub3V0cHV0IHsgYmFja2dyb3VuZC1jb2xvcjojMWI1YjczOGM7IGZvbnQtc2l6ZToyMHB4OyB9CmZpZWxkc2V0LmRyYXcgZGl2Lm91dHB1dCBkaXYuY29udGVudCBzdmcgeyBiYWNrZ3JvdW5kLWNvbG9yOiMxYjViNzM4YzsgfQpmaWVsZHNldC5kcmF3IGRpdi5vdXRwdXQgZGl2LmRpc3BsYXkgeyBtYXgtaGVpZ2h0OjQwMHB4OyB9Cg==",
        "/plugin/local/wiki/draw.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX2FjdGlvbikKCQljYW4ub25pbXBvcnQuX3Nob3coY2FuLCBtc2cpLCBjYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQljYW4ua2V5bGlzdCA9IFtdLCBjYW4ub25rZXltYXAuX2J1aWxkKGNhbikKCX0sCglfc2hvdzogZnVuY3Rpb24oY2FuLCBtc2cpIHsgY2FuLnBvaW50ID0gW10KCQljYW4uc3ZnID0gbnVsbCwgY2FuLmdyb3VwID0gbnVsbCwgY2FuLnRlbXAgPSBudWxsLCBjYW4uY3VycmVudCA9IG51bGwKCgkJLy8g5Yqg6L295Zu+5b2iCgkJY2FuLnVpID0gY2FuLm9ubGF5b3V0LnByb2ZpbGUoY2FuKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi51aS5jb250ZW50LCBtc2cuUmVzdWx0KCl8fGNhbi5vbmV4cG9ydC5jb250ZW50KGNhbikpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLnVpLmNvbnRlbnQsIGh0bWwuU1ZHLCBmdW5jdGlvbihzdmcpIHsKCQkJY2FuLnN2ZyA9IGNhbi5ncm91cCA9IGNhbi5vbmltcG9ydC5fYmxvY2soY2FuLCBzdmcpLCBjYW4ub25pbXBvcnQuX2dyb3VwKGNhbiwgc3ZnKS5jbGljaygpCgkJCWNhbi5jb3JlLkl0ZW1DQihjYW4ub25hY3Rpb24sIGZ1bmN0aW9uKGtleSwgY2IpIHsgc3ZnW2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgY2FuKSB9IH0pCgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHN2ZywgIioiLCBmdW5jdGlvbihpdGVtLCBpbmRleCkgeyBjYW4ub25pbXBvcnQuX2Jsb2NrKGNhbiwgaXRlbSkKCQkJCWl0ZW0udGFnTmFtZSA9PSBzdmcuRyAmJiBpdGVtLlZhbHVlKGh0bWwuQ0xBU1MpICYmIGNhbi5vbmltcG9ydC5fZ3JvdXAoY2FuLCBpdGVtKQoJCQl9KQoJCX0pCgkJLy8g6buY6K6k5Y+C5pWwCgkJY2FuLmNvcmUuVGltZXIoMTAsIGZ1bmN0aW9uKCkgewoJCQljYW4uY29yZS5JdGVtKHsKCQkJCSJzdHJva2Utd2lkdGgiOiAyLCBzdHJva2U6IGNsaS5ZRUxMT1csIGZpbGw6IGNsaS5QVVJQTEUsCgkJCQkiZm9udC1zaXplIjogMjQsICJmb250LWZhbWlseSI6IGh0bWwuTU9OT1NQQUNFLAoJCQkJZ286IGljZS5SVU4sIHNoYXBlOiAicmVjdCIsIGdyaWQ6IDEwLAoJCQl9LCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGNhbi5zdmcuVmFsdWUoa2V5LCBjYW4uQWN0aW9uKGtleSwgY2FuLnN2Zy5WYWx1ZShrZXkpfHx2YWx1ZSkpIH0pCgoJCQl2YXIgcGlkID0gY2FuLk9wdGlvbigicGlkIil8fGNhbi5zdmcuVmFsdWUoInBpZCIpOyBjYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLnVpLnByb2ZpbGUsIHRydWUpCgkJCXBpZCAmJiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uc3ZnLCBpY2UuUFQrcGlkLCBmdW5jdGlvbihpdGVtKSB7CgkJCQljYW4ub25kZXRhaWwucnVuKHt0YXJnZXQ6IGl0ZW19LCBjYW4pLCBjYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBpdGVtKQoJCQl9KSB8fCBjYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBjYW4uc3ZnKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9maWxlKQoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBjYW4udWkuZGlzcGxheSwge3N0eWxlOiB7Im1pbi1oZWlnaHQiOiA4MCwgIm1heC1oZWlnaHQiOiBjYW4uQ29uZigiaGVpZ2h0IiktY2FuLnN2Zy5WYWwoImhlaWdodCIpLTUyfX0pCgkJfSkgCgl9LAoJX2dyb3VwOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyB2YXIgbmFtZSA9IHRhcmdldC5Hcm91cHMoKQoJCWZ1bmN0aW9uIHNob3coZXZlbnQpIHsgY2FuLmdyb3VwID0gdGFyZ2V0CgkJCWNhbi5jb3JlLkxpc3QoW2h0bWwuU1RST0tFX1dJRFRILCBodG1sLlNUUk9LRSwgaHRtbC5GSUxMLCBodG1sLkZPTlRfU0laRV0sIGZ1bmN0aW9uKGtleSkgewoJCQkJY2FuLkFjdGlvbihrZXksIHRhcmdldC5WYWx1ZShrZXkpfHxjYW4uQWN0aW9uKGtleSkpCgkJCX0pCgkJfQoJCXJldHVybiAobmFtZSB8fCB0YXJnZXQgPT0gY2FuLnN2ZykgJiYgY2FuLm9uYXBwZW5kLml0ZW0oY2FuLCBodG1sLklURU0sIHtuYW1lOiBuYW1lfHxodG1sLlNWR30sIGZ1bmN0aW9uKGV2ZW50KSB7IHNob3coZXZlbnQpCgkJCWNhbi5vbmFjdGlvbi5zaG93KGV2ZW50LCBjYW4pCgkJfSwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnVzZXIuY2FydGVSaWdodChldmVudCwgY2FuLCBjYW4ub25hY3Rpb24sIFtpY2UuSElERSwgaWNlLlNIT1csIG1kYi5DUkVBVEUsIGNsaS5DTEVBUiwgbWRiLlJFTU9WRV0pCgkJfSwgY2FuLnVpLnByb2plY3QpCgl9LAoJX2Jsb2NrOiBmdW5jdGlvbihjYW4sIHRhcmdldCkgewoJCXRhcmdldC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJdmFyIGNhcnRlID0gY2FuLnVzZXIuY2FydGUoZXZlbnQsIGNhbiwgY2FuLm9uZGV0YWlsLCBudWxsLCBmdW5jdGlvbihldiwgYnV0dG9uLCBtZXRhKSB7CgkJCQltZXRhW2J1dHRvbl0oZXZlbnQsIGNhbiwgYnV0dG9uKQoJCQl9KTsgY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FydGUuX3RhcmdldCwge3N0eWxlOiB7bGVmdDogZXZlbnQuY2xpZW50WCwgdG9wOiBldmVudC5jbGllbnRZfX0pCgkJfQoJCXRhcmdldC5WYWwgPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7CgkJCXJldHVybiBwYXJzZUludCh0YXJnZXQuVmFsdWUoa2V5LCB2YWx1ZSA9PSB1bmRlZmluZWQ/IHZhbHVlOiBwYXJzZUludCh2YWx1ZSl8fDApKXx8MAoJCX0KCQl0YXJnZXQuVmFsdWUgPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7IGlmIChjYW4uYmFzZS5pc1VuZGVmaW5lZChrZXkpKSB7IHJldHVybiB9CgkJCWlmIChjYW4uYmFzZS5pc09iamVjdChrZXkpKSB7IGNhbi5jb3JlLkl0ZW0oa2V5LCB0YXJnZXQuVmFsdWUpOyByZXR1cm4gfQoKCQkJdmFyIGZpZ3VyZSA9IGNhbi5vbmZpZ3VyZS5fZ2V0KGNhbiwgdGFyZ2V0KQoJCQlrZXkgPSBmaWd1cmUgJiYgZmlndXJlLmRhdGEgJiYgZmlndXJlLmRhdGEuc2l6ZSAmJiBmaWd1cmUuZGF0YS5zaXplW2tleV0gfHwga2V5CgkJCWlmIChmaWd1cmUgJiYgZmlndXJlLmRhdGEgJiYgY2FuLmJhc2UuaXNGdW5jKGZpZ3VyZS5kYXRhW2tleV0pKSB7CgkJCQlyZXR1cm4gZmlndXJlLmRhdGFba2V5XShjYW4sIHZhbHVlLCBrZXksIHRhcmdldCkKCQkJfQoKCQkJaWYgKGtleSA9PSBodG1sLklOTkVSKSB7CgkJCQlyZXR1cm4gdmFsdWUgIT0gdW5kZWZpbmVkICYmICh0YXJnZXQuaW5uZXJIVE1MID0gdmFsdWUpLCB0YXJnZXQuaW5uZXJIVE1MCgkJCX0KCQkJaWYgKGtleSA9PSBpY2UuU0hJUCkgewoJCQkJcmV0dXJuIHZhbHVlICE9IHVuZGVmaW5lZCAmJiB0YXJnZXQuc2V0QXR0cmlidXRlKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKSwgY2FuLmJhc2UuT2JqKHRhcmdldC5nZXRBdHRyaWJ1dGUoa2V5KSwgW10pCgkJCX0KCQkJcmV0dXJuIHZhbHVlICE9IHVuZGVmaW5lZCAmJiB0YXJnZXQuc2V0QXR0cmlidXRlKGtleSwgdmFsdWUpLCB0YXJnZXQuZ2V0QXR0cmlidXRlKGtleXx8aHRtbC5DTEFTUykKCQkJCXx8IHRhcmdldFtrZXldJiZ0YXJnZXRba2V5XS5iYXNlVmFsJiZ0YXJnZXRba2V5XS5iYXNlVmFsLnZhbHVlIHx8IHRhcmdldFtrZXldJiZ0YXJnZXRba2V5XS5iYXNlVmFsIHx8ICIiCgkJfQoJCXRhcmdldC5Hcm91cCA9IGZ1bmN0aW9uKCkgeyB2YXIgaXRlbSA9IHRhcmdldAoJCQl3aGlsZSAoaXRlbSkgeyBpZiAoW2h0bWwuU1ZHLCBzdmcuR10uaW5kZXhPZihpdGVtLnRhZ05hbWUpID4gLTEpIHsgcmV0dXJuIGl0ZW0gfTsgaXRlbSA9IGl0ZW0ucGFyZW50Tm9kZSB9CgkJCXJldHVybiBjYW4uc3ZnCgkJfQoJCXRhcmdldC5Hcm91cHMgPSBmdW5jdGlvbigpIHsgdmFyIGl0ZW0gPSB0YXJnZXQKCQkJdmFyIGxpc3QgPSBbXTsgd2hpbGUgKGl0ZW0gJiYgaXRlbS50YWdOYW1lICE9IGh0bWwuU1ZHKSB7CgkJCQlpdGVtLnRhZ05hbWUgPT0gc3ZnLkcgJiYgaXRlbS5WYWx1ZShodG1sLkNMQVNTKSAmJiBsaXN0LnB1c2goaXRlbS5WYWx1ZShodG1sLkNMQVNTKSkKCQkJCWl0ZW0gPSBpdGVtLnBhcmVudE5vZGUKCQkJfQoJCQlyZXR1cm4gbGlzdC5yZXZlcnNlKCkuam9pbihpY2UuUFQpCgkJfQoJCXJldHVybiB0YXJnZXQKCX0sCglfcHJvZmlsZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGxpc3QpIHsgY2FuLk9wdGlvbigicGlkIiwgY2FuLm9uZmlndXJlLl9waWQoY2FuLCB0YXJnZXQpKQoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsgcmV0dXJuIHRhcmdldC5WYWx1ZSgicGlkIikgfSwgY2FuLnVpLnByb2ZpbGUpKSB7IHJldHVybiB9CgoJCXZhciBhY3Rpb24gPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkucHJvZmlsZSwgW3t2aWV3OiAiYWN0aW9uIn1dKS5maXJzdAoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgY2FuLm9uZGV0YWlsLmxpc3QsIGFjdGlvbiwge19lbmdpbmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGJ1dHRvbikgewoJCQljYW4ub25kZXRhaWxbYnV0dG9uXSh7dGFyZ2V0OiB0YXJnZXR9LCBjYW4sIGJ1dHRvbikKCQl9fSkKCgkJdmFyIGZpZ3VyZSA9IGNhbi5vbmZpZ3VyZS5fZ2V0KGNhbiwgdGFyZ2V0KQoJCWxpc3QgPSAobGlzdHx8W10pLmNvbmNhdChmaWd1cmUuZGF0YS5jb3B5LCBbc3ZnLlgsIHN2Zy5ZLCBtZGIuSU5ERVgsIGN0eC5BUkdTXSkKCQljYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4udWkucHJvZmlsZSwgW3t0eXBlOiBodG1sLlRBQkxFLCBjbGFzc05hbWU6ICJjb250ZW50IiwgbGlzdDogWwoJCQl7dGg6IFttZGIuS0VZLCBtZGIuVkFMVUVdfSwge3RkOiBbbWRiLlRZUEUsIHRhcmdldC50YWdOYW1lXX0sIHt0ZDogWyJwaWQiLCB0YXJnZXQuVmFsdWUoInBpZCIpXX0sCgkJXS5jb25jYXQoY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihrZXkpIHsKCQkJcmV0dXJuIGtleSA9IGZpZ3VyZS5kYXRhLnNpemVba2V5XXx8a2V5LCB7dGQ6IFtrZXksIHRhcmdldC5WYWx1ZShrZXkpXSwgb25kYmxjbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5vbm1vdGlvbi5tb2RpZnkoY2FuLCBldmVudC50YXJnZXQsIGZ1bmN0aW9uKGV2ZW50LCB2YWx1ZSwgb2xkKSB7CgkJCQkJdGFyZ2V0LlZhbHVlKGtleSwgdmFsdWUpLCBjYW4ub25maWd1cmUuX21vdmUoY2FuLCB0YXJnZXQpCgkJCQl9KQoJCQl9fQoJCX0pKSB9XSkKCgl9LAoJZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdmFsdWUpIHsKCQl2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlW3ZhbHVlLnNoYXBlXQoJCXZhciBkYXRhID0gZmlndXJlLmRyYXcoZXZlbnQsIGNhbiwgdmFsdWUucG9pbnQsIHZhbHVlLnN0eWxlKQoJCWNhbi5jb3JlLkl0ZW0odmFsdWUuc3R5bGUsIGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsgZGF0YVtrZXldID0gdmFsdWUgfSkKCQl2YXIgaXRlbSA9IGNhbi5vbmZpZ3VyZS5fcHVzaChjYW4sIGZpZ3VyZS5kYXRhLm5hbWV8fHZhbHVlLnNoYXBlLCBkYXRhLCBjYW4uZ3JvdXB8fGNhbi5zdmcpCgkJY2FuLmNvcmUuSXRlbUNCKHZhbHVlLCBmdW5jdGlvbihrZXksIGNiKSB7IGl0ZW1ba2V5XSA9IGNiIH0pCgkJY2FuLm9uaW1wb3J0Ll9ibG9jayhjYW4sIGl0ZW0pLCBjYW4ub25maWd1cmUuX3BpZChjYW4sIGl0ZW0pCgkJcmV0dXJuIHZhbHVlLl9pbml0ICYmIHZhbHVlLl9pbml0KGl0ZW0pLCBpdGVtCgl9LAp9LCBbIi9wbHVnaW4vbG9jYWwvd2lraS9kcmF3LmNzcyJdKQpWb2xjYW5vcygib25maWd1cmUiLCB7aGVscDogIuWbvuW9oue7mOWItiIsIGxpc3Q6IFtdLAoJX2dldDogZnVuY3Rpb24oY2FuLCBpdGVtLCBuYW1lKSB7CgkJcmV0dXJuIGNhbi5vbmZpZ3VyZVtuYW1lXXx8Y2FuLm9uZmlndXJlW2l0ZW0uZ2V0QXR0cmlidXRlKG1kYi5OQU1FKV18fGNhbi5vbmZpZ3VyZVtpdGVtLnRhZ05hbWVdCgl9LAoJX3BpZDogZnVuY3Rpb24oY2FuLCBpdGVtKSB7IGlmIChpdGVtLlZhbHVlKCJwaWQiKSkgeyByZXR1cm4gaXRlbS5WYWx1ZSgicGlkIikgfQoJCXZhciBwaWQgPSAicCIrY2FuLnN2Zy5WYWwobWRiLkNPVU5ULCBjYW4uc3ZnLlZhbChtZGIuQ09VTlQpKzEpCgkJaXRlbS5WYWx1ZShodG1sLkNMQVNTLCAoaXRlbS5WYWx1ZShodG1sLkNMQVNTKStpY2UuU1AraXRlbS5WYWx1ZSgicGlkIiwgcGlkKSkudHJpbSgpKQoJCXJldHVybiBwaWQKCX0sCglfcHVzaDogZnVuY3Rpb24oY2FuLCB0eXBlLCBkYXRhLCB0YXJnZXQpIHsKCQl2YXIgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCB0eXBlKQoJCXRhcmdldC5hcHBlbmRDaGlsZChjYW4ub25pbXBvcnQuX2Jsb2NrKGNhbiwgaXRlbSkpLCBpdGVtLlZhbHVlKGRhdGEpCgkJcmV0dXJuIGl0ZW0KCX0sCglfY29weTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdGFyZ2V0KSB7CgkJdmFyIGRhdGEgPSB7fSwgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCB0YXJnZXQpLCBzaXplID0gZmlndXJlLmRhdGEuc2l6ZQoJCWNhbi5jb3JlLkxpc3QoZmlndXJlLmRhdGEuY29weSwgZnVuY3Rpb24oaXRlbSkgeyBkYXRhW2l0ZW1dID0gdGFyZ2V0LlZhbHVlKGl0ZW0pIH0pCgkJZGF0YVtzaXplLnh8fHN2Zy5YXSA9IHRhcmdldC5WYWwoc2l6ZS54fHxzdmcuWCkrMTAKCQlkYXRhW3NpemUueXx8c3ZnLlldID0gdGFyZ2V0LlZhbChzaXplLnl8fHN2Zy5ZKSsxMAoJCXJldHVybiBjYW4ub25maWd1cmUuX3B1c2goY2FuLCB0YXJnZXQudGFnTmFtZSwgZGF0YSwgY2FuLmdyb3VwfHxjYW4uc3ZnKQoJfSwKCV9tb3ZlOiBmdW5jdGlvbihjYW4sIHRhcmdldCwgbGlzdCkgewoJCWNhbi5jb3JlLkxpc3QobGlzdHx8dGFyZ2V0LlZhbHVlKGljZS5TSElQKSwgZnVuY3Rpb24oc2hpcCkgewoJCQlzaGlwLnRhcmdldCA9IGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtzaGlwLnBpZClbMF0KCQkJdmFyIHAgPSBjYW4ub25leHBvcnQuYW5jaG9yKHRhcmdldCwgc2hpcC5hbmNob3IsIHt9KSAKCQkJaWYgKHNoaXAud2hpY2ggPT0gMSkgewoJCQkJc2hpcC50YXJnZXQuVmFsKCJ4MSIsIHAueCksIHNoaXAudGFyZ2V0LlZhbCgieTEiLCBwLnkpCgkJCX0gZWxzZSBpZiAoc2hpcC53aGljaCA9PSAyKSB7CgkJCQlzaGlwLnRhcmdldC5WYWwoIngyIiwgcC54KSwgc2hpcC50YXJnZXQuVmFsKCJ5MiIsIHAueSkKCQkJfQoJCX0pCgl9LAoKCXN2ZzogeyAvLyA8c3ZnIGhlaWdodD0iMjAwIiB3aWR0aD0iNjAwIiBjb3VudD0iMCIgZ3JpZD0iMTAiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlPSJ5ZWxsb3ciIGZpbGw9InB1cnBsZSIgZm9udC1zaXplPSIyNCIvPgoJCWRhdGE6IHtzaXplOiB7fSwgY29weTogW119LAoJCXNob3c6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBmaWd1cmUpIHsgcmV0dXJuIGNhbi5vbmV4cG9ydC5fc2l6ZShjYW4sIHRhcmdldCwgZmlndXJlKSB9Cgl9LAoJdGV4dDogeyAvLyA8dGV4dCB4PSI2MCIgeT0iMTAiPmhpPHRleHQ+CgkJZGF0YToge3BvaW50czogMSwgc2l6ZToge30sIGNvcHk6IFtodG1sLklOTkVSXX0sCgkJZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQsIHN0eWxlKSB7IGlmIChwb2ludC5sZW5ndGggPCAxIHx8IGV2ZW50LnR5cGUgPT0gIm1vdXNlbW92ZSIpIHsgcmV0dXJuIH0KCQkJdmFyIHAwID0gcG9pbnRbMF0sIHRleHQgPSBzdHlsZSYmc3R5bGUuaW5uZXJ8fGNhbi51c2VyLnByb21wdChtZGIuVEVYVCkKCQkJcmV0dXJuIHRleHQ/IHt4OiBwMC54LCB5OiBwMC55LCBpbm5lcjogdGV4dH06IG51bGwKCQl9LAoJCXNob3c6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBmaWd1cmUpIHsgcmV0dXJuIGNhbi5vbmV4cG9ydC5fcG9zaXRpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgfQoJfSwKCWNpcmNsZTogeyAvLyA8Y2lyY2xlIHI9IjIwIiBjeD0iMjUiIGN5PSI3NSIvPgoJCWRhdGE6IHtwb2ludHM6IDIsIHNpemU6IHtoZWlnaHQ6IHN2Zy5SLCB3aWR0aDogc3ZnLlIsIHg6ICJjeCIsIHk6ICJjeSJ9LCBjb3B5OiBbc3ZnLlJdfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyBpZiAocG9pbnQubGVuZ3RoIDwgMikgeyByZXR1cm4gfQoJCQl2YXIgcDAgPSBwb2ludFswXSwgcDEgPSBwb2ludFsxXQoJCQlyZXR1cm4ge3I6IHBhcnNlSW50KE1hdGguc3FydChNYXRoLnBvdyhwMC54LXAxLngsIDIpK01hdGgucG93KHAwLnktcDEueSwgMikpKSwgY3g6IHAwLngsIGN5OiBwMC55fQoJCX0sCgl9LAoJZWxsaXBzZTogeyAvLyA8ZWxsaXBzZSByeT0iNSIgcng9IjIwIiBjeD0iNzUiIGN5PSI3NSIvPgoJCWRhdGE6IHtwb2ludHM6IDIsIHNpemU6IHtoZWlnaHQ6ICJyeSIsIHdpZHRoOiAicngiLCB4OiAiY3giLCB5OiAiY3kifSwgY29weTogWyJyeSIsICJyeCJdfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyBpZiAocG9pbnQubGVuZ3RoIDwgMikgeyByZXR1cm4gfQoJCQl2YXIgcDAgPSBwb2ludFswXSwgcDEgPSBwb2ludFsxXQoJCQlyZXR1cm4ge3J5OiBNYXRoLmFicyhwMC55IC0gcDEueSksIHJ4OiBNYXRoLmFicyhwMC54IC0gcDEueCksIGN4OiBwMC54LCBjeTogcDAueX0KCQl9LAoJfSwKCXJlY3Q6IHsgLy8gPHJlY3QgaGVpZ2h0PSIzMCIgd2lkdGg9IjMwIiByeT0iMTAiIHJ4PSIxMCIgeD0iNjAiIHk9IjEwIi8+CgkJZGF0YToge3BvaW50czogMiwgcnk6IDQsIHJ4OiA0LCBzaXplOiB7fSwgY29weTogW2h0bWwuSEVJR0hULCBodG1sLldJRFRILCAicnkiLCAicngiXX0sCgkJZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsgaWYgKHBvaW50Lmxlbmd0aCA8IDIpIHsgcmV0dXJuIH0KCQkJdmFyIHAwID0gcG9pbnRbMF0sIHAxID0gcG9pbnRbMV0KCQkJcmV0dXJuIHsKCQkJCWhlaWdodDogTWF0aC5hYnMocDAueS1wMS55KSwgd2lkdGg6IE1hdGguYWJzKHAwLngtcDEueCksIHJ5OiB0aGlzLmRhdGEucnksIHJ4OiB0aGlzLmRhdGEucngsCgkJCQl4OiBwMC54ID4gcDEueD8gcDEueDogcDAueCwgeTogcDAueSA+IHAxLnk/IHAxLnk6IHAwLnksCgkJCX0KCQl9LAoJCXRleHQ6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IHJldHVybiBkYXRhLnggPSB0YXJnZXQuVmFsKHN2Zy5YKSt0YXJnZXQuVmFsKGh0bWwuV0lEVEgpLzIsIGRhdGEueSA9IHRhcmdldC5WYWwoc3ZnLlkpK3RhcmdldC5WYWwoaHRtbC5IRUlHSFQpLzIsIGRhdGEgfSwKCX0sCglibG9jazogeyAvLyA8cmVjdCBoZWlnaHQ9IjMwIiB3aWR0aD0iMzAiIHJ5PSIxMCIgcng9IjEwIiB4PSI2MCIgeT0iMTAiLz4KCQlkYXRhOiB7cG9pbnRzOiAyLCByeTogNCwgcng6IDQsIHNpemU6IHt9LCBjb3B5OiBbaHRtbC5IRUlHSFQsIGh0bWwuV0lEVEgsICJyeSIsICJyeCJdfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyBpZiAocG9pbnQubGVuZ3RoIDwgMikgeyByZXR1cm4gfQoJCQl0aGlzLl90ZW1wICYmIGNhbi5wYWdlLlJlbW92ZShjYW4sIHRoaXMuX3RlbXApICYmIGRlbGV0ZSh0aGlzLl90ZW1wKQoJCQl0aGlzLl90ZW1wID0gY2FuLm9uZmlndXJlLl9wdXNoKGNhbiwgc3ZnLkcsIHt9LCBjYW4uZ3JvdXB8fGNhbi5zdmcpCgoJCQl2YXIgcmVjdCA9IGNhbi5vbmZpZ3VyZS5fcHVzaChjYW4sICJyZWN0IiwgY2FuLm9uZmlndXJlLnJlY3QuZHJhdyhldmVudCwgY2FuLCBwb2ludCksIHRoaXMuX3RlbXApCgkJCWlmIChldmVudC50eXBlID09IGh0bWwuQ0xJQ0spIHsKCQkJCWNhbi5vbmZpZ3VyZS5fcGlkKGNhbiwgcmVjdCksIGRlbGV0ZSh0aGlzLl90ZW1wKQoJCQl9CgkJfSwKCQl0ZXh0OiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgeyBjYW4ub25maWd1cmUucmVjdC50ZXh0KGNhbiwgZGF0YSwgdGFyZ2V0KSB9LAoJfSwKCWxpbmU6IHsgLy8gPGxpbmUgeDE9IjEwIiB5MT0iNTAiIHgyPSIxMTAiIHkyPSIxNTAiIHh4PSIxMDAiIHl5PSIxMDAiLz4KCQlkYXRhOiB7cG9pbnRzOiAyLCBzaXplOiB7eDogIngxIiwgeTogInkxIn0sIGNvcHk6IFsieDEiLCAieTEiLCAieDIiLCAieTIiXX0sCgkJZ3JpZDogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldAoJCQlpZiAodGFyZ2V0ID09IGNhbi5zdmcpIHsgcmV0dXJuIH0KCQkJdmFyIHAgPSBwb2ludFtwb2ludC5sZW5ndGgtMV0sIHBvcyA9IGNhbi5vbmV4cG9ydC5jdXJzb3IoZXZlbnQsIGNhbiwgdGFyZ2V0KQoJCQl0YXJnZXQuVmFsICYmIGNhbi5vbmV4cG9ydC5hbmNob3IodGFyZ2V0LCBwb3MsIHApCgkJCXJldHVybiBwLnRhcmdldCA9IHRhcmdldCwgcC5hbmNob3IgPSBwb3MsIHBvaW50CgkJfSwKCQlkcmF3OiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCkgeyBpZiAocG9pbnQubGVuZ3RoIDwgMikgeyByZXR1cm4gfQoJCQl2YXIgcDAgPSBwb2ludFswXSwgcDEgPSBwb2ludFsxXSwgc2hpcCA9IFtdCgkJCXAwLnRhcmdldCAmJiBwMC50YXJnZXQuVmFsdWUgJiYgc2hpcC5wdXNoKHtwaWQ6IHAwLnRhcmdldC5WYWx1ZSgicGlkIil9KQoJCQlwMS50YXJnZXQgJiYgcDEudGFyZ2V0LlZhbHVlICYmIHNoaXAucHVzaCh7cGlkOiBwMS50YXJnZXQuVmFsdWUoInBpZCIpfSkKCQkJcmV0dXJuIHt4MTogcDAueCwgeTE6IHAwLnksIHgyOiBwMS54LCB5MjogcDEueSwgc2hpcDogc2hpcH0KCQl9LAoJCXRleHQ6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBkYXRhKSB7IHJldHVybiBkYXRhLnggPSAodGFyZ2V0LlZhbCgieDEiKSt0YXJnZXQuVmFsKCJ4MiIpKS8yLCBkYXRhLnkgPSAodGFyZ2V0LlZhbCgieTEiKSt0YXJnZXQuVmFsKCJ5MiIpKS8yLCBkYXRhIH0sCgkJc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgeyByZXR1cm4gIjwoIisodGFyZ2V0LlZhbCgieTIiKS10YXJnZXQuVmFsKCJ5MSIpKStpY2UuRlMrKHRhcmdldC5WYWwoIngyIiktdGFyZ2V0LlZhbCgieDEiKSkrIikiK2Nhbi5vbmV4cG9ydC5fcG9zaXRpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgfSwKCX0sCn0sIFtdKQpWb2xjYW5vcygib25rZXltYXAiLCB7aGVscDogIumUruebmOS6pOS6kiIsIGxpc3Q6IFtdLAoJX21vZGU6IHsKCQlub3JtYWw6IHsKCQkJZ3I6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLkFjdGlvbigiZ28iLCAicnVuIikgfSwKCQkJZ2E6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLkFjdGlvbigiZ28iLCAiYXV0byIpIH0sCgkJCWdtOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oImdvIiwgIm1hbnVhbCIpIH0sCgoJCQlhZDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJtb2RlIiwgImRyYXciKSB9LAoJCQlhcjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJtb2RlIiwgInJlc2l6ZSIpIH0sCgoJCQlzdDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJzaGFwZSIsICJ0ZXh0IikgfSwKCQkJc3I6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLkFjdGlvbigic2hhcGUiLCAicmVjdCIpIH0sCgkJCXNsOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5BY3Rpb24oInNoYXBlIiwgImxpbmUiKSB9LAoJCQlzYzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJzaGFwZSIsICJjaXJjbGUiKSB9LAoJCQlzZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJzaGFwZSIsICJlbGxpcHNlIikgfSwKCgkJCWNyOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJyZWQiKSB9LAoJCQljYjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJzdHJva2UiLCAiYmx1ZSIpIH0sCgkJCWNnOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJncmVlbiIpIH0sCgkJCWN5OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgInN0cm9rZSIsICJ5ZWxsb3ciKSB9LAoJCQljcDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJzdHJva2UiLCAicHVycGxlIikgfSwKCQkJY2M6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAic3Ryb2tlIiwgImN5YW4iKSB9LAoJCQljaDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJzdHJva2UiLCAiYmxhY2siKSB9LAoJCQljdzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJzdHJva2UiLCAid2hpdGUiKSB9LAoKCQkJZnI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAiZmlsbCIsICJyZWQiKSB9LAoJCQlmYjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgImJsdWUiKSB9LAoJCQlmZzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgImdyZWVuIikgfSwKCQkJZnk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCAiZmlsbCIsICJ5ZWxsb3ciKSB9LAoJCQlmcDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgInB1cnBsZSIpIH0sCgkJCWZjOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAiY3lhbiIpIH0sCgkJCWZoOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmFjdGlvbi5fY2hhbmdlKGNhbiwgImZpbGwiLCAiYmxhY2siKSB9LAoJCQlmdzogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sICJmaWxsIiwgIndoaXRlIikgfSwKCQl9LAoJfSwgX2VuZ2luZToge30sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogWwoJCVsic3Ryb2tlLXdpZHRoIiwgMSwgMiwgMywgNCwgNV0sCgkJWyJzdHJva2UiLCBjbGkuUkVELCBjbGkuWUVMTE9XLCBjbGkuR1JFRU4sIGNsaS5DWUFOLCBjbGkuQkxVRSwgY2xpLlBVUlBMRSwgY2xpLkJMQUNLLCBjbGkuV0hJVEVdLAoJCVsiZmlsbCIsIGNsaS5SRUQsIGNsaS5ZRUxMT1csIGNsaS5HUkVFTiwgY2xpLkNZQU4sIGNsaS5CTFVFLCBjbGkuUFVSUExFLCBjbGkuQkxBQ0ssIGNsaS5XSElURSwgIiMwMDAwIl0sCgkJWyJmb250LXNpemUiLCAxMiwgMTYsIDE4LCAyNCwgMzJdLAoKCQlbImdvIiwgaWNlLlJVTiwgaWNlLkFVVE8sICJtYW51YWwiXSwKCQlbIm1vZGUiLCAiZHJhdyIsICJyZXNpemUiXSwKCQlbInNoYXBlIiwgInRleHQiLCAiY2lyY2xlIiwgImVsbGlwc2UiLCAicmVjdCIsICJibG9jayIsICJsaW5lIl0sCgkJWyJncmlkIiwgMSwgMiwgMywgNCwgNSwgMTAsIDIwXSwKCV0sCglfY2hhbmdlOiBmdW5jdGlvbihjYW4sIGtleSwgdmFsdWUpIHsgY2FuLkFjdGlvbihrZXksIHZhbHVlKSwgY2FuLmdyb3VwLlZhbHVlKGtleSwgdmFsdWUpIH0sCgkic3Ryb2tlLXdpZHRoIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sIGtleSwgdmFsdWUpIH0sCglzdHJva2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgY2FuLm9uYWN0aW9uLl9jaGFuZ2UoY2FuLCBrZXksIHZhbHVlKSB9LAoJZmlsbDogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sIGtleSwgdmFsdWUpIH0sCgkiZm9udC1zaXplIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4ub25hY3Rpb24uX2NoYW5nZShjYW4sIGtleSwgdmFsdWUpIH0sCgoJZ286IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgY2FuLkFjdGlvbihrZXksIHZhbHVlKSB9LAoJbW9kZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4uQWN0aW9uKGtleSwgdmFsdWUpIH0sCglzaGFwZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyBjYW4uQWN0aW9uKGtleSwgdmFsdWUpIH0sCgoJZWRpdDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uQWN0aW9uKCJnbyIsIGNhbi5BY3Rpb24oImdvIikgPT0gaWNlLlJVTj8gaWNlLkFVVE86IGljZS5SVU4pIH0sCglzYXZlOiBmdW5jdGlvbihldmVudCwgY2FuLCBidXR0b24pIHsKCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHtjb250ZW50OiBjYW4ub25leHBvcnQuY29udGVudChjYW4sIGNhbi5zdmcpfSkKCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgYnV0dG9uLCBjYW4uT3B0aW9uKG5mcy5QQVRIKV0sIGZ1bmN0aW9uKG1zZykgewoJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKQoJCX0sIHRydWUpCgl9LAoKCXByb2plY3Q6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi51aS5wcm9qZWN0KSB9LAoJcHJvZmlsZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLnVpLnByb2ZpbGUpIH0sCglzaG93OiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi5zaG93KGNhbiwge2ludGVydmFsOiAxMDAsIGxlbmd0aDogMTB9LCBudWxsLCBjYW4uZ3JvdXApIH0sCgloaWRlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi5oaWRlKGNhbiwge2ludGVydmFsOiAxMDAsIGxlbmd0aDogMTB9LCBudWxsLCBjYW4uZ3JvdXApIH0sCgljcmVhdGU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4udXNlci5wcm9tcHQoImdyb3VwIiwgInNvbWUiLCBmdW5jdGlvbihuYW1lKSB7CgkJCXZhciBncm91cCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCBzdmcuRykKCQkJY2FuLmdyb3VwLmFwcGVuZChncm91cCksIGNhbi5vbmltcG9ydC5fYmxvY2soY2FuLCBncm91cCkKCQkJZ3JvdXAuVmFsdWUoaHRtbC5DTEFTUywgbmFtZSksIGNhbi5jb3JlLkxpc3QoW2h0bWwuU1RST0tFX1dJRFRILCBodG1sLlNUUk9LRSwgaHRtbC5GSUxMLCBodG1sLkZPTlRfU0laRV0sIGZ1bmN0aW9uKG5hbWUpIHsKCQkJCWdyb3VwLlZhbHVlKG5hbWUsIGNhbi5BY3Rpb24obmFtZSkpCgkJCX0pLCBjYW4ub25pbXBvcnQuX2dyb3VwKGNhbiwgZ3JvdXApLmNsaWNrKCkKCQl9KQoJfSwKCXJlbW92ZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBpZiAoY2FuLmdyb3VwID09IGNhbi5zdmcpIHsgcmV0dXJuIH0KCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBjYW4uZ3JvdXApCgl9LAoJY2xlYXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uZ3JvdXApLCBjYW4ucG9pbnQgPSBbXSwgZGVsZXRlKGNhbi50ZW1wKQoJfSwKCglfbW9kZTogewoJCWRyYXc6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHBvaW50KSB7CgkJCXZhciBzaGFwZSA9IGNhbi5BY3Rpb24oInNoYXBlIikKCQkJdmFyIGZpZ3VyZSA9IGNhbi5vbmZpZ3VyZVtzaGFwZV0KCQkJZmlndXJlLmdyaWQgJiYgZmlndXJlLmdyaWQoZXZlbnQsIGNhbiwgcG9pbnQpCgoJCQl2YXIgZGF0YSA9IGZpZ3VyZS5kcmF3ICYmIGZpZ3VyZS5kcmF3KGV2ZW50LCBjYW4sIHBvaW50KQoJCQl2YXIgaXRlbSA9IGRhdGEgJiYgY2FuLm9uZmlndXJlLl9wdXNoKGNhbiwgZmlndXJlLmRhdGEubmFtZXx8c2hhcGUsIGRhdGEsIGNhbi5ncm91cHx8Y2FuLnN2ZykKCQkJZXZlbnQudHlwZSA9PSBodG1sLkNMSUNLICYmIHBvaW50Lmxlbmd0aCA9PT0gZmlndXJlLmRhdGEucG9pbnRzICYmIChjYW4ucG9pbnQgPSBbXSkgCgoJCQlpZiAoZXZlbnQudHlwZSA9PSBodG1sLkNMSUNLICYmIGl0ZW0pIHsKCQkJCXZhciBwaWQgPSBjYW4ub25maWd1cmUuX3BpZChjYW4sIGl0ZW0pOyBjYW4uY29yZS5MaXN0KHBvaW50LCBmdW5jdGlvbihwLCBpKSB7IGlmICghcC50YXJnZXQpIHsgcmV0dXJuIH0KCQkJCQlwLnRhcmdldC5WYWx1ZShpY2UuU0hJUCwgcC50YXJnZXQuVmFsdWUoaWNlLlNISVApLmNvbmNhdChbe3BpZDogcGlkLCB3aGljaDogaSsxLCBhbmNob3I6IHAuYW5jaG9yfV0pKQoJCQkJfSkKCQkJfQoJCQlyZXR1cm4gaXRlbQoJCX0sCgkJcmVzaXplOiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludCwgdGFyZ2V0KSB7IHRhcmdldCA9IHRhcmdldHx8ZXZlbnQudGFyZ2V0CgkJCWlmIChldmVudC50eXBlID09IGh0bWwuQ0xJQ0spIHsKCQkJCWlmIChwb2ludC5sZW5ndGggPT0gMSkgewoJCQkJCWNhbi5jdXJyZW50ID0ge3RhcmdldDogdGFyZ2V0LCBiZWdpbjogY2FuLmNvcmUuTGlzdChbdGFyZ2V0XSwgZnVuY3Rpb24oaXRlbSkgeyBpZiAoaXRlbS50YWdOYW1lID09IHN2Zy5HKSB7IHJldHVybiB9CgkJCQkJCXJldHVybiB7CgkJCQkJCQloZWlnaHQ6IGl0ZW0uVmFsKGh0bWwuSEVJR0hUKSwgd2lkdGg6IGl0ZW0uVmFsKGh0bWwuV0lEVEgpLCB4OiBpdGVtLlZhbChzdmcuWCksIHk6IGl0ZW0uVmFsKHN2Zy5ZKSwKCQkJCQkJCXRhcmdldDogaXRlbSwgc2hpcDogY2FuLmNvcmUuTGlzdChpdGVtLlZhbHVlKGljZS5TSElQKSwgZnVuY3Rpb24oc2hpcCkgewoJCQkJCQkJCXJldHVybiBzaGlwLnBpZCAmJiAoc2hpcC50YXJnZXQgPSBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uc3ZnLCBpY2UuUFQrc2hpcC5waWQpWzBdKSAmJiBzaGlwCgkJCQkJCQl9KQoJCQkJCQl9CgkJCQkJfSksIHBvczogY2FuLm9uZXhwb3J0LmN1cnNvcihldmVudCwgY2FuLCB0YXJnZXQpfQoJCQkJCXJldHVybgoJCQkJfQoJCQkJcmV0dXJuIGNhbi5wb2ludCA9IFtdLCBkZWxldGUoY2FuLmN1cnJlbnQpCgkJCX0KCgkJCWNhbi5jdXJyZW50ICYmIGNhbi5jb3JlLkxpc3QoY2FuLmN1cnJlbnQuYmVnaW4sIGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGZpZ3VyZSA9IGNhbi5vbmZpZ3VyZS5fZ2V0KGNhbiwgaXRlbS50YXJnZXQpCgkJCQljYW4ub25leHBvcnQucmVzaXplKGV2ZW50LCBpdGVtLnRhcmdldCwgaXRlbSwgcG9pbnRbMF0sIHBvaW50WzFdLCBjYW4uY3VycmVudC5wb3MpCgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uc3ZnLCBpY2UuUFQraXRlbS50YXJnZXQuVmFsdWUobWRiLlRFWFQpLCBmdW5jdGlvbih0ZXh0KSB7CgkJCQkJdGV4dC5WYWx1ZShjYW4ub25leHBvcnQuX3RleHQoY2FuLCBpdGVtLnRhcmdldCwgZmlndXJlLCB7fSkpCgkJCQl9KQoJCQkJY2FuLm9uZmlndXJlLl9tb3ZlKGNhbiwgaXRlbS50YXJnZXQsIGl0ZW0uc2hpcCkKCQkJfSkKCQl9LAoJCXJ1bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCQljYW4ub25pbXBvcnQuX3Byb2ZpbGUoY2FuLCBldmVudC50YXJnZXQpCgkJfSwKCX0sCglfYXV0bzogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKCQlpZiAoY2FuLnBvaW50Lmxlbmd0aCA+IDApIHsgcmV0dXJuIH0KCQlpZiAodGFyZ2V0LnRhZ05hbWUgPT0gbWRiLlRFWFQpIHsgcmV0dXJuIH0KCgkJdmFyIHBvcyA9IGNhbi5vbmV4cG9ydC5jdXJzb3IoZXZlbnQsIGNhbiwgZXZlbnQudGFyZ2V0KQoJCWlmICh0YXJnZXQgPT0gY2FuLnN2ZykgewoJCQlpZiAocG9zID09IDUpIHsKCQkJCWNhbi5BY3Rpb24oaWNlLk1PREUsICJkcmF3IiksIGNhbi5BY3Rpb24oInNoYXBlIiwgaHRtbC5CTE9DSykKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHRhcmdldCwge3N0eWxlOiB7Y3Vyc29yOiAiY3Jvc3NoYWlyIn19KQoJCQl9IGVsc2UgewoJCQkJY2FuLkFjdGlvbihpY2UuTU9ERSwgInJlc2l6ZSIpCgkJCX0KCQl9IGVsc2UgewoJCQlzd2l0Y2ggKHBvcykgewoJCQkJY2FzZSA1OgoJCQkJY2FzZSA5OiBjYW4uQWN0aW9uKGljZS5NT0RFLCAicmVzaXplIik7IGJyZWFrCgkJCQlkZWZhdWx0OiBjYW4uQWN0aW9uKGljZS5NT0RFLCAiZHJhdyIpLCBjYW4uQWN0aW9uKCJzaGFwZSIsICJsaW5lIikKCQkJfQoJCX0KCX0sCglfZmlndXJlOiBmdW5jdGlvbihldmVudCwgY2FuLCBwb2ludHMsIHRhcmdldCkgewoJCWNhbi50ZW1wICYmIGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi50ZW1wKSAmJiBkZWxldGUoY2FuLnRlbXApCgkJY2FuLnRlbXAgPSBjYW4uY29yZS5DYWxsRnVuYyhbY2FuLm9uYWN0aW9uLl9tb2RlLCBjYW4uQWN0aW9uKGljZS5NT0RFKV0sIFtldmVudCwgY2FuLCBwb2ludHMsIHRhcmdldF0pCgkJY2FuLnBvaW50Lmxlbmd0aCA9PSAwICYmIGRlbGV0ZShjYW4udGVtcCkKCX0sCgoJb25tb3VzZW92ZXI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZXhwb3J0Ll9zaG93KGNhbiwgZXZlbnQudGFyZ2V0KSB9LAoJb25tb3VzZW1vdmU6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIHBvaW50ID0gY2FuLm9uZXhwb3J0Ll9wb2ludChldmVudCwgY2FuKQoJCWlmIChjYW4uQWN0aW9uKCJnbyIpID09IGljZS5SVU4pIHsgcmV0dXJuIH0KCQljYW4ub25leHBvcnQuY3Vyc29yKGV2ZW50LCBjYW4sIGV2ZW50LnRhcmdldCkKCQlpZiAoY2FuLkFjdGlvbigiZ28iKSA9PSBpY2UuQVVUTykgeyBjYW4ub25hY3Rpb24uX2F1dG8oY2FuLCBldmVudC50YXJnZXQpIH0KCQljYW4ub25hY3Rpb24uX2ZpZ3VyZShldmVudCwgY2FuLCBjYW4ucG9pbnQuY29uY2F0KHBvaW50KSkKCX0sCglvbmNsaWNrOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBwb2ludCA9IGNhbi5vbmV4cG9ydC5fcG9pbnQoZXZlbnQsIGNhbikKCQlpZiAoY2FuLkFjdGlvbigiZ28iKSA9PSBpY2UuUlVOKSB7IGNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGV2ZW50LnRhcmdldCkKCQkJcmV0dXJuIGV2ZW50LnNoaWZ0S2V5PyBjYW4ub25hY3Rpb24uX21vZGUucnVuKGV2ZW50LCBjYW4pOiBjYW4ub25kZXRhaWwucnVuKGV2ZW50LCBjYW4pCgkJfQoJCWNhbi5vbmFjdGlvbi5fZmlndXJlKGV2ZW50LCBjYW4sIGNhbi5wb2ludCA9IGNhbi5wb2ludC5jb25jYXQocG9pbnQpKQoJfSwKCW9uZGJsY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25kZXRhaWwubGFiZWwoZXZlbnQsIGNhbikKCX0sCn0pClZvbGNhbm9zKCJvbmRldGFpbCIsIHtoZWxwOiAi57uE5Lu26K+m5oOFIiwgbGlzdDogW2NsaS5TVEFSVCwgaWNlLlJVTiwgaWNlLkNPUFksIGh0bWwuTEFCRUwsIG1kYi5NT0RJRlksICJ0b2ltYWdlIiwgbWRiLkRFTEVURV0sCglzdGFydDogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJdmFyIGxpc3QgPSBbdGFyZ2V0XSwgZGljdCA9IHt9CgkJZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7IHZhciBzaGlwID0gbGlzdFtpXS5WYWx1ZSgic2hpcCIpCgkJCWZvciAodmFyIGogPSAwOyBqIDwgc2hpcC5sZW5ndGg7IGorKykgeyB2YXIgcGlkID0gc2hpcFtqXS5waWQKCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtwaWQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQl2YXIgcGlkID0gaXRlbS5WYWx1ZSgic2hpcCIpWzFdLnBpZAoJCQkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtwaWQsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCQkJIWRpY3RbcGlkXSAmJiBsaXN0LnB1c2goaXRlbSksIGRpY3RbcGlkXSA9IHRydWUKCQkJCQl9KQoJCQkJfSkKCQkJfQoJCX0KCQljYW4uY29yZS5OZXh0KGxpc3QsIGZ1bmN0aW9uKGl0ZW0sIG5leHQpIHsgY2FuLmNvcmUuVGltZXIoMzAwMCwgZnVuY3Rpb24oKSB7CgkJCWNhbi5vbm1vdGlvbi5zaG93KGNhbiwge2ludGVydmFsOiAzMDAsIGxlbmd0aDogMTB9LCBudWxsLCBpdGVtKSAKCQkJY2FuLnVzZXIudG9hc3QoY2FuLCBpdGVtLlZhbHVlKCJpbmRleCIpKQoJCQljYW4ub25kZXRhaWwucnVuKHt0YXJnZXQ6IGl0ZW19LCBjYW4pLCBuZXh0KCkKCQl9KSB9KQoJfSwKCXJ1bjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJaWYgKCF0YXJnZXQuVmFsdWUoInBpZCIpKSB7IGNhbi5vbmZpZ3VyZS5fcGlkKGNhbiwgdGFyZ2V0KSB9CgoJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsgcmV0dXJuIHRhcmdldC5WYWx1ZSgicGlkIikgfSwgY2FuLnVpLmRpc3BsYXkpKSB7IHJldHVybiB9CgoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5kaXNwbGF5KSwgY2FuLnN2Zy5WYWx1ZSgicGlkIiwgdGFyZ2V0LlZhbHVlKCJwaWQiKSkKCQl2YXIgaW5kZXggPSB0YXJnZXQuVmFsdWUobWRiLklOREVYKTsgaW5kZXggJiYgY2FuLm9uYXBwZW5kLnBsdWdpbihjYW4sIHt0eXBlOiBjaGF0LlNUT1JZLCBpbmRleDogaW5kZXgsIGFyZ3M6IHRhcmdldC5WYWx1ZShjdHguQVJHUyl9LCBmdW5jdGlvbihzdWIpIHsKCQkJc3ViLkNvbmYoImhlaWdodCIsIGNhbi5Db25mKCJoZWlnaHQiKS1jYW4uc3ZnLlZhbCgiaGVpZ2h0IiktNTIpLCBzdWIuQ29uZigid2lkdGgiLCBjYW4uQ29uZigid2lkdGgiKSkKCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYikgeyBjYW4ucnVuKGV2ZW50LCBjYW4ubWlzYy5jb25jYXQoY2FuLCBbaWNlLlJVTiwgaW5kZXhdLCBjbWRzKSwgY2IsIHRydWUpIH0KCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIHN1Yi5fbGVnZW5kKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5kaXNwbGF5LCB0cnVlKQoJCX0sIGNhbi51aS5kaXNwbGF5KQoJfSwKCWNvcHk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZmlndXJlLl9jb3B5KGV2ZW50LCBjYW4sIGV2ZW50LnRhcmdldCkgfSwKCWxhYmVsOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQKCQl2YXIgZGVmID0gdGFyZ2V0LlZhbHVlKG1kYi5URVhUKTsgZGVmICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtkZWYsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJZGVmID0gaXRlbS5WYWx1ZShodG1sLklOTkVSKQoJCX0pCgkJY2FuLnVzZXIucHJvbXB0KGh0bWwuTEFCRUwsIGRlZiwgZnVuY3Rpb24odGV4dCkgewoJCQlpZiAodGFyZ2V0LnRhZ05hbWUgPT0gaHRtbC5URVhUKSB7IHJldHVybiB0YXJnZXQuaW5uZXJIVE1MID0gdGV4dCB9CgoJCQlpZiAoZGVmICYmIGNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi5zdmcsIGljZS5QVCtkZWYsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJCWl0ZW0uVmFsdWUoaHRtbC5JTk5FUiwgdGV4dCkKCQkJfSkubGVuZ3RoID4gMCkgewoJCQkJcmV0dXJuCgkJCX0KCgkJCXZhciBmaWd1cmUgPSBjYW4ub25maWd1cmUuX2dldChjYW4sIHRhcmdldCkKCQkJdmFyIGRhdGEgPSBjYW4ub25leHBvcnQuX3RleHQoY2FuLCB0YXJnZXQsIGZpZ3VyZSwge2lubmVyOiB0ZXh0fSkKCQkJdmFyIGl0ZW0gPSBjYW4ub25maWd1cmUuX3B1c2goY2FuLCBodG1sLlRFWFQsIGRhdGEsIHRhcmdldC5Hcm91cCgpKQoJCQl0YXJnZXQuVmFsdWUobWRiLlRFWFQsIGNhbi5vbmZpZ3VyZS5fcGlkKGNhbiwgaXRlbSkpCgkJfSkKCX0sCgltb2RpZnk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uaW1wb3J0Ll9wcm9maWxlKGNhbiwgZXZlbnQudGFyZ2V0KSB9LAoJdG9pbWFnZTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9pbWFnZShldmVudCwgY2FuLCBjYW4uT3B0aW9uKG5mcy5QQVRIKS5zcGxpdCgiLyIpLnBvcCgpLnNwbGl0KCIuIilbMF0sIGNhbi5zdmcpIH0sCgkiZGVsZXRlIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0CgkJaWYgKHRhcmdldCA9PSBjYW4uc3ZnKSB7IHJldHVybiB9CgkJY2FuLmNvcmUuTGlzdCh0YXJnZXQuVmFsdWUoaWNlLlNISVApLCBmdW5jdGlvbih2YWx1ZSkgewoJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uc3ZnLCBpY2UuUFQrdmFsdWUucGlkLCBmdW5jdGlvbihpdGVtKSB7CgkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBpdGVtKQoJCQl9KQoJCX0pCgkJdGFyZ2V0LlZhbHVlKG1kYi5URVhUKSAmJiBjYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uc3ZnLCBpY2UuUFQrdGFyZ2V0LlZhbHVlKG1kYi5URVhUKSwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCBpdGVtKQoJCX0pCgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgdGFyZ2V0KQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbImdyb3VwIiwgImZpZ3VyZSIsICJpbmRleCIsICJwb3MiXSwKCV9zaG93OiBmdW5jdGlvbihjYW4sIHRhcmdldCkgeyB2YXIgZmlndXJlID0gY2FuLm9uZmlndXJlLl9nZXQoY2FuLCB0YXJnZXQpCgkJZnVuY3Rpb24gc2hvdygpIHsgcmV0dXJuIGNhbi5vbmV4cG9ydC5fc2l6ZShjYW4sIHRhcmdldCwgZmlndXJlKStpY2UuU1ArY2FuLm9uZXhwb3J0Ll9wb3NpdGlvbihjYW4sIHRhcmdldCwgZmlndXJlKSB9CgkJY2FuLlN0YXR1cygiZmlndXJlIiwgdGFyZ2V0LnRhZ05hbWUrIjoiK3RhcmdldC5WYWx1ZSgicGlkIikraWNlLlNQKyhmaWd1cmU/IChmaWd1cmUuc2hvd3x8c2hvdykoY2FuLCB0YXJnZXQsIGZpZ3VyZSk6ICIiKSkKCQljYW4uU3RhdHVzKCJncm91cCIsIHRhcmdldC5Hcm91cHMoKXx8Y2FuLmdyb3VwLkdyb3VwcygpfHxodG1sLlNWRykKCQljYW4uU3RhdHVzKCJpbmRleCIsIHRhcmdldC5WYWx1ZSgiaW5kZXgiKSkKCX0sCglfc2l6ZTogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgeyB2YXIgc2l6ZSA9IGZpZ3VyZS5kYXRhLnNpemV8fHt9CgkJcmV0dXJuICI8KCIrdGFyZ2V0LlZhbChzaXplW2h0bWwuSEVJR0hUXXx8aHRtbC5IRUlHSFQpK2ljZS5GUyt0YXJnZXQuVmFsKHNpemVbaHRtbC5XSURUSF18fGh0bWwuV0lEVEgpKyIpIgoJfSwKCV9wb3NpdGlvbjogZnVuY3Rpb24oY2FuLCB0YXJnZXQsIGZpZ3VyZSkgeyB2YXIgc2l6ZSA9IGZpZ3VyZS5kYXRhLnNpemV8fHt9CgkJcmV0dXJuICJAKCIrdGFyZ2V0LlZhbChzaXplW3N2Zy5YXXx8c3ZnLlgpK2ljZS5GUyt0YXJnZXQuVmFsKHNpemVbc3ZnLlldfHxzdmcuWSkrIikiCgl9LAoJX3RleHQ6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0LCBmaWd1cmUsIGRhdGEpIHsgdmFyIHNpemUgPSBmaWd1cmUuZGF0YS5zaXplfHx7fQoJCWlmIChmaWd1cmUudGV4dCkgeyByZXR1cm4gZmlndXJlLnRleHQoY2FuLCBkYXRhLCB0YXJnZXQpIH0KCQlyZXR1cm4gZGF0YS54ID0gdGFyZ2V0LlZhbChzaXplW3N2Zy5YXXx8c3ZnLlgpLCBkYXRhLnkgPSB0YXJnZXQuVmFsKHNpemVbc3ZnLlldfHxzdmcuWSksIGRhdGEKCX0sCglfcG9pbnQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQl2YXIgcCA9IGNhbi5zdmcuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKCQl2YXIgcG9pbnQgPSB7eDogZXZlbnQuY2xpZW50WC1wLngsIHk6IGV2ZW50LmNsaWVudFktcC55fQoJCXBvaW50LnggPSBwb2ludC54IC0gcG9pbnQueCAlIHBhcnNlSW50KGNhbi5BY3Rpb24oImdyaWQiKSkKCQlwb2ludC55ID0gcG9pbnQueSAtIHBvaW50LnkgJSBwYXJzZUludChjYW4uQWN0aW9uKCJncmlkIikpCgkJcmV0dXJuIGNhbi5TdGF0dXMoInBvcyIsIHBvaW50LngraWNlLkZTK3BvaW50LnkpLCBwb2ludAoJfSwKCgljb250ZW50OiBmdW5jdGlvbihjYW4sIHN2ZykgewoJCXJldHVybiBbJzxzdmcgdmVydGlvbj0iMS4xIiB4bWxucz0iaHR0cHM6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiddLmNvbmNhdCgKCQkJc3ZnPyBjYW4uY29yZS5MaXN0KFtodG1sLkhFSUdIVCwgaHRtbC5XSURUSCwgbWRiLkNPVU5ULCAicGlkIiwgImdyaWQiLCBodG1sLlNUUk9LRV9XSURUSCwgaHRtbC5TVFJPS0UsIGh0bWwuRklMTCwgaHRtbC5GT05UX1NJWkVdLCBmdW5jdGlvbihpdGVtKSB7CgkJCQlyZXR1cm4gc3ZnLlZhbHVlKGl0ZW0pPyBpY2UuU1AgKyBpdGVtICsgJz0iJyArIHN2Zy5WYWx1ZShpdGVtKSArICciJzogIiIKCQkJfSk6IFsiIGhlaWdodD0iKygoY2FuLkNvbmYoaHRtbC5IRUlHSFQpfHw0NTApLTUwKSsiIHdpZHRoPSIrKGNhbi5Db25mKGh0bWwuV0lEVEgpfHw2MDApXSkuY29uY2F0KFsnPicsIHN2Zz8gc3ZnLmlubmVySFRNTDogIiIsICI8L3N2Zz4iXSkuam9pbigiIikKCX0sCgljdXJzb3I6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGl0ZW0sIHNob3cpIHsKCQl2YXIgcCA9IGl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKCQl2YXIgcSA9IHt4OiBldmVudC5jbGllbnRYLCB5OiBldmVudC5jbGllbnRZfQoKCQl2YXIgcG9zID0gNSwgbWFyZ2luID0gMjAKCQl2YXIgeSA9IChxLnktcC55KS9wLmhlaWdodAoJCWlmICh5IDwgMC4yICYmIHEueS1wLnkgPCBtYXJnaW4pIHsKCQkJcG9zIC09IDMKCQl9IGVsc2UgaWYgKHkgPiAwLjggJiYgcS55LXAueS1wLmhlaWdodCA+IC1tYXJnaW4pIHsKCQkJcG9zICs9IDMKCQl9CgkJdmFyIHggPSAocS54LXAueCkvcC53aWR0aAoJCWlmICh4IDwgMC4yICYmIHEueC1wLnggPCBtYXJnaW4pIHsKCQkJcG9zIC09IDEKCQl9IGVsc2UgaWYgKHggPiAwLjggJiYgcS54LXAueC0gcC53aWR0aCA+IC1tYXJnaW4pIHsKCQkJcG9zICs9IDEKCQl9CgoJCXJldHVybiAoc2hvd3x8Y2FuLnN2Zykuc3R5bGUuY3Vyc29yID0gWwoJCQkibnctcmVzaXplIiwgIm4tcmVzaXplIiwgIm5lLXJlc2l6ZSIsCgkJCSJ3LXJlc2l6ZSIsICJtb3ZlIiwgImUtcmVzaXplIiwKCQkJInN3LXJlc2l6ZSIsICJzLXJlc2l6ZSIsICJzZS1yZXNpemUiLAoJCV1bcG9zLTFdLCBwb3MKCX0sCglhbmNob3I6IGZ1bmN0aW9uKHRhcmdldCwgcG9zLCBwb2ludCkgewoJCXN3aXRjaCAocG9zKSB7CgkJCWNhc2UgMToKCQkJY2FzZSAyOgoJCQljYXNlIDM6CgkJCQlwb2ludC55ID0gdGFyZ2V0LlZhbChzdmcuWSkKCQkJCWJyZWFrCgkJCWNhc2UgNDoKCQkJY2FzZSA1OgoJCQljYXNlIDY6CgkJCQlwb2ludC55ID0gdGFyZ2V0LlZhbChzdmcuWSkgKyB0YXJnZXQuVmFsKGh0bWwuSEVJR0hUKSAvIDIKCQkJCWJyZWFrCgkJCWNhc2UgNzoKCQkJY2FzZSA4OgoJCQljYXNlIDk6CgkJCQlwb2ludC55ID0gdGFyZ2V0LlZhbChzdmcuWSkgKyB0YXJnZXQuVmFsKGh0bWwuSEVJR0hUKQoJCQkJYnJlYWsKCQl9CgoJCXN3aXRjaCAocG9zKSB7CgkJCWNhc2UgMToKCQkJY2FzZSA0OgoJCQljYXNlIDc6CgkJCQlwb2ludC54ID0gdGFyZ2V0LlZhbChzdmcuWCkKCQkJCWJyZWFrCgkJCWNhc2UgMjoKCQkJY2FzZSA1OgoJCQljYXNlIDg6CgkJCQlwb2ludC54ID0gdGFyZ2V0LlZhbChzdmcuWCkgKyB0YXJnZXQuVmFsKGh0bWwuV0lEVEgpIC8gMgoJCQkJYnJlYWsKCQkJY2FzZSAzOgoJCQljYXNlIDY6CgkJCWNhc2UgOToKCQkJCXBvaW50LnggPSB0YXJnZXQuVmFsKHN2Zy5YKSArIHRhcmdldC5WYWwoaHRtbC5XSURUSCkKCQkJCWJyZWFrCgkJfQoJCXJldHVybiBwb2ludAoJfSwKCXJlc2l6ZTogZnVuY3Rpb24oZXZlbnQsIGl0ZW0sIGJlZ2luLCBwMCwgcDEsIHBvcykgewoJCXN3aXRjaCAocG9zKSB7CgkJCWNhc2UgNToKCQkJCWl0ZW0uVmFsdWUoc3ZnLlgsIGJlZ2luLnggKyBwMS54IC0gcDAueCkKCQkJCWl0ZW0uVmFsdWUoc3ZnLlksIGJlZ2luLnkgKyBwMS55IC0gcDAueSkKCQkJCXJldHVybgoJCX0KCgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAxOgoJCQljYXNlIDI6CgkJCWNhc2UgMzoKCQkJCWl0ZW0uVmFsdWUoc3ZnLlksIGJlZ2luLnkgKyBwMS55IC0gcDAueSkKCQkJCWl0ZW0uVmFsdWUoaHRtbC5IRUlHSFQsIGJlZ2luLmhlaWdodCAtIHAxLnkgKyBwMC55KQoJCQkJYnJlYWsKCQl9CgkJc3dpdGNoIChwb3MpIHsKCQkJY2FzZSAxOgoJCQljYXNlIDQ6CgkJCWNhc2UgNzoKCQkJCWl0ZW0uVmFsdWUoc3ZlLlgsIGJlZ2luLnggKyBwMS54IC0gcDAueCkKCQkJCWl0ZW0uVmFsdWUoaHRtbC5XSURUSCwgYmVnaW4ud2lkdGggLSBwMS54ICsgcDAueCkKCQkJCWJyZWFrCgkJfQoJCXN3aXRjaCAocG9zKSB7CgkJCWNhc2UgMzoKCQkJY2FzZSA2OgoJCQljYXNlIDk6CgkJCQlpdGVtLlZhbHVlKGh0bWwuV0lEVEgsIGJlZ2luLndpZHRoICsgcDEueCAtIHAwLngpCgkJCQlicmVhawoJCX0KCQlzd2l0Y2ggKHBvcykgewoJCQljYXNlIDc6CgkJCWNhc2UgODoKCQkJY2FzZSA5OgoJCQkJaXRlbS5WYWx1ZShodG1sLkhFSUdIVCwgYmVnaW4uaGVpZ2h0ICsgcDEueSAtIHAwLnkpCgkJCQlicmVhawoJCX0KCX0sCn0pCgo=",
        "/plugin/local/wiki/draw/heart.js": "Vm9sY2Fub3MoImhlYXJ0Iiwge2hlbHA6ICLlv4PlvaIiLCBsaXN0OiBbXSwKICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LAogICAgICAgIGNvcHk6IFsiZCIsICJuYW1lIiwgIm1ldGEiLCAidHQiLCAieHgiLCAieXkiXSwKICAgICAgICB4OiBmdW5jdGlvbihldmVudCwgY2FuLCB2YWx1ZSwgY21kLCB0YXJnZXQpIHsKICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgaWYgKHZhbHVlICE9IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgdHQudHggPSB2YWx1ZS10YXJnZXQuVmFsKCJ4eCIpCiAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgdGFyZ2V0LlZhbHVlKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKCIrdHQudHgrIiwiK3R0LnR5KyIpIikKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieHgiKSt0dC50eAogICAgICAgIH0sCiAgICAgICAgeTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdmFsdWUsIGNtZCwgdGFyZ2V0KSB7CiAgICAgICAgICAgIHZhciB0dCA9IEpTT04ucGFyc2UodGFyZ2V0LlZhbHVlKCJ0dCIpfHwneyJ0eCI6MCwgInR5IjowfScpCiAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHR0LnR5ID0gdmFsdWUtdGFyZ2V0LlZhbCgieXkiKQogICAgICAgICAgICAgICAgdGFyZ2V0LlZhbHVlKCJ0dCIsIEpTT04uc3RyaW5naWZ5KHR0KSkKICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5WYWwoInl5IikrdHQudHkKICAgICAgICB9LAogICAgfSwgLy8gPGhlYXJ0IGN4PSIyNSIgY3k9Ijc1IiByPSIyMCIvPgogICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsgaWYgKHBvaW50Lmxlbmd0aCA8IDIpIHtyZXR1cm59CgogICAgICAgIHZhciBwMCA9IHBvaW50WzBdLCBwMSA9IHBvaW50WzFdLCBwMiA9IHBvaW50WzJdOwogICAgICAgIHBsID0ge3g6IDIqcDAueCAtIHAxLngsIHk6MipwMC55LXAxLnl9CiAgICAgICAgdmFyIHIwID0gTWF0aC5zcXJ0KE1hdGgucG93KHAwLnggLSBwMS54LCAyKSwgTWF0aC5wb3cocDAueSAtIHAxLnksIDIpKSAvIDIKICAgICAgICB2YXIgZCA9IFsKICAgICAgICAgICAgICAgICJNIiwgcGwueCwgcGwueSwKICAgICAgICAgICAgICAgICJBIiwgcjAsIHIwLCAwLCAwLCAwLCBwMC54LCBwMC55LAogICAgICAgICAgICAgICAgIkEiLCByMCwgcjAsIDAsIDAsIDAsIHAxLngsIHAxLnksCiAgICAgICAgICAgIF0KCiAgICAgICAgaWYgKHBvaW50Lmxlbmd0aCA9PSAzKSB7CiAgICAgICAgICAgIHZhciByMSA9IE1hdGguc3FydChNYXRoLnBvdyhwMi54IC0gcDEueCwgMiksIE1hdGgucG93KHAyLnkgLSBwMS55LCAyKSkKICAgICAgICAgICAgZCA9IGQuY29uY2F0KFsKICAgICAgICAgICAgICAgICJBIiwgcjEsIHIxLCAxODAsIDAsIDAsIHAyLngsIHAyLnksCiAgICAgICAgICAgICAgICAiQSIsIHIxLCByMSwgMTgwLCAwLCAwLCBwbC54LCBwbC55LAogICAgICAgICAgICBdKQogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgICAgIG5hbWU6ICJoZWFydCIsIGQ6IGQuam9pbigiICIpLAogICAgICAgICAgICBtZXRhOiBKU09OLnN0cmluZ2lmeShwb2ludCksCiAgICAgICAgICAgIHR0OiBKU09OLnN0cmluZ2lmeSh7dHg6IDAsIHR5OiAwfSksCiAgICAgICAgICAgIHh4OiBwMC54LCB5eTpwMS55LAogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGV2ZW50LnR5cGUgPT0gImNsaWNrIiAmJiBwb2ludC5sZW5ndGggPT0gMyAmJiAoY2FuLnBvaW50ID0gW10pLCBkYXRhCiAgICB9LAogICAgdGV4dDogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKICAgICAgICBkYXRhLnggPSB0YXJnZXQuVmFsKCJjeCIpCiAgICAgICAgZGF0YS55ID0gdGFyZ2V0LlZhbCgiY3kiKQogICAgICAgIHJldHVybiBkYXRhCiAgICB9LAogICAgc2hvdzogZnVuY3Rpb24oY2FuLCB0YXJnZXQpIHsKICAgICAgICByZXR1cm4gImhlYXJ0ICIgKyB0YXJnZXQuVmFsdWUoInR0IikKICAgIH0sCn0pCgo=",
        "/plugin/local/wiki/draw/path.js": "Vm9sY2Fub3MoIm9uZmlndXJlIiwge2hlbHA6ICLlm77lvaLnu5jliLYiLCBsaXN0OiBbXSwKICAgIHBhdGgydjogeyAvLyA8cGF0aCBkPSJNIHgwLHkwIFEgeDIseTIgeDMseTMgVCB4MSx5MSIvPgogICAgICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LCBjb3B5OiBbXX0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gbGluZShwMCwgcDEpIHsgcmV0dXJuIGNhbi5iYXNlLmpvaW5zKFsKICAgICAgICAgICAgICAgIHN2Zy5NLCBbcDAueCwgcDAueV0sIHN2Zy5RLCBbcDAueCwgcDAueSsocDEueS1wMC55KS8zXSwgWyhwMC54K3AxLngpLzIsIChwMC55K3AxLnkpLzJdLCBzdmcuVCwgW3AxLngsIHAxLnldCiAgICAgICAgICAgIF0pIH0KICAgICAgICAgICAgcmV0dXJuIHtmaWxsOiBodG1sLk5PTkUsIGQ6IGxpbmUocG9pbnRbMF0sIHBvaW50WzFdKX0KICAgICAgICB9LAogICAgfSwKICAgIHBhdGgyaDogeyAvLyA8cGF0aCBkPSJNIHgwLHkwIFEgeDIseTIgeDMseTMgVCB4MSx5MSIvPgogICAgICAgIGRhdGE6IHtuYW1lOiAicGF0aCIsIHNpemU6IHt9LCBjb3B5OiBbXX0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQpIHsKICAgICAgICAgICAgZnVuY3Rpb24gbGluZShwMCwgcDEpIHsgcmV0dXJuIGNhbi5iYXNlLmpvaW5zKFsKICAgICAgICAgICAgICAgIHN2Zy5NLCBbcDAueCwgcDAueV0sIHN2Zy5RLCBbcDAueCsocDEueC1wMC54KS8zLCBwMC55XSwgWyhwMC54K3AxLngpLzIsIChwMC55K3AxLnkpLzJdLCBzdmcuVCwgW3AxLngsIHAxLnldCiAgICAgICAgICAgIF0pIH0KICAgICAgICAgICAgcmV0dXJuIHtmaWxsOiBodG1sLk5PTkUsIGQ6IGxpbmUocG9pbnRbMF0sIHBvaW50WzFdKX0KICAgICAgICB9LAogICAgfSwKICAgIHBhdGg6IHsgLy8gPHBhdGggZD0iTTEwIDEwIEggOTAgViA5MCBIIDEwIFoiLz4KICAgICAgICBkYXRhOiB7c2l6ZToge30sIGNvcHk6IFsiZCIsICJ0dCIsICJ4eCIsICJ5eSJdLAogICAgICAgICAgICB4OiBmdW5jdGlvbihjYW4sIHZhbHVlLCBjbWQsIHRhcmdldCkgewogICAgICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0dC50eCA9IHZhbHVlLXRhcmdldC5WYWwoInh4IikKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieHgiKSt0dC50eAogICAgICAgICAgICB9LAogICAgICAgICAgICB5OiBmdW5jdGlvbihjYW4sIHZhbHVlLCBjbWQsIHRhcmdldCkgewogICAgICAgICAgICAgICAgdmFyIHR0ID0gSlNPTi5wYXJzZSh0YXJnZXQuVmFsdWUoInR0Iil8fCd7InR4IjowLCAidHkiOjB9JykKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAhPSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgICAgICB0dC50eSA9IHZhbHVlLXRhcmdldC5WYWwoInl5IikKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuVmFsdWUoInR0IiwgSlNPTi5zdHJpbmdpZnkodHQpKQogICAgICAgICAgICAgICAgICAgIHRhcmdldC5WYWx1ZSgidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgiK3R0LnR4KyIsIit0dC50eSsiKSIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gdGFyZ2V0LlZhbCgieXkiKSt0dC50eQogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICAgICAgZHJhdzogZnVuY3Rpb24oZXZlbnQsIGNhbiwgcG9pbnQsIHN0eWxlKSB7CiAgICAgICAgICAgIGlmIChzdHlsZSAmJiBzdHlsZS5kKSB7IHJldHVybiBzdHlsZSB9CiAgICAgICAgICAgIGlmIChwb2ludC5sZW5ndGggPT0gMSkgeyBjYW4uX3RlbXAgPSB7fSB9CiAgICAgICAgICAgIGlmIChwb2ludC5sZW5ndGggPCAyKSB7IHJldHVybiB9CgogICAgICAgICAgICBpZiAoY2FuLmtleXMgJiYgY2FuLmtleXMubGVuZ3RoID4gMCkgeyB2YXIgazsKICAgICAgICAgICAgICAgIGsgPSBjYW4uX3RlbXBbcG9pbnQubGVuZ3RoLTFdID0gY2FuLmtleXNbMF0KICAgICAgICAgICAgICAgIHN3aXRjaCAoay50b1VwcGVyQ2FzZSgpKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAiQyI6IGNhbi5fdGVtcFtwb2ludC5sZW5ndGgrMV0gPSAiLCIKICAgICAgICAgICAgICAgICAgICBjYXNlICJRIjogY2FuLl90ZW1wW3BvaW50Lmxlbmd0aF0gPSAiLCI7IGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNhbi5rZXlzID0gY2FuLmtleXMuc2xpY2UoMSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdmFyIHNraXAgPSAwCiAgICAgICAgICAgIHZhciBlbmQgPSBmYWxzZQogICAgICAgICAgICB2YXIgZGF0YSA9IHsKICAgICAgICAgICAgICAgIGQ6IGNhbi5jb3JlLkxpc3QocG9pbnQsIGZ1bmN0aW9uKHAsIGkpIHsgdmFyIGsgPSBwLmsKICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHNraXApIHtyZXR1cm59CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDogayA9ICJNIjsgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogayA9IGNhbi5fdGVtcFtpXSB8fCBwLmsgfHwgIkwiOyBicmVhawogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoZW5kKSB7cmV0dXJufQoKICAgICAgICAgICAgICAgICAgICBrID0gay50b1VwcGVyQ2FzZSgpCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIloiOiByZXR1cm4gY2FuLnBvaW50ID0gW10sIGNhbi5fdGVtcCA9IHt9LCBrCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIkwiOiByZXR1cm4gaysiICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiTSI6IHJldHVybiBrKyIgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJIIjogcmV0dXJuIGsrIiAiICsgcC54CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgIlYiOiByZXR1cm4gaysiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiQSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBvaW50Lmxlbmd0aCAtIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IGVuZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIgMCAwIDAgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGguc3FydChNYXRoLnBvdyhwb2ludFtpKzFdLnggLSBwLngsIDIpICsgTWF0aC5wb3cocG9pbnRbaSsxXS55IC0gcC55LCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgciArICIgIiArIHIgKyAiIDAgMCAwICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGguc3FydChNYXRoLnBvdyhwb2ludFtpKzFdLnggLSBwLngsIDIpICsgTWF0aC5wb3cocG9pbnRbaSsxXS55IC0gcC55LCAyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcG9pbnRbaV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBwb2ludFtpXSA9IHBvaW50W2krMV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50W2krMV0gPSB0ZW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IGNhbi5wb2ludFtpXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGNhbi5wb2ludFtpXSA9IGNhbi5wb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYW4ucG9pbnRbaSsxXSA9IHRlbXAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAueCA9IHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAueSA9IHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuZG9uZSA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAuYXJnID0gIiAwIDAgMCAiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBza2lwID0gaSArIDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgcC54ICsgIiAiICsgcC55ICsgIiAwIDAgMCAiICsgcG9pbnRbaSsxXS54ICsgIiAiICsgcG9pbnRbaSsxXS55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJDIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocG9pbnQubGVuZ3RoIC0gaSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyAocG9pbnRbaS0xXS54K3AueCkvMiArICIgIiArIChwb2ludFtpLTFdLnkrcC55KS8yICsgIiwiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIsIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyAocG9pbnRbaS0xXS54K3AueCkvMiArICIgIiArIChwb2ludFtpLTFdLnkrcC55KS8yICsgIiwiICsgcC54ICsgIiAiICsgcC55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyBwb2ludFtpKzJdLnggKyAiICIgKyBwb2ludFtpKzJdLnkgKyAiLCIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50W2ldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcG9pbnRbaV0gPSBwb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludFtpKzFdID0gdGVtcAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZW1wID0gcG9pbnRbaSsxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRbaSsxXSA9IHBvaW50W2krMl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50W2krMl0gPSB0ZW1wCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwLmRvbmUgPSB0cnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiUSI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHBvaW50Lmxlbmd0aCAtIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IGVuZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgKHBvaW50W2ktMV0ueCtwLngpLzIgKyAiICIgKyAocG9pbnRbaS0xXS55K3AueSkvMiArICIsIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjogZW5kID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaysiICIgKyBwb2ludFtpKzFdLnggKyAiICIgKyBwb2ludFtpKzFdLnkgKyAiLCIgKyBwLnggKyAiICIgKyBwLnkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcC5kb25lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50W2ldCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gcG9pbnRbaV0gPSBwb2ludFtpKzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludFtpKzFdID0gdGVtcAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcC5kb25lID0gdHJ1ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGsrIiAiICsgcC54ICsgIiAiICsgcC55CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiBrKyIgIiArIHAueCArICIgIiArIHAueQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pLmpvaW4oIiAiKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBkYXRhCiAgICAgICAgfSwKICAgICAgICB0ZXh0OiBmdW5jdGlvbihjYW4sIHRhcmdldCwgZGF0YSkgewogICAgICAgICAgICBkYXRhLnggPSAodGFyZ2V0LngxLmJhc2VWYWwudmFsdWUgKyB0YXJnZXQueDIuYmFzZVZhbC52YWx1ZSkgLyAyCiAgICAgICAgICAgIGRhdGEueSA9ICh0YXJnZXQueTEuYmFzZVZhbC52YWx1ZSArIHRhcmdldC55Mi5iYXNlVmFsLnZhbHVlKSAvIDIKICAgICAgICAgICAgcmV0dXJuIGRhdGEKICAgICAgICB9LAogICAgICAgIHNob3c6IGZ1bmN0aW9uKGNhbiwgdGFyZ2V0KSB7IHJldHVybiB0YXJnZXQudGFnTmFtZSArICIgIiArIHRhcmdldC5WYWx1ZSgiZCIpIH0sCiAgICB9LAp9KQoK",
        "/plugin/local/wiki/draw/walk_trash.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwKICAgIGluaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYiwgb3V0cHV0LCBhY3Rpb24sIG9wdGlvbikge291dHB1dC5pbm5lckhUTUwgPSAiIjsKICAgICAgICBpZiAoIW1zZy5yZXN1bHQgfHwgbXNnLnJlc3VsdC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICB2YXIgdGFibGUgPSBjYW4ucGFnZS5BcHBlbmRUYWJsZShjYW4sIG1zZywgb3V0cHV0LCBtc2cuYXBwZW5kKTsKICAgICAgICAgICAgdGFibGUub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7c3dpdGNoIChldmVudC50YXJnZXQudGFnTmFtZSkgewogICAgICAgICAgICAgICAgY2FzZSAiVEQiOgogICAgICAgICAgICAgICAgICAgIGNhbi5vbmltcG9ydC53aGljaChldmVudCwgdGFibGUsIG1zZy5hcHBlbmQsIGZ1bmN0aW9uKGluZGV4LCBrZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FuLk9wdGlvbigiZmlsZSIsIGV2ZW50LnRhcmdldC5pbm5lckhUTUwudHJpbSgpKQogICAgICAgICAgICAgICAgICAgICAgICBjYW4ucnVuKGV2ZW50LCBbZXZlbnQudGFyZ2V0LmlubmVySFRNTC50cmltKCldLCBmdW5jdGlvbihtc2cpIHt9KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGNhc2UgIlRIIjoKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgY2FzZSAiVFIiOgogICAgICAgICAgICAgICAgY2FzZSAiVEFCTEUiOgogICAgICAgICAgICB9fQogICAgICAgICAgICByZXR1cm4gY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpLCB0YWJsZTsKICAgICAgICB9CgogICAgICAgIC8vIGNhbi5wYWdlLkFwcGVuZChjYW4sIGFjdGlvbiwgW3t0eXBlOiAic2NyaXB0Iiwgc3JjOiAiaHR0cHM6Ly9jZG4uYm9vdGNzcy5jb20vZWNoYXJ0cy80LjIuMC1yYy4yL2VjaGFydHMuanMifV0pOwogICAgICAgIGNhbi5wYWdlLkFwcGVuZChjYW4sIG91dHB1dCwgW3tpbmNsdWRlOiBbInJlcXVpcmUvc2h5bGludXguY29tL3gvZWNoYXJ0cy9lY2hhcnRzLmpzIiwgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgb3V0cHV0LCBbe2luY2x1ZGU6IFsicmVxdWlyZS9zaHlsaW51eC5jb20veC9lY2hhcnRzL2NoaW5hLmpzIiwgZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgICAgIHZhciBjaGluYV9jaGFydCA9IGVjaGFydHMuaW5pdChjYW4ucGFnZS5BcHBlbmQoY2FuLCBvdXRwdXQsIFt7dHlwZTogImRpdiIsIHN0eWxlOiB7d2lkdGg6ICI2MDBweCIsIGhlaWdodDogIjQwMHB4In19XSkubGFzdCk7CiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IG1zZy5UYWJsZSgpCgogICAgICAgICAgICAgICAgdmFyIHlEYXRhID0gW107CiAgICAgICAgICAgICAgICB2YXIgYmFyRGF0YSA9IFtdOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAoZGF0YS5sZW5ndGg+MTA/IDEwOiBkYXRhLmxlbmd0aCk7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHlEYXRhLnB1c2goaSArIGRhdGFbaV0ubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgYmFyRGF0YS5wdXNoKGRhdGFbaV0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHZhciBvcHRpb24gPSB7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFt7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1zZy5PcHRpb24oInRpdGxlIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHNob3c6IHRydWUsIHJpZ2h0OiAyNTAsIHRvcDogMTAsCiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTdHlsZToge2NvbG9yOiAnIzJEM0U1MycsIGZvbnRTaXplOiAxOH0sCiAgICAgICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgICAgICAgdG9vbHRpcDogewogICAgICAgICAgICAgICAgICAgICAgICBzaG93OiB0cnVlLCBmb3JtYXR0ZXI6IGZ1bmN0aW9uKHBhcmFtcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcy5uYW1lICsiOiAiK3BhcmFtcy52YWx1ZQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgdmlzdWFsTWFwOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjb250aW51b3VzJywKICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50OiAnaG9yaXpvbnRhbCcsCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1XaWR0aDogMTAsCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1IZWlnaHQ6IDgwLAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBbJ+mrmCcsICfkvY4nXSwKICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0xhYmVsOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICBzZXJpZXNJbmRleDogWzBdLAogICAgICAgICAgICAgICAgICAgICAgICBtaW46IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIG1heDogZGF0YVsxXS52YWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgaW5SYW5nZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFsnIzZGQ0Y2QScsICcjRkZGRDY0JywgJyNGRjUwMDAnXQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0U3R5bGU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnIzdCOTNBNycKICAgICAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tOiAzMCwKICAgICAgICAgICAgICAgICAgICAgICAgbGVmdDogJ2xlZnQnLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZ3JpZDoge3JpZ2h0OiAxMCwgdG9wOiAxMzUsIGJvdHRvbTogMTAwLCB3aWR0aDogJzIwJSd9LAogICAgICAgICAgICAgICAgICAgIHhBeGlzOiB7c2hvdzogZmFsc2V9LAogICAgICAgICAgICAgICAgICAgIHlBeGlzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdjYXRlZ29yeScsCiAgICAgICAgICAgICAgICAgICAgICAgIGludmVyc2U6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWVHYXA6IDE2LAogICAgICAgICAgICAgICAgICAgICAgICBheGlzTGluZToge3Nob3c6IGZhbHNlLCBsaW5lU3R5bGU6IHtjb2xvcjogJyNkZGQnfX0sCiAgICAgICAgICAgICAgICAgICAgICAgIGF4aXNUaWNrOiB7c2hvdzogZmFsc2UsIGxpbmVTdHlsZToge2NvbG9yOiAnI2RkZCd9fSwKICAgICAgICAgICAgICAgICAgICAgICAgYXhpc0xhYmVsOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW46IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnRlcnZhbDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHRTdHlsZToge2NvbG9yOiAnIzQ1NUE3NCcsIGFsaWduOiAnbGVmdCcsIGZvbnRTaXplOiAxNH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWNoOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJyNmZmYnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjRkFBQTM5JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDIwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYjogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogJyNmZmYnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjNDE5N0ZEJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDIwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDIwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlclJhZGl1czogMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZXI6IGZ1bmN0aW9uKHBhcmFtcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJzZUludChwYXJhbXMuc2xpY2UoMCwgMSkpIDwgMykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3thfCcgKyAocGFyc2VJbnQocGFyYW1zLnNsaWNlKDAsIDEpKSArIDEpICsgJ30nICsgJyAgJyArIHBhcmFtcy5zbGljZSgxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oJ1xuJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3tifCcgKyAocGFyc2VJbnQocGFyYW1zLnNsaWNlKDAsIDEpKSArIDEpICsgJ30nICsgJyAgJyArIHBhcmFtcy5zbGljZSgxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBdLmpvaW4oJ1xuJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IHlEYXRhCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBnZW86IHsKICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiAnY2hpbmEnLCBsZWZ0OiAnbGVmdCcsIHJpZ2h0OiAnMTAwJywKICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IHtlbXBoYXNpczoge3Nob3c6IGZhbHNlfX0sCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1TdHlsZToge2VtcGhhc2lzOiB7YXJlYUNvbG9yOiAnI2ZmZjQ2NCd9fSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHNlcmllczogW3sKICAgICAgICAgICAgICAgICAgICAgICAgcm9hbTogZmFsc2UsIHR5cGU6ICdtYXAnLCBuYW1lOiAnbWFwU2VyJywKICAgICAgICAgICAgICAgICAgICAgICAgZ2VvSW5kZXg6IDAsIGxhYmVsOiB7c2hvdzogZmFsc2V9LAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgICAgICByb2FtOiBmYWxzZSwgdHlwZTogJ2JhcicsIG5hbWU6ICdiYXJTZXInLAogICAgICAgICAgICAgICAgICAgICAgICB2aXN1YWxNYXA6IGZhbHNlLCBiYXJHYXA6IDAsIGJhck1heFdpZHRoOiA4LAogICAgICAgICAgICAgICAgICAgICAgICB6bGV2ZWw6IDEwMCwgaXRlbVN0eWxlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3JtYWw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1aWxkIGEgY29sb3IgbWFwIGFzIHlvdXIgbmVlZC4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbG9yTGlzdCA9IFt7Y29sb3JTdG9wczogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge29mZnNldDogMCwgY29sb3I6ICcjRkZEMTE5J30sIC8vIDAlIOWkhOeahOminOiJsgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge29mZnNldDogMSwgY29sb3I6ICcjRkZBQzRDJ30sIC8vIDEwMCUg5aSE55qE6aKc6ImyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19LCB7Y29sb3JTdG9wczogWwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge29mZnNldDogMCwgY29sb3I6ICcjMDBDMEZBJ30sIC8vIDAlIOWkhOeahOminOiJsgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge29mZnNldDogMSwgY29sb3I6ICcjMkY5NUZBJ30sIC8vIDEwMCUg5aSE55qE6aKc6ImyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF19XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBhcmFtcy5kYXRhSW5kZXggPCAzPyBjb2xvckxpc3RbMF06IGNvbG9yTGlzdFsxXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFyQm9yZGVyUmFkaXVzOiAxNQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBiYXJEYXRhCiAgICAgICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBjaGluYV9jaGFydC5zZXRPcHRpb24ob3B0aW9uKTsKICAgICAgICAgICAgfV19XSk7CiAgICAgICAgfV19XSk7CiAgICB9LAogICAgd2hpY2g6IGZ1bmN0aW9uKGV2ZW50LCB0YWJsZSwgbGlzdCwgY2IpIHtpZiAoZXZlbnQudGFyZ2V0ID09IHRhYmxlKSB7cmV0dXJuIGNiKC0xLCAiIil9CiAgICAgICAgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFibGUsICJ0ciIsIGZ1bmN0aW9uKHRyLCBpbmRleCkge2lmIChldmVudC50YXJnZXQgPT0gdHIpIHtyZXR1cm4gY2IoaW5kZXgtMSwgIiIpfQogICAgICAgICAgICBjYW4ucGFnZS5TZWxlY3QoY2FuLCB0ciwgInRoLHRkIiwgZnVuY3Rpb24odGQsIG9yZGVyKSB7CiAgICAgICAgICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ID09IHRkKSB7cmV0dXJuIGNiKGluZGV4LTEsIGxpc3Rbb3JkZXJdKX0KICAgICAgICAgICAgfSkKICAgICAgICB9KQogICAgfSwKfSkKCg==",
        "/plugin/local/wiki/feel.css": "ZmllbGRzZXQuZmVlbCBkaXYub3V0cHV0IGltZyB7IGRpc3BsYXk6YmxvY2s7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQuZmVlbCBkaXYub3V0cHV0IHZpZGVvIHsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC5mZWVsLmZsb2F0IHsgYmFja2dyb3VuZC1jb2xvcjojNGVhYWQwYzI7IHBvc2l0aW9uOmFic29sdXRlOyB9CmZpZWxkc2V0LmZlZWwuZmxvYXQ+bGVnZW5kIHsgZGlzcGxheTpub25lOyB9Cg==",
        "/plugin/local/wiki/feel.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnBhdGggPSBjYW4ucmVxdWVzdCgpLCBjYW4ubGlzdCA9IFtdLCBtc2cuVGFibGUoZnVuY3Rpb24odmFsdWUpIHsKCQkJdmFsdWUucGF0aC5sYXN0SW5kZXhPZihpY2UuUFMpPT12YWx1ZS5wYXRoLmxlbmd0aC0xPyBjYW4ucGF0aC5QdXNoKHZhbHVlKTogY2FuLmxpc3QucHVzaCh2YWx1ZSkKCQl9KQoKCQljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKCQljYW4udWkgPSBjYW4ub25sYXlvdXQuZGlzcGxheShjYW4sIHRhcmdldCkKCQljYW4ub25hcHBlbmQudGFibGUoY2FuLCBjYW4ucGF0aCwgbnVsbCwgY2FuLnVpLmNvbnRlbnQpCgkJY2FuLmRpcl9yb290ID0gbXNnLk9wdGlvbigiZGlyX3Jvb3QiKQoKCQljYW4uQWN0aW9uKCJoZWlnaHQiLCBtc2cuT3B0aW9uKCJoZWlnaHQiKXx8IjEwMCIpCgkJY2FuLkFjdGlvbigibGltaXQiLCBtc2cuT3B0aW9uKCJsaW1pdCIpfHwiNiIpCgkJY2FuLkFjdGlvbigicmF0ZSIsIG1zZy5PcHRpb24oInJhdGUiKXx8IjEiKQoJCWNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBjYW4uX2FjdGlvbikKCgkJY2FuLmJlZ2luID0gbXNnLk9wdGlvbigiYmVnaW4iKXx8IjAiCgkJY2FuLm9uaW1wb3J0LnBhZ2UoY2FuLCBjYW4ubGlzdCkKCX0sCglfZmlsZTogZnVuY3Rpb24oY2FuLCBwYXRoLCBpbmRleCkgeyB2YXIgcCA9IGxvY2F0aW9uLmhyZWYuaW5kZXhPZigiaHR0cCIpID09IDA/ICIiOiAiaHR0cDovL2xvY2FsaG9zdDo5MDIwIgoJCXJldHVybiBwYXRoLmluZGV4T2YoImh0dHAiKSA9PSAwPyBwYXRoOiBwK2Nhbi5iYXNlLlBhdGgoIi9zaGFyZS9sb2NhbCIsIGNhbi5kaXJfcm9vdHx8IiIsIHBhdGgpCgl9LAoJZmlsZTogZnVuY3Rpb24oY2FuLCBwYXRoLCBpbmRleCkgeyBwYXRoID0gY2FuLm9uaW1wb3J0Ll9maWxlKGNhbiwgcGF0aCwgaW5kZXgpCgkJdmFyIGNiID0gY2FuLm9uZmlndXJlW2Nhbi5iYXNlLkV4dChwYXRoKV07IGNhbi5TdGF0dXMoImZpbGUiLCBwYXRoKQoJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2FuLnBhZ2UuQXBwZW5kKGNhbiwgY2FuLnVpLmRpc3BsYXksIFtjYihjYW4sIHBhdGgsIGluZGV4KV0pCgl9LAoJcGFnZTogZnVuY3Rpb24oY2FuLCBsaXN0LCBiZWdpbiwgbGltaXQpIHsgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnVpLmRpc3BsYXkpCgkJYmVnaW4gPSBwYXJzZUludChiZWdpbnx8Y2FuLmJlZ2luKSwgbGltaXQgPSBwYXJzZUludChsaW1pdHx8Y2FuLkFjdGlvbigibGltaXQiKSkKCQlmb3IgKHZhciBpID0gYmVnaW47IGkgPCBiZWdpbitsaW1pdDsgaSsrKSB7IGxpc3QgJiYgbGlzdFtpXSAmJiBjYW4ub25pbXBvcnQuZmlsZShjYW4sIGxpc3RbaV0ucGF0aCwgaSkgfQoJCWNhbi5TdGF0dXMoe2JlZ2luOiBiZWdpbiwgbGltaXQ6IGxpbWl0LCB0b3RhbDogY2FuLmxpc3QubGVuZ3RofSkKCX0sCn0sIFsiL3BsdWdpbi9sb2NhbC93aWtpL2ZlZWwuY3NzIl0pClZvbGNhbm9zKCJvbmZpZ3VyZSIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogW10sCglwbmc6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgaW5kZXgpIHsgcmV0dXJuIGNhbi5vbmZpZ3VyZS5pbWFnZShjYW4sIHBhdGgsIGluZGV4KSB9LAoJanBnOiBmdW5jdGlvbihjYW4sIHBhdGgsIGluZGV4KSB7IHJldHVybiBjYW4ub25maWd1cmUuaW1hZ2UoY2FuLCBwYXRoLCBpbmRleCkgfSwKCWpwZWc6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgaW5kZXgpIHsgcmV0dXJuIGNhbi5vbmZpZ3VyZS5pbWFnZShjYW4sIHBhdGgsIGluZGV4KSB9LAoJaW1hZ2U6IGZ1bmN0aW9uKGNhbiwgcGF0aCwgaW5kZXgpIHsgcmV0dXJuIHtpbWc6IHBhdGgsIGhlaWdodDogY2FuLkFjdGlvbigiaGVpZ2h0IiksIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJY2FuLm9uZGV0YWlsLl9pbml0KGNhbiwgaW5kZXgpCgl9LCBfaW5pdDogZnVuY3Rpb24odGFyZ2V0KSB7IGNhbi5TdGF0dXMoImZpbGUiLCBwYXRoKSB9LAoJCW9ubW91c2VvdmVyOiBmdW5jdGlvbihldmVudCkgeyBjYW4uU3RhdHVzKCJmaWxlIiwgcGF0aCkgfSwKCX0gfSwKCgl2aWRlbzogZnVuY3Rpb24oY2FuLCBwYXRoKSB7IHZhciBhdXRvID0gY2FuLnVzZXIuaXNNb2JpbGUmJmNhbi5BY3Rpb24oImxpbWl0IikhPSIxIj8gZmFsc2U6IHRydWUsIGxvb3AgPSB0cnVlLCB0b3RhbCA9IDA7IGZ1bmN0aW9uIGNiKGV2ZW50KSB7IH0KCQlyZXR1cm4ge3R5cGU6ICJ2aWRlbyIsIHN0eWxlOiB7aGVpZ2h0OiBwYXJzZUludChjYW4uQWN0aW9uKCJoZWlnaHQiKSl9LCBjbGFzc05hbWU6ICJwcmV2aWV3IiwKCQkJZGF0YToge3NyYzogcGF0aCwgY29udHJvbHM6ICJjb250cm9scyIsIGF1dG9wbGF5OiBhdXRvLCBsb29wOiBsb29wLCBwbGF5YmFja1JhdGU6IHBhcnNlRmxvYXQoY2FuLkFjdGlvbigicmF0ZSIpKX0sCgkJCW9uY29udGV4dG1lbnU6IGNiLCBvbnBsYXk6IGNiLCBvbnBhdXNlOiBjYiwgb25lbmRlZDogY2IsCgkJCW9ubW91c2VvdmVyOiBmdW5jdGlvbihldmVudCkgeyBjYW4uU3RhdHVzKCJmaWxlIiwgcGF0aCkgfSwKCQkJb25sb2FkZWRtZXRhZGF0YTogZnVuY3Rpb24oZXZlbnQpIHsgdG90YWwgPSBldmVudC50aW1lU3RhbXAKCQkJCWV2ZW50LnRhcmdldC5jdXJyZW50VGltZSA9IGNhbi5fbXNnLmN1cnJlbnRUaW1lIHx8IDAKCQkJfSwgb25sb2FkZWRkYXRhOiBjYiwgb250aW1ldXBkYXRlOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLlN0YXR1cygiZmlsZSIpID09IHBhdGggJiYgY2FuLlN0YXR1cygicG9zaXRpb24iLCBjYW4ub25leHBvcnQucG9zaXRpb24oY2FuLCAoY2FuLl9tc2cuY3VycmVudFRpbWU9ZXZlbnQudGFyZ2V0LmN1cnJlbnRUaW1lKS0xLCBldmVudC50YXJnZXQuZHVyYXRpb24pKQoJCQl9LAoJCX0KCX0sCgltcDQ6IGZ1bmN0aW9uKGNhbiwgcGF0aCkgeyByZXR1cm4gY2FuLm9uZmlndXJlLnZpZGVvKGNhbiwgcGF0aCkgfSwKCW00djogZnVuY3Rpb24oY2FuLCBwYXRoKSB7IHJldHVybiBjYW4ub25maWd1cmUudmlkZW8oY2FuLCBwYXRoKSB9LAoJbW92OiBmdW5jdGlvbihjYW4sIHBhdGgpIHsgcmV0dXJuIGNhbi5vbmZpZ3VyZS52aWRlbyhjYW4sIHBhdGgpIH0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogWwoJCVsiaGVpZ2h0IiwgMTAwLCAyMDAsIDQwMCwgNjAwLCA4MDBdLAoJCVsibGltaXQiLCAxLCAzLCA2LCA5LCAxMiwgMTUsIDIwLCAzMF0sCgkJWyJyYXRlIiwgMC4xLCAwLjIsIDAuNSwgMSwgMiwgMywgNSwgMTBdLAoJXSwKCSLkuIrkuIDpobUiOiBmdW5jdGlvbihldmVudCwgY2FuLCBrZXksIHZhbHVlKSB7CgkJY2FuLmJlZ2luID4gMCAmJiAoY2FuLmJlZ2luIC09IHBhcnNlSW50KGNhbi5BY3Rpb24oImxpbWl0IikpLCBjYW4ub25pbXBvcnQucGFnZShjYW4sIGNhbi5saXN0KSkKCX0sCgki5LiL5LiA6aG1IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgewoJCWNhbi5iZWdpbiArIHBhcnNlSW50KGNhbi5BY3Rpb24oImxpbWl0IikpIDwgY2FuLmxpc3QubGVuZ3RoICYmIChjYW4uYmVnaW4gKz0gcGFyc2VJbnQoY2FuLkFjdGlvbigibGltaXQiKSksIGNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpKQoJfSwKCgkiaGVpZ2h0IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyAKCQljYW4uQWN0aW9uKCJoZWlnaHQiLCB2YWx1ZSksIGNhbi5vbmltcG9ydC5wYWdlKGNhbiwgY2FuLmxpc3QpCgl9LAoJImxpbWl0IjogZnVuY3Rpb24oZXZlbnQsIGNhbiwga2V5LCB2YWx1ZSkgeyAKCQljYW4uQWN0aW9uKCJsaW1pdCIsIHZhbHVlKSwgY2FuLm9uaW1wb3J0LnBhZ2UoY2FuLCBjYW4ubGlzdCkKCX0sCgkicmF0ZSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIGtleSwgdmFsdWUpIHsgCgkJY2FuLkFjdGlvbigicmF0ZSIsIHZhbHVlKSwgY2FuLm9uaW1wb3J0LnBhZ2UoY2FuLCBjYW4ubGlzdCkKCX0sCgoJY2hvb3NlSW1hZ2U6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCWNhbi51c2VyLmFnZW50LmNob29zZUltYWdlKGZ1bmN0aW9uKGxpc3QpIHsgY2FuLmNvcmUuTGlzdChsaXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBbe2ltZzogaXRlbSwgaGVpZ2h0OiAyMDB9XSkKCQl9KSB9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLnu4Tku7boj5zljZUiLCBsaXN0OiBbIuWFs+mXrSIsICLkuIvovb0iLCAi5Yig6ZmkIiwgIuS4iuS4gOS4qiIsICLkuIvkuIDkuKoiLCAi6K6+572u5aS05YOPIiwgIuiuvue9ruiDjOaZryIsICLlpI3liLbpk77mjqUiXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgaW5kZXgpIHsKCQljYW4ub25hcHBlbmQuX2luaXQoY2FuLCB7dHlwZTogInN0b3J5IGZlZWwgZmxvYXQifSwgW10sIGZ1bmN0aW9uKHN1YikgeyBjYW4uc3ViID0gc3ViCgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgcmV0dXJuIGNhbi5ydW4oZXZlbnQsIGNtZHMsIGNiLCB0cnVlKSB9CgoJCQlzdWIuZ2V0QWN0aW9uU2l6ZShmdW5jdGlvbihtc2csIGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkgewoJCQkJc3ViLnBhZ2UuTW9kaWZ5KHN1Yiwgc3ViLl90YXJnZXQsIHtzdHlsZToge2xlZnQ6IGxlZnQsIHRvcDogdG9wfX0pCgkJCQlzdWIucGFnZS5Nb2RpZnkoc3ViLCBzdWIuX291dHB1dCwge3N0eWxlOiB7Im1heC13aWR0aCI6IHdpZHRoLCAibWF4LWhlaWdodCI6IGhlaWdodH19KQoJCQkJc3ViLm9uYXBwZW5kLl9hY3Rpb24oY2FuLCBjYW4ub25kZXRhaWwubGlzdCwgc3ViLl9hY3Rpb24sIGNhbi5vbmRldGFpbCkKCgkJCQljYW4ub3JkZXIgPSBpbmRleCwgY2FuLnNob3cgPSBmdW5jdGlvbihvcmRlcikgewoJCQkJCXBhdGggPSBjYW4ub25pbXBvcnQuX2ZpbGUoY2FuLCBjYW4ubGlzdFtvcmRlcl0ucGF0aCkKCQkJCQlzdWIucGFnZS5BcHBlbmRzKHN1Yiwgc3ViLl9vdXRwdXQsIFt7aW1nOiBwYXRoLCBzdHlsZTogeyJtYXgtd2lkdGgiOiB3aWR0aCwgIm1heC1oZWlnaHQiOiBoZWlnaHQtMipodG1sLkFDVElPTl9IRUlHSFR9fV0pCgkJCQkJc3ViLlN0YXR1cygiYmVnaW4iLCBvcmRlcisxK2ljZS5QUytjYW4ubGlzdC5sZW5ndGgpLCBzdWIuU3RhdHVzKCJmaWxlIiwgcGF0aCkKCQkJCX0sIGNhbi5zaG93KGNhbi5vcmRlcikKCQkJfSkKCQl9LCBkb2N1bWVudC5ib2R5KQoJfSwKCSLlhbPpl60iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5zdWIuX3RhcmdldCkgfSwKCSLkuIvovb0iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi51c2VyLmRvd25sb2FkKGNhbiwgcGF0aCA9IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIGNhbi5saXN0W2Nhbi5vcmRlcl0ucGF0aCkpIH0sCgki5Yig6ZmkIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5ydW4oZXZlbnQsIFtjdHguQUNUSU9OLCBtZGIuUkVNT1ZFLCBjYW4ubGlzdFtjYW4ub3JkZXJdLnBhdGhdLCBmdW5jdGlvbihtc2cpIHsgY2FuLnVzZXIudG9hc3QoY2FuLCAi5Yig6Zmk5oiQ5YqfIikgfSwgdHJ1ZSkKCX0sCgki5LiK5LiA5LiqIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub3JkZXIgPiAwPyBjYW4uc2hvdygtLWNhbi5vcmRlcik6IGNhbi51c2VyLnRvYXN0KGNhbiwgIuW3sue7j+aYr+esrOS4gOW8oOWVpiEiKSB9LAoJIuS4i+S4gOS4qiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9yZGVyIDwgY2FuLmxpc3QubGVuZ3RoLTE/IGNhbi5zaG93KCsrY2FuLm9yZGVyKTogY2FuLnVzZXIudG9hc3QoY2FuLCAi5bey57uP5piv5pyA5ZCO5LiA5byg5ZWmISIpIH0sCgki6K6+572u5aS05YOPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIHt1cmw6IGNhbi5vbmltcG9ydC5fZmlsZShjYW4sIGNhbi5saXN0W2Nhbi5vcmRlcl0ucGF0aCl9KQoJCWNhbi5zZWFyY2goZXZlbnQsIFsiSGVhZGVyLm9uaW1wb3J0LmF2YXRhciJdLCBudWxsLCB0cnVlKQoJfSwKCSLorr7nva7og4zmma8iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtc2cgPSBjYW4ucmVxdWVzdChldmVudCwge3VybDogY2FuLm9uaW1wb3J0Ll9maWxlKGNhbiwgY2FuLmxpc3RbY2FuLm9yZGVyXS5wYXRoKX0pCgkJY2FuLnNlYXJjaChldmVudCwgWyJIZWFkZXIub25pbXBvcnQuYmFja2dyb3VuZCJdLCBudWxsLCB0cnVlKQoJfSwKCSLlpI3liLbpk77mjqUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnVzZXIuY29weShldmVudCwgY2FuLCBjYW4ubWlzYy5NZXJnZVVSTChjYW4sIHtfcGF0aDogY2FuLm9uaW1wb3J0Ll9maWxlKGNhbiwgY2FuLmxpc3RbY2FuLm9yZGVyXS5wYXRoKX0sIHRydWUpKQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbImJlZ2luIiwgImxpbWl0IiwgInRvdGFsIiwgInBvc2l0aW9uIiwgImZpbGUiXSwKCXBvc2l0aW9uOiBmdW5jdGlvbihjYW4sIGluZGV4LCB0b3RhbCkgeyB0b3RhbCA9IHRvdGFsIHx8IGNhbi5tYXgKCQlyZXR1cm4gcGFyc2VJbnQoKGluZGV4KzEpKjEwMC90b3RhbCkrIiUiKyIgPSAiKyhwYXJzZUludChpbmRleCkrMSkraWNlLlBTK3BhcnNlSW50KHRvdGFsKQoJfSwKfSkKCg==",
        "/plugin/local/wiki/word.css": "ZmllbGRzZXQud29yZCBmb3JtLm9wdGlvbiBpbnB1dFtuYW1lPXBhdGhdIHsgd2lkdGg6MTI3cHg7IH0KCmZpZWxkc2V0LndvcmQ+ZGl2Lm5hdm1lbnUgeyBiYWNrZ3JvdW5kLWNvbG9yOmluaGVyaXQ7IG92ZXJmbG93OmF1dG87IG1hcmdpbi1yaWdodDoxMHB4OyBtaW4td2lkdGg6MTIwcHg7IGNsZWFyOmJvdGg7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQud29yZD5kaXYubmF2bWVudSBkaXYubGlzdCB7IG1hcmdpbi1sZWZ0OjIwcHg7IH0KZmllbGRzZXQud29yZD5kaXYubmF2bWVudSBkaXYuaXRlbSB7IGZvbnQtc2l6ZToxLjZlbTsgZm9udC13ZWlnaHQ6Ym9sZDsgZm9udC1mYW1pbHk6Y3Vyc2l2ZTsgcGFkZGluZzo0cHggMTBweDsgfQpmaWVsZHNldC53b3JkPmRpdi5uYXZtZW51PmRpdi5pdGVtIHsgZm9udC1zaXplOjJlbTsgfQoKZmllbGRzZXQud29yZCBhIHsgd29yZC1icmVhazpicmVhay13b3JkOyB9CmZpZWxkc2V0LndvcmQgYnIuc3RvcnkgeyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LndvcmQgdWwuc3RvcnkgeyBmb250LWZhbWlseTptb25vc3BhY2U7IH0KZmllbGRzZXQud29yZCB1bC5zdG9yeSBsaS5IMiB7IGZvbnQtc2l6ZToxLjRlbTsgZm9udC13ZWlnaHQ6Ym9sZDsgfQpmaWVsZHNldC53b3JkIHVsLnN0b3J5IGxpLkgzIHsgZm9udC1zaXplOjEuMmVtOyB9CmZpZWxkc2V0LndvcmQgdWwuc3RvcnlbZGF0YS10eXBlPXByZW1lbnVdIHsgY3Vyc29yOnBvaW50ZXI7IH0KZmllbGRzZXQud29yZCB1bC5zdG9yeVtkYXRhLXR5cGU9cHJlbWVudV0gbGk6aG92ZXIgeyBiYWNrZ3JvdW5kOmN5YW47IGNvbG9yOmJsdWU7IH0KZmllbGRzZXQud29yZCB1bC5zdG9yeVtkYXRhLXR5cGU9ZW5kbWVudV0geyBjbGVhcjpib3RoOyB9CmZpZWxkc2V0LndvcmQgcC5zdG9yeVtkYXRhLW5hbWU9aW5uZXJdIHsgYmFja2dyb3VuZC1jb2xvcjojNGI2YzhhN2E7IHBhZGRpbmc6NHB4IDEwcHg7IGJvcmRlci1sZWZ0OnNvbGlkIDRweCBibHVlOyBtYXJnaW46MTBweCAwcHg7IH0KZmllbGRzZXQud29yZCBwLnN0b3J5W2RhdGEtbmFtZT1pbm5lcl06aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiNjMTBjOGE7IGN1cnNvcjpjb3B5OyB9CmZpZWxkc2V0LndvcmQgc3ZnLnN0b3J5IHsgZGlzcGxheTpibG9jazsgZmxvYXQ6bGVmdDsgfQpmaWVsZHNldC53b3JkIHN2Zy5zdG9yeSB7IGZvbnQtZmFtaWx5OmZhbmdzb25nOyB9CmZpZWxkc2V0LndvcmQgdmlkZW8uc3RvcnkgeyBtYXgtaGVpZ2h0OjMyMHB4OyB9CmZpZWxkc2V0LndvcmQgZmllbGRzZXQuc3RvcnkgeyBtYXJnaW46MTBweDsgfQoKZmllbGRzZXQud29yZC5mbG9hdCB7IHBhZGRpbmc6MDsgbWFyZ2luOjA7IHdpZHRoOi13ZWJraXQtZmlsbC1hdmFpbGFibGU7IHBvc2l0aW9uOmZpeGVkOyBsZWZ0OjA7IHRvcDowOyB6LWluZGV4OjEwOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQ+ZGl2LmFjdGlvbiB7IGRpc3BsYXk6Y29udGVudHM7IH0KZmllbGRzZXQud29yZC5mbG9hdD5kaXYuc3RhdHVzIHsgY2xlYXI6bm9uZTsgfQpmaWVsZHNldC53b3JkLmZsb2F0PmRpdi5vdXRwdXQgeyBiYWNrZ3JvdW5kLWNvbG9yOiNmMGY4ZmY4MDsgcGFkZGluZzoyMHB4OyBvdmVyZmxvdzphdXRvOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQ+ZGl2Lm91dHB1dD5kaXYucHJvamVjdCB7IGJhY2tncm91bmQ6Y29ybnNpbGs7IHBhZGRpbmc6MTBweDsgcG9zaXRpb246Zml4ZWQ7IHJpZ2h0OjA7IHRvcDoyNXB4OyB6LWluZGV4OjEwMDsgfQpmaWVsZHNldC53b3JkLmZsb2F0IGRpdi5jb250ZW50IGRpdi5wYWdlIHsgbWFyZ2luLXRvcDozMHB4OyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQud29yZC5mbG9hdCBkaXYuY29udGVudCBkaXYucGFnZS5zaG93IHsgZGlzcGxheTpibG9jazsgfQpmaWVsZHNldC53b3JkLmZsb2F0IGRpdi5jb250ZW50LmdyaWQgZGl2LnBhZ2UgeyBiYWNrZ3JvdW5kLWNvbG9yOiNhNGNiZWNiNTsgbWFyZ2luOjEwcHg7IGhlaWdodDoyMDBweDsgd2lkdGg6MjAwcHg7IG92ZXJmbG93OmF1dG87IGRpc3BsYXk6YmxvY2s7IGZsb2F0OmxlZnQ7IH0KZmllbGRzZXQud29yZC5mbG9hdCBoMSB7IHRleHQtYWxpZ246Y2VudGVyOyB9CmZpZWxkc2V0LndvcmQuZmxvYXQgaDIgeyB0ZXh0LWFsaWduOmNlbnRlcjsgfQpmaWVsZHNldC53b3JkLmZsb2F0IGgzIHsgdGV4dC1hbGlnbjpjZW50ZXI7IH0KCmZpZWxkc2V0LnBhbmVsLmNtZCBmaWVsZHNldC53b3JkPmxlZ2VuZCB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5wYW5lbC5jbWQgZmllbGRzZXQud29yZD5mb3JtLm9wdGlvbiB7IGRpc3BsYXk6bm9uZTsgfQpmaWVsZHNldC5wYW5lbC5jbWQgZmllbGRzZXQud29yZD5kaXYuYWN0aW9uIHsgZGlzcGxheTpub25lOyB9CmZpZWxkc2V0LnBhbmVsLmNtZCBmaWVsZHNldC53b3JkPmRpdi5zdGF0dXMgeyBkaXNwbGF5Om5vbmU7IH0KCmRpdi5zdG9yeVtkYXRhLXR5cGU9c3BhcmtdW2RhdGEtbmFtZT1zaGVsbF0gbGFiZWwgewoJLW1vei11c2VyLXNlbGVjdDpub25lOyAvKueBq+eLkCovCgktd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7IC8qd2Via2l05rWP6KeI5ZmoKi8KCS1tcy11c2VyLXNlbGVjdDpub25lOyAvKklFMTAqLwoJLWtodG1sLXVzZXItc2VsZWN0Om5vbmU7IC8q5pep5pyf5rWP6KeI5ZmoKi8KCXVzZXItc2VsZWN0Om5vbmU7Cn0KCg==",
        "/plugin/local/wiki/word.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGNiLCB0YXJnZXQpIHsKCgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPiAwKSB7IHJldHVybiBjYW4ub25hcHBlbmQudGFibGUoY2FuLCBtc2cpIH0KCgkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgdGFyZ2V0LCBtc2cuUmVzdWx0KCkpCgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgdGFyZ2V0LCB3aWtpLklURU0sIGZ1bmN0aW9uKGl0ZW0pIHsgdmFyIGRhdGEgPSBpdGVtLmRhdGFzZXR8fHt9CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGl0ZW0sIHtzdHlsZTogY2FuLmJhc2UuT2JqKGRhdGEuc3R5bGUpfSkKCQkJY2FuLmNvcmUuQ2FsbEZ1bmMoW2Nhbi5vbmltcG9ydCwgZGF0YS50eXBlXSwgW2NhbiwgZGF0YSwgaXRlbV0pCgkJCS8vIGNhbi5wYWdlLnN0eWxlKGNhbiwgaXRlbSwgaHRtbC5NQVhfV0lEVEgsIGNhbi5Db25mV2lkdGgoKS0oY2FuLnVzZXIuaXNXaW5kb3dzPyA0MDogMzApKQoJCX0pCgl9LAoJaW1hZ2U6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKS8yLCBodG1sLk1BWF9XSURUSCwgY2FuLkNvbmZXaWR0aCgpKQoKCQkvLyBpZiAoY2FuLnVzZXIuaXNNb2JpbGUpIHsKCQkJaWYgKGNhbi51c2VyLmlzTGFuZHNjYXBlKCkpIHsKCQkJfSBlbHNlewoJCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKSwgaHRtbC5NQVhfV0lEVEgsIGNhbi5Db25mV2lkdGgoKSkKCQkJfQoJCS8vIAlyZXR1cm4KCQkvLyB9CgkJLy8gY2FuLnBhZ2Uuc3R5bGUoY2FuLCB0YXJnZXQsIGh0bWwuTUFYX0hFSUdIVCwgY2FuLkNvbmZIZWlnaHQoKS80KQoJfSwKCW5hdm1lbnU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IHZhciBuYXYgPSBjYW4uc3VwLl9uYXZtZW51CgkJbmF2ID0gbmF2fHxjYW4ucGFnZS5BcHBlbmQoY2FuLCBjYW4uX2ZpZWxkcywgW3t2aWV3OiB3aWtpLk5BVk1FTlV9XSkuZmlyc3QKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBuYXYpLCBjYW4uX2ZpZWxkcy5pbnNlcnRCZWZvcmUobmF2LCBjYW4uX291dHB1dCkKCgkJY2FuLm9uYXBwZW5kLmxpc3QoY2FuLCBjYW4uYmFzZS5PYmooZGF0YS5kYXRhKSwgZnVuY3Rpb24oZXZlbnQsIGl0ZW0pIHsKCQkJdmFyIGxpbmsgPSBpdGVtLm1ldGEubGluaywgbGlzdCA9IGNhbi5jb3JlLlNwbGl0KGl0ZW0ubWV0YS5saW5rKQoJCQlpZiAoY2FuLmNvcmUuVmFsdWUoY2FuLCBsaXN0WzBdKSkgeyByZXR1cm4gY2FuLmNvcmUuQ2FsbEZ1bmMoW2NhbiwgbGlzdFswXV0sIGxpc3Quc2xpY2UoMSkpIH0KCQkJaWYgKCFsaW5rIHx8IGxpbmsgPT0gY2FuLk9wdGlvbihuZnMuUEFUSCkpIHsgcmV0dXJuIGZhbHNlIH0KCgkJCWlmIChjYW4ub25tb3Rpb24uY2FjaGUoY2FuLCBmdW5jdGlvbigpIHsgY2FuLnVzZXIubW9kLmlzQ21kICYmIGNhbi51c2VyLnRpdGxlKGl0ZW0ubWV0YS5uYW1lKTsgcmV0dXJuIGNhbi5PcHRpb24obmZzLlBBVEgsIGxpbmspIH0pKSB7IHJldHVybiB9CgkJCXJldHVybiBjYW4uc3VwLlVwZGF0ZShldmVudCwgW2xpbmtdKQoJCX0sIG5hdiksIGNhbi5zdXAuX25hdm1lbnUgPSBuYXYKCgkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obXNnKSB7IAoJCQljYW4ucGFnZS5zdHlsZShjYW4sIG5hdiwgaHRtbC5IRUlHSFQsIGNhbi5Db25mKGh0bWwuSEVJR0hUKSsoY2FuLnVzZXIubW9kLmlzQ21kPyBtc2cuT3B0aW9uKGh0bWwuTUFSR0lOX1kpOiAwKSkKCQkJY2FuLkNvbmYoaHRtbC5XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCktbmF2Lm9mZnNldFdpZHRoLShjYW4udXNlci5tb2QuaXNDbWQ/IDEwOiAyMCktMTApCgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5fb3V0cHV0LCB7c3R5bGU6IGtpdC5EaWN0KAoJCQkJaHRtbC5IRUlHSFQsIGNhbi5zdXAuX25hdm1lbnUub2Zmc2V0SGVpZ2h0LCBodG1sLk1BWF9XSURUSCwgY2FuLkNvbmYoaHRtbC5XSURUSCksCgkJCQlodG1sLkZMT0FULCBodG1sLkxFRlQsIGh0bWwuQ0xFQVIsIGh0bWwuTk9ORQoJCQkpfSkKCQl9KQoJfSwKCXByZW1lbnU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsIGNhbi5wYWdlLktleXMod2lraS5IMiwgd2lraS5IMyksIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IFtpdGVtLmlubmVySFRNTCwgaHRtbC5MSSwgaXRlbS50YWdOYW1lXSwgb25jbGljazogZnVuY3Rpb24oKSB7CgkJCQlpdGVtLnNjcm9sbEludG9WaWV3KCkKCQkJfX1dKSwgaXRlbS5vbmNsaWNrID0gZnVuY3Rpb24oZXZlbnQpIHsgdGFyZ2V0LnNjcm9sbEludG9WaWV3KCkgfQoJCX0pCgl9LAoJdGl0bGU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7CgkJY2FuLnVzZXIubW9kLmlzQ21kICYmIHRhcmdldC50YWdOYW1lID09ICJIMSIgJiYgY2FuLnVzZXIudGl0bGUoZGF0YS50ZXh0KQoJfSwKCXJlZmVyOiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5BLCBmdW5jdGlvbihpdGVtKSB7CgkJCWl0ZW0ub25jbGljayA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgbWRiLkNSRUFURSwgbWRiLlRZUEUsICJyZWZlciIsIG1kYi5OQU1FLCBpdGVtLmRhdGFzZXQubmFtZSwgbWRiLlRFWFQsIGl0ZW0uaHJlZl0sIG51bGwsIHRydWUpCgkJCX0KCQl9KQoJfSwKCXNwYXJrOiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCWlmIChkYXRhW21kYi5OQU1FXSA9PSBjaGF0LkZJRUxEKSB7CgkJCWZ1bmN0aW9uIGRlZXAodGV4dCkgeyB2YXIgZCA9IDAKCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykgewoJCQkJCXN3aXRjaCAodGV4dFtpXSkgewoJCQkJCQljYXNlICJcdCI6IGQgKz0gNDsgYnJlYWsKCQkJCQkJY2FzZSAiICI6IGQrKzsgYnJlYWsKCQkJCQkJZGVmYXVsdDogcmV0dXJuIGQKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gZAoJCQl9CgkJCXZhciBsaXN0ID0gW107IGNhbi5jb3JlLkxpc3QodGFyZ2V0LmlubmVyVGV4dC5zcGxpdChpY2UuTkwpLCBmdW5jdGlvbihsaW5lKSB7IHZhciBfZGVlcCA9IGRlZXAobGluZSkKCQkJCXdoaWxlIChsaXN0Lmxlbmd0aCA+IDApIHsgaWYgKF9kZWVwIDw9IGxpc3RbbGlzdC5sZW5ndGgtMV0uX2RlZXApIHsgbGlzdC5wb3AoKSB9IGVsc2UgeyBicmVhayB9IH0KCQkJCXZhciBscyA9IGNhbi5jb3JlLlNwbGl0KGxpbmUpLCBpdGVtID0ge19kZWVwOiBfZGVlcCwgbWV0YToge2luZGV4OiBsc1swXSwgbmFtZTogbHNbMV0sIGFyZ3M6IGxzLnNsaWNlKDIpfSwgbGlzdDogW119CgkJCQlpZiAobGlzdC5sZW5ndGggPiAwKSB7IGxpc3RbbGlzdC5sZW5ndGgtMV0ubGlzdC5wdXNoKGl0ZW0pIH0gbGlzdC5wdXNoKGl0ZW0pCgkJCX0pCgoJCQl2YXIgZmlyc3Q7IGZ1bmN0aW9uIHNob3coaXRlbSwgaW5kZXgsIHRhcmdldCwgb3V0cHV0KSB7CgkJCQl2YXIgdWkgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogW2h0bWwuSVRFTSwgaHRtbC5ESVYsIGl0ZW0ubWV0YS5uYW1lfHxpdGVtLm1ldGEuaW5kZXhdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWlmICh1aS5saXN0LmlubmVyVGV4dCkgeyByZXR1cm4gY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIHVpLmxpc3QpIH0KCQkJCQljYW4ub25tb3Rpb24uc2VsZWN0KGNhbiwgdmlldy5tZW51LCBodG1sLkRJVl9JVEVNLCBldmVudC50YXJnZXQpCgkJCQkJaWYgKGNhbi5vbm1vdGlvbi5jYWNoZShjYW4sIGZ1bmN0aW9uKCkgeyByZXR1cm4gaW5kZXggfSwgb3V0cHV0KSkgeyByZXR1cm4gfQoJCQkJCWNhbi5jb3JlLkxpc3QoaXRlbS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCQkJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBpdGVtLm1ldGEsIGZ1bmN0aW9uKHN1YikgewoJCQkJCQkJc3ViLnJ1biA9IGZ1bmN0aW9uKGV2ZW50LCBjbWRzLCBjYiwgc2lsZW50KSB7CgkJCQkJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGljZS5SVU4sIGl0ZW0ubWV0YS5pbmRleF0sIGNtZHMpLCBjYiwgdHJ1ZSkKCQkJCQkJCX0KCQkJCQkJCXN1Yi5Db25mV2lkdGgoaXRlbS5tZXRhLndpZHRoID0gY2FuLkNvbmZXaWR0aCgpLTE2NSkKCQkJCQkJCXN1Yi5Db25mSGVpZ2h0KGl0ZW0ubWV0YS5oZWlnaHQgPSBjYW4uQ29uZkhlaWdodCgpLTMwMCkKCQkJCQkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCktMipodG1sLlBMVUdJTl9NQVJHSU4pCgkJCQkJCQljYW4ucGFnZS5zdHlsZShjYW4sIHN1Yi5fc3RhdHVzLCBodG1sLk1BWF9XSURUSCwgc3ViLkNvbmZXaWR0aCgpLTIqaHRtbC5QTFVHSU5fTUFSR0lOKQoJCQkJCQl9LCBvdXRwdXQpCgkJCQkJfSkKCQkJCX19LCB7dmlldzogaHRtbC5MSVNUfV0pCgkJCQljYW4uY29yZS5MaXN0KGl0ZW0ubGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLmxpc3QubGVuZ3RoID4gMCAmJiBzaG93KGl0ZW0sIGNhbi5jb3JlLktleXMoaW5kZXgsIGl0ZW0ubWV0YS5pbmRleCksIHVpLmxpc3QsIG91dHB1dCkgfSkKCQkJCXVpLmxpc3QuaW5uZXJUZXh0ID09ICIiICYmIChmaXJzdCA9IGZpcnN0fHx1aS5pdGVtKQoJCQl9CgoJCQl2YXIgdmlldyA9IGNhbi5wYWdlLkFwcGVuZHMoY2FuLCB0YXJnZXQsIFt7dmlldzogaHRtbC5NRU5VfSwge3ZpZXc6IGh0bWwuTElTVH1dKQoJCQlyZXR1cm4gc2hvdyhsaXN0WzBdLCBsaXN0WzBdLl9pbmRleCwgdmlldy5tZW51LCB2aWV3Lmxpc3QpLCBmaXJzdC5jbGljaygpCgkJfQoJCWlmIChkYXRhW21kYi5OQU1FXSA9PSBodG1sLklOTkVSKSB7IHJldHVybiBjYW4ub25tb3Rpb24uY29weShjYW4sIHRhcmdldCkgfQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5BLCBmdW5jdGlvbihpdGVtKSB7IGNhbi5vbm1vdGlvbi5saW5rKGNhbiwgaXRlbSkgfSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsIGh0bWwuU1BBTiwgZnVuY3Rpb24oaXRlbSkgewoJCQljYW4ub25tb3Rpb24uY29weShjYW4sIGl0ZW0sICIiLCBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIG1kYi5DUkVBVEUsIG1kYi5UWVBFLCAic3BhcmsiLCBtZGIuTkFNRSwgInNoZWxsIiwgbWRiLlRFWFQsIGl0ZW0uaW5uZXJUZXh0XSwgbnVsbCwgdHJ1ZSkKCQkJfSkKCQl9KQoJfSwKCWNoYXJ0OiBmdW5jdGlvbihjYW4sIGRhdGEsIHRhcmdldCkgewoJCXRhcmdldC5vbmNvbnRleHRtZW51ID0gZnVuY3Rpb24oZXZlbnQpIHsKCQkJY2FuLnVzZXIuY2FydGVDbGllbnQoZXZlbnQsIGNhbiwga2l0LkRpY3QobWRiLkVYUE9SVCwgZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJCQljYW4ub25tb3Rpb24udG9pbWFnZShldmVudCwgY2FuLCAiaGkucG5nIiwgdGFyZ2V0KQoJCQl9KSwgW21kYi5FWFBPUlRdKQoJCX0KCX0sCgl0YWJsZTogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKCQljYW4ucGFnZS5PcmRlclRhYmxlKGNhbiwgdGFyZ2V0KSwgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgY2hhdC5DT05URU5UKQoJCWNhbi5wYWdlLlNlbGVjdChjYW4sIHRhcmdldCwgaHRtbC5URCwgZnVuY3Rpb24oaXRlbSkgeyBjYW4ub25tb3Rpb24uY29weShjYW4sIGl0ZW0pIH0pCgl9LAoJZmllbGQ6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0LCB3aWR0aCkgeyB2YXIgaXRlbSA9IGNhbi5iYXNlLk9iaihkYXRhLm1ldGEpCgkJY2FuLm9uYXBwZW5kLl9pbml0KGNhbiwgaXRlbSwgW2NoYXQuUExVR0lOX1NUQVRFX0pTXSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IsIHNpbGVudCkgewoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgW2N0eC5BQ1RJT04sIGNoYXQuU1RPUlksIGRhdGEudHlwZSwgZGF0YS5uYW1lLCBkYXRhLnRleHRdLCBjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQkJc3ViLkNvbmZIZWlnaHQoY2FuLkNvbmZIZWlnaHQoKSkKCQkJc3ViLkNvbmZXaWR0aChpdGVtLndpZHRoID0gKHdpZHRofHxjYW4uQ29uZldpZHRoKCkpLShjYW4udXNlci5pc1dpbmRvd3M/IDQwOiAyMCkpCgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgc3ViLl9vdXRwdXQsIGh0bWwuTUFYX1dJRFRILCBzdWIuQ29uZldpZHRoKCkpCgoJCQljYW4uY29yZS5WYWx1ZShpdGVtLCAiYXV0by5jbWQiKSAmJiBjYW4uY29yZS5UaW1lcjMwMG1zKGZ1bmN0aW9uKCkgewoJCQkJdmFyIG1zZyA9IHN1Yi5yZXF1ZXN0KHt9LCBjYW4uY29yZS5WYWx1ZShpdGVtLCAib3B0cyIpKTsgbXNnLk9wdGlvbihpY2UuTVNHX0hBTkRMRSwgaWNlLlRSVUUpCgkJCQlzdWIuVXBkYXRlKG1zZy5fZXZlbnQsIFtjdHguQUNUSU9OLCBjYW4uY29yZS5WYWx1ZShpdGVtLCAiYXV0by5jbWQiKV0pCgkJCX0pCgkJfSwgY2FuLl9vdXRwdXQsIHRhcmdldCkKCX0sCglpZnJhbWU6IGZ1bmN0aW9uKGNhbiwgZGF0YSwgdGFyZ2V0KSB7IHZhciBtZXRhID0gY2FuLmJhc2UuT2JqKGRhdGEubWV0YSkKCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCB0YXJnZXQsIHt3aWR0aDogY2FuLkNvbmYoaHRtbC5XSURUSCktMjAwfSkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbmtleW1hcCIsIHtoZWxwOiAi6ZSu55uY5Lqk5LqSIiwgbGlzdDogW10sCglfbW9kZTogewoJCW5vcm1hbDogewoJCQkibiI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsLm5leHQoY2FuLnN1YikgfSwKCQkJImoiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbC5uZXh0KGNhbi5zdWIpIH0sCgkJCSJBcnJvd1JpZ2h0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25kZXRhaWwubmV4dChjYW4uc3ViKSB9LAoJCQkiQXJyb3dMZWZ0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25kZXRhaWwucHJldihjYW4uc3ViKSB9LAoJCQkiayI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsLnByZXYoY2FuLnN1YikgfSwKCQkJInAiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbC5wcmV2KGNhbi5zdWIpIH0sCgoJCQkicSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uZGV0YWlsWyLnu5PmnZ8iXShldmVudCwgY2FuLnN1YikgfSwKCQkJImgiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbmRldGFpbFsi6ZqQ6JePIl0oZXZlbnQsIGNhbi5zdWIpIH0sCgkJfSwKCX0sIF9lbmdpbmU6IHt9LAp9KQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIuaOp+S7tuS6pOS6kiIsIGxpc3Q6IFtdLAoJX3RyYW5zOiB7dmlldzogIuinhuWbviJ9LAoJcGxheTogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbGlzdCA9IFtdLCBjdXJyZW50ID0gW10KCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgd2lraS5JVEVNLCBmdW5jdGlvbihpdGVtKSB7CgkJCXN3aXRjaCAoaXRlbS50YWdOYW1lKSB7CgkJCQljYXNlICJIMSI6CgkJCQljYXNlICJIMiI6CgkJCQljYXNlICJIMyI6CgkJCQkJbGlzdC5wdXNoKGN1cnJlbnQgPSBbXSkKCQkJCQlicmVhawoJCQl9CgkJCWN1cnJlbnQucHVzaChpdGVtKQoJCX0pCgoJCWNhbi5vbmFwcGVuZC5faW5pdChjYW4sIHt0eXBlOiAic3Rvcnkgd29yZCBmbG9hdCJ9LCBbXSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBjYW4ucnVuLCBzdWIuc3VwID0gY2FuLCBjYW4uc3ViID0gc3ViLCBjYW4ub25hcHBlbmQuX2FjdGlvbihzdWIsIFsKCQkJCVsi5biD5bGAIiwgIuW8gOiusiIsICLlv6vpl6oiLCAi572R5qC8Il0sICLlpKfnurIiLCAi6aaW6aG1IiwgIuS4iuS4gOmhtSIsCgkJCQlbIuiPnOWNlSJdLmNvbmNhdChjYW4uY29yZS5MaXN0KGxpc3QsIGZ1bmN0aW9uKHBhZ2UpIHsgcmV0dXJuIHBhZ2VbMF0uaW5uZXJIVE1MIH0pKSwKCQkJCSLkuIvkuIDpobUiLCAi6ZqQ6JePIiwgIue7k+adnyIsCgkJCV0sIHN1Yi5fYWN0aW9uLCBjYW4ub25kZXRhaWwpCgoJCQljYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgImtleW1hcC5mb2N1cyIsIGNhbi5yZXF1ZXN0KGV2ZW50LCB7Y2I6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4ua2V5bGlzdCA9IGNhbi5vbmtleW1hcC5fcGFyc2UoZXZlbnQsIGNhbiwgIm5vcm1hbCIsIGNhbi5rZXlsaXN0KQoJCQl9fSkpLCBjYW4ub25rZXltYXAuX2J1aWxkKGNhbikKCgkJCXN1Yi5wYWdlLnN0eWxlKHN1Yiwgc3ViLl90YXJnZXQsIGh0bWwuQkFDS0dST1VORCwgZG9jdW1lbnQuYm9keS5zdHlsZS5iYWNrZ3JvdW5kKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLkhFSUdIVCwgd2luZG93LmlubmVySGVpZ2h0LTQqaHRtbC5QTFVHSU5fTUFSR0lOLTIqaHRtbC5BQ1RJT05fSEVJR0hUKQoJCQlzdWIucGFnZS5zdHlsZShzdWIsIHN1Yi5fb3V0cHV0LCBodG1sLldJRFRILCB3aW5kb3cuaW5uZXJXaWR0aC00Kmh0bWwuUExVR0lOX01BUkdJTikKCgkJCXN1Yi51aSA9IHN1Yi5wYWdlLkFwcGVuZChzdWIsIHN1Yi5fb3V0cHV0LCBbe3ZpZXc6IGNoYXQuUFJPSkVDVH0sIHt2aWV3OiBjaGF0LkNPTlRFTlR9XSkKCQkJY2FuLmNvcmUuTGlzdChzdWIubGlzdCA9IGxpc3QsIGZ1bmN0aW9uKHBhZ2UsIGluZGV4KSB7CgkJCQljYW4ub25hcHBlbmQuaXRlbShjYW4sIGh0bWwuSVRFTSwge25hbWU6IHBhZ2VbMF0uaW5uZXJIVE1MfSwgZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4ub25kZXRhaWwuc2hvdyhzdWIsIGluZGV4KSAKCQkJCX0sIGZ1bmN0aW9uKGV2ZW50KSB7fSwgc3ViLnVpLnByb2plY3QpCgoJCQkJc3ViLnBhZ2UuQXBwZW5kKHN1Yiwgc3ViLnVpLmNvbnRlbnQsIFt7dmlldzogInBhZ2UiKyhpbmRleD09MD8gIiBmaXJzdCI6ICIiKSwgbGlzdDogY2FuLmNvcmUuTGlzdChwYWdlLCBmdW5jdGlvbihpdGVtKSB7IHZhciBkYXRhID0gaXRlbS5kYXRhc2V0fHx7fQoJCQkJCXN3aXRjaCAoZGF0YS50eXBlKSB7CgkJCQkJCWNhc2Ugd2lraS5QUkVNRU5VOiBpdGVtID0gaXRlbS5jbG9uZU5vZGUoZmFsc2UpOyBicmVhawoJCQkJCQljYXNlIGNoYXQuRklFTEQ6IGl0ZW0gPSBjYW4ub25hcHBlbmQuZmllbGQoY2FuLCBjaGF0LlNUT1JZLCBjYW4uYmFzZS5PYmooZGF0YS5tZXRhKSwgc3ViLnVpLmNvbnRlbnQpLmZpcnN0OyBicmVhawoJCQkJCQlkZWZhdWx0OiBpdGVtID0gaXRlbS5jbG9uZU5vZGUodHJ1ZSkKCQkJCQl9CgkJCQkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25pbXBvcnQsIGRhdGEudHlwZV0sIFtzdWIsIGRhdGEsIGl0ZW0sIHdpbmRvdy5pbm5lcldpZHRoLTQqaHRtbC5QTFVHSU5fTUFSR0lOXSksIGl0ZW0KCQkJCX0pLCB9XSkKCQkJfSksIGNhbi5vbm1vdGlvbi5oaWRkZW4oY2FuLCBzdWIudWkucHJvamVjdCksIGNhbi5vbmRldGFpbC5zaG93KHN1YiwgMCkgCgoJCQlzdWIub25hcHBlbmQuX3N0YXR1cyhzdWIsIFttZGIuUEFHRSwgY2xpLkZST00sIGNsaS5DT1NUXSksIHN1Yi5TdGF0dXMoY2xpLkZST00sIGNhbi5iYXNlLlRpbWUoKSkKCQkJdmFyIGZyb20gPSBuZXcgRGF0ZSgpOyBjYW4uY29yZS5UaW1lcih7aW50ZXJ2YWw6IDEwMH0sIGZ1bmN0aW9uKCkgeyB2YXIgbm93ID0gbmV3IERhdGUoKQoJCQkJc3ViLlN0YXR1cyhjbGkuQ09TVCwgY2FuLmJhc2UuRHVyYXRpb24obm93LWZyb20pKQoJCQl9KQoJCX0sIGRvY3VtZW50LmJvZHkpCgl9LAoJdmlldzogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWlmIChjYW4uX2hlaWdodCkgewoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0LCBjYW4uX2hlaWdodCksIGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnN1cC5fbmF2bWVudSwgY2FuLl9oZWlnaHQpLCBkZWxldGUoY2FuLl9oZWlnaHQpCgkJfSBlbHNlIHsgY2FuLl9oZWlnaHQgPSBjYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0KQoJCQljYW4ucGFnZS5zdHlsZUhlaWdodChjYW4sIGNhbi5fdGFyZ2V0LCAiIiksIGNhbi5wYWdlLnN0eWxlSGVpZ2h0KGNhbiwgY2FuLnN1cC5fbmF2bWVudSwgIiIpCgkJfQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLkuqTkupLmk43kvZwiLCBsaXN0OiBbIuWIoOmZpCJdLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHsKCX0sCglzaG93OiBmdW5jdGlvbihzdWIsIHdoaWNoKSB7IHN1Yi5wYWdlLk1vZGlmeShzdWIsIHN1Yi51aS5jb250ZW50LCB7Y2xhc3NOYW1lOiBjaGF0LkNPTlRFTlR9KQoJCXN1Yi5wYWdlLlNlbGVjdChzdWIsIHN1Yi51aS5jb250ZW50LCB3aWtpLkRJVl9QQUdFLCBmdW5jdGlvbihwYWdlLCBpbmRleCkgewoJCQlpZiAoaW5kZXggPT0gd2hpY2ggfHwgcGFnZSA9PSB3aGljaCkgewoJCQkJc3ViLnBhZ2UuU2VsZWN0KHN1YiwgcGFnZSwgc3ViLnBhZ2UuS2V5cyhodG1sLkgxLCBodG1sLkgyLCBodG1sLkgzKSwgZnVuY3Rpb24oaXRlbSkgeyBzdWIuQWN0aW9uKCLoj5zljZUiLCBpdGVtLmlubmVySFRNTCkgfSkKCQkJCXN1Yi5vbm1vdGlvbi5zZWxlY3Qoc3ViLCBzdWIudWkucHJvamVjdCwgaHRtbC5ESVZfSVRFTSwgaW5kZXgpCgkJCQlzdWIuU3RhdHVzKG1kYi5QQUdFLCBpbmRleCsxK2ljZS5QUytzdWIubGlzdC5sZW5ndGgpCgkJCQlzdWIucGFnZS5DbGFzc0xpc3QuYWRkKHN1YiwgcGFnZSwgaHRtbC5TSE9XKQoJCQl9IGVsc2UgewoJCQkJc3ViLnBhZ2UuQ2xhc3NMaXN0LmRlbChzdWIsIHBhZ2UsIGh0bWwuU0hPVykKCQkJfQoJCX0pCgl9LAoJbmV4dDogZnVuY3Rpb24oc3ViKSB7CgkJc3ViLnBhZ2UuU2VsZWN0KHN1Yiwgc3ViLnVpLmNvbnRlbnQsIHN1Yi5jb3JlLktleXMod2lraS5ESVZfUEFHRSwgaWNlLlNIT1cpLCBmdW5jdGlvbihwYWdlKSB7CgkJCXBhZ2UubmV4dFNpYmxpbmc/IHN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UubmV4dFNpYmxpbmcpOiBzdWIudXNlci50b2FzdChzdWIsIGNsaS5FTkQpCgkJfSkKCX0sCglwcmV2OiBmdW5jdGlvbihzdWIpIHsKCQlzdWIucGFnZS5TZWxlY3Qoc3ViLCBzdWIudWkuY29udGVudCwgc3ViLmNvcmUuS2V5cyh3aWtpLkRJVl9QQUdFLCBpY2UuU0hPVyksIGZ1bmN0aW9uKHBhZ2UpIHsKCQkJcGFnZS5wcmV2aW91c1NpYmxpbmc/IHN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UucHJldmlvdXNTaWJsaW5nKTogc3ViLnVzZXIudG9hc3Qoc3ViLCBjbGkuRU5EKQoJCX0pCgl9LAoJZmxhc2g6IGZ1bmN0aW9uKHN1YikgewoJCXN1Yi5jb3JlLk5leHQoc3ViLnBhZ2UuU2VsZWN0KHN1Yiwgc3ViLnVpLmNvbnRlbnQsIHdpa2kuRElWX1BBR0UpLCBmdW5jdGlvbihwYWdlLCBuZXh0KSB7CgkJCXN1Yi5zdXAub25kZXRhaWwuc2hvdyhzdWIsIHBhZ2UpLCBzdWIuY29yZS5UaW1lcig1MDAsIGZ1bmN0aW9uKCkgeyBuZXh0KCkgfSkKCQl9KQoJfSwKCWdyaWQ6IGZ1bmN0aW9uKHN1YikgeyBzdWIucGFnZS5Nb2RpZnkoc3ViLCBzdWIudWkuY29udGVudCwge2NsYXNzTmFtZTogImNvbnRlbnQgZ3JpZCJ9KSB9LAoKCSLlvIDorrIiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwuc2hvdyhjYW4sIDApIH0sCgki5b+r6ZeqIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc3VwLm9uZGV0YWlsLmZsYXNoKGNhbikgfSwKCSLnvZHmoLwiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwuZ3JpZChjYW4pIH0sCgoJIuWkp+e6siI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9ubW90aW9uLnRvZ2dsZShjYW4sIGNhbi51aS5wcm9qZWN0KSB9LAoJIummlumhtSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmRldGFpbC5zaG93KGNhbiwgMCkgfSwKCSLkuIrkuIDpobUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5zdXAub25kZXRhaWwucHJldihjYW4sIGNhbi51aS5jb250ZW50KSB9LAoJIuiPnOWNlSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnN1cC5vbmRldGFpbC5zaG93KGNhbiwgZXZlbnQudGFyZ2V0LnNlbGVjdGVkSW5kZXgpIH0sCgki5LiL5LiA6aG1IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4uc3VwLm9uZGV0YWlsLm5leHQoY2FuLCBjYW4udWkuY29udGVudCkgfSwKCSLpmpDol48iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX291dHB1dCkgfSwKCSLnu5PmnZ8iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5fdGFyZ2V0KSB9LAoJIuWIoOmZpCI6IGZ1bmN0aW9uKGV2ZW50LCBzdWIpIHsgc3ViLnBhZ2UuUmVtb3ZlKHN1Yiwgc3ViLl90YXJnZXQpIH0sCn0pCgo=",
        "/plugin/state.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgY29uZiwgbGlzdCwgY2IsIHRhcmdldCkge30sCglfcHJvY2VzczogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQltc2cuT3B0aW9uU3RhdHVzKCkgJiYgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLl9zdGF0dXMpICYmIGNhbi5vbmFwcGVuZC5fc3RhdHVzKGNhbiwgY2FuLmJhc2UuT2JqKG1zZy5PcHRpb25TdGF0dXMoKSkpCgkJcmV0dXJuIGNhbi5jb3JlLkNhbGxGdW5jKFtjYW4ub25pbXBvcnQsIG1zZy5PcHRpb25Qcm9jZXNzKCldLCBbY2FuLCBtc2ddKQoJfSwKCglfY29uZmlybTogZnVuY3Rpb24oY2FuLCBtc2csIF9hcmcpIHsgdmFyIHN1YiA9IGNhbi5yZXF1ZXN0KHt9LCBjYW4uT3B0aW9uKCkpCgkJaWYgKGNhbi51c2VyLmNvbmZpcm0oX2FyZykpIHsgY2FuLnJ1bihzdWIuX2V2ZW50LCBbY3R4LkFDVElPTiwgImNvbmZpcm0iXSwgZnVuY3Rpb24oKSB7fSwgdHJ1ZSkgfQoJfSwKCV9sb2NhdGlvbjogZnVuY3Rpb24oY2FuLCBtc2cpIHsgbG9jYXRpb24uaHJlZiA9IG1zZy5fYXJnWzBdIH0sCglfcmVwbGFjZTogZnVuY3Rpb24oY2FuLCBtc2cpIHsgbG9jYXRpb24ucmVwbGFjZShtc2cuX2FyZ1swXSkgfSwKCV9oaXN0b3J5OiBmdW5jdGlvbihjYW4sIG1zZykgeyBoaXN0b3J5LmJhY2soKSB9LAoJX3Jld3JpdGU6IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJZm9yICh2YXIgaSA9IDA7IGkgPCBtc2cuX2FyZy5sZW5ndGg7IGkgKz0gMikgewoJCQljYW4uT3B0aW9uKG1zZy5fYXJnW2ldLCBtc2cuX2FyZ1tpKzFdKQoJCQljYW4uQWN0aW9uKG1zZy5fYXJnW2ldLCBtc2cuX2FyZ1tpKzFdKQoJCX0KCQljYW4uVXBkYXRlKCkKCQlyZXR1cm4gdHJ1ZQoJfSwKCV9yZWZyZXNoOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5jb3JlLlRpbWVyKHBhcnNlSW50KG1zZy5PcHRpb24oIl9kZWxheSIpfHwiNTAwIiksIGZ1bmN0aW9uKCkgewoJCQl2YXIgc3ViID0gY2FuLnJlcXVlc3Qoe30sIHtfY291bnQ6IHBhcnNlSW50KG1zZy5PcHRpb24oIl9jb3VudCIpKS0xfSkKCQkJY2FuLlVwZGF0ZSgpCgkJfSkKCQlyZXR1cm4gdHJ1ZQoJfSwKCV9kaXNwbGF5OiBmdW5jdGlvbihjYW4sIG1zZykgewoJCVZvbGNhbm9zKCJzb21lIiwge30sIFttc2cuT3B0aW9uKGljZS5NU0dfRElTUExBWSldLmNvbmNhdChWb2xjYW5vcy5tZXRhLmxpYnMsIFZvbGNhbm9zLm1ldGEudm9sY2FubyksIGZ1bmN0aW9uKHN1YikgewoJCQlzdWIuQ29uZihjYW4uQ29uZigpKSwgc3ViLnJ1biA9IGNhbi5ydW4KCQkJc3ViLl9vcHRpb24gPSBjYW4uX29wdGlvbiwgc3ViLl9hY3Rpb24gPSBjYW4uX2FjdGlvbgoJCQlzdWIub25pbXBvcnQuX2luaXQoc3ViLCBtc2csIFtdLCBmdW5jdGlvbigpIHt9LCBjYW4uX291dHB1dCkKCQl9KQoJCXJldHVybiB0cnVlCgl9LAoJX2ZpZWxkOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCW1zZy5UYWJsZShmdW5jdGlvbihpdGVtKSB7IGl0ZW0udHlwZSA9IGNoYXQuU1RPUlksIGNhbi5vbmFwcGVuZC5fcGx1Z2luKGNhbiwgaXRlbSwge3R5cGU6IGNoYXQuU1RPUlksIGFyZzogY2FuLmJhc2UuT2JqKGl0ZW1baWNlLkFSR10sIFtdKX0sIGZ1bmN0aW9uKHN1YiwgbWV0YSkgewoJCQlzdWIuQ29uZihjYW4uYmFzZS5PYmooaXRlbS5jb25mKSkKCQkJaWYgKHN1Yi5Db25mKCJtb2RlIikgPT0gInNpbXBsZSIpIHsKCQkJCXZhciBtc2cgPSBjYW4ucmVxdWVzdCgpCgkJCQltc2cuRWNobyhzdWIuQ29uZigicmVzdWx0IikpCgkJCQlzdWIuQ29uZihodG1sLkhFSUdIVCwgY2FuLkNvbmYoaHRtbC5IRUlHSFQpLzIpCgkJCQljYW4ub25hcHBlbmQuX291dHB1dChzdWIsIG1zZywgbXNnLk9wdGlvbihpY2UuTVNHX0RJU1BMQVkpfHxzdWIuQ29uZigiZmVhdHVyZS5kaXNwbGF5Iil8fCIvcGx1Z2luL3RhYmxlLmpzIikKCQkJCXJldHVybgoJCQl9CgkJCXZhciBvcHQgPSBjYW4uYmFzZS5PYmooaXRlbVtpY2UuT1BUXSwgW10pCgkJCXN1Yi5Db25mKGh0bWwuSEVJR0hULCBjYW4uQ29uZihodG1sLkhFSUdIVCkpCgkJCXN1Yi5Db25mKGh0bWwuV0lEVEgsIGNhbi5Db25mKGh0bWwuV0lEVEgpLTQqaHRtbC5QTFVHSU5fTUFSR0lOKQoJCQlzdWIucnVuID0gZnVuY3Rpb24oZXZlbnQsIGNtZHMsIGNiLCBzaWxlbnQpIHsKCQkJCXZhciByZXMgPSBjYW4ucmVxdWVzdChldmVudCwgY2FuLk9wdGlvbigpKQoJCQkJZm9yICh2YXIgaSA9IDA7IGkgPCBvcHQubGVuZ3RoOyBpICs9IDIpIHsgcmVzLk9wdGlvbihvcHRbaV0sIG9wdFtpKzFdKSB9CgkJCQljYW4ucnVuKGV2ZW50LCAobXNnW2ljZS5NU0dfUFJFRklYXXx8W10pLmNvbmNhdChjbWRzKSwgY2IsIHRydWUpCgkJCX0KCQl9KSB9KQoJCXJldHVybiB0cnVlCgl9LAoJX2lubmVyOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZykKCQljYW4ub25hcHBlbmQuYm9hcmQoY2FuLCBtc2cpCgkJY2FuLm9ubW90aW9uLnN0b3J5LmF1dG8oY2FuKQoJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGNhbi5fb3V0cHV0LCB7c3R5bGU6IHtkaXNwbGF5OiBodG1sLkJMT0NLfX0pCgkJcmV0dXJuIHRydWUKCX0sCgoJX29wZW46IGZ1bmN0aW9uKGNhbiwgbXNnKSB7CgkJY2FuLnVzZXIub3Blbihtc2cuT3B0aW9uKCJfYXJnIikpLCBjYW4uVXBkYXRlKCkKCQlyZXR1cm4gdHJ1ZQoJfSwKCV9ob2xkOiBmdW5jdGlvbihjYW4sIG1zZykgeyByZXR1cm4gdHJ1ZSB9LAoJX2JhY2s6IGZ1bmN0aW9uKGNhbikgewoJCWNhbi5faGlzdG9yeS5wb3AoKTsgZm9yICh2YXIgaGlzID0gY2FuLl9oaXN0b3J5LnBvcCgpOyBoaXM7IGhpcyA9IGNhbi5faGlzdG9yeS5wb3AoKSkgeyBpZiAoaGlzWzBdID09IGN0eC5BQ1RJT04pIHsgY29udGludWUgfQoJCQl2YXIgaW5kZXggPSAwCgkJCWNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBjYW4uX29wdGlvbiwgIiIsIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS52YWx1ZSA9IGhpc1tpbmRleCsrXXx8IiIgfSkKCQkJY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGNhbi5fYWN0aW9uLCAiIiwgZnVuY3Rpb24oaXRlbSkgeyBpdGVtLnZhbHVlID0gaGlzW2luZGV4KytdfHwiIiB9KQoJCQljYW4uVXBkYXRlKCkKCQkJYnJlYWsKCQl9CgkJIWhpcyAmJiBjYW4uVXBkYXRlKCkKCQlyZXR1cm4gdHJ1ZQoJfSwKCglfZ3JvdzogZnVuY3Rpb24oY2FuLCBzdHIpIHsKCQlpZiAoY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYuY29kZSIsIGZ1bmN0aW9uKGRpdikgewoJCQljYW4ucGFnZS5Nb2RpZnkoY2FuLCBkaXYsIHtzdHlsZTogeyJtYXgtaGVpZ2h0IjogNDAwfX0pCgkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIGRpdiwgW3t0ZXh0OiBbc3RyXX1dKQoJCQlkaXYuc2Nyb2xsQnkoMCwgMTAwMDApCgkJCXJldHVybiB0cnVlCgkJfSkubGVuZ3RoID09IDApIHsKCQkJY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgc3RyKQoJCX0KCX0sCn0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5Lqk5LqS5pON5L2cIiwgbGlzdDogWwoJCSLlhbHkuqvlt6XlhbciLCAi5Yi35paw5pWw5o2uIiwgIuWIh+aNouWFqOWxjyIsICLmiZPlvIDpk77mjqUiLCAi55Sf5oiQ6ZO+5o6lIiwgIueUn+aIkOWbvueJhyIsICLnlJ/miJDohJrmnKwiLCBbCgkJCSLlhbblroMiLCAi5omp5bGV5Y+C5pWwIiwgIua4heepuuWPguaVsCIsICLlpI3liLbmlbDmja4iLCAi5LiL6L295pWw5o2uIiwgIua4heepuuaVsOaNriIsICLliKDpmaTlt6XlhbciLAoJCV0sCgldLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2csIGxpc3QsIGNiLCB0YXJnZXQpIHt9LAoJX2VuZ2luZTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IGNhbi5VcGRhdGUoZXZlbnQsIFtjdHguQUNUSU9OLCBidXR0b25dLmNvbmNhdChjYW4uSW5wdXQoW10sIHRydWUpKSkgfSwKCgki5omp5bGV5Y+C5pWwIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX2FjdGlvbikKCX0sCgki5YWx5Lqr5bel5YW3IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbWV0YSA9IGNhbi5Db25mKCkKCQljYW4ub25tb3Rpb24uc2hhcmUoZXZlbnQsIGNhbiwgW3tuYW1lOiBjaGF0LlRJVExFLCB2YWx1ZTogbWV0YS5uYW1lfSwge25hbWU6IGNoYXQuVE9QSUMsIHZhbHVlczogW2NsaS5XSElURSwgY2xpLkJMQUNLXX1dLCBbCgkJCW1kYi5OQU1FLCBtZXRhLmluZGV4LCBtZGIuVEVYVCwgSlNPTi5zdHJpbmdpZnkoY2FuLklucHV0KFtdLCB0cnVlKSksCgkJXSkKCX0sCgki5YiH5o2i5YWo5bGPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgc3ViID0gY2FuLl9vdXRwdXRzW2Nhbi5fb3V0cHV0cy5sZW5ndGgtMV0KCQlpZiAoY2FuLnBhZ2UuQ2xhc3NMaXN0Lm5lZyhjYW4sIGNhbi5fdGFyZ2V0LCAiRnVsbCIpKSB7CgkJCXN1Yi5faGVpZ2h0X2JhayA9IHN1Yi5Db25mSGVpZ2h0KCksIHN1Yi5fd2lkdGhfYmFrID0gc3ViLkNvbmZXaWR0aCgpCgkJCXZhciBoZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQtKGNhbi5fc3RhdHVzLmlubmVyVGV4dD8gMjogMSkqaHRtbC5BQ1RJT05fSEVJR0hUCgkJCWNhbi51c2VyLmlzTW9iaWxlICYmIChoZWlnaHQgLT0gMipodG1sLkFDVElPTl9IRUlHSFQpCgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgY2FuLl9vdXRwdXQsICJoZWlnaHQiLCBzdWIuQ29uZkhlaWdodChoZWlnaHQpLCAibWluLXdpZHRoIiwgc3ViLkNvbmZXaWR0aCh3aW5kb3cuaW5uZXJXaWR0aCkpCgkJCWNhbi5jb3JlLkNhbGxGdW5jKFtzdWIsICJvbmltcG9ydC5sYXlvdXQiXSwge2Nhbjogc3VifSkKCQl9IGVsc2UgewoJCQlzdWIuQ29uZkhlaWdodChzdWIuX2hlaWdodF9iYWspLCBzdWIuQ29uZldpZHRoKHN1Yi5fd2lkdGhfYmFrKQoJCQljYW4uY29yZS5DYWxsRnVuYyhbc3ViLCAib25pbXBvcnQubGF5b3V0Il0sIHtjYW46IHN1Yn0pCgkJCWNhbi5wYWdlLnN0eWxlKGNhbiwgY2FuLl9vdXRwdXQsICJoZWlnaHQiLCAiIiwgIm1pbi13aWR0aCIsICIiKQoJCX0KCX0sCgki5omT5byA6ZO+5o6lIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyB2YXIgbWV0YSA9IGNhbi5Db25mKCkKCQl2YXIgcHJlID0gIi9jaGF0L2NtZC8iOyBpZiAoY2FuLnVzZXIubW9kLmlzUG9kKSB7IHByZSA9ICIvY2hhdC9wb2QvIitjYW4ubWlzYy5TZWFyY2goY2FuLCBpY2UuUE9EKSsiL2NtZC8iIH0KCQl2YXIgYXJncyA9IGNhbi5PcHRpb24oKTsgYXJncy5fcGF0aCA9IHByZSsobWV0YS5pbmRleHx8Y2FuLmNvcmUuS2V5cyhtZXRhLmN0eCwgbWV0YS5jbWQpKQoJCWFyZ3MuX3BhdGguaW5kZXhPZigiL2NtZC93ZWIud2lraS53b3JkIikgPiAtMSAmJiAoYXJncyA9IHtfcGF0aDogcHJlK2FyZ3MucGF0aH0pCgoJCWNhbi51c2VyLmlzV2VpWGluPyBjYW4udXNlci5qdW1wcyhjYW4ubWlzYy5NZXJnZVVSTChjYW4sIGFyZ3MpKTogY2FuLnVzZXIub3BlbihjYW4ubWlzYy5NZXJnZVVSTChjYW4sIGFyZ3MpKQoJfSwKCSLnlJ/miJDpk77mjqUiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKQoJCXZhciBwcmUgPSAiL2NoYXQvY21kLyI7IGlmIChjYW4udXNlci5tb2QuaXNQb2QpIHsgcHJlID0gIi9jaGF0L3BvZC8iK2Nhbi5taXNjLlNlYXJjaChjYW4sIGljZS5QT0QpKyIvY21kLyIgfQoJCXZhciBhcmdzID0gY2FuLk9wdGlvbigpOyBhcmdzLl9wYXRoID0gcHJlKyhtZXRhLmluZGV4fHxjYW4uY29yZS5LZXlzKG1ldGEuY3R4LCBtZXRhLmNtZCkpCgkJYXJncy5fcGF0aC5pbmRleE9mKCIvY21kL3dlYi53aWtpLndvcmQiKSA+IC0xICYmIChhcmdzID0ge19wYXRoOiBwcmUrYXJncy5wYXRofSkKCQl2YXIgdXJsID0gY2FuLm1pc2MuTWVyZ2VVUkwoY2FuLCBhcmdzKQoJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgdXJsKQoJCWNhbi5vbm1vdGlvbi5zaGFyZShldmVudCwgY2FuLCBbXSwgW21kYi5MSU5LLCB1cmxdKQoJfSwKCSLnlJ/miJDlm77niYciOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2ltYWdlKGV2ZW50LCBjYW4sIGNhbi5fbmFtZSkgfSwKCS8vICLnlJ/miJDlm77niYciOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkvLyAgICAgY2FuLnVzZXIudG9QTkcoY2FuLCAiaGkucG5nIiwgY2FuLl90YXJnZXQub3V0ZXJIVE1MLCBjYW4uQ29uZihodG1sLkhFSUdIVCksIGNhbi5Db25mKGh0bWwuV0lEVEgpKQoJLy8gfSwKCgki55Sf5oiQ6ISa5pysIjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7IHZhciBjb25mID0gY2FuLkNvbmYoKQoJCXZhciBhcmdzID0gY2FuLklucHV0KCIiLCB0cnVlKS5qb2luKGljZS5TUCk7IHZhciBsaXN0ID0gWwoJCQkiZXhwb3J0IGN0eF9kZXY9Iitsb2NhdGlvbi5vcmlnaW4rIjsgY3R4X3RlbXA9JChta3RlbXApOyBjdXJsIC1mc1NMICRjdHhfZGV2IC1vICRjdHhfdGVtcDsiKyIgc291cmNlICRjdHhfdGVtcCAiKyhjb25mLmluZGV4fHwiIikraWNlLlNQK2FyZ3MsCgkJCSJpc2hfc3lzX2Rldl9ydW5fY29tbWFuZCAiK2FyZ3MsICJpc2hfc3lzX2Rldl9ydW5fYWN0aW9uIiwgImlzaF9zeXNfZGV2X3J1bl9zb3VyY2UiLAoJCV0KCQl2YXIgdWkgPSBjYW4udXNlci50b2FzdChjYW4sIHt0aXRsZTogYnV0dG9uLCBkdXJhdGlvbjogLTEsIHdpZHRoOiAtMzAwLAoJCQljb250ZW50OiAnPGRpdiBjbGFzcz0ic3RvcnkiIGRhdGEtdHlwZT0ic3BhcmsiLCBkYXRhLW5hbWU9InNoZWxsIj4nKwoJCQknPGxhYmVsPiQgPC9sYWJlbD4nKyc8c3Bhbj4nK2xpc3Quam9pbigiPC9zcGFuPjxici8+PGxhYmVsPiQgPC9sYWJlbD48c3Bhbj4iKSsnPC9zcGFuPicrJzwvZGl2PicsCgkJCWFjdGlvbjogW2NsaS5DTE9TRV0sCgkJfSkKCQljYW4ub25tb3Rpb24uc3RvcnkuYXV0byhjYW4sIHVpLl90YXJnZXQpCgkJY2FuLnVzZXIuY29weShldmVudCwgY2FuLCBsaXN0WzBdKQoJfSwKCSLliLfmlrDmlbDmja4iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5VcGRhdGUoe30sIGNhbi5JbnB1dChbXSwgdHJ1ZSkpIH0sCgki5omT5YyF6aG16Z2iIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25lbmdpbmUuc2lnbmFsKGNhbiwgIm9ud2VicGFjayIsIGNhbi5yZXF1ZXN0KGV2ZW50KSkgfSwKCSLliLfmlrDpobXpnaIiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJdmFyIHN1YiA9IGNhbi5jb3JlLlZhbHVlKGNhbi5fb3V0cHV0cywgIi0xIiksIG1zZyA9IHN1Yi5fbXNnCgkJY2FuLmNvcmUuQ2FsbEZ1bmMoW3N1YiwgY2hhdC5PTklNUE9SVCwgIl9pbml0Il0sIHtjYW46IHN1YiwgbXNnOiBtc2csIGxpc3Q6IG1zZy5yZXN1bHR8fG1zZy5hcHBlbmR8fFtdLCBjYjogZnVuY3Rpb24obXNnKSB7CgkJfSwgdGFyZ2V0OiBjYW4uX291dHB1dH0pCgl9LAoJIuS/neWtmOWPguaVsCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnNlYXJjaChldmVudCwgWyJSaXZlci5vbmRldGFpbC7kv53lrZjlj4LmlbAiXSkgfSwKCgki5riF56m65Y+C5pWwIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5wYWdlLlNlbGVjdEFyZ3MoY2FuLCBjYW4uX29wdGlvbiwgIiIsIGZ1bmN0aW9uKGl0ZW0pIHsgcmV0dXJuIGl0ZW0udmFsdWUgPSAiIiB9KQoJfSwKCSLlpI3liLbmlbDmja4iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKSwgbXNnID0gY2FuLl9tc2cKCQl2YXIgcmVzID0gW21zZy5hcHBlbmQgJiYgbXNnLmFwcGVuZC5qb2luKCIsIildOyBtc2cuVGFibGUoZnVuY3Rpb24obGluZSwgaW5kZXgsIGFycmF5KSB7CgkJCXJlcy5wdXNoKGNhbi5jb3JlLkl0ZW0obGluZSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4gdmFsdWUgfSkuam9pbigiLCIpKQoJCX0pCgoJCXJlcy5sZW5ndGggPiAxICYmIGNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgcmVzLmpvaW4oaWNlLlNQKSkKCQltc2cucmVzdWx0ICYmIGNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgbXNnLlJlc3VsdCgpKQoJfSwKCSLkuIvovb3mlbDmja4iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IHZhciBtZXRhID0gY2FuLkNvbmYoKSwgbXNnID0gY2FuLl9tc2cKCQl2YXIgcmVzID0gW21zZy5hcHBlbmQgJiYgbXNnLmFwcGVuZC5qb2luKCIsIildOyBtc2cuVGFibGUoZnVuY3Rpb24obGluZSwgaW5kZXgsIGFycmF5KSB7CgkJCXJlcy5wdXNoKGNhbi5jb3JlLkl0ZW0obGluZSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkgeyByZXR1cm4gdmFsdWUgfSkuam9pbigiLCIpKQoJCX0pCgoJCXJlcy5sZW5ndGggPiAxICYmIGNhbi51c2VyLmRvd25sb2FkcyhjYW4sIHJlcy5qb2luKCJcbiIpLCBtZXRhLm5hbWUrIi5jc3YiKQoJCW1zZy5yZXN1bHQgJiYgY2FuLnVzZXIuZG93bmxvYWRzKGNhbiwgbXNnLlJlc3VsdCgpLCBtZXRhLm5hbWUrIi50eHQiKQoJfSwKCSLmuIXnqbrmlbDmja4iOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5fb3V0cHV0KSB9LAoJIuWIoOmZpOW3peWFtyI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLl90YXJnZXQpIH0sCgki5pGE5YOP5aS0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBjb25zdHJhaW50cyA9IHthdWRpbzogZmFsc2UsIHZpZGVvOiB7d2lkdGg6IDIwMCwgaGVpZ2h0OiAyMDB9fQoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBbe3ZpZXc6IGN0eC5BQ1RJT059LCB7dmlldzogImNhcHR1cmUiLCBsaXN0OiBbe3R5cGU6ICJ2aWRlbyIsIF9pbml0OiBmdW5jdGlvbihpdGVtKSB7CgkJCW5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgewoJCQkJaXRlbS5zcmNPYmplY3QgPSBzdHJlYW0sIGl0ZW0ub25sb2FkZWRtZXRhZGF0YSA9IGZ1bmN0aW9uKGUpIHsKCQkJCQlpdGVtLnBsYXkoKQoJCQkJfSwgdWkuc3RyZWFtID0gc3RyZWFtCgkJCX0pLmNhdGNoKGZ1bmN0aW9uKGVycikgeyBjb25zb2xlLmxvZyhlcnIubmFtZSArICI6ICIgKyBlcnIubWVzc2FnZSk7IH0pCgkJfX1dfV0pCgoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgWyLlhbPpl60iLCAi5oqT5ouNIl0sIHVpLmFjdGlvbiwgewoJCQki5oqT5ouNIjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCXZhciBjYW52YXMgPSBjYW4ucGFnZS5BcHBlbmQoY2FuLCB1aS5jYXB0dXJlLCBbe3R5cGU6ICJjYW52YXMiLCB3aWR0aDogdWkudmlkZW8ub2Zmc2V0V2lkdGgsIGhlaWdodDogdWkudmlkZW8ub2Zmc2V0SGVpZ2h0fV0pLmZpcnN0CgkJCQljYW52YXMuZ2V0Q29udGV4dCgiMmQiKS5kcmF3SW1hZ2UodWkudmlkZW8sIDAsIDApCgkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB1aS5jYXB0dXJlLCBbe2ltZzogY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyksIHN0eWxlOiB7d2lkdGg6IHVpLnZpZGVvLm9mZnNldFdpZHRoLCBoZWlnaHQ6IHVpLnZpZGVvLm9mZnNldEhlaWdodH19XSkKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbnZhcykKCQkJfSwKCQkJIuWFs+mXrSI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQljYW4uY29yZS5MaXN0KHVpLnN0cmVhbS5nZXRUcmFja3MoKSwgZnVuY3Rpb24odHJhY2spIHsgdHJhY2suc3RvcCgpIH0pCgkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS5hY3Rpb24pCgkJCQljYW4ucGFnZS5SZW1vdmUoY2FuLCB1aS52aWRlbykKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLmNhcHR1cmUpCgkJCX0sCgkJfSkKCX0sCgoJYWN0aW9uczogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLl9hY3Rpb24pIH0sCgljbGVhcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgbmFtZSkgeyBjYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uX291dHB1dCkgfSwKCWNsb3NlOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5wYWdlLlJlbW92ZShjYW4sIGNhbi5fdGFyZ2V0KSB9LAoJdXBsb2FkOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi51c2VyLnVwbG9hZChldmVudCwgY2FuKSB9LAoJY2hhbmdlOiBmdW5jdGlvbihldmVudCwgY2FuLCBuYW1lLCB2YWx1ZSwgY2IpIHsKCQlyZXR1cm4gY2FuLnBhZ2UuU2VsZWN0QXJncyhjYW4sIGNhbi5fb3B0aW9uLCAiIiwgZnVuY3Rpb24oaW5wdXQpIHsKCQkJaWYgKGlucHV0Lm5hbWUgPT0gbmFtZSAmJiB2YWx1ZSAhPSBpbnB1dC52YWx1ZSkgeyBpbnB1dC52YWx1ZSA9IHZhbHVlCgkJCQl2YXIgZGF0YSA9IGlucHV0LmRhdGFzZXR8fHt9OyBjYW4uVXBkYXRlKGV2ZW50LCBjYW4uSW5wdXQoKSwgY2IpCgkJCQlyZXR1cm4gaW5wdXQKCQkJfQoJCX0pCgl9LAoKCW5leHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4uVXBkYXRlKGV2ZW50LCBbY3R4LkFDVElPTiwgIm5leHQiLCBjYW4uU3RhdHVzKCJ0b3RhbCIpfHwwLCBjYW4uT3B0aW9uKCJsaW1pdCIpfHxjYW4uQWN0aW9uKCJsaW1pdCIpfHwiIiwgY2FuLk9wdGlvbigib2ZmZW5kIil8fGNhbi5BY3Rpb24oIm9mZmVuZCIpfHwiIl0pCgl9LAoJcHJldjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5VcGRhdGUoZXZlbnQsIFtjdHguQUNUSU9OLCAicHJldiIsIGNhbi5TdGF0dXMoInRvdGFsIil8fDAsIGNhbi5PcHRpb24oImxpbWl0Iil8fGNhbi5BY3Rpb24oImxpbWl0Iil8fCIiLCBjYW4uT3B0aW9uKCJvZmZlbmQiKXx8Y2FuLkFjdGlvbigib2ZmZW5kIil8fCIiXSkKCX0sCgoJZ2V0Q2xpcGJvYXJkRGF0YTogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJZnVuY3Rpb24gYWRkKHRleHQpIHsKCQkJY2FuLnJ1bihldmVudCwgY2FuLmJhc2UuU2ltcGxlKGN0eC5BQ1RJT04sIGJ1dHRvbiwgY2FuLmJhc2UuUGFyc2VKU09OKHRleHQpKSwgZnVuY3Rpb24obXNnKSB7CgkJCQljYW4udXNlci50b2FzdFN1Y2Nlc3MoY2FuKSwgY2FuLlVwZGF0ZSgpCgkJCX0sIHRydWUpCgkJfQoJCWlmIChuYXZpZ2F0b3IuY2xpcGJvYXJkKSB7CgkJCW5hdmlnYXRvci5jbGlwYm9hcmQucmVhZFRleHQoKS50aGVuKGFkZCkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7IGNhbi5taXNjLkxvZyhlcnIpIH0pCgkJfSBlbHNlIHsKCQkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW3t0eXBlOiBodG1sLlRFWFRBUkVBLCBuYW1lOiBtZGIuVEVYVH1dLCBmdW5jdGlvbihldiwgYnV0dG9uLCBkYXRhLCBsaXN0LCBhcmdzKSB7IGFkZChsaXN0WzBdKSB9KQoJCX0KCX0sCglnZXRMb2NhdGlvbjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgYnV0dG9uKSB7CgkJY2FuLnVzZXIuYWdlbnQuZ2V0TG9jYXRpb24oZnVuY3Rpb24oZGF0YSkgeyBjYW4ucmVxdWVzdChldmVudCwgZGF0YSkKCQkJY2FuLnVzZXIuaW5wdXQoZXZlbnQsIGNhbiwgW21kYi5UWVBFLCBtZGIuTkFNRSwgbWRiLlRFWFQsICJsYXRpdHVkZSIsICJsb25naXR1ZGUiXSwgZnVuY3Rpb24oZXYsIGJ1LCBkYXRhLCBsaXN0LCBhcmdzKSB7CgkJCQljYW4ucnVuKGV2ZW50LCBbY3R4LkFDVElPTiwgYnV0dG9uXS5jb25jYXQoY2FuLmJhc2UuU2ltcGxlKGFyZ3MsIGRhdGEpKSwgZnVuY3Rpb24obXNnKSB7CgkJCQkJY2FuLnVzZXIudG9hc3RTdWNjZXNzKGNhbiksIGNhbi5VcGRhdGUoKQoJCQkJfSwgdHJ1ZSkKCQkJfSkKCQl9KQoJfSwKCW9wZW5Mb2NhdGlvbjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4udXNlci5hZ2VudC5vcGVuTG9jYXRpb24oY2FuLnJlcXVlc3QoZXZlbnQpKSB9LAoKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXX0pCgo=",
        "/plugin/story/form.css": "ZGl2Lm91dHB1dC5mb3JtIGRpdi5pdGVtIHsKCXBhZGRpbmc6NDBweDsKfQo=",
        "/plugin/story/form.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgImZvcm0iKQoJCW1zZy5QdXNoKCJ0eXBlIiwgInRleHQiKQoJCW1zZy5QdXNoKCJuYW1lIiwgIm5hbWUiKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICJoYXJ2ZXlzaGFvIikKCQltc2cuUHVzaCgiYWN0aW9uIiwgImtleSIpCgoJCW1zZy5QdXNoKCJ0eXBlIiwgInRleHQiKQoJCW1zZy5QdXNoKCJuYW1lIiwgImFnZSIpCgkJbXNnLlB1c2goInZhbHVlIiwgIjE4IikKCQltc2cuUHVzaCgiYWN0aW9uIiwgIiIpCgoJCW1zZy5QdXNoKCJ0eXBlIiwgInNlbGVjdCIpCgkJbXNnLlB1c2goIm5hbWUiLCAibWFsZSIpCgkJbXNnLlB1c2goInZhbHVlIiwgIm1hbGUsZmVtYWxlIikKCQltc2cuUHVzaCgiYWN0aW9uIiwgIiIpCgoJCW1zZy5QdXNoKCJ0eXBlIiwgInRleHRhcmVhIikKCQltc2cuUHVzaCgibmFtZSIsICJpbnRybyIpCgkJbXNnLlB1c2goInZhbHVlIiwgInByb2dyYW0iKQoJCW1zZy5QdXNoKCJhY3Rpb24iLCAiIikKCgkJbXNnLlB1c2goInR5cGUiLCAiYnV0dG9uIikKCQltc2cuUHVzaCgibmFtZSIsICJzdWJtaXQiKQoJCW1zZy5QdXNoKCJ2YWx1ZSIsICLmj5DkuqQiKQoJCW1zZy5QdXNoKCJhY3Rpb24iLCAiIikKCgkJdmFyIGFjdGlvbiA9ICIiOyBtc2cuVGFibGUoZnVuY3Rpb24odmFsdWUsIGluZGV4LCBhcnJheSkgewoJCQlzd2l0Y2ggKHZhbHVlLnR5cGUpIHsKCQkJCWNhc2UgaHRtbC5CVVRUT046IGFjdGlvbiA9IGFjdGlvbnx8dmFsdWUubmFtZQoJCQkJCWNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiAiaXRlbSIsIGxpc3Q6IFsKCQkJCQkJe3ZpZXc6IFsiaW5wdXQiXSwgbGlzdDogW3t0eXBlOiBodG1sLklOUFVULCBzdHlsZToge3dpZHRoOiAoY2FuLkNvbmZXaWR0aCgpLTkwKS8yfSwgZGF0YToge3R5cGU6IHZhbHVlLnR5cGUsIHZhbHVlOiB2YWx1ZS52YWx1ZX0sIG9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQkJCQl2YXIgYXJncyA9IFtjdHguQUNUSU9OLCBhY3Rpb25dCgkJCQkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCB0YXJnZXQsICIuYXJncyIsIGZ1bmN0aW9uKGl0ZW0pIHsgYXJncy5wdXNoKGl0ZW0ubmFtZSwgaXRlbS52YWx1ZSl9KQoJCQkJCQkJY2FuLnJ1bihldmVudCwgYXJncykKCQkJCQkJfX1dfSwKCQkJCQldfV0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgaHRtbC5TRUxFQ1Q6CgkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3ZpZXc6ICJpdGVtIiwgbGlzdDogWwoJCQkJCQl7dmlldzogWyJsYWJlbCJdLCBsaXN0OiBbe3RleHQ6IHZhbHVlLm5hbWV9XX0sCgkJCQkJCXt2aWV3OiBbImlucHV0Il0sIGxpc3Q6IFt7dHlwZTogaHRtbC5TRUxFQ1QsIGNsYXNzTmFtZTogImFyZ3MiLCBzdHlsZToge3dpZHRoOiBjYW4uQ29uZldpZHRoKCktMTAwfSwKCQkJCQkJCWRhdGE6IHZhbHVlLCBsaXN0OiBjYW4uY29yZS5MaXN0KGNhbi5jb3JlLlNwbGl0KHZhbHVlLnZhbHVlKSwgZnVuY3Rpb24odikgeyByZXR1cm4ge3R5cGU6IGh0bWwuT1BUSU9OLCBuYW1lOiB2LCB2YWx1ZTogdiwgaW5uZXI6IHZ9IH0pIH1dfSwKCQkJCQldfV0pCgkJCQkJYnJlYWsKCQkJCWNhc2UgaHRtbC5URVhUQVJFQToKCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogIml0ZW0iLCBsaXN0OiBbCgkJCQkJCXt2aWV3OiBbImxhYmVsIl0sIGxpc3Q6IFt7dGV4dDogdmFsdWUubmFtZX1dfSwKCQkJCQkJe3ZpZXc6IFsiaW5wdXQiXSwgbGlzdDogW3t0eXBlOiBodG1sLlRFWFRBUkVBLCBjbGFzc05hbWU6ICJhcmdzIiwgc3R5bGU6IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpLTEwMH0sIGRhdGE6IHZhbHVlfV19LAoJCQkJCV19XSkKCQkJCQlicmVhawoJCQkJZGVmYXVsdDoKCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dmlldzogIml0ZW0iLCBsaXN0OiBbCgkJCQkJCXt2aWV3OiBbImxhYmVsIl0sIGxpc3Q6IFt7dGV4dDogdmFsdWUubmFtZX1dfSwKCQkJCQkJe3ZpZXc6IFsiaW5wdXQiXSwgbGlzdDogW3t0eXBlOiAiaW5wdXQiLCBjbGFzc05hbWU6ICJhcmdzIiwgc3R5bGU6IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpLTEwMH0sIGRhdGE6IHZhbHVlfV19LAoJCQkJCV19XSkKCQkJfQoJCX0pCgl9LAp9LCBbIiJdKQoKCg==",
        "/plugin/story/json.css": "ZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IzAwMDA7IH0KZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbSBkaXYuaXRlbSB7IHBhZGRpbmctbGVmdDoxNXB4OyBib3JkZXI6c29saWQgMXB4ICMwMDAwMDAwZDsgYm9yZGVyLWxlZnQ6ZGFzaGVkIDFweCBsaWdodGJsdWU7IG1hcmdpbi1sZWZ0OjVweDsgfQpmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIGRpdi5pdGVtOmhvdmVyIHsgYm9yZGVyOnNvbGlkIDFweCByZWQ7IH0KZmllbGRzZXQucGx1Z2luIGRpdi5vdXRwdXQuanNvbiBkaXYuaXRlbSBzcGFuLm5vbmNlIHsgY29sb3I6IzljYmVjYTRmOyBjdXJzb3I6cG9pbnRlcjsgfQpmaWVsZHNldC5wbHVnaW4gZGl2Lm91dHB1dC5qc29uIGRpdi5pdGVtIHNwYW4ua2V5IHsgY29sb3I6eWVsbG93OyB9CmZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5zdHJpbmcgeyBjb2xvcjptYWdlbnRhOyB9CmZpZWxkc2V0LnBsdWdpbiBkaXYub3V0cHV0Lmpzb24gZGl2Lml0ZW0gc3Bhbi5jb25zdCB7IGNvbG9yOmN5YW47IH0KCg==",
        "/plugin/story/json.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRhcmdldCwgImpzb24iKQoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIHRhcmdldCksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIG1zZyksIGNhbi5vbmltcG9ydC5zaG93KGNhbiwgY2FuLmJhc2UuT2JqKG1zZy5SZXN1bHQoKSwge30pLCB0YXJnZXQpCgl9LAoJc2hvdzogZnVuY3Rpb24oY2FuLCBkYXRhLCB0YXJnZXQpIHsKCQlmdW5jdGlvbiBzaG93KGRhdGEsIHRhcmdldCwgaW5kZXgsIHRvdGFsKSB7IHZhciBsaXN0CgkJCXN3aXRjaCAodHlwZW9mIGRhdGEpIHsKCQkJCWNhc2UgbGFuZy5PQkpFQ1Q6CgkJCQkJaWYgKGRhdGEgPT0gbnVsbCkgewoJCQkJCQlsaXN0ID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6ICJudWxsIn1dKS5pdGVtCgkJCQkJCWJyZWFrCgkJCQkJfQoJCQkJCWZ1bmN0aW9uIHdyYXAoYmVnaW4sIGVuZCwgYWRkLCBjYikgewoJCQkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB0YXJnZXQsIFt7dGV4dDogYmVnaW59XSkKCQkJCQkJYWRkICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBbIi4uLiIsIGh0bWwuU1BBTiwgIm5vbmNlIl19XSksIGNiKCkKCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IGVuZH1dKQoJCQkJCX0KCQkJCQlmdW5jdGlvbiB0b2dnbGUobGlzdCkgeyBsaXN0ICYmIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBsaXN0KSB9CgkJCQkJZnVuY3Rpb24gX2l0ZW0oKSB7CgkJCQkJCWxpc3QgPSBsaXN0IHx8IGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBodG1sLkxJU1R9XSkubGlzdAoJCQkJCQlyZXR1cm4gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgbGlzdCwgW3t2aWV3OiBodG1sLklURU19XSkuaXRlbQoJCQkJCX0KCgkJCQkJaWYgKGNhbi5iYXNlLmlzQXJyYXkoZGF0YSkpIHsgLy8g5pWw57uECgkJCQkJCXdyYXAoIlsiLCAiXSIsIGRhdGEubGVuZ3RoID4gMCwgZnVuY3Rpb24oKSB7IGNhbi5jb3JlLkxpc3QoZGF0YSwgZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7IHZhciBpdGVtID0gX2l0ZW0oKQoJCQkJCQkJc2hvdyh2YWx1ZSwgaXRlbSwgaW5kZXgsIGRhdGEubGVuZ3RoKQoJCQkJCQl9KSB9KQoJCQkJCX0gZWxzZSB7IC8vIOWvueixoQoJCQkJCQl2YXIgbGVuZ3RoID0gY2FuLmNvcmUuSXRlbShkYXRhKS5sZW5ndGgsIGNvdW50ID0gMAoJCQkJCQl3cmFwKCJ7IiwgIn0iLCBsZW5ndGggPiAwLCBmdW5jdGlvbigpIHsgY2FuLmNvcmUuSXRlbShkYXRhLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7IHZhciBpdGVtID0gX2l0ZW0oKQoJCQkJCQkJY2FuLnBhZ2UuQXBwZW5kKGNhbiwgaXRlbSwgW3t0ZXh0OiBbJyInK2tleSsnIicsIGh0bWwuU1BBTiwgImtleSJdLCBvbmNsaWNrOiBmdW5jdGlvbihldmVudCkgeyB0b2dnbGUoc3ViKSB9fSwge3RleHQ6ICc6ICd9XSkKCQkJCQkJCXZhciBzdWIgPSBzaG93KHZhbHVlLCBpdGVtLCBjb3VudCsrLCBsZW5ndGgpCgkJCQkJCX0pIH0pCgkJCQkJfQoJCQkJCWJyZWFrCgkJCQljYXNlIGxhbmcuU1RSSU5HOiAvKiDlrZfkuLIgKi8gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdGFyZ2V0LCBbe3RleHQ6IFsnIicrZGF0YSsnIicsIGh0bWwuU1BBTiwgbGFuZy5TVFJJTkddfV0pOyBicmVhawoJCQkJZGVmYXVsdDogLyog5YW25a6DICovIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBbJycrZGF0YSsnJywgaHRtbC5TUEFOLCAiY29uc3QiXX1dKQoJCQl9CgkJCShpbmRleCA8IHRvdGFsLTEpICYmIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t0ZXh0OiBpY2UuRlN9XSkKCQkJcmV0dXJuIGxpc3QKCQl9OyBzaG93KGRhdGEsIGNhbi5wYWdlLkFwcGVuZChjYW4sIHRhcmdldCwgW3t2aWV3OiBodG1sLklURU19XSkuaXRlbSwgMCwgMCkKCX0sCn0sIFsiIl0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi57uE5Lu26I+c5Y2VIiwgbGlzdDogWyLlsZXlvIAiLCAi5oqY5Y+gIiwgIuWkjeWItiJdLAoJIuWxleW8gCI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgImRpdi5saXN0IGRpdi5saXN0IiwgZnVuY3Rpb24obGlzdCkgewoJCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgbGlzdCwgdHJ1ZSkKCQl9KQoJfSwKCSLmipjlj6AiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7CgkJY2FuLnBhZ2UuU2VsZWN0KGNhbiwgY2FuLl9vdXRwdXQsICJkaXYubGlzdCBkaXYubGlzdCIsIGZ1bmN0aW9uKGxpc3QpIHsKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGxpc3QpCgkJfSkKCX0sCgki5aSN5Yi2IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi51c2VyLmNvcHkoZXZlbnQsIGNhbiwgY2FuLl9tc2cuUmVzdWx0KCkpCgl9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCg==",
        "/plugin/story/media.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYiwgdGFyZ2V0KSB7CgljYW4uYmFzZS5pc0Z1bmMoY2IpICYmIGNiKG1zZykKfX0pClZvbGNhbm9zKCJvbmFjdGlvbiIsIHtoZWxwOiAi5pON5L2c5pWw5o2uIiwgbGlzdDogWyLmiZPlvIDlsY/luZUiLCAi5omT5byA5pGE5YOPIiwgIuaJk+W8gOW9lemfsyJdLAoJX2FjdGlvbjogZnVuY3Rpb24oY2FuLCBjYikgewoJCXZhciB1aSA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIGNhbi5fb3V0cHV0LCBbe3ZpZXc6IGh0bWwuQUNUSU9OfSwge3ZpZXc6IGh0bWwuT1VUUFVULCBsaXN0OiBbe3R5cGU6IGh0bWwuVklERU8sIHN0eWxlOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKX0sIF9pbml0OiBmdW5jdGlvbihpdGVtKSB7CgkJCWNhbi5jb3JlLlRpbWVyKDEwLCBmdW5jdGlvbigpIHsgY2IoaXRlbSwgdWkpIH0pCgkJfX1dfV0pCgoJCWNhbi5vbmFwcGVuZC5fYWN0aW9uKGNhbiwgW10sIHVpLmFjdGlvbiwgewoJCQki5YWz6ZetIjogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCWNhbi5jb3JlLkxpc3QodWkuc3RyZWFtLmdldFRyYWNrcygpLCBmdW5jdGlvbih0cmFjaykgeyB0cmFjay5zdG9wKCkgfSkKCQkJCWNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLmFjdGlvbiksIGNhbi5wYWdlLlJlbW92ZShjYW4sIHVpLm91dHB1dCkKCQkJfSwKCQkJIuaKk+aLjSI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQl2YXIgY2FudmFzID0gY2FuLnBhZ2UuQXBwZW5kKGNhbiwgdWkub3V0cHV0LCBbe3R5cGU6IGh0bWwuQ0FOVkFTfV0pLmZpcnN0OyBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKS5kcmF3SW1hZ2UodWkudmlkZW8sIDAsIDApCgkJCQljYW4ucGFnZS5BcHBlbmQoY2FuLCB1aS5vdXRwdXQsIFt7aW1nOiBjYW52YXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKSwgc3R5bGU6IHt3aWR0aDogY2FuLkNvbmZXaWR0aCgpfX1dKQoJCQkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FudmFzKQoJCQl9LAoJCQki5b2V5Yi2IjogZnVuY3Rpb24oZXZlbnQpIHsgdWkuYmxvYnMgPSBbXQoJCQkJdWkubWVkaWFSZWNvcmRlciA9IG5ldyBNZWRpYVJlY29yZGVyKHVpLnN0cmVhbSwge21pbWVUeXBlOiAndmlkZW8vd2VibSd9KQoJCQkJdWkubWVkaWFSZWNvcmRlci5vbmRhdGFhdmFpbGFibGUgPSAoZSkgPT4geyB1aS5ibG9icy5wdXNoKGUuZGF0YSksIGNhbi5taXNjLkxvZyh1aS5ibG9icy5sZW5ndGgpIH0KCQkJCXVpLm1lZGlhUmVjb3JkZXIuc3RhcnQoMTAwKQoJCQl9LAoJCQki5Zue5pS+IjogZnVuY3Rpb24oZXZlbnQpIHsgdmFyIGJsb2JzID0gdWkuYmxvYnM7IHVpLmJsb2JzID0gW10KCQkJCXZhciB2aWRlbyA9IGNhbi5wYWdlLkFwcGVuZChjYW4sIHVpLm91dHB1dCwgW3t0eXBlOiBodG1sLlZJREVPLCBzdHlsZToge3dpZHRoOiBjYW4uQ29uZldpZHRoKCl9fV0pLnZpZGVvCgkJCQl2aWRlby5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKGJsb2JzLCB7dHlwZSA6ICd2aWRlby93ZWJtJ30pKSwgdmlkZW8ucGxheSgpCgkJCX0sCgkJCSLkuIvovb0iOiBmdW5jdGlvbihldmVudCkgewoJCQkJY2FuLnVzZXIuZG93bmxvYWQoY2FuLCBVUkwuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKHVpLmJsb2JzLCB7dHlwZTogJ3ZpZGVvL3dlYm0nfSkpLCAncmVjb3JkLndlYm0nKQoJCQl9LAoJCX0pCgl9LAoJIuaJk+W8gOWxj+W5lSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25hY3Rpb24uX2FjdGlvbihjYW4sIGZ1bmN0aW9uKGl0ZW0sIHVpKSB7CgkJCW5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0RGlzcGxheU1lZGlhKHt2aWRlbzoge3dpZHRoOiBjYW4uQ29uZldpZHRoKCl9fSkudGhlbihmdW5jdGlvbihzdHJlYW0pIHsgdWkuc3RyZWFtID0gc3RyZWFtCgkJCQlpdGVtLnNyY09iamVjdCA9IHN0cmVhbSwgaXRlbS5vbmxvYWRlZG1ldGFkYXRhID0gZnVuY3Rpb24oZSkgeyBpdGVtLnBsYXkoKSB9CgkJCX0pLmNhdGNoKGZ1bmN0aW9uKGVycikgeyBjYW4ubWlzYy5Mb2coZXJyLm5hbWUgKyAiOiAiICsgZXJyLm1lc3NhZ2UpIH0pCgkJfSkKCX0sCgki5omT5byA5pGE5YOPIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbmFjdGlvbi5fYWN0aW9uKGNhbiwgZnVuY3Rpb24oaXRlbSwgdWkpIHsKCQkJbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoe3ZpZGVvOiB7d2lkdGg6IGNhbi5Db25mV2lkdGgoKX19KS50aGVuKGZ1bmN0aW9uKHN0cmVhbSkgeyB1aS5zdHJlYW0gPSBzdHJlYW0KCQkJCWl0ZW0uc3JjT2JqZWN0ID0gc3RyZWFtLCBpdGVtLm9ubG9hZGVkbWV0YWRhdGEgPSBmdW5jdGlvbihlKSB7IGl0ZW0ucGxheSgpIH0KCQkJfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7IGNhbi5taXNjLkxvZyhlcnIubmFtZSArICI6ICIgKyBlcnIubWVzc2FnZSkgfSkKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZXhwb3J0Iiwge2hlbHA6ICLlr7zlh7rmlbDmja4iLCBsaXN0OiBbXX0pCg==",
        "/plugin/story/pie.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy5qcyIsICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9wYXRoLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQl2YXIgaGVpZ2h0ID0gbXNnLk9wdGlvbihodG1sLkhFSUdIVCl8fGNhbi5Db25mSGVpZ2h0KCkKCQkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKSwgY2FuLm9uaW1wb3J0Ll9zaG93KGNhbiwgbXNnKQoJCQl2YXIgciA9IGhlaWdodC8yLTIwLCBtYXJnaW4gPSAyMDsgY2FuLnN2Zy5WYWwoaHRtbC5XSURUSCwgMioocittYXJnaW4pKSwgY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIDIqKHIrbWFyZ2luKSkKCQkJY2FuLl9hcmdzID0gY2FuLmJhc2UuQ29weSh7ZmllbGQ6ICJ2YWx1ZSJ9LCBjYW4uYmFzZS5QYXJzZVVSTChjYW4uX2Rpc3BsYXkpKQoJCQljYW4ub25pbXBvcnQuX2RyYXcoY2FuLCBtc2csIGNhbi5fYXJncy5maWVsZCwgcittYXJnaW4sIHIrbWFyZ2luLCByLCBtYXJnaW4sIDApCgkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5wcm9qZWN0KSwgY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBudWxsLCBjYW4udWkucHJvamVjdCkKCQkJY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0LCB0cnVlKQoJCQl2YXIgcmVzdCA9IGNhbi5Db25mV2lkdGgoKS1oZWlnaHQKCQkJY2FuLnBhZ2UuTW9kaWZ5KGNhbiwgY2FuLnVpLnByb2plY3QsIHtzdHlsZTogeyJtYXgtd2lkdGgiOiByZXN0fX0pCgkJCWNhbi5wYWdlLlNlbGVjdChjYW4sIGNhbi51aS5wcm9qZWN0LCBodG1sLlRSLCBmdW5jdGlvbih0ciwgaW5kZXgpIHsKCQkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIHRyLCB7b25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCkgewoJCQkJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpLCBjYW4ub25pbXBvcnQuX2RyYXcoY2FuLCBtc2csIGNhbi5fYXJncy5maWVsZCwgcittYXJnaW4sIHIrbWFyZ2luLCByLCBtYXJnaW4sIGluZGV4LTEpCgkJCQl9fSkKCQkJfSkKCQl9KQoJfSwKCV9kcmF3OiBmdW5jdGlvbihjYW4sIG1zZywgZmllbGQsIHgsIHksIHIsIG1hcmdpbiwgd2hpY2gpIHsKCQlmdW5jdGlvbiBwb3MoeCwgeSwgciwgYW5nbGUpIHsgYW5nbGUgLT0gOTAKCQkJcmV0dXJuIFt4ICsgciAqIE1hdGguY29zKGFuZ2xlICogTWF0aC5QSSAvIDE4MCksIHkgKyByICogTWF0aC5zaW4oYW5nbGUgKiBNYXRoLlBJIC8gMTgwKV0KCQl9CgkJZnVuY3Rpb24gcGllKHgsIHksIHIsIGJlZ2luLCBzcGFuLCBjb2xvciwgY2IpIHsgY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiAicGF0aCIsIHN0eWxlOiB7CgkJCSJzdHJva2Utd2lkdGgiOiAxLCBzdHJva2U6IGNvbG9yLCBmaWxsOiBjb2xvciwgZDogY2FuLmJhc2Uuam9pbnMoWwoJCQkJWyJNIiwgeCwgeV0sIFsiTCJdLmNvbmNhdChwb3MoeCwgeSwgciwgYmVnaW4pKSwgWyJBIiwgciwgciwgIjAiLCBzcGFuPjE4MD8gIjEiOiAiMCIsICIxIl0uY29uY2F0KHBvcyh4LCB5LCByLCBiZWdpbitzcGFuKSksIFsiWiJdCgkJCV0sIGljZS5TUCwgaWNlLkZTKSwKCQl9LCBvbm1vdXNlZW50ZXI6IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IoZXZlbnQpCgkJfSB9KSB9CgoJCXZhciB0b3RhbCA9IDA7IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSkgeyB0b3RhbCArPSBwYXJzZUludCh2YWx1ZVtmaWVsZF0pIH0pCgkJdmFyIGNvbG9yID0gW2NsaS5SRUQsIGNsaS5ZRUxMT1csIGNsaS5HUkVFTiwgY2xpLkNZQU4sIGNsaS5CTFVFLCBjbGkuUFVSUExFLCBjbGkuV0hJVEUsIGNsaS5CTEFDS10KCQl2YXIgYmVnaW4gPSAwOyBtc2dbImNvbG9yIl0gPSBbXSwgbXNnWyJ3ZWlnaHQiXSA9IFtdLCBtc2cuVGFibGUoZnVuY3Rpb24odmFsdWUsIGluZGV4KSB7IHZhciBzcGFuID0gcGFyc2VJbnQodmFsdWVbZmllbGRdKS90b3RhbCozNjAKCQkJdmFyIHAgPSBpbmRleD09d2hpY2g/IHBvcyh4LCB5LCBtYXJnaW4sIGJlZ2luK3NwYW4vMik6IFt4LCB5XTsgaW5kZXggPT0gd2hpY2ggJiYgY2FuLlN0YXR1cyh2YWx1ZSkKCQkJdmFyIGMgPSBjb2xvcltpbmRleCVjb2xvci5sZW5ndGhdOyBwaWUocFswXSwgcFsxXSwgciwgYmVnaW4sIHNwYW4sIGMsIGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoaW5kZXggPT0gY2FuLl9sYXN0KSB7IHJldHVybiB9IGNhbi5fbGFzdCA9IGluZGV4CgkJCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCBjYW4uc3ZnKSwgY2FuLnN2Zy5WYWx1ZSgiY291bnQiLCAwKQoJCQkJY2FuLm9uaW1wb3J0Ll9kcmF3KGNhbiwgbXNnLCBmaWVsZCwgeCwgeSwgciwgbWFyZ2luLCBpbmRleCkKCQkJCWNhbi5vbmltcG9ydC5fcHJvZmlsZShjYW4sIGV2ZW50LnRhcmdldCkKCQkJfSksIGJlZ2luICs9IHNwYW4sIG1zZy5QdXNoKCJjb2xvciIsICc8c3BhbiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjonK2MrJyI+ICAgICA8L3NwYW4+JykKCQkJbXNnLlB1c2goIndlaWdodCIsIHBhcnNlSW50KHBhcnNlSW50KHZhbHVlW2ZpZWxkXSkqMTAwMDAvdG90YWwpLzEwMCsiJSIpCgkJfSkKCX0sCn0pCgo=",
        "/plugin/story/spide.css": "ZmllbGRzZXQuZHJhdy5zcGlkZSBkaXYub3V0cHV0IGRpdi50b2dnbGUgeyBkaXNwbGF5Om5vbmU7IH0KZmllbGRzZXQuZHJhdy5zcGlkZSBkaXYub3V0cHV0IGRpdi50b2dnbGUucHJvamVjdCB7IGRpc3BsYXk6YmxvY2s7IH0K",
        "/plugin/story/spide.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMCkgeyByZXR1cm4gfQoKCQljYW4uX2FyZ3MgPSBjYW4uYmFzZS5Db3B5KHtyb290OiAiaWNlIiwgZmllbGQ6IG1zZy5hcHBlbmRbMF0sIHNwbGl0OiBpY2UuUFN9LCBjYW4uYmFzZS5QYXJzZVVSTChjYW4uX2Rpc3BsYXkpKQoJCWNhbi5kaXJfcm9vdCA9IG1zZy5PcHRpb24obmZzLkRJUl9ST09UKXx8Y2FuLl9hcmdzLnJvb3R8fCIiCgkJY2FuLl90cmVlID0gY2FuLm9uaW1wb3J0Ll90cmVlKGNhbiwgbXNnLlRhYmxlKCksIGNhbi5fYXJncy5maWVsZCwgY2FuLl9hcmdzLnNwbGl0KQoJCWlmICghY2FuLl90cmVlWyIiXSkgeyByZXR1cm4gfSBjYW4uX3RyZWVbIiJdLm5hbWUgPSBjYW4uX2FyZ3Mucm9vdAoKCQljYW4uc2l6ZSA9IDMwLCBjYW4ubWFyZ2luID0gMzAKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgkJY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy5qcyIsICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9wYXRoLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJkcmF3IikKCQkJY2FuLm9uaW1wb3J0Ll9zaG93KGNhbiwgbXNnKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQl2YXIgcCA9IGNhbi5BY3Rpb24oaWNlLlZJRVcsIGNhbi5zdXAudmlld3x8Y2FuLkFjdGlvbihpY2UuVklFVykpCgkJCWNhbi5vbmFjdGlvbltwXShldmVudCwgY2FuLCBwKQoJCX0pCgl9LAoKCV90cmVlOiBmdW5jdGlvbihjYW4sIGxpc3QsIGZpZWxkLCBzcGxpdCkgewoJCXZhciBub2RlID0ge307IGNhbi5jb3JlLkxpc3QobGlzdCwgZnVuY3Rpb24oaXRlbSkgeyBpZiAoIWl0ZW1bZmllbGRdKSB7IHJldHVybiB9CgkJCWNhbi5jb3JlLkxpc3QoY2FuLmJhc2UudHJpbVByZWZpeChpdGVtW2ZpZWxkXSwgY2FuLmRpcl9yb290K2Nhbi5fYXJncy5zcGxpdCkuc3BsaXQoc3BsaXQpLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGFycmF5KSB7CgkJCQl2YXIgbGFzdCA9IGFycmF5LnNsaWNlKDAsIGluZGV4KS5qb2luKHNwbGl0KXx8IiIsIG5hbWUgPSBhcnJheS5zbGljZSgwLCBpbmRleCsxKS5qb2luKHNwbGl0KQoJCQkJaWYgKCF2YWx1ZSB8fCBub2RlW25hbWVdKSB7IHJldHVybiB9CgoJCQkJbm9kZVtsYXN0XSA9IG5vZGVbbGFzdF18fHtuYW1lOiBsYXN0LCBtZXRhOiB7fSwgbGlzdDogW119CgkJCQlub2RlW2xhc3RdLmxpc3QucHVzaChub2RlW25hbWVdID0gewoJCQkJCW5hbWU6IHZhbHVlKyhpbmRleD09YXJyYXkubGVuZ3RoLTE/ICIiOiBzcGxpdCksCgkJCQkJbWV0YTogaXRlbSwgbGlzdDogW10sIGxhc3Q6IG5vZGVbbGFzdF0sCgkJCQkJZmlsZTogaXRlbVtmaWVsZF18fGl0ZW0uZmlsZSwgaGlkZTogdHJ1ZSwKCQkJCX0pCgkJCX0pCgkJfSkKCQlyZXR1cm4gbm9kZQoJfSwKCV9oZWlnaHQ6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgZGVlcCkgeyBpZiAoIXRyZWUpIHsgcmV0dXJuIDAgfQoJCXRyZWUuZGVlcCA9IGRlZXB8fDAKCQlpZiAodHJlZS5saXN0Lmxlbmd0aCA9PSAwIHx8IHRyZWUuaGlkZSkgeyByZXR1cm4gdHJlZS5oZWlnaHQgPSAxIH0KCgkJdmFyIGhlaWdodCA9IDA7IGNhbi5jb3JlLkxpc3QodHJlZS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCWhlaWdodCArPSBjYW4ub25pbXBvcnQuX2hlaWdodChjYW4sIGl0ZW0sIChkZWVwfHwwKSsxKQoJCX0pCgkJcmV0dXJuIHRyZWUuaGVpZ2h0ID0gaGVpZ2h0Cgl9LAoJX3dpZHRoOiBmdW5jdGlvbihjYW4sIHRyZWUsIGRlZXApIHsgaWYgKCF0cmVlKSB7IHJldHVybiAwIH0KCQl0cmVlLmRlZXAgPSBkZWVwfHwwCgkJaWYgKHRyZWUubGlzdC5sZW5ndGggPT0gMCB8fCB0cmVlLmhpZGUpIHsKCQkJdHJlZS52aWV3ID0gY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBodG1sLlRFWFQsIHBvaW50OiBbe3g6IDAsIHk6IDB9XSwgc3R5bGU6IHtpbm5lcjogdHJlZS5uYW1lfX0pCgkJCXJldHVybiB0cmVlLndpZHRoID0gdHJlZS52aWV3LlZhbCgidGV4dExlbmd0aCIpK2Nhbi5tYXJnaW4KCQl9CgoJCXZhciB3aWR0aCA9IDA7IGNhbi5jb3JlLkxpc3QodHJlZS5saXN0LCBmdW5jdGlvbihpdGVtKSB7CgkJCXdpZHRoICs9IGNhbi5vbmltcG9ydC5fd2lkdGgoY2FuLCBpdGVtLCAoZGVlcHx8MCkrMSkKCQl9KQoJCXJldHVybiB0cmVlLndpZHRoID0gd2lkdGgKCX0sCglfY29sb3I6IGZ1bmN0aW9uKGNhbiwgdHJlZSkgewoJCXJldHVybiB0cmVlLm1ldGEmJnRyZWUubWV0YS5jb2xvciB8fCAodHJlZS5saXN0ID09IDA/IGNsaS5QVVJQTEU6IGNsaS5ZRUxMT1cpCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIueUqOaIt+aTjeS9nCIsIGxpc3Q6IFsiZWRpdCIsIFtpY2UuVklFVywgIuaoquWQkSIsICLnurXlkJEiXSwgIueUn+aIkOWbvueJhyJdLAoJImVkaXQiOiBmdW5jdGlvbihldmVudCwgY2FuKSB7IGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX2FjdGlvbiksIGNhbi5vbm1vdGlvbi50b2dnbGUoY2FuLCBjYW4uX3N0YXR1cykgfSwKCgki5qiq5ZCRIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbmltcG9ydC5faGVpZ2h0KGNhbiwgY2FuLl90cmVlWyIiXSkKCQljYW4uc3VwLnZpZXcgPSAi5qiq5ZCRIiwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZykKCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGNhbi5fdHJlZVsiIl0uaGVpZ2h0KmNhbi5zaXplKzIqY2FuLm1hcmdpbikKCQljYW4ud2lkdGggPSAwLCBjYW4ub25hY3Rpb24uX2RyYXdfaG9yaXpvbnRhbChjYW4sIGNhbi5fdHJlZVsiIl0sIGNhbi5tYXJnaW4sIGNhbi5tYXJnaW4pCgkJY2FuLnN2Zy5WYWwoaHRtbC5XSURUSCwgY2FuLndpZHRoK2Nhbi5tYXJnaW4pCgl9LAoJIue6teWQkSI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ub25pbXBvcnQuX3dpZHRoKGNhbiwgY2FuLl90cmVlWyIiXSkKCQljYW4uc3VwLnZpZXcgPSAi57q15ZCRIiwgY2FuLm9ubW90aW9uLmNsZWFyKGNhbiwgY2FuLnN2ZykKCgkJY2FuLnN2Zy5WYWwoaHRtbC5XSURUSCwgY2FuLl90cmVlWyIiXS53aWR0aCsyKmNhbi5tYXJnaW4pCgkJY2FuLmhlaWdodCA9IDAsIGNhbi5vbmFjdGlvbi5fZHJhd192ZXJ0aWNhbChjYW4sIGNhbi5fdHJlZVsiIl0sIGNhbi5tYXJnaW4sIGNhbi5tYXJnaW4rY2FuLnNpemUpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGNhbi5oZWlnaHQrY2FuLm1hcmdpbikKCX0sCgki55Sf5oiQ5Zu+54mHIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi50b2ltYWdlKGV2ZW50LCBjYW4sIGNhbi5fbGVnZW5kLmlubmVyVGV4dCwgY2FuLl9vdXRwdXQpCgl9LAoJX2RyYXc6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgeCwgeSwgc3R5bGUpIHsKCQl2YXIgY29sb3IgPSBjYW4ub25pbXBvcnQuX2NvbG9yKGNhbiwgdHJlZSkKCQl0cmVlLnZpZXcgPSBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7CgkJCXNoYXBlOiBodG1sLlRFWFQsIHBvaW50OiBbe3g6IHgsIHk6IHl9XSwgc3R5bGU6IGNhbi5iYXNlLkNvcHkoewoJCQkJc3Ryb2tlOiBjb2xvciwgZmlsbDogY29sb3IsICJ0ZXh0LWFuY2hvciI6ICJzdGFydCIsIGlubmVyOiB0cmVlLm5hbWV8fHRyZWUuZmlsZSwKCQkJfSwgc3R5bGUpLAoJCX0pLCBjYW4uY29yZS5JdGVtQ0IoY2FuLm9uZGV0YWlsLCB0cmVlLnZpZXcsIGNhbiwgdHJlZSkKCX0sCglfZHJhd192ZXJ0aWNhbDogZnVuY3Rpb24oY2FuLCB0cmVlLCB4LCB5KSB7IHRyZWUueCA9IHgsIHRyZWUueSA9IHkKCQljYW4ub25hY3Rpb24uX2RyYXcoY2FuLCB0cmVlLCB4K3RyZWUud2lkdGgvMiwgeSwgeyJ0ZXh0LWFuY2hvciI6ICJtaWRkbGUifSkKCgkJdHJlZS5oZWlnaHQgPSBjYW4uc2l6ZQoJCWlmICh5K3RyZWUuaGVpZ2h0ID4gY2FuLmhlaWdodCkgeyBjYW4uaGVpZ2h0ID0geSt0cmVlLmhlaWdodCB9CgkJaWYgKHRyZWUuaGlkZSkgeyByZXR1cm4gfQoKCQl2YXIgb2Zmc2V0ID0gMDsgY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBzdmcuUEFUSDJWLCBwb2ludDogWwoJCQkJe3g6IHgrdHJlZS53aWR0aC8yLCB5OiB5K3RyZWUuaGVpZ2h0LWNhbi5tYXJnaW4vMn0sCgkJCQl7eDogeCtvZmZzZXQraXRlbS53aWR0aC8yLCB5OiB5K3RyZWUuaGVpZ2h0K2Nhbi5tYXJnaW4vMn0sCgkJCV0sIHN0eWxlOiB7c3Ryb2tlOiBjbGkuQ1lBTn19KQoKCQkJY2FuLm9uYWN0aW9uLl9kcmF3X3ZlcnRpY2FsKGNhbiwgaXRlbSwgeCtvZmZzZXQsIHkrdHJlZS5oZWlnaHQrY2FuLm1hcmdpbikKCQkJb2Zmc2V0ICs9IGl0ZW0ud2lkdGgKCQl9KQoJfSwKCV9kcmF3X2hvcml6b250YWw6IGZ1bmN0aW9uKGNhbiwgdHJlZSwgeCwgeSkgeyB0cmVlLnggPSB4LCB0cmVlLnkgPSB5CgkJY2FuLm9uYWN0aW9uLl9kcmF3KGNhbiwgdHJlZSwgeCwgeSt0cmVlLmhlaWdodCpjYW4uc2l6ZS8yLCB7InRleHQtYW5jaG9yIjogInN0YXJ0In0pCgoJCXRyZWUud2lkdGggPSB0cmVlLnZpZXcuVmFsKCJ0ZXh0TGVuZ3RoIil8fCh0cmVlLm5hbWV8fCIiKS5sZW5ndGgqMTAKCQlpZiAoeCt0cmVlLndpZHRoID4gY2FuLndpZHRoKSB7IGNhbi53aWR0aCA9IHgrdHJlZS53aWR0aCB9CgkJaWYgKHRyZWUuaGlkZSkgeyByZXR1cm4gfQoKCQl2YXIgb2Zmc2V0ID0gMDsgY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwge3NoYXBlOiBzdmcuUEFUSDJILCBwb2ludDogWwoJCQkJe3g6IHgrdHJlZS53aWR0aCtjYW4ubWFyZ2luLzgsIHk6IHkrdHJlZS5oZWlnaHQqY2FuLnNpemUvMn0sCgkJCQl7eDogeCt0cmVlLndpZHRoK2Nhbi5tYXJnaW4qMi0yKmNhbi5tYXJnaW4vOCwgeTogeStvZmZzZXQraXRlbS5oZWlnaHQqY2FuLnNpemUvMn0KCQkJXSwgc3R5bGU6IHtzdHJva2U6IGNsaS5DWUFOfX0pCgoJCQljYW4ub25hY3Rpb24uX2RyYXdfaG9yaXpvbnRhbChjYW4sIGl0ZW0sIHgrdHJlZS53aWR0aCsyKmNhbi5tYXJnaW4sIHkrb2Zmc2V0KQoJCQlvZmZzZXQgKz0gaXRlbS5oZWlnaHQqY2FuLnNpemUKCQl9KQoJfSwKfSkKVm9sY2Fub3MoIm9uZGV0YWlsIiwge2hlbHA6ICLnlKjmiLfkuqTkupIiLCBsaXN0OiBbXSwKCW9ubW91c2VlbnRlcjogZnVuY3Rpb24oZXZlbnQsIGNhbiwgdHJlZSkgeyB2YXIgeSA9IHRyZWUueSt0cmVlLmhlaWdodCpjYW4uc2l6ZS8yCgkJY2FuLnBhZ2UuUmVtb3ZlKGNhbiwgY2FuLnBvcyksIGNhbi5wb3MgPSBjYW4ub25pbXBvcnQuZHJhdyh7fSwgY2FuLCB7CgkJCXNoYXBlOiBzdmcuUkVDVCwgcG9pbnQ6IFsKCQkJCXt4OiB0cmVlLngtY2FuLm1hcmdpbi80LCB5OiB5LWNhbi5zaXplLzJ9LAoJCQkJe3g6IHRyZWUueCt0cmVlLndpZHRoK2Nhbi5tYXJnaW4vOCwgeTogeStjYW4uc2l6ZS8yfSwKCQkJXSwgc3R5bGU6IHtzdHJva2U6IGNsaS5SRUQsIGZpbGw6IGh0bWwuTk9ORX0sCgkJfSksIGNhbi5vbmtleW1hcC5wcmV2ZW50KGV2ZW50KQoJfSwKCW9uY2xpY2s6IGZ1bmN0aW9uKGV2ZW50LCBjYW4sIHRyZWUpIHsKCQlpZiAodHJlZS5saXN0Lmxlbmd0aCA+IDAgfHwgdHJlZS50YWdzIHx8IHRyZWUubmFtZS5lbmRzV2l0aChjYW4uX2FyZ3Muc3BsaXQpKSB7CgkJCXJldHVybiB0cmVlLmhpZGUgPSAhdHJlZS5oaWRlLCBjYW4ub25hY3Rpb25bY2FuLkFjdGlvbihpY2UuVklFVyldKGV2ZW50LCBjYW4pCgkJfQoKCQlmb3IgKHZhciBub2RlID0gdHJlZTsgbm9kZTsgbm9kZSA9IG5vZGUubGFzdCkgewoJCQljYW4ucmVxdWVzdChldmVudCwgbm9kZS5tZXRhKQoJCX0KCQl2YXIgbXNnID0gY2FuLnJlcXVlc3QoZXZlbnQsIGNhbi5PcHRpb24oKSkKCQljYW4ucnVuKGV2ZW50LCBjYW4uYmFzZS5PYmooY2FuLl9hcmdzLnByZWZpeCwgW10pLmNvbmNhdChbY2FuLk9wdGlvbigicmVwb3MiKXx8IiIsIHRyZWUuZmlsZXx8IiIsIHRyZWUubmFtZV0pLCBmdW5jdGlvbihtc2cpIHsKCQkJaWYgKG1zZy5MZW5ndGgoKSA9PSAwKSB7CgkJCQlyZXR1cm4gY2FuLm9uZGV0YWlsLnBsdWdpbihjYW4sIHRyZWUsIHt9LCAid2ViLmNvZGUuaW5uZXIiLCBbY2FuLmRpcl9yb290LCB0cmVlLmZpbGUsIHRyZWUubGluZV0sIFtjdHguQUNUSU9OLCAiaW5uZXIiXSkKCQkJfQoJCQlpZiAobXNnLkFwcGVuZChtZGIuSU5ERVgpKSB7IG1zZy5UYWJsZShmdW5jdGlvbih2YWx1ZSkgewoJCQkJY2FuLm9uZGV0YWlsLnBsdWdpbihjYW4sIHRyZWUsIHZhbHVlLCB2YWx1ZS5pbmRleCwgW10sIFtjdHguQUNUSU9OLCBpY2UuUlVOLCB2YWx1ZS5pbmRleF0pCgkJCX0pOyByZXR1cm4gfQoKCQkJdHJlZS50YWdzID0gdHJ1ZQoJCQlpZiAobXNnLk9wdGlvbihsZXguU1BMSVQpKSB7CgkJCQl0cmVlLmxpc3QgPSBjYW4ub25pbXBvcnQuX3RyZWUoY2FuLCBtc2cuVGFibGUoKSwgbXNnLk9wdGlvbihtZGIuRklFTEQpfHxtc2cuYXBwZW5kWzBdLCBtc2cuT3B0aW9uKGxleC5TUExJVCkpWyIiXS5saXN0fHxbXQoJCQkJY2FuLmNvcmUuTGlzdCh0cmVlLmxpc3QsIGZ1bmN0aW9uKGl0ZW0pIHsgaXRlbS5sYXN0ID0gdHJlZSB9KQoJCQl9IGVsc2UgewoJCQkJbXNnLlRhYmxlKGZ1bmN0aW9uKGl0ZW0pIHsgdHJlZS5saXN0LnB1c2goewoJCQkJCXR5cGU6ICJ0YWdzIiwgbmFtZTogaXRlbS5uYW1lfHxpdGVtLmZpbGV8fGl0ZW1bbXNnLmFwcGVuZFswXV0sCgkJCQkJbWV0YTogaXRlbSwgbGlzdDogW10sIGxhc3Q6IHRyZWUsCgkJCQkJZmlsZTogaXRlbS5maWxlLCBsaW5lOiBpdGVtLmxpbmUsIGhpZGU6IHRydWUsCgkJCQl9KSB9KQoJCQl9CgkJCXRyZWUuaGlkZSA9ICF0cmVlLmhpZGUsIGNhbi5vbmFjdGlvbltjYW4uQWN0aW9uKGljZS5WSUVXKV0oZXZlbnQsIGNhbikKCQl9LCB0cnVlKQoJfSwKCglwbHVnaW46IGZ1bmN0aW9uKGNhbiwgdHJlZSwgdmFsdWUsIGluZGV4LCBhcmdzLCBwcmVmaXgpIHsKCQlmb3IgKHZhciBub2RlID0gdHJlZTsgbm9kZTsgbm9kZSA9IG5vZGUubGFzdCkgewoJCQljYW4uYmFzZS5Db3B5KHZhbHVlLCBub2RlLm1ldGEpCgkJfQoJCWNhbi5vbmFwcGVuZC5wbHVnaW4oY2FuLCBjYW4uYmFzZS5Db3B5KHt0eXBlOiBjaGF0LkZMT0FULCBpbmRleDogaW5kZXgsIGFyZ3M6IGFyZ3N9KSwgZnVuY3Rpb24oc3ViKSB7CgkJCXN1Yi5ydW4gPSBmdW5jdGlvbihldmVudCwgY21kcywgY2IpIHsgdmFyIG1zZyA9IGNhbi5yZXF1ZXN0KGV2ZW50KQoJCQkJY2FuLnJ1bihldmVudCwgY2FuLm1pc2MuY29uY2F0KGNhbiwgcHJlZml4LCBjbWRzKSwgY2IsIHRydWUpCgkJCX0sIGNhbi5vbmRldGFpbC5maWd1cmUoY2FuLCBzdWIpCgkJfSkKCX0sCglmaWd1cmU6IGZ1bmN0aW9uKGNhbiwgc3ViLCBtc2csIGNiKSB7CgkJY2FuLmdldEFjdGlvblNpemUoZnVuY3Rpb24obGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KSB7IGxlZnQgPSBsZWZ0fHwwCgkJCXZhciB0b3AgPSAxMjA7IGlmIChjYW4udXNlci5pc01vYmlsZSkgeyB0b3AgPSBjYW4udXNlci5pc0xhbmRzY2FwZSgpPyAwOiA0OCB9CgkJCXN1Yi5Db25mSGVpZ2h0KGhlaWdodC10b3AtaHRtbC5BQ1RJT05fSEVJR0hULShjYW4udXNlci5pc01vYmlsZSYmIWNhbi51c2VyLmlzTGFuZHNjYXBlKCk/IDIqaHRtbC5BQ1RJT05fSEVJR0hUOiAwKSksIHN1Yi5Db25mV2lkdGgod2lkdGgpCgoJCQljYW4ub25tb3Rpb24ubW92ZShjYW4sIHN1Yi5fdGFyZ2V0LCB7cG9zaXRpb246IGh0bWwuRklYRUQsIGxlZnQ6IGxlZnQsIHRvcDogdG9wfSkKCQkJY2FuLnBhZ2Uuc3R5bGUoY2FuLCBzdWIuX291dHB1dCwgaHRtbC5NQVhfV0lEVEgpCgkJCWNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCX0pCgl9LAp9KQoK",
        "/plugin/story/trend.css": "ZmllbGRzZXQuZHJhdy50cmVuZCBkaXYub3V0cHV0IGRpdi50b2dnbGUgeyBkaXNwbGF5Om5vbmU7IH0KCg==",
        "/plugin/story/trend.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9ubW90aW9uLmNsZWFyKGNhbiksIGNhbi5iYXNlLmlzRnVuYyhjYikgJiYgY2IobXNnKQoJCWlmIChtc2cuTGVuZ3RoKCkgPT0gMCkgeyByZXR1cm4gfQoJCWlmIChtc2cuT3B0aW9uKCJicmFuY2giKSkgeyByZXR1cm4gY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKSB9CgoJCWNhbi5vbmFwcGVuZC5fc3RhdHVzKGNhbiwgWyJmcm9tIiwgImNvbW1pdCIsICJ0b3RhbCIsICJtYXgiLCAiZGF0ZSIsICJ0ZXh0IiwgImFkZCIsICJkZWwiXSkKCQljYW4uZGF0YSA9IG1zZy5UYWJsZSgpLCBjYW4ub25pbXBvcnQuX3N1bShjYW4pCgkJY2FuLkFjdGlvbihodG1sLkhFSUdIVCwgbXNnLk9wdGlvbihodG1sLkhFSUdIVCl8fGljZS5BVVRPKQoJCWNhbi5BY3Rpb24oInNwZWVkIiwgcGFyc2VJbnQobXNnLk9wdGlvbigic3BlZWQiKXx8IjEwMCIpKQoKCQljYW4ub25tb3Rpb24uaGlkZGVuKGNhbiwgY2FuLl9hY3Rpb24pCgkJY2FuLnJlcXVpcmUoWyIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy5qcyIsICIvcGx1Z2luL2xvY2FsL3dpa2kvZHJhdy9wYXRoLmpzIl0sIGZ1bmN0aW9uKCkgewoJCQljYW4ucGFnZS5DbGFzc0xpc3QuYWRkKGNhbiwgY2FuLl9maWVsZHMsICJkcmF3IikKCQkJY2FuLm9uaW1wb3J0Ll9zaG93KGNhbiwgbXNnKSwgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi51aS5wcm9qZWN0KQoJCQljYW4ub25hY3Rpb25bY2FuLkFjdGlvbihpY2UuVklFVyldKGV2ZW50LCBjYW4pCgkJfSkKCX0sCglfc3VtOiBmdW5jdGlvbihjYW4pIHsKCQl2YXIgYmVnaW4gPSAiIiwgY291bnQgPSAwLCByZXN0ID0gMCwgYWRkID0gMCwgZGVsID0gMCwgbWF4ID0gMAoJCWNhbi5tYXggPSAwLCBjYW4ubWluID0gMCwgY2FuLmxpc3QgPSBjYW4uY29yZS5MaXN0KGNhbi5kYXRhLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsKCQkJdmFyIGxpbmUgPSB7CgkJCQlkYXRlOiB2YWx1ZVtjYW4uX21zZy5hcHBlbmRbMF1dLAoJCQkJdGV4dDogdmFsdWVbY2FuLl9tc2cuYXBwZW5kWzRdXSwKCQkJCWFkZDogcGFyc2VJbnQodmFsdWVbY2FuLl9tc2cuYXBwZW5kWzFdXSksCgkJCQlkZWw6IHBhcnNlSW50KHZhbHVlW2Nhbi5fbXNnLmFwcGVuZFsyXV0pLAoJCQl9CgoJCQlsaW5lLmJlZ2luID0gcmVzdAoJCQlsaW5lLm1heCA9IHJlc3QgKyBsaW5lLmFkZAoJCQlsaW5lLm1pbiA9IHJlc3QgLSBsaW5lLmRlbAoJCQlsaW5lLmNsb3NlID0gcmVzdCArIGxpbmUuYWRkIC0gbGluZS5kZWwKCgkJCWJlZ2luID0gYmVnaW4gfHwgdmFsdWUuZGF0ZSwgY291bnQrKwoJCQlyZXN0ID0gbGluZS5jbG9zZSwgYWRkICs9IGxpbmUuYWRkLCBkZWwgKz0gbGluZS5kZWwKCgkJCWlmIChsaW5lLm1heCAtIGxpbmUubWluID4gbWF4KSB7IG1heCA9IGxpbmUubWF4IC0gbGluZS5taW4gfQoJCQlpZiAobGluZS5tYXggPiBjYW4ubWF4KSB7IGNhbi5tYXggPSBsaW5lLm1heCB9CgkJCWlmIChsaW5lLm1pbiA8IGNhbi5taW4pIHsgY2FuLm1pbiA9IGxpbmUubWluIH0KCQkJcmV0dXJuIGxpbmUKCQl9KQoJCWNhbi5TdGF0dXMoeyJmcm9tIjogYmVnaW4sICJjb21taXQiOiBjb3VudCwgInRvdGFsIjogYWRkK2RlbCwgIm1heCI6IG1heH0pCgl9LAp9LCBbIiJdKQpWb2xjYW5vcygib25hY3Rpb24iLCB7aGVscDogIue7hOS7tuiPnOWNlSIsIGxpc3Q6IFsiZWRpdCIsIFtpY2UuVklFVywgIui2i+WKv+WbviIsICLmn7Hnirblm74iLCAi5pWw5o2u5rqQIl0sIFsiaGVpZ2h0IiwgIjEwMCIsICIyMDAiLCAiNDAwIiwgIjYwMCIsICI4MDAiLCAiYXV0byJdLCBbInNwZWVkIiwgIjEwIiwgIjIwIiwgIjUwIiwgIjEwMCJdXSwKCSJlZGl0IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgeyBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLl9hY3Rpb24pLCBjYW4ub25tb3Rpb24udG9nZ2xlKGNhbiwgY2FuLl9zdGF0dXMpIH0sCgoJIui2i+WKv+WbviI6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIGhlaWdodCA9IGNhbi5BY3Rpb24oaHRtbC5IRUlHSFQpCgkJaWYgKGhlaWdodCA9PSBpY2UuQVVUTykgeyBoZWlnaHQgPSBjYW4uQ29uZihodG1sLkhFSUdIVCkgfQoJCWhlaWdodCA9IHBhcnNlSW50KGhlaWdodCkKCgkJdmFyIHNwYWNlID0gMTAsIHdpZHRoID0gcGFyc2VJbnQoY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkJdmFyIHN0ZXAgPSBwYXJzZUludCgod2lkdGgtMipzcGFjZSkgLyBjYW4ubGlzdC5sZW5ndGgpCgoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGhlaWdodCkKCQljYW4uc3ZnLlZhbChodG1sLldJRFRILCB3aWR0aCkKCgkJZnVuY3Rpb24gc2NhbGUoeSkgeyByZXR1cm4gKHkgLSBjYW4ubWluKS8oY2FuLm1heCAtIGNhbi5taW4pKihoZWlnaHQtMipzcGFjZSkgfQoJCWZ1bmN0aW9uIG9yZGVyKGluZGV4LCB4LCB5KSB7IHJldHVybiB7eDogc3BhY2Urc3RlcCppbmRleCt4LCB5OiBoZWlnaHQtc3BhY2Utc2NhbGUoeSl9IH0KCgkJY2FuLmNvcmUuTmV4dChjYW4ubGlzdCwgZnVuY3Rpb24obGluZSwgbmV4dCwgaW5kZXgpIHsKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwgewoJCQkJc2hhcGU6IHN2Zy5MSU5FLCBwb2ludDogWwoJCQkJCW9yZGVyKGluZGV4LCBzdGVwLzIsIGxpbmUubWluKSwgb3JkZXIoaW5kZXgsIHN0ZXAvMiwgbGluZS5tYXgpLAoJCQkJXSwgc3R5bGU6IGtpdC5EaWN0KGh0bWwuU1RST0tFX1dJRFRILCAxLCBodG1sLlNUUk9LRSwgbGluZS5iZWdpbiA8IGxpbmUuY2xvc2U/IGNoYXQuV0hJVEU6IGNoYXQuQkxBQ0spLAoJCQl9KQoKCQkJY2FuLm9uaW1wb3J0LmRyYXcoe30sIGNhbiwgewoJCQkJc2hhcGU6IHN2Zy5SRUNULCBwb2ludDogWwoJCQkJCW9yZGVyKGluZGV4LCBzdGVwLzQsIGxpbmUuY2xvc2UpLCBvcmRlcihpbmRleCwgc3RlcC80KjMsIGxpbmUuYmVnaW4pLAoJCQkJXSwgc3R5bGU6IGNhbi5iYXNlLkNvcHkoa2l0LkRpY3QoaHRtbC5TVFJPS0VfV0lEVEgsIDEsIHN2Zy5SWCwgMCwgc3ZnLlJZLCAwKSwgbGluZS5iZWdpbiA8IGxpbmUuY2xvc2U/CgkJCQkJa2l0LkRpY3QoaHRtbC5TVFJPS0UsIGNoYXQuV0hJVEUsIGh0bWwuRklMTCwgY2hhdC5XSElURSk6IGtpdC5EaWN0KGh0bWwuU1RST0tFLCBjaGF0LkJMQUNLLCBodG1sLkZJTEwsIGNoYXQuQkxBQ0spCgkJCQkpLAoJCQkJX2luaXQ6IGZ1bmN0aW9uKHZpZXcpIHsKCQkJCQljYW4uY29yZS5JdGVtQ0IoY2FuLm9uZGV0YWlsLCBmdW5jdGlvbihrZXksIGNiKSB7IHZpZXdba2V5XSA9IGZ1bmN0aW9uKGV2ZW50KSB7IGNiKGV2ZW50LCBjYW4sIGxpbmUpIH0gfSkKCQkJCX0sCgkJCX0pCgoJCQljYW4uU3RhdHVzKGxpbmUsIFsiZGF0ZSIsICJ0ZXh0IiwgImFkZCIsICJkZWwiXSkKCQkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQoY2FuLkFjdGlvbigic3BlZWQiKSksIG5leHQpCgkJfSkKCX0sCgki5p+x54q25Zu+IjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCXZhciBtYXggPSB7fSwgbWluID0ge30KCQljYW4uY29yZS5MaXN0KGNhbi5fbXNnLmFwcGVuZCwgZnVuY3Rpb24oa2V5LCB3aGljaCkgewoJCQljYW4uY29yZS5MaXN0KGNhbi5kYXRhLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgpIHsKCQkJCXZhciB2ID0gcGFyc2VJbnQodmFsdWVba2V5XSl8fDA7IGlmIChpbmRleCA9PSAwKSB7CgkJCQkJbWF4W2tleV0gPSB2LCBtaW5ba2V5XSA9IHYKCQkJCQlyZXR1cm4KCQkJCX0KCQkJCWlmICh2ID4gbWF4W2tleV0pIHsgbWF4W2tleV0gPSB2IH0KCQkJCWlmICh2IDwgbWluW2tleV0pIHsgbWluW2tleV0gPSB2IH0KCQkJfSkKCQl9KQoKCQl2YXIgaGVpZ2h0ID0gcGFyc2VJbnQoY2FuLkFjdGlvbihodG1sLkhFSUdIVCkpCgkJdmFyIHNwYWNlID0gMTAsIHdpZHRoID0gcGFyc2VJbnQoY2FuLkNvbmYoaHRtbC5XSURUSCkpCgkJdmFyIHN0ZXAgPSBwYXJzZUludCgod2lkdGgtMipzcGFjZSkgLyBjYW4ubGlzdC5sZW5ndGgpCgoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi5zdmcpCgkJY2FuLnN2Zy5WYWwoaHRtbC5IRUlHSFQsIGhlaWdodCkKCQljYW4uc3ZnLlZhbChodG1sLldJRFRILCB3aWR0aCkKCgkJZnVuY3Rpb24gc2NhbGUoa2V5LCB5KSB7IHJldHVybiAoeSAtIG1pbltrZXldKS8obWF4W2tleV0gLSBtaW5ba2V5XSkqKGhlaWdodC0yKnNwYWNlKSB9CgkJZnVuY3Rpb24gb3JkZXIoaW5kZXgsIGtleSwgeCwgeSkgeyByZXR1cm4ge3g6IHNwYWNlK3N0ZXAqaW5kZXgreCwgeTogc3BhY2Urc2NhbGUoa2V5LCB5KX0gfQoKCQl2YXIgd2lkdGggPSAoc3RlcC00KS9jYW4uX21zZy5hcHBlbmQubGVuZ3RoCgkJY2FuLmNvcmUuTGlzdChjYW4uX21zZy5hcHBlbmQsIGZ1bmN0aW9uKGtleSwgd2hpY2gpIHsKCQkJbWF4W2tleV0gIT0gbWluW2tleV0gJiYgY2FuLmNvcmUuTmV4dChjYW4uZGF0YSwgZnVuY3Rpb24obGluZSwgbmV4dCwgaW5kZXgpIHsKCQkJCXZhciB5ID0gc2NhbGUoa2V5LCBwYXJzZUZsb2F0KGxpbmVba2V5XSkpCgkJCQl5ICYmIGNhbi5vbmltcG9ydC5kcmF3KHt9LCBjYW4sIHsKCQkJCQlzaGFwZTogc3ZnLlJFQ1QsIHBvaW50OiBbCgkJCQkJCW9yZGVyKGluZGV4LCBrZXksIHdpZHRoKndoaWNoKzIsIDApLCBvcmRlcihpbmRleCwga2V5LCB3aWR0aCp3aGljaCsyK3dpZHRoLCB5KSwKCQkJCQldLCBzdHlsZToga2l0LkRpY3QoaHRtbC5TVFJPS0VfV0lEVEgsIDEsIGh0bWwuU1RST0tFLCBjbGkuV0hJVEUsIGh0bWwuRklMTCwgY2xpLldISVRFLCBzdmcuUlgsIDAsIHN2Zy5SWSwgMCksCgkJCQkJX2luaXQ6IGZ1bmN0aW9uKHZpZXcpIHsKCQkJCQkJY2FuLmNvcmUuSXRlbUNCKGNhbi5vbmRldGFpbCwgZnVuY3Rpb24oa2V5LCBjYikgeyB2aWV3W2tleV0gPSBmdW5jdGlvbihldmVudCkgeyBjYihldmVudCwgY2FuLCBsaW5lKSB9IH0pCgkJCQkJfSwKCQkJCX0pCgoJCQkJY2FuLmNvcmUuVGltZXIocGFyc2VJbnQoY2FuLkFjdGlvbigic3BlZWQiKSksIG5leHQpCgkJCX0pCgkJfSkKCX0sCgki5pWw5o2u5rqQIjogZnVuY3Rpb24oZXZlbnQsIGNhbikgewoJCWNhbi5vbm1vdGlvbi5jbGVhcihjYW4sIGNhbi51aS5kaXNwbGF5KQoJCWNhbi5vbmFwcGVuZC50YWJsZShjYW4sIGNhbi5fbXNnLCBudWxsLCBjYW4udWkuZGlzcGxheSkKCQljYW4ub25tb3Rpb24uc2hvdyhjYW4sIGNhbi51aS5kaXNwbGF5KQoJfSwKCgloZWlnaHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uW2Nhbi5BY3Rpb24oaWNlLlZJRVcpXShldmVudCwgY2FuKSB9LAoJc3BlZWQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgY2FuLm9uYWN0aW9uW2Nhbi5BY3Rpb24oaWNlLlZJRVcpXShldmVudCwgY2FuKSB9LAp9KQpWb2xjYW5vcygib25kZXRhaWwiLCB7aGVscDogIueUqOaIt+S6pOS6kiIsIGxpc3Q6IFtdLAoJb25tb3VzZWVudGVyOiBmdW5jdGlvbihldmVudCwgY2FuLCBsaW5lKSB7IGNhbi5TdGF0dXMobGluZSwgWyJkYXRlIiwgInRleHQiLCAiYWRkIiwgImRlbCJdKSB9LAp9KQpWb2xjYW5vcygib25leHBvcnQiLCB7aGVscDogIuWvvOWHuuaVsOaNriIsIGxpc3Q6IFtdfSkKCg==",
        "/plugin/story/video.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBsaXN0LCBjYiwgdGFyZ2V0KSB7CgkJY2FuLm9uaW1wb3J0LnNlbGVjdChjYW4sIG1zZykKCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuKSwgY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnKSwgY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgbXNnKQoJCWNhbi5jb3JlLlRpbWVyKDEyMDAwLCBmdW5jdGlvbigpIHsgY2FuLm9uYWN0aW9uLnBsYXkoZXZlbnQsIGNhbikgfSkKCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgInRkIGEiLCBmdW5jdGlvbihhKSB7CgkJCWNhbi5wYWdlLk1vZGlmeShjYW4sIGEsIHt0YXJnZXQ6ICIifSkKCQl9KQoJfSwKCXNlbGVjdDogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCQltc2cuQ2xlYXIoKSwgY2FuLnBhZ2UuU2VsZWN0KGNhbiwgZG9jdW1lbnQuYm9keSwgY2FuLk9wdGlvbigidGFncyIpLCBmdW5jdGlvbihhLCBpbmRleCkgewoJCQltc2cuUHVzaChtZGIuSU5ERVgsIGluZGV4KQoJCQltc2cuUHVzaChtZGIuTkFNRSwgYS5pbm5lclRleHQpCgkJCW1zZy5QdXNoKG1kYi5MSU5LLCBhLmhyZWYpCgkJCWEuaHJlZiA9PSBsb2NhdGlvbi5ocmVmICYmIGNhbi5jb3JlLlRpbWVyKDEwMCwgZnVuY3Rpb24oKSB7CgkJCQljYW4ucGFnZS5TZWxlY3QoY2FuLCBjYW4uX291dHB1dCwgaHRtbC5UUiwgZnVuY3Rpb24odHIsIGkpIHsKCQkJCQlpLTEgPT0gaW5kZXggJiYgY2FuLnBhZ2UuQ2xhc3NMaXN0LmFkZChjYW4sIHRyLCAic2VsZWN0IikKCQkJCX0pCgkJCX0pCgkJfSkKCQltc2cuT3B0aW9uKGljZS5NU0dfU1RBVFVTLCBKU09OLnN0cmluZ2lmeShbCgkJCXtuYW1lOiAidGltZSIsIHZhbHVlOiBjYW4uYmFzZS5UaW1lKG51bGwsICIleS0lbS0lZCAlSDolTTolUyIpfSwKCQkJe25hbWU6ICJjb3VudCIsIHZhbHVlOiBtc2cuTGVuZ3RoKCl9LAoJCV0pKQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbXSwKCW5leHQ6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsgdmFyIG1zZyA9IGNhbi5fbXNnCgkJbXNnLlRhYmxlKGZ1bmN0aW9uKGxpbmUsIGluZGV4KSB7CgkJCWlmIChsaW5lLmxpbmsgPT0gbG9jYXRpb24uaHJlZikgewoJCQkJbG9jYXRpb24uaHJlZiA9IG1zZy5saW5rW2luZGV4KzFdCgkJCX0KCQl9KQoJfSwKCXBsYXk6IGZ1bmN0aW9uKGV2ZW50LCBjYW4pIHsKCQljYW4ucGFnZS5TZWxlY3RBbGwoY2FuLCBkb2N1bWVudC5ib2R5LCBodG1sLlZJREVPLCBmdW5jdGlvbih2aWRlbykgewoJCQl2aWRlby5wbGF5YmFja1JhdGUgPSBwYXJzZUZsb2F0KGNhbi5PcHRpb24oInJhdGUiKSkKCQkJdmlkZW8uY3VycmVudFRpbWUgPSBwYXJzZUludChjYW4uT3B0aW9uKCJza2lwIikpCgkJCXZpZGVvLm9udGltZXVwZGF0ZSA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAodmlkZW8uY3VycmVudFRpbWUgPiBwYXJzZUludChjYW4uT3B0aW9uKCJuZXh0IikpKSB7CgkJCQkJY2FuLm9uYWN0aW9uLm5leHQoZXZlbnQsIGNhbikKCQkJCX0KCQkJfSwgdmlkZW8ucGxheSgpLCB2aWRlby5yZXF1ZXN0RnVsbHNjcmVlbigpCgkJfSkKCX0sCn0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW119KQoK",
        "/plugin/table.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBsaXN0OiBbXSwgX2luaXQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCBjYiwgdGFyZ2V0KSB7CgkJY2FuLnVzZXIuaXNNb2JpbGUgJiYgIWNhbi51c2VyLmlzTGFuZHNjYXBlKCkgJiYgY2FuLm9ubW90aW9uLmhpZGRlbihjYW4sIGNhbi5fYWN0aW9uKQoJCXZhciBjYnMgPSBjYW4ub25pbXBvcnRbY2FuLl9hcmdzWyJzdHlsZSJdXTsgaWYgKGNhbi5iYXNlLmlzRnVuYyhjYnMpKSB7CgkJCWNhbi5wYWdlLkNsYXNzTGlzdC5hZGQoY2FuLCB0YXJnZXQsIGNhbi5fYXJnc1sic3R5bGUiXSkKCQkJcmV0dXJuIGNicyhjYW4sIG1zZywgdGFyZ2V0KQoJCX0KCQljYW4ub25tb3Rpb24uY2xlYXIoY2FuLCB0YXJnZXQpCgkJY2FuLm9uYXBwZW5kLnRhYmxlKGNhbiwgbXNnLCBudWxsLCB0YXJnZXQpCgkJY2FuLm9uYXBwZW5kLmJvYXJkKGNhbiwgbXNnLCB0YXJnZXQpCgkJY2FuLm9ubW90aW9uLnN0b3J5LmF1dG8oY2FuLCB0YXJnZXQpCgkJY2FuLmJhc2UuaXNGdW5jKGNiKSAmJiBjYihtc2cpCgl9LAoKCV9wcm9jZXNzOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCW1zZy5PcHRpb24oaWNlLk1TR19UT0FTVCkgJiYgY2FuLnVzZXIudG9hc3QoY2FuLCBtc2cuT3B0aW9uKGljZS5NU0dfVE9BU1QpKQoJCXJldHVybiBjYW4uY29yZS5DYWxsRnVuYyhbY2FuLm9uaW1wb3J0LCBtc2cuT3B0aW9uKGljZS5NU0dfUFJPQ0VTUyldLCBbY2FuLCBtc2ddKQoJfSwKCWNhcmQ6IGZ1bmN0aW9uKGNhbiwgbXNnLCB0YXJnZXQpIHsKCQljYW4ucGFnZS5BcHBlbmRzKGNhbiwgdGFyZ2V0LCBtc2cuVGFibGUoZnVuY3Rpb24odmFsdWUpIHsKCQkJcmV0dXJuIHt2aWV3OiAiaXRlbSIsIGxpc3Q6IFsKCQkJCXt2aWV3OiBbInRpdGxlIiwgImRpdiIsIHZhbHVlLm5hbWVdfSwKCQkJCXt2aWV3OiBbImNvbnRlbnQiLCAiZGl2IiwgdmFsdWUudGV4dF19LAoJCQkJe3ZpZXc6ICJvcGVyYXRlIiwgaW5uZXI6IHZhbHVlLmFjdGlvbiwgb25jbGljazogZnVuY3Rpb24oZXZlbnQpIHsKCQkJCQljYW4ucmVxdWVzdChldmVudCwgdmFsdWUpCgkJCQkJY2FuLnJ1bihldmVudCwgW2N0eC5BQ1RJT04sIGV2ZW50LnRhcmdldC5uYW1lXSkKCQkJCX19LAoJCQldfQoJCX0pKQoJfSwKfSkKVm9sY2Fub3MoIm9uYWN0aW9uIiwge2hlbHA6ICLmjqfku7bkuqTkupIiLCBsaXN0OiBbXX0pClZvbGNhbm9zKCJvbmV4cG9ydCIsIHtoZWxwOiAi5a+85Ye65pWw5o2uIiwgbGlzdDogW119KQoK",
        "/publish/client/nodejs/proto.js": "Vm9sY2Fub3MoIm9uYXBwZW5kIiwge2hlbHA6ICLmuLLmn5PlvJXmk44iLCBsaXN0OiBbXSwKCXRhYmxlOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCXZhciBtYXggPSB7fTsgbXNnLlRhYmxlKGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgYXJyYXkpIHsKCQkJZm9yICh2YXIgayBpbiB2YWx1ZSkgeyBpZiAodmFsdWVba10ubGVuZ3RoID4gKG1heFtrXXx8MCkpIHsKCQkJCW1heFtrXSA9IHZhbHVlW2tdLmxlbmd0aAoJCQl9IH0KCQl9KQoKCQl2YXIgbGlzdCA9IFtdOyBtc2cuVGFibGUoZnVuY3Rpb24odmFsdWUsIGluZGV4LCBhcnJheSkgeyB2YXIgbGluZSA9IFtdCgkJCWlmIChpbmRleCA9PSAwKSB7CgkJCQlmb3IgKHZhciBpID0gMDsgaSA8IG1zZy5hcHBlbmQubGVuZ3RoOyBpKyspIHsgbGluZS5wdXNoKG1zZy5hcHBlbmRbaV0pCgkJCQkJZm9yICh2YXIgaiA9IDA7IGogPD0gbWF4W21zZy5hcHBlbmRbaV1dLW1zZy5hcHBlbmRbaV0ubGVuZ3RoOyBqKyspIHsKCQkJCQkJbGluZS5wdXNoKGljZS5TUCkKCQkJCQl9CgkJCQkJbGluZS5wdXNoKGljZS5TUCkKCQkJCX0KCQkJCWxpc3QucHVzaChsaW5lLmpvaW4oIiIpKQoJCQl9CgkJCWxpbmUgPSBbXTsgZm9yICh2YXIgaSA9IDA7IGkgPCBtc2cuYXBwZW5kLmxlbmd0aDsgaSsrKSB7IHZhciBrID0gbXNnLmFwcGVuZFtpXQoJCQkJbGluZS5wdXNoKHZhbHVlW2tdKQoJCQkJZm9yICh2YXIgaiA9IDA7IGogPD0gbWF4W2tdLXZhbHVlW2tdOyBqKyspIHsKCQkJCQlsaW5lLnB1c2goaWNlLlNQKQoJCQkJfQoJCQkJbGluZS5wdXNoKGljZS5TUCkKCQkJfQoJCQlsaXN0LnB1c2gobGluZS5qb2luKCIiKSkKCQl9KQoJCWNvbnNvbGUubG9nKGxpc3Quam9pbihpY2UuTkwpKQoJfSwKCWJvYXJkOiBmdW5jdGlvbihjYW4sIG1zZykgewoJCWNvbnNvbGUubG9nKG1zZy5SZXN1bHQoKSkKCX0sCn0pCgo=",

        "usr/intshell/LICENSE": "TUlUIExpY2Vuc2UKCkNvcHlyaWdodCAoYykgMjAyMSDnoIHnpZ4KClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwp0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwpmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsCmNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgpUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgpJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUKU09GVFdBUkUuCg==",
        "usr/intshell/README.md": "IyBpbnRzaGVsbApJTlRTSEVMTCBhbGlhcyBmb3IgaW4gdGhlIHNoZWxsLCBhIHBsdWdpbiBtYW5hZ2VyIHN5c3RlbQoKIyMgQWJvcnQKCklOVFNIRUxMIGFsbG93cyB5b3UgdG8uLi4KCi0ga2VlcCB0cmFjayBvZiBhbmQgY29uZmlndXJlIHlvdXIgcGx1Z2lucyByaWdodCBpbiB0aGUgLmlzaC9wbHVnZWQvCi0gaW5zdGFsbCBjb25maWd1cmVkIHBsdWdpbnMgKGEuay5hLiBzY3JpcHRzL2J1bmRsZSkKLSB1cGRhdGUgY29uZmlndXJlZCBwbHVnaW5zCi0gc2VhcmNoIGJ5IG5hbWUgYWxsIGF2YWlsYWJsZSBzY3JpcHRzCi0gY2xlYW4gdW51c2VkIHBsdWdpbnMgdXAKCklOVFNIRUxMIGF1dG9tYXRpY2FsbHkuLi4KCi0gY2xvbmUgdGhlIHJlcG9zIGlmIHRoZSBwbHVnaW5zIGRvbid0IGV4aXN0cwotIGxvYWQgdGhlIHNjcmlwdCBpZiB0aGUgcGx1Z2lucyBkb24ndCBzb3VyY2UKLSBtYW5hZ2VzIHRoZSBydW50aW1lIHBhdGggb2YgeW91ciBpbnN0YWxsZWQgc2NyaXB0cwotIHJlZ2VuZXJhdGVzIGhlbHAgdGFncyBhZnRlciBpbnN0YWxsaW5nIGFuZCB1cGRhdGluZwoKIyMgUXVpY2sgU3RhcnQKIyMjIDEuIFNldCB1cCBJTlRTSEVMTAoKYGBgc2gKZ2l0IGNsb25lIGh0dHBzOi8vc2h5bGludXguY29tL3gvaW50c2hlbGwuZ2l0IH4vLmlzaApgYGAKCiMjIyAyLiBDb25maWd1cmUgUGx1Z2luczoKUHV0IHRoaXMgYXQgdGhlIGJvdHRvbSBvZiB5b3VyIC5iYXNocmMgdG8gdXNlIElOVFNIRUxMCmBgYHNoCmlmIFsgLWYgfi8uaXNoL3BsdWcuc2ggXSAmJiBzb3VyY2Ugfi8uaXNoL3BsdWcuc2g7IHRoZW4KICAgIHJlcXVpcmUgY29uZi5zaAogICAjIC4uLiBhZGQgb3RoZXIgcGx1Z2lucwpmaQoKYGBgCgojIyMgMy4gVXNlIFBsdWdpbnM6CioqdXNlIGJ5IGF1dG8gbG9hZCoqCmBgYHNoCiQgaXNoIHNoeWxpbnV4LmNvbS94L2ludHNoZWxsL2Jhc2UuY2xpLm9zX29zX3N5c3RlbQpHTlUvTGludXgKCmBgYAoKKip1c2UgYnkgbWFudWFsIGxvYWQqKgpgYGBzaAokIHJlcXVpcmUgc2h5bGludXguY29tL3gvaW50c2hlbGwgYmFzZS9jbGkvb3Muc2gKYGBgCgphZnRlciBsb2FkIG9zLnNoLCB5b3UgY2FsbCBhbGwgdGhlIGZ1bmN0aW9uIGRpcmVjdGx5CmBgYHNoCiQgaXNoX2N0eF9vc19zeXN0ZW0KR05VL0xpbnV4CgokIGlzaF9jdHhfb3Nfa2VybmVsCkxpbnV4CgpgYGAKCiMjIENyZWF0ZSBQbHVnaW5zOgojIyMgYWRkIHBsdWdpbgppZiB0aGUgcGx1Z2luIG5hbWVkICpkZW1vKgphZGQgdGhlIGNvZGUgdG8gdGhlIGZpbGUgJElTSF9QQVRIL2RlbW8vZGVtby5zaApgYGBzaAppc2ggc2V0IHJlcG9zICJnaXRodWIuY29tL3h4eC94eHgiCmlzaCBzZXQgb3duZXIgInh4eEBnbWFpbC5jb20iCmlzaCBzZXQgcHJvZHVjdCAicGx1Z2luIGRlbW8iCmlzaCBzZXQgdmVyc2lvbiAidjAuMC4xIgoKJHtJU0hfQ1RYX1NDUklQVH1faW5mbygpIHsgaXNoIG1vZCAkMAogICAgZWNobyAicmVwb3M6ICQoaXNoIGdldCByZXBvcykiCiAgICBlY2hvICJvd25lcjogJChpc2ggZ2V0IG93bmVyKSIKICAgIGVjaG8gInByb2R1Y3Q6ICQoaXNoIGdldCBwcm9kdWN0KSIKICAgIGVjaG8gInZlcnNpb246ICQoaXNoIGdldCB2ZXJzaW9uKSIKfQoke0lTSF9DVFhfU0NSSVBUfV9oZWxwKCkgeyBpc2ggbW9kICQwCiAgICBlY2hvICJ1c2FnZTogaXNoIG1vZC9maWxlLmZ1biBhcmcuLi4iCn0KJHtJU0hfQ1RYX1NDUklQVH1faW5pdCgpIHsgaXNoIG1vZCAkMAogICAgcHdkCn0KYGBgCgojIyMgdXNlIHBsdWdpbgp1c2UgdGhlIG5ldyBwbHVnaW4KYGBgc2gKJCBpc2ggZGVtby9kZW1vX2luZm8KcmVwb3M6IGdpdGh1Yi5jb20veHh4L2RlbW8Kb3duZXI6IHh4eEBnbWFpbC5jb20KcHJvZHVjdDogcGx1Z2luIGRlbW8KdmVyc2lvbjogdjAuMC4xCmBgYAoKIyMjIHNoYXJlIHBsdWdpbgppZiB5b3UgY3JlYXRlIGdpdCByZXBvcywgYW5kIHB1c2ggaXQgdG8gdGhlIGdpdGh1YiwgdXNlIGJ5IGxvbmcgbmFtZQpgYGBzaAokIGlzaCBnaXRodWIuY29tL3h4eC9kZW1vL2RlbW8uaW5mbwpyZXBvczogZ2l0aHViLmNvbS94eHgveHh4Cm93bmVyOiB4eHhAZ21haWwuY29tCnByb2R1Y3Q6IHBsdWdpbiBkZW1vCnZlcnNpb246IHYwLjAuMQpgYGAK",
        "usr/intshell/app/app.sh": "IyEvYmluL3NoCgo=",
        "usr/intshell/app/cat.sh": "IyEvYmluL2Jhc2gKCmNhdCAkMQo=",
        "usr/intshell/conf.sh": "IyEvYmluL3NoCgpyZXF1aXJlIHN5cy9zeXMuc2gKcmVxdWlyZSBkZXYvZGV2LnNoCnJlcXVpcmUgYXBwL2FwcC5zaAoK",
        "usr/intshell/dev/dev.sh": "IyEvYmluL3NoCgpyZXF1aXJlIGRldi9naXQvZ2l0LnNoCnJlcXVpcmUgZGV2L3ZpbS92aW0uc2gKcmVxdWlyZSBkZXYvdG11eC90bXV4LnNoCgo=",
        "usr/intshell/dev/git/git.sh": "IyEvYmluL2Jhc2gKCmlzaF9kZXZfZ2l0X3ByZXBhcmUoKSB7CiAgICBnaXQgY29uZmlnIC0tZ2xvYmFsIGFsaWFzLnQgdGFnCiAgICBnaXQgY29uZmlnIC0tZ2xvYmFsIGFsaWFzLnMgc3RhdHVzCiAgICBnaXQgY29uZmlnIC0tZ2xvYmFsIGFsaWFzLmIgYnJhbmNoCiAgICBnaXQgY29uZmlnIC0tZ2xvYmFsIGFsaWFzLmwgImxvZyAtLW9uZWxpbmUgLS1kZWNvcmF0ZSIKICAgIGdpdCBjb25maWcgLS1nbG9iYWwgaW5pdC5kZWZhdWx0QnJhbmNoIG1hc3RlcgoKICAgIGdpdCBjb25maWcgLS1nbG9iYWwgY29sb3IudWkgYWx3YXlzCiAgICBnaXQgY29uZmlnIC0tZ2xvYmFsIGNvcmUucXVvdGVwYXRoIGZhbHNlCiAgICBnaXQgY29uZmlnIC0tZ2xvYmFsIGNyZWRlbnRpYWwuaGVscGVyIHN0b3JlCiAgICBnaXQgY29uZmlnIC0tZ2xvYmFsIHB1c2guZGVmYXVsdCBzaW1wbGUKICAgIGdpdCBjb25maWcgLS1nbG9iYWwgcHVsbC5mZiBvbmx5Cn0KaXNoX2Rldl9naXRfY29uZmlnKCkgewogICAgaXNoX3N5c19kZXZfcmVxdWVzdAp9Cg==",
        "usr/intshell/dev/tmux/local.sh": "IyEvYmluL2Jhc2gKCnRtdXhfY21kPSJ0bXV4IC1TIGJpbi90bXV4LnNvY2tldCAtZiBldGMvdG11eC5jb25mIgpzZXNzaW9uPW1pc3MgJiYgWyAtcyAiJDEiIF0gJiYgc2Vzc2lvbj0kMSAmJiBzaGlmdAoKaWYgJHRtdXhfY21kIGhhcy1zZXNzaW9uIC10ICRzZXNzaW9uOyB0aGVuCiAgICAkdG11eF9jbWQgYXR0YWNoIC10ICRzZXNzaW9uCmVsc2UKICAgICR0bXV4X2NtZCBuZXctc2Vzc2lvbiAtcyAkc2Vzc2lvbgpmaQo=",
        "usr/intshell/dev/tmux/tmux-1.8.conf": "YmluZCBDLW0gY29tbWFuZC1wcm9tcHQgLXAgIm1vdmUgdG86IiAic3dhcC1wYW5lIC1zIC4gLXQgJSUiCmJpbmQgQy11IGNvbW1hbmQtcHJvbXB0IC1wICJtb3ZlIHRvOiIgIm1vdmUtcGFuZSAtdiAtdCAlJSIKYmluZCBDLXYgY29tbWFuZC1wcm9tcHQgLXAgIm1vdmUgdG86IiAibW92ZS1wYW5lIC1oIC10ICUlIgoKc2V0IC1nIG1vdXNlLXNlbGVjdC13aW5kb3cgb24Kc2V0IC1nIG1vdXNlLXNlbGVjdC1wYW5lIG9uCnNldCAtZyBtb3VzZS1yZXNpemUtcGFuZSBvbgpzZXQgLWcgbW91c2UtdXRmOCBvbgpzZXQgLWcgbW9kZS1tb3VzZSBvbgoK",
        "usr/intshell/dev/tmux/tmux.conf": "IyDphY3nva7nrqHnkIYge3t7CnNldCAtZyBwcmVmaXggQy1zCgpzZXQgLWcgYmFzZS1pbmRleCAxCnNldCAtZyBwYW5lLWJhc2UtaW5kZXggMQpzZXQgLWcgcmVudW1iZXItd2luZG93cyBvbgoKc2V0IC1nIGRpc3BsYXktdGltZSA1MDAwCnNldCAtZyBkaXNwbGF5LXBhbmVzLXRpbWUgNTAwMApzZXQgLWcgaGlzdG9yeS1saW1pdCAzMDAwCnNldCAtZyBtb2RlLWtleXMgdmkKCnNldCAtZ3cgb3RoZXItcGFuZS13aWR0aCA2MApzZXQgLWd3IG90aGVyLXBhbmUtaGVpZ2h0IDE1CgojIOagh+mimOagjwpzZXQgLWcgc2V0LXRpdGxlcyBvbgpzZXQgLWcgc2V0LXRpdGxlcy1zdHJpbmcgIiNoLyNTOiNXLiNQIgoKIyDnirbmgIHmoI8Kc2V0IC1nIHN0YXR1cy1iZyBibHVlCnNldCAtZyBzdGF0dXMtZmcgd2hpdGUKc2V0IC1nIGFsbG93LXJlbmFtZSBvZmYKc2V0IC1nIHN0YXR1cy1pbnRlcnZhbCAxCnNldCAtZyBzdGF0dXMtbGVmdC1sZW5ndGggNjAKc2V0IC1nIHN0YXR1cy1sZWZ0ICIjW2JnPXJlZCBmZz13aGl0ZV1cIFsjaC8jU11cICNbYmc9eWVsbG93IGZnPWJsYWNrXVwgW11cICNbYmc9cmVkXSIKc2V0IC1nIHN0YXR1cy1yaWdodCAiI1tiZz1yZWRdXCBbIyhkYXRlICcrJVktJW0tJWQgJUg6JU06JVMnKV1cICIKc2V0IC1nIHN0YXR1cy1yaWdodC1sZW5ndGggNjAKCnNldCAtZ3cgd2luZG93LXN0YXR1cy1mb3JtYXQgIiNbYmc9Ymx1ZSBmZz13aGl0ZV1cIFsjSTojVyNGXVwgIgpzZXQgLWd3IHdpbmRvdy1zdGF0dXMtY3VycmVudC1mb3JtYXQgIiNbYmc9cmVkIGZnPXdoaXRlXVwgWyNJOiNXI0ZdXCAiCiMgfX19CiMg5Lya6K+d566h55CGe3t7CmJpbmQgcSBjb25maXJtLWJlZm9yZSAiZGV0YWNoLWNsaWVudCIKIyB9fX0KIyDnqpflj6PnrqHnkIZ7e3sKYmluZCBiIGJyZWFrLXBhbmUKYmluZCBjIG5ldy13aW5kb3cKYmluZCBlIGNvbW1hbmQtcHJvbXB0IC1wICJ3aW5kb3cgbmV3IG5hbWU6IiAicmVuYW1lLXdpbmRvdyAnJSUnIgpiaW5kIEIgY29tbWFuZC1wcm9tcHQgLXAgInRhcmdldCB3aW5kb3c6IiAiam9pbi1wYW5lIC12IC10ICUlIgoKYmluZCBwIHByZXZpb3VzLXdpbmRvdwpiaW5kIG4gbmV4dC13aW5kb3cKYmluZCBvIGxhc3Qtd2luZG93CiMgfX19CiMg6Z2i5p2/566h55CGe3t7CmJpbmQgaSBkaXNwbGF5LXBhbmVzCmJpbmQgeCBjb25maXJtLWJlZm9yZSAtcCAia2lsbC1wYW5lICNQPyAoeS9uKSIga2lsbC1wYW5lCmJpbmQgeiByZXNpemUtcGFuZSAtWgpiaW5kIHYgc3BsaXQtd2luZG93IC1oCmJpbmQgdSBzcGxpdC13aW5kb3cKCmJpbmQgaCBzZWxlY3QtcGFuZSAtTApiaW5kIGwgc2VsZWN0LXBhbmUgLVIKYmluZCBqIHNlbGVjdC1wYW5lIC1ECmJpbmQgayBzZWxlY3QtcGFuZSAtVQoKYmluZCBDLWcgc2VsZWN0LWxheW91IHRpbGVkCmJpbmQgQy15IHNlbGVjdC1sYXlvdSBtYWluLXZlcnRpY2FsCmJpbmQgQy10IHNlbGVjdC1sYXlvdSBtYWluLWhvcml6b250YWwKYmluZCBDLWggY29tbWFuZC1wcm9tcHQgLXAgInNpemU6IiAicmVzaXplLXBhbmUgLUwgJSUiCmJpbmQgQy1sIGNvbW1hbmQtcHJvbXB0IC1wICJzaXplOiIgInJlc2l6ZS1wYW5lIC1SICUlIgpiaW5kIEMtaiBjb21tYW5kLXByb21wdCAtcCAic2l6ZToiICJyZXNpemUtcGFuZSAtRCAlJSIKYmluZCBDLWsgY29tbWFuZC1wcm9tcHQgLXAgInNpemU6IiAicmVzaXplLXBhbmUgLVUgJSUiCmJpbmQgQy1vIGNvbmZpcm0tYmVmb3JlIC1wICJraWxsIGFsbCBvdGhlciBwYW5lKHkvbik/IiAia2lsbC1wYW5lIC1hIgojIH19fQojIOe8k+WtmOeuoeeQhnt7ewpiaW5kIEMtcyBjb3B5LW1vZGUKCmJpbmQgciBjaG9vc2UtYnVmZmVyCmJpbmQgYSBwYXN0ZS1idWZmZXIKIyB9fX0KIyDlkb3ku6TnrqHnkIZ7e3sKYmluZCBDLWkgcnVuLXNoZWxsICJzb3VyY2UgYmluL3NlbmQtaW50c2hlbGwuc2giCmJpbmQgU3BhY2UgY29tbWFuZC1wcm9tcHQKIyB9fX0KCmlmLXNoZWxsICJbIC1lIH4vLnRtdXhfbG9jYWwgXSIgInNvdXJjZS1maWxlIH4vLnRtdXhfbG9jYWwiCgo=",
        "usr/intshell/dev/tmux/tmux.sh": "IyEvYmluL2Jhc2gKCmlzaF9kZXZfdG11eF9wcmVwYXJlKCkgewogICAgaXNoX3N5c19saW5rX2NyZWF0ZSB+Ly50bXV4LmNvbmYgJFBXRC91c3IvaW50c2hlbGwvZGV2L3RtdXgvdG11eC5jb25mCiAgICBpc2hfc3lzX2xpbmtfY3JlYXRlIH4vLnRtdXhfbG9jYWwgJFBXRC91c3IvaW50c2hlbGwvZGV2L3RtdXgvdG11eF9sb2NhbC5jb25mCn0KaXNoX2Rldl90bXV4X3Nlc3Npb24oKSB7CiAgICBsb2NhbCB0bXV4X2NtZD0idG11eCAtUyBiaW4vdG11eC5zb2NrZXQgLWYgZXRjL3RtdXguY29uZiIKICAgIGxvY2FsIHNlc3Npb249bWlzcyAmJiBbIC1zICIkMSIgXSAmJiBzZXNzaW9uPSQxICYmIHNoaWZ0CgogICAgaWYgJHRtdXhfY21kIGhhcy1zZXNzaW9uIC10ICRzZXNzaW9uOyB0aGVuCiAgICAgICAgJHRtdXhfY21kIGF0dGFjaCAtdCAkc2Vzc2lvbgogICAgZWxzZQogICAgICAgICR0bXV4X2NtZCBuZXctc2Vzc2lvbiAtcyAkc2Vzc2lvbgogICAgZmkKfQo=",
        "usr/intshell/dev/tmux/tmux_local.conf": "YmluZCBjIG5ldy13aW5kb3cgLWMgIiN7cGFuZV9jdXJyZW50X3BhdGh9IgoKYmluZCB1IHNwbGl0LXdpbmRvdyAtYyAiI3twYW5lX2N1cnJlbnRfcGF0aH0iCmJpbmQgdiBzcGxpdC13aW5kb3cgLWggLWMgIiN7cGFuZV9jdXJyZW50X3BhdGh9IgpiaW5kIFUgc3BsaXQtd2luZG93IC1mIC1jICIje3BhbmVfY3VycmVudF9wYXRofSIKYmluZCBWIHNwbGl0LXdpbmRvdyAtZiAtaCAtYyAiI3twYW5lX2N1cnJlbnRfcGF0aH0iCgpiaW5kIEMtbSBkaXNwbGF5LXBhbmVzICJzd2FwLXBhbmUgLXQgJSUiCmJpbmQgQy11IGRpc3BsYXktcGFuZXMgIm1vdmUtcGFuZSAtdiAtdCAlJSIKYmluZCBDLXYgZGlzcGxheS1wYW5lcyAibW92ZS1wYW5lIC1oIC10ICUlIgoKc2V0IC1nIG1vdXNlIG9uCgo=",
        "usr/intshell/dev/vim/auto.vim": "IiDln7rnoYDlh73mlbB7e3sKIiDlj5jph4/lrprkuYkKZnVuYyEgU2h5RGVmaW5lKG5hbWUsIHZhbHVlKQoJaWYgIWV4aXN0cyhhOm5hbWUpIHwgZXhlYyAibGV0ICIgLiBhOm5hbWUgLiAiID0gXCIiIC4gYTp2YWx1ZSAuICJcIiIgfCBlbmRpZgplbmRmdW5jCgoiIOWQjuerr+mAmuS/oQpjYWxsIFNoeURlZmluZSgiZzpjdHhfc2lkIiwgIiIpCmNhbGwgU2h5RGVmaW5lKCJnOmN0eF91cmwiLCAobGVuKCRjdHhfb3BzKSA+IDE/ICRjdHhfb3BzOiAiaHR0cDovLzEyNy4wLjAuMTo5MDIwIikgLiAiL2NvZGUvdmltLyIpCmZ1bmMhIFNoeVNlbmQoY21kLCBhcmcpCiAgICBpZiBoYXNfa2V5KGE6YXJnLCAic3ViIikgJiYgYTphcmdbInN1YiJdICE9ICIiIHwgbGV0IHRlbXAgPSB0ZW1wbmFtZSgpCiAgICAgICAgY2FsbCB3cml0ZWZpbGUoc3BsaXQoYTphcmdbInN1YiJdLCAiXG4iKSwgdGVtcCwgImIiKSB8IGxldCBhOmFyZ1sic3ViIl0gPSAiQCIgLiB0ZW1wCiAgICBlbmRpZgoKICAgIGxldCBhOmFyZ1sic2lkIl0gPSBnOmN0eF9zaWQKICAgIGxldCBhOmFyZ1sicHdkIl0gPSBnZXRjd2QoKSB8IGxldCBhOmFyZ1siYnVmIl0gPSBidWZuYW1lKCIlIikgfCBsZXQgYTphcmdbInJvdyJdID0gbGluZSgiLiIpIHwgbGV0IGE6YXJnWyJjb2wiXSA9IGNvbCgiLiIpCiAgICBsZXQgYXJncyA9ICIiIHwgZm9yIGsgaW4gc29ydChrZXlzKGE6YXJnKSkgfCBsZXQgYXJncyA9IGFyZ3MgLiAiIC1GICciIC4gayAuICI9IiAuIGE6YXJnW2tdIC4gIicgIiB8IGVuZGZvcgogICAgcmV0dXJuIHN5c3RlbSgiY3VybCAtcyAiIC4gZzpjdHhfdXJsIC4gYTpjbWQgLiBhcmdzIC4gIiAyPi9kZXYvbnVsbCIpCmVuZGZ1bmMKCmZ1bmMhIFNoeUxvZ2luKCkKICAgIGxldCBnOmN0eF9zaWQgPSBTaHlTZW5kKCJzZXNzIiwgeyJ1c2VybmFtZSI6ICRVU0VSLCAiaG9zdG5hbWUiOiBob3N0bmFtZSgpLCAicGlkIjogZ2V0cGlkKCl9KQplbmRmdW5jCmZ1bmMhIFNoeUxvZ291dCgpCiAgICBjYWxsIFNoeVNlbmQoInNlc3MiLCB7ImNtZHMiOiAibG9nb3V0In0pIHwgbGV0IGc6Y3R4X3NpZCA9ICIiCmVuZGZ1bmMKIiB9fX0KIiDlip/og73lh73mlbB7e3sKIiDmlbDmja7lkIzmraUKZnVuYyEgU2h5U3luYyh0YXJnZXQpCiAgICBpZiBidWZuYW1lKCIlIikgPT0gIkNvbnRyb2xQIiB8IHJldHVybiB8IGVuZAoKICAgIGlmIGE6dGFyZ2V0ID09ICJyZWFkIiB8fCBhOnRhcmdldCA9PSAid3JpdGUiCiAgICAgICAgY2FsbCBTaHlTZW5kKCJzeW5jIiwgeyJjbWRzIjogYTp0YXJnZXQsICJhcmciOiBleHBhbmQoIjxhZmlsZT4iKX0pCiAgICBlbHNlaWYgYTp0YXJnZXQgPT0gImluc2VydCIKICAgICAgICBjYWxsIFNoeVNlbmQoInN5bmMiLCB7ImNtZHMiOiBhOnRhcmdldCwgInN1YiI6IGdldHJlZygiLiIpfSkKICAgIGVsc2VpZiBhOnRhcmdldCA9PSAiZXhlYyIKICAgICAgICBjYWxsIFNoeVNlbmQoInN5bmMiLCB7ImNtZHMiOiBhOnRhcmdldCwgImFyZyI6IGdldGNtZGxpbmUoKX0pCiAgICBlbHNlCiAgICAgICAgbGV0IGNtZCA9IHsiYnVmcyI6ICJidWZmZXJzIiwgInJlZ3MiOiAicmVnaXN0ZXJzIiwgIm1hcmtzIjogIm1hcmtzIiwgInRhZ3MiOiAidGFncyIsICJmaXhzIjogImNsaXN0In0KICAgICAgICBjYWxsIFNoeVNlbmQoInN5bmMiLCB7ImNtZHMiOiBhOnRhcmdldCwgInN1YiI6IGV4ZWN1dGUoY21kW2E6dGFyZ2V0XSl9KQogICAgZW5kaWYKZW5kZnVuYwoKIiDovpPlhaXooaXlhagKZnVuYyEgU2h5SW5wdXQoY29kZSkKICAgIHJldHVybiBzcGxpdChTaHlTZW5kKCJpbnB1dCIsIHsiY21kcyI6IGE6Y29kZSwgInByZSI6IGdldGxpbmUoIi4iKSwgInJvdyI6IGxpbmUoIi4iKSwgImNvbCI6IGNvbCgiLiIpfSksICJcbiIpCmVuZGZ1bmMKZnVuYyEgU2h5Q29tcGxldGUoZmlyc3RzdGFydCwgYmFzZSkKICAgIGlmIGE6Zmlyc3RzdGFydCB8IGxldCBsaW5lID0gZ2V0bGluZSgnLicpIHwgbGV0IHN0YXJ0ID0gY29sKCcuJykgLSAxCiAgICAgICAgIiDlkb3ku6TkvY3nva4KICAgICAgICBpZiBtYXRjaChsaW5lLCAnXHMqaWNlICcpID49IDAgfCByZXR1cm4gbWF0Y2gobGluZSwgImljZSAiKSB8IGVuZGlmCiAgICAgICAgIiDnrKblj7fkvY3nva4KICAgICAgICBpZiBsaW5lW3N0YXJ0LTFdICF+ICdcYScgfCByZXR1cm4gc3RhcnQgLSAxIHwgZW5kCiAgICAgICAgIiDljZXor43kvY3nva4KICAgICAgICB3aGlsZSBzdGFydCA+IDAgJiYgbGluZVtzdGFydCAtIDFdID1+ICdcYScgfCBsZXQgc3RhcnQgLT0gMSB8IGVuZHdoaWxlCiAgICAgICAgcmV0dXJuIHN0YXJ0CiAgICBlbmRpZgoKICAgICIg56ym5Y+36L2s5o2iCiAgICBpZiBhOmJhc2UgPT0gIigiIHwgcmV0dXJuIFsi77yIIiwgIigiXSB8IGVuZAogICAgaWYgYTpiYXNlID09ICIpIiB8IHJldHVybiBbIu+8iSIsICIpIl0gfCBlbmQKICAgIGlmIGE6YmFzZSA9PSAiOiIgfCByZXR1cm4gWyLvvJoiLCAiOiJdIHwgZW5kCiAgICBpZiBhOmJhc2UgPT0gIjsiIHwgcmV0dXJuIFsi77ybIiwgIjsiXSB8IGVuZAogICAgaWYgYTpiYXNlID09ICIsIiB8IHJldHVybiBbIu+8jCIsICIsIl0gfCBlbmQKICAgICIgaWYgYTpiYXNlID09ICIuIiB8IHJldHVybiBbIuOAgiIsICIuIl0gfCBlbmQKICAgIGlmIGE6YmFzZSA9PSAiXFwiIHwgcmV0dXJuIFsi44CBIiwgIlxcIl0gfCBlbmQKCiAgICAiIOWNleivjei9rOaNogogICAgbGV0IGxpc3QgPSBTaHlJbnB1dChhOmJhc2UpCiAgICBpZiBsZW4obGlzdCkgPiAwICAmJiBsaXN0WzBdID09ICJmdW5jIgogICAgICAgIGxldCByZXMgPSBbXSB8IGZvciBpIGluIHJhbmdlKDEsIGxlbihsaXN0KS0xLCAyKQogICAgICAgICAgICBpZiBsZW4obGlzdCkgPiBpKzEKICAgICAgICAgICAgICAgIGxldCByZXMgPSByZXMgKyBbeyJ3b3JkIjogbGlzdFtpXSwgImluZm8iOiBsaXN0W2krMV19XQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBsZXQgcmVzID0gcmVzICsgW3sid29yZCI6IGxpc3RbaV19XQogICAgICAgICAgICBlbmRpZgogICAgICAgIGVuZGZvcgogICAgICAgIHJldHVybiByZXMKICAgIGVuZGlmCiAgICByZXR1cm4gbGlzdAplbmRmdW5jCnNldCBjb21wbGV0ZWZ1bmM9U2h5Q29tcGxldGUKCiIg5pS26JeP5YiX6KGoCmNhbGwgU2h5RGVmaW5lKCJnOmZhdm9yX25hbWUiLCAiIikKZnVuYyEgU2h5RmF2b3IoKQogICAgbGV0IHpvbmVfbGlzdCA9IFsiYWRkIHpvbmUiXSArIHNwbGl0KFNoeVNlbmQoImZhdm9yIiwgeyJjbWRzIjogInNlbGVjdCJ9KSwgIlxuIikKICAgIGxldCB6b25lX3Nob3cgPSBbXSB8IGZvciBpIGluIHJhbmdlKDAsIGxlbih6b25lX2xpc3QpLTEpCiAgICAgICAgbGV0IHpvbmVfc2hvdyA9IHpvbmVfc2hvdyArIFtwcmludGYoIiVkLiAlcyIsIGksIHpvbmVfbGlzdFtpXSldCiAgICBlbmRmb3IKCiAgICBpZiBsZW4oem9uZV9saXN0KSA+IDEKICAgICAgICBsZXQgaW5kZXggPSBpbnB1dGxpc3Qoem9uZV9zaG93KSB8IGxldCB6b25lID0gem9uZV9saXN0W2luZGV4XQogICAgICAgIGlmIGluZGV4ID09IDAgfCBsZXQgem9uZSA9IGlucHV0KCJ6b25lOiAiLCAi5pWw5o2u57uT5p6EIikgfCBlbmQKICAgIGVsc2UKICAgICAgICBsZXQgem9uZSA9IGlucHV0KCJ6b25lOiAiLCAi5pWw5o2u57uT5p6EIikKICAgIGVuZGlmCgogICAgbGV0IGc6ZmF2b3JfbmFtZSA9IGlucHV0KCJuYW1lOiAiLCBnOmZhdm9yX25hbWUpCiAgICBjYWxsIFNoeVNlbmQoImZhdm9yIiwgeyJjbWRzIjogImluc2VydCIsICJ6b25lIjogem9uZSwgInR5cGUiOiAiZmlsZSIsICJuYW1lIjogZzpmYXZvcl9uYW1lLCAidGV4dCI6IGdldGxpbmUoIi4iKSwgImZpbGUiOiBidWZuYW1lKCIlIiksICJsaW5lIjogZ2V0cG9zKCIuIilbMV19KQplbmRmdW5jCmZ1bmMhIFNoeUZhdm9ycygpCiAgICBsZXQgem9uZV9saXN0ID0gc3BsaXQoU2h5U2VuZCgiZmF2b3IiLCB7ImNtZHMiOiAic2VsZWN0In0pLCAiXG4iKQogICAgbGV0IHpvbmVfc2hvdyA9IFtdIHwgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKHpvbmVfbGlzdCktMSkKICAgICAgICBsZXQgem9uZV9zaG93ID0gem9uZV9zaG93ICsgW3ByaW50ZigiJWQuICVzIiwgaSwgem9uZV9saXN0W2ldKV0KICAgIGVuZGZvcgogICAgbGV0IGluZGV4ID0gaW5wdXRsaXN0KHpvbmVfc2hvdykgfCBsZXQgem9uZSA9IHpvbmVfbGlzdFtpbmRleF0KCiAgICBsZXQgcmVzID0gc3BsaXQoU2h5U2VuZCgiZmF2b3IiLCB7InpvbmUiOiB6b25lfSksICJcbiIpCiAgICBsZXQgcGFnZSA9ICIiIHwgbGV0IG5hbWUgPSAiIgogICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKHJlcyktMSwgMikKICAgICAgICBpZiByZXNbaV0gIT0gcGFnZQogICAgICAgICAgICBpZiBuYW1lICE9ICIiIHwgbGV4cHIgbmFtZSB8IGxvcGVuIHwgbGV0IG5hbWUgPSAiIiB8IGVuZGlmCiAgICAgICAgICAgIGV4ZWN1dGUgZXhpc3RzKCI6VGFib29PcGVuIik/ICJUYWJvb09wZW4gIiAuIHJlc1tpXTogInRhYm5ldyIKICAgICAgICBlbmRpZgogICAgICAgIGxldCBwYWdlID0gcmVzW2ldIHwgbGV0IG5hbWUgLj0gcmVzW2krMV0gLiAiXG4iCiAgICBlbmRmb3IKICAgIGlmIG5hbWUgIT0gIiIgfCBsZXhwciBuYW1lIHwgbGV0IG5hbWUgPSAiIiB8IGVuZGlmCgogICAgbGV0IHZpZXcgPSBpbnB1dGxpc3QoWyLliJfooagiLCAi6buY6K6kIiwgIuWeguebtCIsICLmsLTlubMiXSkKICAgIGZvciBpIGluIHJhbmdlKDAsIGxlbihyZXMpLTEsIDIpIHwgaWYgaSA8IDUKICAgICAgICBpZiBsOnZpZXcgPT0gNCB8IHNwbGl0IHwgbG5leHQgfCBlbHNlaWYgbDp2aWV3ID09IDMgfCB2c3BsaXQgfCBsbmV4dCB8IGVuZGlmCiAgICBlbmRpZiB8IGVuZGZvcgogICAgYm90cmlnaHQgbG9wZW4gfCBpZiBsOnZpZXcgID09IDEgfCBvbmx5IHwgZW5kaWYKZW5kZnVuYwoKIiDmlofku7bmkJzntKIKY2FsbCBTaHlEZWZpbmUoImc6Z3JlcF9kaXIiLCAiLi8iKQpmdW5jISBTaHlHcmVwKHdvcmQpCiAgICBsZXQgZzpncmVwX2RpciA9IGlucHV0KCJkaXI6ICIsIGc6Z3JlcF9kaXIsICJmaWxlIikKICAgIHNpbGVudCBleGVjdXRlICJncmVwIC0tZXhjbHVkZS1kaXI9Jy5naXQnICAtLWV4Y2x1ZGU9Jyouc3dvJyAgLS1leGNsdWRlPScqLnN3cCcgLS1leGNsdWRlPScqLnRhZ3MnIC1ybiAnXFw8IiAuIGlucHV0KCJ3b3JkOiAiLCBhOndvcmQpIC4gIlxcPicgIiAuIGc6Z3JlcF9kaXIKICAgIGNvcGVuCmVuZGZ1bmMKZnVuYyEgU2h5VGFncyhwYXR0ZXJuLCBmbGFncywgaW5mbykKICAgIGxldCBsaW5lID0gZ2V0bGluZSgiLiIpCiAgICBsZXQgZW5kID0gY29sKCIuIikgfCB3aGlsZSBlbmQgPiAwICYmIGxpbmVbZW5kXSA9fiAnXHcnIHwgbGV0IGVuZCAtPSAxIHwgZW5kd2hpbGUKICAgIGxldCBiZWdpbiA9IGVuZCAtIDEgfCB3aGlsZSBiZWdpbiA+IDAgJiYgbGluZVtiZWdpbl0gPX4gJ1x3JyB8IGxldCBiZWdpbiAtPSAxIHwgZW5kd2hpbGUKCiAgICBsZXQgdGFnc19saXN0ID0gc3BsaXQoU2h5U2VuZCgidGFncyIsIHsibW9kdWxlIjogbGluZVtiZWdpbisxOmVuZC0xXSwgInByZSI6IGdldGxpbmUoIi4iKSwgInBhdHRlcm4iOiBhOnBhdHRlcm59KSwgIlxuIikKICAgIGxldCBsaXN0ID0gW10gfCBpZiBsZW4odGFnc19saXN0KSA9PSAwIHwgcmV0dXJuIGxpc3QgfCBlbmRpZgogICAgZm9yIGkgaW4gcmFuZ2UoMCwgbGVuKHRhZ3NfbGlzdCktMSwgMykKICAgICAgICBsZXQgbGlzdCA9IGxpc3QgKyBbIHsgIm5hbWUiOiB0YWdzX2xpc3RbaV0sICJmaWxlbmFtZSI6IHRhZ3NfbGlzdFtpKzFdLCAiY21kIjogdGFnc19saXN0W2krMl0gfSBdCiAgICBlbmRmb3IKICAgIHJldHVybiBsaXN0CmVuZGZ1bmMKIiB9fX0KIiDkuovku7blm57osIN7e3sKY2FsbCBTaHlMb2dpbigpIHwgYXV0b2NtZCEgVmltTGVhdmVQcmUgKiBjYWxsIFNoeUxvZ291dCgpCiIgYXV0b2NtZCBCdWZOZXdGaWxlLEJ1ZlJlYWRQb3N0ICouanMgc2V0IHRhZ2Z1bmM9U2h5VGFncwoKIiBhdXRvY21kISBCdWZSZWFkUG9zdCAqIGNhbGwgU2h5U3luYygicmVhZCIpCiIgYXV0b2NtZCEgQnVmV3JpdGVQcmUgKiBjYWxsIFNoeVN5bmMoIndyaXRlIikKIiBhdXRvY21kISBJbnNlcnRMZWF2ZSAqIGNhbGwgU2h5U3luYygiaW5zZXJ0IikKIiBhdXRvY21kISBDbWRsaW5lTGVhdmUgKiBjYWxsIFNoeVN5bmMoImV4ZWMiKQoifX19CiIg5oyJ6ZSu5pig5bCEe3t7Cm5ub3JlbWFwIDxDLUc+PEMtRz4gOmNhbGwgU2h5R3JlcChleHBhbmQoIjxjd29yZD4iKSk8Q1I+Cm5ub3JlbWFwIDxDLUc+PEMtRj4gOmNhbGwgU2h5RmF2b3IoKTxDUj4Kbm5vcmVtYXAgPEMtRz5mIDpjYWxsIFNoeUZhdm9ycygpPENSPgppbm9yZW1hcCA8Qy1LPiA8Qy1YPjxDLVU+CiJ9fX0KCg==",
        "usr/intshell/dev/vim/css.vim": "aGlnaGxpZ2h0IGNzc0tleSAgICBjdGVybWZnPXllbGxvdwoKc3ludGF4IG1hdGNoIGlzaEtleSAicGFnZSIKc3ludGF4IG1hdGNoIGlzaEtleSAidmlldyIK",
        "usr/intshell/dev/vim/go.vim": "c3ludGF4IG1hdGNoIENvbW1lbnQgIiMuKiQiCnN5bnRheCBtYXRjaCBDb21tZW50ICJcPE5hbWU6IFwiW15cIl0qXCIiCnN5bnRheCBtYXRjaCBDb21tZW50ICJcPEhlbHA6IFwiW15cIl0qXCIiCgpoaWdobGlnaHQga2l0VHlwZSAgICBjdGVybWZnPWxpZ2h0Z3JlZW4Kc3ludGF4IG1hdGNoIGtpdFR5cGUgIlw8QW55XD4iCnN5bnRheCBtYXRjaCBraXRUeXBlICJcPE1hcFw+IgoKaGlnaGxpZ2h0IGtpdENvbnN0ICAgIGN0ZXJtZmc9eWVsbG93CnN5bnRheCBtYXRjaCBraXRDb25zdCAiXDxraXRcLlthLXowLTlBLVpfLl0qIgoKaGlnaGxpZ2h0IG1zZ0NvbnN0ICAgIGN0ZXJtZmc9Y3lhbgpzeW50YXggbWF0Y2ggbXNnQ29uc3QgIlw8aWNlXC5bYS16MC05QS1aXy5dKiIKc3ludGF4IG1hdGNoIG1zZ0NvbnN0ICJcPG1zZ1wuW2EtejAtOUEtWl8uXSoiCnN5bnRheCBtYXRjaCBtc2dDb25zdCAiXDxtXC5bYS16MC05QS1aXy5dKiIKCg==",
        "usr/intshell/dev/vim/iml.vim": "c3ludGF4IG1hdGNoIENvbW1lbnQgIiMuKiQiCnN5bnRheCBtYXRjaCBDb21tZW50ICJcIlteXCJdKlwiIgoKaGlnaGxpZ2h0IHNoeVJpdmVyICAgIGN0ZXJtZmc9cmVkCnN5bnRheCBtYXRjaCBzaHlSaXZlciAiXlthLXpBLVowLTkuXVwrIgoKaGlnaGxpZ2h0IHNoeVN0b3JtICAgIGN0ZXJtZmc9eWVsbG93CnN5bnRheCBtYXRjaCBzaHlTdG9ybSAiXglbYS16QS1aMC05Oi5fXVwrIgoKaGlnaGxpZ2h0IHNoeUNvbW1hbmQgICAgY3Rlcm1mZz1ncmVlbgpzeW50YXggbWF0Y2ggc2h5Q29tbWFuZCAiXgkJW2EtekEtWjAtOTouXy8tXVwrIgoKaGlnaGxpZ2h0IHNoeUFyZ3MgICAgY3Rlcm1mZz1jeWFuCnN5bnRheCBtYXRjaCBzaHlBcmdzICJuYW1lIgpzeW50YXggbWF0Y2ggc2h5QXJncyAiYXJncyIKCg==",
        "usr/intshell/dev/vim/javascript.vim": "c3ludGF4IG1hdGNoIENvbW1lbnQgIlw8c2h5KFwiW15cIl0qXCIiCnN5bnRheCBtYXRjaCBDb21tZW50ICJcPG5hbWU6IFwiW15cIl0qXCIiCnN5bnRheCBtYXRjaCBDb21tZW50ICJcPGhlbHA6IFwiW15cIl0qXCIiCnN5bnRheCBtYXRjaCBDb21tZW50ICJcPFZvbGNhbm9zKFwiW15cIl0qXCIiCgpoaWdobGlnaHQgY2FuQ29uc3QgICAgY3Rlcm1mZz15ZWxsb3cKc3ludGF4IG1hdGNoIGNhbkNvbnN0ICJcPGNhblw+IgpzeW50YXggbWF0Y2ggY2FuQ29uc3QgIlw8c3ViXD4iCnN5bnRheCBtYXRjaCBjYW5Db25zdCAiXDxtc2dcPiIKc3ludGF4IG1hdGNoIGNhbkNvbnN0ICJcPHJlc1w+IgpzeW50YXggbWF0Y2ggY2FuQ29uc3QgIlw8dGFyZ2V0XD4iCgpoaWdobGlnaHQga2l0Q29uc3QgICAgY3Rlcm1mZz15ZWxsb3cKc3ludGF4IG1hdGNoIGtpdENvbnN0ICJcPGtpdFwuW2EtejAtOUEtWl8uXSoiCgoKaGlnaGxpZ2h0IG1zZ0NvbnN0ICAgIGN0ZXJtZmc9Y3lhbgpzeW50YXggbWF0Y2ggbXNnQ29uc3QgIlw8bVwuW2EtejAtOUEtWl8uXSoiCnN5bnRheCBtYXRjaCBtc2dDb25zdCAiXDxtc2dcLlthLXowLTlBLVpfLl0qIgpzeW50YXggbWF0Y2ggbXNnQ29uc3QgIlw8cmVzXC5bYS16MC05QS1aXy5dKiIKc3ludGF4IG1hdGNoIG1zZ0NvbnN0ICJcPGNhblwuW2EtejAtOUEtWl9dKiIKc3ludGF4IG1hdGNoIG1zZ0NvbnN0ICJcPHN1YlwuW2EtejAtOUEtWl8uXSoiCnN5bnRheCBtYXRjaCBtc2dDb25zdCAiXDxjYlw+IgpzeW50YXggbWF0Y2ggbXNnQ29uc3QgIlw8Y2JzXD4iCgpzeW50YXggbWF0Y2ggY2FuQ29uc3QgIlw8Y2FuXC5iYXNlIgpzeW50YXggbWF0Y2ggY2FuQ29uc3QgIlw8Y2FuXC5jb3JlIgpzeW50YXggbWF0Y2ggY2FuQ29uc3QgIlw8Y2FuXC5taXNjIgpzeW50YXggbWF0Y2ggY2FuQ29uc3QgIlw8Y2FuXC5wYWdlIgpzeW50YXggbWF0Y2ggY2FuQ29uc3QgIlw8Y2FuXC51c2VyIgoK",
        "usr/intshell/dev/vim/plug.vim": "IiB2aW0tcGx1ZzogVmltIHBsdWdpbiBtYW5hZ2VyCiIgPT09PT09PT09PT09PT09PT09PT09PT09PT09PQoiCiIgRG93bmxvYWQgcGx1Zy52aW0gYW5kIHB1dCBpdCBpbiB+Ly52aW0vYXV0b2xvYWQKIgoiICAgY3VybCAtZkxvIH4vLnZpbS9hdXRvbG9hZC9wbHVnLnZpbSAtLWNyZWF0ZS1kaXJzIFwKIiAgICAgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2p1bmVndW5uL3ZpbS1wbHVnL21hc3Rlci9wbHVnLnZpbQoiCiIgRWRpdCB5b3VyIC52aW1yYwoiCiIgICBjYWxsIHBsdWcjYmVnaW4oJ34vLnZpbS9wbHVnZ2VkJykKIgoiICAgIiBNYWtlIHN1cmUgeW91IHVzZSBzaW5nbGUgcXVvdGVzCiIKIiAgICIgU2hvcnRoYW5kIG5vdGF0aW9uOyBmZXRjaGVzIGh0dHBzOi8vZ2l0aHViLmNvbS9qdW5lZ3Vubi92aW0tZWFzeS1hbGlnbgoiICAgUGx1ZyAnanVuZWd1bm4vdmltLWVhc3ktYWxpZ24nCiIKIiAgICIgQW55IHZhbGlkIGdpdCBVUkwgaXMgYWxsb3dlZAoiICAgUGx1ZyAnaHR0cHM6Ly9naXRodWIuY29tL2p1bmVndW5uL3ZpbS1naXRodWItZGFzaGJvYXJkLmdpdCcKIgoiICAgIiBNdWx0aXBsZSBQbHVnIGNvbW1hbmRzIGNhbiBiZSB3cml0dGVuIGluIGEgc2luZ2xlIGxpbmUgdXNpbmcgfCBzZXBhcmF0b3JzCiIgICBQbHVnICdTaXJWZXIvdWx0aXNuaXBzJyB8IFBsdWcgJ2hvbnphL3ZpbS1zbmlwcGV0cycKIgoiICAgIiBPbi1kZW1hbmQgbG9hZGluZwoiICAgUGx1ZyAnc2Nyb29sb29zZS9uZXJkdHJlZScsIHsgJ29uJzogICdORVJEVHJlZVRvZ2dsZScgfQoiICAgUGx1ZyAndHBvcGUvdmltLWZpcmVwbGFjZScsIHsgJ2Zvcic6ICdjbG9qdXJlJyB9CiIKIiAgICIgVXNpbmcgYSBub24tbWFzdGVyIGJyYW5jaAoiICAgUGx1ZyAncmRuZXR0by9ZQ00tR2VuZXJhdG9yJywgeyAnYnJhbmNoJzogJ3N0YWJsZScgfQoiCiIgICAiIFVzaW5nIGEgdGFnZ2VkIHJlbGVhc2U7IHdpbGRjYXJkIGFsbG93ZWQgKHJlcXVpcmVzIGdpdCAxLjkuMiBvciBhYm92ZSkKIiAgIFBsdWcgJ2ZhdGloL3ZpbS1nbycsIHsgJ3RhZyc6ICcqJyB9CiIKIiAgICIgUGx1Z2luIG9wdGlvbnMKIiAgIFBsdWcgJ25zZi9nb2NvZGUnLCB7ICd0YWcnOiAndi4yMDE1MDMwMycsICdydHAnOiAndmltJyB9CiIKIiAgICIgUGx1Z2luIG91dHNpZGUgfi8udmltL3BsdWdnZWQgd2l0aCBwb3N0LXVwZGF0ZSBob29rCiIgICBQbHVnICdqdW5lZ3Vubi9memYnLCB7ICdkaXInOiAnfi8uZnpmJywgJ2RvJzogJy4vaW5zdGFsbCAtLWFsbCcgfQoiCiIgICAiIFVubWFuYWdlZCBwbHVnaW4gKG1hbnVhbGx5IGluc3RhbGxlZCBhbmQgdXBkYXRlZCkKIiAgIFBsdWcgJ34vbXktcHJvdG90eXBlLXBsdWdpbicKIgoiICAgIiBJbml0aWFsaXplIHBsdWdpbiBzeXN0ZW0KIiAgIGNhbGwgcGx1ZyNlbmQoKQoiCiIgVGhlbiByZWxvYWQgLnZpbXJjIGFuZCA6UGx1Z0luc3RhbGwgdG8gaW5zdGFsbCBwbHVnaW5zLgoiCiIgUGx1ZyBvcHRpb25zOgoiCiJ8IE9wdGlvbiAgICAgICAgICAgICAgICAgIHwgRGVzY3JpcHRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwKInwgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gfCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gfAoifCBgYnJhbmNoYC9gdGFnYC9gY29tbWl0YCB8IEJyYW5jaC90YWcvY29tbWl0IG9mIHRoZSByZXBvc2l0b3J5IHRvIHVzZSAgICAgICB8CiJ8IGBydHBgICAgICAgICAgICAgICAgICAgIHwgU3ViZGlyZWN0b3J5IHRoYXQgY29udGFpbnMgVmltIHBsdWdpbiAgICAgICAgICAgIHwKInwgYGRpcmAgICAgICAgICAgICAgICAgICAgfCBDdXN0b20gZGlyZWN0b3J5IGZvciB0aGUgcGx1Z2luICAgICAgICAgICAgICAgICAgfAoifCBgYXNgICAgICAgICAgICAgICAgICAgICB8IFVzZSBkaWZmZXJlbnQgbmFtZSBmb3IgdGhlIHBsdWdpbiAgICAgICAgICAgICAgICB8CiJ8IGBkb2AgICAgICAgICAgICAgICAgICAgIHwgUG9zdC11cGRhdGUgaG9vayAoc3RyaW5nIG9yIGZ1bmNyZWYpICAgICAgICAgICAgIHwKInwgYG9uYCAgICAgICAgICAgICAgICAgICAgfCBPbi1kZW1hbmQgbG9hZGluZzogQ29tbWFuZHMgb3IgYDxQbHVnPmAtbWFwcGluZ3MgfAoifCBgZm9yYCAgICAgICAgICAgICAgICAgICB8IE9uLWRlbWFuZCBsb2FkaW5nOiBGaWxlIHR5cGVzICAgICAgICAgICAgICAgICAgICB8CiJ8IGBmcm96ZW5gICAgICAgICAgICAgICAgIHwgRG8gbm90IHVwZGF0ZSB1bmxlc3MgZXhwbGljaXRseSBzcGVjaWZpZWQgICAgICAgIHwKIgoiIE1vcmUgaW5mb3JtYXRpb246IGh0dHBzOi8vZ2l0aHViLmNvbS9qdW5lZ3Vubi92aW0tcGx1ZwoiCiIKIiBDb3B5cmlnaHQgKGMpIDIwMTcgSnVuZWd1bm4gQ2hvaQoiCiIgTUlUIExpY2Vuc2UKIgoiIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZwoiIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZQoiICJTb2Z0d2FyZSIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKIiB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCiIgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvCiIgcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvCiIgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoiCiIgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUKIiBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KIgoiIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELAoiIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgoiIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5ECiIgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRQoiIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04KIiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04KIiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS4KCmlmIGV4aXN0cygnZzpsb2FkZWRfcGx1ZycpCiAgZmluaXNoCmVuZGlmCmxldCBnOmxvYWRlZF9wbHVnID0gMQoKbGV0IHM6Y3BvX3NhdmUgPSAmY3BvCnNldCBjcG8mdmltCgpsZXQgczpwbHVnX3NyYyA9ICdodHRwczovL2dpdGh1Yi5jb20vanVuZWd1bm4vdmltLXBsdWcuZ2l0JwpsZXQgczpwbHVnX3RhYiA9IGdldChzOiwgJ3BsdWdfdGFiJywgLTEpCmxldCBzOnBsdWdfYnVmID0gZ2V0KHM6LCAncGx1Z19idWYnLCAtMSkKbGV0IHM6bWFjX2d1aSA9IGhhcygnZ3VpX21hY3ZpbScpICYmIGhhcygnZ3VpX3J1bm5pbmcnKQpsZXQgczppc193aW4gPSBoYXMoJ3dpbjMyJykKbGV0IHM6bnZpbSA9IGhhcygnbnZpbS0wLjInKSB8fCAoaGFzKCdudmltJykgJiYgZXhpc3RzKCcqam9id2FpdCcpICYmICFzOmlzX3dpbikKbGV0IHM6dmltOCA9IGhhcygncGF0Y2gtOC4wLjAwMzknKSAmJiBleGlzdHMoJypqb2Jfc3RhcnQnKQppZiBzOmlzX3dpbiAmJiAmc2hlbGxzbGFzaAogIHNldCBub3NoZWxsc2xhc2gKICBsZXQgczptZSA9IHJlc29sdmUoZXhwYW5kKCc8c2ZpbGU+OnAnKSkKICBzZXQgc2hlbGxzbGFzaAplbHNlCiAgbGV0IHM6bWUgPSByZXNvbHZlKGV4cGFuZCgnPHNmaWxlPjpwJykpCmVuZGlmCmxldCBzOmJhc2Vfc3BlYyA9IHsgJ2JyYW5jaCc6ICdtYXN0ZXInLCAnZnJvemVuJzogMCB9CmxldCBzOlRZUEUgPSB7ClwgICAnc3RyaW5nJzogIHR5cGUoJycpLApcICAgJ2xpc3QnOiAgICB0eXBlKFtdKSwKXCAgICdkaWN0JzogICAgdHlwZSh7fSksClwgICAnZnVuY3JlZic6IHR5cGUoZnVuY3Rpb24oJ2NhbGwnKSkKXCB9CmxldCBzOmxvYWRlZCA9IGdldChzOiwgJ2xvYWRlZCcsIHt9KQpsZXQgczp0cmlnZ2VycyA9IGdldChzOiwgJ3RyaWdnZXJzJywge30pCgppZiBzOmlzX3dpbgogIGZ1bmN0aW9uISBzOnBsdWdfY2FsbChmbiwgLi4uKQogICAgbGV0IHNoZWxsc2xhc2ggPSAmc2hlbGxzbGFzaAogICAgdHJ5CiAgICAgIHNldCBub3NoZWxsc2xhc2gKICAgICAgcmV0dXJuIGNhbGwoYTpmbiwgYTowMDApCiAgICBmaW5hbGx5CiAgICAgIGxldCAmc2hlbGxzbGFzaCA9IHNoZWxsc2xhc2gKICAgIGVuZHRyeQogIGVuZGZ1bmN0aW9uCmVsc2UKICBmdW5jdGlvbiEgczpwbHVnX2NhbGwoZm4sIC4uLikKICAgIHJldHVybiBjYWxsKGE6Zm4sIGE6MDAwKQogIGVuZGZ1bmN0aW9uCmVuZGlmCgpmdW5jdGlvbiEgczpwbHVnX2dldGN3ZCgpCiAgcmV0dXJuIHM6cGx1Z19jYWxsKCdnZXRjd2QnKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cGx1Z19mbmFtZW1vZGlmeShmbmFtZSwgbW9kcykKICByZXR1cm4gczpwbHVnX2NhbGwoJ2ZuYW1lbW9kaWZ5JywgYTpmbmFtZSwgYTptb2RzKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cGx1Z19leHBhbmQoZm10KQogIHJldHVybiBzOnBsdWdfY2FsbCgnZXhwYW5kJywgYTpmbXQsIDEpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpwbHVnX3RlbXBuYW1lKCkKICByZXR1cm4gczpwbHVnX2NhbGwoJ3RlbXBuYW1lJykKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBwbHVnI2JlZ2luKC4uLikKICBpZiBhOjAgPiAwCiAgICBsZXQgczpwbHVnX2hvbWVfb3JnID0gYToxCiAgICBsZXQgaG9tZSA9IHM6cGF0aChzOnBsdWdfZm5hbWVtb2RpZnkoczpwbHVnX2V4cGFuZChhOjEpLCAnOnAnKSkKICBlbHNlaWYgZXhpc3RzKCdnOnBsdWdfaG9tZScpCiAgICBsZXQgaG9tZSA9IHM6cGF0aChnOnBsdWdfaG9tZSkKICBlbHNlaWYgIWVtcHR5KCZydHApCiAgICBsZXQgaG9tZSA9IHM6cGF0aChzcGxpdCgmcnRwLCAnLCcpWzBdKSAuICcvcGx1Z2dlZCcKICBlbHNlCiAgICByZXR1cm4gczplcnIoJ1VuYWJsZSB0byBkZXRlcm1pbmUgcGx1ZyBob21lLiBUcnkgY2FsbGluZyBwbHVnI2JlZ2luKCkgd2l0aCBhIHBhdGggYXJndW1lbnQuJykKICBlbmRpZgogIGlmIHM6cGx1Z19mbmFtZW1vZGlmeShob21lLCAnOnQnKSA9PSMgJ3BsdWdpbicgJiYgczpwbHVnX2ZuYW1lbW9kaWZ5KGhvbWUsICc6aCcpID09IyBzOmZpcnN0X3J0cAogICAgcmV0dXJuIHM6ZXJyKCdJbnZhbGlkIHBsdWcgaG9tZS4gJy5ob21lLicgaXMgYSBzdGFuZGFyZCBWaW0gcnVudGltZSBwYXRoIGFuZCBpcyBub3QgYWxsb3dlZC4nKQogIGVuZGlmCgogIGxldCBnOnBsdWdfaG9tZSA9IGhvbWUKICBsZXQgZzpwbHVncyA9IHt9CiAgbGV0IGc6cGx1Z3Nfb3JkZXIgPSBbXQogIGxldCBzOnRyaWdnZXJzID0ge30KCiAgY2FsbCBzOmRlZmluZV9jb21tYW5kcygpCiAgcmV0dXJuIDEKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmRlZmluZV9jb21tYW5kcygpCiAgY29tbWFuZCEgLW5hcmdzPSsgLWJhciBQbHVnIGNhbGwgcGx1ZyMoPGFyZ3M+KQogIGlmICFleGVjdXRhYmxlKCdnaXQnKQogICAgcmV0dXJuIHM6ZXJyKCdgZ2l0YCBleGVjdXRhYmxlIG5vdCBmb3VuZC4gTW9zdCBjb21tYW5kcyB3aWxsIG5vdCBiZSBhdmFpbGFibGUuIFRvIHN1cHByZXNzIHRoaXMgbWVzc2FnZSwgcHJlcGVuZCBgc2lsZW50IWAgdG8gYGNhbGwgcGx1ZyNiZWdpbiguLi4pYC4nKQogIGVuZGlmCiAgaWYgaGFzKCd3aW4zMicpCiAgXCAmJiAmc2hlbGxzbGFzaAogIFwgJiYgKCZzaGVsbCA9fiMgJ2NtZFwuZXhlJyB8fCAmc2hlbGwgPX4jICdwb3dlcnNoZWxsXC5leGUnKQogICAgcmV0dXJuIHM6ZXJyKCd2aW0tcGx1ZyBkb2VzIG5vdCBzdXBwb3J0IHNoZWxsLCAnIC4gJnNoZWxsIC4gJywgd2hlbiBzaGVsbHNsYXNoIGlzIHNldC4nKQogIGVuZGlmCiAgaWYgIWhhcygnbnZpbScpCiAgICBcICYmIChoYXMoJ3dpbjMyJykgfHwgaGFzKCd3aW4zMnVuaXgnKSkKICAgIFwgJiYgIWhhcygnbXVsdGlfYnl0ZScpCiAgICByZXR1cm4gczplcnIoJ1ZpbSBuZWVkcyArbXVsdGlfYnl0ZSBmZWF0dXJlIG9uIFdpbmRvd3MgdG8gcnVuIHNoZWxsIGNvbW1hbmRzLiBFbmFibGUgK2ljb252IGZvciBiZXN0IHJlc3VsdHMuJykKICBlbmRpZgogIGNvbW1hbmQhIC1uYXJncz0qIC1iYXIgLWJhbmcgLWNvbXBsZXRlPWN1c3RvbWxpc3QsczpuYW1lcyBQbHVnSW5zdGFsbCBjYWxsIHM6aW5zdGFsbCg8YmFuZz4wLCBbPGYtYXJncz5dKQogIGNvbW1hbmQhIC1uYXJncz0qIC1iYXIgLWJhbmcgLWNvbXBsZXRlPWN1c3RvbWxpc3QsczpuYW1lcyBQbHVnVXBkYXRlICBjYWxsIHM6dXBkYXRlKDxiYW5nPjAsIFs8Zi1hcmdzPl0pCiAgY29tbWFuZCEgLW5hcmdzPTAgLWJhciAtYmFuZyBQbHVnQ2xlYW4gY2FsbCBzOmNsZWFuKDxiYW5nPjApCiAgY29tbWFuZCEgLW5hcmdzPTAgLWJhciBQbHVnVXBncmFkZSBpZiBzOnVwZ3JhZGUoKSB8IGV4ZWN1dGUgJ3NvdXJjZScgczplc2MoczptZSkgfCBlbmRpZgogIGNvbW1hbmQhIC1uYXJncz0wIC1iYXIgUGx1Z1N0YXR1cyAgY2FsbCBzOnN0YXR1cygpCiAgY29tbWFuZCEgLW5hcmdzPTAgLWJhciBQbHVnRGlmZiAgICBjYWxsIHM6ZGlmZigpCiAgY29tbWFuZCEgLW5hcmdzPT8gLWJhciAtYmFuZyAtY29tcGxldGU9ZmlsZSBQbHVnU25hcHNob3QgY2FsbCBzOnNuYXBzaG90KDxiYW5nPjAsIDxmLWFyZ3M+KQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6dG9fYSh2KQogIHJldHVybiB0eXBlKGE6dikgPT0gczpUWVBFLmxpc3QgPyBhOnYgOiBbYTp2XQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6dG9fcyh2KQogIHJldHVybiB0eXBlKGE6dikgPT0gczpUWVBFLnN0cmluZyA/IGE6diA6IGpvaW4oYTp2LCAiXG4iKSAuICJcbiIKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmdsb2IoZnJvbSwgcGF0dGVybikKICByZXR1cm4gczpsaW5lcyhnbG9icGF0aChhOmZyb20sIGE6cGF0dGVybikpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpzb3VyY2UoZnJvbSwgLi4uKQogIGxldCBmb3VuZCA9IDAKICBmb3IgcGF0dGVybiBpbiBhOjAwMAogICAgZm9yIHZpbSBpbiBzOmdsb2IoYTpmcm9tLCBwYXR0ZXJuKQogICAgICBleGVjdXRlICdzb3VyY2UnIHM6ZXNjKHZpbSkKICAgICAgbGV0IGZvdW5kID0gMQogICAgZW5kZm9yCiAgZW5kZm9yCiAgcmV0dXJuIGZvdW5kCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczphc3NvYyhkaWN0LCBrZXksIHZhbCkKICBsZXQgYTpkaWN0W2E6a2V5XSA9IGFkZChnZXQoYTpkaWN0LCBhOmtleSwgW10pLCBhOnZhbCkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmFzayhtZXNzYWdlLCAuLi4pCiAgY2FsbCBpbnB1dHNhdmUoKQogIGVjaG9obCBXYXJuaW5nTXNnCiAgbGV0IGFuc3dlciA9IGlucHV0KGE6bWVzc2FnZS4oYTowID8gJyAoeS9OL2EpICcgOiAnICh5L04pICcpKQogIGVjaG9obCBOb25lCiAgY2FsbCBpbnB1dHJlc3RvcmUoKQogIGVjaG8gIlxyIgogIHJldHVybiAoYTowICYmIGFuc3dlciA9fj8gJ15hJykgPyAyIDogKGFuc3dlciA9fj8gJ155JykgPyAxIDogMAplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6YXNrX25vX2ludGVycnVwdCguLi4pCiAgdHJ5CiAgICByZXR1cm4gY2FsbCgnczphc2snLCBhOjAwMCkKICBjYXRjaAogICAgcmV0dXJuIDAKICBlbmR0cnkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmxhenkocGx1Zywgb3B0KQogIHJldHVybiBoYXNfa2V5KGE6cGx1ZywgYTpvcHQpICYmCiAgICAgICAgXCAoZW1wdHkoczp0b19hKGE6cGx1Z1thOm9wdF0pKSAgICAgICAgIHx8CiAgICAgICAgXCAgIWlzZGlyZWN0b3J5KGE6cGx1Zy5kaXIpICAgICAgICAgICAgIHx8CiAgICAgICAgXCAgbGVuKHM6Z2xvYihzOnJ0cChhOnBsdWcpLCAncGx1Z2luJykpIHx8CiAgICAgICAgXCAgbGVuKHM6Z2xvYihzOnJ0cChhOnBsdWcpLCAnYWZ0ZXIvcGx1Z2luJykpKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHBsdWcjZW5kKCkKICBpZiAhZXhpc3RzKCdnOnBsdWdzJykKICAgIHJldHVybiBzOmVycigncGx1ZyNlbmQoKSBjYWxsZWQgd2l0aG91dCBjYWxsaW5nIHBsdWcjYmVnaW4oKSBmaXJzdCcpCiAgZW5kaWYKCiAgaWYgZXhpc3RzKCcjUGx1Z0xPRCcpCiAgICBhdWdyb3VwIFBsdWdMT0QKICAgICAgYXV0b2NtZCEKICAgIGF1Z3JvdXAgRU5ECiAgICBhdWdyb3VwISBQbHVnTE9ECiAgZW5kaWYKICBsZXQgbG9kID0geyAnZnQnOiB7fSwgJ21hcCc6IHt9LCAnY21kJzoge30gfQoKICBpZiBleGlzdHMoJ2c6ZGlkX2xvYWRfZmlsZXR5cGVzJykKICAgIGZpbGV0eXBlIG9mZgogIGVuZGlmCiAgZm9yIG5hbWUgaW4gZzpwbHVnc19vcmRlcgogICAgaWYgIWhhc19rZXkoZzpwbHVncywgbmFtZSkKICAgICAgY29udGludWUKICAgIGVuZGlmCiAgICBsZXQgcGx1ZyA9IGc6cGx1Z3NbbmFtZV0KICAgIGlmIGdldChzOmxvYWRlZCwgbmFtZSwgMCkgfHwgIXM6bGF6eShwbHVnLCAnb24nKSAmJiAhczpsYXp5KHBsdWcsICdmb3InKQogICAgICBsZXQgczpsb2FkZWRbbmFtZV0gPSAxCiAgICAgIGNvbnRpbnVlCiAgICBlbmRpZgoKICAgIGlmIGhhc19rZXkocGx1ZywgJ29uJykKICAgICAgbGV0IHM6dHJpZ2dlcnNbbmFtZV0gPSB7ICdtYXAnOiBbXSwgJ2NtZCc6IFtdIH0KICAgICAgZm9yIGNtZCBpbiBzOnRvX2EocGx1Zy5vbikKICAgICAgICBpZiBjbWQgPX4/ICdePFBsdWc+LlwrJwogICAgICAgICAgaWYgZW1wdHkobWFwY2hlY2soY21kKSkgJiYgZW1wdHkobWFwY2hlY2soY21kLCAnaScpKQogICAgICAgICAgICBjYWxsIHM6YXNzb2MobG9kLm1hcCwgY21kLCBuYW1lKQogICAgICAgICAgZW5kaWYKICAgICAgICAgIGNhbGwgYWRkKHM6dHJpZ2dlcnNbbmFtZV0ubWFwLCBjbWQpCiAgICAgICAgZWxzZWlmIGNtZCA9fiMgJ15bQS1aXScKICAgICAgICAgIGxldCBjbWQgPSBzdWJzdGl0dXRlKGNtZCwgJyEqJCcsICcnLCAnJykKICAgICAgICAgIGlmIGV4aXN0cygnOicuY21kKSAhPSAyCiAgICAgICAgICAgIGNhbGwgczphc3NvYyhsb2QuY21kLCBjbWQsIG5hbWUpCiAgICAgICAgICBlbmRpZgogICAgICAgICAgY2FsbCBhZGQoczp0cmlnZ2Vyc1tuYW1lXS5jbWQsIGNtZCkKICAgICAgICBlbHNlCiAgICAgICAgICBjYWxsIHM6ZXJyKCdJbnZhbGlkIGBvbmAgb3B0aW9uOiAnLmNtZC4KICAgICAgICAgIFwgJy4gU2hvdWxkIHN0YXJ0IHdpdGggYW4gdXBwZXJjYXNlIGxldHRlciBvciBgPFBsdWc+YC4nKQogICAgICAgIGVuZGlmCiAgICAgIGVuZGZvcgogICAgZW5kaWYKCiAgICBpZiBoYXNfa2V5KHBsdWcsICdmb3InKQogICAgICBsZXQgdHlwZXMgPSBzOnRvX2EocGx1Zy5mb3IpCiAgICAgIGlmICFlbXB0eSh0eXBlcykKICAgICAgICBhdWdyb3VwIGZpbGV0eXBlZGV0ZWN0CiAgICAgICAgY2FsbCBzOnNvdXJjZShzOnJ0cChwbHVnKSwgJ2Z0ZGV0ZWN0LyoqLyoudmltJywgJ2FmdGVyL2Z0ZGV0ZWN0LyoqLyoudmltJykKICAgICAgICBhdWdyb3VwIEVORAogICAgICBlbmRpZgogICAgICBmb3IgdHlwZSBpbiB0eXBlcwogICAgICAgIGNhbGwgczphc3NvYyhsb2QuZnQsIHR5cGUsIG5hbWUpCiAgICAgIGVuZGZvcgogICAgZW5kaWYKICBlbmRmb3IKCiAgZm9yIFtjbWQsIG5hbWVzXSBpbiBpdGVtcyhsb2QuY21kKQogICAgZXhlY3V0ZSBwcmludGYoCiAgICBcICdjb21tYW5kISAtbmFyZ3M9KiAtcmFuZ2UgLWJhbmcgLWNvbXBsZXRlPWZpbGUgJXMgY2FsbCBzOmxvZF9jbWQoJXMsICI8YmFuZz4iLCA8bGluZTE+LCA8bGluZTI+LCA8cS1hcmdzPiwgJXMpJywKICAgIFwgY21kLCBzdHJpbmcoY21kKSwgc3RyaW5nKG5hbWVzKSkKICBlbmRmb3IKCiAgZm9yIFttYXAsIG5hbWVzXSBpbiBpdGVtcyhsb2QubWFwKQogICAgZm9yIFttb2RlLCBtYXBfcHJlZml4LCBrZXlfcHJlZml4XSBpbgogICAgICAgICAgXCBbWydpJywgJzxDLU8+JywgJyddLCBbJ24nLCAnJywgJyddLCBbJ3YnLCAnJywgJ2d2J10sIFsnbycsICcnLCAnJ11dCiAgICAgIGV4ZWN1dGUgcHJpbnRmKAogICAgICBcICclc25vcmVtYXAgPHNpbGVudD4gJXMgJXM6PEMtVT5jYWxsIDxTSUQ+bG9kX21hcCglcywgJXMsICVzLCAiJXMiKTxDUj4nLAogICAgICBcIG1vZGUsIG1hcCwgbWFwX3ByZWZpeCwgc3RyaW5nKG1hcCksIHN0cmluZyhuYW1lcyksIG1vZGUgIT0gJ2knLCBrZXlfcHJlZml4KQogICAgZW5kZm9yCiAgZW5kZm9yCgogIGZvciBbZnQsIG5hbWVzXSBpbiBpdGVtcyhsb2QuZnQpCiAgICBhdWdyb3VwIFBsdWdMT0QKICAgICAgZXhlY3V0ZSBwcmludGYoJ2F1dG9jbWQgRmlsZVR5cGUgJXMgY2FsbCA8U0lEPmxvZF9mdCglcywgJXMpJywKICAgICAgICAgICAgXCBmdCwgc3RyaW5nKGZ0KSwgc3RyaW5nKG5hbWVzKSkKICAgIGF1Z3JvdXAgRU5ECiAgZW5kZm9yCgogIGNhbGwgczpyZW9yZ19ydHAoKQogIGZpbGV0eXBlIHBsdWdpbiBpbmRlbnQgb24KICBpZiBoYXMoJ3ZpbV9zdGFydGluZycpCiAgICBpZiBoYXMoJ3N5bnRheCcpICYmICFleGlzdHMoJ2c6c3ludGF4X29uJykKICAgICAgc3ludGF4IGVuYWJsZQogICAgZW5kCiAgZWxzZQogICAgY2FsbCBzOnJlbG9hZF9wbHVnaW5zKCkKICBlbmRpZgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6bG9hZGVkX25hbWVzKCkKICByZXR1cm4gZmlsdGVyKGNvcHkoZzpwbHVnc19vcmRlciksICdnZXQoczpsb2FkZWQsIHY6dmFsLCAwKScpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpsb2FkX3BsdWdpbihzcGVjKQogIGNhbGwgczpzb3VyY2UoczpydHAoYTpzcGVjKSwgJ3BsdWdpbi8qKi8qLnZpbScsICdhZnRlci9wbHVnaW4vKiovKi52aW0nKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cmVsb2FkX3BsdWdpbnMoKQogIGZvciBuYW1lIGluIHM6bG9hZGVkX25hbWVzKCkKICAgIGNhbGwgczpsb2FkX3BsdWdpbihnOnBsdWdzW25hbWVdKQogIGVuZGZvcgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6dHJpbShzdHIpCiAgcmV0dXJuIHN1YnN0aXR1dGUoYTpzdHIsICdbXC9dXCskJywgJycsICcnKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6dmVyc2lvbl9yZXF1aXJlbWVudCh2YWwsIG1pbikKICBmb3IgaWR4IGluIHJhbmdlKDAsIGxlbihhOm1pbikgLSAxKQogICAgbGV0IHYgPSBnZXQoYTp2YWwsIGlkeCwgMCkKICAgIGlmICAgICB2IDwgYTptaW5baWR4XSB8IHJldHVybiAwCiAgICBlbHNlaWYgdiA+IGE6bWluW2lkeF0gfCByZXR1cm4gMQogICAgZW5kaWYKICBlbmRmb3IKICByZXR1cm4gMQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6Z2l0X3ZlcnNpb25fcmVxdWlyZW1lbnQoLi4uKQogIGlmICFleGlzdHMoJ3M6Z2l0X3ZlcnNpb24nKQogICAgbGV0IHM6Z2l0X3ZlcnNpb24gPSBtYXAoc3BsaXQoc3BsaXQoczpzeXN0ZW0oJ2dpdCAtLXZlcnNpb24nKSlbMl0sICdcLicpLCAnc3RyMm5yKHY6dmFsKScpCiAgZW5kaWYKICByZXR1cm4gczp2ZXJzaW9uX3JlcXVpcmVtZW50KHM6Z2l0X3ZlcnNpb24sIGE6MDAwKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cHJvZ3Jlc3Nfb3B0KGJhc2UpCiAgcmV0dXJuIGE6YmFzZSAmJiAhczppc193aW4gJiYKICAgICAgICBcIHM6Z2l0X3ZlcnNpb25fcmVxdWlyZW1lbnQoMSwgNywgMSkgPyAnLS1wcm9ncmVzcycgOiAnJwplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cnRwKHNwZWMpCiAgcmV0dXJuIHM6cGF0aChhOnNwZWMuZGlyIC4gZ2V0KGE6c3BlYywgJ3J0cCcsICcnKSkKZW5kZnVuY3Rpb24KCmlmIHM6aXNfd2luCiAgZnVuY3Rpb24hIHM6cGF0aChwYXRoKQogICAgcmV0dXJuIHM6dHJpbShzdWJzdGl0dXRlKGE6cGF0aCwgJy8nLCAnXCcsICdnJykpCiAgZW5kZnVuY3Rpb24KCiAgZnVuY3Rpb24hIHM6ZGlycGF0aChwYXRoKQogICAgcmV0dXJuIHM6cGF0aChhOnBhdGgpIC4gJ1wnCiAgZW5kZnVuY3Rpb24KCiAgZnVuY3Rpb24hIHM6aXNfbG9jYWxfcGx1ZyhyZXBvKQogICAgcmV0dXJuIGE6cmVwbyA9fj8gJ15bYS16XTpcfF5bJX5dJwogIGVuZGZ1bmN0aW9uCgogICIgQ29waWVkIGZyb20gZnpmCiAgZnVuY3Rpb24hIHM6d3JhcF9jbWRzKGNtZHMpCiAgICBsZXQgY21kcyA9IFsKICAgICAgXCAnQGVjaG8gb2ZmJywKICAgICAgXCAnc2V0bG9jYWwgZW5hYmxlZGVsYXllZGV4cGFuc2lvbiddCiAgICBcICsgKHR5cGUoYTpjbWRzKSA9PSB0eXBlKFtdKSA/IGE6Y21kcyA6IFthOmNtZHNdKQogICAgXCArIFsnZW5kbG9jYWwnXQogICAgaWYgaGFzKCdpY29udicpCiAgICAgIGlmICFleGlzdHMoJ3M6Y29kZXBhZ2UnKQogICAgICAgIGxldCBzOmNvZGVwYWdlID0gbGliY2FsbG5yKCdrZXJuZWwzMi5kbGwnLCAnR2V0QUNQJywgMCkKICAgICAgZW5kaWYKICAgICAgcmV0dXJuIG1hcChjbWRzLCBwcmludGYoJ2ljb252KHY6dmFsLiJcciIsICIlcyIsICJjcCVkIiknLCAmZW5jb2RpbmcsIHM6Y29kZXBhZ2UpKQogICAgZW5kaWYKICAgIHJldHVybiBtYXAoY21kcywgJ3Y6dmFsLiJcciInKQogIGVuZGZ1bmN0aW9uCgogIGZ1bmN0aW9uISBzOmJhdGNoZmlsZShjbWQpCiAgICBsZXQgYmF0Y2hmaWxlID0gczpwbHVnX3RlbXBuYW1lKCkuJy5iYXQnCiAgICBjYWxsIHdyaXRlZmlsZShzOndyYXBfY21kcyhhOmNtZCksIGJhdGNoZmlsZSkKICAgIGxldCBjbWQgPSBwbHVnI3NoZWxsZXNjYXBlKGJhdGNoZmlsZSwgeydzaGVsbCc6ICZzaGVsbCwgJ3NjcmlwdCc6IDB9KQogICAgaWYgJnNoZWxsID1+IyAncG93ZXJzaGVsbFwuZXhlJwogICAgICBsZXQgY21kID0gJyYgJyAuIGNtZAogICAgZW5kaWYKICAgIHJldHVybiBbYmF0Y2hmaWxlLCBjbWRdCiAgZW5kZnVuY3Rpb24KZWxzZQogIGZ1bmN0aW9uISBzOnBhdGgocGF0aCkKICAgIHJldHVybiBzOnRyaW0oYTpwYXRoKQogIGVuZGZ1bmN0aW9uCgogIGZ1bmN0aW9uISBzOmRpcnBhdGgocGF0aCkKICAgIHJldHVybiBzdWJzdGl0dXRlKGE6cGF0aCwgJ1svXFxdKiQnLCAnLycsICcnKQogIGVuZGZ1bmN0aW9uCgogIGZ1bmN0aW9uISBzOmlzX2xvY2FsX3BsdWcocmVwbykKICAgIHJldHVybiBhOnJlcG9bMF0gPX4gJ1svJH5dJwogIGVuZGZ1bmN0aW9uCmVuZGlmCgpmdW5jdGlvbiEgczplcnIobXNnKQogIGVjaG9obCBFcnJvck1zZwogIGVjaG9tICdbdmltLXBsdWddICcuYTptc2cKICBlY2hvaGwgTm9uZQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6d2FybihjbWQsIG1zZykKICBlY2hvaGwgV2FybmluZ01zZwogIGV4ZWN1dGUgYTpjbWQgJ2E6bXNnJwogIGVjaG9obCBOb25lCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczplc2MocGF0aCkKICByZXR1cm4gZXNjYXBlKGE6cGF0aCwgJyAnKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6ZXNjcnRwKHBhdGgpCiAgcmV0dXJuIGVzY2FwZShhOnBhdGgsICcgLCcpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpyZW1vdmVfcnRwKCkKICBmb3IgbmFtZSBpbiBzOmxvYWRlZF9uYW1lcygpCiAgICBsZXQgcnRwID0gczpydHAoZzpwbHVnc1tuYW1lXSkKICAgIGV4ZWN1dGUgJ3NldCBydHAtPScuczplc2NydHAocnRwKQogICAgbGV0IGFmdGVyID0gZ2xvYnBhdGgocnRwLCAnYWZ0ZXInKQogICAgaWYgaXNkaXJlY3RvcnkoYWZ0ZXIpCiAgICAgIGV4ZWN1dGUgJ3NldCBydHAtPScuczplc2NydHAoYWZ0ZXIpCiAgICBlbmRpZgogIGVuZGZvcgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cmVvcmdfcnRwKCkKICBpZiAhZW1wdHkoczpmaXJzdF9ydHApCiAgICBleGVjdXRlICdzZXQgcnRwLT0nLnM6Zmlyc3RfcnRwCiAgICBleGVjdXRlICdzZXQgcnRwLT0nLnM6bGFzdF9ydHAKICBlbmRpZgoKICAiICZydHAgaXMgbW9kaWZpZWQgZnJvbSBvdXRzaWRlCiAgaWYgZXhpc3RzKCdzOnBydHAnKSAmJiBzOnBydHAgIT0jICZydHAKICAgIGNhbGwgczpyZW1vdmVfcnRwKCkKICAgIHVubGV0ISBzOm1pZGRsZQogIGVuZGlmCgogIGxldCBzOm1pZGRsZSA9IGdldChzOiwgJ21pZGRsZScsICZydHApCiAgbGV0IHJ0cHMgICAgID0gbWFwKHM6bG9hZGVkX25hbWVzKCksICdzOnJ0cChnOnBsdWdzW3Y6dmFsXSknKQogIGxldCBhZnRlcnMgICA9IGZpbHRlcihtYXAoY29weShydHBzKSwgJ2dsb2JwYXRoKHY6dmFsLCAiYWZ0ZXIiKScpLCAnIWVtcHR5KHY6dmFsKScpCiAgbGV0IHJ0cCAgICAgID0gam9pbihtYXAocnRwcywgJ2VzY2FwZSh2OnZhbCwgIiwiKScpLCAnLCcpCiAgICAgICAgICAgICAgICAgXCAuICcsJy5zOm1pZGRsZS4nLCcKICAgICAgICAgICAgICAgICBcIC4gam9pbihtYXAoYWZ0ZXJzLCAnZXNjYXBlKHY6dmFsLCAiLCIpJyksICcsJykKICBsZXQgJnJ0cCAgICAgPSBzdWJzdGl0dXRlKHN1YnN0aXR1dGUocnRwLCAnLCwqJywgJywnLCAnZycpLCAnXixcfCwkJywgJycsICdnJykKICBsZXQgczpwcnRwICAgPSAmcnRwCgogIGlmICFlbXB0eShzOmZpcnN0X3J0cCkKICAgIGV4ZWN1dGUgJ3NldCBydHBePScuczpmaXJzdF9ydHAKICAgIGV4ZWN1dGUgJ3NldCBydHArPScuczpsYXN0X3J0cAogIGVuZGlmCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpkb2F1dG9jbWQoLi4uKQogIGlmIGV4aXN0cygnIycuam9pbihhOjAwMCwgJyMnKSkKICAgIGV4ZWN1dGUgJ2RvYXV0b2NtZCcgKCh2OnZlcnNpb24gPiA3MDMgfHwgaGFzKCdwYXRjaDQ0MicpKSA/ICc8bm9tb2RlbGluZT4nIDogJycpIGpvaW4oYTowMDApCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmRvYnVmcmVhZChuYW1lcykKICBmb3IgbmFtZSBpbiBhOm5hbWVzCiAgICBsZXQgcGF0aCA9IHM6cnRwKGc6cGx1Z3NbbmFtZV0pCiAgICBmb3IgZGlyIGluIFsnZnRkZXRlY3QnLCAnZnRwbHVnaW4nLCAnYWZ0ZXIvZnRkZXRlY3QnLCAnYWZ0ZXIvZnRwbHVnaW4nXQogICAgICBpZiBsZW4oZmluZGRpcihkaXIsIHBhdGgpKQogICAgICAgIGlmIGV4aXN0cygnI0J1ZlJlYWQnKQogICAgICAgICAgZG9hdXRvY21kIEJ1ZlJlYWQKICAgICAgICBlbmRpZgogICAgICAgIHJldHVybgogICAgICBlbmRpZgogICAgZW5kZm9yCiAgZW5kZm9yCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgcGx1ZyNsb2FkKC4uLikKICBpZiBhOjAgPT0gMAogICAgcmV0dXJuIHM6ZXJyKCdBcmd1bWVudCBtaXNzaW5nOiBwbHVnaW4gbmFtZShzKSByZXF1aXJlZCcpCiAgZW5kaWYKICBpZiAhZXhpc3RzKCdnOnBsdWdzJykKICAgIHJldHVybiBzOmVycigncGx1ZyNiZWdpbiB3YXMgbm90IGNhbGxlZCcpCiAgZW5kaWYKICBsZXQgbmFtZXMgPSBhOjAgPT0gMSAmJiB0eXBlKGE6MSkgPT0gczpUWVBFLmxpc3QgPyBhOjEgOiBhOjAwMAogIGxldCB1bmtub3ducyA9IGZpbHRlcihjb3B5KG5hbWVzKSwgJyFoYXNfa2V5KGc6cGx1Z3MsIHY6dmFsKScpCiAgaWYgIWVtcHR5KHVua25vd25zKQogICAgbGV0IHMgPSBsZW4odW5rbm93bnMpID4gMSA/ICdzJyA6ICcnCiAgICByZXR1cm4gczplcnIocHJpbnRmKCdVbmtub3duIHBsdWdpbiVzOiAlcycsIHMsIGpvaW4odW5rbm93bnMsICcsICcpKSkKICBlbmQKICBsZXQgdW5sb2FkZWQgPSBmaWx0ZXIoY29weShuYW1lcyksICchZ2V0KHM6bG9hZGVkLCB2OnZhbCwgMCknKQogIGlmICFlbXB0eSh1bmxvYWRlZCkKICAgIGZvciBuYW1lIGluIHVubG9hZGVkCiAgICAgIGNhbGwgczpsb2QoW25hbWVdLCBbJ2Z0ZGV0ZWN0JywgJ2FmdGVyL2Z0ZGV0ZWN0JywgJ3BsdWdpbicsICdhZnRlci9wbHVnaW4nXSkKICAgIGVuZGZvcgogICAgY2FsbCBzOmRvYnVmcmVhZCh1bmxvYWRlZCkKICAgIHJldHVybiAxCiAgZW5kCiAgcmV0dXJuIDAKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnJlbW92ZV90cmlnZ2VycyhuYW1lKQogIGlmICFoYXNfa2V5KHM6dHJpZ2dlcnMsIGE6bmFtZSkKICAgIHJldHVybgogIGVuZGlmCiAgZm9yIGNtZCBpbiBzOnRyaWdnZXJzW2E6bmFtZV0uY21kCiAgICBleGVjdXRlICdzaWxlbnQhIGRlbGMnIGNtZAogIGVuZGZvcgogIGZvciBtYXAgaW4gczp0cmlnZ2Vyc1thOm5hbWVdLm1hcAogICAgZXhlY3V0ZSAnc2lsZW50ISB1bm1hcCcgbWFwCiAgICBleGVjdXRlICdzaWxlbnQhIGl1bm1hcCcgbWFwCiAgZW5kZm9yCiAgY2FsbCByZW1vdmUoczp0cmlnZ2VycywgYTpuYW1lKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6bG9kKG5hbWVzLCB0eXBlcywgLi4uKQogIGZvciBuYW1lIGluIGE6bmFtZXMKICAgIGNhbGwgczpyZW1vdmVfdHJpZ2dlcnMobmFtZSkKICAgIGxldCBzOmxvYWRlZFtuYW1lXSA9IDEKICBlbmRmb3IKICBjYWxsIHM6cmVvcmdfcnRwKCkKCiAgZm9yIG5hbWUgaW4gYTpuYW1lcwogICAgbGV0IHJ0cCA9IHM6cnRwKGc6cGx1Z3NbbmFtZV0pCiAgICBmb3IgZGlyIGluIGE6dHlwZXMKICAgICAgY2FsbCBzOnNvdXJjZShydHAsIGRpci4nLyoqLyoudmltJykKICAgIGVuZGZvcgogICAgaWYgYTowCiAgICAgIGlmICFzOnNvdXJjZShydHAsIGE6MSkgJiYgIWVtcHR5KHM6Z2xvYihydHAsIGE6MikpCiAgICAgICAgZXhlY3V0ZSAncnVudGltZScgYToxCiAgICAgIGVuZGlmCiAgICAgIGNhbGwgczpzb3VyY2UocnRwLCBhOjIpCiAgICBlbmRpZgogICAgY2FsbCBzOmRvYXV0b2NtZCgnVXNlcicsIG5hbWUpCiAgZW5kZm9yCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpsb2RfZnQocGF0LCBuYW1lcykKICBsZXQgc3luID0gJ3N5bnRheC8nLmE6cGF0LicudmltJwogIGNhbGwgczpsb2QoYTpuYW1lcywgWydwbHVnaW4nLCAnYWZ0ZXIvcGx1Z2luJ10sIHN5biwgJ2FmdGVyLycuc3luKQogIGV4ZWN1dGUgJ2F1dG9jbWQhIFBsdWdMT0QgRmlsZVR5cGUnIGE6cGF0CiAgY2FsbCBzOmRvYXV0b2NtZCgnZmlsZXR5cGVwbHVnaW4nLCAnRmlsZVR5cGUnKQogIGNhbGwgczpkb2F1dG9jbWQoJ2ZpbGV0eXBlaW5kZW50JywgJ0ZpbGVUeXBlJykKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmxvZF9jbWQoY21kLCBiYW5nLCBsMSwgbDIsIGFyZ3MsIG5hbWVzKQogIGNhbGwgczpsb2QoYTpuYW1lcywgWydmdGRldGVjdCcsICdhZnRlci9mdGRldGVjdCcsICdwbHVnaW4nLCAnYWZ0ZXIvcGx1Z2luJ10pCiAgY2FsbCBzOmRvYnVmcmVhZChhOm5hbWVzKQogIGV4ZWN1dGUgcHJpbnRmKCclcyVzJXMgJXMnLCAoYTpsMSA9PSBhOmwyID8gJycgOiAoYTpsMS4nLCcuYTpsMikpLCBhOmNtZCwgYTpiYW5nLCBhOmFyZ3MpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpsb2RfbWFwKG1hcCwgbmFtZXMsIHdpdGhfcHJlZml4LCBwcmVmaXgpCiAgY2FsbCBzOmxvZChhOm5hbWVzLCBbJ2Z0ZGV0ZWN0JywgJ2FmdGVyL2Z0ZGV0ZWN0JywgJ3BsdWdpbicsICdhZnRlci9wbHVnaW4nXSkKICBjYWxsIHM6ZG9idWZyZWFkKGE6bmFtZXMpCiAgbGV0IGV4dHJhID0gJycKICB3aGlsZSAxCiAgICBsZXQgYyA9IGdldGNoYXIoMCkKICAgIGlmIGMgPT0gMAogICAgICBicmVhawogICAgZW5kaWYKICAgIGxldCBleHRyYSAuPSBucjJjaGFyKGMpCiAgZW5kd2hpbGUKCiAgaWYgYTp3aXRoX3ByZWZpeAogICAgbGV0IHByZWZpeCA9IHY6Y291bnQgPyB2OmNvdW50IDogJycKICAgIGxldCBwcmVmaXggLj0gJyInLnY6cmVnaXN0ZXIuYTpwcmVmaXgKICAgIGlmIG1vZGUoMSkgPT0gJ25vJwogICAgICBpZiB2Om9wZXJhdG9yID09ICdjJwogICAgICAgIGxldCBwcmVmaXggPSAiXDxlc2M+IiAuIHByZWZpeAogICAgICBlbmRpZgogICAgICBsZXQgcHJlZml4IC49IHY6b3BlcmF0b3IKICAgIGVuZGlmCiAgICBjYWxsIGZlZWRrZXlzKHByZWZpeCwgJ24nKQogIGVuZGlmCiAgY2FsbCBmZWVka2V5cyhzdWJzdGl0dXRlKGE6bWFwLCAnXjxQbHVnPicsICJcPFBsdWc+IiwgJycpIC4gZXh0cmEpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgcGx1ZyMocmVwbywgLi4uKQogIGlmIGE6MCA+IDEKICAgIHJldHVybiBzOmVycignSW52YWxpZCBudW1iZXIgb2YgYXJndW1lbnRzICgxLi4yKScpCiAgZW5kaWYKCiAgdHJ5CiAgICBsZXQgcmVwbyA9IHM6dHJpbShhOnJlcG8pCiAgICBsZXQgb3B0cyA9IGE6MCA9PSAxID8gczpwYXJzZV9vcHRpb25zKGE6MSkgOiBzOmJhc2Vfc3BlYwogICAgbGV0IG5hbWUgPSBnZXQob3B0cywgJ2FzJywgczpwbHVnX2ZuYW1lbW9kaWZ5KHJlcG8sICc6dDpzP1wuZ2l0JD8/JykpCiAgICBsZXQgc3BlYyA9IGV4dGVuZChzOmluZmVyX3Byb3BlcnRpZXMobmFtZSwgcmVwbyksIG9wdHMpCiAgICBpZiAhaGFzX2tleShnOnBsdWdzLCBuYW1lKQogICAgICBjYWxsIGFkZChnOnBsdWdzX29yZGVyLCBuYW1lKQogICAgZW5kaWYKICAgIGxldCBnOnBsdWdzW25hbWVdID0gc3BlYwogICAgbGV0IHM6bG9hZGVkW25hbWVdID0gZ2V0KHM6bG9hZGVkLCBuYW1lLCAwKQogIGNhdGNoCiAgICByZXR1cm4gczplcnIodjpleGNlcHRpb24pCiAgZW5kdHJ5CmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpwYXJzZV9vcHRpb25zKGFyZykKICBsZXQgb3B0cyA9IGNvcHkoczpiYXNlX3NwZWMpCiAgbGV0IHR5cGUgPSB0eXBlKGE6YXJnKQogIGlmIHR5cGUgPT0gczpUWVBFLnN0cmluZwogICAgbGV0IG9wdHMudGFnID0gYTphcmcKICBlbHNlaWYgdHlwZSA9PSBzOlRZUEUuZGljdAogICAgY2FsbCBleHRlbmQob3B0cywgYTphcmcpCiAgICBpZiBoYXNfa2V5KG9wdHMsICdkaXInKQogICAgICBsZXQgb3B0cy5kaXIgPSBzOmRpcnBhdGgoczpwbHVnX2V4cGFuZChvcHRzLmRpcikpCiAgICBlbmRpZgogIGVsc2UKICAgIHRocm93ICdJbnZhbGlkIGFyZ3VtZW50IHR5cGUgKGV4cGVjdGVkOiBzdHJpbmcgb3IgZGljdGlvbmFyeSknCiAgZW5kaWYKICByZXR1cm4gb3B0cwplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6aW5mZXJfcHJvcGVydGllcyhuYW1lLCByZXBvKQogIGxldCByZXBvID0gYTpyZXBvCiAgaWYgczppc19sb2NhbF9wbHVnKHJlcG8pCiAgICByZXR1cm4geyAnZGlyJzogczpkaXJwYXRoKHM6cGx1Z19leHBhbmQocmVwbykpIH0KICBlbHNlCiAgICBpZiByZXBvID1+ICc6JwogICAgICBsZXQgdXJpID0gcmVwbwogICAgZWxzZQogICAgICBpZiByZXBvICF+ICcvJwogICAgICAgIHRocm93IHByaW50ZignSW52YWxpZCBhcmd1bWVudDogJXMgKGltcGxpY2l0IGB2aW0tc2NyaXB0cycnIGV4cGFuc2lvbiBpcyBkZXByZWNhdGVkKScsIHJlcG8pCiAgICAgIGVuZGlmCiAgICAgIGxldCBmbXQgPSBnZXQoZzosICdwbHVnX3VybF9mb3JtYXQnLCAnaHR0cHM6Ly9naXQ6OkBnaXRodWIuY29tLyVzLmdpdCcpCiAgICAgIGxldCB1cmkgPSBwcmludGYoZm10LCByZXBvKQogICAgZW5kaWYKICAgIHJldHVybiB7ICdkaXInOiBzOmRpcnBhdGgoZzpwbHVnX2hvbWUuJy8nLmE6bmFtZSksICd1cmknOiB1cmkgfQogIGVuZGlmCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczppbnN0YWxsKGZvcmNlLCBuYW1lcykKICBjYWxsIHM6dXBkYXRlX2ltcGwoMCwgYTpmb3JjZSwgYTpuYW1lcykKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnVwZGF0ZShmb3JjZSwgbmFtZXMpCiAgY2FsbCBzOnVwZGF0ZV9pbXBsKDEsIGE6Zm9yY2UsIGE6bmFtZXMpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgcGx1ZyNoZWxwdGFncygpCiAgaWYgIWV4aXN0cygnZzpwbHVncycpCiAgICByZXR1cm4gczplcnIoJ3BsdWcjYmVnaW4gd2FzIG5vdCBjYWxsZWQnKQogIGVuZGlmCiAgZm9yIHNwZWMgaW4gdmFsdWVzKGc6cGx1Z3MpCiAgICBsZXQgZG9jZCA9IGpvaW4oW3M6cnRwKHNwZWMpLCAnZG9jJ10sICcvJykKICAgIGlmIGlzZGlyZWN0b3J5KGRvY2QpCiAgICAgIHNpbGVudCEgZXhlY3V0ZSAnaGVscHRhZ3MnIHM6ZXNjKGRvY2QpCiAgICBlbmRpZgogIGVuZGZvcgogIHJldHVybiAxCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpzeW50YXgoKQogIHN5bnRheCBjbGVhcgogIHN5bnRheCByZWdpb24gcGx1ZzEgc3RhcnQ9L1wlMWwvIGVuZD0vXCUybC8gY29udGFpbnM9cGx1Z051bWJlcgogIHN5bnRheCByZWdpb24gcGx1ZzIgc3RhcnQ9L1wlMmwvIGVuZD0vXCUzbC8gY29udGFpbnM9cGx1Z0JyYWNrZXQscGx1Z1gKICBzeW4gbWF0Y2ggcGx1Z051bWJlciAvWzAtOV1cK1swLTkuXSovIGNvbnRhaW5lZAogIHN5biBtYXRjaCBwbHVnQnJhY2tldCAvW1tcXV0vIGNvbnRhaW5lZAogIHN5biBtYXRjaCBwbHVnWCAveC8gY29udGFpbmVkCiAgc3luIG1hdGNoIHBsdWdEYXNoIC9eLS8KICBzeW4gbWF0Y2ggcGx1Z1BsdXMgL14rLwogIHN5biBtYXRjaCBwbHVnU3RhciAvXiovCiAgc3luIG1hdGNoIHBsdWdNZXNzYWdlIC9cKF4tIFwpXEA8PS4qLwogIHN5biBtYXRjaCBwbHVnTmFtZSAvXCheLSBcKVxAPD1bXiBdKjovCiAgc3luIG1hdGNoIHBsdWdTaGEgL1wlKDogXClcQDw9WzAtOWEtZl1cezQsfSQvCiAgc3luIG1hdGNoIHBsdWdUYWcgLyh0YWc6IFteKV1cKykvCiAgc3luIG1hdGNoIHBsdWdJbnN0YWxsIC9cKF4rIFwpXEA8PVteOl0qLwogIHN5biBtYXRjaCBwbHVnVXBkYXRlIC9cKF4qIFwpXEA8PVteOl0qLwogIHN5biBtYXRjaCBwbHVnQ29tbWl0IC9eICBcWCpbMC05YS1mXVx7Nyw5fSAuKi8gY29udGFpbnM9cGx1Z1JlbERhdGUscGx1Z0VkZ2UscGx1Z1RhZwogIHN5biBtYXRjaCBwbHVnRWRnZSAvXiAgXFhcKyQvCiAgc3luIG1hdGNoIHBsdWdFZGdlIC9eICBcWCovIGNvbnRhaW5lZCBuZXh0Z3JvdXA9cGx1Z1NoYQogIHN5biBtYXRjaCBwbHVnU2hhIC9bMC05YS1mXVx7Nyw5fS8gY29udGFpbmVkCiAgc3luIG1hdGNoIHBsdWdSZWxEYXRlIC8oW14pXSopJC8gY29udGFpbmVkCiAgc3luIG1hdGNoIHBsdWdOb3RMb2FkZWQgLyhub3QgbG9hZGVkKSQvCiAgc3luIG1hdGNoIHBsdWdFcnJvciAvXnguKi8KICBzeW4gcmVnaW9uIHBsdWdEZWxldGVkIHN0YXJ0PS9eXH4gLiovIGVuZD0vXlx6ZVxTLwogIHN5biBtYXRjaCBwbHVnSDIgL14uKjpcbi1cKyQvCiAgc3luIGtleXdvcmQgRnVuY3Rpb24gUGx1Z0luc3RhbGwgUGx1Z1N0YXR1cyBQbHVnVXBkYXRlIFBsdWdDbGVhbgogIGhpIGRlZiBsaW5rIHBsdWcxICAgICAgIFRpdGxlCiAgaGkgZGVmIGxpbmsgcGx1ZzIgICAgICAgUmVwZWF0CiAgaGkgZGVmIGxpbmsgcGx1Z0gyICAgICAgVHlwZQogIGhpIGRlZiBsaW5rIHBsdWdYICAgICAgIEV4Y2VwdGlvbgogIGhpIGRlZiBsaW5rIHBsdWdCcmFja2V0IFN0cnVjdHVyZQogIGhpIGRlZiBsaW5rIHBsdWdOdW1iZXIgIE51bWJlcgoKICBoaSBkZWYgbGluayBwbHVnRGFzaCAgICBTcGVjaWFsCiAgaGkgZGVmIGxpbmsgcGx1Z1BsdXMgICAgQ29uc3RhbnQKICBoaSBkZWYgbGluayBwbHVnU3RhciAgICBCb29sZWFuCgogIGhpIGRlZiBsaW5rIHBsdWdNZXNzYWdlIEZ1bmN0aW9uCiAgaGkgZGVmIGxpbmsgcGx1Z05hbWUgICAgTGFiZWwKICBoaSBkZWYgbGluayBwbHVnSW5zdGFsbCBGdW5jdGlvbgogIGhpIGRlZiBsaW5rIHBsdWdVcGRhdGUgIFR5cGUKCiAgaGkgZGVmIGxpbmsgcGx1Z0Vycm9yICAgRXJyb3IKICBoaSBkZWYgbGluayBwbHVnRGVsZXRlZCBJZ25vcmUKICBoaSBkZWYgbGluayBwbHVnUmVsRGF0ZSBDb21tZW50CiAgaGkgZGVmIGxpbmsgcGx1Z0VkZ2UgICAgUHJlUHJvYwogIGhpIGRlZiBsaW5rIHBsdWdTaGEgICAgIElkZW50aWZpZXIKICBoaSBkZWYgbGluayBwbHVnVGFnICAgICBDb25zdGFudAoKICBoaSBkZWYgbGluayBwbHVnTm90TG9hZGVkIENvbW1lbnQKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmxwYWQoc3RyLCBsZW4pCiAgcmV0dXJuIGE6c3RyIC4gcmVwZWF0KCcgJywgYTpsZW4gLSBsZW4oYTpzdHIpKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6bGluZXMobXNnKQogIHJldHVybiBzcGxpdChhOm1zZywgIltcclxuXSIpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpsYXN0bGluZShtc2cpCiAgcmV0dXJuIGdldChzOmxpbmVzKGE6bXNnKSwgLTEsICcnKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6bmV3X3dpbmRvdygpCiAgZXhlY3V0ZSBnZXQoZzosICdwbHVnX3dpbmRvdycsICd2ZXJ0aWNhbCB0b3BsZWZ0IG5ldycpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpwbHVnX3dpbmRvd19leGlzdHMoKQogIGxldCBidWZsaXN0ID0gdGFicGFnZWJ1Zmxpc3QoczpwbHVnX3RhYikKICByZXR1cm4gIWVtcHR5KGJ1Zmxpc3QpICYmIGluZGV4KGJ1Zmxpc3QsIHM6cGx1Z19idWYpID49IDAKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnN3aXRjaF9pbigpCiAgaWYgIXM6cGx1Z193aW5kb3dfZXhpc3RzKCkKICAgIHJldHVybiAwCiAgZW5kaWYKCiAgaWYgd2luYnVmbnIoMCkgIT0gczpwbHVnX2J1ZgogICAgbGV0IHM6cG9zID0gW3RhYnBhZ2VucigpLCB3aW5ucigpLCB3aW5zYXZldmlldygpXQogICAgZXhlY3V0ZSAnbm9ybWFsIScgczpwbHVnX3RhYi4nZ3QnCiAgICBsZXQgd2lubnIgPSBidWZ3aW5ucihzOnBsdWdfYnVmKQogICAgZXhlY3V0ZSB3aW5uci4nd2luY21kIHcnCiAgICBjYWxsIGFkZChzOnBvcywgd2luc2F2ZXZpZXcoKSkKICBlbHNlCiAgICBsZXQgczpwb3MgPSBbd2luc2F2ZXZpZXcoKV0KICBlbmRpZgoKICBzZXRsb2NhbCBtb2RpZmlhYmxlCiAgcmV0dXJuIDEKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnN3aXRjaF9vdXQoLi4uKQogIGNhbGwgd2lucmVzdHZpZXcoczpwb3NbLTFdKQogIHNldGxvY2FsIG5vbW9kaWZpYWJsZQogIGlmIGE6MCA+IDAKICAgIGV4ZWN1dGUgYToxCiAgZW5kaWYKCiAgaWYgbGVuKHM6cG9zKSA+IDEKICAgIGV4ZWN1dGUgJ25vcm1hbCEnIHM6cG9zWzBdLidndCcKICAgIGV4ZWN1dGUgczpwb3NbMV0gJ3dpbmNtZCB3JwogICAgY2FsbCB3aW5yZXN0dmlldyhzOnBvc1syXSkKICBlbmRpZgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6ZmluaXNoX2JpbmRpbmdzKCkKICBubm9yZW1hcCA8c2lsZW50PiA8YnVmZmVyPiBSICA6Y2FsbCA8U0lEPnJldHJ5KCk8Y3I+CiAgbm5vcmVtYXAgPHNpbGVudD4gPGJ1ZmZlcj4gRCAgOlBsdWdEaWZmPGNyPgogIG5ub3JlbWFwIDxzaWxlbnQ+IDxidWZmZXI+IFMgIDpQbHVnU3RhdHVzPGNyPgogIG5ub3JlbWFwIDxzaWxlbnQ+IDxidWZmZXI+IFUgIDpjYWxsIDxTSUQ+c3RhdHVzX3VwZGF0ZSgpPGNyPgogIHhub3JlbWFwIDxzaWxlbnQ+IDxidWZmZXI+IFUgIDpjYWxsIDxTSUQ+c3RhdHVzX3VwZGF0ZSgpPGNyPgogIG5ub3JlbWFwIDxzaWxlbnQ+IDxidWZmZXI+IF1dIDpzaWxlbnQhIGNhbGwgPFNJRD5zZWN0aW9uKCcnKTxjcj4KICBubm9yZW1hcCA8c2lsZW50PiA8YnVmZmVyPiBbWyA6c2lsZW50ISBjYWxsIDxTSUQ+c2VjdGlvbignYicpPGNyPgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cHJlcGFyZSguLi4pCiAgaWYgZW1wdHkoczpwbHVnX2dldGN3ZCgpKQogICAgdGhyb3cgJ0ludmFsaWQgY3VycmVudCB3b3JraW5nIGRpcmVjdG9yeS4gQ2Fubm90IHByb2NlZWQuJwogIGVuZGlmCgogIGZvciBldmFyIGluIFsnJEdJVF9ESVInLCAnJEdJVF9XT1JLX1RSRUUnXQogICAgaWYgZXhpc3RzKGV2YXIpCiAgICAgIHRocm93IGV2YXIuJyBkZXRlY3RlZC4gQ2Fubm90IHByb2NlZWQuJwogICAgZW5kaWYKICBlbmRmb3IKCiAgY2FsbCBzOmpvYl9hYm9ydCgpCiAgaWYgczpzd2l0Y2hfaW4oKQogICAgaWYgYjpwbHVnX3ByZXZpZXcgPT0gMQogICAgICBwYwogICAgZW5kaWYKICAgIGVuZXcKICBlbHNlCiAgICBjYWxsIHM6bmV3X3dpbmRvdygpCiAgZW5kaWYKCiAgbm5vcmVtYXAgPHNpbGVudD4gPGJ1ZmZlcj4gcSAgOmlmIGI6cGx1Z19wcmV2aWV3PT0xPGJhcj5wYzxiYXI+ZW5kaWY8YmFyPmJkPGNyPgogIGlmIGE6MCA9PSAwCiAgICBjYWxsIHM6ZmluaXNoX2JpbmRpbmdzKCkKICBlbmRpZgogIGxldCBiOnBsdWdfcHJldmlldyA9IC0xCiAgbGV0IHM6cGx1Z190YWIgPSB0YWJwYWdlbnIoKQogIGxldCBzOnBsdWdfYnVmID0gd2luYnVmbnIoMCkKICBjYWxsIHM6YXNzaWduX25hbWUoKQoKICBmb3IgayBpbiBbJzxjcj4nLCAnTCcsICdvJywgJ1gnLCAnZCcsICdkZCddCiAgICBleGVjdXRlICdzaWxlbnQhIHVubWFwIDxidWZmZXI+JyBrCiAgZW5kZm9yCiAgc2V0bG9jYWwgYnVmdHlwZT1ub2ZpbGUgYnVmaGlkZGVuPXdpcGUgbm9idWZsaXN0ZWQgbm9saXN0IG5vc3dhcGZpbGUgbm93cmFwIGN1cnNvcmxpbmUgbW9kaWZpYWJsZSBub3NwZWxsCiAgaWYgZXhpc3RzKCcrY29sb3Jjb2x1bW4nKQogICAgc2V0bG9jYWwgY29sb3Jjb2x1bW49CiAgZW5kaWYKICBzZXRmIHZpbS1wbHVnCiAgaWYgZXhpc3RzKCdnOnN5bnRheF9vbicpCiAgICBjYWxsIHM6c3ludGF4KCkKICBlbmRpZgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6YXNzaWduX25hbWUoKQogICIgQXNzaWduIGJ1ZmZlciBuYW1lCiAgbGV0IHByZWZpeCA9ICdbUGx1Z2luc10nCiAgbGV0IG5hbWUgICA9IHByZWZpeAogIGxldCBpZHggICAgPSAyCiAgd2hpbGUgYnVmZXhpc3RzKG5hbWUpCiAgICBsZXQgbmFtZSA9IHByaW50ZignJXMgKCVzKScsIHByZWZpeCwgaWR4KQogICAgbGV0IGlkeCA9IGlkeCArIDEKICBlbmR3aGlsZQogIHNpbGVudCEgZXhlY3V0ZSAnZicgZm5hbWVlc2NhcGUobmFtZSkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmNoc2goc3dhcCkKICBsZXQgcHJldiA9IFsmc2hlbGwsICZzaGVsbGNtZGZsYWcsICZzaGVsbHJlZGlyXQogIGlmICFzOmlzX3dpbiAmJiBhOnN3YXAKICAgIHNldCBzaGVsbD1zaCBzaGVsbHJlZGlyPT4lc1wgMj4mMQogIGVuZGlmCiAgcmV0dXJuIHByZXYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmJhbmcoY21kLCAuLi4pCiAgbGV0IGJhdGNoZmlsZSA9ICcnCiAgdHJ5CiAgICBsZXQgW3NoLCBzaGVsbGNtZGZsYWcsIHNocmRdID0gczpjaHNoKGE6MCkKICAgICIgRklYTUU6IEVzY2FwaW5nIGlzIGluY29tcGxldGUuIFdlIGNvdWxkIHVzZSBzaGVsbGVzY2FwZSB3aXRoIGV2YWwsCiAgICAiICAgICAgICBidXQgaXQgd29uJ3Qgd29yayBvbiBXaW5kb3dzLgogICAgbGV0IGNtZCA9IGE6MCA/IHM6d2l0aF9jZChhOmNtZCwgYToxKSA6IGE6Y21kCiAgICBpZiBzOmlzX3dpbgogICAgICBsZXQgW2JhdGNoZmlsZSwgY21kXSA9IHM6YmF0Y2hmaWxlKGNtZCkKICAgIGVuZGlmCiAgICBsZXQgZzpfcGx1Z19iYW5nID0gKHM6aXNfd2luICYmIGhhcygnZ3VpX3J1bm5pbmcnKSA/ICdzaWxlbnQgJyA6ICcnKS4nIScuZXNjYXBlKGNtZCwgJyMhJScpCiAgICBleGVjdXRlICJub3JtYWwhIDpleGVjdXRlIGc6X3BsdWdfYmFuZ1w8Y3I+XDxjcj4iCiAgZmluYWxseQogICAgdW5sZXQgZzpfcGx1Z19iYW5nCiAgICBsZXQgWyZzaGVsbCwgJnNoZWxsY21kZmxhZywgJnNoZWxscmVkaXJdID0gW3NoLCBzaGVsbGNtZGZsYWcsIHNocmRdCiAgICBpZiBzOmlzX3dpbiAmJiBmaWxlcmVhZGFibGUoYmF0Y2hmaWxlKQogICAgICBjYWxsIGRlbGV0ZShiYXRjaGZpbGUpCiAgICBlbmRpZgogIGVuZHRyeQogIHJldHVybiB2OnNoZWxsX2Vycm9yID8gJ0V4aXQgc3RhdHVzOiAnIC4gdjpzaGVsbF9lcnJvciA6ICcnCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpyZWdyZXNzX2JhcigpCiAgbGV0IGJhciA9IHN1YnN0aXR1dGUoZ2V0bGluZSgyKVsxOi0yXSwgJy4qXHpzPScsICd4JywgJycpCiAgY2FsbCBzOnByb2dyZXNzX2JhcigyLCBiYXIsIGxlbihiYXIpKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6aXNfdXBkYXRlZChkaXIpCiAgcmV0dXJuICFlbXB0eShzOnN5c3RlbV9jaG9tcCgnZ2l0IGxvZyAtLXByZXR0eT1mb3JtYXQ6IiVoIiAiSEVBRC4uLkhFQURAezF9IicsIGE6ZGlyKSkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmRvKHB1bGwsIGZvcmNlLCB0b2RvKQogIGZvciBbbmFtZSwgc3BlY10gaW4gaXRlbXMoYTp0b2RvKQogICAgaWYgIWlzZGlyZWN0b3J5KHNwZWMuZGlyKQogICAgICBjb250aW51ZQogICAgZW5kaWYKICAgIGxldCBpbnN0YWxsZWQgPSBoYXNfa2V5KHM6dXBkYXRlLm5ldywgbmFtZSkKICAgIGxldCB1cGRhdGVkID0gaW5zdGFsbGVkID8gMCA6CiAgICAgIFwgKGE6cHVsbCAmJiBpbmRleChzOnVwZGF0ZS5lcnJvcnMsIG5hbWUpIDwgMCAmJiBzOmlzX3VwZGF0ZWQoc3BlYy5kaXIpKQogICAgaWYgYTpmb3JjZSB8fCBpbnN0YWxsZWQgfHwgdXBkYXRlZAogICAgICBleGVjdXRlICdjZCcgczplc2Moc3BlYy5kaXIpCiAgICAgIGNhbGwgYXBwZW5kKDMsICctIFBvc3QtdXBkYXRlIGhvb2sgZm9yICcuIG5hbWUgLicgLi4uICcpCiAgICAgIGxldCBlcnJvciA9ICcnCiAgICAgIGxldCB0eXBlID0gdHlwZShzcGVjLmRvKQogICAgICBpZiB0eXBlID09IHM6VFlQRS5zdHJpbmcKICAgICAgICBpZiBzcGVjLmRvWzBdID09ICc6JwogICAgICAgICAgaWYgIWdldChzOmxvYWRlZCwgbmFtZSwgMCkKICAgICAgICAgICAgbGV0IHM6bG9hZGVkW25hbWVdID0gMQogICAgICAgICAgICBjYWxsIHM6cmVvcmdfcnRwKCkKICAgICAgICAgIGVuZGlmCiAgICAgICAgICBjYWxsIHM6bG9hZF9wbHVnaW4oc3BlYykKICAgICAgICAgIHRyeQogICAgICAgICAgICBleGVjdXRlIHNwZWMuZG9bMTpdCiAgICAgICAgICBjYXRjaAogICAgICAgICAgICBsZXQgZXJyb3IgPSB2OmV4Y2VwdGlvbgogICAgICAgICAgZW5kdHJ5CiAgICAgICAgICBpZiAhczpwbHVnX3dpbmRvd19leGlzdHMoKQogICAgICAgICAgICBjZCAtCiAgICAgICAgICAgIHRocm93ICdXYXJuaW5nOiB2aW0tcGx1ZyB3YXMgdGVybWluYXRlZCBieSB0aGUgcG9zdC11cGRhdGUgaG9vayBvZiAnLm5hbWUKICAgICAgICAgIGVuZGlmCiAgICAgICAgZWxzZQogICAgICAgICAgbGV0IGVycm9yID0gczpiYW5nKHNwZWMuZG8pCiAgICAgICAgZW5kaWYKICAgICAgZWxzZWlmIHR5cGUgPT0gczpUWVBFLmZ1bmNyZWYKICAgICAgICB0cnkKICAgICAgICAgIGxldCBzdGF0dXMgPSBpbnN0YWxsZWQgPyAnaW5zdGFsbGVkJyA6ICh1cGRhdGVkID8gJ3VwZGF0ZWQnIDogJ3VuY2hhbmdlZCcpCiAgICAgICAgICBjYWxsIHNwZWMuZG8oeyAnbmFtZSc6IG5hbWUsICdzdGF0dXMnOiBzdGF0dXMsICdmb3JjZSc6IGE6Zm9yY2UgfSkKICAgICAgICBjYXRjaAogICAgICAgICAgbGV0IGVycm9yID0gdjpleGNlcHRpb24KICAgICAgICBlbmR0cnkKICAgICAgZWxzZQogICAgICAgIGxldCBlcnJvciA9ICdJbnZhbGlkIGhvb2sgdHlwZScKICAgICAgZW5kaWYKICAgICAgY2FsbCBzOnN3aXRjaF9pbigpCiAgICAgIGNhbGwgc2V0bGluZSg0LCBlbXB0eShlcnJvcikgPyAoZ2V0bGluZSg0KSAuICdPSycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwgOiAoJ3gnIC4gZ2V0bGluZSg0KVsxOl0gLiBlcnJvcikpCiAgICAgIGlmICFlbXB0eShlcnJvcikKICAgICAgICBjYWxsIGFkZChzOnVwZGF0ZS5lcnJvcnMsIG5hbWUpCiAgICAgICAgY2FsbCBzOnJlZ3Jlc3NfYmFyKCkKICAgICAgZW5kaWYKICAgICAgY2QgLQogICAgZW5kaWYKICBlbmRmb3IKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmhhc2hfbWF0Y2goYSwgYikKICByZXR1cm4gc3RyaWR4KGE6YSwgYTpiKSA9PSAwIHx8IHN0cmlkeChhOmIsIGE6YSkgPT0gMAplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6Y2hlY2tvdXQoc3BlYykKICBsZXQgc2hhID0gYTpzcGVjLmNvbW1pdAogIGxldCBvdXRwdXQgPSBzOnN5c3RlbSgnZ2l0IHJldi1wYXJzZSBIRUFEJywgYTpzcGVjLmRpcikKICBpZiAhdjpzaGVsbF9lcnJvciAmJiAhczpoYXNoX21hdGNoKHNoYSwgczpsaW5lcyhvdXRwdXQpWzBdKQogICAgbGV0IG91dHB1dCA9IHM6c3lzdGVtKAogICAgICAgICAgXCAnZ2l0IGZldGNoIC0tZGVwdGggOTk5OTk5ICYmIGdpdCBjaGVja291dCAnLnBsdWcjc2hlbGxlc2NhcGUoc2hhKS4nIC0tJywgYTpzcGVjLmRpcikKICBlbmRpZgogIHJldHVybiBvdXRwdXQKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmZpbmlzaChwdWxsKQogIGxldCBuZXdfZnJvemVuID0gbGVuKGZpbHRlcihrZXlzKHM6dXBkYXRlLm5ldyksICdnOnBsdWdzW3Y6dmFsXS5mcm96ZW4nKSkKICBpZiBuZXdfZnJvemVuCiAgICBsZXQgcyA9IG5ld19mcm96ZW4gPiAxID8gJ3MnIDogJycKICAgIGNhbGwgYXBwZW5kKDMsIHByaW50ZignLSBJbnN0YWxsZWQgJWQgZnJvemVuIHBsdWdpbiVzJywgbmV3X2Zyb3plbiwgcykpCiAgZW5kaWYKICBjYWxsIGFwcGVuZCgzLCAnLSBGaW5pc2hpbmcgLi4uICcpIHwgNAogIHJlZHJhdwogIGNhbGwgcGx1ZyNoZWxwdGFncygpCiAgY2FsbCBwbHVnI2VuZCgpCiAgY2FsbCBzZXRsaW5lKDQsIGdldGxpbmUoNCkgLiAnRG9uZSEnKQogIHJlZHJhdwogIGxldCBtc2dzID0gW10KICBpZiAhZW1wdHkoczp1cGRhdGUuZXJyb3JzKQogICAgY2FsbCBhZGQobXNncywgIlByZXNzICdSJyB0byByZXRyeS4iKQogIGVuZGlmCiAgaWYgYTpwdWxsICYmIGxlbihzOnVwZGF0ZS5uZXcpIDwgbGVuKGZpbHRlcihnZXRsaW5lKDUsICckJyksCiAgICAgICAgICAgICAgICBcICJ2OnZhbCA9fiAnXi0gJyAmJiB2OnZhbCAhfiMgJ0FscmVhZHkgdXAudG8uZGF0ZSciKSkKICAgIGNhbGwgYWRkKG1zZ3MsICJQcmVzcyAnRCcgdG8gc2VlIHRoZSB1cGRhdGVkIGNoYW5nZXMuIikKICBlbmRpZgogIGVjaG8gam9pbihtc2dzLCAnICcpCiAgY2FsbCBzOmZpbmlzaF9iaW5kaW5ncygpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpyZXRyeSgpCiAgaWYgZW1wdHkoczp1cGRhdGUuZXJyb3JzKQogICAgcmV0dXJuCiAgZW5kaWYKICBlY2hvCiAgY2FsbCBzOnVwZGF0ZV9pbXBsKHM6dXBkYXRlLnB1bGwsIHM6dXBkYXRlLmZvcmNlLAogICAgICAgIFwgZXh0ZW5kKGNvcHkoczp1cGRhdGUuZXJyb3JzKSwgW3M6dXBkYXRlLnRocmVhZHNdKSkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmlzX21hbmFnZWQobmFtZSkKICByZXR1cm4gaGFzX2tleShnOnBsdWdzW2E6bmFtZV0sICd1cmknKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6bmFtZXMoLi4uKQogIHJldHVybiBzb3J0KGZpbHRlcihrZXlzKGc6cGx1Z3MpLCAnc3RyaWR4KHY6dmFsLCBhOjEpID09IDAgJiYgczppc19tYW5hZ2VkKHY6dmFsKScpKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6Y2hlY2tfcnVieSgpCiAgc2lsZW50ISBydWJ5IHJlcXVpcmUgJ3RocmVhZCc7IFZJTTo6Y29tbWFuZCgibGV0IGc6cGx1Z19ydWJ5ID0gJyN7UlVCWV9WRVJTSU9OfSciKQogIGlmICFleGlzdHMoJ2c6cGx1Z19ydWJ5JykKICAgIHJlZHJhdyEKICAgIHJldHVybiBzOndhcm4oJ2VjaG9tJywgJ1dhcm5pbmc6IFJ1YnkgaW50ZXJmYWNlIGlzIGJyb2tlbicpCiAgZW5kaWYKICBsZXQgcnVieV92ZXJzaW9uID0gc3BsaXQoZzpwbHVnX3J1YnksICdcLicpCiAgdW5sZXQgZzpwbHVnX3J1YnkKICByZXR1cm4gczp2ZXJzaW9uX3JlcXVpcmVtZW50KHJ1YnlfdmVyc2lvbiwgWzEsIDgsIDddKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6dXBkYXRlX2ltcGwocHVsbCwgZm9yY2UsIGFyZ3MpIGFib3J0CiAgbGV0IHN5bmMgPSBpbmRleChhOmFyZ3MsICctLXN5bmMnKSA+PSAwIHx8IGhhcygndmltX3N0YXJ0aW5nJykKICBsZXQgYXJncyA9IGZpbHRlcihjb3B5KGE6YXJncyksICd2OnZhbCAhPSAiLS1zeW5jIicpCiAgbGV0IHRocmVhZHMgPSAobGVuKGFyZ3MpID4gMCAmJiBhcmdzWy0xXSA9fiAnXlsxLTldWzAtOV0qJCcpID8KICAgICAgICAgICAgICAgICAgXCByZW1vdmUoYXJncywgLTEpIDogZ2V0KGc6LCAncGx1Z190aHJlYWRzJywgMTYpCgogIGxldCBtYW5hZ2VkID0gZmlsdGVyKGNvcHkoZzpwbHVncyksICdzOmlzX21hbmFnZWQodjprZXkpJykKICBsZXQgdG9kbyA9IGVtcHR5KGFyZ3MpID8gZmlsdGVyKG1hbmFnZWQsICchdjp2YWwuZnJvemVuIHx8ICFpc2RpcmVjdG9yeSh2OnZhbC5kaXIpJykgOgogICAgICAgICAgICAgICAgICAgICAgICAgXCBmaWx0ZXIobWFuYWdlZCwgJ2luZGV4KGFyZ3MsIHY6a2V5KSA+PSAwJykKCiAgaWYgZW1wdHkodG9kbykKICAgIHJldHVybiBzOndhcm4oJ2VjaG8nLCAnTm8gcGx1Z2luIHRvICcuIChhOnB1bGwgPyAndXBkYXRlJyA6ICdpbnN0YWxsJykpCiAgZW5kaWYKCiAgaWYgIXM6aXNfd2luICYmIHM6Z2l0X3ZlcnNpb25fcmVxdWlyZW1lbnQoMiwgMykKICAgIGxldCBzOmdpdF90ZXJtaW5hbF9wcm9tcHQgPSBleGlzdHMoJyRHSVRfVEVSTUlOQUxfUFJPTVBUJykgPyAkR0lUX1RFUk1JTkFMX1BST01QVCA6ICcnCiAgICBsZXQgJEdJVF9URVJNSU5BTF9QUk9NUFQgPSAwCiAgICBmb3IgcGx1ZyBpbiB2YWx1ZXModG9kbykKICAgICAgbGV0IHBsdWcudXJpID0gc3Vic3RpdHV0ZShwbHVnLnVyaSwKICAgICAgICAgICAgXCAnXmh0dHBzOi8vZ2l0OjpAZ2l0aHViXC5jb20nLCAnaHR0cHM6Ly9naXRodWIuY29tJywgJycpCiAgICBlbmRmb3IKICBlbmRpZgoKICBpZiAhaXNkaXJlY3RvcnkoZzpwbHVnX2hvbWUpCiAgICB0cnkKICAgICAgY2FsbCBta2RpcihnOnBsdWdfaG9tZSwgJ3AnKQogICAgY2F0Y2gKICAgICAgcmV0dXJuIHM6ZXJyKHByaW50ZignSW52YWxpZCBwbHVnIGRpcmVjdG9yeTogJXMuICcuCiAgICAgICAgICAgICAgXCAnVHJ5IHRvIGNhbGwgcGx1ZyNiZWdpbiB3aXRoIGEgdmFsaWQgZGlyZWN0b3J5JywgZzpwbHVnX2hvbWUpKQogICAgZW5kdHJ5CiAgZW5kaWYKCiAgaWYgaGFzKCdudmltJykgJiYgIWV4aXN0cygnKmpvYndhaXQnKSAmJiB0aHJlYWRzID4gMQogICAgY2FsbCBzOndhcm4oJ2VjaG9tJywgJ1t2aW0tcGx1Z10gVXBkYXRlIE5lb3ZpbSBmb3IgcGFyYWxsZWwgaW5zdGFsbGVyJykKICBlbmRpZgoKICBsZXQgdXNlX2pvYiA9IHM6bnZpbSB8fCBzOnZpbTgKICBsZXQgcHl0aG9uID0gKGhhcygncHl0aG9uJykgfHwgaGFzKCdweXRob24zJykpICYmICF1c2Vfam9iCiAgbGV0IHJ1YnkgPSBoYXMoJ3J1YnknKSAmJiAhdXNlX2pvYiAmJiAodjp2ZXJzaW9uID49IDcwMyB8fCB2OnZlcnNpb24gPT0gNzAyICYmIGhhcygncGF0Y2gzNzQnKSkgJiYgIShzOmlzX3dpbiAmJiBoYXMoJ2d1aV9ydW5uaW5nJykpICYmIHRocmVhZHMgPiAxICYmIHM6Y2hlY2tfcnVieSgpCgogIGxldCBzOnVwZGF0ZSA9IHsKICAgIFwgJ3N0YXJ0JzogICByZWx0aW1lKCksCiAgICBcICdhbGwnOiAgICAgdG9kbywKICAgIFwgJ3RvZG8nOiAgICBjb3B5KHRvZG8pLAogICAgXCAnZXJyb3JzJzogIFtdLAogICAgXCAncHVsbCc6ICAgIGE6cHVsbCwKICAgIFwgJ2ZvcmNlJzogICBhOmZvcmNlLAogICAgXCAnbmV3JzogICAgIHt9LAogICAgXCAndGhyZWFkcyc6IChweXRob24gfHwgcnVieSB8fCB1c2Vfam9iKSA/IG1pbihbbGVuKHRvZG8pLCB0aHJlYWRzXSkgOiAxLAogICAgXCAnYmFyJzogICAgICcnLAogICAgXCAnZmluJzogICAgIDAKICBcIH0KCiAgY2FsbCBzOnByZXBhcmUoMSkKICBjYWxsIGFwcGVuZCgwLCBbJycsICcnXSkKICBub3JtYWwhIDJHCiAgc2lsZW50ISByZWRyYXcKCiAgbGV0IHM6Y2xvbmVfb3B0ID0gZ2V0KGc6LCAncGx1Z19zaGFsbG93JywgMSkgPwogICAgICAgIFwgJy0tZGVwdGggMScgLiAoczpnaXRfdmVyc2lvbl9yZXF1aXJlbWVudCgxLCA3LCAxMCkgPyAnIC0tbm8tc2luZ2xlLWJyYW5jaCcgOiAnJykgOiAnJwoKICBpZiBoYXMoJ3dpbjMydW5peCcpIHx8IGhhcygnd3NsJykKICAgIGxldCBzOmNsb25lX29wdCAuPSAnIC1jIGNvcmUuZW9sPWxmIC1jIGNvcmUuYXV0b2NybGY9aW5wdXQnCiAgZW5kaWYKCiAgbGV0IHM6c3VibW9kdWxlX29wdCA9IHM6Z2l0X3ZlcnNpb25fcmVxdWlyZW1lbnQoMiwgOCkgPyAnIC0tam9icz0nLnRocmVhZHMgOiAnJwoKICAiIFB5dGhvbiB2ZXJzaW9uIHJlcXVpcmVtZW50ICg+PSAyLjcpCiAgaWYgcHl0aG9uICYmICFoYXMoJ3B5dGhvbjMnKSAmJiAhcnVieSAmJiAhdXNlX2pvYiAmJiBzOnVwZGF0ZS50aHJlYWRzID4gMQogICAgcmVkaXIgPT4gcHl2CiAgICBzaWxlbnQgcHl0aG9uIGltcG9ydCBwbGF0Zm9ybTsgcHJpbnQgcGxhdGZvcm0ucHl0aG9uX3ZlcnNpb24oKQogICAgcmVkaXIgRU5ECiAgICBsZXQgcHl0aG9uID0gczp2ZXJzaW9uX3JlcXVpcmVtZW50KAogICAgICAgICAgXCBtYXAoc3BsaXQoc3BsaXQocHl2KVswXSwgJ1wuJyksICdzdHIybnIodjp2YWwpJyksIFsyLCA2XSkKICBlbmRpZgoKICBpZiAocHl0aG9uIHx8IHJ1YnkpICYmIHM6dXBkYXRlLnRocmVhZHMgPiAxCiAgICB0cnkKICAgICAgbGV0IGltZCA9ICZpbWQKICAgICAgaWYgczptYWNfZ3VpCiAgICAgICAgc2V0IG5vaW1kCiAgICAgIGVuZGlmCiAgICAgIGlmIHJ1YnkKICAgICAgICBjYWxsIHM6dXBkYXRlX3J1YnkoKQogICAgICBlbHNlCiAgICAgICAgY2FsbCBzOnVwZGF0ZV9weXRob24oKQogICAgICBlbmRpZgogICAgY2F0Y2gKICAgICAgbGV0IGxpbmVzID0gZ2V0bGluZSg0LCAnJCcpCiAgICAgIGxldCBwcmludGVkID0ge30KICAgICAgc2lsZW50ISA0LCRkIF8KICAgICAgZm9yIGxpbmUgaW4gbGluZXMKICAgICAgICBsZXQgbmFtZSA9IHM6ZXh0cmFjdF9uYW1lKGxpbmUsICcuJywgJycpCiAgICAgICAgaWYgZW1wdHkobmFtZSkgfHwgIWhhc19rZXkocHJpbnRlZCwgbmFtZSkKICAgICAgICAgIGNhbGwgYXBwZW5kKCckJywgbGluZSkKICAgICAgICAgIGlmICFlbXB0eShuYW1lKQogICAgICAgICAgICBsZXQgcHJpbnRlZFtuYW1lXSA9IDEKICAgICAgICAgICAgaWYgbGluZVswXSA9PSAneCcgJiYgaW5kZXgoczp1cGRhdGUuZXJyb3JzLCBuYW1lKSA8IDAKICAgICAgICAgICAgICBjYWxsIGFkZChzOnVwZGF0ZS5lcnJvcnMsIG5hbWUpCiAgICAgICAgICAgIGVuZAogICAgICAgICAgZW5kaWYKICAgICAgICBlbmRpZgogICAgICBlbmRmb3IKICAgIGZpbmFsbHkKICAgICAgbGV0ICZpbWQgPSBpbWQKICAgICAgY2FsbCBzOnVwZGF0ZV9maW5pc2goKQogICAgZW5kdHJ5CiAgZWxzZQogICAgY2FsbCBzOnVwZGF0ZV92aW0oKQogICAgd2hpbGUgdXNlX2pvYiAmJiBzeW5jCiAgICAgIHNsZWVwIDEwMG0KICAgICAgaWYgczp1cGRhdGUuZmluCiAgICAgICAgYnJlYWsKICAgICAgZW5kaWYKICAgIGVuZHdoaWxlCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmxvZzQobmFtZSwgbXNnKQogIGNhbGwgc2V0bGluZSg0LCBwcmludGYoJy0gJXMgKCVzKScsIGE6bXNnLCBhOm5hbWUpKQogIHJlZHJhdwplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6dXBkYXRlX2ZpbmlzaCgpCiAgaWYgZXhpc3RzKCdzOmdpdF90ZXJtaW5hbF9wcm9tcHQnKQogICAgbGV0ICRHSVRfVEVSTUlOQUxfUFJPTVBUID0gczpnaXRfdGVybWluYWxfcHJvbXB0CiAgZW5kaWYKICBpZiBzOnN3aXRjaF9pbigpCiAgICBjYWxsIGFwcGVuZCgzLCAnLSBVcGRhdGluZyAuLi4nKSB8IDQKICAgIGZvciBbbmFtZSwgc3BlY10gaW4gaXRlbXMoZmlsdGVyKGNvcHkoczp1cGRhdGUuYWxsKSwgJ2luZGV4KHM6dXBkYXRlLmVycm9ycywgdjprZXkpIDwgMCAmJiAoczp1cGRhdGUuZm9yY2UgfHwgczp1cGRhdGUucHVsbCB8fCBoYXNfa2V5KHM6dXBkYXRlLm5ldywgdjprZXkpKScpKQogICAgICBsZXQgW3BvcywgX10gPSBzOmxvZ3BvcyhuYW1lKQogICAgICBpZiAhcG9zCiAgICAgICAgY29udGludWUKICAgICAgZW5kaWYKICAgICAgaWYgaGFzX2tleShzcGVjLCAnY29tbWl0JykKICAgICAgICBjYWxsIHM6bG9nNChuYW1lLCAnQ2hlY2tpbmcgb3V0ICcuc3BlYy5jb21taXQpCiAgICAgICAgbGV0IG91dCA9IHM6Y2hlY2tvdXQoc3BlYykKICAgICAgZWxzZWlmIGhhc19rZXkoc3BlYywgJ3RhZycpCiAgICAgICAgbGV0IHRhZyA9IHNwZWMudGFnCiAgICAgICAgaWYgdGFnID1+ICdcKicKICAgICAgICAgIGxldCB0YWdzID0gczpsaW5lcyhzOnN5c3RlbSgnZ2l0IHRhZyAtLWxpc3QgJy5wbHVnI3NoZWxsZXNjYXBlKHRhZykuJyAtLXNvcnQgLXZlcnNpb246cmVmbmFtZSAyPiYxJywgc3BlYy5kaXIpKQogICAgICAgICAgaWYgIXY6c2hlbGxfZXJyb3IgJiYgIWVtcHR5KHRhZ3MpCiAgICAgICAgICAgIGxldCB0YWcgPSB0YWdzWzBdCiAgICAgICAgICAgIGNhbGwgczpsb2c0KG5hbWUsIHByaW50ZignTGF0ZXN0IHRhZyBmb3IgJXMgLT4gJXMnLCBzcGVjLnRhZywgdGFnKSkKICAgICAgICAgICAgY2FsbCBhcHBlbmQoMywgJycpCiAgICAgICAgICBlbmRpZgogICAgICAgIGVuZGlmCiAgICAgICAgY2FsbCBzOmxvZzQobmFtZSwgJ0NoZWNraW5nIG91dCAnLnRhZykKICAgICAgICBsZXQgb3V0ID0gczpzeXN0ZW0oJ2dpdCBjaGVja291dCAtcSAnLnBsdWcjc2hlbGxlc2NhcGUodGFnKS4nIC0tIDI+JjEnLCBzcGVjLmRpcikKICAgICAgZWxzZQogICAgICAgIGxldCBicmFuY2ggPSBnZXQoc3BlYywgJ2JyYW5jaCcsICdtYXN0ZXInKQogICAgICAgIGNhbGwgczpsb2c0KG5hbWUsICdNZXJnaW5nIG9yaWdpbi8nLnM6ZXNjKGJyYW5jaCkpCiAgICAgICAgbGV0IG91dCA9IHM6c3lzdGVtKCdnaXQgY2hlY2tvdXQgLXEgJy5wbHVnI3NoZWxsZXNjYXBlKGJyYW5jaCkuJyAtLSAyPiYxJwogICAgICAgICAgICAgIFwuIChoYXNfa2V5KHM6dXBkYXRlLm5ldywgbmFtZSkgPyAnJyA6ICgnJiYgZ2l0IG1lcmdlIC0tZmYtb25seSAnLnBsdWcjc2hlbGxlc2NhcGUoJ29yaWdpbi8nLmJyYW5jaCkuJyAyPiYxJykpLCBzcGVjLmRpcikKICAgICAgZW5kaWYKICAgICAgaWYgIXY6c2hlbGxfZXJyb3IgJiYgZmlsZXJlYWRhYmxlKHNwZWMuZGlyLicvLmdpdG1vZHVsZXMnKSAmJgogICAgICAgICAgICBcIChzOnVwZGF0ZS5mb3JjZSB8fCBoYXNfa2V5KHM6dXBkYXRlLm5ldywgbmFtZSkgfHwgczppc191cGRhdGVkKHNwZWMuZGlyKSkKICAgICAgICBjYWxsIHM6bG9nNChuYW1lLCAnVXBkYXRpbmcgc3VibW9kdWxlcy4gVGhpcyBtYXkgdGFrZSBhIHdoaWxlLicpCiAgICAgICAgbGV0IG91dCAuPSBzOmJhbmcoJ2dpdCBzdWJtb2R1bGUgdXBkYXRlIC0taW5pdCAtLXJlY3Vyc2l2ZScuczpzdWJtb2R1bGVfb3B0LicgMj4mMScsIHNwZWMuZGlyKQogICAgICBlbmRpZgogICAgICBsZXQgbXNnID0gczpmb3JtYXRfbWVzc2FnZSh2OnNoZWxsX2Vycm9yID8gJ3gnOiAnLScsIG5hbWUsIG91dCkKICAgICAgaWYgdjpzaGVsbF9lcnJvcgogICAgICAgIGNhbGwgYWRkKHM6dXBkYXRlLmVycm9ycywgbmFtZSkKICAgICAgICBjYWxsIHM6cmVncmVzc19iYXIoKQogICAgICAgIHNpbGVudCBleGVjdXRlIHBvcyAnZCBfJwogICAgICAgIGNhbGwgYXBwZW5kKDQsIG1zZykgfCA0CiAgICAgIGVsc2VpZiAhZW1wdHkob3V0KQogICAgICAgIGNhbGwgc2V0bGluZShwb3MsIG1zZ1swXSkKICAgICAgZW5kaWYKICAgICAgcmVkcmF3CiAgICBlbmRmb3IKICAgIHNpbGVudCA0IGQgXwogICAgdHJ5CiAgICAgIGNhbGwgczpkbyhzOnVwZGF0ZS5wdWxsLCBzOnVwZGF0ZS5mb3JjZSwgZmlsdGVyKGNvcHkoczp1cGRhdGUuYWxsKSwgJ2luZGV4KHM6dXBkYXRlLmVycm9ycywgdjprZXkpIDwgMCAmJiBoYXNfa2V5KHY6dmFsLCAiZG8iKScpKQogICAgY2F0Y2gKICAgICAgY2FsbCBzOndhcm4oJ2VjaG9tJywgdjpleGNlcHRpb24pCiAgICAgIGNhbGwgczp3YXJuKCdlY2hvJywgJycpCiAgICAgIHJldHVybgogICAgZW5kdHJ5CiAgICBjYWxsIHM6ZmluaXNoKHM6dXBkYXRlLnB1bGwpCiAgICBjYWxsIHNldGxpbmUoMSwgJ1VwZGF0ZWQuIEVsYXBzZWQgdGltZTogJyAuIHNwbGl0KHJlbHRpbWVzdHIocmVsdGltZShzOnVwZGF0ZS5zdGFydCkpKVswXSAuICcgc2VjLicpCiAgICBjYWxsIHM6c3dpdGNoX291dCgnbm9ybWFsISBnZycpCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmpvYl9hYm9ydCgpCiAgaWYgKCFzOm52aW0gJiYgIXM6dmltOCkgfHwgIWV4aXN0cygnczpqb2JzJykKICAgIHJldHVybgogIGVuZGlmCgogIGZvciBbbmFtZSwgal0gaW4gaXRlbXMoczpqb2JzKQogICAgaWYgczpudmltCiAgICAgIHNpbGVudCEgY2FsbCBqb2JzdG9wKGouam9iaWQpCiAgICBlbHNlaWYgczp2aW04CiAgICAgIHNpbGVudCEgY2FsbCBqb2Jfc3RvcChqLmpvYmlkKQogICAgZW5kaWYKICAgIGlmIGoubmV3CiAgICAgIGNhbGwgczpybV9yZihnOnBsdWdzW25hbWVdLmRpcikKICAgIGVuZGlmCiAgZW5kZm9yCiAgbGV0IHM6am9icyA9IHt9CmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpsYXN0X25vbl9lbXB0eV9saW5lKGxpbmVzKQogIGxldCBsZW4gPSBsZW4oYTpsaW5lcykKICBmb3IgaWR4IGluIHJhbmdlKGxlbikKICAgIGxldCBsaW5lID0gYTpsaW5lc1tsZW4taWR4LTFdCiAgICBpZiAhZW1wdHkobGluZSkKICAgICAgcmV0dXJuIGxpbmUKICAgIGVuZGlmCiAgZW5kZm9yCiAgcmV0dXJuICcnCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpqb2Jfb3V0X2NiKHNlbGYsIGRhdGEpIGFib3J0CiAgbGV0IHNlbGYgPSBhOnNlbGYKICBsZXQgZGF0YSA9IHJlbW92ZShzZWxmLmxpbmVzLCAtMSkgLiBhOmRhdGEKICBsZXQgbGluZXMgPSBtYXAoc3BsaXQoZGF0YSwgIlxuIiwgMSksICdzcGxpdCh2OnZhbCwgIlxyIiwgMSlbLTFdJykKICBjYWxsIGV4dGVuZChzZWxmLmxpbmVzLCBsaW5lcykKICAiIFRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIGJ1ZmZlciB1cGRhdGVzCiAgbGV0IHNlbGYudGljayA9IGdldChzZWxmLCAndGljaycsIC0xKSArIDEKICBpZiAhc2VsZi5ydW5uaW5nIHx8IHNlbGYudGljayAlIGxlbihzOmpvYnMpID09IDAKICAgIGxldCBidWxsZXQgPSBzZWxmLnJ1bm5pbmcgPyAoc2VsZi5uZXcgPyAnKycgOiAnKicpIDogKHNlbGYuZXJyb3IgPyAneCcgOiAnLScpCiAgICBsZXQgcmVzdWx0ID0gc2VsZi5lcnJvciA/IGpvaW4oc2VsZi5saW5lcywgIlxuIikgOiBzOmxhc3Rfbm9uX2VtcHR5X2xpbmUoc2VsZi5saW5lcykKICAgIGNhbGwgczpsb2coYnVsbGV0LCBzZWxmLm5hbWUsIHJlc3VsdCkKICBlbmRpZgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6am9iX2V4aXRfY2Ioc2VsZiwgZGF0YSkgYWJvcnQKICBsZXQgYTpzZWxmLnJ1bm5pbmcgPSAwCiAgbGV0IGE6c2VsZi5lcnJvciA9IGE6ZGF0YSAhPSAwCiAgY2FsbCBzOnJlYXAoYTpzZWxmLm5hbWUpCiAgY2FsbCBzOnRpY2soKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6am9iX2NiKGZuLCBqb2IsIGNoLCBkYXRhKQogIGlmICFzOnBsdWdfd2luZG93X2V4aXN0cygpICIgcGx1ZyB3aW5kb3cgY2xvc2VkCiAgICByZXR1cm4gczpqb2JfYWJvcnQoKQogIGVuZGlmCiAgY2FsbCBjYWxsKGE6Zm4sIFthOmpvYiwgYTpkYXRhXSkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOm52aW1fY2Ioam9iX2lkLCBkYXRhLCBldmVudCkgZGljdCBhYm9ydAogIHJldHVybiBhOmV2ZW50ID09ICdzdGRvdXQnID8KICAgIFwgczpqb2JfY2IoJ3M6am9iX291dF9jYicsICBzZWxmLCAwLCBqb2luKGE6ZGF0YSwgIlxuIikpIDoKICAgIFwgczpqb2JfY2IoJ3M6am9iX2V4aXRfY2InLCBzZWxmLCAwLCBhOmRhdGEpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpzcGF3bihuYW1lLCBjbWQsIG9wdHMpCiAgbGV0IGpvYiA9IHsgJ25hbWUnOiBhOm5hbWUsICdydW5uaW5nJzogMSwgJ2Vycm9yJzogMCwgJ2xpbmVzJzogWycnXSwKICAgICAgICAgICAgXCAnbmV3JzogZ2V0KGE6b3B0cywgJ25ldycsIDApIH0KICBsZXQgczpqb2JzW2E6bmFtZV0gPSBqb2IKICBsZXQgY21kID0gaGFzX2tleShhOm9wdHMsICdkaXInKSA/IHM6d2l0aF9jZChhOmNtZCwgYTpvcHRzLmRpciwgMCkgOiBhOmNtZAogIGxldCBhcmd2ID0gczppc193aW4gPyBbJ2NtZCcsICcvcycsICcvYycsICciJy5jbWQuJyInXSA6IFsnc2gnLCAnLWMnLCBjbWRdCgogIGlmIHM6bnZpbQogICAgY2FsbCBleHRlbmQoam9iLCB7CiAgICBcICdvbl9zdGRvdXQnOiBmdW5jdGlvbignczpudmltX2NiJyksCiAgICBcICdvbl9leGl0JzogICBmdW5jdGlvbignczpudmltX2NiJyksCiAgICBcIH0pCiAgICBsZXQgamlkID0gczpwbHVnX2NhbGwoJ2pvYnN0YXJ0JywgYXJndiwgam9iKQogICAgaWYgamlkID4gMAogICAgICBsZXQgam9iLmpvYmlkID0gamlkCiAgICBlbHNlCiAgICAgIGxldCBqb2IucnVubmluZyA9IDAKICAgICAgbGV0IGpvYi5lcnJvciAgID0gMQogICAgICBsZXQgam9iLmxpbmVzICAgPSBbamlkIDwgMCA/IGFyZ3ZbMF0uJyBpcyBub3QgZXhlY3V0YWJsZScgOgogICAgICAgICAgICBcICdJbnZhbGlkIGFyZ3VtZW50cyAob3Igam9iIHRhYmxlIGlzIGZ1bGwpJ10KICAgIGVuZGlmCiAgZWxzZWlmIHM6dmltOAogICAgbGV0IGppZCA9IGpvYl9zdGFydChzOmlzX3dpbiA/IGpvaW4oYXJndiwgJyAnKSA6IGFyZ3YsIHsKICAgIFwgJ291dF9jYic6ICAgZnVuY3Rpb24oJ3M6am9iX2NiJywgWydzOmpvYl9vdXRfY2InLCAgam9iXSksCiAgICBcICdleGl0X2NiJzogIGZ1bmN0aW9uKCdzOmpvYl9jYicsIFsnczpqb2JfZXhpdF9jYicsIGpvYl0pLAogICAgXCAnb3V0X21vZGUnOiAncmF3JwogICAgXH0pCiAgICBpZiBqb2Jfc3RhdHVzKGppZCkgPT0gJ3J1bicKICAgICAgbGV0IGpvYi5qb2JpZCA9IGppZAogICAgZWxzZQogICAgICBsZXQgam9iLnJ1bm5pbmcgPSAwCiAgICAgIGxldCBqb2IuZXJyb3IgICA9IDEKICAgICAgbGV0IGpvYi5saW5lcyAgID0gWydGYWlsZWQgdG8gc3RhcnQgam9iJ10KICAgIGVuZGlmCiAgZWxzZQogICAgbGV0IGpvYi5saW5lcyA9IHM6bGluZXMoY2FsbCgnczpzeXN0ZW0nLCBbY21kXSkpCiAgICBsZXQgam9iLmVycm9yID0gdjpzaGVsbF9lcnJvciAhPSAwCiAgICBsZXQgam9iLnJ1bm5pbmcgPSAwCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnJlYXAobmFtZSkKICBsZXQgam9iID0gczpqb2JzW2E6bmFtZV0KICBpZiBqb2IuZXJyb3IKICAgIGNhbGwgYWRkKHM6dXBkYXRlLmVycm9ycywgYTpuYW1lKQogIGVsc2VpZiBnZXQoam9iLCAnbmV3JywgMCkKICAgIGxldCBzOnVwZGF0ZS5uZXdbYTpuYW1lXSA9IDEKICBlbmRpZgogIGxldCBzOnVwZGF0ZS5iYXIgLj0gam9iLmVycm9yID8gJ3gnIDogJz0nCgogIGxldCBidWxsZXQgPSBqb2IuZXJyb3IgPyAneCcgOiAnLScKICBsZXQgcmVzdWx0ID0gam9iLmVycm9yID8gam9pbihqb2IubGluZXMsICJcbiIpIDogczpsYXN0X25vbl9lbXB0eV9saW5lKGpvYi5saW5lcykKICBjYWxsIHM6bG9nKGJ1bGxldCwgYTpuYW1lLCBlbXB0eShyZXN1bHQpID8gJ09LJyA6IHJlc3VsdCkKICBjYWxsIHM6YmFyKCkKCiAgY2FsbCByZW1vdmUoczpqb2JzLCBhOm5hbWUpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpiYXIoKQogIGlmIHM6c3dpdGNoX2luKCkKICAgIGxldCB0b3RhbCA9IGxlbihzOnVwZGF0ZS5hbGwpCiAgICBjYWxsIHNldGxpbmUoMSwgKHM6dXBkYXRlLnB1bGwgPyAnVXBkYXRpbmcnIDogJ0luc3RhbGxpbmcnKS4KICAgICAgICAgIFwgJyBwbHVnaW5zICgnLmxlbihzOnVwZGF0ZS5iYXIpLicvJy50b3RhbC4nKScpCiAgICBjYWxsIHM6cHJvZ3Jlc3NfYmFyKDIsIHM6dXBkYXRlLmJhciwgdG90YWwpCiAgICBjYWxsIHM6c3dpdGNoX291dCgpCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmxvZ3BvcyhuYW1lKQogIGxldCBtYXggPSBsaW5lKCckJykKICBmb3IgaSBpbiByYW5nZSg0LCBtYXggPiA0ID8gbWF4IDogNCkKICAgIGlmIGdldGxpbmUoaSkgPX4jICdeWy0reCpdICcuYTpuYW1lLic6JwogICAgICBmb3IgaiBpbiByYW5nZShpICsgMSwgbWF4ID4gNSA/IG1heCA6IDUpCiAgICAgICAgaWYgZ2V0bGluZShqKSAhfiAnXiAnCiAgICAgICAgICByZXR1cm4gW2ksIGogLSAxXQogICAgICAgIGVuZGlmCiAgICAgIGVuZGZvcgogICAgICByZXR1cm4gW2ksIGldCiAgICBlbmRpZgogIGVuZGZvcgogIHJldHVybiBbMCwgMF0KZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmxvZyhidWxsZXQsIG5hbWUsIGxpbmVzKQogIGlmIHM6c3dpdGNoX2luKCkKICAgIGxldCBbYiwgZV0gPSBzOmxvZ3BvcyhhOm5hbWUpCiAgICBpZiBiID4gMAogICAgICBzaWxlbnQgZXhlY3V0ZSBwcmludGYoJyVkLCVkIGQgXycsIGIsIGUpCiAgICAgIGlmIGIgPiB3aW5oZWlnaHQoJy4nKQogICAgICAgIGxldCBiID0gNAogICAgICBlbmRpZgogICAgZWxzZQogICAgICBsZXQgYiA9IDQKICAgIGVuZGlmCiAgICAiIEZJWE1FIEZvciBzb21lIHJlYXNvbiwgbm9tb2RpZmlhYmxlIGlzIHNldCBhZnRlciA6ZCBpbiB2aW04CiAgICBzZXRsb2NhbCBtb2RpZmlhYmxlCiAgICBjYWxsIGFwcGVuZChiIC0gMSwgczpmb3JtYXRfbWVzc2FnZShhOmJ1bGxldCwgYTpuYW1lLCBhOmxpbmVzKSkKICAgIGNhbGwgczpzd2l0Y2hfb3V0KCkKICBlbmRpZgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6dXBkYXRlX3ZpbSgpCiAgbGV0IHM6am9icyA9IHt9CgogIGNhbGwgczpiYXIoKQogIGNhbGwgczp0aWNrKCkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnRpY2soKQogIGxldCBwdWxsID0gczp1cGRhdGUucHVsbAogIGxldCBwcm9nID0gczpwcm9ncmVzc19vcHQoczpudmltIHx8IHM6dmltOCkKd2hpbGUgMSAiIFdpdGhvdXQgVENPLCBWaW0gc3RhY2sgaXMgYm91bmQgdG8gZXhwbG9kZQogIGlmIGVtcHR5KHM6dXBkYXRlLnRvZG8pCiAgICBpZiBlbXB0eShzOmpvYnMpICYmICFzOnVwZGF0ZS5maW4KICAgICAgY2FsbCBzOnVwZGF0ZV9maW5pc2goKQogICAgICBsZXQgczp1cGRhdGUuZmluID0gMQogICAgZW5kaWYKICAgIHJldHVybgogIGVuZGlmCgogIGxldCBuYW1lID0ga2V5cyhzOnVwZGF0ZS50b2RvKVswXQogIGxldCBzcGVjID0gcmVtb3ZlKHM6dXBkYXRlLnRvZG8sIG5hbWUpCiAgbGV0IG5ldyAgPSBlbXB0eShnbG9icGF0aChzcGVjLmRpciwgJy5naXQnLCAxKSkKCiAgY2FsbCBzOmxvZyhuZXcgPyAnKycgOiAnKicsIG5hbWUsIHB1bGwgPyAnVXBkYXRpbmcgLi4uJyA6ICdJbnN0YWxsaW5nIC4uLicpCiAgcmVkcmF3CgogIGxldCBoYXNfdGFnID0gaGFzX2tleShzcGVjLCAndGFnJykKICBpZiAhbmV3CiAgICBsZXQgW2Vycm9yLCBfXSA9IHM6Z2l0X3ZhbGlkYXRlKHNwZWMsIDApCiAgICBpZiBlbXB0eShlcnJvcikKICAgICAgaWYgcHVsbAogICAgICAgIGxldCBmZXRjaF9vcHQgPSAoaGFzX3RhZyAmJiAhZW1wdHkoZ2xvYnBhdGgoc3BlYy5kaXIsICcuZ2l0L3NoYWxsb3cnKSkpID8gJy0tZGVwdGggOTk5OTk5OTknIDogJycKICAgICAgICBjYWxsIHM6c3Bhd24obmFtZSwgcHJpbnRmKCdnaXQgZmV0Y2ggJXMgJXMgMj4mMScsIGZldGNoX29wdCwgcHJvZyksIHsgJ2Rpcic6IHNwZWMuZGlyIH0pCiAgICAgIGVsc2UKICAgICAgICBsZXQgczpqb2JzW25hbWVdID0geyAncnVubmluZyc6IDAsICdsaW5lcyc6IFsnQWxyZWFkeSBpbnN0YWxsZWQnXSwgJ2Vycm9yJzogMCB9CiAgICAgIGVuZGlmCiAgICBlbHNlCiAgICAgIGxldCBzOmpvYnNbbmFtZV0gPSB7ICdydW5uaW5nJzogMCwgJ2xpbmVzJzogczpsaW5lcyhlcnJvciksICdlcnJvcic6IDEgfQogICAgZW5kaWYKICBlbHNlCiAgICBjYWxsIHM6c3Bhd24obmFtZSwKICAgICAgICAgIFwgcHJpbnRmKCdnaXQgY2xvbmUgJXMgJXMgJXMgJXMgMj4mMScsCiAgICAgICAgICBcIGhhc190YWcgPyAnJyA6IHM6Y2xvbmVfb3B0LAogICAgICAgICAgXCBwcm9nLAogICAgICAgICAgXCBwbHVnI3NoZWxsZXNjYXBlKHNwZWMudXJpLCB7J3NjcmlwdCc6IDB9KSwKICAgICAgICAgIFwgcGx1ZyNzaGVsbGVzY2FwZShzOnRyaW0oc3BlYy5kaXIpLCB7J3NjcmlwdCc6IDB9KSksIHsgJ25ldyc6IDEgfSkKICBlbmRpZgoKICBpZiAhczpqb2JzW25hbWVdLnJ1bm5pbmcKICAgIGNhbGwgczpyZWFwKG5hbWUpCiAgZW5kaWYKICBpZiBsZW4oczpqb2JzKSA+PSBzOnVwZGF0ZS50aHJlYWRzCiAgICBicmVhawogIGVuZGlmCmVuZHdoaWxlCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczp1cGRhdGVfcHl0aG9uKCkKbGV0IHB5X2V4ZSA9IGhhcygncHl0aG9uJykgPyAncHl0aG9uJyA6ICdweXRob24zJwpleGVjdXRlIHB5X2V4ZSAiPDwgRU9GIgppbXBvcnQgZGF0ZXRpbWUKaW1wb3J0IGZ1bmN0b29scwppbXBvcnQgb3MKdHJ5OgogIGltcG9ydCBxdWV1ZQpleGNlcHQgSW1wb3J0RXJyb3I6CiAgaW1wb3J0IFF1ZXVlIGFzIHF1ZXVlCmltcG9ydCByYW5kb20KaW1wb3J0IHJlCmltcG9ydCBzaHV0aWwKaW1wb3J0IHNpZ25hbAppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgdGVtcGZpbGUKaW1wb3J0IHRocmVhZGluZyBhcyB0aHIKaW1wb3J0IHRpbWUKaW1wb3J0IHRyYWNlYmFjawppbXBvcnQgdmltCgpHX05WSU0gPSB2aW0uZXZhbCgiaGFzKCdudmltJykiKSA9PSAnMScKR19QVUxMID0gdmltLmV2YWwoJ3M6dXBkYXRlLnB1bGwnKSA9PSAnMScKR19SRVRSSUVTID0gaW50KHZpbS5ldmFsKCdnZXQoZzosICJwbHVnX3JldHJpZXMiLCAyKScpKSArIDEKR19USU1FT1VUID0gaW50KHZpbS5ldmFsKCdnZXQoZzosICJwbHVnX3RpbWVvdXQiLCA2MCknKSkKR19DTE9ORV9PUFQgPSB2aW0uZXZhbCgnczpjbG9uZV9vcHQnKQpHX1BST0dSRVNTID0gdmltLmV2YWwoJ3M6cHJvZ3Jlc3Nfb3B0KDEpJykKR19MT0dfUFJPQiA9IDEuMCAvIGludCh2aW0uZXZhbCgnczp1cGRhdGUudGhyZWFkcycpKQpHX1NUT1AgPSB0aHIuRXZlbnQoKQpHX0lTX1dJTiA9IHZpbS5ldmFsKCdzOmlzX3dpbicpID09ICcxJwoKY2xhc3MgUGx1Z0Vycm9yKEV4Y2VwdGlvbik6CiAgZGVmIF9faW5pdF9fKHNlbGYsIG1zZyk6CiAgICBzZWxmLm1zZyA9IG1zZwpjbGFzcyBDbWRUaW1lZE91dChQbHVnRXJyb3IpOgogIHBhc3MKY2xhc3MgQ21kRmFpbGVkKFBsdWdFcnJvcik6CiAgcGFzcwpjbGFzcyBJbnZhbGlkVVJJKFBsdWdFcnJvcik6CiAgcGFzcwpjbGFzcyBBY3Rpb24ob2JqZWN0KToKICBJTlNUQUxMLCBVUERBVEUsIEVSUk9SLCBET05FID0gWycrJywgJyonLCAneCcsICctJ10KCmNsYXNzIEJ1ZmZlcihvYmplY3QpOgogIGRlZiBfX2luaXRfXyhzZWxmLCBsb2NrLCBudW1fcGx1Z3MsIGlzX3B1bGwpOgogICAgc2VsZi5iYXIgPSAnJwogICAgc2VsZi5ldmVudCA9ICdVcGRhdGluZycgaWYgaXNfcHVsbCBlbHNlICdJbnN0YWxsaW5nJwogICAgc2VsZi5sb2NrID0gbG9jawogICAgc2VsZi5tYXh5ID0gaW50KHZpbS5ldmFsKCd3aW5oZWlnaHQoIi4iKScpKQogICAgc2VsZi5udW1fcGx1Z3MgPSBudW1fcGx1Z3MKCiAgZGVmIF9fd2hlcmUoc2VsZiwgbmFtZSk6CiAgICAiIiIgRmluZCBmaXJzdCBsaW5lIHdpdGggbmFtZSBpbiBjdXJyZW50IGJ1ZmZlci4gUmV0dXJuIGxpbmUgbnVtLiAiIiIKICAgIGZvdW5kLCBsbnVtID0gRmFsc2UsIDAKICAgIG1hdGNoZXIgPSByZS5jb21waWxlKCdeWy0reCpdIHswfTonLmZvcm1hdChuYW1lKSkKICAgIGZvciBsaW5lIGluIHZpbS5jdXJyZW50LmJ1ZmZlcjoKICAgICAgaWYgbWF0Y2hlci5zZWFyY2gobGluZSkgaXMgbm90IE5vbmU6CiAgICAgICAgZm91bmQgPSBUcnVlCiAgICAgICAgYnJlYWsKICAgICAgbG51bSArPSAxCgogICAgaWYgbm90IGZvdW5kOgogICAgICBsbnVtID0gLTEKICAgIHJldHVybiBsbnVtCgogIGRlZiBoZWFkZXIoc2VsZik6CiAgICBjdXJidWYgPSB2aW0uY3VycmVudC5idWZmZXIKICAgIGN1cmJ1ZlswXSA9IHNlbGYuZXZlbnQgKyAnIHBsdWdpbnMgKHswfS97MX0pJy5mb3JtYXQobGVuKHNlbGYuYmFyKSwgc2VsZi5udW1fcGx1Z3MpCgogICAgbnVtX3NwYWNlcyA9IHNlbGYubnVtX3BsdWdzIC0gbGVuKHNlbGYuYmFyKQogICAgY3VyYnVmWzFdID0gJ1t7MH17MX1dJy5mb3JtYXQoc2VsZi5iYXIsIG51bV9zcGFjZXMgKiAnICcpCgogICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgIHZpbS5jb21tYW5kKCdub3JtYWwhIDJHJykKICAgICAgdmltLmNvbW1hbmQoJ3JlZHJhdycpCgogIGRlZiB3cml0ZShzZWxmLCBhY3Rpb24sIG5hbWUsIGxpbmVzKToKICAgIGZpcnN0LCByZXN0ID0gbGluZXNbMF0sIGxpbmVzWzE6XQogICAgbXNnID0gWyd7MH0gezF9ezJ9ezN9Jy5mb3JtYXQoYWN0aW9uLCBuYW1lLCAnOiAnIGlmIGZpcnN0IGVsc2UgJycsIGZpcnN0KV0KICAgIG1zZy5leHRlbmQoWycgICAgJyArIGxpbmUgZm9yIGxpbmUgaW4gcmVzdF0pCgogICAgdHJ5OgogICAgICBpZiBhY3Rpb24gPT0gQWN0aW9uLkVSUk9SOgogICAgICAgIHNlbGYuYmFyICs9ICd4JwogICAgICAgIHZpbS5jb21tYW5kKCJjYWxsIGFkZChzOnVwZGF0ZS5lcnJvcnMsICd7MH0nKSIuZm9ybWF0KG5hbWUpKQogICAgICBlbGlmIGFjdGlvbiA9PSBBY3Rpb24uRE9ORToKICAgICAgICBzZWxmLmJhciArPSAnPScKCiAgICAgIGN1cmJ1ZiA9IHZpbS5jdXJyZW50LmJ1ZmZlcgogICAgICBsbnVtID0gc2VsZi5fX3doZXJlKG5hbWUpCiAgICAgIGlmIGxudW0gIT0gLTE6ICMgRm91bmQgbWF0Y2hpbmcgbGluZSBudW0KICAgICAgICBkZWwgY3VyYnVmW2xudW1dCiAgICAgICAgaWYgbG51bSA+IHNlbGYubWF4eSBhbmQgYWN0aW9uIGluIHNldChbQWN0aW9uLklOU1RBTEwsIEFjdGlvbi5VUERBVEVdKToKICAgICAgICAgIGxudW0gPSAzCiAgICAgIGVsc2U6CiAgICAgICAgbG51bSA9IDMKICAgICAgY3VyYnVmLmFwcGVuZChtc2csIGxudW0pCgogICAgICBzZWxmLmhlYWRlcigpCiAgICBleGNlcHQgdmltLmVycm9yOgogICAgICBwYXNzCgpjbGFzcyBDb21tYW5kKG9iamVjdCk6CiAgQ0QgPSAnY2QgL2QnIGlmIEdfSVNfV0lOIGVsc2UgJ2NkJwoKICBkZWYgX19pbml0X18oc2VsZiwgY21kLCBjbWRfZGlyPU5vbmUsIHRpbWVvdXQ9NjAsIGNiPU5vbmUsIGNsZWFuPU5vbmUpOgogICAgc2VsZi5jbWQgPSBjbWQKICAgIGlmIGNtZF9kaXI6CiAgICAgIHNlbGYuY21kID0gJ3swfSB7MX0gJiYgezJ9Jy5mb3JtYXQoQ29tbWFuZC5DRCwgY21kX2Rpciwgc2VsZi5jbWQpCiAgICBzZWxmLnRpbWVvdXQgPSB0aW1lb3V0CiAgICBzZWxmLmNhbGxiYWNrID0gY2IgaWYgY2IgZWxzZSAobGFtYmRhIG1zZzogTm9uZSkKICAgIHNlbGYuY2xlYW4gPSBjbGVhbiBpZiBjbGVhbiBlbHNlIChsYW1iZGE6IE5vbmUpCiAgICBzZWxmLnByb2MgPSBOb25lCgogIEBwcm9wZXJ0eQogIGRlZiBhbGl2ZShzZWxmKToKICAgICIiIiBSZXR1cm5zIHRydWUgb25seSBpZiBjb21tYW5kIHN0aWxsIHJ1bm5pbmcuICIiIgogICAgcmV0dXJuIHNlbGYucHJvYyBhbmQgc2VsZi5wcm9jLnBvbGwoKSBpcyBOb25lCgogIGRlZiBleGVjdXRlKHNlbGYsIG50cmllcz0zKToKICAgICIiIiBFeGVjdXRlIHRoZSBjb21tYW5kIHdpdGggbnRyaWVzIGlmIENtZFRpbWVkT3V0LgogICAgICAgIFJldHVybnMgdGhlIG91dHB1dCBvZiB0aGUgY29tbWFuZCBpZiBubyBFeGNlcHRpb24uCiAgICAiIiIKICAgIGF0dGVtcHQsIGZpbmlzaGVkLCBsaW1pdCA9IDAsIEZhbHNlLCBzZWxmLnRpbWVvdXQKCiAgICB3aGlsZSBub3QgZmluaXNoZWQ6CiAgICAgIHRyeToKICAgICAgICBhdHRlbXB0ICs9IDEKICAgICAgICByZXN1bHQgPSBzZWxmLnRyeV9jb21tYW5kKCkKICAgICAgICBmaW5pc2hlZCA9IFRydWUKICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgIGV4Y2VwdCBDbWRUaW1lZE91dDoKICAgICAgICBpZiBhdHRlbXB0ICE9IG50cmllczoKICAgICAgICAgIHNlbGYubm90aWZ5X3JldHJ5KCkKICAgICAgICAgIHNlbGYudGltZW91dCArPSBsaW1pdAogICAgICAgIGVsc2U6CiAgICAgICAgICByYWlzZQoKICBkZWYgbm90aWZ5X3JldHJ5KHNlbGYpOgogICAgIiIiIFJldHJ5IHJlcXVpcmVkIGZvciBjb21tYW5kLCBub3RpZnkgdXNlci4gIiIiCiAgICBmb3IgY291bnQgaW4gcmFuZ2UoMywgMCwgLTEpOgogICAgICBpZiBHX1NUT1AuaXNfc2V0KCk6CiAgICAgICAgcmFpc2UgS2V5Ym9hcmRJbnRlcnJ1cHQKICAgICAgbXNnID0gJ1RpbWVvdXQuIFdpbGwgcmV0cnkgaW4gezB9IHNlY29uZHsxfSAuLi4nLmZvcm1hdCgKICAgICAgICAgICAgY291bnQsICdzJyBpZiBjb3VudCAhPSAxIGVsc2UgJycpCiAgICAgIHNlbGYuY2FsbGJhY2soW21zZ10pCiAgICAgIHRpbWUuc2xlZXAoMSkKICAgIHNlbGYuY2FsbGJhY2soWydSZXRyeWluZyAuLi4nXSkKCiAgZGVmIHRyeV9jb21tYW5kKHNlbGYpOgogICAgIiIiIEV4ZWN1dGUgYSBjbWQgJiBwb2xsIGZvciBjYWxsYmFjay4gUmV0dXJucyBsaXN0IG9mIG91dHB1dC4KICAgICAgICBSYWlzZXMgQ21kRmFpbGVkICAgLT4gcmV0dXJuIGNvZGUgZm9yIFBvcGVuIGlzbid0IDAKICAgICAgICBSYWlzZXMgQ21kVGltZWRPdXQgLT4gY29tbWFuZCBleGNlZWRlZCB0aW1lb3V0IHdpdGhvdXQgbmV3IG91dHB1dAogICAgIiIiCiAgICBmaXJzdF9saW5lID0gVHJ1ZQoKICAgIHRyeToKICAgICAgdGZpbGUgPSB0ZW1wZmlsZS5OYW1lZFRlbXBvcmFyeUZpbGUobW9kZT0ndytiJykKICAgICAgcHJlZXhlY19mbiA9IG5vdCBHX0lTX1dJTiBhbmQgb3Muc2V0c2lkIG9yIE5vbmUKICAgICAgc2VsZi5wcm9jID0gc3VicHJvY2Vzcy5Qb3BlbihzZWxmLmNtZCwgc3Rkb3V0PXRmaWxlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGRpbj1zdWJwcm9jZXNzLlBJUEUsIHNoZWxsPVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlZXhlY19mbj1wcmVleGVjX2ZuKQogICAgICB0aHJkID0gdGhyLlRocmVhZCh0YXJnZXQ9KGxhbWJkYSBwcm9jOiBwcm9jLndhaXQoKSksIGFyZ3M9KHNlbGYucHJvYywpKQogICAgICB0aHJkLnN0YXJ0KCkKCiAgICAgIHRocmVhZF9ub3Rfc3RhcnRlZCA9IFRydWUKICAgICAgd2hpbGUgdGhyZWFkX25vdF9zdGFydGVkOgogICAgICAgIHRyeToKICAgICAgICAgIHRocmQuam9pbigwLjEpCiAgICAgICAgICB0aHJlYWRfbm90X3N0YXJ0ZWQgPSBGYWxzZQogICAgICAgIGV4Y2VwdCBSdW50aW1lRXJyb3I6CiAgICAgICAgICBwYXNzCgogICAgICB3aGlsZSBzZWxmLmFsaXZlOgogICAgICAgIGlmIEdfU1RPUC5pc19zZXQoKToKICAgICAgICAgIHJhaXNlIEtleWJvYXJkSW50ZXJydXB0CgogICAgICAgIGlmIGZpcnN0X2xpbmUgb3IgcmFuZG9tLnJhbmRvbSgpIDwgR19MT0dfUFJPQjoKICAgICAgICAgIGZpcnN0X2xpbmUgPSBGYWxzZQogICAgICAgICAgbGluZSA9ICcnIGlmIEdfSVNfV0lOIGVsc2Ugbm9uYmxvY2tfcmVhZCh0ZmlsZS5uYW1lKQogICAgICAgICAgaWYgbGluZToKICAgICAgICAgICAgc2VsZi5jYWxsYmFjayhbbGluZV0pCgogICAgICAgIHRpbWVfZGlmZiA9IHRpbWUudGltZSgpIC0gb3MucGF0aC5nZXRtdGltZSh0ZmlsZS5uYW1lKQogICAgICAgIGlmIHRpbWVfZGlmZiA+IHNlbGYudGltZW91dDoKICAgICAgICAgIHJhaXNlIENtZFRpbWVkT3V0KFsnVGltZW91dCEnXSkKCiAgICAgICAgdGhyZC5qb2luKDAuNSkKCiAgICAgIHRmaWxlLnNlZWsoMCkKICAgICAgcmVzdWx0ID0gW2xpbmUuZGVjb2RlKCd1dGYtOCcsICdyZXBsYWNlJykucnN0cmlwKCkgZm9yIGxpbmUgaW4gdGZpbGVdCgogICAgICBpZiBzZWxmLnByb2MucmV0dXJuY29kZSAhPSAwOgogICAgICAgIHJhaXNlIENtZEZhaWxlZChbJyddICsgcmVzdWx0KQoKICAgICAgcmV0dXJuIHJlc3VsdAogICAgZXhjZXB0OgogICAgICBzZWxmLnRlcm1pbmF0ZSgpCiAgICAgIHJhaXNlCgogIGRlZiB0ZXJtaW5hdGUoc2VsZik6CiAgICAiIiIgVGVybWluYXRlIHByb2Nlc3MgYW5kIGNsZWFudXAuICIiIgogICAgaWYgc2VsZi5hbGl2ZToKICAgICAgaWYgR19JU19XSU46CiAgICAgICAgb3Mua2lsbChzZWxmLnByb2MucGlkLCBzaWduYWwuU0lHSU5UKQogICAgICBlbHNlOgogICAgICAgIG9zLmtpbGxwZyhzZWxmLnByb2MucGlkLCBzaWduYWwuU0lHVEVSTSkKICAgIHNlbGYuY2xlYW4oKQoKY2xhc3MgUGx1Z2luKG9iamVjdCk6CiAgZGVmIF9faW5pdF9fKHNlbGYsIG5hbWUsIGFyZ3MsIGJ1Zl9xLCBsb2NrKToKICAgIHNlbGYubmFtZSA9IG5hbWUKICAgIHNlbGYuYXJncyA9IGFyZ3MKICAgIHNlbGYuYnVmX3EgPSBidWZfcQogICAgc2VsZi5sb2NrID0gbG9jawogICAgc2VsZi50YWcgPSBhcmdzLmdldCgndGFnJywgMCkKCiAgZGVmIG1hbmFnZShzZWxmKToKICAgIHRyeToKICAgICAgaWYgb3MucGF0aC5leGlzdHMoc2VsZi5hcmdzWydkaXInXSk6CiAgICAgICAgc2VsZi51cGRhdGUoKQogICAgICBlbHNlOgogICAgICAgIHNlbGYuaW5zdGFsbCgpCiAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICB0aHJlYWRfdmltX2NvbW1hbmQoImxldCBzOnVwZGF0ZS5uZXdbJ3swfSddID0gMSIuZm9ybWF0KHNlbGYubmFtZSkpCiAgICBleGNlcHQgUGx1Z0Vycm9yIGFzIGV4YzoKICAgICAgc2VsZi53cml0ZShBY3Rpb24uRVJST1IsIHNlbGYubmFtZSwgZXhjLm1zZykKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgR19TVE9QLnNldCgpCiAgICAgIHNlbGYud3JpdGUoQWN0aW9uLkVSUk9SLCBzZWxmLm5hbWUsIFsnSW50ZXJydXB0ZWQhJ10pCiAgICBleGNlcHQ6CiAgICAgICMgQW55IGV4Y2VwdGlvbiBleGNlcHQgdGhvc2UgYWJvdmUgcHJpbnQgc3RhY2sgdHJhY2UKICAgICAgbXNnID0gJ1RyYWNlOlxuezB9Jy5mb3JtYXQodHJhY2ViYWNrLmZvcm1hdF9leGMoKS5yc3RyaXAoKSkKICAgICAgc2VsZi53cml0ZShBY3Rpb24uRVJST1IsIHNlbGYubmFtZSwgbXNnLnNwbGl0KCdcbicpKQogICAgICByYWlzZQoKICBkZWYgaW5zdGFsbChzZWxmKToKICAgIHRhcmdldCA9IHNlbGYuYXJnc1snZGlyJ10KICAgIGlmIHRhcmdldFstMV0gPT0gJ1xcJzoKICAgICAgdGFyZ2V0ID0gdGFyZ2V0WzA6LTFdCgogICAgZGVmIGNsZWFuKHRhcmdldCk6CiAgICAgIGRlZiBfY2xlYW4oKToKICAgICAgICB0cnk6CiAgICAgICAgICBzaHV0aWwucm10cmVlKHRhcmdldCkKICAgICAgICBleGNlcHQgT1NFcnJvcjoKICAgICAgICAgIHBhc3MKICAgICAgcmV0dXJuIF9jbGVhbgoKICAgIHNlbGYud3JpdGUoQWN0aW9uLklOU1RBTEwsIHNlbGYubmFtZSwgWydJbnN0YWxsaW5nIC4uLiddKQogICAgY2FsbGJhY2sgPSBmdW5jdG9vbHMucGFydGlhbChzZWxmLndyaXRlLCBBY3Rpb24uSU5TVEFMTCwgc2VsZi5uYW1lKQogICAgY21kID0gJ2dpdCBjbG9uZSB7MH0gezF9IHsyfSB7M30gMj4mMScuZm9ybWF0KAogICAgICAgICAgJycgaWYgc2VsZi50YWcgZWxzZSBHX0NMT05FX09QVCwgR19QUk9HUkVTUywgc2VsZi5hcmdzWyd1cmknXSwKICAgICAgICAgIGVzYyh0YXJnZXQpKQogICAgY29tID0gQ29tbWFuZChjbWQsIE5vbmUsIEdfVElNRU9VVCwgY2FsbGJhY2ssIGNsZWFuKHRhcmdldCkpCiAgICByZXN1bHQgPSBjb20uZXhlY3V0ZShHX1JFVFJJRVMpCiAgICBzZWxmLndyaXRlKEFjdGlvbi5ET05FLCBzZWxmLm5hbWUsIHJlc3VsdFstMTpdKQoKICBkZWYgcmVwb191cmkoc2VsZik6CiAgICBjbWQgPSAnZ2l0IHJldi1wYXJzZSAtLWFiYnJldi1yZWYgSEVBRCAyPiYxICYmIGdpdCBjb25maWcgLWYgLmdpdC9jb25maWcgcmVtb3RlLm9yaWdpbi51cmwnCiAgICBjb21tYW5kID0gQ29tbWFuZChjbWQsIHNlbGYuYXJnc1snZGlyJ10sIEdfVElNRU9VVCwpCiAgICByZXN1bHQgPSBjb21tYW5kLmV4ZWN1dGUoR19SRVRSSUVTKQogICAgcmV0dXJuIHJlc3VsdFstMV0KCiAgZGVmIHVwZGF0ZShzZWxmKToKICAgIGFjdHVhbF91cmkgPSBzZWxmLnJlcG9fdXJpKCkKICAgIGV4cGVjdF91cmkgPSBzZWxmLmFyZ3NbJ3VyaSddCiAgICByZWdleCA9IHJlLmNvbXBpbGUocideKD86XHcrOi8vKT8oPzpbXkAvXSpAKT8oW146L10qKD86OlswLTldKik/KVs6L10oLio/KSg/OlwuZ2l0KT8vPyQnKQogICAgbWEgPSByZWdleC5tYXRjaChhY3R1YWxfdXJpKQogICAgbWIgPSByZWdleC5tYXRjaChleHBlY3RfdXJpKQogICAgaWYgbWEgaXMgTm9uZSBvciBtYiBpcyBOb25lIG9yIG1hLmdyb3VwcygpICE9IG1iLmdyb3VwcygpOgogICAgICBtc2cgPSBbJycsCiAgICAgICAgICAgICAnSW52YWxpZCBVUkk6IHswfScuZm9ybWF0KGFjdHVhbF91cmkpLAogICAgICAgICAgICAgJ0V4cGVjdGVkICAgICB7MH0nLmZvcm1hdChleHBlY3RfdXJpKSwKICAgICAgICAgICAgICdQbHVnQ2xlYW4gcmVxdWlyZWQuJ10KICAgICAgcmFpc2UgSW52YWxpZFVSSShtc2cpCgogICAgaWYgR19QVUxMOgogICAgICBzZWxmLndyaXRlKEFjdGlvbi5VUERBVEUsIHNlbGYubmFtZSwgWydVcGRhdGluZyAuLi4nXSkKICAgICAgY2FsbGJhY2sgPSBmdW5jdG9vbHMucGFydGlhbChzZWxmLndyaXRlLCBBY3Rpb24uVVBEQVRFLCBzZWxmLm5hbWUpCiAgICAgIGZldGNoX29wdCA9ICctLWRlcHRoIDk5OTk5OTk5JyBpZiBzZWxmLnRhZyBhbmQgb3MucGF0aC5pc2ZpbGUob3MucGF0aC5qb2luKHNlbGYuYXJnc1snZGlyJ10sICcuZ2l0L3NoYWxsb3cnKSkgZWxzZSAnJwogICAgICBjbWQgPSAnZ2l0IGZldGNoIHswfSB7MX0gMj4mMScuZm9ybWF0KGZldGNoX29wdCwgR19QUk9HUkVTUykKICAgICAgY29tID0gQ29tbWFuZChjbWQsIHNlbGYuYXJnc1snZGlyJ10sIEdfVElNRU9VVCwgY2FsbGJhY2spCiAgICAgIHJlc3VsdCA9IGNvbS5leGVjdXRlKEdfUkVUUklFUykKICAgICAgc2VsZi53cml0ZShBY3Rpb24uRE9ORSwgc2VsZi5uYW1lLCByZXN1bHRbLTE6XSkKICAgIGVsc2U6CiAgICAgIHNlbGYud3JpdGUoQWN0aW9uLkRPTkUsIHNlbGYubmFtZSwgWydBbHJlYWR5IGluc3RhbGxlZCddKQoKICBkZWYgd3JpdGUoc2VsZiwgYWN0aW9uLCBuYW1lLCBtc2cpOgogICAgc2VsZi5idWZfcS5wdXQoKGFjdGlvbiwgbmFtZSwgbXNnKSkKCmNsYXNzIFBsdWdUaHJlYWQodGhyLlRocmVhZCk6CiAgZGVmIF9faW5pdF9fKHNlbGYsIHRuYW1lLCBhcmdzKToKICAgIHN1cGVyKFBsdWdUaHJlYWQsIHNlbGYpLl9faW5pdF9fKCkKICAgIHNlbGYudG5hbWUgPSB0bmFtZQogICAgc2VsZi5hcmdzID0gYXJncwoKICBkZWYgcnVuKHNlbGYpOgogICAgdGhyLmN1cnJlbnRfdGhyZWFkKCkubmFtZSA9IHNlbGYudG5hbWUKICAgIGJ1Zl9xLCB3b3JrX3EsIGxvY2sgPSBzZWxmLmFyZ3MKCiAgICB0cnk6CiAgICAgIHdoaWxlIG5vdCBHX1NUT1AuaXNfc2V0KCk6CiAgICAgICAgbmFtZSwgYXJncyA9IHdvcmtfcS5nZXRfbm93YWl0KCkKICAgICAgICBwbHVnID0gUGx1Z2luKG5hbWUsIGFyZ3MsIGJ1Zl9xLCBsb2NrKQogICAgICAgIHBsdWcubWFuYWdlKCkKICAgICAgICB3b3JrX3EudGFza19kb25lKCkKICAgIGV4Y2VwdCBxdWV1ZS5FbXB0eToKICAgICAgcGFzcwoKY2xhc3MgUmVmcmVzaFRocmVhZCh0aHIuVGhyZWFkKToKICBkZWYgX19pbml0X18oc2VsZiwgbG9jayk6CiAgICBzdXBlcihSZWZyZXNoVGhyZWFkLCBzZWxmKS5fX2luaXRfXygpCiAgICBzZWxmLmxvY2sgPSBsb2NrCiAgICBzZWxmLnJ1bm5pbmcgPSBUcnVlCgogIGRlZiBydW4oc2VsZik6CiAgICB3aGlsZSBzZWxmLnJ1bm5pbmc6CiAgICAgIHdpdGggc2VsZi5sb2NrOgogICAgICAgIHRocmVhZF92aW1fY29tbWFuZCgnbm9hdXRvY21kIG5vcm1hbCEgYScpCiAgICAgIHRpbWUuc2xlZXAoMC4zMykKCiAgZGVmIHN0b3Aoc2VsZik6CiAgICBzZWxmLnJ1bm5pbmcgPSBGYWxzZQoKaWYgR19OVklNOgogIGRlZiB0aHJlYWRfdmltX2NvbW1hbmQoY21kKToKICAgIHZpbS5zZXNzaW9uLnRocmVhZHNhZmVfY2FsbChsYW1iZGE6IHZpbS5jb21tYW5kKGNtZCkpCmVsc2U6CiAgZGVmIHRocmVhZF92aW1fY29tbWFuZChjbWQpOgogICAgdmltLmNvbW1hbmQoY21kKQoKZGVmIGVzYyhuYW1lKToKICByZXR1cm4gJyInICsgbmFtZS5yZXBsYWNlKCciJywgJ1wiJykgKyAnIicKCmRlZiBub25ibG9ja19yZWFkKGZuYW1lKToKICAiIiIgUmVhZCBhIGZpbGUgd2l0aCBub25ibG9jayBmbGFnLiBSZXR1cm4gdGhlIGxhc3QgbGluZS4gIiIiCiAgZnJlYWQgPSBvcy5vcGVuKGZuYW1lLCBvcy5PX1JET05MWSB8IG9zLk9fTk9OQkxPQ0spCiAgYnVmID0gb3MucmVhZChmcmVhZCwgMTAwMDAwKS5kZWNvZGUoJ3V0Zi04JywgJ3JlcGxhY2UnKQogIG9zLmNsb3NlKGZyZWFkKQoKICBsaW5lID0gYnVmLnJzdHJpcCgnXHJcbicpCiAgbGVmdCA9IG1heChsaW5lLnJmaW5kKCdccicpLCBsaW5lLnJmaW5kKCdcbicpKQogIGlmIGxlZnQgIT0gLTE6CiAgICBsZWZ0ICs9IDEKICAgIGxpbmUgPSBsaW5lW2xlZnQ6XQoKICByZXR1cm4gbGluZQoKZGVmIG1haW4oKToKICB0aHIuY3VycmVudF90aHJlYWQoKS5uYW1lID0gJ21haW4nCiAgbnRocmVhZHMgPSBpbnQodmltLmV2YWwoJ3M6dXBkYXRlLnRocmVhZHMnKSkKICBwbHVncyA9IHZpbS5ldmFsKCdzOnVwZGF0ZS50b2RvJykKICBtYWNfZ3VpID0gdmltLmV2YWwoJ3M6bWFjX2d1aScpID09ICcxJwoKICBsb2NrID0gdGhyLkxvY2soKQogIGJ1ZiA9IEJ1ZmZlcihsb2NrLCBsZW4ocGx1Z3MpLCBHX1BVTEwpCiAgYnVmX3EsIHdvcmtfcSA9IHF1ZXVlLlF1ZXVlKCksIHF1ZXVlLlF1ZXVlKCkKICBmb3Igd29yayBpbiBwbHVncy5pdGVtcygpOgogICAgd29ya19xLnB1dCh3b3JrKQoKICBzdGFydF9jbnQgPSB0aHIuYWN0aXZlX2NvdW50KCkKICBmb3IgbnVtIGluIHJhbmdlKG50aHJlYWRzKToKICAgIHRuYW1lID0gJ1BsdWdULXswOjAyfScuZm9ybWF0KG51bSkKICAgIHRocmVhZCA9IFBsdWdUaHJlYWQodG5hbWUsIChidWZfcSwgd29ya19xLCBsb2NrKSkKICAgIHRocmVhZC5zdGFydCgpCiAgaWYgbWFjX2d1aToKICAgIHJ0aHJlYWQgPSBSZWZyZXNoVGhyZWFkKGxvY2spCiAgICBydGhyZWFkLnN0YXJ0KCkKCiAgd2hpbGUgbm90IGJ1Zl9xLmVtcHR5KCkgb3IgdGhyLmFjdGl2ZV9jb3VudCgpICE9IHN0YXJ0X2NudDoKICAgIHRyeToKICAgICAgYWN0aW9uLCBuYW1lLCBtc2cgPSBidWZfcS5nZXQoVHJ1ZSwgMC4yNSkKICAgICAgYnVmLndyaXRlKGFjdGlvbiwgbmFtZSwgWydPSyddIGlmIG5vdCBtc2cgZWxzZSBtc2cpCiAgICAgIGJ1Zl9xLnRhc2tfZG9uZSgpCiAgICBleGNlcHQgcXVldWUuRW1wdHk6CiAgICAgIHBhc3MKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgR19TVE9QLnNldCgpCgogIGlmIG1hY19ndWk6CiAgICBydGhyZWFkLnN0b3AoKQogICAgcnRocmVhZC5qb2luKCkKCm1haW4oKQpFT0YKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnVwZGF0ZV9ydWJ5KCkKICBydWJ5IDw8IEVPRgogIG1vZHVsZSBQbHVnU3RyZWFtCiAgICBTRVAgPSBbIlxyIiwgIlxuIiwgbmlsXQogICAgZGVmIGdldF9saW5lCiAgICAgIGJ1ZmZlciA9ICcnCiAgICAgIGxvb3AgZG8KICAgICAgICBjaGFyID0gcmVhZGNoYXIgcmVzY3VlIHJldHVybgogICAgICAgIGlmIFNFUC5pbmNsdWRlPyBjaGFyLmNocgogICAgICAgICAgYnVmZmVyIDw8ICQvCiAgICAgICAgICBicmVhawogICAgICAgIGVsc2UKICAgICAgICAgIGJ1ZmZlciA8PCBjaGFyCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBidWZmZXIKICAgIGVuZAogIGVuZCB1bmxlc3MgZGVmaW5lZD8oUGx1Z1N0cmVhbSkKCiAgZGVmIGVzYyBhcmcKICAgICVbIiN7YXJnLmdzdWIoJyInLCAnXCInKX0iXQogIGVuZAoKICBkZWYga2lsbGFsbCBwaWQKICAgIHBpZHMgPSBbcGlkXQogICAgaWYgL21zd2lufG1pbmd3fGJjY3dpbi8gPX4gUlVCWV9QTEFURk9STQogICAgICBwaWRzLmVhY2ggeyB8cGlkfCBQcm9jZXNzLmtpbGwgJ0lOVCcsIHBpZC50b19pIHJlc2N1ZSBuaWwgfQogICAgZWxzZQogICAgICB1bmxlc3MgYHdoaWNoIHBncmVwIDI+IC9kZXYvbnVsbGAuZW1wdHk/CiAgICAgICAgY2hpbGRyZW4gPSBwaWRzCiAgICAgICAgdW50aWwgY2hpbGRyZW4uZW1wdHk/CiAgICAgICAgICBjaGlsZHJlbiA9IGNoaWxkcmVuLm1hcCB7IHxwaWR8CiAgICAgICAgICAgIGBwZ3JlcCAtUCAje3BpZH1gLmxpbmVzLm1hcCB7IHxsfCBsLmNob21wIH0KICAgICAgICAgIH0uZmxhdHRlbgogICAgICAgICAgcGlkcyArPSBjaGlsZHJlbgogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgcGlkcy5lYWNoIHsgfHBpZHwgUHJvY2Vzcy5raWxsICdURVJNJywgcGlkLnRvX2kgcmVzY3VlIG5pbCB9CiAgICBlbmQKICBlbmQKCiAgZGVmIGNvbXBhcmVfZ2l0X3VyaSBhLCBiCiAgICByZWdleCA9ICVye14oPzpcdys6Ly8pPyg/OlteQC9dKkApPyhbXjovXSooPzo6WzAtOV0qKT8pWzovXSguKj8pKD86XC5naXQpPy8/JH0KICAgIHJlZ2V4Lm1hdGNoKGEpLnRvX2EuZHJvcCgxKSA9PSByZWdleC5tYXRjaChiKS50b19hLmRyb3AoMSkKICBlbmQKCiAgcmVxdWlyZSAndGhyZWFkJwogIHJlcXVpcmUgJ2ZpbGV1dGlscycKICByZXF1aXJlICd0aW1lb3V0JwogIHJ1bm5pbmcgPSB0cnVlCiAgaXN3aW4gPSBWSU06OmV2YWx1YXRlKCdzOmlzX3dpbicpLnRvX2kgPT0gMQogIHB1bGwgID0gVklNOjpldmFsdWF0ZSgnczp1cGRhdGUucHVsbCcpLnRvX2kgPT0gMQogIGJhc2UgID0gVklNOjpldmFsdWF0ZSgnZzpwbHVnX2hvbWUnKQogIGFsbCAgID0gVklNOjpldmFsdWF0ZSgnczp1cGRhdGUudG9kbycpCiAgbGltaXQgPSBWSU06OmV2YWx1YXRlKCdnZXQoZzosICJwbHVnX3RpbWVvdXQiLCA2MCknKQogIHRyaWVzID0gVklNOjpldmFsdWF0ZSgnZ2V0KGc6LCAicGx1Z19yZXRyaWVzIiwgMiknKSArIDEKICBudGhyICA9IFZJTTo6ZXZhbHVhdGUoJ3M6dXBkYXRlLnRocmVhZHMnKS50b19pCiAgbWF4eSAgPSBWSU06OmV2YWx1YXRlKCd3aW5oZWlnaHQoIi4iKScpLnRvX2kKICB2aW03ICA9IFZJTTo6ZXZhbHVhdGUoJ3Y6dmVyc2lvbicpLnRvX2kgPD0gNzAzICYmIFJVQllfUExBVEZPUk0gPX4gL2Rhcndpbi8KICBjZCAgICA9IGlzd2luID8gJ2NkIC9kJyA6ICdjZCcKICB0b3QgICA9IFZJTTo6ZXZhbHVhdGUoJ2xlbihzOnVwZGF0ZS50b2RvKScpIHx8IDAKICBiYXIgICA9ICcnCiAgc2tpcCAgPSAnQWxyZWFkeSBpbnN0YWxsZWQnCiAgbXR4ICAgPSBNdXRleC5uZXcKICB0YWtlMSA9IHByb2MgeyBtdHguc3luY2hyb25pemUgeyBydW5uaW5nICYmIGFsbC5zaGlmdCB9IH0KICBsb2doICA9IHByb2MgewogICAgY250ID0gYmFyLmxlbmd0aAogICAgJGN1cmJ1ZlsxXSA9ICIje3B1bGwgPyAnVXBkYXRpbmcnIDogJ0luc3RhbGxpbmcnfSBwbHVnaW5zICgje2NudH0vI3t0b3R9KSIKICAgICRjdXJidWZbMl0gPSAnWycgKyBiYXIubGp1c3QodG90KSArICddJwogICAgVklNOjpjb21tYW5kKCdub3JtYWwhIDJHJykKICAgIFZJTTo6Y29tbWFuZCgncmVkcmF3JykKICB9CiAgd2hlcmUgPSBwcm9jIHsgfG5hbWV8ICgxLi4oJGN1cmJ1Zi5sZW5ndGgpKS5maW5kIHsgfGx8ICRjdXJidWZbbF0gPX4gL15bLSt4Kl0gI3tuYW1lfTovIH0gfQogIGxvZyAgID0gcHJvYyB7IHxuYW1lLCByZXN1bHQsIHR5cGV8CiAgICBtdHguc3luY2hyb25pemUgZG8KICAgICAgaW5nICA9ICFbdHJ1ZSwgZmFsc2VdLmluY2x1ZGU/KHR5cGUpCiAgICAgIGJhciArPSB0eXBlID8gJz0nIDogJ3gnIHVubGVzcyBpbmcKICAgICAgYiA9IGNhc2UgdHlwZQogICAgICAgICAgd2hlbiA6aW5zdGFsbCAgdGhlbiAnKycgd2hlbiA6dXBkYXRlIHRoZW4gJyonCiAgICAgICAgICB3aGVuIHRydWUsIG5pbCB0aGVuICctJyBlbHNlCiAgICAgICAgICAgIFZJTTo6Y29tbWFuZCgiY2FsbCBhZGQoczp1cGRhdGUuZXJyb3JzLCAnI3tuYW1lfScpIikKICAgICAgICAgICAgJ3gnCiAgICAgICAgICBlbmQKICAgICAgcmVzdWx0ID0KICAgICAgICBpZiB0eXBlIHx8IHR5cGUubmlsPwogICAgICAgICAgWyIje2J9ICN7bmFtZX06ICN7cmVzdWx0LmxpbmVzLnRvX2EubGFzdCB8fCAnT0snfSJdCiAgICAgICAgZWxzaWYgcmVzdWx0ID1+IC9eSW50ZXJydXB0ZWR8XlRpbWVvdXQvCiAgICAgICAgICBbIiN7Yn0gI3tuYW1lfTogI3tyZXN1bHR9Il0KICAgICAgICBlbHNlCiAgICAgICAgICBbIiN7Yn0gI3tuYW1lfSJdICsgcmVzdWx0LmxpbmVzLm1hcCB7IHxsfCAiICAgICIgPDwgbCB9CiAgICAgICAgZW5kCiAgICAgIGlmIGxudW0gPSB3aGVyZS5jYWxsKG5hbWUpCiAgICAgICAgJGN1cmJ1Zi5kZWxldGUgbG51bQogICAgICAgIGxudW0gPSA0IGlmIGluZyAmJiBsbnVtID4gbWF4eQogICAgICBlbmQKICAgICAgcmVzdWx0LmVhY2hfd2l0aF9pbmRleCBkbyB8bGluZSwgb2Zmc2V0fAogICAgICAgICRjdXJidWYuYXBwZW5kKChsbnVtIHx8IDQpIC0gMSArIG9mZnNldCwgbGluZS5nc3ViKC9cZVxbLi8sICcnKS5jaG9tcCkKICAgICAgZW5kCiAgICAgIGxvZ2guY2FsbAogICAgZW5kCiAgfQogIGJ0ID0gcHJvYyB7IHxjbWQsIG5hbWUsIHR5cGUsIGNsZWFudXB8CiAgICB0cmllZCA9IHRpbWVvdXQgPSAwCiAgICBiZWdpbgogICAgICB0cmllZCArPSAxCiAgICAgIHRpbWVvdXQgKz0gbGltaXQKICAgICAgZmQgPSBuaWwKICAgICAgZGF0YSA9ICcnCiAgICAgIGlmIGlzd2luCiAgICAgICAgVGltZW91dDo6dGltZW91dCh0aW1lb3V0KSBkbwogICAgICAgICAgdG1wID0gVklNOjpldmFsdWF0ZSgndGVtcG5hbWUoKScpCiAgICAgICAgICBzeXN0ZW0oIigje2NtZH0pID4gI3t0bXB9IikKICAgICAgICAgIGRhdGEgPSBGaWxlLnJlYWQodG1wKS5jaG9tcAogICAgICAgICAgRmlsZS51bmxpbmsgdG1wIHJlc2N1ZSBuaWwKICAgICAgICBlbmQKICAgICAgZWxzZQogICAgICAgIGZkID0gSU8ucG9wZW4oY21kKS5leHRlbmQoUGx1Z1N0cmVhbSkKICAgICAgICBmaXJzdF9saW5lID0gdHJ1ZQogICAgICAgIGxvZ19wcm9iID0gMS4wIC8gbnRocgogICAgICAgIHdoaWxlIGxpbmUgPSBUaW1lb3V0Ojp0aW1lb3V0KHRpbWVvdXQpIHsgZmQuZ2V0X2xpbmUgfQogICAgICAgICAgZGF0YSA8PCBsaW5lCiAgICAgICAgICBsb2cuY2FsbCBuYW1lLCBsaW5lLmNob21wLCB0eXBlIGlmIG5hbWUgJiYgKGZpcnN0X2xpbmUgfHwgcmFuZCA8IGxvZ19wcm9iKQogICAgICAgICAgZmlyc3RfbGluZSA9IGZhbHNlCiAgICAgICAgZW5kCiAgICAgICAgZmQuY2xvc2UKICAgICAgZW5kCiAgICAgIFskPyA9PSAwLCBkYXRhLmNob21wXQogICAgcmVzY3VlIFRpbWVvdXQ6OkVycm9yLCBJbnRlcnJ1cHQgPT4gZQogICAgICBpZiBmZCAmJiAhZmQuY2xvc2VkPwogICAgICAgIGtpbGxhbGwgZmQucGlkCiAgICAgICAgZmQuY2xvc2UKICAgICAgZW5kCiAgICAgIGNsZWFudXAuY2FsbCBpZiBjbGVhbnVwCiAgICAgIGlmIGUuaXNfYT8oVGltZW91dDo6RXJyb3IpICYmIHRyaWVkIDwgdHJpZXMKICAgICAgICAzLmRvd250bygxKSBkbyB8Y291bnRkb3dufAogICAgICAgICAgcyA9IGNvdW50ZG93biA+IDEgPyAncycgOiAnJwogICAgICAgICAgbG9nLmNhbGwgbmFtZSwgIlRpbWVvdXQuIFdpbGwgcmV0cnkgaW4gI3tjb3VudGRvd259IHNlY29uZCN7c30gLi4uIiwgdHlwZQogICAgICAgICAgc2xlZXAgMQogICAgICAgIGVuZAogICAgICAgIGxvZy5jYWxsIG5hbWUsICdSZXRyeWluZyAuLi4nLCB0eXBlCiAgICAgICAgcmV0cnkKICAgICAgZW5kCiAgICAgIFtmYWxzZSwgZS5pc19hPyhJbnRlcnJ1cHQpID8gIkludGVycnVwdGVkISIgOiAiVGltZW91dCEiXQogICAgZW5kCiAgfQogIG1haW4gPSBUaHJlYWQuY3VycmVudAogIHRocmVhZHMgPSBbXQogIHdhdGNoZXIgPSBUaHJlYWQubmV3IHsKICAgIGlmIHZpbTcKICAgICAgd2hpbGUgVklNOjpldmFsdWF0ZSgnZ2V0Y2hhcigxKScpCiAgICAgICAgc2xlZXAgMC4xCiAgICAgIGVuZAogICAgZWxzZQogICAgICByZXF1aXJlICdpby9jb25zb2xlJyAjID49IFJ1YnkgMS45CiAgICAgIG5pbCB1bnRpbCBJTy5jb25zb2xlLmdldGNoID09IDMuY2hyCiAgICBlbmQKICAgIG10eC5zeW5jaHJvbml6ZSBkbwogICAgICBydW5uaW5nID0gZmFsc2UKICAgICAgdGhyZWFkcy5lYWNoIHsgfHR8IHQucmFpc2UgSW50ZXJydXB0IH0gdW5sZXNzIHZpbTcKICAgIGVuZAogICAgdGhyZWFkcy5lYWNoIHsgfHR8IHQuam9pbiByZXNjdWUgbmlsIH0KICAgIG1haW4ua2lsbAogIH0KICByZWZyZXNoID0gVGhyZWFkLm5ldyB7CiAgICB3aGlsZSB0cnVlCiAgICAgIG10eC5zeW5jaHJvbml6ZSBkbwogICAgICAgIGJyZWFrIHVubGVzcyBydW5uaW5nCiAgICAgICAgVklNOjpjb21tYW5kKCdub2F1dG9jbWQgbm9ybWFsISBhJykKICAgICAgZW5kCiAgICAgIHNsZWVwIDAuMgogICAgZW5kCiAgfSBpZiBWSU06OmV2YWx1YXRlKCdzOm1hY19ndWknKSA9PSAxCgogIGNsb25lX29wdCA9IFZJTTo6ZXZhbHVhdGUoJ3M6Y2xvbmVfb3B0JykKICBwcm9ncmVzcyA9IFZJTTo6ZXZhbHVhdGUoJ3M6cHJvZ3Jlc3Nfb3B0KDEpJykKICBudGhyLnRpbWVzIGRvCiAgICBtdHguc3luY2hyb25pemUgZG8KICAgICAgdGhyZWFkcyA8PCBUaHJlYWQubmV3IHsKICAgICAgICB3aGlsZSBwYWlyID0gdGFrZTEuY2FsbAogICAgICAgICAgbmFtZSA9IHBhaXIuZmlyc3QKICAgICAgICAgIGRpciwgdXJpLCB0YWcgPSBwYWlyLmxhc3QudmFsdWVzX2F0ICold1tkaXIgdXJpIHRhZ10KICAgICAgICAgIGV4aXN0cyA9IEZpbGUuZGlyZWN0b3J5PyBkaXIKICAgICAgICAgIG9rLCByZXN1bHQgPQogICAgICAgICAgICBpZiBleGlzdHMKICAgICAgICAgICAgICBjaGRpciA9ICIje2NkfSAje2lzd2luID8gZGlyIDogZXNjKGRpcil9IgogICAgICAgICAgICAgIHJldCwgZGF0YSA9IGJ0LmNhbGwgIiN7Y2hkaXJ9ICYmIGdpdCByZXYtcGFyc2UgLS1hYmJyZXYtcmVmIEhFQUQgMj4mMSAmJiBnaXQgY29uZmlnIC1mIC5naXQvY29uZmlnIHJlbW90ZS5vcmlnaW4udXJsIiwgbmlsLCBuaWwsIG5pbAogICAgICAgICAgICAgIGN1cnJlbnRfdXJpID0gZGF0YS5saW5lcy50b19hLmxhc3QKICAgICAgICAgICAgICBpZiAhcmV0CiAgICAgICAgICAgICAgICBpZiBkYXRhID1+IC9eSW50ZXJydXB0ZWR8XlRpbWVvdXQvCiAgICAgICAgICAgICAgICAgIFtmYWxzZSwgZGF0YV0KICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgW2ZhbHNlLCBbZGF0YS5jaG9tcCwgIlBsdWdDbGVhbiByZXF1aXJlZC4iXS5qb2luKCQvKV0KICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICAgIGVsc2lmICFjb21wYXJlX2dpdF91cmkoY3VycmVudF91cmksIHVyaSkKICAgICAgICAgICAgICAgIFtmYWxzZSwgWyJJbnZhbGlkIFVSSTogI3tjdXJyZW50X3VyaX0iLAogICAgICAgICAgICAgICAgICAgICAgICAgIkV4cGVjdGVkOiAgICAje3VyaX0iLAogICAgICAgICAgICAgICAgICAgICAgICAgIlBsdWdDbGVhbiByZXF1aXJlZC4iXS5qb2luKCQvKV0KICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBpZiBwdWxsCiAgICAgICAgICAgICAgICAgIGxvZy5jYWxsIG5hbWUsICdVcGRhdGluZyAuLi4nLCA6dXBkYXRlCiAgICAgICAgICAgICAgICAgIGZldGNoX29wdCA9ICh0YWcgJiYgRmlsZS5leGlzdD8oRmlsZS5qb2luKGRpciwgJy5naXQvc2hhbGxvdycpKSkgPyAnLS1kZXB0aCA5OTk5OTk5OScgOiAnJwogICAgICAgICAgICAgICAgICBidC5jYWxsICIje2NoZGlyfSAmJiBnaXQgZmV0Y2ggI3tmZXRjaF9vcHR9ICN7cHJvZ3Jlc3N9IDI+JjEiLCBuYW1lLCA6dXBkYXRlLCBuaWwKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgW3RydWUsIHNraXBdCiAgICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgICBlbmQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgIGQgPSBlc2MgZGlyLnN1YiglcntbXFwvXSskfSwgJycpCiAgICAgICAgICAgICAgbG9nLmNhbGwgbmFtZSwgJ0luc3RhbGxpbmcgLi4uJywgOmluc3RhbGwKICAgICAgICAgICAgICBidC5jYWxsICJnaXQgY2xvbmUgI3tjbG9uZV9vcHQgdW5sZXNzIHRhZ30gI3twcm9ncmVzc30gI3t1cml9ICN7ZH0gMj4mMSIsIG5hbWUsIDppbnN0YWxsLCBwcm9jIHsKICAgICAgICAgICAgICAgIEZpbGVVdGlscy5ybV9yZiBkaXIKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGVuZAogICAgICAgICAgbXR4LnN5bmNocm9uaXplIHsgVklNOjpjb21tYW5kKCJsZXQgczp1cGRhdGUubmV3Wycje25hbWV9J10gPSAxIikgfSBpZiAhZXhpc3RzICYmIG9rCiAgICAgICAgICBsb2cuY2FsbCBuYW1lLCByZXN1bHQsIG9rCiAgICAgICAgZW5kCiAgICAgIH0gaWYgcnVubmluZwogICAgZW5kCiAgZW5kCiAgdGhyZWFkcy5lYWNoIHsgfHR8IHQuam9pbiByZXNjdWUgbmlsIH0KICBsb2doLmNhbGwKICByZWZyZXNoLmtpbGwgaWYgcmVmcmVzaAogIHdhdGNoZXIua2lsbApFT0YKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnNoZWxsZXNjX2NtZChhcmcsIHNjcmlwdCkKICBsZXQgZXNjYXBlZCA9IHN1YnN0aXR1dGUoJyInLmE6YXJnLiciJywgJ1smfDw+KClAXiEiXScsICdeJicsICdnJykKICByZXR1cm4gc3Vic3RpdHV0ZShlc2NhcGVkLCAnJScsIChhOnNjcmlwdCA/ICclJyA6ICdeJykgLiAnJicsICdnJykKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnNoZWxsZXNjX3BzMShhcmcpCiAgcmV0dXJuICInIi5zdWJzdGl0dXRlKGVzY2FwZShhOmFyZywgJ1wiJyksICInIiwgIicnIiwgJ2cnKS4iJyIKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnNoZWxsZXNjX3NoKGFyZykKICByZXR1cm4gIiciLnN1YnN0aXR1dGUoYTphcmcsICInIiwgIidcXFxcJyciLCAnZycpLiInIgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHBsdWcjc2hlbGxlc2NhcGUoYXJnLCAuLi4pCiAgbGV0IG9wdHMgPSBhOjAgPiAwICYmIHR5cGUoYToxKSA9PSBzOlRZUEUuZGljdCA/IGE6MSA6IHt9CiAgbGV0IHNoZWxsID0gZ2V0KG9wdHMsICdzaGVsbCcsIHM6aXNfd2luID8gJ2NtZC5leGUnIDogJ3NoJykKICBsZXQgc2NyaXB0ID0gZ2V0KG9wdHMsICdzY3JpcHQnLCAxKQogIGlmIHNoZWxsID1+IyAnY21kXC5leGUnCiAgICByZXR1cm4gczpzaGVsbGVzY19jbWQoYTphcmcsIHNjcmlwdCkKICBlbHNlaWYgc2hlbGwgPX4jICdwb3dlcnNoZWxsXC5leGUnIHx8IHNoZWxsID1+IyAncHdzaCQnCiAgICByZXR1cm4gczpzaGVsbGVzY19wczEoYTphcmcpCiAgZW5kaWYKICByZXR1cm4gczpzaGVsbGVzY19zaChhOmFyZykKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmdsb2JfZGlyKHBhdGgpCiAgcmV0dXJuIG1hcChmaWx0ZXIoczpnbG9iKGE6cGF0aCwgJyoqJyksICdpc2RpcmVjdG9yeSh2OnZhbCknKSwgJ3M6ZGlycGF0aCh2OnZhbCknKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cHJvZ3Jlc3NfYmFyKGxpbmUsIGJhciwgdG90YWwpCiAgY2FsbCBzZXRsaW5lKGE6bGluZSwgJ1snIC4gczpscGFkKGE6YmFyLCBhOnRvdGFsKSAuICddJykKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmNvbXBhcmVfZ2l0X3VyaShhLCBiKQogICIgU2VlIGBnaXQgaGVscCBjbG9uZScKICAiIGh0dHBzOi8vIFt1c2VyQF0gZ2l0aHViLmNvbVs6cG9ydF0gLyBqdW5lZ3Vubi92aW0tcGx1ZyBbLmdpdF0KICAiICAgICAgICAgIFtnaXRAXSAgZ2l0aHViLmNvbVs6cG9ydF0gOiBqdW5lZ3Vubi92aW0tcGx1ZyBbLmdpdF0KICAiIGZpbGU6Ly8gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyBqdW5lZ3Vubi92aW0tcGx1ZyAgICAgICAgWy9dCiAgIiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8ganVuZWd1bm4vdmltLXBsdWcgICAgICAgIFsvXQogIGxldCBwYXQgPSAnXlwlKFx3XCs6Ly9cKVw9Jy4nXCUoW15AL10qQFwpXD0nLidcKFteOi9dKlwlKDpbMC05XSpcKVw9XCknLidbOi9dJy4nXCguXHstfVwpJy4nXCUoXC5naXRcKVw9L1w/JCcKICBsZXQgbWEgPSBtYXRjaGxpc3QoYTphLCBwYXQpCiAgbGV0IG1iID0gbWF0Y2hsaXN0KGE6YiwgcGF0KQogIHJldHVybiBtYVsxOjJdID09IyBtYlsxOjJdCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpmb3JtYXRfbWVzc2FnZShidWxsZXQsIG5hbWUsIG1lc3NhZ2UpCiAgaWYgYTpidWxsZXQgIT0gJ3gnCiAgICByZXR1cm4gW3ByaW50ZignJXMgJXM6ICVzJywgYTpidWxsZXQsIGE6bmFtZSwgczpsYXN0bGluZShhOm1lc3NhZ2UpKV0KICBlbHNlCiAgICBsZXQgbGluZXMgPSBtYXAoczpsaW5lcyhhOm1lc3NhZ2UpLCAnIiAgICAiLnY6dmFsJykKICAgIHJldHVybiBleHRlbmQoW3ByaW50ZigneCAlczonLCBhOm5hbWUpXSwgbGluZXMpCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOndpdGhfY2QoY21kLCBkaXIsIC4uLikKICBsZXQgc2NyaXB0ID0gYTowID4gMCA/IGE6MSA6IDEKICByZXR1cm4gcHJpbnRmKCdjZCVzICVzICYmICVzJywgczppc193aW4gPyAnIC9kJyA6ICcnLCBwbHVnI3NoZWxsZXNjYXBlKGE6ZGlyLCB7J3NjcmlwdCc6IHNjcmlwdH0pLCBhOmNtZCkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnN5c3RlbShjbWQsIC4uLikKICBsZXQgYmF0Y2hmaWxlID0gJycKICB0cnkKICAgIGxldCBbc2gsIHNoZWxsY21kZmxhZywgc2hyZF0gPSBzOmNoc2goMSkKICAgIGxldCBjbWQgPSBhOjAgPiAwID8gczp3aXRoX2NkKGE6Y21kLCBhOjEpIDogYTpjbWQKICAgIGlmIHM6aXNfd2luCiAgICAgIGxldCBbYmF0Y2hmaWxlLCBjbWRdID0gczpiYXRjaGZpbGUoY21kKQogICAgZW5kaWYKICAgIHJldHVybiBzeXN0ZW0oY21kKQogIGZpbmFsbHkKICAgIGxldCBbJnNoZWxsLCAmc2hlbGxjbWRmbGFnLCAmc2hlbGxyZWRpcl0gPSBbc2gsIHNoZWxsY21kZmxhZywgc2hyZF0KICAgIGlmIHM6aXNfd2luICYmIGZpbGVyZWFkYWJsZShiYXRjaGZpbGUpCiAgICAgIGNhbGwgZGVsZXRlKGJhdGNoZmlsZSkKICAgIGVuZGlmCiAgZW5kdHJ5CmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpzeXN0ZW1fY2hvbXAoLi4uKQogIGxldCByZXQgPSBjYWxsKCdzOnN5c3RlbScsIGE6MDAwKQogIHJldHVybiB2OnNoZWxsX2Vycm9yID8gJycgOiBzdWJzdGl0dXRlKHJldCwgJ1xuJCcsICcnLCAnJykKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmdpdF92YWxpZGF0ZShzcGVjLCBjaGVja19icmFuY2gpCiAgbGV0IGVyciA9ICcnCiAgaWYgaXNkaXJlY3RvcnkoYTpzcGVjLmRpcikKICAgIGxldCByZXN1bHQgPSBzOmxpbmVzKHM6c3lzdGVtKCdnaXQgcmV2LXBhcnNlIC0tYWJicmV2LXJlZiBIRUFEIDI+JjEgJiYgZ2l0IGNvbmZpZyAtZiAuZ2l0L2NvbmZpZyByZW1vdGUub3JpZ2luLnVybCcsIGE6c3BlYy5kaXIpKQogICAgbGV0IHJlbW90ZSA9IHJlc3VsdFstMV0KICAgIGlmIHY6c2hlbGxfZXJyb3IKICAgICAgbGV0IGVyciA9IGpvaW4oW3JlbW90ZSwgJ1BsdWdDbGVhbiByZXF1aXJlZC4nXSwgIlxuIikKICAgIGVsc2VpZiAhczpjb21wYXJlX2dpdF91cmkocmVtb3RlLCBhOnNwZWMudXJpKQogICAgICBsZXQgZXJyID0gam9pbihbJ0ludmFsaWQgVVJJOiAnLnJlbW90ZSwKICAgICAgICAgICAgICAgICAgICBcICdFeHBlY3RlZDogICAgJy5hOnNwZWMudXJpLAogICAgICAgICAgICAgICAgICAgIFwgJ1BsdWdDbGVhbiByZXF1aXJlZC4nXSwgIlxuIikKICAgIGVsc2VpZiBhOmNoZWNrX2JyYW5jaCAmJiBoYXNfa2V5KGE6c3BlYywgJ2NvbW1pdCcpCiAgICAgIGxldCByZXN1bHQgPSBzOmxpbmVzKHM6c3lzdGVtKCdnaXQgcmV2LXBhcnNlIEhFQUQgMj4mMScsIGE6c3BlYy5kaXIpKQogICAgICBsZXQgc2hhID0gcmVzdWx0Wy0xXQogICAgICBpZiB2OnNoZWxsX2Vycm9yCiAgICAgICAgbGV0IGVyciA9IGpvaW4oYWRkKHJlc3VsdCwgJ1BsdWdDbGVhbiByZXF1aXJlZC4nKSwgIlxuIikKICAgICAgZWxzZWlmICFzOmhhc2hfbWF0Y2goc2hhLCBhOnNwZWMuY29tbWl0KQogICAgICAgIGxldCBlcnIgPSBqb2luKFtwcmludGYoJ0ludmFsaWQgSEVBRCAoZXhwZWN0ZWQ6ICVzLCBhY3R1YWw6ICVzKScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwgYTpzcGVjLmNvbW1pdFs6Nl0sIHNoYVs6Nl0pLAogICAgICAgICAgICAgICAgICAgICAgXCAnUGx1Z1VwZGF0ZSByZXF1aXJlZC4nXSwgIlxuIikKICAgICAgZW5kaWYKICAgIGVsc2VpZiBhOmNoZWNrX2JyYW5jaAogICAgICBsZXQgYnJhbmNoID0gcmVzdWx0WzBdCiAgICAgICIgQ2hlY2sgdGFnCiAgICAgIGlmIGhhc19rZXkoYTpzcGVjLCAndGFnJykKICAgICAgICBsZXQgdGFnID0gczpzeXN0ZW1fY2hvbXAoJ2dpdCBkZXNjcmliZSAtLWV4YWN0LW1hdGNoIC0tdGFncyBIRUFEIDI+JjEnLCBhOnNwZWMuZGlyKQogICAgICAgIGlmIGE6c3BlYy50YWcgIT0jIHRhZyAmJiBhOnNwZWMudGFnICF+ICdcKicKICAgICAgICAgIGxldCBlcnIgPSBwcmludGYoJ0ludmFsaWQgdGFnOiAlcyAoZXhwZWN0ZWQ6ICVzKS4gVHJ5IFBsdWdVcGRhdGUuJywKICAgICAgICAgICAgICAgIFwgKGVtcHR5KHRhZykgPyAnTi9BJyA6IHRhZyksIGE6c3BlYy50YWcpCiAgICAgICAgZW5kaWYKICAgICAgIiBDaGVjayBicmFuY2gKICAgICAgZWxzZWlmIGE6c3BlYy5icmFuY2ggIT0jIGJyYW5jaAogICAgICAgIGxldCBlcnIgPSBwcmludGYoJ0ludmFsaWQgYnJhbmNoOiAlcyAoZXhwZWN0ZWQ6ICVzKS4gVHJ5IFBsdWdVcGRhdGUuJywKICAgICAgICAgICAgICBcIGJyYW5jaCwgYTpzcGVjLmJyYW5jaCkKICAgICAgZW5kaWYKICAgICAgaWYgZW1wdHkoZXJyKQogICAgICAgIGxldCBbYWhlYWQsIGJlaGluZF0gPSBzcGxpdChzOmxhc3RsaW5lKHM6c3lzdGVtKHByaW50ZigKICAgICAgICAgICAgICBcICdnaXQgcmV2LWxpc3QgLS1jb3VudCAtLWxlZnQtcmlnaHQgSEVBRC4uLm9yaWdpbi8lcycsCiAgICAgICAgICAgICAgXCBhOnNwZWMuYnJhbmNoKSwgYTpzcGVjLmRpcikpLCAnXHQnKQogICAgICAgIGlmICF2OnNoZWxsX2Vycm9yICYmIGFoZWFkCiAgICAgICAgICBpZiBiZWhpbmQKICAgICAgICAgICAgIiBPbmx5IG1lbnRpb24gUGx1Z0NsZWFuIGlmIGRpdmVyZ2VkLCBvdGhlcndpc2UgaXQncyBsaWtlbHkgdG8gYmUKICAgICAgICAgICAgIiBwdXNoYWJsZSAoYW5kIHByb2JhYmx5IG5vdCB0aGF0IG1lc3NlZCB1cCkuCiAgICAgICAgICAgIGxldCBlcnIgPSBwcmludGYoCiAgICAgICAgICAgICAgICAgIFwgIkRpdmVyZ2VkIGZyb20gb3JpZ2luLyVzICglZCBjb21taXQocykgYWhlYWQgYW5kICVkIGNvbW1pdChzKSBiZWhpbmQhXG4iCiAgICAgICAgICAgICAgICAgIFwgLidCYWNrdXAgbG9jYWwgY2hhbmdlcyBhbmQgcnVuIFBsdWdDbGVhbiBhbmQgUGx1Z1VwZGF0ZSB0byByZWluc3RhbGwgaXQuJywgYTpzcGVjLmJyYW5jaCwgYWhlYWQsIGJlaGluZCkKICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbGV0IGVyciA9IHByaW50ZigiQWhlYWQgb2Ygb3JpZ2luLyVzIGJ5ICVkIGNvbW1pdChzKS5cbiIKICAgICAgICAgICAgICAgICAgXCAuJ0Nhbm5vdCB1cGRhdGUgdW50aWwgbG9jYWwgY2hhbmdlcyBhcmUgcHVzaGVkLicsCiAgICAgICAgICAgICAgICAgIFwgYTpzcGVjLmJyYW5jaCwgYWhlYWQpCiAgICAgICAgICBlbmRpZgogICAgICAgIGVuZGlmCiAgICAgIGVuZGlmCiAgICBlbmRpZgogIGVsc2UKICAgIGxldCBlcnIgPSAnTm90IGZvdW5kJwogIGVuZGlmCiAgcmV0dXJuIFtlcnIsIGVyciA9fiMgJ1BsdWdDbGVhbiddCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpybV9yZihkaXIpCiAgaWYgaXNkaXJlY3RvcnkoYTpkaXIpCiAgICBjYWxsIHM6c3lzdGVtKChzOmlzX3dpbiA/ICdybWRpciAvUyAvUSAnIDogJ3JtIC1yZiAnKSAuIHBsdWcjc2hlbGxlc2NhcGUoYTpkaXIpKQogIGVuZGlmCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpjbGVhbihmb3JjZSkKICBjYWxsIHM6cHJlcGFyZSgpCiAgY2FsbCBhcHBlbmQoMCwgJ1NlYXJjaGluZyBmb3IgaW52YWxpZCBwbHVnaW5zIGluICcuZzpwbHVnX2hvbWUpCiAgY2FsbCBhcHBlbmQoMSwgJycpCgogICIgTGlzdCBvZiB2YWxpZCBkaXJlY3RvcmllcwogIGxldCBkaXJzID0gW10KICBsZXQgZXJycyA9IHt9CiAgbGV0IFtjbnQsIHRvdGFsXSA9IFswLCBsZW4oZzpwbHVncyldCiAgZm9yIFtuYW1lLCBzcGVjXSBpbiBpdGVtcyhnOnBsdWdzKQogICAgaWYgIXM6aXNfbWFuYWdlZChuYW1lKQogICAgICBjYWxsIGFkZChkaXJzLCBzcGVjLmRpcikKICAgIGVsc2UKICAgICAgbGV0IFtlcnIsIGNsZWFuXSA9IHM6Z2l0X3ZhbGlkYXRlKHNwZWMsIDEpCiAgICAgIGlmIGNsZWFuCiAgICAgICAgbGV0IGVycnNbc3BlYy5kaXJdID0gczpsaW5lcyhlcnIpWzBdCiAgICAgIGVsc2UKICAgICAgICBjYWxsIGFkZChkaXJzLCBzcGVjLmRpcikKICAgICAgZW5kaWYKICAgIGVuZGlmCiAgICBsZXQgY250ICs9IDEKICAgIGNhbGwgczpwcm9ncmVzc19iYXIoMiwgcmVwZWF0KCc9JywgY250KSwgdG90YWwpCiAgICBub3JtYWwhIDJHCiAgICByZWRyYXcKICBlbmRmb3IKCiAgbGV0IGFsbG93ZWQgPSB7fQogIGZvciBkaXIgaW4gZGlycwogICAgbGV0IGFsbG93ZWRbczpkaXJwYXRoKHM6cGx1Z19mbmFtZW1vZGlmeShkaXIsICc6aDpoJykpXSA9IDEKICAgIGxldCBhbGxvd2VkW2Rpcl0gPSAxCiAgICBmb3IgY2hpbGQgaW4gczpnbG9iX2RpcihkaXIpCiAgICAgIGxldCBhbGxvd2VkW2NoaWxkXSA9IDEKICAgIGVuZGZvcgogIGVuZGZvcgoKICBsZXQgdG9kbyA9IFtdCiAgbGV0IGZvdW5kID0gc29ydChzOmdsb2JfZGlyKGc6cGx1Z19ob21lKSkKICB3aGlsZSAhZW1wdHkoZm91bmQpCiAgICBsZXQgZiA9IHJlbW92ZShmb3VuZCwgMCkKICAgIGlmICFoYXNfa2V5KGFsbG93ZWQsIGYpICYmIGlzZGlyZWN0b3J5KGYpCiAgICAgIGNhbGwgYWRkKHRvZG8sIGYpCiAgICAgIGNhbGwgYXBwZW5kKGxpbmUoJyQnKSwgJy0gJyAuIGYpCiAgICAgIGlmIGhhc19rZXkoZXJycywgZikKICAgICAgICBjYWxsIGFwcGVuZChsaW5lKCckJyksICcgICAgJyAuIGVycnNbZl0pCiAgICAgIGVuZGlmCiAgICAgIGxldCBmb3VuZCA9IGZpbHRlcihmb3VuZCwgJ3N0cmlkeCh2OnZhbCwgZikgIT0gMCcpCiAgICBlbmQKICBlbmR3aGlsZQoKICA0CiAgcmVkcmF3CiAgaWYgZW1wdHkodG9kbykKICAgIGNhbGwgYXBwZW5kKGxpbmUoJyQnKSwgJ0FscmVhZHkgY2xlYW4uJykKICBlbHNlCiAgICBsZXQgczpjbGVhbl9jb3VudCA9IDAKICAgIGNhbGwgYXBwZW5kKDMsIFsnRGlyZWN0b3JpZXMgdG8gZGVsZXRlOicsICcnXSkKICAgIHJlZHJhdyEKICAgIGlmIGE6Zm9yY2UgfHwgczphc2tfbm9faW50ZXJydXB0KCdEZWxldGUgYWxsIGRpcmVjdG9yaWVzPycpCiAgICAgIGNhbGwgczpkZWxldGUoWzYsIGxpbmUoJyQnKV0sIDEpCiAgICBlbHNlCiAgICAgIGNhbGwgc2V0bGluZSg0LCAnQ2FuY2VsbGVkLicpCiAgICAgIG5ub3JlbWFwIDxzaWxlbnQ+IDxidWZmZXI+IGQgOnNldCBvcGZ1bmM9PHNpZD5kZWxldGVfb3A8Y3I+Z0AKICAgICAgbm1hcCAgICAgPHNpbGVudD4gPGJ1ZmZlcj4gZGQgZF8KICAgICAgeG5vcmVtYXAgPHNpbGVudD4gPGJ1ZmZlcj4gZCA6PGMtdT5jYWxsIDxzaWQ+ZGVsZXRlX29wKHZpc3VhbG1vZGUoKSwgMSk8Y3I+CiAgICAgIGVjaG8gJ0RlbGV0ZSB0aGUgbGluZXMgKGR7bW90aW9ufSkgdG8gZGVsZXRlIHRoZSBjb3JyZXNwb25kaW5nIGRpcmVjdG9yaWVzJwogICAgZW5kaWYKICBlbmRpZgogIDQKICBzZXRsb2NhbCBub21vZGlmaWFibGUKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmRlbGV0ZV9vcCh0eXBlLCAuLi4pCiAgY2FsbCBzOmRlbGV0ZShhOjAgPyBbbGluZSgiJzwiKSwgbGluZSgiJz4iKV0gOiBbbGluZSgiJ1siKSwgbGluZSgiJ10iKV0sIDApCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpkZWxldGUocmFuZ2UsIGZvcmNlKQogIGxldCBbbDEsIGwyXSA9IGE6cmFuZ2UKICBsZXQgZm9yY2UgPSBhOmZvcmNlCiAgd2hpbGUgbDEgPD0gbDIKICAgIGxldCBsaW5lID0gZ2V0bGluZShsMSkKICAgIGlmIGxpbmUgPX4gJ14tICcgJiYgaXNkaXJlY3RvcnkobGluZVsyOl0pCiAgICAgIGV4ZWN1dGUgbDEKICAgICAgcmVkcmF3IQogICAgICBsZXQgYW5zd2VyID0gZm9yY2UgPyAxIDogczphc2soJ0RlbGV0ZSAnLmxpbmVbMjpdLic/JywgMSkKICAgICAgbGV0IGZvcmNlID0gZm9yY2UgfHwgYW5zd2VyID4gMQogICAgICBpZiBhbnN3ZXIKICAgICAgICBjYWxsIHM6cm1fcmYobGluZVsyOl0pCiAgICAgICAgc2V0bG9jYWwgbW9kaWZpYWJsZQogICAgICAgIGNhbGwgc2V0bGluZShsMSwgJ34nLmxpbmVbMTpdKQogICAgICAgIGxldCBzOmNsZWFuX2NvdW50ICs9IDEKICAgICAgICBjYWxsIHNldGxpbmUoNCwgcHJpbnRmKCdSZW1vdmVkICVkIGRpcmVjdG9yaWVzLicsIHM6Y2xlYW5fY291bnQpKQogICAgICAgIHNldGxvY2FsIG5vbW9kaWZpYWJsZQogICAgICBlbmRpZgogICAgZW5kaWYKICAgIGxldCBsMSArPSAxCiAgZW5kd2hpbGUKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnVwZ3JhZGUoKQogIGVjaG8gJ0Rvd25sb2FkaW5nIHRoZSBsYXRlc3QgdmVyc2lvbiBvZiB2aW0tcGx1ZycKICByZWRyYXcKICBsZXQgdG1wID0gczpwbHVnX3RlbXBuYW1lKCkKICBsZXQgbmV3ID0gdG1wIC4gJy9wbHVnLnZpbScKCiAgdHJ5CiAgICBsZXQgb3V0ID0gczpzeXN0ZW0ocHJpbnRmKCdnaXQgY2xvbmUgLS1kZXB0aCAxICVzICVzJywgcGx1ZyNzaGVsbGVzY2FwZShzOnBsdWdfc3JjKSwgcGx1ZyNzaGVsbGVzY2FwZSh0bXApKSkKICAgIGlmIHY6c2hlbGxfZXJyb3IKICAgICAgcmV0dXJuIHM6ZXJyKCdFcnJvciB1cGdyYWRpbmcgdmltLXBsdWc6ICcuIG91dCkKICAgIGVuZGlmCgogICAgaWYgcmVhZGZpbGUoczptZSkgPT0jIHJlYWRmaWxlKG5ldykKICAgICAgZWNobyAndmltLXBsdWcgaXMgYWxyZWFkeSB1cC10by1kYXRlJwogICAgICByZXR1cm4gMAogICAgZWxzZQogICAgICBjYWxsIHJlbmFtZShzOm1lLCBzOm1lIC4gJy5vbGQnKQogICAgICBjYWxsIHJlbmFtZShuZXcsIHM6bWUpCiAgICAgIHVubGV0IGc6bG9hZGVkX3BsdWcKICAgICAgZWNobyAndmltLXBsdWcgaGFzIGJlZW4gdXBncmFkZWQnCiAgICAgIHJldHVybiAxCiAgICBlbmRpZgogIGZpbmFsbHkKICAgIHNpbGVudCEgY2FsbCBzOnJtX3JmKHRtcCkKICBlbmR0cnkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnVwZ3JhZGVfc3BlY3MoKQogIGZvciBzcGVjIGluIHZhbHVlcyhnOnBsdWdzKQogICAgbGV0IHNwZWMuZnJvemVuID0gZ2V0KHNwZWMsICdmcm96ZW4nLCAwKQogIGVuZGZvcgplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6c3RhdHVzKCkKICBjYWxsIHM6cHJlcGFyZSgpCiAgY2FsbCBhcHBlbmQoMCwgJ0NoZWNraW5nIHBsdWdpbnMnKQogIGNhbGwgYXBwZW5kKDEsICcnKQoKICBsZXQgZWNudCA9IDAKICBsZXQgdW5sb2FkZWQgPSAwCiAgbGV0IFtjbnQsIHRvdGFsXSA9IFswLCBsZW4oZzpwbHVncyldCiAgZm9yIFtuYW1lLCBzcGVjXSBpbiBpdGVtcyhnOnBsdWdzKQogICAgbGV0IGlzX2RpciA9IGlzZGlyZWN0b3J5KHNwZWMuZGlyKQogICAgaWYgaGFzX2tleShzcGVjLCAndXJpJykKICAgICAgaWYgaXNfZGlyCiAgICAgICAgbGV0IFtlcnIsIF9dID0gczpnaXRfdmFsaWRhdGUoc3BlYywgMSkKICAgICAgICBsZXQgW3ZhbGlkLCBtc2ddID0gW2VtcHR5KGVyciksIGVtcHR5KGVycikgPyAnT0snIDogZXJyXQogICAgICBlbHNlCiAgICAgICAgbGV0IFt2YWxpZCwgbXNnXSA9IFswLCAnTm90IGZvdW5kLiBUcnkgUGx1Z0luc3RhbGwuJ10KICAgICAgZW5kaWYKICAgIGVsc2UKICAgICAgaWYgaXNfZGlyCiAgICAgICAgbGV0IFt2YWxpZCwgbXNnXSA9IFsxLCAnT0snXQogICAgICBlbHNlCiAgICAgICAgbGV0IFt2YWxpZCwgbXNnXSA9IFswLCAnTm90IGZvdW5kLiddCiAgICAgIGVuZGlmCiAgICBlbmRpZgogICAgbGV0IGNudCArPSAxCiAgICBsZXQgZWNudCArPSAhdmFsaWQKICAgICIgYHM6bG9hZGVkYCBlbnRyeSBjYW4gYmUgbWlzc2luZyBpZiBQbHVnVXBncmFkZWQKICAgIGlmIGlzX2RpciAmJiBnZXQoczpsb2FkZWQsIG5hbWUsIC0xKSA9PSAwCiAgICAgIGxldCB1bmxvYWRlZCA9IDEKICAgICAgbGV0IG1zZyAuPSAnIChub3QgbG9hZGVkKScKICAgIGVuZGlmCiAgICBjYWxsIHM6cHJvZ3Jlc3NfYmFyKDIsIHJlcGVhdCgnPScsIGNudCksIHRvdGFsKQogICAgY2FsbCBhcHBlbmQoMywgczpmb3JtYXRfbWVzc2FnZSh2YWxpZCA/ICctJyA6ICd4JywgbmFtZSwgbXNnKSkKICAgIG5vcm1hbCEgMkcKICAgIHJlZHJhdwogIGVuZGZvcgogIGNhbGwgc2V0bGluZSgxLCAnRmluaXNoZWQuICcuZWNudC4nIGVycm9yKHMpLicpCiAgbm9ybWFsISBnZwogIHNldGxvY2FsIG5vbW9kaWZpYWJsZQogIGlmIHVubG9hZGVkCiAgICBlY2hvICJQcmVzcyAnTCcgb24gZWFjaCBsaW5lIHRvIGxvYWQgcGx1Z2luLCBvciAnVScgdG8gdXBkYXRlIgogICAgbm5vcmVtYXAgPHNpbGVudD4gPGJ1ZmZlcj4gTCA6Y2FsbCA8U0lEPnN0YXR1c19sb2FkKGxpbmUoJy4nKSk8Y3I+CiAgICB4bm9yZW1hcCA8c2lsZW50PiA8YnVmZmVyPiBMIDpjYWxsIDxTSUQ+c3RhdHVzX2xvYWQobGluZSgnLicpKTxjcj4KICBlbmQKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmV4dHJhY3RfbmFtZShzdHIsIHByZWZpeCwgc3VmZml4KQogIHJldHVybiBtYXRjaHN0cihhOnN0ciwgJ14nLmE6cHJlZml4LicgXHpzW146XVwrXHplOi4qJy5hOnN1ZmZpeC4nJCcpCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpzdGF0dXNfbG9hZChsbnVtKQogIGxldCBsaW5lID0gZ2V0bGluZShhOmxudW0pCiAgbGV0IG5hbWUgPSBzOmV4dHJhY3RfbmFtZShsaW5lLCAnLScsICcobm90IGxvYWRlZCknKQogIGlmICFlbXB0eShuYW1lKQogICAgY2FsbCBwbHVnI2xvYWQobmFtZSkKICAgIHNldGxvY2FsIG1vZGlmaWFibGUKICAgIGNhbGwgc2V0bGluZShhOmxudW0sIHN1YnN0aXR1dGUobGluZSwgJyAobm90IGxvYWRlZCkkJywgJycsICcnKSkKICAgIHNldGxvY2FsIG5vbW9kaWZpYWJsZQogIGVuZGlmCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpzdGF0dXNfdXBkYXRlKCkgcmFuZ2UKICBsZXQgbGluZXMgPSBnZXRsaW5lKGE6Zmlyc3RsaW5lLCBhOmxhc3RsaW5lKQogIGxldCBuYW1lcyA9IGZpbHRlcihtYXAobGluZXMsICdzOmV4dHJhY3RfbmFtZSh2OnZhbCwgIlt4LV0iLCAiIiknKSwgJyFlbXB0eSh2OnZhbCknKQogIGlmICFlbXB0eShuYW1lcykKICAgIGVjaG8KICAgIGV4ZWN1dGUgJ1BsdWdVcGRhdGUnIGpvaW4obmFtZXMpCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmlzX3ByZXZpZXdfd2luZG93X29wZW4oKQogIHNpbGVudCEgd2luY21kIFAKICBpZiAmcHJldmlld3dpbmRvdwogICAgd2luY21kIHAKICAgIHJldHVybiAxCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmZpbmRfbmFtZShsbnVtKQogIGZvciBsbnVtIGluIHJldmVyc2UocmFuZ2UoMSwgYTpsbnVtKSkKICAgIGxldCBsaW5lID0gZ2V0bGluZShsbnVtKQogICAgaWYgZW1wdHkobGluZSkKICAgICAgcmV0dXJuICcnCiAgICBlbmRpZgogICAgbGV0IG5hbWUgPSBzOmV4dHJhY3RfbmFtZShsaW5lLCAnLScsICcnKQogICAgaWYgIWVtcHR5KG5hbWUpCiAgICAgIHJldHVybiBuYW1lCiAgICBlbmRpZgogIGVuZGZvcgogIHJldHVybiAnJwplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6cHJldmlld19jb21taXQoKQogIGlmIGI6cGx1Z19wcmV2aWV3IDwgMAogICAgbGV0IGI6cGx1Z19wcmV2aWV3ID0gIXM6aXNfcHJldmlld193aW5kb3dfb3BlbigpCiAgZW5kaWYKCiAgbGV0IHNoYSA9IG1hdGNoc3RyKGdldGxpbmUoJy4nKSwgJ14gIFxYKlx6c1swLTlhLWZdXHs3LDl9JykKICBpZiBlbXB0eShzaGEpCiAgICByZXR1cm4KICBlbmRpZgoKICBsZXQgbmFtZSA9IHM6ZmluZF9uYW1lKGxpbmUoJy4nKSkKICBpZiBlbXB0eShuYW1lKSB8fCAhaGFzX2tleShnOnBsdWdzLCBuYW1lKSB8fCAhaXNkaXJlY3RvcnkoZzpwbHVnc1tuYW1lXS5kaXIpCiAgICByZXR1cm4KICBlbmRpZgoKICBpZiBleGlzdHMoJ2c6cGx1Z19wd2luZG93JykgJiYgIXM6aXNfcHJldmlld193aW5kb3dfb3BlbigpCiAgICBleGVjdXRlIGc6cGx1Z19wd2luZG93CiAgICBleGVjdXRlICdlJyBzaGEKICBlbHNlCiAgICBleGVjdXRlICdwZWRpdCcgc2hhCiAgICB3aW5jbWQgUAogIGVuZGlmCiAgc2V0bG9jYWwgcHJldmlld3dpbmRvdyBmaWxldHlwZT1naXQgYnVmdHlwZT1ub2ZpbGUgbm9idWZsaXN0ZWQgbW9kaWZpYWJsZQogIGxldCBiYXRjaGZpbGUgPSAnJwogIHRyeQogICAgbGV0IFtzaCwgc2hlbGxjbWRmbGFnLCBzaHJkXSA9IHM6Y2hzaCgxKQogICAgbGV0IGNtZCA9ICdjZCAnLnBsdWcjc2hlbGxlc2NhcGUoZzpwbHVnc1tuYW1lXS5kaXIpLicgJiYgZ2l0IHNob3cgLS1uby1jb2xvciAtLXByZXR0eT1tZWRpdW0gJy5zaGEKICAgIGlmIHM6aXNfd2luCiAgICAgIGxldCBbYmF0Y2hmaWxlLCBjbWRdID0gczpiYXRjaGZpbGUoY21kKQogICAgZW5kaWYKICAgIGV4ZWN1dGUgJ3NpbGVudCAlIScgY21kCiAgZmluYWxseQogICAgbGV0IFsmc2hlbGwsICZzaGVsbGNtZGZsYWcsICZzaGVsbHJlZGlyXSA9IFtzaCwgc2hlbGxjbWRmbGFnLCBzaHJkXQogICAgaWYgczppc193aW4gJiYgZmlsZXJlYWRhYmxlKGJhdGNoZmlsZSkKICAgICAgY2FsbCBkZWxldGUoYmF0Y2hmaWxlKQogICAgZW5kaWYKICBlbmR0cnkKICBzZXRsb2NhbCBub21vZGlmaWFibGUKICBubm9yZW1hcCA8c2lsZW50PiA8YnVmZmVyPiBxIDpxPGNyPgogIHdpbmNtZCBwCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpzZWN0aW9uKGZsYWdzKQogIGNhbGwgc2VhcmNoKCdcKF5beC1dIFwpXEA8PVteOl1cKzonLCBhOmZsYWdzKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6Zm9ybWF0X2dpdF9sb2cobGluZSkKICBsZXQgaW5kZW50ID0gJyAgJwogIGxldCB0b2tlbnMgPSBzcGxpdChhOmxpbmUsIG5yMmNoYXIoMSkpCiAgaWYgbGVuKHRva2VucykgIT0gNQogICAgcmV0dXJuIGluZGVudC5zdWJzdGl0dXRlKGE6bGluZSwgJ1xzKiQnLCAnJywgJycpCiAgZW5kaWYKICBsZXQgW2dyYXBoLCBzaGEsIHJlZnMsIHN1YmplY3QsIGRhdGVdID0gdG9rZW5zCiAgbGV0IHRhZyA9IG1hdGNoc3RyKHJlZnMsICd0YWc6IFteLCldXCsnKQogIGxldCB0YWcgPSBlbXB0eSh0YWcpID8gJyAnIDogJyAoJy50YWcuJykgJwogIHJldHVybiBwcmludGYoJyVzJXMlcyVzJXMgKCVzKScsIGluZGVudCwgZ3JhcGgsIHNoYSwgdGFnLCBzdWJqZWN0LCBkYXRlKQplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6YXBwZW5kX3VsKGxudW0sIHRleHQpCiAgY2FsbCBhcHBlbmQoYTpsbnVtLCBbJycsIGE6dGV4dCwgcmVwZWF0KCctJywgbGVuKGE6dGV4dCkpXSkKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOmRpZmYoKQogIGNhbGwgczpwcmVwYXJlKCkKICBjYWxsIGFwcGVuZCgwLCBbJ0NvbGxlY3RpbmcgY2hhbmdlcyAuLi4nLCAnJ10pCiAgbGV0IGNudHMgPSBbMCwgMF0KICBsZXQgYmFyID0gJycKICBsZXQgdG90YWwgPSBmaWx0ZXIoY29weShnOnBsdWdzKSwgJ3M6aXNfbWFuYWdlZCh2OmtleSkgJiYgaXNkaXJlY3Rvcnkodjp2YWwuZGlyKScpCiAgY2FsbCBzOnByb2dyZXNzX2JhcigyLCBiYXIsIGxlbih0b3RhbCkpCiAgZm9yIG9yaWdpbiBpbiBbMSwgMF0KICAgIGxldCBwbHVncyA9IHJldmVyc2Uoc29ydChpdGVtcyhmaWx0ZXIoY29weSh0b3RhbCksIChvcmlnaW4gPyAnJyA6ICchJykuJyhoYXNfa2V5KHY6dmFsLCAiY29tbWl0IikgfHwgaGFzX2tleSh2OnZhbCwgInRhZyIpKScpKSkpCiAgICBpZiBlbXB0eShwbHVncykKICAgICAgY29udGludWUKICAgIGVuZGlmCiAgICBjYWxsIHM6YXBwZW5kX3VsKDIsIG9yaWdpbiA/ICdQZW5kaW5nIHVwZGF0ZXM6JyA6ICdMYXN0IHVwZGF0ZTonKQogICAgZm9yIFtrLCB2XSBpbiBwbHVncwogICAgICBsZXQgcmFuZ2UgPSBvcmlnaW4gPyAnLi5vcmlnaW4vJy52LmJyYW5jaCA6ICdIRUFEQHsxfS4uJwogICAgICBsZXQgY21kID0gJ2dpdCBsb2cgLS1ncmFwaCAtLWNvbG9yPW5ldmVyICcKICAgICAgXCAuIChzOmdpdF92ZXJzaW9uX3JlcXVpcmVtZW50KDIsIDEwLCAwKSA/ICctLW5vLXNob3ctc2lnbmF0dXJlICcgOiAnJykKICAgICAgXCAuIGpvaW4obWFwKFsnLS1wcmV0dHk9Zm9ybWF0OiV4MDElaCV4MDElZCV4MDElcyV4MDElY3InLCByYW5nZV0sICdwbHVnI3NoZWxsZXNjYXBlKHY6dmFsKScpKQogICAgICBpZiBoYXNfa2V5KHYsICdydHAnKQogICAgICAgIGxldCBjbWQgLj0gJyAtLSAnLnBsdWcjc2hlbGxlc2NhcGUodi5ydHApCiAgICAgIGVuZGlmCiAgICAgIGxldCBkaWZmID0gczpzeXN0ZW1fY2hvbXAoY21kLCB2LmRpcikKICAgICAgaWYgIWVtcHR5KGRpZmYpCiAgICAgICAgbGV0IHJlZiA9IGhhc19rZXkodiwgJ3RhZycpID8gKCcgKHRhZzogJy52LnRhZy4nKScpIDogaGFzX2tleSh2LCAnY29tbWl0JykgPyAoJyAnLnYuY29tbWl0KSA6ICcnCiAgICAgICAgY2FsbCBhcHBlbmQoNSwgZXh0ZW5kKFsnJywgJy0gJy5rLic6Jy5yZWZdLCBtYXAoczpsaW5lcyhkaWZmKSwgJ3M6Zm9ybWF0X2dpdF9sb2codjp2YWwpJykpKQogICAgICAgIGxldCBjbnRzW29yaWdpbl0gKz0gMQogICAgICBlbmRpZgogICAgICBsZXQgYmFyIC49ICc9JwogICAgICBjYWxsIHM6cHJvZ3Jlc3NfYmFyKDIsIGJhciwgbGVuKHRvdGFsKSkKICAgICAgbm9ybWFsISAyRwogICAgICByZWRyYXcKICAgIGVuZGZvcgogICAgaWYgIWNudHNbb3JpZ2luXQogICAgICBjYWxsIGFwcGVuZCg1LCBbJycsICdOL0EnXSkKICAgIGVuZGlmCiAgZW5kZm9yCiAgY2FsbCBzZXRsaW5lKDEsIHByaW50ZignJWQgcGx1Z2luKHMpIHVwZGF0ZWQuJywgY250c1swXSkKICAgICAgICBcIC4gKGNudHNbMV0gPyBwcmludGYoJyAlZCBwbHVnaW4ocykgaGF2ZSBwZW5kaW5nIHVwZGF0ZXMuJywgY250c1sxXSkgOiAnJykpCgogIGlmIGNudHNbMF0gfHwgY250c1sxXQogICAgbm5vcmVtYXAgPHNpbGVudD4gPGJ1ZmZlcj4gPHBsdWc+KHBsdWctcHJldmlldykgOnNpbGVudCEgY2FsbCA8U0lEPnByZXZpZXdfY29tbWl0KCk8Y3I+CiAgICBpZiBlbXB0eShtYXBhcmcoIlw8Y3I+IiwgJ24nKSkKICAgICAgbm1hcCA8YnVmZmVyPiA8Y3I+IDxwbHVnPihwbHVnLXByZXZpZXcpCiAgICBlbmRpZgogICAgaWYgZW1wdHkobWFwYXJnKCdvJywgJ24nKSkKICAgICAgbm1hcCA8YnVmZmVyPiBvIDxwbHVnPihwbHVnLXByZXZpZXcpCiAgICBlbmRpZgogIGVuZGlmCiAgaWYgY250c1swXQogICAgbm5vcmVtYXAgPHNpbGVudD4gPGJ1ZmZlcj4gWCA6Y2FsbCA8U0lEPnJldmVydCgpPGNyPgogICAgZWNobyAiUHJlc3MgJ1gnIG9uIGVhY2ggYmxvY2sgdG8gcmV2ZXJ0IHRoZSB1cGRhdGUiCiAgZW5kaWYKICBub3JtYWwhIGdnCiAgc2V0bG9jYWwgbm9tb2RpZmlhYmxlCmVuZGZ1bmN0aW9uCgpmdW5jdGlvbiEgczpyZXZlcnQoKQogIGlmIHNlYXJjaCgnXlBlbmRpbmcgdXBkYXRlcycsICdiblcnKQogICAgcmV0dXJuCiAgZW5kaWYKCiAgbGV0IG5hbWUgPSBzOmZpbmRfbmFtZShsaW5lKCcuJykpCiAgaWYgZW1wdHkobmFtZSkgfHwgIWhhc19rZXkoZzpwbHVncywgbmFtZSkgfHwKICAgIFwgaW5wdXQocHJpbnRmKCdSZXZlcnQgdGhlIHVwZGF0ZSBvZiAlcz8gKHkvTikgJywgbmFtZSkpICF+PyAnXnknCiAgICByZXR1cm4KICBlbmRpZgoKICBjYWxsIHM6c3lzdGVtKCdnaXQgcmVzZXQgLS1oYXJkIEhFQURAezF9ICYmIGdpdCBjaGVja291dCAnLnBsdWcjc2hlbGxlc2NhcGUoZzpwbHVnc1tuYW1lXS5icmFuY2gpLicgLS0nLCBnOnBsdWdzW25hbWVdLmRpcikKICBzZXRsb2NhbCBtb2RpZmlhYmxlCiAgbm9ybWFsISAiX2RhcAogIHNldGxvY2FsIG5vbW9kaWZpYWJsZQogIGVjaG8gJ1JldmVydGVkJwplbmRmdW5jdGlvbgoKZnVuY3Rpb24hIHM6c25hcHNob3QoZm9yY2UsIC4uLikgYWJvcnQKICBjYWxsIHM6cHJlcGFyZSgpCiAgc2V0ZiB2aW0KICBjYWxsIGFwcGVuZCgwLCBbJyIgR2VuZXJhdGVkIGJ5IHZpbS1wbHVnJywKICAgICAgICAgICAgICAgIFwgJyIgJy5zdHJmdGltZSgiJWMiKSwKICAgICAgICAgICAgICAgIFwgJyIgOnNvdXJjZSB0aGlzIGZpbGUgaW4gdmltIHRvIHJlc3RvcmUgdGhlIHNuYXBzaG90JywKICAgICAgICAgICAgICAgIFwgJyIgb3IgZXhlY3V0ZTogdmltIC1TIHNuYXBzaG90LnZpbScsCiAgICAgICAgICAgICAgICBcICcnLCAnJywgJ1BsdWdVcGRhdGUhJ10pCiAgMQogIGxldCBhbmNob3IgPSBsaW5lKCckJykgLSAzCiAgbGV0IG5hbWVzID0gc29ydChrZXlzKGZpbHRlcihjb3B5KGc6cGx1Z3MpLAogICAgICAgIFwnaGFzX2tleSh2OnZhbCwgInVyaSIpICYmICFoYXNfa2V5KHY6dmFsLCAiY29tbWl0IikgJiYgaXNkaXJlY3Rvcnkodjp2YWwuZGlyKScpKSkKICBmb3IgbmFtZSBpbiByZXZlcnNlKG5hbWVzKQogICAgbGV0IHNoYSA9IHM6c3lzdGVtX2Nob21wKCdnaXQgcmV2LXBhcnNlIC0tc2hvcnQgSEVBRCcsIGc6cGx1Z3NbbmFtZV0uZGlyKQogICAgaWYgIWVtcHR5KHNoYSkKICAgICAgY2FsbCBhcHBlbmQoYW5jaG9yLCBwcmludGYoInNpbGVudCEgbGV0IGc6cGx1Z3NbJyVzJ10uY29tbWl0ID0gJyVzJyIsIG5hbWUsIHNoYSkpCiAgICAgIHJlZHJhdwogICAgZW5kaWYKICBlbmRmb3IKCiAgaWYgYTowID4gMAogICAgbGV0IGZuID0gczpwbHVnX2V4cGFuZChhOjEpCiAgICBpZiBmaWxlcmVhZGFibGUoZm4pICYmICEoYTpmb3JjZSB8fCBzOmFzayhhOjEuJyBhbHJlYWR5IGV4aXN0cy4gT3ZlcndyaXRlPycpKQogICAgICByZXR1cm4KICAgIGVuZGlmCiAgICBjYWxsIHdyaXRlZmlsZShnZXRsaW5lKDEsICckJyksIGZuKQogICAgZWNobyAnU2F2ZWQgYXMgJy5hOjEKICAgIHNpbGVudCBleGVjdXRlICdlJyBzOmVzYyhmbikKICAgIHNldGYgdmltCiAgZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmN0aW9uISBzOnNwbGl0X3J0cCgpCiAgcmV0dXJuIHNwbGl0KCZydHAsICdcXFxAPCEsJykKZW5kZnVuY3Rpb24KCmxldCBzOmZpcnN0X3J0cCA9IHM6ZXNjcnRwKGdldChzOnNwbGl0X3J0cCgpLCAwLCAnJykpCmxldCBzOmxhc3RfcnRwICA9IHM6ZXNjcnRwKGdldChzOnNwbGl0X3J0cCgpLCAtMSwgJycpKQoKaWYgZXhpc3RzKCdnOnBsdWdzJykKICBsZXQgZzpwbHVnc19vcmRlciA9IGdldChnOiwgJ3BsdWdzX29yZGVyJywga2V5cyhnOnBsdWdzKSkKICBjYWxsIHM6dXBncmFkZV9zcGVjcygpCiAgY2FsbCBzOmRlZmluZV9jb21tYW5kcygpCmVuZGlmCgpsZXQgJmNwbyA9IHM6Y3BvX3NhdmUKdW5sZXQgczpjcG9fc2F2ZQo=",
        "usr/intshell/dev/vim/sh.vim": "aGlnaGxpZ2h0IGlzaEtleSAgICBjdGVybWZnPXllbGxvdwpoaWdobGlnaHQgaXNoRnVuYyAgICBjdGVybWZnPWN5YW4KCnN5bnRheCBtYXRjaCBpc2hLZXkgIm1ha2UiCnN5bnRheCBtYXRjaCBpc2hLZXkgInJlcXVpcmUiCnN5bnRheCBtYXRjaCBpc2hGdW5jICJpc2hfbWlzc19wcmVwYXJlIgpzeW50YXggbWF0Y2ggaXNoRnVuYyAiaXNoX21pc3NfbWFrZSIKCnN5bnRheCBtYXRjaCBpc2hLZXkgImxvY2FsIgpzeW50YXggbWF0Y2ggaXNoS2V5ICJ3aGl0ZSIKCnNldCBmb2xkbWV0aG9kPW1hcmtlcgpzZXQgZm9sZG1hcmtlcj17LH0KCg==",
        "usr/intshell/dev/vim/shy.vim": "CnNldCBmb2xkbWV0aG9kPWluZGVudApzeW50YXggbWF0Y2ggQ29tbWVudAkgICAgIiMuKiQiCnN5bnRheCBtYXRjaCBDb21tZW50CSAgICAiXCJbXlwiXSpcIiIKCmhpZ2hsaWdodCBzaHlTdHJpbmcgICAgIGN0ZXJtZmc9bWFnZW50YQpzeW50YXggcmVnaW9uIHNoeVN0cmluZwlzdGFydD0iYCIgZW5kPSJgIgpzeW50YXggbWF0Y2ggc2h5U3RyaW5nCSAgICAiXGBbXlxgXSpcYCIKc3ludGF4IG1hdGNoIHNoeVN0cmluZwkgICAgImZhbHNlIgpzeW50YXggbWF0Y2ggc2h5U3RyaW5nCSAgICAidHJ1ZSIKCmhpZ2hsaWdodCBzaHlDb250ZXh0ICAgIGN0ZXJtZmc9cmVkCnN5bnRheCBtYXRjaCBzaHlDb250ZXh0ICJcflthLXpcLl1cKyIKCmhpZ2hsaWdodCBzaHlDb21tYW5kICAgIGN0ZXJtZmc9Z3JlZW4Kc3ludGF4IG1hdGNoIHNoeUNvbW1hbmQgIl4gICAgW2EtekEtWjAtOTouX11cKyIKc3ludGF4IG1hdGNoIHNoeUNvbW1hbmQgIl5cdFthLXpBLVowLTk6Ll9dXCsiCnN5bnRheCBtYXRjaCBzaHlDb21tYW5kICJeW2EtekEtWjAtOTouX11cKyIKCmhpZ2hsaWdodCBzaHlDb25maWcgICAgY3Rlcm1mZz15ZWxsb3cKc3ludGF4IG1hdGNoIHNoeUNvbmZpZyAiXiAgICBjb25maWciCnN5bnRheCBtYXRjaCBzaHlDb25maWcgIl5zb3VyY2UiCnN5bnRheCBtYXRjaCBzaHlDb25maWcgIl5yZXR1cm4iCgoKaGlnaGxpZ2h0IHNoeVRpdGxlICAgIGN0ZXJtYmc9ZGFya3JlZCBjdGVybWZnPXdoaXRlCmhpZ2hsaWdodCBzaHlTZWN0aW9uICAgIGN0ZXJtYmc9ZGFya2dyZWVuIGN0ZXJtZmc9d2hpdGUKc3ludGF4IG1hdGNoIHNoeVRpdGxlICJedGl0bGUiCnN5bnRheCBtYXRjaCBzaHlUaXRsZSAiXmNoYXB0ZXIiCnN5bnRheCBtYXRjaCBzaHlTZWN0aW9uICJec2VjdGlvbiIKCg==",
        "usr/intshell/dev/vim/vim.sh": "IyEvYmluL2Jhc2gKCmlzaF9kZXZfdmltX3ByZXBhcmUoKSB7CiAgICBsb2NhbCBmcm9tPSRQV0QvdXNyL2ludHNoZWxsL2Rldi92aW0KCiAgICBta2RpciAtcCB+Ly52aW0vYXV0b2xvYWQKICAgIGlzaF9zeXNfbGlua19jcmVhdGUgfi8udmltL2F1dG9sb2FkL3BsdWcudmltICRmcm9tL3BsdWcudmltCiAgICBpc2hfc3lzX2xpbmtfY3JlYXRlIH4vLnZpbS9hdXRvbG9hZC9hdXRvLnZpbSAkZnJvbS9hdXRvLnZpbQoKICAgIG1rZGlyIC1wIH4vLnZpbS9zeW50YXgKICAgIGlzaF9zeXNfbGlua19jcmVhdGUgfi8udmltL3N5bnRheC9zaC52aW0gJGZyb20vc2gudmltCiAgICBpc2hfc3lzX2xpbmtfY3JlYXRlIH4vLnZpbS9zeW50YXgvc2h5LnZpbSAkZnJvbS9zaHkudmltCiAgICBpc2hfc3lzX2xpbmtfY3JlYXRlIH4vLnZpbS9zeW50YXgvZ28udmltICRmcm9tL2dvLnZpbQogICAgaXNoX3N5c19saW5rX2NyZWF0ZSB+Ly52aW0vc3ludGF4L2ltbC52aW0gJGZyb20vaW1sLnZpbQogICAgaXNoX3N5c19saW5rX2NyZWF0ZSB+Ly52aW0vc3ludGF4L3ptbC52aW0gJGZyb20vem1sLnZpbQogICAgaXNoX3N5c19saW5rX2NyZWF0ZSB+Ly52aW0vc3ludGF4L2Nzcy52aW0gJGZyb20vY3NzLnZpbQogICAgaXNoX3N5c19saW5rX2NyZWF0ZSB+Ly52aW0vc3ludGF4L2phdmFzY3JpcHQudmltICRmcm9tL2phdmFzY3JpcHQudmltCgogICAgaXNoX3N5c19saW5rX2NyZWF0ZSB+Ly52aW1yYyAkZnJvbS92aW1yYwogICAgdmltIC1jIFBsdWdJbnN0YWxsIC1jIGV4aXQgLWMgZXhpdAogICAgdmltIC1jIEdvSW5zdGFsbEJpbmFyaWVzIC1jIGV4aXQgLWMgZXhpdAp9CmlzaF9kZXZfdmltX2NsZWFyKCkgewogICAgZm9yIHBhdGggaW4gdm9sY2Fub3MgbGVhcm5pbmcgaWNlYmVyZ3MgdG9vbGtpdHMgaW50c2hlbGw7IGRvCiAgICAgICAgZm9yIGZpbGUgaW4gYGZpbmQgdXNyLyRwYXRoLyAtbmFtZSAiKnN3cCJgOyBkbwogICAgICAgICAgICBpc2hfbG9nX2RlYnVnICJybSAkZmlsZSI7IHJtICRmaWxlCiAgICAgICAgZG9uZQogICAgZG9uZQoKICAgIGZvciBmaWxlIGluIGBmaW5kIC4vIC1uYW1lICIqc3dwImA7IGRvCiAgICAgICAgaXNoX2xvZ19kZWJ1ZyAicm0gJGZpbGUiOyBybSAiJGZpbGUiCiAgICBkb25lCn0KCg==",
        "usr/intshell/dev/vim/vimrc": "IiDova/ku7blronoo4Uge3t7CiIkIGN1cmwgLWZMbyB+Ly52aW0vYXV0b2xvYWQvcGx1Zy52aW0gLS1jcmVhdGUtZGlycyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vanVuZWd1bm4vdmltLXBsdWcvbWFzdGVyL3BsdWcudmltCiIKIjEuIOWuieijhXZpbeWQhOenjeaPkuS7tgoiOlBsdWdJbnN0YWxsCiIKIjIuIOWuieijhWdv5ZCE56eN5o+S5Lu2CiI6R29JbnN0YWxsQmluYXJpZXMKIn19fQoiIOaPkuS7tuWIl+ihqCJ7e3sKaWYgZmlsZXJlYWRhYmxlKGV4cGFuZCgifi8udmltL2F1dG9sb2FkL3BsdWcudmltIikpCgljYWxsIHBsdWcjYmVnaW4oKQoJUGx1ZyAnZ2NtdC90YWJvby52aW0nCglzZXQgc2Vzc2lvbm9wdGlvbnMrPXRhYnBhZ2VzLGdsb2JhbHMKCglQbHVnICdhcnR1ci1zaGFpay92aW0tamF2YWNvbXBsZXRlMicKCgoJUGx1ZyAna2llbi9jdHJscC52aW0nCglsZXQgZzpjdHJscF9jbWQ9J0N0cmxQQnVmZmVyJwoKCVBsdWcgJ3ZpbS1haXJsaW5lL3ZpbS1haXJsaW5lJwoJUGx1ZyAnYWlyYmxhZGUvdmltLWdpdGd1dHRlcicKCVBsdWcgJ3Rwb3BlL3ZpbS1mdWdpdGl2ZScKCglQbHVnICdtYWp1dHN1c2hpL3RhZ2JhcicKCVBsdWcgJ3Njcm9vbG9vc2UvbmVyZHRyZWUnCglsZXQgZzpORVJEVHJlZVdpblBvcz0ibGVmdCIKCWxldCBnOk5FUkRUcmVlV2luU2l6ZT0yMAoKCSIgUGx1ZyAncG9zdmEvdmltLXZ1ZScKCVBsdWcgJ2ZhdGloL3ZpbS1nbycKCVBsdWcgJ2NocjQvbmdpbngudmltJwoJUGx1ZyAnb3RocmVlL2h0bWw1LnZpbScKCVBsdWcgJ3ZpbS1zY3JpcHRzL3B5dGhvbi52aW0nCglQbHVnICdwbGFzdGljYm95L3ZpbS1tYXJrZG93bicKCglQbHVnICdtYmJpbGwvZWNob2Z1bmMnCglQbHVnICd2aW0tc2NyaXB0cy90Q29tbWVudCcKCVBsdWcgJ3ZpbS1zeW50YXN0aWMvc3ludGFzdGljJwoJUGx1ZyAndmltLXNjcmlwdHMvbWF0cml4LnZpbS0tWWFuZycKCWNhbGwgcGx1ZyNlbmQoKQplbmRpZgoifX19CiIg5Z+65pys6YWN572uInt7ewpzZXQgY2M9MTIwCnNldCBub3dyYXAKc2V0IG51bWJlcgpzZXQgcmVsYXRpdmVudW1iZXIKc2V0IGN1cnNvcmxpbmUKc2V0IGN1cnNvcmNvbHVtbgpzZXQgc2Nyb2xsb2ZmPTMKc2V0IG1vdXNlPWEKCiIg57yT5a2YCnNldCBoaWRkZW4Kc2V0IGF1dG93cml0ZQpzZXQgZW5jb2Rpbmc9dXRmLTgKCiIg5pCc57SiCnNldCBobHNlYXJjaApzZXQgaW5jc2VhcmNoCnNldCBub3dyYXBzY2FuCnNldCBzbWFydGNhc2UKc2V0IGlnbm9yZWNhc2UKc2V0IHNob3dtYXRjaApzZXQgbWF0Y2h0aW1lPTIKCiIg57yp6L+bCnNldCBjaW5kZW50CiIgc2V0IGV4cGFuZHRhYgpzZXQgdGFic3RvcD00CnNldCBzaGlmdHdpZHRoPTQKc2V0IGJhY2tzcGFjZT1pbmRlbnQsZW9sLHN0YXJ0CgoiIOaKmOWPoApzZXQgZm9sZGVuYWJsZQpzZXQgZm9sZG1ldGhvZD1tYXJrZXIKCiIg5oyJ6ZSuCm5ub3JlbWFwIDxTcGFjZT4gOgpubm9yZW1hcCA8Qy1IPiA8Qy1XPmgKbm5vcmVtYXAgPEMtSj4gPEMtVz5qCm5ub3JlbWFwIDxDLUs+IDxDLVc+awpubm9yZW1hcCA8Qy1MPiA8Qy1XPmwKCm5ub3JlbWFwIDxGMj4gOk5FUkRUcmVlVG9nZ2xlPENSPgpubm9yZW1hcCA8RjM+IDpUYWdiYXJUb2dnbGU8Q1I+CiJ9fX0KIiDnvJbnqIvphY3nva57e3sKc2V0IGtleXdvcmRwcmc9bWFuXCAtYQoKZnVuY3Rpb24hIENvbmZpZyh0eXBlKQoJaWYgYTp0eXBlID09ICJjb25mIgoJCXNldCBmaWxldHlwZT1uZ2lueAoJZWxzZWlmIGE6dHlwZSA9PSAieG1sIgoJCXNldCBmaWxldHlwZT14bWwKCWVsc2VpZiBhOnR5cGUgPT0gInZ1ZSIKCQlzZXQgc2hpZnR3aWR0aD0yCgkJc2V0IHRhYnN0b3A9MgoJZW5kaWYKZW5kZnVuY3Rpb24KCmZ1bmMhIENvbmZpZ3MoKQoJbGV0IGV4dCA9IGV4cGFuZCgiJTplIikKCWlmIGV4dCA9PSAiZ28iCgkJc2V0IGZvbGRuZXN0bWF4PTMKCQlzZXQgZm9sZG1ldGhvZD1zeW50YXgKCQlsZXQgZzp0YWdiYXJfY3RhZ3NfYmluID0gImdvdGFncyIKCQlubm9yZW1hcCA8Qy1bPiA6R29JbXBsZW1lbnRzPENSPgoKCQlsZXQgZzpnb191cGRhdGV0aW1lID0gMzAwCgkJIiBsZXQgZzpnb19hdXRvX3NhbWVpZHMgPSAwCgkJbGV0IGc6Z29fYXV0b190eXBlX2luZm8gPSAxCgkJbGV0IGc6Z29fdmVyc2lvbl93YXJuaW5nID0gMAoJCQoJCWxldCBnOmdvX2ZtdF9hdXRvc2F2ZSA9IDEKCQlsZXQgZzpnb19pbXBvcnRzX2F1dG9zYXZlID0gMQoJCSIgbGV0IGc6Z29fbWV0YWxpbnRlcl9hdXRvc2F2ZSA9IDEKCQkKCQlsZXQgZzpnb19oaWdobGlnaHRfdHlwZXMgPSAxCgkJbGV0IGc6Z29faGlnaGxpZ2h0X2Z1bmN0aW9ucyA9IDEKCQlsZXQgZzpnb19oaWdobGlnaHRfb3BlcmF0b3JzID0gMQoJCWxldCBnOmdvX2hpZ2hsaWdodF9zcGFjZV90YWJfZXJyb3IgPSAxCgkJbGV0IGc6Z29faGlnaGxpZ2h0X3RyYWlsaW5nX3doaXRlc3BhY2VfZXJyb3IgPSAxCgkJCgkJIiBhdXRvY21kIEJ1ZldyaXRlUHJlICouZ28gR29GbXQKCQkiIGF1dG9jbWQgQnVmV3JpdGVQcmUgKi5nbyBHb1ZldAoJCSIgYXV0b2NtZCBCdWZXcml0ZVByZSAqLmdvIEdvTGludAoJCSIgYXV0b2NtZCBCdWZXcml0ZVByZSAqLmdvIEdvSW1wb3J0cwoKCWVsc2VpZiBleHQgPT0gInNoeSIKCQlzZXQgZmlsZXR5cGU9c2h5CgkJc2V0IHRhYnN0b3A9MgoJCXNldCBzaGlmdHdpZHRoPTIKCQlzZXQgY29tbWVudHN0cmluZz0jJXMKCgllbHNlaWYgZXh0ID09ICJqc29uIgoJCXNldCBmb2xkbWV0aG9kPXN5bnRheAoKCWVsc2VpZiBleHQgPT0gImpzIgoJCXNldCBmaWxldHlwZT1qYXZhc2NyaXB0CgkJc2V0IGZvbGRtZXRob2Q9bWFya2VyCgkJc2V0IGZvbGRtYXJrZXI9eyx9CgkJbGV0IGphdmFTY3JpcHRfZm9sZD0xCgkJc291cmNlIH4vLnZpbS9zeW50YXgvamF2YXNjcmlwdC52aW0KCgllbHNlaWYgZXh0ID09ICJjc3MiCgkJc2V0IGZpbGV0eXBlPWNzcwoJCXNldCBmb2xkbWV0aG9kPW1hcmtlcgoJCXNldCBmb2xkbWFya2VyPXssfQoJCXNldCBzaGlmdHdpZHRoPTIKCQlzZXQgdGFic3RvcD0yCgoJZWxzZWlmIGV4dCA9PSAiem1sIgoJCXNldCBmaWxldHlwZT16bWwKCQlzZXQgdGFic3RvcD0yCgkJc2V0IHNoaWZ0d2lkdGg9MgoJCXNldCBjb21tZW50c3RyaW5nPSMlcwoKCWVsc2VpZiBleHQgPT0gImltbCIKCQlzZXQgZmlsZXR5cGU9aW1sCgkJc2V0IHRhYnN0b3A9MgoJCXNldCBzaGlmdHdpZHRoPTIKCQlzZXQgY29tbWVudHN0cmluZz0jJXMKCgllbHNlaWYgZXh0ID09ICJ5YW1sIgoJCXNldCBzaGlmdHdpZHRoPTIKCQlzZXQgdGFic3RvcD0yCgoJZWxzZWlmIGV4dCA9PSAicHJvdG8iCgkJc2V0IGZvbGRtYXJrZXI9eyx9CgkJc2V0IHNoaWZ0d2lkdGg9MgoJCXNldCB0YWJzdG9wPTIKCQlzZXQgZXhwYW5kdGFiCgoJZWxzZWlmIGV4dCA9PSAic3FsIgoJCXNldCBmb2xkbWFya2VyPSgsKQoJCXNldCBzaGlmdHdpZHRoPTIKCQlzZXQgdGFic3RvcD0yCgkJc2V0IGV4cGFuZHRhYgoKCWVsc2VpZiBleHQgPT0gImdyb292eSIKCQlzZXQgZXhwYW5kdGFiCgkJc2V0IHRhYnN0b3A9NAoJCXNldCBzaGlmdHdpZHRoPTQKCiAgICBlbHNlaWYgZXh0ID09ICJqYXZhIgoJCXNldCBleHBhbmR0YWIKCQlzZXQgdGFic3RvcD00CgkJc2V0IHNoaWZ0d2lkdGg9NAoJCXNldCBvbW5pZnVuYz1qYXZhY29tcGxldGUjQ29tcGxldGUKCgllbmRpZgplbmRmdW5jCgphdXRvY21kIEJ1Zk5ld0ZpbGUsQnVmUmVhZFBvc3QgKiBjYWxsIENvbmZpZ3MoKQphdXRvY21kIEJ1Zk5ld0ZpbGUsQnVmUmVhZFBvc3QgKi5jb25mIGNhbGwgQ29uZmlnKCJjb25mIikKYXV0b2NtZCBCdWZOZXdGaWxlLEJ1ZlJlYWRQb3N0ICoud3htbCBjYWxsIENvbmZpZygieG1sIikKYXV0b2NtZCBCdWZOZXdGaWxlLEJ1ZlJlYWRQb3N0ICoudnVlIGNhbGwgQ29uZmlnKCJ2dWUiKQoifX19Cgoi5pys5Zyw6YWN572uInt7ewppZiBmaWxlcmVhZGFibGUoZXhwYW5kKCJ+Ly52aW0vYXV0b2xvYWQvYXV0by52aW0iKSkgfCBzb3VyY2Ugfi8udmltL2F1dG9sb2FkL2F1dG8udmltIHwgZW5kaWYKaWYgZmlsZXJlYWRhYmxlKGV4cGFuZCgifi8udmltX2xvY2FsLnZpbSIpKSB8IHNvdXJjZSB+Ly52aW1fbG9jYWwudmltIHwgZW5kaWYKYXV0b2NtZCBCdWZSZWFkUG9zdCAqIG5vcm1hbCBgIgoifX19CiLkuLvpopjoibLns7sie3t7CnN5bnRheCBvbgpzZXQgdF9Dbz0yNTYKY29sb3JzY2hlbWUgdG9ydGUKIiBjb2xvcnNjaGVtZSBlbGZsb3JkCgpoaWdobGlnaHQgQ29tbWVudCBjdGVybWZnPWN5YW4gY3Rlcm1iZz1kYXJrYmx1ZQpoaWdobGlnaHQgUG1lbnVTZWwgY3Rlcm1mZz1kYXJrYmx1ZSBjdGVybWJnPWN5YW4KaGlnaGxpZ2h0IFBtZW51IGN0ZXJtZmc9Y3lhbiBjdGVybWJnPWRhcmtibHVlCiJ9fX0K",
        "usr/intshell/dev/vim/zml.vim": "aGlnaGxpZ2h0IHptbENvbW1hbmQgICAgY3Rlcm1mZz15ZWxsb3cKc3ludGF4IG1hdGNoIHptbENvbW1hbmQgIl5oZWFkIgpzeW50YXggbWF0Y2ggem1sQ29tbWFuZCAiXmxlZnQiCnN5bnRheCBtYXRjaCB6bWxDb21tYW5kICJebWFpbiIKc3ludGF4IG1hdGNoIHptbENvbW1hbmQgIl5mb290IgpzeW50YXggbWF0Y2ggem1sQ29tbWFuZCAiXm1lbnUiCgpoaWdobGlnaHQgem1sRnVuY3Rpb24gICAgY3Rlcm1mZz1jeWFuCnN5bnRheCBtYXRjaCB6bWxGdW5jdGlvbiAiaW5kZXgiCnN5bnRheCBtYXRjaCB6bWxGdW5jdGlvbiAiYWN0aW9uIgpzeW50YXggbWF0Y2ggem1sRnVuY3Rpb24gImFyZ3MiCnN5bnRheCBtYXRjaCB6bWxGdW5jdGlvbiAic3R5bGUiCnN5bnRheCBtYXRjaCB6bWxGdW5jdGlvbiAic3R5bGUud2lkdGgiCgpoaWdobGlnaHQgem1sQ29uc3RhbnQgICAgY3Rlcm1mZz1tYWdlbnRhCnN5bnRheCBtYXRjaCB6bWxDb25zdGFudCAiYXV0byIKc3ludGF4IG1hdGNoIHptbENvbnN0YW50ICJ1c2VybmFtZSIK",
        "usr/intshell/index.sh": "IyEvYmluL3NoCgpleHBvcnQgY3R4X2Rldj0ke2N0eF9kZXY6PSJodHRwczovL2NvbnRleHRzLmNvbS5jbiJ9CiMgZXhwb3J0IGN0eF9kZXY9JHtjdHhfZGV2Oj0iaHR0cHM6Ly9zaHlsaW51eC5jb20ifQoKX2Rvd25fYmlnX2ZpbGUoKSB7ICMg5LiL6L295paH5Lu2IGRpciB1cmwKCVsgLWYgIiQxIiBdICYmIHJldHVybiB8fCBlY2hvICJkb3dubG9hZCAkY3R4X2Rldi8kMiIKCWVjaG8gJDF8IGdyZXAgIi8iICY+L2Rldi9udWxsICYmIG1rZGlyIC1wICR7MSUqLyp9OyBpZiBjdXJsIC1oICY+L2Rldi9udWxsOyB0aGVuCgkJY3VybCAtbyAkMSAtZkwgIiRjdHhfZGV2LyQyP3BvZD0kY3R4X3BvZCIKCWVsc2UKCQl3Z2V0IC1PICQxICIkY3R4X2Rldi8kMj9wb2Q9JGN0eF9wb2QiCglmaQp9Cl9kb3duX2ZpbGVzKCkgeyAjIOS4i+i9veaWh+S7tiBmaWxlLi4uCiAgICBmb3IgZmlsZSBpbiAiJEAiOyBkbyBfZG93bl9maWxlICRmaWxlIHB1Ymxpc2gvJHtmaWxlIyMqL307IGRvbmUKfQpfZG93bl9maWxlKCkgeyAjIOS4i+i9veaWh+S7tiBkaXIgdXJsCgllY2hvICQxfCBncmVwICIvIiAmPi9kZXYvbnVsbCAmJiBta2RpciAtcCAkezElKi8qfTsgaWYgY3VybCAtaCAmPi9kZXYvbnVsbDsgdGhlbgoJCWN1cmwgLW8gJDEgLWZzU0wgJGN0eF9kZXYvJDIKCWVsc2UKCQl3Z2V0IC1PICQxICRjdHhfZGV2LyQyCglmaQp9Cl90ZW1wX2ZpbGUoKSB7ICMg5Yqg6L295paH5Lu2IHVybCBhcmcuLi4KICAgIGN0eF90ZW1wPSQobWt0ZW1wKSAmJiBfZG93bl9maWxlICRjdHhfdGVtcCAkMSAmJiBzaGlmdCAmJiBzb3VyY2UgJGN0eF90ZW1wICIkQCIKfQpfZG93bl90YXJzKCkgeyAjIOS4i+i9veaWh+S7tiBmaWxlLi4uCiAgICBmb3IgZmlsZSBpbiAiJEAiOyBkbyBfZG93bl90YXIgJGZpbGUgcHVibGlzaC8kZmlsZTsgZG9uZQp9Cl9kb3duX3RhcigpIHsgIyDkuIvovb3mlofku7YgZmlsZSBwYXRoCiAgICBbIC1mICQxIF0gJiYgcmV0dXJuOyBfZG93bl9iaWdfZmlsZSAiJEAiICYmIHRhciAteGYgJDEKfQoKcHJlcGFyZV9zY3JpcHQoKSB7CiAgICBmb3Igc2NyaXB0IGluICIkQCI7IGRvIF90ZW1wX2ZpbGUgaW50c2hlbGwvJHNjcmlwdDsgZG9uZSAKfQpwcmVwYXJlX3BhY2thZ2UoKSB7CiAgICBfZG93bl90YXJzIGNvbnRleHRzLmJpbi50YXIuZ3ogY29udGV4dHMuc3JjLnRhci5negogICAgbG9jYWwgYmFjaz0kUFdEOyBjZCB+LzsgX2Rvd25fdGFycyBjb250ZXh0cy5ob21lLnRhci5nejsgY2QgJGJhY2sKICAgIGV4cG9ydCBWSU09JFBXRC91c3IvaW5zdGFsbC92aW0tdmltLTEyYmU3MzQvX2luc3RhbGwvc2hhcmUvdmltL3ZpbTgyLwogICAgZXhwb3J0IExEX0xJQlJBUllfUEFUSD0kUFdEL3Vzci9sb2NhbC9saWIKCiAgIAlpc2hfc3lzX3BhdGhfbG9hZAoJZ2l0IGNvbmZpZyAtLWdsb2JhbCBpbml0LnRlbXBsYXRlZGlyICRQV0QvdXNyL2luc3RhbGwvZ2l0LTIuMzEuMS9faW5zdGFsbC9zaGFyZS9naXQtY29yZS90ZW1wbGF0ZXMvCglnaXQgY29uZmlnIC0tZ2xvYmFsIHVybC4iJGN0eF9kZXYiLmluc3RlYWRPZiBodHRwczovL3NoeWxpbnV4LmNvbQoJZ2l0IGNvbmZpZyAtLWdsb2JhbCBpbml0LmRlZmF1bHRCcmFuY2ggbWFzdGVyCn0KcHJlcGFyZV9zeXN0ZW0oKSB7CiAgICBjYXNlICIkKHVuYW1lKSIgaW4KICAgICAgICBEYXJ3aW4pIHhjb2RlLXNlbGVjdCAtLWluc3RhbGwgMj4vZGV2L251bGwgOzsKICAgICAgICBMaW51eCkgCiAgICAgICAgICAgIGlmIFsgYHdob2FtaWAgPT0gcm9vdCBdOyB0aGVuCiAgICAgICAgICAgICAgICB5dW0gaW5zdGFsbCAteSBtYWtlIGdpdCB2aW0gdG11eAogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBzdWRvIHl1bSBpbnN0YWxsIC15IG1ha2UgZ2l0IHZpbSB0bXV4CiAgICAgICAgICAgIGZpCiAgICAgICAgICAgIDs7CiAgICBlc2FjCn0KcHJlcGFyZV90bXV4KCkgewogICAgX2Rvd25fZmlsZSBldGMvdG11eC5jb25mIGludHNoZWxsL2Rldi90bXV4L3RtdXguY29uZgogICAgX2Rvd25fZmlsZSBiaW4vdG11eC5zaCBpbnRzaGVsbC9kZXYvdG11eC9sb2NhbC5zaAp9CnByZXBhcmVfaWNlKCkgewogICAgbG9jYWwgYmluPSJpY2UiCiAgICBjYXNlIGB1bmFtZSAtc2AgaW4KICAgICAgICBEYXJ3aW4pIGJpbj0ke2Jpbn0uZGFyd2luIDs7CiAgICAgICAgTGludXgpIGJpbj0ke2Jpbn0ubGludXggOzsKICAgICAgICAqKSBiaW49JHtiaW59LndpbmRvd3MgOzsKICAgIGVzYWMKICAgIGNhc2UgYHVuYW1lIC1tYCBpbgogICAgICAgIHg4Nl82NCkgYmluPSR7YmlufS5hbWQ2NCA7OwogICAgICAgIGFybTY0KSBiaW49JHtiaW59LmFtZDY0IDs7CiAgICAgICAgYXJtKikgYmluPSR7YmlufS5hcm0gOzsKICAgICAgICAqKSBiaW49JHtiaW59LjM4NiA7OwogICAgZXNhYwogICAgX2Rvd25fYmlnX2ZpbGUgYmluL2ljZS5iaW4gcHVibGlzaC8kYmluICYmIGNobW9kIHUreCBiaW4vaWNlLmJpbjsgWyAtZiBiaW4vaWNlLmJpbiBdCn0KCm1haW4oKSB7CiAgICBjYXNlICIkMSIgaW4KICAgICAgICBwcm9qZWN0KSAjIOWIm+W7uumhueebrgogICAgICAgICAgICBwcmVwYXJlX3NjcmlwdCBwbHVnLnNoIGNvbmYuc2ggbWlzcy5zaDsgcHJlcGFyZV9zeXN0ZW0KICAgICAgICAgICAgaXNoX21pc3NfcHJlcGFyZV9jb21waWxlCiAgICAgICAgICAgIGlzaF9taXNzX3ByZXBhcmVfZGV2ZWxvcAogICAgICAgICAgICBpc2hfbWlzc19wcmVwYXJlX2luc3RhbGwKCiAgICAgICAgICAgIGlzaF9taXNzX3ByZXBhcmVfY29udGV4dHMKCiAgICAgICAgICAgIGV4cG9ydCBQQVRIPSR7UFdEfS9iaW46JFBBVEggY3R4X2xvZz0ke2N0eF9sb2c6PS9kZXYvc3Rkb3V0fQogICAgICAgICAgICBnbyBnZXQgc2h5bGludXguY29tL3gvaWNlCiAgICAgICAgICAgIHNoaWZ0ICYmIG1ha2UgJiYgaXNoX21pc3Nfc2VydmUgIiRAIgogICAgICAgICAgICA7OwogICAgICAgIHNvdXJjZSkgIyDmupDnoIHlronoo4UKICAgICAgICAgICAgcHJlcGFyZV9zeXN0ZW0KICAgICAgICAgICAgZ2l0IGNsb25lIGh0dHBzOi8vc2h5bGludXguY29tL3gvY29udGV4dHMKICAgICAgICAgICAgc2hpZnQgJiYgY2QgY29udGV4dHMgJiYgc291cmNlIGV0Yy9taXNzLnNoICIkQCIKICAgICAgICAgICAgOzsKICAgICAgICBiaW5hcnkpICMg5bqU55So5a6J6KOFCiAgICAgICAgICAgIGV4cG9ydCBjdHhfbG9nPSR7Y3R4X2xvZzo9L2Rldi9zdGRvdXR9IGN0eF9kZXY9Imh0dHBzOi8vY29udGV4dHMuY29tLmNuIgogICAgICAgICAgICAjIGV4cG9ydCBjdHhfbG9nPSR7Y3R4X2xvZzo9L2Rldi9zdGRvdXR9IGN0eF9kZXY9Imh0dHBzOi8vc2h5bGludXguY29tIgogICAgICAgICAgICBzaGlmdCAmJiBwcmVwYXJlX2ljZSAmJiBiaW4vaWNlLmJpbiBmb3JldmVyIHNlcnZlIGRldiAiIiAiJEAiCiAgICAgICAgICAgIDs7CiAgICAgICAgYXBwKSAjIOeUn+S6p+eOr+WigwogICAgICAgICAgICBleHBvcnQgY3R4X2xvZz0ke2N0eF9sb2c6PS9kZXYvc3Rkb3V0fQogICAgICAgICAgICBzaGlmdCAmJiBwcmVwYXJlX2ljZSAmJiBiaW4vaWNlLmJpbiBmb3JldmVyIHNlcnZlIGRldiBkZXYgIiRAIgogICAgICAgICAgICA7OwogICAgICAgIGRldikgIyDlvIDlj5Hnjq/looMKICAgICAgICAgICAgcHJlcGFyZV9zY3JpcHQgcGx1Zy5zaCBjb25mLnNoIG1pc3Muc2gKCQkJCQkJc2hpZnQgJiYgcHJlcGFyZV9wYWNrYWdlICYmIHNvdXJjZSBldGMvbWlzcy5zaCAiJEAiCiAgICAgICAgICAgIDs7CiAgICAgICAgKikgIyDnu4jnq6/njq/looMKICAgICAgICAgICAgcHJlcGFyZV9zY3JpcHQgcGx1Zy5zaCBjb25mLnNoIG1pc3Muc2gKICAgICAgICAgICAgaXNoX3N5c19kZXZfbG9naW4gJiYgWyAtbiAiJCoiIF0gJiYgaXNoX3N5c19kZXZfcnVuICIkQCIKICAgICAgICAgICAgOzsKICAgIGVzYWMKfQoKbWFpbiAiJEAiCg==",
        "usr/intshell/miss.sh": "IyEvYmluL3NoCgpleHBvcnQgY3R4X3BpZD0ke2N0eF9waWQ6PXZhci9ydW4vaWNlLnBpZH0KZXhwb3J0IGN0eF9sb2c9JHtjdHhfbG9nOj1iaW4vYm9vdC5sb2d9CgpyZXF1aXJlIHN5cy9jbGkvZmlsZS5zaAoKaXNoX21pc3NfaWNlX2Jpbj0iaWNlLmJpbiIKaXNoX21pc3NfaWNlX3NoPSJiaW4vaWNlLnNoIgppc2hfbWlzc19pbml0X3NoeT0iZXRjL2luaXQuc2h5Igppc2hfbWlzc19tYWluX3NoeT0ic3JjL21haW4uc2h5Igppc2hfbWlzc19tYWluX2dvPSJzcmMvbWFpbi5nbyIKCmlzaF9taXNzX2Rvd25sb2FkX3BrZygpIHsKCWZvciB1cmwgaW4gIiRAIjsgZG8gbG9jYWwgcGtnPSR7dXJsIyMqL30KCQlbIGBpc2hfc3lzX2ZpbGVfc2l6ZSAkcGtnYCAtZ3QgMCBdICYmIGJyZWFrCgkJaXNoX2xvZ19yZXF1aXJlICR1cmwKCQljdXJsIC1mU09MICR1cmwgJiYgdGFyIHhmICRwa2cgCglkb25lCn0KaXNoX21pc3NfcHJlcGFyZV9jb21waWxlKCkgewoJaXNoX3N5c19wYXRoX2luc2VydCAiJFBXRC91c3IvbG9jYWwvZ28vYmluIiAiJFBXRC91c3IvbG9jYWwvYmluIiAiJFBXRC9iaW4iICIkUFdEL3Vzci9wdWJsaXNoIgoJZXhwb3J0IEdPUFJWSUFURT0ke0dPUFJWSUFURTo9c2h5bGludXguY29tLGdpdGh1Yi5jb219CglleHBvcnQgR09CSU49JHtHT0JJTjo9JFBXRC91c3IvbG9jYWwvYmlufQoJZXhwb3J0IElTSF9DT05GX1BBVEg9JFBXRC8uaXNoL3BsdWdlZAoKCWdvIHZlcnNpb24gJj4vZGV2L251bGwgJiYgcmV0dXJuCgoJbG9jYWwgZ29hcmNoPWFtZDY0OyBjYXNlICIkKHVuYW1lIC1tKSIgaW4KCXg4Nl82NCkgZ29hcmNoPWFtZDY0OzsKCWFybTY0KSBnb2FyY2g9YXJtNjQ7OwoJaTY4NikgZ29hcmNoPTM4Njs7CgkqKSBnb29zPWFybTs7CmVzYWMKbG9jYWwgZ29vcz1saW51eDsgY2FzZSAiJCh1bmFtZSAtcykiIGluCkRhcndpbikgZ29vcz1kYXJ3aW47OwpMaW51eCkgZ29vcz1saW51eDs7CiopIGdvb3M9d2luZG93czs7CmVzYWMKCmxvY2FsIHBrZz1nbyR7R09WRVJTSU9OOj0xLjE1LjV9LiR7Z29vc30tJHtnb2FyY2h9LnRhci5nejsgaXNoX2xvZ19kZWJ1ZyAiZG93bmxvYWQ6ICRwa2ciCmxvY2FsIGJhY2s9JFBXRDsgbWtkaXIgLXAgdXNyL2xvY2FsOyBjZCB1c3IvbG9jYWw7IGlzaF9taXNzX2Rvd25sb2FkX3BrZyBodHRwczovL2RsLmdvb2dsZS5jb20vZ28vJHBrZzsgY2QgJGJhY2sKfQppc2hfbWlzc19wcmVwYXJlX2RldmVsb3AoKSB7CglkZWNsYXJlfGdyZXAgIl5pc2hfZGV2X2dpdF9wcmVwYXJlICgpIiAmPi9kZXYvbnVsbCB8fCByZXF1aXJlIGRldi9naXQvZ2l0LnNoCglpc2hfZGV2X2dpdF9wcmVwYXJlCgoJCSMgLmdpdGlnbm9yZQoJCWlzaF9zeXNfZmlsZV9jcmVhdGUgLmdpdGlnbm9yZSA8PEVORApldGMvCmJpbi8KdmFyLwp1c3IvCi4qCgpFTkQKCgkJIyBzcmMvbWFpbi5nbwoJCWlzaF9zeXNfZmlsZV9jcmVhdGUgJGlzaF9taXNzX21haW5fZ28gPDxFTkQKcGFja2FnZSBtYWluCgppbXBvcnQgInNoeWxpbnV4LmNvbS94L2ljZSIKCmZ1bmMgbWFpbigpIHsgcHJpbnQoaWNlLlJ1bigpKSB9CkVORApbIC1mIGdvLm1vZCBdIHx8IGdvIG1vZCBpbml0ICR7UFdEIyMqL30KCgkJIyBNYWtlZmlsZQoJCWlzaF9zeXNfZmlsZV9jcmVhdGUgTWFrZWZpbGUgPDwgRU5ECmV4cG9ydCBDR09fRU5BQkxFRD0wCgphbGw6CglAZWNobyAmJiBkYXRlCglnbyBidWlsZCAtdiAtbyBiaW4vJGlzaF9taXNzX2ljZV9iaW4gJGlzaF9taXNzX21haW5fZ28gLi8kaXNoX21pc3NfaWNlX2JpbiBmb3JldmVyIHJlc3RhcnQKRU5ECn0KaXNoX21pc3NfcHJlcGFyZV9pbnN0YWxsKCkgewoJIyBldGMvcGF0aAoJaXNoX3N5c19maWxlX2NyZWF0ZSBldGMvcGF0aCA8PEVORAp1c3IvbG9jYWwvZ28vYmluCnVzci9sb2NhbC9iaW4KdXNyL3B1Ymxpc2gKYmluCkVORAoKCQkjIGV0Yy9pbml0LnNoeQoJCWlzaF9zeXNfZmlsZV9jcmVhdGUgJGlzaF9taXNzX2luaXRfc2h5IDw8RU5ECn5hYWEKCn53ZWIKCn5jbGkKCn5jdHgKCn5tZGIKCkVORAoKCQkjIHNyYy9tYWluLnNoeQoJCWlzaF9zeXNfZmlsZV9jcmVhdGUgJGlzaF9taXNzX21haW5fc2h5IDw8RU5ECnRpdGxlICIke1BXRCMjKi99IgpFTkQKfQoKaXNoX21pc3NfcHJlcGFyZSgpIHsKCWxvY2FsIG5hbWU9JHsxIyMqL30gcmVwb3M9JHsxI2h0dHBzOi8vfQoJWyAiJG5hbWUiID0gIiRyZXBvcyIgXSAmJiByZXBvcz1zaHlsaW51eC5jb20veC8kbmFtZQoKCWxvY2FsIGJhY2s9JFBXRAoJSVNIX0NPTkZfUEFUSD0kUFdELy5pc2gvcGx1Z2VkIHJlcXVpcmUgJHJlcG9zCglpc2hfc3lzX2xpbmtfY3JlYXRlIHVzci8kbmFtZSAkKHJlcXVpcmVfcGF0aCAkcmVwb3MpCglyZXF1aXJlX3B1bGwgdXNyLyRuYW1lCgljZCAkYmFjawp9CmlzaF9taXNzX3ByZXBhcmVfY29udGV4dHMoKSB7Cglpc2hfbG9nX3JlcXVpcmUgLWcgc2h5bGludXguY29tL3gvY29udGV4dHMKCVsgLWQgLmdpdCBdIHx8IGdpdCBpbml0CglbICJgZ2l0IHJlbW90ZWAiID0gIiIgXSB8fCByZXF1aXJlX3B1bGwgLi8KCWlzaF9zeXNfZmlsZV9jcmVhdGUgZXRjL2NvbmYvYmFzaF9sb2NhbC5zaCA8PEVORAojIS9iaW4vYmFzaAoKRU5ECmlzaF9zeXNfZmlsZV9jcmVhdGUgZXRjL2NvbmYvdmltX2xvY2FsLnZpbSA8PEVORAoKRU5ECn0KaXNoX21pc3NfcHJlcGFyZV9pbnRzaGVsbCgpIHsKCWlzaF9sb2dfcmVxdWlyZSAtZyBzaHlsaW51eC5jb20veC9pbnRzaGVsbAoJWyAtZiAkUFdELy5pc2gvcGx1Zy5zaCBdIHx8IFsgLWYgJEhPTUUvLmlzaC9wbHVnLnNoIF0gfHwgZ2l0IGNsb25lIGh0dHBzOi8vc2h5bGludXguY29tL3gvaW50c2hlbGwgJFBXRC8uaXNoCglbIC1kICRQV0QvLmlzaCBdICYmIGlzaF9zeXNfbGlua19jcmVhdGUgdXNyL2ludHNoZWxsICRQV0QvLmlzaAoJWyAtZCAkSE9NRS8uaXNoIF0gJiYgaXNoX3N5c19saW5rX2NyZWF0ZSB1c3IvaW50c2hlbGwgJEhPTUUvLmlzaAoJcmVxdWlyZV9wdWxsIHVzci9pbnRzaGVsbAoKCWRlY2xhcmV8Z3JlcCAiXmlzaF9zeXNfY2xpX3ByZXBhcmUgKCkiICY+L2Rldi9udWxsIHx8IHJlcXVpcmUgc3lzL2NsaS9jbGkuc2gKCWlzaF9zeXNfY2xpX3ByZXBhcmUKfQppc2hfbWlzc19wcmVwYXJlX2ljZWJlcmdzKCkgewoJaXNoX21pc3NfcHJlcGFyZSBpY2ViZXJncwp9CmlzaF9taXNzX3ByZXBhcmVfdG9vbGtpdHMoKSB7Cglpc2hfbWlzc19wcmVwYXJlIHRvb2xraXRzCn0KaXNoX21pc3NfcHJlcGFyZV92b2xjYW5vcygpIHsKCWlzaF9taXNzX3ByZXBhcmUgdm9sY2Fub3MKfQppc2hfbWlzc19wcmVwYXJlX2xlYXJuaW5nKCkgewoJaXNoX21pc3NfcHJlcGFyZSBsZWFybmluZwp9CmlzaF9taXNzX3ByZXBhcmVfc2Vzc2lvbigpIHsKCWxvY2FsIG5hbWU9JDEgJiYgWyAiJG5hbWUiID0gIiIgXSAmJiBuYW1lPSR7UFdEIyMqL30KCWxvY2FsIHdpbj0kMiAmJiBbICIkd2luIiA9ICIiIF0gJiYgd2luPSR7bmFtZSMjKi19Cglpc2hfbG9nX2RlYnVnICJzZXNzaW9uOiAkbmFtZTokd2luIgoKCWlmICEgdG11eCBoYXMtc2Vzc2lvbiAtdCAkbmFtZSAmPi9kZXYvbnVsbDsgdGhlbgoJCVRNVVg9IiIgdG11eCBuZXctc2Vzc2lvbiAtZCAtcyAkbmFtZSAtbiAkd2luCgkJdG11eCBzcGxpdC13aW5kb3cgLWQgLXAgMzAgLXQgJG5hbWUKCQl0bXV4IHNwbGl0LXdpbmRvdyAtZCAtaCAtdCAke25hbWV9OiR3aW4uMgoKCQlsb2NhbCBsZWZ0PTIgcmlnaHQ9MwoJCXRtdXggc2VuZC1rZXkgLXQgJHtuYW1lfTokd2luLiRyaWdodCAiaXNoX21pc3NfbG9nIiBFbnRlcgoJCWlmIFsgIiRuYW1lIiA9ICJtaXNzIiBdOyB0aGVuCgkJCXRtdXggc2VuZC1rZXkgLXQgJHtuYW1lfTokd2luLiRsZWZ0ICJpc2hfbWlzc19zZXJ2ZSIKCQllbHNlCgkJCXRtdXggc2VuZC1rZXkgLXQgJHtuYW1lfTokd2luLiRsZWZ0ICJpc2hfbWlzc19zcGFjZSBkZXYgZGV2IgoJCWZpCgkJc2xlZXAgMSAmJiB0bXV4IHNlbmQta2V5IC10ICR7bmFtZX06JHdpbi4xICJ2aW0gLU8gc3JjL21haW4uZ28gc3JjL21haW4uc2h5IiBFbnRlcgoKCQljYXNlIGB1bmFtZSAtc2AgaW4KCQkJRGFyd2luKSBzbGVlcCA1ICYmIG9wZW4gaHR0cDovL2xvY2FsaG9zdDo5MDIwIDs7CgkJZXNhYwoJZmkKCglbICIkVE1VWCIgPSAiIiBdICYmIHRtdXggYXR0YWNoIC10ICRuYW1lIHx8IHRtdXggc2VsZWN0LXdpbmRvdyAtdCAkbmFtZTokd2luCn0KCmlzaF9taXNzX3N0YXJ0KCkgewoJd2hpbGUgdHJ1ZTsgZG8KCQlkYXRlICYmICRpc2hfbWlzc19pY2VfYmluICIkQCIgMj4kY3R4X2xvZyAmJiBicmVhayB8fCBlY2hvIC1lICJcblxucmVzdGFydGluZy4uLiIKCQlzbGVlcCAxCglkb25lCn0KaXNoX21pc3NfcmVzdGFydCgpIHsKCVsgLWUgIiRjdHhfcGlkIiBdICYmIGtpbGwgLTIgYGNhdCAkY3R4X3BpZGAgJj4vZGV2L251bGwgfHwgZWNobwp9CmlzaF9taXNzX3N0b3AoKSB7CglbIC1lICIkY3R4X3BpZCIgXSAmJiBraWxsIC0zIGBjYXQgJGN0eF9waWRgICY+L2Rldi9udWxsIHx8IGVjaG8KfQppc2hfbWlzc19zZXJ2ZV9sb2coKSB7Cglpc2hfbWlzc19zdG9wICYmIGN0eF9sb2c9L2Rldi9zdGRvdXQgaXNoX21pc3Nfc3RhcnQgc2VydmUgc3RhcnQgJEAKfQppc2hfbWlzc19zZXJ2ZSgpIHsKCWlzaF9taXNzX3N0b3AgJiYgaXNoX21pc3Nfc3RhcnQgc2VydmUgc3RhcnQgJEAKfQppc2hfbWlzc19zcGFjZSgpIHsKCWlzaF9taXNzX3N0b3AgJiYgaXNoX21pc3Nfc3RhcnQgc3BhY2UgZGlhbCBkZXYgb3BzICRACn0KaXNoX21pc3NfbG9nKCkgewoJdG91Y2ggJGN0eF9sb2cgJiYgdGFpbCAtZiAkY3R4X2xvZwp9Cgppc2hfbWlzc19wdWJsaXNoKCkgewoJZm9yIGZpbGUgaW4gIiRAIjsgZG8KCQljcCAkZmlsZSB1c3IvcHVibGlzaC8KCWRvbmUKfQppc2hfbWlzc19tYWtlKCkgewoJbG9jYWwgYmluYXJ5cz1iaW4vaWNlLmJpbgoJZWNobyAmJiBkYXRlCglbIC1mIHNyYy92ZXJzaW9uLmdvIF0gfHwgZWNobyAicGFja2FnZSBtYWluIiA+IHNyYy92ZXJzaW9uLmdvCglnbyBidWlsZCAtdiAtbyAke2JpbmFyeXN9IHNyYy9tYWluLmdvIHNyYy92ZXJzaW9uLmdvICYmIC4vJHtiaW5hcnlzfSBmb3JldmVyIHJlc3RhcnQgJj4vZGV2L251bGwKfQoKaXNoX21pc3NfZ29fc3VtKCkgewoJZ28gbW9kIGRvd25sb2FkIHNoeWxpbnV4LmNvbS94L2ljZQoJZ28gbW9kIGRvd25sb2FkIHNoeWxpbnV4LmNvbS94L2ljZWJlcmdzCglnbyBtb2QgZG93bmxvYWQgc2h5bGludXguY29tL3gvdG9vbGtpdHMKCglnbyBtb2QgZG93bmxvYWQgc2h5bGludXguY29tL3gvd2Vic29ja2V0CglnbyBtb2QgZG93bmxvYWQgc2h5bGludXguY29tL3gvZ28tcXJjb2RlCglnbyBtb2QgZG93bmxvYWQgc2h5bGludXguY29tL3gvZ28tc3FsLW15c3FsCgoJZ28gbW9kIGRvd25sb2FkIHNoeWxpbnV4LmNvbS94L2xpbnV4LXN0b3J5CglnbyBtb2QgZG93bmxvYWQgc2h5bGludXguY29tL3gvbmdpbngtc3RvcnkKCWdvIG1vZCBkb3dubG9hZCBzaHlsaW51eC5jb20veC9nb2xhbmctc3RvcnkKCWdvIG1vZCBkb3dubG9hZCBzaHlsaW51eC5jb20veC9yZWRpcy1zdG9yeQoJZ28gbW9kIGRvd25sb2FkIHNoeWxpbnV4LmNvbS94L215c3FsLXN0b3J5Cgp9Cg==",
        "usr/intshell/plug.sh": "IyEvYmluL3NoCgojIyAxLumFjee9riAjIHsKSVNIX0NPTkZfUFJFPWlzaApJU0hfQ09ORl9MT0c9JHtJU0hfQ09ORl9MT0c6PSIvZGV2L3N0ZGVyciJ9CklTSF9DT05GX0xFVkVMPSR7SVNIX0NPTkZfTEVWRUw6PSJkZWJ1ZyJ9CklTSF9DT05GX0NPTE9SPSR7SVNIX0NPTkZfQ09MT1I6PSJ0cnVlIn0KCklTSF9DT05GX1BBVEg9JHtJU0hfQ09ORl9QQVRIOj0iJFBXRC8uaXNoL3BsdWdlZCJ9CklTSF9DT05GX1JPT1Q9JHtJU0hfQ09ORl9ST09UOj0iJEhPTUUvLmlzaC9wbHVnZWQifQojIH0KIyMgMi7ml6Xlv5cgIyB7CklTSF9TSE9XX0NPTE9SX3I9IlxlWzMxbSIKSVNIX1NIT1dfQ09MT1JfZz0iXGVbMzJtIgpJU0hfU0hPV19DT0xPUl9iPSJcZVszNG0iCklTSF9TSE9XX0NPTE9SX2VuZD0iXGVbMG0iCmlzaF9zaG93KCkgewogICAgbG9jYWwgc3BhY2U9IiAiIGNvdW50PTA7IHdoaWxlIFsgIiQjIiAtZ3QgIjAiIF07IGRvIHNwYWNlPSIgIjsgY2FzZSAkMSBpbgogICAgICAgIC11c2VybmFtZSkgZWNobyAtbiAiJCh3aG9hbWkpIjs7CiAgICAgICAgLWhvc3RuYW1lKSBlY2hvIC1uICIkKGhvc3RuYW1lKSI7OwogICAgICAgIC1kYXRlKSBlY2hvIC1uICIkKGRhdGUgKyIlWS0lbS0lZCIpIjs7CiAgICAgICAgLXRpbWUpIGVjaG8gLW4gIiQoZGF0ZSArIiVZLSVtLSVkICVIOiVNOiVTIikiOzsKICAgICAgICAqKSBpZiBsb2NhbCBrPSQxICYmIFsgIiR7azowOjF9IiA9ICItIiBdIDsgdGhlbiBzcGFjZT0iIgogICAgICAgICAgICBsb2NhbCBjb2xvcj0kKGV2YWwgInByaW50ZiBcJHtJU0hfU0hPV19DT0xPUl8ke2s6MX19IiAyPi9kZXYvbnVsbCkKICAgICAgICAgICAgWyAiJElTSF9DT05GX0NPTE9SIiA9ICJ0cnVlIiBdICYmIHByaW50ZiAiJGNvbG9yIiAmJiAoKGNvdW50KyspKQogICAgICAgIGVsc2UKICAgICAgICAgICAgcHJpbnRmICIkMSI7IFsgJGNvdW50IC1ndCAwIF0gJiYgcHJpbnRmICIkSVNIX1NIT1dfQ09MT1JfZW5kIiAmJiAoKGNvdW50LS0pKQogICAgICAgIGZpOzsKICAgIGVzYWM7IFsgIiQjIiAtZ3QgIjAiIF0gJiYgc2hpZnQgJiYgZWNobyAtbiAiJHNwYWNlIjsgZG9uZTsgZWNobwp9CmlzaF9sb2coKSB7CiAgICBmb3IgbCBpbiAkKGVjaG8gJHtJU0hfQ09ORl9MRVZFTDo9JDF9KTsgZG8KICAgICAgICBbICIkbCIgPSAiJDEiIF0gJiYgaXNoX3Nob3cgLXRpbWUgIiRAIiA+JElTSF9DT05GX0xPRyAKICAgIGRvbmU7IHJldHVybiAwCn0KaXNoX2xvZ19kZWJ1ZygpIHsgaXNoX2xvZyAiZGVidWciICIkQCIgYF9maWxlbGluZSAyIDJgOyB9CmlzaF9sb2dfcmVxdWlyZSgpIHsgaXNoX2xvZyAicmVxdWlyZSIgIiRAIjsgfQppc2hfbG9nX3JlcXVlc3QoKSB7IGlzaF9sb2cgInJlcXVlc3QiICIkQCI7IH0KaXNoX2xvZ19zb3VyY2UoKSB7IGlzaF9sb2cgInNvdXJjZSIgIiRAIjsgfQppc2hfbG9nX2FsaWFzKCkgeyBpc2hfbG9nICJhbGlhcyIgIiRAIjsgfQojIH0KIyMgMy7liqDovb0gIyB7CnJlcXVpcmVfcGF0aCgpIHsgIyDnm67lvZUgcmVwb3MKICAgIGZvciBuYW1lIGluICIkQCI7IGRvCiAgICAgICAgWyAtZSAkbmFtZSBdICYmIGVjaG8gJG5hbWUgJiYgY29udGludWUKICAgICAgICBmb3IgcCBpbiAkUFdELy5pc2gvcGx1Z2VkICRJU0hfQ09ORl9QQVRIICRJU0hfQ09ORl9ST09UOyBkbwogICAgICAgICAgICBbIC1lICRwLyRuYW1lIF0gJiYgZWNobyAkcC8kbmFtZSAmJiBicmVhawogICAgICAgICAgICBbIC1lICR7cCUvKn0vJG5hbWUgXSAmJiBlY2hvICR7cCUvKn0vJG5hbWUgJiYgYnJlYWsKICAgICAgICBkb25lCiAgICBkb25lCn0KcmVxdWlyZV9mb3JrKCkgeyAgIyDku5PlupMgcmVwb3MgW3RhZ10KICAgIGxvY2FsIG5hbWU9JDEgbW9kPSQxIHRhZz0kMiAmJiBzaGlmdCAyOyBbICIkdGFnIiA9ICIiIF0gfHwgbmFtZT0kbW9kQCR0YWcKICAgIGxvY2FsIHA9JChyZXF1aXJlX3BhdGggJG5hbWUpOyBbICIkcCIgIT0gIiIgXSAmJiBlY2hvICRwICYmIHJldHVybgoKICAgIGlzaF9sb2dfZGVidWcgLWcgImNsb25lICRtb2QgPT4gJElTSF9DT05GX1BBVEgvJG5hbWUiCiAgICBnaXQgY2xvbmUgaHR0cHM6Ly8kbW9kICRJU0hfQ09ORl9QQVRILyRuYW1lICY+L2Rldi9udWxsCiAgICBlY2hvICRJU0hfQ09ORl9QQVRILyRuYW1lOyBbICIkdGFnIiA9ICIiIF0gJiYgcmV0dXJuCgogICAgY2QgIiRJU0hfQ09ORl9QQVRILyRuYW1lIjsgZ2l0IGNoZWNrb3V0ICR0YWcgJj4vZGV2L251bGwgJiYgcm0gLXJmIC5naXQ7IGNkIC0gJj4vZGV2L251bGwKfQpyZXF1aXJlX3B1bGwoKSB7ICMg5pu05pawIHJlcG9zCiAgICBsb2NhbCBiYWNrPSRQV0Q7IGNkICIkKHJlcXVpcmVfZm9yayAkMSkiICYmIGlzaF9sb2dfZGVidWcgcHdkICRQV0QgJiYgZ2l0IHB1bGw7IGNkICRiYWNrOyBlY2hvCn0KcmVxdWlyZV90ZW1wKCkgeyAjIOS4i+i9vSBmaWxlCiAgICBmb3IgbmFtZSBpbiAiJEAiOyBkbyBsb2NhbCB0ZW1wPSQobWt0ZW1wKSAKICAgICAgICBpc2hfbG9nX3JlcXVlc3QgIiR0ZW1wIDw9ICRjdHhfZGV2L2ludHNoZWxsLyRuYW1lIgogICAgICAgIGN1cmwgLS1jcmVhdGUtZGlycyAtZnNTTCAtbyAkdGVtcCAkY3R4X2Rldi9pbnRzaGVsbC8kbmFtZSAmJiBlY2hvICR0ZW1wCiAgICBkb25lCn0KcmVxdWlyZSgpIHsgIyByZXF1aXJlIFthcyBuYW1lXSBbbW9kXSBmaWxlIGFyZy4uLgogICAgbG9jYWwgbmFtZT0ke0lTSF9DVFhfTU9EVUxFI2lzaF99ICYmIFsgIiQxIiA9ICJhcyIgXSAmJiBuYW1lPSQyICYmIHNoaWZ0IDIKICAgIGxvY2FsIG1vZD0kMSB0YWc9ICYmIHNoaWZ0OyBtb2Q9JHttb2QjaHR0cHM6Ly99CiAgICB0YWc9JHttb2QjKkB9IG1vZD0ke21vZCVAKn07IFsgIiR0YWciID0gIiRtb2QiIF0gJiYgdGFnPSIiCiAgICBpc2hfbG9nX3JlcXVpcmUgJG5hbWUgLWcgJG1vZCBieSBgX2ZpbGVsaW5lIDIgMmAKCiAgICBsb2NhbCBmaWxlPSQocmVxdWlyZV9wYXRoICRtb2QpCiAgICBbIC1mICIkZmlsZSIgXSB8fCBpZiBlY2hvICRtb2R8IGdyZXAgIl5naXQiICY+L2Rldi9udWxsOyB0aGVuCiAgICAgICAgZmlsZT0kKHJlcXVpcmVfZm9yayAiJG1vZCIgIiR0YWciKS8kMSAmJiBzaGlmdAogICAgZWxpZiBlY2hvICRtb2R8IGdyZXAgInNoeWxpbnV4LmNvbS94LyIgJj4vZGV2L251bGw7IHRoZW4KICAgICAgICBmaWxlPSQocmVxdWlyZV9mb3JrICIkbW9kIiAiJHRhZyIpLyQxICYmIHNoaWZ0CiAgICBlbHNlCiAgICAgICAgZmlsZT0kKHJlcXVpcmVfdGVtcCAkbW9kKQogICAgZmk7IFsgLWYgIiRmaWxlIiBdIHx8IHJldHVybiAwCgogICAgbG9jYWwgYmFjaz0kUFdEICYmIFsgLWQgIiR7ZmlsZSUvKn0iIF0gJiYgY2QgJHtmaWxlJS8qfQogICAgSVNIX0NUWF9NT0RVTEU9JChfbmFtZSBpc2hfJHtuYW1lfSkgSVNIX0NUWF9TQ1JJUFQ9JDEgX2xvYWQgJGZpbGUgIiRAIgogICAgY2QgJGJhY2s7IHJldHVybiAwCn0KX2xvYWQoKSB7CiAgICBsb2NhbCBmaWxlPSQxICYmIHNoaWZ0CiAgICBpc2hfbG9nX3NvdXJjZSAiJGZpbGUgIiRAIiIKICAgIHNvdXJjZSAuLyR7ZmlsZSMjKi99ICIkQCIKfQpfbmFtZSgpIHsKICAgIGxvY2FsIG5hbWU9IiQqIiAmJiBlY2hvICR7bmFtZS8vW15hLXpBLVowLTlfXS9ffQp9Cl9maWxlbGluZSgpIHsKICAgIGxvY2FsIGluZGV4MT0kKCgkezF9LTEpKQogICAgZWNobyAiJHtCQVNIX1NPVVJDRVskMV19OiR7QkFTSF9MSU5FTk9bJGluZGV4MV19OiR7RlVOQ05BTUVbJGluZGV4MV19Igp9Cgo=",
        "usr/intshell/show.sh": "IyEvYmluL3NoCgpJU0hfU0hPV19DT0xPUl9hcmc9IlxlWzMzOzRtIgoKSVNIX1NIT1dfQ09MT1Jfcj0iXGVbMzFtIgpJU0hfU0hPV19DT0xPUl9nPSJcZVszMm0iCklTSF9TSE9XX0NPTE9SX3k9IlxlWzMzbSIKSVNIX1NIT1dfQ09MT1JfYj0iXGVbMzRtIgpJU0hfU0hPV19DT0xPUl9wPSJcZVszNW0iCklTSF9TSE9XX0NPTE9SX2M9IlxlWzM2bSIKCklTSF9TSE9XX0NPTE9SX3JlZD0iXGVbMzFtIgpJU0hfU0hPV19DT0xPUl9ncmVlbj0iXGVbMzJtIgpJU0hfU0hPV19DT0xPUl9ibHVlPSJcZVszNG0iCklTSF9TSE9XX0NPTE9SX3llbGxvdz0iXGVbMzNtIgpJU0hfU0hPV19DT0xPUl9wdXJwbGU9IlxlWzM1bSIKSVNIX1NIT1dfQ09MT1JfY3lhbj0iXGVbMzZtIgpJU0hfU0hPV19DT0xPUl9ibGFjaz0iXGVbMzdtIgpJU0hfU0hPV19DT0xPUl93aGl0ZT0iXGVbMzBtIgpJU0hfU0hPV19DT0xPUl9iZ19yZWQ9IlxlWzQxbSIKSVNIX1NIT1dfQ09MT1JfYmdfZ3JlZW49IlxlWzQybSIKSVNIX1NIT1dfQ09MT1JfYmdfYmx1ZT0iXGVbNDRtIgpJU0hfU0hPV19DT0xPUl9iZ195ZWxsb3c9IlxlWzQzbSIKSVNIX1NIT1dfQ09MT1JfYmdfcHVycGxlPSJcZVs0NW0iCklTSF9TSE9XX0NPTE9SX2JnX2N5YW49IlxlWzQ2bSIKSVNIX1NIT1dfQ09MT1JfYmdfYmxhY2s9IlxlWzQ3bSIKSVNIX1NIT1dfQ09MT1JfYmdfd2hpdGU9IlxlWzQwbSIKSVNIX1NIT1dfQ09MT1JfYm9sZD0iXGVbMW0iCklTSF9TSE9XX0NPTE9SX3VuZGVybGluZT0iXGVbNG0iCklTSF9TSE9XX0NPTE9SX3JldmVyc2U9IlxlWzdtIgpJU0hfU0hPV19DT0xPUl9ibGluaz0iXGVbNW0iCklTSF9TSE9XX0NPTE9SX2VuZD0iXGVbMG0iCgo=",
        "usr/intshell/sys/cli/cli.sh": "IyEvYmluL3NoCgppc2hfc3lzX2NsaV9hbGlhcygpIHsKICAgIFsgIiQjIiA9ICIwIiBdICYmIGFsaWFzICYmIHJldHVybgogICAgWyAiJCMiID0gIjEiIF0gJiYgYWxpYXMgJDEgJiYgcmV0dXJuCiAgICBpc2hfbG9nX2FsaWFzICItZyIgIiQxIiAiPT4iICIkMiIgYnkgYF9maWxlbGluZSAyYAogICAgYWxpYXMgJDE9IiQyIgp9CmlzaF9zeXNfY2xpX3NoZWxsKCkgewogICAgcHMgfGdyZXAgIl5cICokJCJ8Z3JlcCAtdiBncmVwfGdyZXAgLW8gIlthLXpdKiQiCn0KaXNoX3N5c19jbGlfcHJvbXB0KCkgewogICAgbG9jYWwgbmFtZT0kKGhvc3RuYW1lKSAmJiBuYW1lPSR7bmFtZSMjKi19ICYmIG5hbWU9JHtuYW1lJSVcLip9CiAgICBjYXNlICIkKGlzaF9zeXNfY2xpX3NoZWxsKSIgaW4KICAgICAgICBiYXNoKQogICAgICAgICAgICBleHBvcnQgUFMxPSJcXCFAJG5hbWVbXFx0XVxcV1xcJCAiCiAgICAgICAgICAgIDs7CiAgICAgICAgenNoKQogICAgICAgICAgICBleHBvcnQgUFMxPSJcXCFAJG5hbWVbXHRdXFdcJCAiCiAgICAgICAgICAgIDs7CiAgICBlc2FjCn0KaXNoX3N5c19jbGlfcHJlcGFyZSgpIHsKICAgIGxvY2FsIHJjPSIuYmFzaHJjIjsgY2FzZSAiJChpc2hfc3lzX2NsaV9zaGVsbCkiIGluCiAgICAgICAgYmFzaCkgcmM9Ii5iYXNocmMiOzsKICAgICAgICB6c2gpIHJjPSIuenNocmMiOzsKICAgIGVzYWMKCiAgICBbIC1kIH4vLmlzaCBdIHx8IFsgIiRQV0QiID0gIiRIT01FIiBdIHx8IGxuIC1zICRQV0QvLmlzaCAkSE9NRS8uaXNoCiAgICBncmVwICJzb3VyY2Ugfi8uYmFzaF9sb2NhbCIgfi8kcmMgJj4vZGV2L251bGwgfHwgY2F0ID4+IH4vJHJjIDw8RU5ECmlmIFsgLWYgfi8uaXNoL3BsdWcuc2ggXSAmJiBzb3VyY2Ugfi8uaXNoL3BsdWcuc2g7IHRoZW4KICAgIHJlcXVpcmUgY29uZi5zaAogICAgcmVxdWlyZSBtaXNzLnNoCmZpCgpbIC1mIH4vLmJhc2hfbG9jYWwgXSAmJiBzb3VyY2Ugfi8uYmFzaF9sb2NhbApFTkQKfQo=",
        "usr/intshell/sys/cli/date.sh": "IyEvYmluL3NoCgppc2hfc3lzX2RhdGUoKSB7IGRhdGUgKyIlWS0lbS0lZCAlSDolTTolUyI7IH0KaXNoX3N5c19kYXRlX2RhdGUoKSB7IGRhdGUgKyIlWS0lbS0lZCI7IH0KaXNoX3N5c19kYXRlX3RpbWUoKSB7IGRhdGUgKyIlSDolTTolUyI7IH0KCmlzaF9zeXNfZGF0ZV95ZWFyKCkgeyBkYXRlICsiJVkiOyB9CmlzaF9zeXNfZGF0ZV9tb250aCgpIHsgZGF0ZSArIiVtIjsgfQppc2hfc3lzX2RhdGVfZGF5KCkgeyBkYXRlICsiJWQiOyB9Cgppc2hfc3lzX2RhdGVfaG91cigpIHsgZGF0ZSArIiVIIjsgfQppc2hfc3lzX2RhdGVfbWludXRlKCkgeyBkYXRlICsiJU0iOyB9CmlzaF9zeXNfZGF0ZV9zZWNvbmQoKSB7IGRhdGUgKyIlUyI7IH0KCmlzaF9zeXNfZGF0ZV93ZWVrZGF5KCkgeyBkYXRlICsiJXciOyB9CmlzaF9zeXNfZGF0ZV90aW1lem9uZSgpIHsgZGF0ZSArIiV6IjsgfQoKaXNoX3N5c19kYXRlX2ZpbGVuYW1lKCkgeyBkYXRlICsiJVklbSVkXyVIJU0lUyI7IH0KCg==",
        "usr/intshell/sys/cli/file.sh": "IyEvYmluL3NoCgppc2hfc3lzX3BhdGhfY3JlYXRlKCkgewogICAgbG9jYWwgdGFyZ2V0PSQxICYmIFsgLWQgJHt0YXJnZXQlLyp9IF0gJiYgcmV0dXJuCiAgICBbICR7dGFyZ2V0JS8qfSAhPSAke3RhcmdldH0gXSAmJiBta2RpciAtcCAke3RhcmdldCUvKn0gfHwgcmV0dXJuIDAKfQppc2hfc3lzX3BhdGhfaW5zZXJ0KCkgewogICAgZm9yIHAgaW4gIiRAIjsgZG8KICAgICAgICBlY2hvICRQQVRIfCBncmVwICIkcCIgJj4vZGV2L251bGwgfHwgZXhwb3J0IFBBVEg9JHA6JFBBVEgKICAgIGRvbmUKfQppc2hfc3lzX3BhdGhfbG9hZCgpIHsKICAgIGxvY2FsIHBhdGg9JHtDVFhfUk9PVDo9JFBXRH0KICAgIGZvciBsaW5lIGluIGBjYXQgJHtwYXRofS9ldGMvcGF0aCAyPi9kZXYvbnVsbGA7IGRvCiAgICAgICAgaWYgZWNobyAkbGluZXwgZ3JlcCAtdiAiXi8iICY+L2Rldi9udWxsOyB0aGVuIGxpbmU9JHBhdGgvJGxpbmU7IGZpCiAgICAgICAgaXNoX3N5c19wYXRoX2luc2VydCAkbGluZQogICAgZG9uZQp9CmlzaF9zeXNfZmlsZV9zaXplKCkgewogICAgbG9jYWwgc2l6ZT1gbHMgLXMgJDEgMj4vZGV2L251bGx8IGdyZXAgLW8gIlswLTldKiJ8aGVhZCAtbjFgCiAgICBbICIkc2l6ZSIgPSAiIiBdICYmIHNpemU9MDsgZWNobyAkc2l6ZQp9CmlzaF9zeXNfZmlsZV9jcmVhdGUoKSB7CiAgICBbIC1lICQxIF0gJiYgcmV0dXJuIHx8IGlzaF9sb2dfZGVidWcgLWcgImNyZWF0ZSBmaWxlICR7UFdEfSAkMSIKICAgIGlzaF9zeXNfcGF0aF9jcmVhdGUgJDEgJiYgY2F0ID4gJDEKfQppc2hfc3lzX2xpbmtfY3JlYXRlKCkgewogICAgWyAteiAiJDIiIF0gJiYgcmV0dXJuCiAgICBbIC1lICIkMSIgXSAmJiByZXR1cm4gfHwgaXNoX2xvZ19kZWJ1ZyAtZyAiY3JlYXRlIGxpbmsgJDEgPT4gJDIiCiAgICBpc2hfc3lzX3BhdGhfY3JlYXRlICQxICYmIGxuIC1zICQyICQxCn0KCg==",
        "usr/intshell/sys/sys.sh": "IyEvYmluL3NoCgpyZXF1aXJlIHN5cy9jbGkvY2xpLnNoCnJlcXVpcmUgc3lzL2NsaS9kYXRlLnNoCnJlcXVpcmUgc3lzL2NsaS9maWxlLnNoCgpyZXF1aXJlIHN5cy93ZWIvd2ViLnNoCnJlcXVpcmUgc3lzL3dlYi9kZXYuc2gKCg==",
        "usr/intshell/sys/web/dev.sh": "IyEvYmluL3NoCgppc2hfc3lzX2Rldl9zaWQ9JHtpc2hfc3lzX2Rldl9zaWQ6PSIifQppc2hfc3lzX2Rldl9zaWQoKSB7IGVjaG8gJGlzaF9zeXNfZGV2X3NpZDsgfQppc2hfc3lzX2Rldl9yZXF1ZXN0KCkgewogICAgbG9jYWwgdXJsPSRjdHhfZGV2L2NvZGUvYmFzaC8kMSAmJiBzaGlmdAogICAgaXNoX3N5c193ZWJfcmVxdWVzdCAiJHVybCIgIiRAIiBwd2QgIiR7UFdEfSIgc2lkICIkaXNoX3N5c19kZXZfc2lkIiBwb2QgJGN0eF9wb2QKfQppc2hfc3lzX2Rldl9zb3VyY2UoKSB7CiAgICBsb2NhbCBjdHhfdGVtcD0kKG1rdGVtcCk7IGlzaF9zeXNfZGV2X3JlcXVlc3QgIiRAIiA+JGN0eF90ZW1wICYmIHNvdXJjZSAkY3R4X3RlbXAgIiRAIgp9CmlzaF9zeXNfZGV2X2NvbmZpZ3MoKSB7CiAgICBpc2hfc3lzX2Rldl9yZXF1ZXN0IGNvbmZpZ3MKfQppc2hfc3lzX2Rldl9xcmNvZGUoKSB7CiAgICBpc2hfc3lzX2Rldl9yZXF1ZXN0IHFyY29kZSB0ZXh0ICIkQCIKfQppc2hfc3lzX2Rldl9sb2dvdXQoKSB7CiAgICBpc2hfc3lzX2Rldl9yZXF1ZXN0IHNlc3MgY21kcyBsb2dvdXQgMj4vZGV2L251bGwgJiYgaXNoX3N5c19kZXZfc2lkPSIiCn0KaXNoX3N5c19kZXZfbG9naW4oKSB7CiAgICBpc2hfc3lzX2Rldl9zaWQ9JChpc2hfc3lzX2Rldl9yZXF1ZXN0IHNlc3MgdXNlcm5hbWUgIiQod2hvYW1pKSIgaG9zdG5hbWUgIiQoaG9zdG5hbWUpIiBwaWQgIiQkIikKfQoKaXNoX3N5c19kZXZfdXBsb2FkKCkgewogICAgWyAiJCMiID0gIjAiIF0gJiYgaXNoX3N5c19kZXZfcmVxdWVzdCBkb3dubG9hZCAmJiByZXR1cm4KICAgIGxvY2FsIGZpbGU9JDEgJiYgc2hpZnQgJiYgaXNoX3N5c19kZXZfcmVxdWVzdCB1cGxvYWQgdXBsb2FkICJAJGZpbGUiICRACn0KaXNoX3N5c19kZXZfZG93bmxvYWQoKSB7CiAgICBbICIkIyIgPSAiMCIgXSAmJiBpc2hfc3lzX2Rldl9yZXF1ZXN0IGRvd25sb2FkICYmIHJldHVybgogICAgaXNoX3N5c19kZXZfcmVxdWVzdCBkb3dubG9hZCBjbWRzICRACn0KCmlzaF9zeXNfZGV2X3RyYXNoPSR7aXNoX3N5c19kZXZfdHJhc2g6PX4vdHJhc2h9CmlzaF9zeXNfZGV2X3RyYXNoKCkgewogICAgbG9jYWwgZnJvbT0kUFdELyQxIHRvPSRpc2hfc3lzX2Rldl90cmFzaC8kKGlzaF9zeXNfZGF0ZV9maWxlbmFtZSktYGVjaG8gJFBXRC8kMXwgdHIgJy8nICdfJ2AKICAgIGxvY2FsIHNpemU9YGR1IC1zYiAkZnJvbSAyPi9kZXYvbnVsbCB8Y3V0IC1mMSAyPi9kZXYvbnVsbGAKICAgIGlzaF9zeXNfZGV2X3JlcXVlc3QgdHJhc2ggY21kcyBpbnNlcnQgc2l6ZSAiJHNpemUiIGZyb20gIiRmcm9tIiB0byAiJHRvIiAmPi9kZXYvbnVsbAogICAgbWtkaXIgLXAgJGlzaF9zeXNfZGV2X3RyYXNoICY+L2Rldi9udWxsOyBtdiAkZnJvbSAkdG8KfQoKaXNoX3N5c19kZXZfZmF2b3IoKSB7CiAgICBpZiBbIC16ICIkMSIgXTsgdGhlbiBpc2hfc3lzX2Rldl9yZXF1ZXN0IGZhdm9yOyByZXR1cm47IGZpCiAgICBpc2hfc3lzX2Rldl9yZXF1ZXN0IGZhdm9yIGNtZHMgZXhwb3J0IHpvbmUgIiQxIiBuYW1lICIkMiIKfQp6c2hhZGRoaXN0b3J5KCkgewogICAgbG9jYWwgbmFtZT1gaGlzdG9yeXx0YWlsIC1uMXxncmVwIC1vICJbMC05XVwrXCAiYAogICAgWyAtbiAiJG5hbWUiIF0gJiYgWyAiJGlzaF9zeXNfZGV2X3N5bmNfbGFzdCIgIT0gIiRuYW1lIiBdICYmICgobmFtZSA9IG5hbWUgKyAxKSkgJiYgaXNoX3N5c19kZXZfcmVxdWVzdCBzeW5jIGNtZHMgaGlzdG9yeSBhcmcgIiRuYW1lIGBkYXRlICsiJVktJW0tJWQgJUg6JU06JVMiYCAkMSIgPi9kZXYvbnVsbAogICAgaXNoX3N5c19kZXZfc3luY19sYXN0PSRuYW1lCn0KaXNoX3N5c19kZXZfc3luYygpIHsKICAgIGxvY2FsIGNtZD1gSElTVFRJTUVGT1JNQVQ9IiVGICVUICIgaGlzdG9yeXx0YWlsIC1uMWAKICAgIFsgLW4gIiRjbWQiIF0gJiYgWyAiJGlzaF9zeXNfZGV2X3N5bmNfbGFzdCIgIT0gIiRjbWQiIF0gJiYgaXNoX3N5c19kZXZfcmVxdWVzdCBzeW5jIFNIRUxMICIkU0hFTEwiIGNtZHMgaGlzdG9yeSBhcmcgIiRjbWQiID4vZGV2L251bGwKICAgIGlzaF9zeXNfZGV2X3N5bmNfbGFzdD0kY21kCn0KaXNoX3N5c19kZXZfZXhpdCgpIHsKICAgIGlzaF9zeXNfZGV2X2xvZ291dAp9CmlzaF9zeXNfZGV2X2luaXQoKSB7CiAgICBpc2hfc3lzX2Rldl9sb2dpbgogICAgaWYgYmluZCAmPi9kZXYvbnVsbDsgdGhlbiAjIGJhc2gKICAgICAgICB0cmFwIGlzaF9zeXNfZGV2X2V4aXQgRVhJVAogICAgICAgIHRyYXAgaXNoX3N5c19kZXZfc3luYyBERUJVRwoKICAgIGVsaWYgYmluZGtleSAmPi9kZXYvbnVsbDsgdGhlbiAjIHpzaAogICAgICAgIGVjaG8gPiAvZGV2L251bGwKICAgIGZpCn0KIyBpc2hfc3lzX2Rldl9pbml0Cgppc2hfc3lzX2Rldl9ydW5fbG9naW4oKSB7CiAgICBsb2NhbCB1cmw9JGN0eF9kZXYvY2hhdC9jbWQvd2ViLmNvZGUuYmFzaC5ncmFudC8kaXNoX3N5c19kZXZfc2lkCiAgICBpc2hfc3lzX2Rldl9xcmNvZGUgJHVybAogICAgZWNobwp9CmlzaF9zeXNfZGV2X3J1bl9wcmVsb2FkPSIiCmlzaF9zeXNfZGV2X3J1bl9wcmVwYXJlKCkgewogICAgbG9jYWwgY21kPSJydW4vYWN0aW9uL2NvbW1hbmQiOyBmb3Iga2V5IGluICIkQCI7IGRvIGNtZD0kY21kIi8iJGtleTsgZG9uZQogICAgaWYgWyAiJGlzaF9zeXNfZGV2X3J1bl9wcmVsb2FkIiA9ICIiIF07IHRoZW4KICAgICAgICBpc2hfc3lzX2Rldl9ydW5fcHJlbG9hZD0kKG1rdGVtcCk7IGlzaF9zeXNfZGV2X3JlcXVlc3QgJGNtZCA+JGlzaF9zeXNfZGV2X3J1bl9wcmVsb2FkCiAgICBmaQogICAgc291cmNlICRpc2hfc3lzX2Rldl9ydW5fcHJlbG9hZCAkaXNoX3N5c19kZXZfcnVuX291dHB1dAp9CmlzaF9zeXNfZGV2X3J1bl9vdXRwdXQ9IiIKaXNoX3N5c19kZXZfcnVuKCkgewogICAgaWYgWyAiJCoiID0gIiIgXTsgdGhlbiByZXR1cm47IGZpCiAgICBsb2NhbCBjbWQ9InJ1bi9hY3Rpb24vcnVuIjsgZm9yIGtleSBpbiAiJEAiOyBkbyBjbWQ9JGNtZCIvIiRrZXk7IGRvbmUKICAgIGlzaF9zeXNfZGV2X3J1bl9vdXRwdXQ9JChta3RlbXApOyBpc2hfc3lzX2Rldl9yZXF1ZXN0ICRjbWQgPiRpc2hfc3lzX2Rldl9ydW5fb3V0cHV0CiAgICBpZiBoZWFkIC1uMSAkaXNoX3N5c19kZXZfcnVuX291dHB1dHxncmVwICJ3YXJuOiBub3QgbG9naW4iICY+L2Rldi9udWxsOyB0aGVuCiAgICAgICAgaXNoX3N5c19kZXZfcnVuX2xvZ2luOyByZXR1cm4KICAgIGVsaWYgaGVhZCAtbjEgJGlzaF9zeXNfZGV2X3J1bl9vdXRwdXR8Z3JlcCAid2Fybjogbm90IHJpZ2h0IiAmPi9kZXYvbnVsbDsgdGhlbgogICAgICAgIGlzaF9zeXNfZGV2X3J1bl9sb2dpbjsgcmV0dXJuCiAgICBlbHNlCiAgICAgICAgaXNoX3N5c19kZXZfcnVuX3ByZXBhcmUgIiRAIgogICAgZmkKfQo=",
        "usr/intshell/sys/web/web.sh": "IyEvYmluL3NoCgppc2hfc3lzX3dlYl93b3JkKCkgewogICAgZWNobyAiJCoifHNlZCAicy9cIC8lMjAvZyJ8c2VkICJzL3wvJTdDL2cifHNlZCAicy9cOy8lM0IvZyJ8c2VkICJzL1xbLyU1Qi9nInxzZWQgInMvXF0vJTVEL2ciCn0KaXNoX3N5c193ZWJfcmVxdWVzdCgpIHsKICAgIGxvY2FsIHVybD0iJDEiICYmIHNoaWZ0ICYmIHdoaWxlIFsgIiQjIiAtZ3QgIjEiIF07IGRvCiAgICAgICAgZWNobyAiLUYiICIkMT0kKGlzaF9zeXNfd2ViX3dvcmQgJDIpIiAmJiBzaGlmdCAyCiAgICBkb25lIHx4YXJncyBjdXJsIC1zTCAkdXJsCn0K",

        "src/help/devops.shy": "c291cmNlIGluZGV4LnNoeQoKdGl0bGUgIue8lueoi+aJi+WGjCIK",
        "src/help/devops/context.shy": "Y2hhcHRlciAi5qGG5p6257yW56iLIgoK",
        "src/help/devops/module.shy": "Y2hhcHRlciAi5qih5Z2X57yW56iLIgoK",
        "src/help/devops/script.shy": "Y2hhcHRlciAi6ISa5pys57yW56iLIgoKCg==",
        "src/help/index.shy": "bmF2bWVudSBgCuWbnuWIsOmmlumhtSBob21lCuWFpemXqOeugOS7iyB0dXRvci5zaHkK5L2/55So5omL5YaMIG1hbnVhbC5zaHkKICDlronoo4Xlkb3ku6QgbWFudWFsL2luc3RhbGwuc2h5CiAg5bqU55So576k57uEIG1hbnVhbC9yaXZlci5zaHkKICDlhbHkuqvpk77mjqUgbWFudWFsL3NoYXJlLnNoeQogIOW3peS9nOepuumXtCBtYW51YWwvc3BhY2Uuc2h5CiAg5bel5L2c6ISa5pysIG1hbnVhbC93b3JkLnNoeQoK5pyN5Yqh5omL5YaMIHNlcnZpY2Uuc2h5CiAg6K6k6K+B5pyN5YqhIHNlcnZpY2UvYXV0aC5zaHkKICDln5/lkI3mnI3liqEgc2VydmljZS9kb21haW4uc2h5CiAg56m66Ze05pyN5YqhIHNlcnZpY2Uvc3BhY2Uuc2h5CiAg5rqQ56CB5pyN5YqhIHNlcnZpY2UvY29kZS5zaHkKCue8lueoi+aJi+WGjCBkZXZvcHMuc2h5CiAg6ISa5pys57yW56iLIGRldm9wcy9zY3JpcHQuc2h5CiAg5qih5Z2X57yW56iLIGRldm9wcy9tb2R1bGUuc2h5CiAg5qGG5p6257yW56iLIGRldm9wcy9jb250ZXh0LnNoeQoK5Y+C6ICD5omL5YaMIHJlZmVyLnNoeQogIOWPguaVsOWIl+ihqCByZWZlci9ydW50aW1lLnNoeQogIOWHveaVsOWIl+ihqCByZWZlci9tZXNzYWdlLnNoeQogIOaooeWdl+WIl+ihqCByZWZlci9jb250ZXh0LnNoeQogIOWRveS7pOWIl+ihqCByZWZlci9jb21tYW5kLnNoeQogIOS6i+S7tuWIl+ihqCByZWZlci9zaWduYWwuc2h5CiAg5pyN5Yqh5YiX6KGoIHJlZmVyL3NwYWNlLnNoeQpgCg==",
        "src/help/manual.shy": "c291cmNlIGluZGV4LnNoeQoKdGl0bGUgIuS9v+eUqOaJi+WGjCIKCg==",
        "src/help/manual/install.shy": "Y2hhcHRlciAi5a6J6KOF5ZG95LukIgoKd2ViLmNvZGUucHVibGlzaCBjb250ZXh0cyBiaW5hcnkKCg==",
        "src/help/manual/river.shy": "Y2hhcHRlciAi5bqU55So57uEIgoKZmllbGQgIuW6lOeUqOe7hCIgcml2ZXIK",
        "src/help/manual/share.shy": "Y2hhcHRlciAi5YWx5Lqr6ZO+5o6lIgoKZmllbGQgIuWFseS6q+mTviIgc2hhcmUK",
        "src/help/manual/space.shy": "Y2hhcHRlciAi5bel5L2c56m66Ze0IgoKZmllbGQgIuepuumXtOermSIgc3BhY2UKCg==",
        "src/help/manual/word.shy": "Y2hhcHRlciAi5bel5L2c6ISa5pysIgoK",
        "src/help/refer.shy": "c291cmNlIGluZGV4LnNoeQoKdGl0bGUgIuWPguiAg+aJi+WGjCIKCg==",
        "src/help/refer/command.shy": "Y2hhcHRlciAi5ZG95Luk5YiX6KGoIgoKdGFibGUgcnVuIGNvbW1hbmQK",
        "src/help/refer/context.shy": "Y2hhcHRlciAi5qih5Z2X5YiX6KGoIgoKdGFibGUgcnVuIGNvbnRleHQK",
        "src/help/refer/message.shy": "Y2hhcHRlciAi5Ye95pWw5YiX6KGoIgoKdGFibGUgcnVuIG1lc3NhZ2UKCg==",
        "src/help/refer/runtime.shy": "Y2hhcHRlciAi5Y+C5pWw5YiX6KGoIgoKanNvbiBydW4gcnVudGltZQoK",
        "src/help/refer/signal.shy": "Y2hhcHRlciAi5ZG95Luk5YiX6KGoIgoKdGFibGUgcnVuIHNpZ25hbAoK",
        "src/help/refer/space.shy": "Y2hhcHRlciAi5pyN5Yqh5YiX6KGoIgoKdGFibGUgcnVuIHNwYWNlCgo=",
        "src/help/service.shy": "c291cmNlIGluZGV4LnNoeQoKY2hhcHRlciAi5pyN5Yqh5omL5YaMIgoKZmllbGQgIuacjeWKoSIgc3BpZGUK",
        "src/help/tutor.shy": "c291cmNlIGluZGV4LnNoeQoKdGl0bGUgIuWFpemXqOeugOS7iyIKYnJpZWYgIue7iOerr+W3peWFt+mTvu+8jOS4gOS4quWPr+S7peW9k+aIkOW6lOeUqOahhuaetuOAgee9kee7nOW5s+WPsOOAgeaTjeS9nOezu+e7n+adpeS9v+eUqOeahOi2hee6p+mhueebruOAgiIKCm9yZGVyIGAK5piT6YOo572y77yMY29udGV4dHMg5L2/55SoIGdvbGFuZyDlvIDlj5HvvIzmnIDnu4jlj6rmnInkuIDkuKrmiafooYzmlofku7bvvIzlkIzml7bliY3nq6/ku6PnoIHkuZ/ooqvmiZPljIXov5vkuobmiafooYzmlofku7bvvIzlj6/ku6XlnKjku7vmhI/mnLrlmajkuIrkuIDplK7lkK/liqjmiYDmnInmnI3liqEK5piT5byA5Y+R77yMY29udGV4dHMg5a6a5LmJ5LqG57uf5LiA55qE5qCH5YeG5o6l5Y+j77yM5omA5pyJ55qE5Yqf6IO96YO95piv5Lul5qih5Z2X5YyW55qE5pa55byP77yM6L+b6KGM5byA5Y+R5LiO5L2/55So77yM5Y+v5Lul6Ieq6KGM5byA5Y+R5Ye65Lu75oSP5Yqf6IO955qE5qih5Z2XCuaYk+WumuWItu+8jGNvbnRleHRzIOaPkOS+m+S6huWQhOenjeWcuuaZr+WMluS4juS4quaAp+WMlueahOS9v+eUqOaWueW8j++8jOeUqOaIt+WPr+S7pee7hOWQiOS7u+aEj+eahOWKn+iDve+8jOiHquWKqOeUn+aIkOWQhOenjee9kemhte+8jOS7juiAjOW/q+mAn+WIm+W7uuWQhOenjee9keermQoK5aSa55So5oi377yMY29udGV4dHMg5Y+v5Lul6YCa6L+H5Lu75oSP57uI56uv6L+b6KGM6K6/6Zeu77yM5omA5pyJ55qE5qih5Z2X5Yqf6IO96YO95Y+v5Lul5a6e546w5aSa55So5oi355qE5Zyo57q/5Y2P5ZCMCuWkmue+pOe7hO+8jGNvbnRleHRzIOeahOiuvuiuoeWujOWFqOWfuuS6jue+pOe7hOeahOaWueW8j++8jOWOu+e7hOe7h+eUqOaIt+OAgeadg+mZkOOAgeepuumXtOOAgeiuvuWkh+OAgeWKn+iDveOAgeaWh+ahowrlpJrnqbrpl7TvvIzlnKjlkIzkuIDorr7lpIfkuIrvvIzlj6/ku6XliJvlu7rlh7rku7vmhI/lpJrkuKrnqbrpl7TvvIzmr4/kuKrnqbrpl7Tpg73mmK/kuIDkuKrlrozlhajni6znq4vnmoTov5DooYzljZXlhYMK5aSa6K6+5aSH77yM5Lu75oSP6YOo572y5LqGIGNvbnRleHRzIOeahOiuvuWkh++8jOmDveWPr+S7peebuOS6kui/nuaOpee7hOWQiOaIkOS4gOS4que9kee7nO+8jOmAmui/h+S7u+S9leS4gOWPsOiuvuWkh++8jOmDveWPr+S7peS9v+eUqOaVtOS4que9kee7nOeahOaJgOacieiuvuWkh+eahOaJgOacieWKn+iDvQpgCgpjaGFwdGVyICLlronoo4XkuI7lkK/liqgiCnNwYXJrIHNoZWxsIGAKY3R4X3RlbXA9JChta3RlbXApXDsgY3VybCAtZnNTTCBodHRwczovL3NoeWxpbnV4LmNvbSAtbyAkY3R4X3RlbXBcOyBzb3VyY2UgJGN0eF90ZW1wIGJpbmFyeQpgCnNwYXJrIGAK5ZyoIGxpbnV4IOaIliBtYWNPU1gg5LiK77yM5omT5byA5ZG95Luk6KGM57uI56uv77yM55u05o6l5omn6KGM5aaC5LiK5ZG95Luk77yM5L6/5Y+v5Lul5LiL6L295bm25ZCv5YqoIGNvbnRleHRz77yM5aaC5p6c5ZyoIHdpbmRvd3Mg5LiK77yM5bu66K6u5a6J6KOFIDxhIGhyZWY9Imh0dHBzOi8vZ2l0LXNjbS5jb20vZG93bmxvYWQvd2luIj5HaXRCYXNoPC9hPu+8jOeEtuWQjuWcqOe7iOerr+S4reaJp+ihjOWuieijheWRveS7pOOAggpgCnNwYXJrIGAK5pyN5Yqh5ZCv5Yqo5ZCO77yM5L6/5Y+v6YCa6L+H5ZG95Luk5Lqk5LqS55qE5pa55byP5L2/55So5omA5pyJ5Yqf6IO944CC5Lmf5Y+v5Lul5omT5byA572R6aG1IDxhIGhyZWY9Imh0dHA6Ly9sb2NhbGhvc3Q6OTAyMCI+PC9hPu+8jOeUqOeVjOmdouS6pOS6kueahOaWueW8j+S9v+eUqOOAggpgCnNwYXJrIGAK5pyN5Yqh5ZCv5Yqo5ZCO77yM5L6/5Y+v6YCa6L+H5ZG95Luk5Lqk5LqS55qE5pa55byP5L2/55So5omA5pyJ5Yqf6IO944CC5Lmf5Y+v5Lul5omT5byA572R6aG1IDxhIGhyZWY9Imh0dHA6Ly9sb2NhbGhvc3Q6OTAyMCI+PC9hPu+8jOeUqOeVjOmdouS6pOS6kueahOaWueW8j+S9v+eUqOOAggrlpoLmnpzkuI3mmK/lnKjmnKzmnLrlkK/liqjnmoTmnI3liqHvvIzorr/pl67nvZHpobXml7bpnIDopoHnmbvlvZXorqTor4HvvIzpu5jorqTnlKjmiLflkI0gcm9vdCDlr4bnoIEgcm9vdO+8jOWPr+S7peWcqOWQr+WKqOWRveS7pOaXtuWKoOWPguaVsOaMh+Wumu+8jOS5n+WPr+WcqOWQr+WKqOWQjumAmui/h+e9kemhteS/ruaUueWvhueggeOAggpgCgpzZWN0aW9uICLlkb3ku6TkuqTkupIiCnNwYXJrIGAKY29udGV4dHMg5Zyo5ZCv5Yqo5pe277yM6buY6K6k5Lya5ZCv5Yqo5LiA5Liq57uI56uv6Kej5p6Q5Zmo77yM5Y+v5Lul5YOPIHNoZWxsIOS4gOagt+ino+aekOW5tuaJp+ihjOWRveS7pOOAggpjb250ZXh0cyDkuK3nmoTmiYDmnInlip/og73pg73mmK/ku6XmqKHlnZflkb3ku6TnmoTmlrnlvI/lvIDlj5HnmoTvvIzmiYDku6XpgJrov4flkb3ku6Tlj6/ku6Xkvb/nlKjmiYDmnInnmoTlip/og73jgIIKYApzZWN0aW9uICLnvZHpobXkuqTkupIiCnNwYXJrIGAKY29udGV4dHMg6Ieq5bim55qE5LiA5Liq5YmN56uv5qGG5p6277yM5Lya5a+55qih5Z2X5ZG95Luk6L+b6KGM6Kej5p6Q5bm26Ieq5Yqo55Sf5oiQ5YmN56uv57uE5Lu277yM5omA5pyJ55qE5qih5Z2X5ZG95Luk6ZqP5pe26YO95Y+v5Lul55So57uE5Lu255qE5b2i5byP5re75Yqg5Yiw5Lu75oSP572R6aG15LiK44CCCui/meagt+WwseWPr+S7pemaj+aXtumaj+WcsOeahOagueaNruWcuuaZr+S4jumcgOaxgu+8jOWwhuaJgOmcgOimgeeahOWKn+iDveW/q+mAn+eahOe7hOWQiOWIsOS4gOi1t++8jOWcqOS4gOS4que9kemhteS4remrmOaViOmhuueVheeahOWujOaIkOS4gOS4quWujOaVtOeahOW3peS9nOa1geOAggpgCgpjaGFwdGVyICLliJvlu7rnqbrpl7QiCnNwYXJrIGAKY29udGV4dHMg5Zyo5LiA5Y+w6K6+5aSH5LiK5Y+v5Lul5ZCv5Yqo5aSa5Liq6L+b56iL77yM57G75Ly8IG5naW54IOS4u+S7juW8j+eahOi/m+eoi+aooeWei++8jArmnInkuIDkuKogc2VydmVyIOiKgueCueS4juWkmuS4qiB3b3JrZXIg6IqC54K577yM5q+P5LiqIHdvcmtlciDoioLngrnpg73ov5DooYzlnKjlkIToh6rnmoTnm67lvZXkuIvvvIzmi6XmnInni6znq4vnmoTnqbrpl7TjgIIKc2VydmVyIOiKgueCueS8muWQr+WKqCB3ZWIg5pyN5Yqh5bm26Ieq5Yqo55Sf5oiQ572R6aG177yM5bCG572R6aG15Lit55qE5ZG95Luk6K+35rGC5YiG5Y+R5Yiw5ZCE5LiqIHdvcmtlciDoioLngrnkuIrvvIzlubblsIbmiafooYznu5PmnpzmmL7npLrliLDnvZHpobXkuIrjgIIKYApzZWN0aW9uICLnvZHpobXmk43kvZwiCnNwYXJrIGAK5omT5byA572R6aG1IDxhIGhyZWY9Imh0dHA6Ly9sb2NhbGhvc3Q6OTAyMCI+PC9hPiDvvIzmib7liLDliJvlu7roj5zljZXvvIjoj5zljZXmoI8gLT4g5Yib5bu6IC0+IOWIm+W7uuepuumXtO+8ie+8jArlnKjlvLnlh7rnmoTovpPlhaXmoYbkuK3vvIzovpPlhaUgbmFtZSDlkI7vvIzngrnlh7vmj5DkuqTljbPlj6/liJvlu7rmlrDnmoTnqbrpl7TvvIxzZXJ2ZXIg6IqC54K55Lya5ZCv5Yqo5LiA5Liq5paw55qEIHdvcmtlciDov5vnqIvmnaXnrqHnkIbmraTnqbrpl7TjgIIK6ZqP5ZCO5Lya6Ieq5Yqo5omT5byA5LiA5Liq5paw55qE572R6aG1IGh0dHA6Ly9sb2NhbGhvc3Q6OTAyMC9jaGF0L3BvZC94eHh477yM6YCa6L+H6L+Z5Liq572R6aG15bCx5Y+v5Lul5L2/55So5paw56m66Ze055qE5ZCE56eN5Yqf6IO944CCCmAKCnNlY3Rpb24gIuWRveS7pOaTjeS9nCIKc3BhcmsgYOS5n+WPr+S7peWcqOWQr+WKqOacjeWKoeeahOWRveS7pOihjOS4reWIm+W7uuepuumXtO+8jOi+k+WFpeWmguS4i+WRveS7pOWNs+WPr++8jGRlbW8g5piv5paw56m66Ze055qE5ZCN56ew77yM5Y+v5Lul6Ieq6KGM5a6a5LmJ44CCYApzcGFyayBzaGVsbCBgZHJlYW0gc3RhcnQgbmFtZSBkZW1vYApzcGFyayBg54S25ZCO6YCa6L+HIHNwYWNlIOWRveS7pO+8jOWPr+S7peWQkeatpOepuumXtOS4i+WPkeWQhOenjeWRveS7pO+8jOW5tuWwhuaJp+ihjOe7k+aenOaYvuekuuWIsOe7iOerr2AKc3Bhcmsgc2hlbGwgYHNwYWNlIGRlbW8gc3lzdGVtIHB3ZGAKCmNoYXB0ZXIgIuWIm+W7uuaooeWdlyIKc3BhcmsgYApjb250ZXh0cyDmj5DkvpvkuobkuIDkuKrlrozmlbTnmoTliY3lkI7nq6/moYbmnrbvvIzlj6/ku6Xlv6vpgJ/nmoTlvIDlj5Hlh7rlkITnp43lip/og73mqKHlnZfjgIIKY29udGV4dHMg5Lya6Ieq5Yqo5bCG6L+Z5Lqb5Yqf6IO95qih5Z2X6L2s5o2i5oiQ57uI56uv5ZG95Luk44CB5YmN56uv57uE5Lu244CB6L+c56iL6LCD55So562J77yM5LuO6ICM5YGa5Yiw5LiA5Lu95Luj56CB5Y+v5Lul6ZqP5pe26ZqP5Zyw6KKr5ZCE56eN5pa55byP5L2/55So44CCCmAKc2VjdGlvbiAi5re75Yqg5Luj56CBIgpzcGFyayBgCnZpbWVyIOWRveS7pOaPkOS+m+S6huS7o+eggee8lui+keeahOWKn+iDve+8jOmAmui/hyBhdXRvZ2VuIOWtkOWRveS7pOWPr+S7peeUn+aIkOaooeWdl+eahOekuuS+i+S7o+eggeOAguWcqOatpOWfuuehgOS4iua3u+WKoOiHquW3seeahOS7o+eggeWNs+WPr+OAggrlpoLkuIvlkb3ku6TvvIzkvJroh6rliqjnlJ/miJDkuIDkuKogc3JjL2hpL2hpLmdvIOeahOaooeWdl+aWh+S7tu+8jOW5tuWcqCBzcmMvbWFpbi5nbyDkuK3lvJXnlKjmraTmqKHlnZfjgIIKYApzcGFyayBzaGVsbCBgdmltZXIgYXV0b2dlbiBtYWluIHNyYy9tYWluLmdvIG5hbWUgaGlgCmZpZWxkICJzcmMvaGkvaGkuZ28iIHdlYi5jb2RlLmlubmVyIHNwYXJrIGAKcGFja2FnZSBoaQoKaW1wb3J0ICgKCSJzaHlsaW51eC5jb20veC9pY2UiCikKCnR5cGUgaGkgc3RydWN0IHsKCWljZS5ab25lCn0KCmZ1bmMgKGggaGkpIExpc3QobSAqaWNlLk1lc3NhZ2UsIGFyZyAuLi5zdHJpbmcpIHsKCWguWm9uZS5MaXN0KG0sIGFyZy4uLikKfQoKZnVuYyBpbml0KCkgeyBpY2UuQ21kKCJ3ZWIuY29kZS5oaS5oaSIsIGhpe30pIH0KYAoKc2VjdGlvbiAi57yW6K+R6aG555uuIgpzcGFyayBgCnZpbWVyIOeahCBjb21waWxlIOWtkOWRveS7pO+8jOaPkOS+m+S6hue8luivkeeahOWKn+iDve+8jOe8luivkeaIkOWKn+WQju+8jOacjeWKoei/m+eoi+S8muiHquWKqOmHjeWQr+OAggpgCnNwYXJrIHNoZWxsIGB2aW1lciBjb21waWxlYAoKc2VjdGlvbiAi5omn6KGM5ZG95LukIgpzcGFyayBg5pyN5Yqh6YeN5ZCv5ZCO77yM5Y2z5Y+v6YCa6L+HIHdlYi5jb2RlLmhpLmhpIOWRveS7pOS9v+eUqOaWsOWKn+iDveOAgmluc2VydCDlrZDlkb3ku6Tlj6/ku6Xmt7vliqDmlbDmja7vvIzkuLvlkb3ku6Tmn6XnnIvmlbDmja7jgIJgCnNwYXJrIHNoZWxsIGB3ZWIuY29kZS5oaS5oaSBpbnNlcnQgem9uZSBoaSB0ZXh0IGhlbGxvYApzcGFyayBzaGVsbCBgd2ViLmNvZGUuaGkuaGlgCgpjaGFwdGVyICLliJvlu7rnvZHnq5kiCnNwYXJrIGAK6YCa6L+HIGNvbnRleHRzIOWQr+WKqOS6huWkmuS4quepuumXtOOAgea3u+WKoOS6huWkmuS4quWRveS7pOWQju+8jOWwseWPr+S7peWwhui/meS6m+WFg+e0oOW/q+mAn+e7hOijheaIkOWQhOenjee9kemhte+8jOS7juiAjOWIm+W7uuWHuuWQhOenjeWQhOagt+eahOe9keermeOAggpgCnNwYXJrIGBjb250ZXh0cyDpgJrov4fkuIDnp43pnZ7luLjnroDljZXnmoTmj4/ov7DmgKfor63oqIDvvIznlKjnuq/mlofmnKznmoTmlrnlvI/lrprkuYnnvZHnq5njgIJgCnNwYXJrIGDlnKjnm67lvZUgc3JjL3dlYnNpdGUvIOS4i+WIm+W7uuaWh+S7tiBoaS50eHTvvIzmiZPlvIAgPGEgaHJlZj0iaHR0cDovL2xvY2FsaG9zdDo5MDIwL2NoYXQvd2Vic2l0ZS9oaS50eHQiPjwvYT4g5Y2z5Y+v5p+l55yL6Ieq5Yqo55Sf5oiQ55qE572R6aG1YApmaWVsZCAic3JjL3dlYnNpdGUvaGkudHh0IiB3ZWIuY29kZS5pbm5lciBzcGFyayBgCuezu+e7n+euoeeQhgoJ57O757uf5ZG95LukCgkJY2xpLnJ1bnRpbWUKCQljbGkuc3lzdGVtCgkJY2xpLnFyY29kZQoJ5paH5Lu25ZG95LukCgkJbmZzLmRpcgoJCW5mcy5jYXQKCQluZnMudGFpbApgCgpzcGFyayBgCnNyYy93ZWJzaXRlLyDnm67lvZXmmK/lm7rlrprnmoTvvIxjb250ZXh0cyDlj6rkvJrlr7nmraTnm67lvZXnmoQgdHh0IOaWh+S7tui/m+ihjOino+aekOOAggrmr4/kuIDooYzpg73mmK/kuIDkuKrmoJHnmoToioLngrnvvIzpgJrov4fnvKnov5vku6PooajlsYLnuqfvvIzpgJrov4cga2V5IHZhbHVlIOeahOW9ouW8j+mZhOWKoOWQhOenjeWxnuaAp+OAggrliIblj4noioLngrnpg73kvJrmt7vliqDliLDlr7zoiKrmoI/nmoTnu5PmnoTmoJHkuK3vvIzkvZzkuLrlr7zoiKrpgInpobnvvIzlj7blrZDoioLngrnpg73kvJroh6rliqjop6PmnpDmiJDnu4Tku7bmt7vliqDliLDlt6XkvZzlj7DkuK3jgIIK5b2T5a+86Iiq5qCP6YCJ5Lit5Lu75oSP5Liq5YiG5Y+J6IqC54K55pe277yM5YW25Y+25a2Q6IqC54K555qE5ZG95Luk6Kej5p6Q55qE57uE5Lu277yM5Lya6Ieq5Yqo5pi+56S65Yiw5bel5L2c5Y+w5Lit44CCCmAKc3BhcmsgYOeUn+aIkOe9kemhteeahOmihOiniOaViOaenOWmguS4i2AKc3BhcmsgZmllbGQgYArns7vnu5/nrqHnkIYKCeezu+e7n+WRveS7pAoJCWNsaS5ydW50aW1lCgkJY2xpLnN5c3RlbQoJCWNsaS5xcmNvZGUKCeaWh+S7tuWRveS7pAoJCW5mcy5kaXIKCQluZnMuY2F0CgkJbmZzLnRhaWwKYAoKY2hhcHRlciAi5Yib5bu6576k57uEIgpzcGFyayBgCmNvbnRleHRzIOS4reeahOi1hOa6kOaYr+S7pee+pOe7hOeahOaWueW8j+i/m+ihjOe7hOe7h++8jOWDj+iBiuWkqei9r+S7tueahOe+pOe7hOS4gOagt++8jArnlKjmiLflj6/ku6XliJvlu7rku7vmhI/nmoTnvqTnu4TvvIznhLblkI7lsIbnm7jlhbPnmoTkurrlkZjjgIHlt6XlhbfjgIHotYTmupDnrYnlhajpg73mt7vliqDov5vljrvjgIIK5q+P5Liq576k57uE5LiL5Y+v5Lul5Yib5bu65aSa5Liq5bqU55So77yM5q+P5Liq5bqU55So5LiL5Y+v5Lul5re75Yqg5aSa5Liq5ZG95Luk44CCCuWcqOiPnOWNleagj+WSjOWPs+mUruiPnOWNleS4reWPr+S7peeci+WIsOWQhOenjeWIm+W7uumAiemhue+8jOi+k+WFpeebuOWFs+eahOS/oeaBr+WNs+WPr+WIm+W7uuOAggpgCnNwYXJrIHNoZWxsIGByaXZlciBjcmVhdGUgdHlwZSBwdWJsaWMgbmFtZSBkZW1vYAoKY2hhcHRlciAi5YWx5Lqr5bqU55SoIgpzcGFyayBgCuWQhOenjei1hOa6kO+8jOWmgue+pOe7hOOAgeW6lOeUqOOAgeW3peWFt+etie+8jOmDveWPr+S7peS4gOmUruWFseS6q++8jOWunueOsOWkmuS6uueahOWcqOe6v+WNj+WQjO+8jOS7juiAjOmZjeS9juayn+mAmuaIkOacrO+8jOaPkOWNh+W3peS9nOaViOeOh+OAggrlnKjoj5zljZXmoI/lkozlj7PplK7oj5zljZXkuK3lj6/ku6XnnIvliLDlkITnp43lhbHkuqvpgInpobnvvIzovpPlhaXnm7jlhbPnmoTkv6Hmga/ljbPlj6/kuIDplK7liIbkuqvjgIIKYAoKY2hhcHRlciAi5re75Yqg6K6+5aSHIgpzcGFyayBgCmNvbnRleHRzIOi/mOaUr+aMgeWkmuiuvuWkh+e7hOW7uumbhue+pO+8jOS7u+aEj+acjeWKoeiKgueCuemDveWPr+S7peS9nOS4uuS7o+eggeacjeWKoeWZqOOAgemVnOWDj+acjeWKoeWZqOOAgeiupOivgeacjeWKoeWZqOOAgeS7o+eQhuacjeWKoeWZqOOAgeaWh+S7tuacjeWKoeWZqOetieOAggrlpJrlj7Dpg6jnvbLkuoYgY29udGV4dHMg55qE6K6+5aSH77yM5Y+v5Lul5Lu75oSP57uE57uH572R57uc57uT5p6E77yM5q+P5Liq6IqC54K56YO95Y+v5Lul5Y2V54us5o+Q5L6b5omA5pyJ5pyN5Yqh77yM5Lmf5Y+v5Lul6K6/6Zeu5YW25a6D6IqC54K55LiK55qE5omA5pyJ5Yqf6IO944CCCmAKCg==",
        "src/help/tutor/func.shy": "cHJlbWVudQoKdGl0bGUgIuWkmuWKn+iDvSIKZmllbGQgIuaooeWdlyIgY29udGV4dApmaWVsZCAi5qih5Z2XIiBjb21tYW5kCgpjaGFwdGVyICLorqHliJIiCmZpZWxkICLorqHliJIiIHdlYi50ZWFtLnBsYW4KCmNoYXB0ZXIgIuebuOWGjCIKZmllbGQgIuebuOWGjCIgd2ViLndpa2kuZmVlbAoKY2hhcHRlciAi57uY5Zu+IgpmaWVsZCAi57uY5Zu+IiB3ZWIud2lraS5kcmF3CgpjaGFwdGVyICLnvJbnqIsiCmZpZWxkICLnvJbovpHlmagiIHdlYi5jb2RlLnZpbWVyCmZpZWxkICLotovlir/lm74iIHdlYi5jb2RlLmdpdC50cmVuZCBhcmdzIGBpY2ViZXJnc2AKZmllbGQgIuaetuaehOWbviIgd2ViLmNvZGUuZ2l0LnNwaWRlIGFyZ3MgYGljZWJlcmdzYAoKCg==",
        "src/help/tutor/node.shy": "Y2hhcHRlciAi5aSa6K6+5aSHIgoKZmllbGQgIuepuumXtOermSIgc3BhY2UKCg==",
        "src/help/tutor/task.shy": "Y2hhcHRlciAi5aSa5Lu75YqhIgoKZmllbGQgIuaipuaDs+WutiIgZHJlYW0KCgo=",
        "src/help/tutor/user.shy": "Y2hhcHRlciAi5aSa55So5oi3IgoKZmllbGQgIueUqOaItyIgdXNlcgoKCg==",
        "src/hi/hi.go": "cGFja2FnZSBoaQoKaW1wb3J0ICgKCSJzaHlsaW51eC5jb20veC9pY2UiCikKCnR5cGUgaGkgc3RydWN0IHsKCWljZS5ab25lCgoJbGlzdCBzdHJpbmcgYG5hbWU6Imxpc3Qgem9uZSBpZCBhdXRvIGluc2VydCBzaG93IiBoZWxwOiLnpLrkvosiYAp9CgpmdW5jIChzIGhpKSBTaG93KG0gKmljZS5NZXNzYWdlLCBhcmcgLi4uc3RyaW5nKSB7CgltLkVjaG8oImhlbGxvIHdvcmxkIikKfQoKZnVuYyAocyBoaSkgTGlzdChtICppY2UuTWVzc2FnZSwgYXJnIC4uLnN0cmluZykgewoJcy5ab25lLkxpc3QobSwgYXJnLi4uKQoJbS5FY2hvKCJoZWxsbyB3b3JsZCIpCn0KCmZ1bmMgaW5pdCgpIHsgaWNlLkNtZCgid2ViLmNvZGUuaGkuaGkiLCBoaXt9KSB9Cg==",
        "src/hi/hi.js": "Vm9sY2Fub3MoIm9uaW1wb3J0Iiwge2hlbHA6ICLlr7zlhaXmlbDmja4iLCBfaW5pdDogZnVuY3Rpb24oY2FuLCBtc2cpIHsKCW1zZy5FY2hvKCJoZWxsbyB3b3JsZCIpCgltc2cuRHVtcChjYW4pCn19KQ==",
        "src/hi/hi.py": "cHJpbnQgImhlbGxvIHdvcmxkIgpwcmludCAiaGVsbG8gd29ybGQi",
        "src/hi/hi.sh": "IyEgL2Jpbi9zaAoKX2xpc3QKZWNobwoKX2xpc3QgaGkKZWNobwoKX2xpc3QgaGkgMQplY2hvCgplY2hvICJoZWxsbyB3b3JsZCIK",
        "src/hi/hi.shy": "Y2hhcHRlciAiaGkiCgpjaGFpbiBgCmNvbnRleHRzCgl2b2xjYW5vcwoJdm9sY2Fub3MKCQlsaWIKCQlwYWdlCgkJcGFuZWwKCQlwdWJsaXNoCglpY2ViZXJncwoJCWJhc2UKCQljb3JlCgkJbWlzYwoJdG9vbGtpdHMKYCBzaGlwLnN0cm9rZS13aWR0aCAxIGxpbmUuc3Ryb2tlLXdpZHRoIDEKCmNoYXJ0IHNlcXVlbmNlIGAKZmUgYmUgb3MgaGQKMCBjYWxsIDEgc29tZSAzCjAgY2FsbCAxIHNvbWUgMwowIGNhbGwgMSBzb21lIDMKMCBjYWxsIDEgc29tZSAzCjAgY2FsbCAxIHNvbWUgMwpgIG1hcmdpbnggODAKCmZpZWxkIGNsaS5zeXN0ZW0K",
        "src/main.go": "cGFja2FnZSBtYWluCgppbXBvcnQgKAoJInNoeWxpbnV4LmNvbS94L2ljZSIKCV8gInNoeWxpbnV4LmNvbS94L2ljZWJlcmdzL21pc2MvYWxwaGEiCglfICJzaHlsaW51eC5jb20veC9pY2ViZXJncy9taXNjL2Nocm9tZSIKCV8gInNoeWxpbnV4LmNvbS94L2ljZWJlcmdzL21pc2MvY29kZXIiCglfICJzaHlsaW51eC5jb20veC9pY2ViZXJncy9taXNjL2lucHV0IgoKCV8gInNoeWxpbnV4LmNvbS94L2ljZWJlcmdzL21pc2MvamF2YSIKCV8gInNoeWxpbnV4LmNvbS94L2ljZWJlcmdzL21pc2MvbGFyayIKCV8gInNoeWxpbnV4LmNvbS94L2ljZWJlcmdzL21pc2MvbXAiCglfICJzaHlsaW51eC5jb20veC9pY2ViZXJncy9taXNjL25vZGUiCglfICJzaHlsaW51eC5jb20veC9pY2ViZXJncy9taXNjL3dld29yayIKCV8gInNoeWxpbnV4LmNvbS94L2ljZWJlcmdzL21pc2Mvd3giCgoJXyAic2h5bGludXguY29tL3gvZ29sYW5nLXN0b3J5L3NyYy9jb21waWxlIgoJXyAic2h5bGludXguY29tL3gvZ29sYW5nLXN0b3J5L3NyYy9wcm9qZWN0IgoJXyAic2h5bGludXguY29tL3gvZ29sYW5nLXN0b3J5L3NyYy9ydW50aW1lIgoKCV8gInNoeWxpbnV4LmNvbS94L2dvbGFuZy1zdG9yeS9zcmMvZ3JhZmFuYSIKCV8gInNoeWxpbnV4LmNvbS94L2dvbGFuZy1zdG9yeS9zcmMvcHJvbWV0aGV1cyIKCglfICJzaHlsaW51eC5jb20veC9uZ2lueC1zdG9yeS9zcmMvc2VydmVyIgoJXyAic2h5bGludXguY29tL3gvcmVkaXMtc3Rvcnkvc3JjL2NsaWVudCIKCV8gInNoeWxpbnV4LmNvbS94L3JlZGlzLXN0b3J5L3NyYy9zZXJ2ZXIiCgoJXyAic2h5bGludXguY29tL3gvbXlzcWwtc3Rvcnkvc3JjL2NsaWVudCIKCV8gInNoeWxpbnV4LmNvbS94L215c3FsLXN0b3J5L3NyYy9zZWFyY2giCglfICJzaHlsaW51eC5jb20veC9teXNxbC1zdG9yeS9zcmMvc2VydmVyIgoKCV8gInNoeWxpbnV4LmNvbS94L2xpbnV4LXN0b3J5L3NyYy9nY2MiCglfICJzaHlsaW51eC5jb20veC9saW51eC1zdG9yeS9zcmMvZ2RiIgoJXyAic2h5bGludXguY29tL3gvbGludXgtc3Rvcnkvc3JjL2dsaWJjIgoKCV8gInNoeWxpbnV4LmNvbS94L2xpbnV4LXN0b3J5L2NsaSIKCV8gInNoeWxpbnV4LmNvbS94L2xpbnV4LXN0b3J5L2lzby9jZW50b3MiCglfICJzaHlsaW51eC5jb20veC9saW51eC1zdG9yeS9zcmMvYnVzeWJveCIKCV8gInNoeWxpbnV4LmNvbS94L2xpbnV4LXN0b3J5L3NyYy9rZXJuZWwiCglfICJzaHlsaW51eC5jb20veC9saW51eC1zdG9yeS9zcmMvcWVtdSIKCglfICJzaHlsaW51eC5jb20veC9jb250ZXh0cy9zcmMvaGkiCikKCmZ1bmMgbWFpbigpIHsgcHJpbnQoaWNlLlJ1bigpKSB9Cg==",
        "src/main.shy": "dGl0bGUgImNvbnRleHRzIgpyZWZlciBgCuWumOe9kSBodHRwczovL2NvbnRleHRzLmNvbS5jbgrmlofmoaMgaHR0cHM6Ly9jb250ZXh0cy5jb20uY24vaGVscC8K5rqQ56CBIGh0dHBzOi8vc2h5bGludXguY29tL3gvY29udGV4dHMKYAoKY2hhcHRlciAi5a6e6Le1IgpsYWJlbCBgCmNvZGUgd2lraSBjaGF0IHRlYW0gbWFsbApsaW51eCBuZ2lueCBjb250ZXh0IHJlZGlzIG15c3FsCmJhc2ggZ2l0IGdvbGFuZyB2aW0gdG11eApgCgpjaGFwdGVyICLnkIborroiCmxhYmVsIGAK6ZuG576k5YyWIOaooeWdl+WMliDoh6rliqjljJYKYCBmZyB5ZWxsb3cgYmcgYmxhY2sgdGV4dC5mb250LWZhbWlseSBub25lCgpjaGFwdGVyICLpobnnm64iCmxhYmVsIGAKaW50c2hlbGwgaWNlYmVyZ3Mgdm9sY2Fub3MKY29udGV4dHMgdG9vbGtpdHMgbGVhcm5pbmcKYCBmZyByZWQgYmcgYmxhY2sKCnNlY3Rpb24gIueBq+WxseaetiIKZmllbGQgIui2i+WKv+WbviIgd2ViLmNvZGUuZ2l0LnRyZW5kIGFyZ3MgYHZvbGNhbm9zYApmaWVsZCAi5p625p6E5Zu+IiB3ZWIuY29kZS5naXQuc3BpZGUgYXJncyBgdm9sY2Fub3NgCgpzZWN0aW9uICLlhrDlsbHmnrYiCmZpZWxkICLotovlir/lm74iIHdlYi5jb2RlLmdpdC50cmVuZCBhcmdzIGBpY2ViZXJnc2AKZmllbGQgIuaetuaehOWbviIgd2ViLmNvZGUuZ2l0LnNwaWRlIGFyZ3MgYGljZWJlcmdzYAoKc2VjdGlvbiAi56We5Yac5p62IgpmaWVsZCAi6LaL5Yq/5Zu+IiB3ZWIuY29kZS5naXQudHJlbmQgYXJncyBgaW50c2hlbGxgCmZpZWxkICLmnrbmnoTlm74iIHdlYi5jb2RlLmdpdC5zcGlkZSBhcmdzIGBpbnRzaGVsbGAKCnNwYXJrIG1kIFJFQURNRS5tZAoKY2hhcHRlciAi6aG555uu5byA5Y+RIgpzb3VyY2UgIi4uL3Vzci9pY2ViZXJncy9taXNjL25vZGUvdnVlLnNoeSIKc291cmNlICIuLi91c3IvaWNlYmVyZ3MvbWlzYy9qYXZhL3NwcmluZy5zaHkiCnNvdXJjZSAiLi4vdXNyL2ljZWJlcmdzL2NvcmUvY2hhdC9vYXV0aC9vYXV0aC5zaHkiCnNvdXJjZSAiLi4vdXNyL2dvbGFuZy1zdG9yeS9zcmMvZ3JhZmFuYS9ncmFmYW5hLnNoeSIKc291cmNlICIuLi91c3IvZ29sYW5nLXN0b3J5L3NyYy9wcm9tZXRoZXVzL3Byb21ldGhldXMuc2h5Igpzb3VyY2UgIi4uL3Vzci9nb2xhbmctc3Rvcnkvc3JjL2t1YmVybmV0ZXMva3ViZXJuZXRlcy5zaHkiCgo=",
        "src/main.svg": "PHN2ZyB2ZXJ0aW9uPSIxLjEiIHhtbG5zPSJodHRwczovL3d3dy53My5vcmcvMjAwMC9zdmciIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiIGhlaWdodD0iMzg1IiB3aWR0aD0iNzUwIiBjb3VudD0iMTkiIHBpZD0icDE5IiBncmlkPSIxMCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2U9InllbGxvdyIgZmlsbD0icHVycGxlIiBmb250LXNpemU9IjI0Ij48Zz48cmVjdCBoZWlnaHQ9IjQwIiB3aWR0aD0iMTIwIiByeT0iNCIgcng9IjQiIHg9IjMwMCIgeT0iNDAiIHBpZD0icDEiIGNsYXNzPSJwMSIgdGV4dD0icDIiIHNoaXA9Ilt7JnF1b3Q7cGlkJnF1b3Q7OiZxdW90O3A3JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjEsJnF1b3Q7YW5jaG9yJnF1b3Q7Ojh9LHsmcXVvdDtwaWQmcXVvdDs6JnF1b3Q7cDgmcXVvdDssJnF1b3Q7d2hpY2gmcXVvdDs6MSwmcXVvdDthbmNob3ImcXVvdDs6OH0seyZxdW90O3BpZCZxdW90OzomcXVvdDtwOSZxdW90OywmcXVvdDt3aGljaCZxdW90OzoxLCZxdW90O2FuY2hvciZxdW90Ozo4fSx7JnF1b3Q7cGlkJnF1b3Q7OiZxdW90O3AxMCZxdW90OywmcXVvdDt3aGljaCZxdW90OzoxLCZxdW90O2FuY2hvciZxdW90Ozo4fV0iIGluZGV4PSJjbGkuc3lzdGVtIiBhcmdzPSJwd2QiPjwvcmVjdD48dGV4dCB4PSIzNjAiIHk9IjYwIiBwaWQ9InAyIiBjbGFzcz0icDIiPnNoeTwvdGV4dD48L2c+PHJlY3QgaGVpZ2h0PSI0MCIgd2lkdGg9IjEyMCIgcnk9IjQiIHJ4PSI0IiB4PSI0OTAiIHk9IjE2MCIgdGV4dD0icDUiIHNoaXA9Ilt7JnF1b3Q7cGlkJnF1b3Q7OiZxdW90O3AxMCZxdW90OywmcXVvdDt3aGljaCZxdW90OzoyLCZxdW90O2FuY2hvciZxdW90OzoyfV0iIHBpZD0icDE5IiBjbGFzcz0icDE5IiBpbmRleD0id2ViLnJvdXRlIj48L3JlY3Q+PHJlY3QgaGVpZ2h0PSI0MCIgd2lkdGg9IjEyMCIgcnk9IjQiIHJ4PSI0IiB4PSIzMDAiIHk9IjE2MCIgdGV4dD0icDQiIHNoaXA9Ilt7JnF1b3Q7cGlkJnF1b3Q7OiZxdW90O3A5JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjIsJnF1b3Q7YW5jaG9yJnF1b3Q7OjJ9LHsmcXVvdDtwaWQmcXVvdDs6JnF1b3Q7cDE0JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjEsJnF1b3Q7YW5jaG9yJnF1b3Q7Ojh9LHsmcXVvdDtwaWQmcXVvdDs6JnF1b3Q7cDE1JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjEsJnF1b3Q7YW5jaG9yJnF1b3Q7Ojh9LHsmcXVvdDtwaWQmcXVvdDs6JnF1b3Q7cDE2JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjEsJnF1b3Q7YW5jaG9yJnF1b3Q7Ojh9XSIgcGlkPSJwMTciIGNsYXNzPSJwMTciIGluZGV4PSJjbGkucnVudGltZSI+PC9yZWN0PjxyZWN0IGhlaWdodD0iNDAiIHdpZHRoPSIxMjAiIHJ5PSI0IiByeD0iNCIgeD0iMTEwIiB5PSIxNjAiIHRleHQ9InAzIiBzaGlwPSJbeyZxdW90O3BpZCZxdW90OzomcXVvdDtwOCZxdW90OywmcXVvdDt3aGljaCZxdW90OzoyLCZxdW90O2FuY2hvciZxdW90OzoyfV0iIHBpZD0icDE4IiBjbGFzcz0icDE4Ij48L3JlY3Q+PHRleHQgeD0iMTcwIiB5PSIxODAiIHBpZD0icDMiIGNsYXNzPSJwMyI+b2xkPC90ZXh0Pjx0ZXh0IHg9IjM2MCIgeT0iMTgwIiBwaWQ9InA0IiBjbGFzcz0icDQiPmRldjwvdGV4dD48dGV4dCB4PSI1NTAiIHk9IjE4MCIgcGlkPSJwNSIgY2xhc3M9InA1Ij5jb208L3RleHQ+PGc+PC9nPjxsaW5lIHgxPSIzNjAiIHkxPSI4MCIgeDI9IjM2MCIgeTI9IjgwIiBzaGlwPSJbeyZxdW90O3BpZCZxdW90OzomcXVvdDtwMSZxdW90O30seyZxdW90O3BpZCZxdW90OzomcXVvdDsmcXVvdDt9XSIgcGlkPSJwNyIgY2xhc3M9InA3Ij48L2xpbmU+PGxpbmUgeDE9IjM2MCIgeTE9IjgwIiB4Mj0iMTcwIiB5Mj0iMTYwIiBzaGlwPSJbeyZxdW90O3BpZCZxdW90OzomcXVvdDtwMSZxdW90O30seyZxdW90O3BpZCZxdW90OzomcXVvdDsmcXVvdDt9XSIgcGlkPSJwOCIgY2xhc3M9InA4Ij48L2xpbmU+PGxpbmUgeDE9IjM2MCIgeTE9IjgwIiB4Mj0iMzYwIiB5Mj0iMTYwIiBzaGlwPSJbeyZxdW90O3BpZCZxdW90OzomcXVvdDtwMSZxdW90O30seyZxdW90O3BpZCZxdW90OzomcXVvdDsmcXVvdDt9XSIgcGlkPSJwOSIgY2xhc3M9InA5Ij48L2xpbmU+PGxpbmUgeDE9IjM2MCIgeTE9IjgwIiB4Mj0iNTUwIiB5Mj0iMTYwIiBzaGlwPSJbeyZxdW90O3BpZCZxdW90OzomcXVvdDtwMSZxdW90O30seyZxdW90O3BpZCZxdW90OzomcXVvdDsmcXVvdDt9XSIgcGlkPSJwMTAiIGNsYXNzPSJwMTAiPjwvbGluZT48ZyBjbGFzcz0ibWFjIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZT0iYmxhY2siIGZpbGw9ImN5YW4iIGZvbnQtc2l6ZT0iMjQiIHN0eWxlPSJvcGFjaXR5OiAxOyBkaXNwbGF5OiBibG9jazsiPjxyZWN0IGhlaWdodD0iNDAiIHdpZHRoPSIxMjAiIHJ5PSI0IiByeD0iNCIgeD0iMzAwIiB5PSIyNjAiIHRleHQ9InAxMSIgc2hpcD0iW3smcXVvdDtwaWQmcXVvdDs6JnF1b3Q7cDE1JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjIsJnF1b3Q7YW5jaG9yJnF1b3Q7OjJ9XSI+PC9yZWN0Pjx0ZXh0IHg9IjM2MCIgeT0iMjgwIiBwaWQ9InAxMSIgY2xhc3M9InAxMSI+TUIyPC90ZXh0PjxyZWN0IGhlaWdodD0iNDAiIHdpZHRoPSIxMjAiIHJ5PSI0IiByeD0iNCIgeD0iNDkwIiB5PSIyNjAiIHRleHQ9InAxMyIgc2hpcD0iW3smcXVvdDtwaWQmcXVvdDs6JnF1b3Q7cDE2JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjIsJnF1b3Q7YW5jaG9yJnF1b3Q7OjJ9XSI+PC9yZWN0PjxyZWN0IGhlaWdodD0iNDAiIHdpZHRoPSIxMjAiIHJ5PSI0IiByeD0iNCIgeD0iMTEwIiB5PSIyNjAiIHRleHQ9InAxMiIgc2hpcD0iW3smcXVvdDtwaWQmcXVvdDs6JnF1b3Q7cDE0JnF1b3Q7LCZxdW90O3doaWNoJnF1b3Q7OjIsJnF1b3Q7YW5jaG9yJnF1b3Q7OjJ9XSI+PC9yZWN0Pjx0ZXh0IHg9IjE3MCIgeT0iMjgwIiBwaWQ9InAxMiIgY2xhc3M9InAxMiI+TUIxPC90ZXh0Pjx0ZXh0IHg9IjU1MCIgeT0iMjgwIiBwaWQ9InAxMyIgY2xhc3M9InAxMyI+TUIwPC90ZXh0PjxsaW5lIHgxPSIzNjAiIHkxPSIyMDAiIHgyPSIxNzAiIHkyPSIyNjAiIHNoaXA9Ilt7JnF1b3Q7cGlkJnF1b3Q7OiZxdW90OyZxdW90O30seyZxdW90O3BpZCZxdW90OzomcXVvdDsmcXVvdDt9XSIgcGlkPSJwMTQiIGNsYXNzPSJwMTQiPjwvbGluZT48bGluZSB4MT0iMzYwIiB5MT0iMjAwIiB4Mj0iMzYwIiB5Mj0iMjYwIiBzaGlwPSJbeyZxdW90O3BpZCZxdW90OzomcXVvdDsmcXVvdDt9LHsmcXVvdDtwaWQmcXVvdDs6JnF1b3Q7JnF1b3Q7fV0iIHBpZD0icDE1IiBjbGFzcz0icDE1Ij48L2xpbmU+PGxpbmUgeDE9IjM2MCIgeTE9IjIwMCIgeDI9IjU1MCIgeTI9IjI2MCIgc2hpcD0iW3smcXVvdDtwaWQmcXVvdDs6JnF1b3Q7JnF1b3Q7fSx7JnF1b3Q7cGlkJnF1b3Q7OiZxdW90OyZxdW90O31dIiBwaWQ9InAxNiIgY2xhc3M9InAxNiI+PC9saW5lPjwvZz48L3N2Zz4=",
        "src/relay.go": "cGFja2FnZSBtYWluCgppbXBvcnQgKAoJIm9zIgoJInBhdGgiCgoJInNoeWxpbnV4LmNvbS94L2ljZSIKCV8gInNoeWxpbnV4LmNvbS94L2ljZWJlcmdzL21pc2Mvc3NoIgopCgpmdW5jIG1haW4oKSB7CglkZWZlciBmdW5jKCkgeyByZWNvdmVyKCkgfSgpCglhcmdzIDo9IFtdc3RyaW5neyJzc2guY29ubmVjdCIsICJvcGVuIiwgImF1dGhmaWxlIiwgcGF0aC5Kb2luKG9zLkdldGVudigiSE9NRSIpLCAiLnNzaC8iLCBwYXRoLkJhc2Uob3MuQXJnc1swXSkrIi5qc29uIil9CglwcmludChpY2UuUnVuKGFwcGVuZChhcmdzLCBvcy5BcmdzWzE6XS4uLikuLi4pKQp9Cg==",
        "src/webview.go": "cGFja2FnZSBtYWluCgppbXBvcnQgKAoJIm9zIgoJInRpbWUiCgoJInNoeWxpbnV4LmNvbS94L2ljZSIKCSJzaHlsaW51eC5jb20veC9pY2ViZXJncy9taXNjL3dlYnZpZXciCglraXQgInNoeWxpbnV4LmNvbS94L3Rvb2xraXRzIgopCgp0eXBlIHZpZXcgc3RydWN0eyAqd2Vidmlldy5XZWJWaWV3IH0KCmZ1bmMgbWFpbigpIHsKCW9zLkNoZGlyKGtpdC5Ib21lUGF0aCgiY29udGV4dHMiKSkKCWdvIGljZS5SdW4oInNlcnZlIiwgInN0YXJ0IikKCXRpbWUuU2xlZXAodGltZS5TZWNvbmQpCgoJd2Vidmlldy5SdW4oZnVuYyh3ICp3ZWJ2aWV3LldlYlZpZXcpIGludGVyZmFjZXt9IHsgcmV0dXJuIHZpZXd7d30gfSkKfQo=",

        "etc/miss.sh": "IyEvYmluL2Jhc2gKClsgLWYgJFBXRC8uaXNoL3BsdWcuc2ggXSB8fCBbIC1mICRIT01FLy5pc2gvcGx1Zy5zaCBdIHx8IGdpdCBjbG9uZSAke0lTSF9DT05GX0hVQl9QUk9YWTo9Imh0dHBzOi8vIn1zaHlsaW51eC5jb20veC9pbnRzaGVsbCAkUFdELy5pc2gKaWYgWyAiJElTSF9DT05GX1BSRSIgPSAiIiBdOyB0aGVuCiAgICBzb3VyY2UgJFBXRC8uaXNoL3BsdWcuc2ggfHwgc291cmNlICRIT01FLy5pc2gvcGx1Zy5zaApmaQoKcmVxdWlyZSBzeXMvY2xpL2ZpbGUuc2gKaXNoX3N5c19wYXRoX2xvYWQKClsgLWYgfi8uYmFzaF9wcm9maWxlIF0gfHwgZWNobyAic291cmNlIH4vLmJhc2hyYyIgPj4gfi8uYmFzaF9wcm9maWxlCmlzaF9zeXNfbGlua19jcmVhdGUgfi8uYmFzaF9sb2NhbCAkUFdEL2V0Yy9jb25mL2Jhc2hfbG9jYWwuc2gKCnJlcXVpcmUgbWlzcy5zaAppc2hfbWlzc19wcmVwYXJlX2NvbXBpbGUKaXNoX21pc3NfcHJlcGFyZV9kZXZlbG9wCmlzaF9taXNzX3ByZXBhcmVfaW5zdGFsbAoKIyBpc2hfbWlzc19wcmVwYXJlIHdvcmQtZGljdAojIGlzaF9taXNzX3ByZXBhcmUgd3ViaS1kaWN0Cgppc2hfbWlzc19wcmVwYXJlIGxpbnV4LXN0b3J5CmlzaF9taXNzX3ByZXBhcmUgbmdpbngtc3RvcnkKaXNoX21pc3NfcHJlcGFyZSBnb2xhbmctc3RvcnkKaXNoX21pc3NfcHJlcGFyZSByZWRpcy1zdG9yeQppc2hfbWlzc19wcmVwYXJlIG15c3FsLXN0b3J5CmlzaF9taXNzX3ByZXBhcmUgcmVsZWFzZQoKaXNoX21pc3NfcHJlcGFyZV9jb250ZXh0cwppc2hfbWlzc19wcmVwYXJlX2ludHNoZWxsCmlzaF9taXNzX3ByZXBhcmVfaWNlYmVyZ3MKaXNoX21pc3NfcHJlcGFyZV90b29sa2l0cwppc2hfbWlzc19wcmVwYXJlX3ZvbGNhbm9zCmlzaF9taXNzX3ByZXBhcmVfbGVhcm5pbmcKCmlzaF9taXNzX21ha2U7IGlmIFsgLW4gIiQqIiBdOyB0aGVuIC4vYmluL2ljZS5iaW4gZm9yZXZlciBzZXJ2ZSAiJEAiOyBmaQoKaXNoX3N5c19saW5rX2NyZWF0ZSB+Ly52aW1fbG9jYWwudmltICRQV0QvZXRjL2NvbmYvdmltX2xvY2FsLnZpbQpyZXF1aXJlIGRldi92aW0vdmltLnNoCmlzaF9kZXZfdmltX3ByZXBhcmUKCmlmIHRtdXggLVY7IHRoZW4KICAgIHJlcXVpcmUgZGV2L3RtdXgvdG11eC5zaAogICAgaXNoX2Rldl90bXV4X3ByZXBhcmUKICAgIGlzaF9taXNzX3ByZXBhcmVfc2Vzc2lvbiBtaXNzIG1pc3MKZWxzZQogICAgY3R4X2xvZz0vZGV2L3N0ZG91dCBpc2hfbWlzc19zZXJ2ZQpmaQoK",
        "etc/init.shy": "fmFhYSAKCXJvbGUgd2hpdGUgdm9pZCB3ZWIuY29kZS5pbm5lcgoJcm9sZSB3aGl0ZSB2b2lkIHdlYi5jb2RlLmdpdC5zcGlkZQoJcm9sZSB3aGl0ZSB2b2lkIHdlYi5jb2RlLmdpdC50cmVuZAoJcm9sZSB3aGl0ZSB2b2lkIHdlYi5jb2RlLmlucHV0LmZpbmQKCXJvbGUgd2hpdGUgdm9pZCB3ZWIud2lraS5hbHBoYS5maW5kCglyb2xlIHdoaXRlIHZvaWQgd2ViLndpa2kud29yZAoJcm9sZSB3aGl0ZSB2b2lkIHdlYi53aWtpLmRyYXcKCn53ZWIuY29kZS5pbnB1dAoJIyB3dWJpIGxvYWQgZmlsZSB1c3Ivd3ViaS1kaWN0L3d1Ymk4NgoJd3ViaSBsb2FkIGZpbGUgdXNyL3d1YmktZGljdC9wZXJzb24gem9uZSBwZXJzb24KCn5nZGIKCWV2ZW50IGFjdGlvbiBsaXN0ZW4gZXZlbnQgZHJlYW0uY3JlYXRlIGNtZCB3ZWIuY29kZS50bXV4LnNlc3Npb24KCn5zc2gKCXRhcmdldCB3ZWIuY29kZQoJc291cmNlIGxvY2FsLnNoeQoK",
        "etc/exit.shy": "fmFhYQo=",

        "LICENSE": "TUlUIExpY2Vuc2UKCkNvcHlyaWdodCAoYykgMjAyMiDnoIHnpZ4KClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwp0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCmNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwpmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsCmNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCgpUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgpJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCkFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUKU09GVFdBUkUuCg==",
        "Makefile": "ZXhwb3J0IENHT19FTkFCTEVEPTAKCmJpbmFyeXMgPSBiaW4vaWNlLmJpbgpwdWJsaXNoID0gdXNyL3B1Ymxpc2gvaWNlLiQoc2hlbGwgZ28gZW52IEdPT1MpLiQoc2hlbGwgZ28gZW52IEdPQVJDSCkKCmFsbDogZGVmCglAZWNobyAmJiBkYXRlCglnbyBidWlsZCAtdiAtbyAke2JpbmFyeXN9IHNyYy9tYWluLmdvIHNyYy92ZXJzaW9uLmdvIHNyYy9iaW5wYWNrLmdvICYmIC4vJHtiaW5hcnlzfSBmb3JldmVyIHJlc3RhcnQgJj4vZGV2L251bGwKCW1rZGlyIC1wICQoZGlyICR7cHVibGlzaH0pICY+L2Rldi9udWxsOyBybSAke3B1Ymxpc2h9ICY+L2Rldi9udWxsOyBjcCAke2JpbmFyeXN9ICR7cHVibGlzaH0KCmRlZjoKCUAgWyAtZiBzcmMvdmVyc2lvbi5nbyBdIHx8IGVjaG8gInBhY2thZ2UgbWFpbiIgPiBzcmMvdmVyc2lvbi5nbwoJQCBbIC1mIHNyYy9iaW5wYWNrLmdvIF0gfHwgZWNobyAicGFja2FnZSBtYWluIiA+IHNyYy9iaW5wYWNrLmdvCgphcHA6CglDR09fRU5BQkxFRD0xIGdvIGJ1aWxkIC1vIHVzci9wdWJsaXNoL2NvbnRleHRzLmFwcC9Db250ZW50cy9NYWNPUy9jb250ZXh0cyBzcmMvd2Vidmlldy5nbyBzcmMvYmlucGFjay5nbyAmJiBvcGVuIHVzci9wdWJsaXNoL2NvbnRleHRzLmFwcAoJIyBoZGl1dGlsIGNyZWF0ZSB1c3IvcHVibGlzaC90bXAuZG1nIC1vdiAtdm9sbmFtZSAiQ29udGV4dHNJbnN0YWxsIiAtZnMgSEZTKyAtc3JjZm9sZGVyICJ1c3IvcHVibGlzaC9jb250ZXh0cy5hcHAiCgkjIHJtIC1mIHVzci9wdWJsaXNoL0NvbnRleHRzSW5zdGFsbC5kbWcKCSMgaGRpdXRpbCBjb252ZXJ0IHVzci9wdWJsaXNoL3RtcC5kbWcgLWZvcm1hdCBVRFpPIC1vIHVzci9wdWJsaXNoL0NvbnRleHRzSW5zdGFsbC5kbWcKCiU6IHNyYy8lLmdvCglAZWNobyAmJiBkYXRlCglnbyBidWlsZCAtdiAtbyB1c3IvcHVibGlzaC8kQCBzcmMvJEAuZ28gJiYgY2htb2QgdSt4IHVzci9wdWJsaXNoLyRACgo=",
        "README.md": "IyBjb250ZXh0cwoKY29udGV4dHMg6YCa6L+H6ZuG576k5YyW44CB5qih5Z2X5YyW44CB6Ieq5Yqo5YyW55qE5pa55byP77yM55So5LiA5LiqIDIwTSDnmoTnqIvluo/mlofku7bvvIwg5bCx5Y+v5Lul5Zyo5ZCE56eN6K6+5aSH5LiK77yM5LiA6ZSu5pCt6LW35a6M5pW055qE5LqR6K6h566X5LiO5LqR56CU5Y+R5pyN5Yqh44CCCgojIyDlronoo4Xpobnnm64KCmBgYHNoCmN0eF90ZW1wPSQobWt0ZW1wKTsgY3VybCAtbyAkY3R4X3RlbXAgLWZzU0wgaHR0cHM6Ly9zaHlsaW51eC5jb207IHNvdXJjZSAkY3R4X3RlbXAgYmluYXJ5IHBvcnQgOTAyMApgYGAKCiMjIOS9v+eUqOmhueebrgrlpoLmnpzmmK/mnKzlnLDlkK/liqjvvIznm7TmjqXlhY3nmbvlvZXmiZPlvIDnvZHpobXvvIxodHRwOi8vbG9jYWxob3N0OjkwMjAg77yMCuWmguaenOaYr+i/nOeoi+aIluWuueWZqOWQr+WKqO+8jOi+k+WFpeebuOW6lOWcsOWdgOWQju+8jOi+k+WFpem7mOiupOeahCB1c2VybmFtZTogcm9vdCBwYXNzd29yZDogcm9vdCDljbPlj6/nmbvlvZUKCg==",

	}

	for k, v := range pack {
		ice.Info.Pack[k], _ = base64.StdEncoding.DecodeString(v)
	}

}
